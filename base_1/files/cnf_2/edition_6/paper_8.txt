DOI: 10.1111/j.1467-8659.2009.01546.x

COMPUTER GRAPHICS

forum

Volume 29 (2010), number 1 pp. 88–100

Time-Dependent 2-D Vector Field Topology: An Approach
Inspired by Lagrangian Coherent Structures
F. Sadlo and D. Weiskopf
Visualization Research Center, Universit¨at Stuttgart, Germany
{sadlo, weiskopf}@visus.uni-stuttgart.de

Abstract
This paper presents an approach to a time-dependent variant of the concept of vector field topology for 2-D
vector fields. Vector field topology is defined for steady vector fields and aims at discriminating the domain of a
vector field into regions of qualitatively different behaviour. The presented approach represents a generalization
for saddle-type critical points and their separatrices to unsteady vector fields based on generalized streak lines,
with the classical vector field topology as its special case for steady vector fields. The concept is closely related to
that of Lagrangian coherent structures obtained as ridges in the finite-time Lyapunov exponent field. The proposed
approach is evaluated on both 2-D time-dependent synthetic and vector fields from computational fluid dynamics.
Keywords: vector field topology, Lagrangian coherent structures, time-dependent vector fields
Categories and Subject Descriptors (according to ACM CCS): Computer Graphics [I.3.8]: Applications—
Physical Sciences and Engineering; [J.2]: Physics—Simulation, Modeling, and Visualization [I.6.9]: Visualization

practical flows, these stream surfaces are often too convoluted [PS07] and lead to occlusion problems. An alternative
is to show only their pairwise intersections, known as saddle connectors [TWHS03] or heteroclinic orbits, showing
the connectivity between critical points. In three dimensions,
there are two more types of singularities that can be investigated beyond what the topological skeleton provides,
namely invariant tori [PS09] and strange attractors. Another
purpose of critical points, besides characterizing the neighbourhood and computing skeletons, is their use for seeding
stream lines and stream surfaces, as has been done e.g. by
Ye et al. [YKP05]. Even if critical points are used without
any type analysis, this strategy was shown to yield effective
visualizations by Weinkauf et al. [WHN∗ 03]. Garth et al.
[GTS∗ 04] and Tricoche et al. [TGK∗ 04] demonstrated how
complex flow structures such as vortex breakdown bubbles
can effectively be visualized by using stream surfaces.

1. Introduction and Related Work
Vector field topology, introduced by Helman and Hesselink
[HH89], aims at the extraction of special stream lines related
to singularities, most importantly the isolated zeros called
critical points. Critical points, as well as 3-D periodic orbits (closed stream lines), can be classified into attracting,
repelling, or saddle-like types by analysis of the velocity
gradient. Vector field topology is utilized in a wide field
of applications, from fluid dynamics to the large field of
continuous dynamical systems. L¨offelmann et al. visualize
the behaviour near the singularities of a 3-D system using
various techniques such as glyphs [LMGP97] and Poincar´e
maps [LKG98]. The topological skeleton is obtained by extracting singularities (critical points and periodic orbits), and
if they are of saddle type, also the separatrices, i.e. their
stable and unstable manifolds. Isolated periodic orbits can
be extracted with the method of Wischgoll and Scheuermann
[WS01]. In two dimensions the topological skeleton provides
a segmentation of the domain into regions of qualitatively
similar behaviour. In three dimensions, the 2-D separating
manifolds theoretically provide segmentation. However, in
c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and
Blackwell Publishing Ltd. Published by Blackwell Publishing,
9600 Garsington Road, Oxford OX4 2DQ, UK and 350 Main
Street, Malden, MA 02148, USA.

However, vector field topology suffers from one important drawback: it only gives an instantaneous view on vector
fields because it is based on stream lines and is therefore not
directly interpretable for time-dependent vector fields. The

88

F. Sadlo & D. Weiskopf / Time-Dependent 2-D Vector Field Topology

so-called Lagrangian coherent structures (LCS) represent a
time-dependent alternative. Haller [Hal01] has shown that
they can be formulated as ridges in the field of the finitetime Lyapunov exponent [Hal01] (FTLE), measuring the divergence of trajectories, and Lekien et al. [LCM∗ 05] have
confirmed that LCS behave as material lines (in 2-D) or
material surfaces (in 3-D). The FTLE-based approach has
recently attracted much interest in the visualization community [BKKW08, STM08], however, it does not in an intrinsic
way single out special points, classify them, and characterize
their neighbourhood. There is however such a classification
for material lines and surfaces, due to Haller [Hal01]. Unlike
vector field topology, FTLE depends on the choice of the
integration time and therefore, resulting LCS are parameterdependent. A third, more practical limitation is that their
computation tends to be very costly, even if optimization, as
proposed by Garth et al. [GLT∗ 09] and Sadlo et al. [SP07], is
used, because a trajectory has to be integrated for each sample. An ideal ‘time-dependent vector field topology’ would
respect the Lagrangian view, but not have the limitations of
the FTLE-based approach. This is of course an ambitious
goal that will require solving several problems. What we
propose here is to look into the use of generalized streak
lines (GSL) [WTS∗ 07] as a replacement for separatrices and
critical points. Experiments performed on analytic and CFD
vector fields showed that GSL, if appropriately seeded, are
often consistent with FTLE ridges. More prominently, Haller
[Hal00] showed in 2000 that there exist so-called hyperbolic
trajectories with the property that neighbouring path lines
converge towards them in positive or negative time. We will
reinterpret his findings in terms of vector field topology, one
result being the fact that these hyperbolic trajectories are
a generalized counterpart to saddle-type critical points for
time-dependent vector fields and that GSL seeded at hyperbolic trajectories represent separatrices. GSL have the additional advantage of being parameter-free (except for their
geometric length) and easily computable by a method that
generates lines directly, not via ridge extraction.
2. Classical Vector Field Topology
The concept of vector field topology for steady vector fields
or snapshots (single time steps) of time-dependent vector
fields was originally defined by means of special types of
stream lines, or orbits in terms of dynamical systems theory:
critical points and separatrices.
Stream lines that degenerate to points because starting at
zeros of the vector field are called stationary points and if
they exhibit a regular velocity gradient they are called critical points. Critical points constitute the basis of vector field
topology and can be classified by means of the eigenvalues of the velocity gradient at these locations into different
categories. In 2-D vector fields one mainly discriminates
saddle-type critical points exhibiting real eigenvalues of opposite sign (or negative determinant), nodes where signs are
equal, and foci with a pair of complex eigenvalues. In the

89

special case of 2-D divergence-free vector fields, centers are
structurally stable critical points, too.
Stream lines that converge to saddles in either positive or
negative time form the separatrices which separate regions
of different behaviour of the vector field. In 3-D, a saddle has
a pair of a 1-D and a 2-D separatrix, i.e. a stream line and
a stream surface. The separatrices can be further classified
into stable and unstable manifolds, converging to the critical
point in positive or negative direction of time, respectively. In
3-D, additional separatrices are obtained from stream lines
that converge to saddle-type periodic orbits in positive or
negative time. They form a pair of 2-D manifolds, a stable
and an unstable one.
In the following section we motivate a time-dependent
alternative for the two concepts of critical points and separatrices, and reinterpret the concept of hyperbolic trajectories
and the trajectories that converge to them in these terms.
3. Generalized Vector Field Topology
For steady-state vector fields, LCS defined by FTLE ridges
coincide in many cases with manifolds in the sense of vector
field topology [Hal01, SP09], stable manifolds corresponding to repelling LCS and unstable ones to attracting LCS
[Hal00]. Manifolds are attracting in the sense that a perturbation perpendicular to the manifold grows exponentially in
reverse time direction and repelling in the sense that such
a perturbation grows exponentially in forward time. FTLE
often exhibits ridges along separatrices because separatrices
are converging to saddle-type critical points in the respective direction of time whereas nearby stream lines pass the
critical point and hence typically end up at locations distant
from the critical point, and hence lead to an increased FTLE.
Because LCS are material lines, this motivates to interpret
separatrices as streak lines converging to respective saddletype critical points in the appropriate direction of time. As
in the case of classical vector field topology, these separatrices can be constructed by seeding them at small offset from
the respective critical point and developing them in the appropriate direction of time. This leads to our approach to a
time-dependent (generalized) vector field topology (GVFT):
simply replace the role of stream lines by generalized streak
lines [WTS∗ 07] in the concept. Since streak lines and stream
lines are identical in steady vector fields, this generalization
does not change the classical vector field topology but may
provoke new interpretations.
In the case of time-dependent vector fields, on the other
hand, GVFT and vector field topology will usually differ
substantially. In contrast to classical separatrices, our generalized separatrices (the generalized streak lines) advect
with the flow and our generalized critical points (degenerate
generalized streak lines) may move over time. The fact
that our generalized critical points may move over time
necessitates to use generalized streak lines, a variant of streak
lines where the seed is allowed to move.

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

90

F. Sadlo & D. Weiskopf / Time-Dependent 2-D Vector Field Topology

The above reasoning about the correspondence between
FTLE ridges and generalized separatrices also holds for timedependent vector fields: (moving) hyperbolic regions take
over the seeding role of saddle-type critical points in the
case of time-dependent vector fields. For the same reasons,
the generalized streak lines converge to that region in the
respective direction of time even if the region is moving. A
major drawback with classical vector field topology is its
frame dependence, i.e. a Galilean transformation can arbitrarily move critical points and even lead to bifurcations, i.e.
the creation or destruction of critical points. In the original
approach [HH89], it is therefore mentioned that an appropriate frame of reference has to be chosen when applying
the concept of vector field topology, surely a unsatisfactory
circumstance in many cases. Fortunately, FTLE and hence
the concept of LCS are Galilean invariant and since we aim
at an approach inspired by LCS, we also aim at Galilean
invariance. Regions in 2-D vector fields can be defined to
be hyperbolic if the determinant of the velocity gradient has
negative sign, a Galilean invariant property, and consistent
with the classification of classical saddle-type critical points.
However, on the one hand these regions are typically quite
large, and on the other they can move at arbitrary speed in
time-dependent vector fields leading to no substantial separation effect on neighbouring trajectories passing the region.
In addition, we propose the generalized critical points to
be degenerate generalized streak lines. Generalized streak
lines are only degenerate if they are seeded on path lines in
space–time, i.e. the seed itself is a particle that advects with
the flow. All in all, this motivates us to define generalized
critical points in the space–time view as distinguished path
lines inside hyperbolic regions.
The concept of hyperbolic trajectories was already proposed in 2-D by Haller [Hal00] in 2000 using the so-called
hyperbolicity time: the time a trajectory spends in a hyperbolic region until it leaves it for the first time. He states
that a trajectory is hyperbolic if two 1-D manifolds of trajectories converge towards it, one in forward and one in
reverse time direction. For finding the seed for such a hyperbolic trajectory at a given time t0 , he proposed to compute
the hyperbolicity time in forward and backward time direction, to detect the local maxima (which we interpret here
as height ridges according to Eberly [EGM∗ 94]) in these
two scalar fields and to determine the intersections of these
ridges. If the ridges are ‘sharp’, i.e. thin and the deformation
rate of the LCS low, these intersections already represent
the seeds for hyperbolic trajectories, otherwise one intersects the ridge-like regions and obtains regions representing
sets of candidates for hyperbolic trajectories, which need
then to get further restricted by additional conditions in his
theorem 1.
Ide et al. [ISW02] proposed an alternative approach: they
obtain candidates for their so-called distinguished hyperbolic trajectories from a temporal analysis of classical critical
points and then find the distinguished hyperbolic trajectories

by construction of a time-dependent linear model. We restrict
this work to Haller’s formulation and refer the reader to the
dynamical systems and fluid mechanics literature for methods and discussions of how to find hyperbolic trajectories in
general. Haller addressed 2-D time-dependent vector fields
that are not necessarily divergence-free, interpreted time as
third dimension, and stated that the trajectories converging to
the hyperbolic trajectory form 2-D manifolds in space–time
(see Figure 3). This is perfectly consistent with our approach
because if these manifolds are intersected by a plane of constant time, one obtains exactly the generalized streak lines
seeded on the hyperbolic trajectory in the appropriate direction of time.
The presented approach may be incomplete in the sense
that no time-dependent counterpart in terms of generalized
streak lines is given for the classical critical points of type
node, focus and center, as well as for periodic orbits. The authors are not aware of it in the field of dynamical systems and
fluid mechanics, and because it would probably go beyond
the scope of this paper, it is addressed as future work.
In the following Section 4, we present methods for obtaining the seeds for hyperbolic trajectories and the construction
of the space–time streak manifolds. Then, in Section 5, we
validate our approach and show results using different synthetic and CFD examples.
4. Method
In this section we present methods for obtaining seeds for
hyperbolic trajectories (Section 4.1) and for generating the
space–time streak manifolds (Section 4.2).
4.1. Extraction of seeds for hyperbolic trajectories
As stated by Haller [Hal00], hyperbolicity time has some
nice properties compared to FTLE. Whereas FTLE builds
on the gradient between the end points of trajectories and
is therefore highly sampling-dependent, hyperbolicity time
can be evaluated per trajectory and a value at a sample point
does therefore not depend on neighbouring values. Second,
it is less dependent on the advection time T that is used for
its evaluation, compared to FTLE. He states that increasing
T renders sharper and sharper results. Therefore, T can be
chosen such that it covers the complete available temporal
domain of the data. Haller proposed to sample hyperbolicity
time on a grid of initial conditions, i.e. starting points for the
trajectories. Hyperbolicity time dT of the vector field u(x, t)
at time t0 and location x 0 computes as
dT (x 0 , t0 ) =
max {t | det ∇u(x(τ ; x 0 ), τ ) < 0, t0 ≤ τ < t}

t∈[t0 ,t0 +T ]

(1)
with x(•; x 0 ) being the trajectory started at x 0 , in other words,
the time a trajectory spends in a hyperbolic region until it

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

91

F. Sadlo & D. Weiskopf / Time-Dependent 2-D Vector Field Topology

tant since the extraction of height ridges is sensitive to noise
[PS08] because it relies on second derivatives.
The straightforward approach would be now to extract
hyperbolicity time in forward and reverse time over a sufficiently large time interval to ensure sufficiently sharp ridges,
extract ridges therefrom, and use the ridge intersections directly as seeds for hyperbolic trajectories, or, depending on
the data, to additionally check if the trajectories seeded at
these intersections fulfill over the interval [t0 , t0 + T ] all
conditions in Haller’s theorem 1 [Hal00]:
√

det ∇u(x(t), t) < 0,

2β

1
1
+
λ1 min
λ2 min

<α

with the real eigenvalues −λ1 (t) < 0 < λ2 (t) of ∇u(x(t), t),
λk min = min λk (t),
[t0 ,t0 +T ]

k = 1, 2,

M being the matrix of the temporally consistently oriented
eigenvectors of ∇u(x(t), t), and
Figure 1: Forward hyperbolicity time in buoyancy dataset
(see Section 5.4) inside time interval [2, 9] computed without
supersampling (top left, visible aliasing artifacts (arrows) at
thin ridges) and with supersampling (top right). For comparison, FTLE at t0 = 2 with advection time T = 0.5 (bottom
left) and T = 3 (bottom right).
exits it the first time. Haller also proposes to apply early
termination of the integration of the trajectories, meaning that
integration can be stopped as soon as the trajectory enters
a non-hyperbolic region. This accelerates the computation
typically substantially since vector fields usually exhibit a
high amount of (moving) non-hyperbolic regions.
Figure 1 (top row) shows a result for the buoyancy dataset
subject to investigation in Section 5.4. There are, however,
mainly two issues with the sampling of hyperbolicity time.
The first one is that one needs to evolve time (and hence
the trajectory) in discrete steps in numerical data and a direct application of Equation 1 in this context would lead to
quantization by these time steps. Therefore, we detect the
time step where it leaves the hyperbolic regime, or the domain, and perform bisection search inside that time interval
to determine the exit time. The second issue is aliasing. The
ridges in hyperbolicity time are typically extremely thin and
exhibit high gradients, therefore trajectories seeded on a regular grid often miss the features, leading to aliasing as shown
in Figure 1 (top left). Increasing resolution does typically not
reduce the problem because the ridges are that thin. We perform super-sampling to address this problem. Figure 1 (top
right) shows the same region of the field but this time 5 × 5
trajectories are seeded on a regular grid covering a pixel
and the resulting hyperbolicity times are averaged. This not
only tends to produce contiguous and smooth ridges, it also
results in reduced numerical noise. This is especially impor-

α=

min

t∈[t0 ,t0 +T ]

| det M|,

β=

max

t∈[t0 ,t0 +T ]

∂
M .
∂t

With
√
γ =

2β α 2 λ1 min λ2 min +

√

2αβ(λ1 min + λ2 min ) + 2β 2

α 3 λ1 min λ2 min

the additional conditions of Haller’s theorem 1 for a trajectory being uniformly finite-time hyperbolic inside the interval
[t0 , t0 + T ] are:
β <

α
2

2λ1 min λ2 min ,

2β 2
λ2 (t),
1 min λ2 min
2β 2
λ2 (t) > γ + 2
λ1 (t).
α λ1 min λ2 min
λ1 (t) > γ +

α2 λ

Although intersecting ridges of hyperbolicity time works
well for some cases such as our oscillating gyre-saddle example (Section 5.2), we encountered problems even for the
simple quad-gyre example (Section 5.3), and in particular in
case of CFD (Section 5.4). Several problems can arise:
• The temporal domain of the field may not allow hyperbolicity time to develop sharp enough ridges, meaning
that regions of constant maximum time (compare red
band in Figure 1 (top row)) remain, which do not allow
for a robust extraction of height ridges. In this case, after
intersection of forward and backward hyperbolicity time
candidate sets, a subset of these adjacent samples represents candidates for uniformly hyperbolic trajectories
and many of them may fulfill the additional conditions
of theorem 1, resulting in adjacent uniformly hyperbolic
trajectories, instead of isolated ones. Extracting ridges

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

92

F. Sadlo & D. Weiskopf / Time-Dependent 2-D Vector Field Topology

would have the additional advantage that the ridge intersections are not restricted to the sampling grid, because
ridge extraction is based on interpolation. Hence, ridge
intersections typically result in a much better approximation for the seeds, especially if the ridges are very thin
and hence would be hard to sample on a grid.
• The field may lead to intricate ridges, as in the case of the
quad-gyre example (see below), making the extraction
and intersection of ridges intractable.
• The ridge intersections may not be consistent with FTLE
ridges for a desired FTLE advection time. This is basically no problem but the goal of this work is to derive
a concept that is consistent with LCS in terms of FTLE
ridges.

Since both, ridges in the FTLE (of appropriate advection
time) and ridges in hyperbolicity time represent invariant
manifolds, we prefer to extract ridges from FTLE fields and
intersect those. As already mentioned, FTLE depends on the
advection time used for its computation. This first seems as a
drawback, but it also offers a scale-dependent approach: if the
advection time is increased, FTLE ridges (the LCS) typically
also get sharper but at the same time they often get longer
and more convoluted (see Figure 1, bottom row). Intersecting
these massively folded LCS leads to a huge number of intersections and may lead to insignificant visualizations. Hence,
the advection time for FTLE computation can serve as a scale
parameter. This motivation is supported by the observation
that we were not able to extract uniformly hyperbolic trajectories, using both ridges in hyperbolicity time and FTLE,
in CFD data in significant regions and time intervals, as
discussed in Section 5.4. In addition, rejecting FTLE ridge
regions if the FTLE falls below a threshold allows to quantitatively restrict the analysis to LCS of a required strength of
repulsion or attraction. Furthermore, FTLE is, due to its spatially variational definition, typically smooth even at low resolutions and does not exhibit flat regions in non-degenerate
vector fields, hence its ridges are well defined and precise
with respect to the chosen time scale. Further, we typically
impose a threshold on the intersection angle between ridges
to suppress intersections of almost parallel ridges that would
lead to inaccurate and also often insignificant results.
If the data allow for it (depending on the rate at which LCS
deform [Hal00], the available temporal domain, and numerics), we restrict the intersections to seeds for uniformly hyperbolic trajectories by applying the additional conditions of
Haller’s theorem 1. Otherwise, we propose a ‘weak’ hyperbolicity approach: we generate the space–time streak manifolds as long as the seeding trajectory is inside a hyperbolic
region and stop their generation if it enters a non-hyperbolic
region (or start the reverse-time manifold only at this time).
This can be seen as a complementary approach to filtering
the trajectories by their hyperbolicity time. Although these
trajectories typically deviate from the intersection curve of

the attracting and repelling invariant manifolds, this is not so
much of a problem because the generated streaks get quickly
attracted by the attracting manifold in the respective direction
of time (compare Figure 6 and Figure 10, bottom).
Accurate seeds can be extracted by filtered AMR ridge
extraction [SP07], however at the risk of missed ridges and
hence intersections. In our tests, we iteratively decrease the
size of a sampling window of constant resolution around each
intersection of the ridges until the change of the intersection
falls below a tolerance. To constrain the computational cost
to an acceptable level and to obtain significant visualizations
in case of massively folded ridges, we supervised the search
in these cases by adapting the ridge filtering criteria. We address an advanced algorithm for the seed search in case of
massively folded ridges as future work, possibly based on
a histogram analysis of the underlying field, also because
our tests indicate that even highly accurate seeds with respect to the underlying FTLE or hyperbolicity time field do
not guarantee exact hyperbolic trajectories over long time
intervals (Figure 6, bottom), in the sense that they follow the
intersection curves of the invariant attracting and repelling
manifolds. It was already stated by Haller [Hal00] that integrating hyperbolic trajectories is a hard task because there is
a repelling manifold in each direction of time and therefore
errors tend to grow exponentially.
To conclude this section, we present the problems and the
chosen approach for extracting the seed for the quad-gyre
example (Section 5.3). Figure 2 (top row) shows its hyperbolicity time forward, and in reverse time direction. Whereas
the forward hyperbolicity time behaves well in the central region where the seed has to be located, backward hyperbolicity time exhibits ‘resonances’: there is a very high number of
vertical ridges in the region where the aimed ridge is located
(Figure 2, top right). This phenomenon forbids to extract
ridges in this region and zooming as well as supersampling
did not lead to a successful extraction of the desired (vertical)
ridge. Therefore we also visualized inside a region around
the presumed ridge intersection the points of uniform hyperbolicity according to all conditions of Haller’s theorem 1
(Figure 2, mid row). Whereas the forward hyperbolicity
time exhibits a single horizontal ridge, backward hyperbolicity still exhibits a multitude of seeds for uniformly hyperbolic trajectories along that line. Therefore we have chosen
to extract the ridges from FTLE (Figure 2, bottom row),
which resulted in a seed for an accurate uniformly hyperbolic
trajectory.
4.2. Extraction of space–time streak manifolds
As explained in Section 3, the generalized streak lines
representing time-dependent separatrices, or manifolds, are
seeded along hyperbolic trajectories. In a space–time view
(regarding time as third dimension of the 2-D vector field),
the generalized streak lines become 2-D manifolds (e.g.
Figure 3) which we call space–time streak manifolds.

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

F. Sadlo & D. Weiskopf / Time-Dependent 2-D Vector Field Topology

Figure 2: Seed extraction in quad-gyre example at time
t0 = 20. Forward hyperbolicity time (top left) and backward
(top right) of the complete region. Close-up region of uniform
hyperbolicity (red) for time interval [20, 30] (mid left) and
[10, 20] (mid right) with max-time hyperbolicity (light blue)
around the ‘cross-shaped’ high backward hyperbolicity time
region (arrow), and corresponding FTLE of advection time
T = 10 (bottom left) and T = −10 (bottom right). The backward uniform hyperbolicity exhibits a small vertical ridge
consistent with the LCS in backward-time FTLE and indeed,
the intersection of the FTLE ridges results in an accurate
seed for a uniformly hyperbolic trajectory (Figure 8).

Several techniques were proposed for the extraction of the
invariant stable and unstable manifolds of hyperbolic trajectories. Because the manifolds usually undergo massive thinning (stretching) and also possibly folding, refinement of the
resulting lines is usually necessary. Mancho et al. [MSWI03]
give an overview of different existing approaches and also
present new ones. In general, they initially seed particles
along the eigenvector of the velocity gradient (the eigenvector corresponding to the chosen direction of time), discuss
different criteria for deciding when a new trajectory (in our
sense a new streak particle) needs to get inserted during ad-

93

Figure 3: Attracting invariant manifold (light blue) and repelling invariant manifold (red) consist of trajectories (blue,
red) converging to the hyperbolic trajectory (green tube
seeded at black sphere) in the respective direction of time.
Space–time streak manifold generation: attracting streak
manifold is seeded in forward direction along hyperbolic
trajectory with offset in eigenvector direction of the velocity
gradient at the respective position and time (orange spheres).
The space–time streak manifold consists of the trajectories
(blue) of each particle of the two generalized streak lines. An
isotemporal slice of the manifold represents the two generalized streak lines (turquoise).

vection for obtaining manifolds without ‘gaps’, and insert
required particles at the previous time step by interpolation.
We follow a different approach: for a given direction of
time, we seed two generalized streak lines at an offset from
the hyperbolic trajectory (Figure 3). A seed for each streak
line is generated at regular time steps along the hyperbolic
trajectory and the offset is orientated along the eigenvector
of the velocity gradient at the respective position and time of
the hyperbolic trajectory, the major eigenvector for the extraction of attracting manifolds (integration in forward time)
and the minor for repelling manifolds (integrated in reverse
time). We use a user-defined constant offset from the hyperbolic trajectory. This offset distance has to be small enough
to allow for the linearization by the velocity gradient, also
with respect to temporal change. However, because the manifold is attracting in the respective direction of time, errors
tend to shrink and therefore tend to be negligible. It is also
necessary to orientate the eigenvector to be consistent with
the respective streak in order to prevent ‘switching’ of the
seeds.

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

94

F. Sadlo & D. Weiskopf / Time-Dependent 2-D Vector Field Topology

At each time step of the space–time streak manifold generation procedure, we measure the distance between neighbouring particles of each streak line and test it against a
user-defined threshold. If this threshold is violated and hence
insertion of a particle is required, we do not interpolate
between already advected streak particles, similar to the
Hultquist family of integral surface construction algorithms
[Hul92, GTS∗ 04, GKTJ08], but linearly interpolate between
the corresponding seed positions in space and time and use
the interpolated seed for generating a new trajectory up to
the current time. In addition, to avoid excessive computation,
we allow to erase streak particles if the distance falls below
an other threshold. Hereby, we either allow only the deletion of particles that were generated by interpolation of the
seed (and hence less accurate), or also allow the deletion of
particles generated by ‘true’ seeds.

5.1. Skewing gyre-saddle example
One of the simplest cases in the field of LCS is a saddle-type
critical point that stands still, exhibits approximately constant
eigenvalues and eigenvectors over time, and persists over the
entire temporal domain. Although this example may sound
academic, it is quite common in many areas. The probably
most prominent and most important area are dynamical systems where it is quite common that the phase space exhibits
non-moving critical points. As another example, fluid dynamics solutions at low Reynolds numbers tend to converge
to quasi-steady state flow, provided that there are constant
boundary conditions.
A time-dependent variant of the linear saddle-type vector
field
ax
u(x) =
a > 0, b > 0,
−by

The space–time streak manifolds are terminated as soon
as the corresponding hyperbolic trajectory enters a nonhyperbolic region. From that point on the remaining part
of the trajectory may be visualized to support the spatial perception of where the space–time streak manifold ends (see
Figure 10, bottom). The corresponding reverse-time manifold is constructed along the same hyperbolic trajectory with
the difference, that if the forward-time trajectory was stopped
because it entered a non-hyperbolic region, the reverse-time
manifold is constructed only from this time on (see Figure 10,
bottom). Of course, the manifolds can be constructed from
hyperbolic trajectories integrated in both directions of time
starting at the seeds. However, in this work we only show
the manifolds for the hyperbolic trajectories computed in
forward direction from the seeds.

which is often used as a simple test case in vector field topology, would be a straightforward approach for our analysis.
However, this field exhibits uniform velocity gradient and
because all trajectories separate at the same rate in this vector field, it also exhibits uniform FTLE and hence no ridges.
This is sometimes regarded as a drawback of Lagrangian
methods such as FTLE, but due to the uniform velocity gradient we regard it as a degenerate case in the Lagrangian
view. Therefore, we will be using a simple example derived
from the so-called steady-type double-gyre flow. This vector
field is 2-D, divergence-free, spatially periodic, features a
saddle point, and expresses FTLE ridges due to non-linearity
[Sha05]. The derived example is made spatially non-periodic
for simplicity, is still divergence-free, and offers a parameter for manipulating the angle at which the manifolds cross
each other, which will be varied to obtain an exemplary timedependent vector field. We call our example gyre-saddle and
define it inside the region D = [− 12 , 12 ] × [− 21 , 12 ] as

5. Results
In the following sections, we examine our approach using
different 2-D vector fields, both synthetic and from CFD.
The seeds for the hyperbolic trajectories were all obtained
by ridge intersections of FTLE, not hyperbolicity time.

u(x) =

1

1

0

0

-1

-1

-1

0

1

-1

− sin(π x) cos(π y) + a sin(π y) cos(π x)
sin(π y) cos(π x) − a sin(π x) cos(π y)

0

1

Figure 4: Gyre-saddle example. Standard configuration at t = 0 (left) and skew configuration at t = 1/4 (right).
c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

F. Sadlo & D. Weiskopf / Time-Dependent 2-D Vector Field Topology

Figure 5: Space–time visualization of skewing gyre-saddle
example. Top: standard visualization. FTLE at time t0 = 4
with advection time T = 5, at time t0 = 6.6 with advection time T = −5, and at time t0 = 9 with advection time
T = −5. Space–time streak manifolds (attracting: light blue,
repelling: red) seeded along uniformly hyperbolic trajectory
(green tube) are consistent with respective LCS. Bottom: visualization for verification with reversed FTLE advection
times. The repelling LCS should preferably intersect the attracting space–time streak manifold at the uniformly hyperbolic trajectory. This is the case over the complete time interval in this example.
and outside the region D using k = (y ≥ |x|) − (y ≤ −|x|)
and l = (x > |y|) − (x < |y|), with (·) being 1 if true and 0
if false, as
u(x)
⎞
⎛
1
k
−
lc
π
y
−
aπ
x
−
kac
π
x
−
aπ
y
−
⎜
2
2 ⎟
⎟
=⎜
⎝
1 ⎠
k
− lac π y − aπ x −
kc π x − aπ y −
2
2
with the clamped cosine
⎧
0
⎪
⎨
c(x) = cos(x)
⎪
⎩
0

if x < −π/2
if − π/2 ≤ x ≤ π/2 ,
if x > π/2

95

Figure 6: Space–time visualization of oscillating gyresaddle example. Top: FTLE at time t0 = 4 with advection
time T = 5, at t0 = 6.5 with T = −5, and at t0 = 9 with
T = −5. Space–time streak manifolds (attracting: light blue,
repelling: red) seeded along uniformly hyperbolic trajectory
(green tube) are consistent with respective LCS. Additional
shear-induced LCS (arrow) are not captured. Bottom: reversed FTLE advection times for verification. The repelling
LCS should preferably intersect the attracting streak manifold at the uniformly hyperbolic trajectory. This is still the
case at t = 6.5 but not anymore at t = 9 (arrow). Please see
Section 5.2 for a discussion of this issue.
and the parameter a which is used to control the skew
of the vector field. The standard configuration is a = 0.
We will vary a sinusoidally with time: a(t) = sin(2π t)/3
(Figure 4).
Figure 5 shows a visualization of the skewing saddle example. A seed for a uniformly hyperbolic trajectory inside
the visualized time interval was found and space–time streak
manifolds are visualized together with backward-time FTLE
fields for verification of the attracting streak manifold by
the corresponding attracting LCS. Because the vector field
exhibits a temporal period of τ = 1, the intermediate FTLE
was chosen at t0 = 6.6 for reliable validation. It can be seen
that it is consistent. For a verification of the repelling streak

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

96

F. Sadlo & D. Weiskopf / Time-Dependent 2-D Vector Field Topology

manifold, forward-time FTLE fields are also visualized.
Again, the LCS and the respective streak manifold are consistent. The visualization in Figure 5 (bottom) also serves as
a validation of the uniformly hyperbolic trajectory: it should
stay on the intersection curve of the invariant manifolds and
therefore the attracting streak manifold should intersect the
repelling LCS at the uniformly hyperbolic trajectory. It can
be seen that this is the case for the visualized time interval in
this example.

1

y 0

5.2. Oscillating gyre-saddle example
Here, we apply our method to another variant of the gyresaddle dataset from Section 5.1. Instead of a time-dependent
skew, the example is at standard configuration (a = 0), and
is made time-dependent by a harmonic oscillation of the saddle diagonally between the locations (0.25, 0.25) and (−0.25,
−0.25) with a period of τ = 4. Figure 6 shows the space–time
visualization. The attracting LCS in the FTLE is consistent
with the attracting space–time streak manifold over the entire time interval but the additional boundary-shear induced
attracting LCS are not captured because they are not related
to hyperbolic mechanisms.
For a verification of the repelling streak manifold, forwardtime FTLE fields are also visualized (Figure 6, bottom).
Again, the LCS and the streak manifold are consistent. However, the trajectory does not stay over the complete visualized
time interval on the space–time intersection curve of the attracting and repelling LCS (compare visualization at time
t = 9). Nevertheless, it starts to deviate only at the end of the
interval. We tried to address this problem by extracting the
seed at very high precision from ridges of long-time FTLE
(advection time |T | = 7.9) and also hyperbolicity time, but
this did not lead to better results. Also performing very precise integration for the computation of FTLE and hyperbolicity time as well as for the uniformly hyperbolic trajectory did
not reduce the problem. Since the problem seems to be hard
to isolate, we find it an interesting topic for future research.
Still, it has to be noted that the visualization typically does
not suffer because the streak manifolds get quickly attracted
by the respective invariant manifold.

5.3. Quad-gyre example
Here, we apply the method to the so-called time-dependent
double-gyre example due to Shadden [Sha05]. It is temporally periodic and we use a larger range of the field, resulting
in four gyres, hence we call this example the quad-gyre.
Using
f (x, t) = a(t)x 2 + b(t)x,
a(t) = ε sin(ωt),
b(t) = 1 − 2ε sin(ωt),

−1
−1

0
x

1

Figure 7: Quad-gyre example at t = 0.

it is defined as follows:
⎞
⎛
−πA sin(π f (x)) cos(π y)
u(x) = ⎝
df ⎠ .
πA cos(π f (x)) sin(π y)
dx
We use the configuration = 0.25, ω = 2π/10, and A =
0.1. Figure 7 shows a plot at t = 0. The saddle-type critical
points at x = 0 oscillate horizontally while those at x = −1
and x = 1 are stationary.
Figure 8 shows the visualization using our method. A seed
for a uniformly hyperbolic trajectory inside the visualized
time interval was found and space–time streak manifolds
are visualized together with backward-time FTLE fields for
verification of the attracting streak manifold by the corresponding attracting LCS. It can be seen that it is consistent.
Because the y-symmetry of the example is not varying over
time, we do not show additional forward-time FTLE for verification of the repelling streak manifold. It is consistent with
the y = 0 plane and hence consistent with the corresponding repelling LCS. The uniformly hyperbolic trajectory also
stays on that plane and hence follows the intersection curve
of the invariant manifolds.
5.4. Buoyancy example
This example is a 2-D time-dependent CFD simulation of
buoyant air. The bottom wall is heated whereas the upper one
is cooled, while the left and right walls are neutral. Gravity
is pointing downwards and there is a horizontal barrier extending from the mid of the left wall to the center (Figure 9).
Convective flows are known to exhibit very complicated LCS

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

F. Sadlo & D. Weiskopf / Time-Dependent 2-D Vector Field Topology

97

Figure 8: Space–time visualization of time-dependent quad-gyre example. FTLE at time t0 = 20 with advection time T = 10,
at t0 = 25 with advection time T = −10, and at t0 = 30 with advection time T = −10. Space–time streak manifolds (attracting:
light blue, repelling: red) seeded along uniformly hyperbolic trajectory (green tube) are consistent with respective LCS over the
entire time interval.
that drive the mixing in the flow, i.e. by so-called thinning
and folding.
Unfortunately we were not able to extract seeds for uniformly hyperbolic trajectories in significant regions and for
significant time intervals, as well as in another CFD example.
It has to be subject to further investigation if this is due to
numerics, or if these are cases where the method is not applicable; Haller stated [Hal00] that his method is only applicable
if the deformation rate of the LCS is lower than typical particle speeds. Therefore, we follow our ‘weak’ hyperbolicity
approach discussed in Section 4.1, meaning that we generate
streak manifolds as long as the seeding trajectory stays in a
hyperbolic region. We obtain the seeds from moderate-time
(|T | = 0.5 seconds, same as the visualization time interval)

FTLE fields because long-time FTLE and hyperbolicity time
exhibit massively folded ridges (see Figure 1) that would
lead to a very high number of seeds and hence insignificant
visualizations.
Figure 10 shows two visualizations of the data. The
space–time streak manifolds are visualized together with
backward-time FTLE fields for verification of the attracting streak manifolds by the corresponding attracting LCS.
It can be seen that they are consistent. For a verification of
the repelling streak manifolds, forward-time FTLE fields are
also visualized. Again, the LCS and the streak manifolds are
consistent. However, as in the example from Section 5.2 the
seeding trajectories do not stay on the space–time intersection curves of attracting and repelling LCS over the complete
visualized time interval. Nevertheless, they keep close in the
first half of the visualized time interval. As the trajectory from
Section 5.2 was determined to be uniformly hyperbolic, in
contrast to our weakly hyperbolic trajectories used here, but
also exhibits deviation from the intersection curve, we see
this fact as a motivation for our approach. In addition, the
resulting streak manifolds still got attracted to the respective
invariant manifold in all our experiments.
6. Conclusion

Figure 9: Buoyancy CFD example at t = 2.

We presented an approach to a time-dependent vector field
topology. The concept is inspired by Lagrangian coherent
structures (LCS) present as ridges in the finite-time Lyapunov exponent (FTLE). We mainly build on the findings
by Haller [Hal00] about invariant manifolds of hyperbolic
trajectories in time-dependent vector fields: his concept can
be directly reinterpreted as a time-dependent vector field

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

98

F. Sadlo & D. Weiskopf / Time-Dependent 2-D Vector Field Topology

Figure 10: Space–time visualizations of buoyancy example. Top: FTLE at time t0 = 2 with advection time T = 0.5, at t0 = 2.25
with T = −0.5, and at t0 = 2.50 with T = −0.5. Space–time streak manifolds (attracting: light blue, repelling: red) seeded
along weakly hyperbolic trajectories (green tubes) are consistent with respective LCS, although some would need longer
advection times to cover the full extent of the LCS. Bottom: FTLE with reversed advection times and additionally at t0 = 2.375
with advection time T = 0.5. Space–time streak manifolds are stopped if trajectory gets non-hyperbolic (visualized by white
tubes, black arrow). Repelling LCS should preferably intersect attracting streak manifolds at hyperbolic trajectories. This is
still mostly the case at t = 2.25 but not necessarily at later times (white arrow), see Section 5.2 for a discussion.

topology when the role of stream lines is substituted by generalized streak lines. In this sense one can say that vector field topology should have been formulated based on
generalized streak lines, since they are identical to stream
lines in stationary vector fields. However, we have to point
out that our approach is not complete in the sense that we
only found a time-dependent counterpart to critical points of
type saddle, the hyperbolic trajectories in space–time, and
their separatrices, the space–time streak manifolds. Therefore, only LCS regions that are related to hyperbolic mecha-

nisms are represented, e.g. LCS due to shear processes are not
captured.
Our approach is not restricted to Haller’s formulation on
the basis of ridges in hyperbolicity time, we propose to alternatively base the concept on ridges in the FTLE. This allows
for a robust and scale-dependent approach by variation of the
advection time used for FTLE computation and for significant visualizations that are consistent with LCS defined by
ridges in the FTLE at the chosen advection time scale.

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

F. Sadlo & D. Weiskopf / Time-Dependent 2-D Vector Field Topology

The presented approach exhibits the following advantages
over the extraction of LCS from the FTLE:
• Efficient computation of time series: whereas the FTLE
needs to get recomputed for each frame of an animation,
which is typically very time-consuming, the streak manifolds can be computed at arbitrary temporal and spatial
resolution at comparably little computational cost.
• Ridge extraction is avoided: the resulting streaks are
smooth and insusceptible to (numerical) noise.

99

[GKTJ08] GARTH C., KRISHNAN H., TRICOCHE X., JOY
K. I.: Generation of Accurate Integrat Surfaces in TimeDependent Vector Fields. IEEE Trans. Visual. Comput.
Graph. 14, 6 (2008), 1404–1411.
[GLT*09] GARTH C., LI G.-S., TRICOCHE X., HANSEN C.
D., HAGEN H.: Visualization of coherent structures in transient flows. In Topology-Based Methods in Visualization II
(2009), Hege H.-C., Polthier K., Scheuermann G., (Eds.),
Springer, Berlin Heidelberg, pp. 1–14.

• Hyperbolic trajectories give additional insight into the
organization and dynamics of LCS.

[GTS*04] GARTH C., TRICOCHE X., SALZBRUNN T., BOBACH
T., SCHEUERMANN G.: Surface techniques for vortex visualization. In VisSym, 346 (2004), pp. 155–164.

But it also exhibits the following drawbacks compared to
LCS by FTLE:

[Hal00] HALLER G.: Finding finite-time invariant manifolds
in two-dimensional velocity fields. Chaos 10, 1 (2000),
99–108.

• The approach relies on a sampled field for seeding
the streak manifolds at discrete time steps: the FTLE
or hyperbolicity time. Short-lived LCS may therefore
get missed, i.e. hyperbolic trajectories that are short in
space–time. This can lead to popping artifacts over time.
• The FTLE is not computed on the space–time streak
manifolds and is therefore not available for a quantitative interpretation of the LCS regarding attraction or
repulsion.
• Hyperbolic trajectories are hard to integrate: errors in
the seeding position or during integration tend to grow
exponentially.
We identified several topics for future research. Finding
time-dependent counterparts to critical points of type node,
focus, and center, as well as periodic orbits is probably the
most evident but maybe also most demanding step. A robust
and efficient method for extracting highly accurate ridge intersections in case of massively folded ridges is probably
easier to achieve and therefore the next step we address. Finally, the approach could be extended to 3-D vector fields.

Acknowledgments
We would like to thank Ronald Peikert (ETH Zurich) for his
support.

References
[BKKW08] B¨URGER K., KONDRATIEVA P., KRU¨ GER J.,
WESTERMANN R.: Importance-driven particle techniques
for flow visualization. In Proc. of Pacific Vis. Symp. (2008),
pp. 71–78.
[EGM*94] EBERLY D., GARDNER R., MORSE B., PIZER S.,
SCHARLACH C.: Ridges for image analysis. J. Math. Imag.
Vis. 4, 4 (1994), 353–373.

[Hal01] HALLER G.: Distinguished material surfaces and
coherent structures in three-dimensional fluid flows. Physica D 149, (2001), 248–277.
[HH89] HELMAN J., HESSELINK L.: Representation and display of vector field topology in fluid flow data sets. Computer 22, 8 (1989), 27–36.
[Hul92] HULTQUIST J. P. M.: Constructing stream surfaces
in steady 3-D vector fields. In Proc. IEEE Visualization
’92 (1992), IEEE Computer Society, pp. 171–178.
[ISW02] IDE K., SMALL D., WIGGINS S.: Distinguished hyperbolic trajectories in time-dependent fluid flows: analytical and computational approach for velocity fields defined as data sets. Nonlin. Process. Geophys. 9, 3/4 (2002),
237–263.
[LCM*05] LEKIEN F., COULLIETTE C., MARIANO A. J., RYAN
E. H., SHAY L. K., HALLER G., MARSDEN J. E.: Pollution
release tied to invariant manifolds: A case study for the
coast of Florida. Physica D 210, 1 (2005).
[LKG98] L¨OFFELMANN H., KUCˇ ERA T., GRO¨ LLER E.: Visualizing Poincar´e maps together with the underlying flow. In
Mathematical Visualization (1998), Hege H.-C., POLTHIER
K., (Eds.), Springer Verlag, Berlin Heidelberg New York,
pp. 315–328.
[LMGP97] L¨OFFELMANN H., MROZ L., GRO¨ LLER E.,
PURGATHOFER W.: Stream arrows: Enhancing the use of
stream-surfaces for the visualization of dynamical systems. Visual Comput. 13, (1997), 359–369.
[MSWI03] MANCHO A. M., SMALL D., WIGGINS S., IDE K.:
Computation of stable and unstable manifolds of hyperbolic trajectories in two-dimensional, aperiodically timedependent vector fields. Physica D 182, (2003), 188–
222.

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

100

F. Sadlo & D. Weiskopf / Time-Dependent 2-D Vector Field Topology

[PS07] PEIKERT R., SADLO F.: Visualization Methods for
Vortex Rings and Vortex Breakdown Bubbles. In Proceedings of the 9th Eurographics/IEEE VGTC Symposium on
Visualization (EuroVis’07) (2007), pp. 211–218.
[PS08] PEIKERT R., SADLO F.: Height ridge computation
and filtering for visualization. In Proc. of Pacific Vis.
Symp. (2008), Fujishiro I., Li H., Ma K.-L., (Eds.),
pp. 119–126.
[PS09] PEIKERT R., SADLO F.: Flow topology beyond skeletons: visualization of features in recirculating flow. In
Topology-Based Methods in Visualization II (2009), Hege
H.-C., Polthier K., Scheuermann G., (Eds.), Springer,
Berlin Heidelberg, pp. 145–160.
[Sha05] SHADDEN S. C.: Lagrangian coherent structures
(2005). http://www.cds.caltech.edu/˜shawn/LCS-tutorial/
contents.html.
[SP07] SADLO F., PEIKERT R.: Efficient Visualization of Lagrangian Coherent Structures by Filtered AMR Ridge Extraction. IEEE Trans. Visual. Comput. Graph. 13, 5 (2007),
1456–1463.
[SP09] SADLO F., PEIKERT R.: Visualizing Lagrangian coherent structures and comparison to vector field topology. In
Topology-Based Methods in Visualization II (2009), Hege
H.-C., Polthier K., Scheuermann G., (Eds.), Springer,
Berlin Heidelberg, pp. 15–30.
[STM08] SONI B., THOMPSON D., MACHIRAJU R.: Visualizing
particle/flow structure interactions in the small bronchial

tubes. IEEE Trans. Visual. Comput. Graph. 14, 6 (2008),
1412–1427.
[TGK*04] TRICOCHE X., GARTH C., KINDLMANN G., DEINES
E., SCHEUERMANN G., RUETTEN M., HANSEN C.: Visualization of intricate flow structures for vortex breakdown
analysis. In Proc. IEEE Visualization ’04 (2004), pp. 187–
194.
[TWHS03] THEISEL H., WEINKAUF T., HEGE H.-C., SEIDEL
H.-P.: Saddle connectors—an approach to visualizing the
topological skeleton of complex 3-D vector fields. In Proc.
IEEE Visualization ’03 (2003), pp. 225–232.
[WHN*03] WEINKAUF T., HEGE H.-C., NOACK B., SCHLEGEL
M., DILLMANN A.: Coherent structures in a transitional flow
around a backward-facing step. Phys. Fluids 15, 9 (2003),
S3.
[WS01] WISCHGOLL T., SCHEUERMANN G.: Detection and
visualization of closed streamlines in planar flows.
IEEE Trans. Visual. Comput. Graph. 7, 2 (2001), 165–
172.
[WTS*07] WIEBEL A., TRICOCHE X., SCHNEIDER D.,
JAENICKE H., SCHEUERMANN G.: Generalized streak lines:
Analysis and visualization of boundary induced vortices. IEEE Trans. Visual. Comput. Graph. 13, 6 (2007),
1735–1742.
[YKP05] YE X., KAO D., PANG A.: Strategy for scalable
seeding of 3-D streamlines. In Proc. IEEE Visualization
’05 (2005), pp. 471–478.

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.


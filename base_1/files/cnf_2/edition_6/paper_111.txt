DOI: 10.1111/j.1467-8659.2009.01675.x
Eurographics/ IEEE-VGTC Symposium on Visualization 2010
G. Melançon, T. Munzner, and D. Weiskopf
(Guest Editors)

Volume 29 (2010), Number 3

A Maximum Enhancing Higher-Order Tensor Glyph
T. Schultz and G. Kindlmann
Computer Science Department and Computation Institute, University of Chicago, USA — {t.schultz,glk}@uchicago.edu

Abstract
Glyphs are a fundamental tool in tensor visualization, since they provide an intuitive geometric representation
of the full tensor information. The Higher-Order Maximum Enhancing (HOME) glyph, a generalization of the
second-order tensor ellipsoid, was recently shown to emphasize the orientational information in the tensor through
a pointed shape around maxima. This paper states and formally proves several important properties of this novel
glyph, presents its first three-dimensional implementation, and proposes a new coloring scheme that reflects peak
direction and sharpness. Application to data from High Angular Resolution Diffusion Imaging (HARDI) shows
that the method allows for interactive data exploration and confirms that the HOME glyph conveys fiber spread
and crossings more effectively than the conventional polar plot.
Categories and Subject Descriptors (according to ACM CCS): Computer Graphics [I.3.5]: Curve, surface, solid, and
object representation—Computer Graphics [I.3.8]: Applications—

1. Introduction
Due to their multivariate nature, tensors cannot be fully represented as grayscale or color values. Therefore, glyphs are
the standard tool to inspect the full information of individual
tensors. There exists a considerable choice of second-order
tensor glyphs for various applications: Specialized glyphs
emphasize different aspects of stress and strain tensors
[HYW03]. In Diffusion Tensor Magnetic Resonance Imaging (DT-MRI), ellipsoids are the most traditional type of
glyph [BMLB94], but more advanced glyphs based on composite shapes [WMK∗ 99] or superquadrics [Kin04] have
been constructed to overcome visual ambiguities that occur when projecting ellipsoids to the two-dimensional image
space. Similar glyphs have been used to illustrate the tensor
voting process [TTMM04] or selected properties of the Hessian near crease features [KSJESW09], and to visualize the
nematic liquid crystal alignment tensor [JKM06].

Figure 1: Polar plots (a) make it difficult to see the shape
and orientation of peaks, which is readily revealed by our
HOME glyphs (b). In applications like HARDI, algebraic
surfaces (c) are counter-intuitive.

Angular Resolution Diffusion Imaging (HARDI), it has
been referred to as a “parametrized surface” [ÖM03], the
“higher-order tensor glyph” [HS05], or the “HARDI glyph”
[PPvA∗ 09]. To differentiate it from our novel glyph, we
adopt the name “spherical polar plot” [Tuc04].

In contrast, a single glyph dominates the visualization
of higher-order tensors: namely, the surface whose distance
from the origin in each direction equals the value of the
homogeneous form in that same direction (Figure 1 (a)).
Despite its widespread use, this glyph lacks an established
name. It can be considered a generalization of the Reynolds
glyph [HYW03], but that name refers to the particular application to Reynolds stress tensors. In the context of High
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

As shown in Figure 1, the polar plot makes it difficult
to examine maxima of the homogeneous form: A perfectly
symmetric peak (left column) looks similar to an anisotropic
one, which is sharper in some directions than in others, and

1143

1144

T. Schultz and G. Kindlmann / A Maximum Enhancing Higher-Order Tensor Glyph

different orientations of anisotropic peaks are difficult to discern (middle and right column). However, such differences
play an important role in applications like HARDI, where
they indicate anisotropic fiber spread.
To overcome such problems, Schultz et al. [SWS09]
recently proposed the Higher-Order Maximum Enhancing
(HOME) glyph, which generalizes the second-order tensor ellipsoid. When applied to two-dimensional higher-order
tensors that arise in image processing, it has been shown to
depict maxima more clearly. In this paper, we turn this definition into a more general visualization tool by clarifying
its mathematical properties and the conditions under which
it can be used. We also present an optimized implementation that provides an efficient framework for interactive
exploration of three-dimensional higher-order tensors (Figure 1 (b)). Finally, we support identification and localization
of peaks by a new coloring scheme and present novel application examples on HARDI data.
The remainder of this paper is organized as follows: After reviewing related work in Section 2, we introduce the
Higher-Order Maximum Enhancing glyph and discuss its
formal properties in Section 3. In Sections 4 and 5, we treat
coloring by peaks and address implementation issues, respectively. Finally, applications to HARDI data are shown in
Section 6, before Section 7 concludes the paper and points
out possible directions of future research.

and vice versa (Figure 1 (c)), they are counter-intuitive in
applications like HARDI.
The commonly used tensor ellipsoid, whose half-axes are
aligned with the eigenvectors and scaled with the eigenvalues, is obtained by replacing T in Eq. (1) with its squared
inverse T−2 . Özarslan and Mareci [ÖM03] point out that
due to the lack of a suitable inverse, this formulation cannot
be transferred to higher-order tensors. Therefore, this paper
takes a different route to generalizing the tensor ellipsoid,
which was first proposed by Schultz et al. [SWS09].
3. Generalizing the Second-Order Tensor Ellipsoid
3.1. Notation
The coefficients Ti1 i2 ...il of an order-l tensor T with respect
to a given basis are indexed by l numbers. In this paper, we
are concerned with totally symmetric tensors, whose coefficients are invariant under arbitrary index permutations.
The inner product T · v between an order-l tensor T and
a vector v produces a tensor T of order (l − 1):
Ti1 i2 ...il−1 = Ti1 i2 ...il vil

In Eq. (2), the Einstein summation convention implies
summation over all values of the repeated index il . Performing the inner product l times (T ·l v) produces a scalar. This
mapping is called the homogeneous form F(v) of the tensor:
F(v) = T ·l v = Ti1 i2 ...il vi1 vi2 · · · vil

2. Related Work
Several previous authors have tried to visually emphasize
maxima in the polar plot: Tuch [Tuc04] visualizes a transformed tensor to emphasize peaks, while trying to avoid exaggerating noise-related features. Hlawitschka and Scheuermann [HS05] render the glyphs semi-transparently and add
arrows that point towards the maxima. Similarly, Descoteaux
et al. [DDKA09] use lines to indicate maxima. In our work,
the shape of the glyph itself is sharpened around the peaks,
making them visually more prominent. Perception of the
number and direction of maxima is further improved by a
new coloring scheme.
Other works have concentrated on interactive rendering
of the polar plot: Shattuck et al. [SCB∗ 08] precompute a
set of multi-resolution slice images suitable for exploration
over the internet. Peeters et al. [PPvA∗ 09] present a GPUbased ray casting approach. We found that, alternatively, a
relatively simple geometry-based approach allows for interactive data exploration.
A textbook by Strang [Str98] suggests to visualize a symmetric second-order tensor T by the quadratic surface
{v | vT Tv = 1}

(1)

Corresponding algebraic surfaces have been defined from
higher-order tensors by Qi [Qi06]. However, since maxima
in the homogeneous form lead to minima in these surfaces

(2)

(3)

There is a one-to-one mapping between symmetric tensors and their homogeneous forms [CM96], so the full tensor information is conveyed by plotting F(v). Traditionally,
this is done using the polar plot
p(v) = F(v)v

(4)

When rewriting v in spherical coordinates, the contribution of the radius r can be separated from the angular part
f (θ, φ) of the homogeneous form:
F(v(r, θ, φ)) = fˆ(r, θ, φ) = rl f (θ, φ)

(5)

Therefore, it is sufficient to plot p(v) for vectors on the
unit sphere ( v = 1). Some authors (including [PPvA∗ 09,
DDKA09]) prefer to express f (θ, φ) in a spherical harmonics basis of order l, with odd-order coefficients set to zero.
That basis defines the same space of functions on the sphere
as symmetric tensors, and the relation between the respective
coefficients is linear [ÖM03]. In this paper, we rely on tensor
notation, since it lends itself more easily to a generalization
of second-order tensor ellipsoids.
3.2. Generalizing Positive Definiteness
The second-order tensor ellipsoid is only applied to positive
definite tensors. A symmetric second-order tensor T is positive definite if its homogeneous form F(v) > 0 for all v = 0.
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

T. Schultz and G. Kindlmann / A Maximum Enhancing Higher-Order Tensor Glyph

1145

Figure 2: Sharp peaks can cause self-intersections in the
HOME glyph (b) even if the homogeneous form is positive,
as revealed by the polar plot (a). This problem cannot occur
if the tensor has a positive rank-1 decomposition.

Figure 3: The polar plot p(v) preserves the angles between
vectors v that are distributed uniformly over the unit circle
(a). In the tensor ellipse t(v) and the HOME glyph h(v), the
vectors are deflected towards maxima.

Alternatively, positive definiteness is defined by the fact that
all eigenvalues λi that occur in the spectral decomposition

h(v) generalizes Eq. (8) to symmetric tensors of even order
l. It transforms the unit circle under the mapping given by
(l − 1) applications of the inner tensor-vector product:

n

T=

∑ λi ei ⊗ ei

(6)

i=1

are larger than zero. Here, the eigenvectors ei form an orthonormal basis of the underlying vector space, and both
definitions of positive definiteness are equivalent.
Since tensors of odd order exhibit antipodal antisymmetry, F(−v) = −F(v), the notion of positive definiteness is
limited to even orders. Similar to symmetric second-order
tensors, symmetric higher-order tensors have a decomposition into a sum of rank-1 terms [CGLM08]:
r

T =

∑ λi ei ⊗ · · · ⊗ ei

i=1

(7)

l factors

In this case, the vectors ei can still be normalized to unit
length, but they no longer need to be pairwise orthogonal.
Consequently, a rank-1 decomposition with all λi > 0 is still
a sufficient, but no longer a necessary condition for a positive homogeneous form. Intuitively, negative terms can now
be balanced by non-orthogonal positive ones and still create
peaks which are so sharp that they cannot be expressed with
positive terms alone.
Therefore, in the higher-order case, a positive rank-1 decomposition is a stronger notion of positive definiteness than
a positive homogeneous form. For the HOME glyph, we will
impose this stronger condition. As illustrated by the selfintersection of the 2D HOME glyph in Figure 2 (b), F(v) > 0
is not sufficient to guarantee that the glyph is well-behaved.
The reasons for this will become clear in the formal treatment of the glyph properties in Appendix A.
3.3. Definition and Properties of the Glyph
The standard ellipsoid t(v) for symmetric second-order tensors T can be expressed as the transformation of the unit
sphere under the linear mapping defined by T:
t(v) = T · v

with v = 1

(8)

The Higher-Order Maximum Enhancing (HOME) glyph
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

h(v) = T ·l−1 v

with v = 1

(9)

The polar plot is related to the HOME glyph through
p(v) = (h(v) · v)v. Based on two-dimensional experiments
in [SWS09], it has been conjectured that at stationary points
of the homogeneous form (i.e., points at which the derivative
f ′ vanishes), the following properties hold:
1. The polar plot and the HOME glyph coincide.
2. For both glyphs, the distance to the origin is extremal.
3. The HOME glyph has sharper maxima, while minima are
more pronounced in the polar plot.
Intuitively, this is explained by the observation that at nonstationary points, h(v) deflects the input vector v towards a
maximum in the homogeneous form. This is also the basis
of the power method for finding the largest eigenvector of
a matrix, and its generalization to higher-order tensors with
a definite homogeneous form [KR02]. When implementing
the glyph by deforming a uniformly tesselated sphere, as
described in Section 5, it automatically concentrates mesh
vertices in the high-curvature regions around sharp peaks.
Figure 3 illustrates this in 2D, both for a matrix and a fourthorder tensor.
To formalize these results, and to transfer them to three
dimensions, we express v in spherical coordinates to obtain
a parametrization of the polar plot p and the HOME glyph h
in terms of θ and φ. Let hθ and hφ denote partial derivatives
of this surface parametrization, fθ and fφ partial derivatives
of the angular part of the homogeneous form. The principal
curvatures of h are given as κh1 and κh2 . By the convention
in [Top06], maxima have negative principal curvatures.
With this, the three properties of the HOME glyph can be
formalized as follows: If fθ (θ, φ) = fφ (θ, φ) = 0,
1. p(θ, φ) = h(θ, φ).
2. ∂ p(θ, φ) /∂θ = ∂ p(θ, φ) /∂φ = ∂ h(θ, φ) /∂θ =
∂ h(θ, φ) /∂φ = 0.
p
3. if f (θ, φ) = 0, f θθ (θ, φ) = 0, and fφφ (θ, φ) = 0, then κ1 >
p
h
h
κ1 and κ2 > κ2 .

1146

T. Schultz and G. Kindlmann / A Maximum Enhancing Higher-Order Tensor Glyph

Figure 4: Coloring based on surface partitioning (b) conveys the number and direction of maxima more clearly
than simple rainbow coloring (a). An additional smoothing
step (c) blurs the boundaries between regions.

Establishing these properties ensures that the HOME
glyph reproduces extrema of the homogeneous form, and
that maxima are indeed sharper than in the polar plot. A formal proof is provided in Appendix A.
4. Coloring by Peaks
Since the full tensor information is expressed in the glyph
geometry alone, it is up to the individual application to use
color or texture to emphasize specific properties of the tensor
field, or to encode additional information.
In diffusion imaging, the degree of anisotropy and the orientation of the tensor are especially relevant, so they are frequently used to determine the color of the glyph. It is customary to employ an XYZ-RGB color coding of the principal direction, in which the spatial x, y, and z axes are mapped
to the red, green, and blue color channel, respectively. In this
section, we will transfer this way of supporting the perception of tensor orientation with color to higher-order tensors.
4.1. Partitioning of the Glyph Surface
Higher-order tensors may have more than one peak, so it is
no longer possible to indicate a single direction by a uniform color. A common trick is to instead color each surface
point individually, based on the vector to the center of the
glyph [Tuc04, TCGC04, PPvA∗ 09]. If the glyph has narrow
and clearly separated lobes, this simple scheme often colors
each of them approximately uniformly. However, it fails if
the tensor has a rounder shape. For example, the color green
is dominant in Figure 4 (a) only because the glyph is viewed
from the y direction—there is no maximum in that direction.
Therefore, we propose a coloring based on an explicit partitioning of the surface, in which surface points are grouped
together if the same maximum is reached from them when
following a gradient ascent. Then, each maximum determines the color for its whole region of influence. In the terminology of Morse-Smale complexes [EHNP03], our partitions resemble descending manifolds. However, we refrain
from depicting saddles, since they are not considered as relevant features in the context of HARDI.
XYZ-RGB coloring accounts for the antipodal symmetry F(v) = F(−v) of even-order tensors by assigning the
same color to antipodal peaks. Unfortunately, additional,

non-antipodal peaks might also receive the same color. We
use XYZ-RGB despite this fact, since it is widely accepted
by radiologists and domain scientists, and it can be shown
that any coloring that avoids this problem will exhibit undesirable discontinuities [PP99].
The exact boundaries of the individual regions are less
important, and sharp edges would draw undue attention to
them (Figure 4 (b)). Therefore, we perform a small amount
of smoothing to blur these transitions (Figure 4 (c)).
4.2. Modulation by Peak Sharpness
In case of a second-order tensor T, XYZ-RGB colors are
generally modulated by a measure of linearity in order to
avoid indicating a principal direction when it is not clearly
defined. One common measure is Westin’s cl [WMK∗ 99],
defined from sorted eigenvalues λ1 ≥ λ2 ≥ λ3 :
cl =

λ1 − λ2
λ1

(10)

In general, the magnitude of the second derivatives is an
indicator of how well-localized a maximum of a function is.
For an order-l tensor T , the Hessian H(v) of the homogeneous form F(v) at v is given as
H(v) = l(l − 1) T ·l−2 v

(11)

Since we are interested in the restriction of F(v) to the
unit sphere, we express v in spherical coordinates such that
e1 = ∂v(θ, φ)/∂θ and e2 = ∂v(θ, φ)/∂φ are orthonormal tangents at the peak. We then look for the Hessian Hθφ of the
spherical function f (θ, φ). It can be computed by stacking
e1 and e2 into the columns of a 3 × 2 matrix P. Then, the
Hessian Hθφ at a stationary point of f (θ, φ) is given as
Hθφ = PT HP − l f (θ, φ)I

(12)

where I denotes a 2 × 2 identity matrix. A derivation of this
Equation is given in Appendix B.
Let µi be the eigenvalues of Hθφ . At a maximum, µ2 ≤
µ1 ≤ 0. How well a peak is localized depends on the less
sharp direction, given by µ1 . As part of Appendix A, it
is shown that if the tensor has a positive decomposition,
µ1 ≥ −l f (θ, φ) (Eq. (19)). Therefore, µ1 can be converted
into a peak sharpness measure PS ∈ [0, 1] by normalizing it
as follows:
−µ1
(13)
PS =
l f (θ, φ)
Figure 5 presents two examples in which the peak sharpness measure is used to modulate the saturation of XYZRGB colors. In (a), the maxima on an almost-planar fourthorder tensor are desaturated strongly. At the same time, the
sharp peaks in (b) retain their saturated colors. Despite the
fact that saturation varies in the XYZ-RGB colors already,
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

T. Schultz and G. Kindlmann / A Maximum Enhancing Higher-Order Tensor Glyph

Tensor order
4
6
Figure 5: Color modulation decreases the saturation at
broad peaks that lack a clear direction (a). Sharp peaks (b)
are still marked by highly saturated colors.

we modulate saturation rather than brightness because dark
colors would make it difficult to appreciate glyph shapes.
At the maximum of a second-order tensor, f (θ, φ) = λ1
and µ1 = 2(λ2 − λ1 ). Thus, peak sharpness coincides with
cl from Eq. (10) for order l = 2. However, cl characterizes
a second-order tensor as a whole, while PS is specific to a
particular peak of a higher-order tensor.
Note that we use the name peak sharpness rather than peak
anisotropy, since the latter term has been used to denote the
degree to which the sharpness of a peak varies as a function
of the direction in its tangent plane [KKA07, SCH∗ 07].

Polar Plot
68 ms (202 ms)
76 ms (231 ms)

1147
HOME glyph
70 ms (224 ms)
86 ms (274 ms)

Table 1: Time needed to generate 5577 glyphs, on a quadcore and on a single-core CPU (in brackets).

v, our tesselation also contains the antipodal point −v. Thus,
we only need to compute the transformed positions for half
of the vertices and may scale them by −1 to obtain the other
half. Moreover, all glyphs are independent from each other,
which makes it straightforward to generate them in parallel
on modern multi-core CPUs.
Table 1 summarizes the time it takes to generate 5577
glyphs with 642 vertices each from an axial slice of HARDI
data on a 2.67 GHz Intel Xeon Quad-Core, for different
tensor orders and glyph types. The timings include discrete
normal estimation [Tau95]. Even when restricting our implementation to a single CPU core, it creates approximately
27600 glyphs per second. Compared to the 1.15 glyphs per
second reported for the same refinement level in [PPvA∗ 09],
this amounts to a speedup of factor 24000.

5. Interactive Implementation
Our implementation allows for interactive data exploration,
even though it is based on standard triangle meshes, along
with a few simple optimizations. This may seem surprising
in the light of previous work, which used GPU programming
for interactive ellipsoid splatting [Gum03] and ray casting of
ellipsoids [SWBG06] and polar plots [PPvA∗ 09].
However, unlike in molecule visualization [SWBG06],
where the information mainly lies in the spatial relation
of the displayed atoms, the utility of tensor glyphs hinges
on the discernability of their individual shapes, which requires a larger size in image space. Consequently, the number of geometric objects is generally lower in tensor visualization than in molecule visualization. Moreover, we found
the geometry-based implementations used for comparison in
part of the literature [PPvA∗ 09] to be highly inefficient.

5.2. Coloring
To implement the segmentation-based coloring from Section 4, each local maximum is assigned an XYZ-RGB color,
with the saturation modulated according to peak sharpness
(Eq. (13)). Then, we move from each uncolored vertex to
the neighbor that is furthest from the origin and repeat this
recursively until a colored vertex is met. The resulting color
is copied to the original vertex and all vertices on the path.
This procedure is iterated until no uncolored vertices are left.
In a second pass, the color of each vertex is blended with
the colors on its one-ring. For efficiency, we perform simple
averaging in RGB space. Coloring the above 5577 glyphs in
this way takes 60 ms (210 ms on a single CPU core).
5.3. Efficient Rendering

5.1. Creating the Geometry
Both the polar plot and the HOME glyph can be expressed as
deformed spheres, which we approximate by refined icosahedra. In each refinement step, each edge is bisected at
its center, thus subdividing each triangle into four smaller
ones. New vertices are projected back to the surface of the
sphere. To faithfully represent tensors of orders four and
six, we use three subdivision steps, generating 642 vertices
on the sphere. This corresponds to “tesselation order 7” in
[PPvA∗ 09].

While exploring a tensor dataset, the user typically either
looks at a large-scale overview for orientation, or zooms into
a part of the data to examine individual tensors. In the first
case, each glyph is projected to a small area on the screen,
so coarser tesselations can be used without a visible degradation of image quality. In the second case, only a small number of glyphs is rendered at the same time. Two common
acceleration methods exploit this situation: The use of different levels of detail, and culling of objects that fall outside
the current view frustum.

Once a suitable triangulation of the sphere is given, glyphs
are generated by evaluating Eq.s (4) or (9), respectively. To
speed up this process, we exploit the fact that for each vertex

We use bounding spheres to implement both techniques.
Their radius is given by the global maximum of the homogeneous form, as found during glyph generation. First, glyphs

c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

1148
# Glyphs
5577
5577
12846
12846

T. Schultz and G. Kindlmann / A Maximum Enhancing Higher-Order Tensor Glyph

# in Level of Detail
Low
High
5577
0
0
477
12846
0
299
2786

Framerate
88 fps (34 fps)
>100 fps (72 fps)
41 fps (15 fps)
42 fps (14 fps)

Table 2: Framerates at different stages of navigation in a
tensor dataset, with and without (in brackets) VBOs.

Figure 6: Even when the polar plot hardly shows a difference between the original ODF and a positive rank-k approximation (a), this step is indispensible for an intersectionfree visualization of HOME glyphs (b).

outside the viewport are culled by computing signed distances of their center to the six planes that bound the view
frustum: If the point is outside and its distance is larger than
the radius of the bounding sphere, then the glyph is discarded
without further processing.

Unlike diffusion tensors, spherical deconvolution ODFs
do not model a physical process. Rather, they describe a
fiber distribution which is inferred from the acquired diffusion weighted images (DWIs) based on a particular model of
the signal that arises from a single fiber bundle.

A high and a low level of detail are given by three and
two refinements of the icosahedron, respectively. This way,
only one set of vertices has to be kept for each glyph, and the
coarser version simply uses a subset of them. The level of detail is chosen based on the projected radius of the bounding
sphere. A simple and efficient formula for its approximative
computation under perspective projections is derived in Section 3.2 of [LRC∗ 03].
During interactive exploration, the same glyphs are typically rendered many times, from varying positions. In this
case, OpenGL Vertex Buffer Objects (VBOs) can be used to
keep glyph geometry in video memory. Setting up VBOs for
5577 glyphs takes 55 ms, but speeds up the rendering itself
by a factor of ≈ 2.5.
Rendering performance on a 1800 × 1000 viewport using
an NVIDIA Quadro FX 1800 is summarized in Table 2. The
results correspond to a single slice of HARDI data, and to
three orthogonal slices, both at an overview and a zoomedin level. Even though creating HOME glyphs takes slightly
longer than creating polar plots, and order 6 requires more
computations than order 4, the rendering of all glyphs is
equally efficient. Due to differences in graphics hardware
and because the viewport size is not specified, an exact comparison to [PPvA∗ 09] is not possible. However, our results
are approximately three orders of magnitude faster than reported for their geometry-based implementation and compare favorably to their ray-tracing based results.
6. Application to HARDI
In High Angular Resolution Diffusion Imaging (HARDI),
there exist different types of spherical functions that can
be represented as higher-order tensors. The sharpest of
them are created by spherical deconvolution [TCGC04]
or, equivalently, the “sharpening deconvolution transform”
[DDKA09]. In our examples, we focus on orientation density functions (ODFs) that arise from this technique. Therefore, we demonstrate an additional visual sharpening, after a
sharpening on the data itself has already been performed.

6.1. Enforcing a Positive Decomposition
Conceptually, spherical deconvolution ODFs can be expected to meet the positive decomposition assumption from
Section 3.2. When using a deconvolution kernel that maps
the single fiber response to a rank-1 tensor (as in [SS08]),
ODFs that do not possess a positive decomposition correspond to fiber densities that contain negative fiber contributions, which do not make sense anatomically.
In practice, ODFs are not even non-negative, which is
commonly attributed to noise. Therefore, we approximate
them with a positive sum of rank-1 terms before visualization. This step is analogous to the clamping of negative lobes
in the polar plot, which is common in the spherical deconvolution literature [TCGC04].
To perform the positive rank-k approximation, we make
two modifications to the algorithm proposed in [SS08]: First,
we replace the heuristic for estimating the number of crossing fibers with a rule that accepts a rank-k approximation if,
compared to the previous rank-(k − 1) approximation, it decreases the norm of the residual by more than ε times the
original tensor norm. Second, we ensure that only positive
rank-1 terms are added.
In most cases, this approximation only leaves a small
residual, and the clamped polar plot of the result looks almost identical to the original ODF (cf. Figure 6 (a)). However, using the approximation avoids confusing and misleading self-intersections in the HOME glyph, like they become
apparent in 2D in Figure 2(b) and in 3D by the presence of
unlit backfaces on the left hand side of Figure 6(b).
Spherical deconvolution ODFs were estimated from
60 DWIs at b = 1000 s/mm2 . Figure 7 shows a detail of a
coronal slice, at the transition between corpus callosum and
pyramidal tract. The top row uses polar plots with clamped
negative lobes, the bottom row shows HOME glyphs after
positive approximation, with the coloring from Section 4.
Two high-resolution images in the supplementary material
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

T. Schultz and G. Kindlmann / A Maximum Enhancing Higher-Order Tensor Glyph

1149

Figure 7: Fourth-order tensors from a HARDI dataset. The
relatively flat appearance of the HOME glyphs (bottom) with
respect to the polar plot (top) conveys the fact that the displayed fiber distributions stay mostly within the image plane.

of this paper provide a whole-slice comparison of our novel
glyph-based visualization against the state of the art.
In order to determine which glyph conveys the properties
of fiber distributions more effectively, we will first consider
a number of synthetic examples, for which the underlying
fiber configurations are known, before we return to real data.

shown both from the side and by looking orthogonally onto
the peak, to maximize the impression of peak anisotropy.

6.2. Inspecting Fiber Spread
In addition to inferring dominant fiber directions, spherical
deconvolution enables conclusions about fiber spread, i.e.,
the variance around the main direction. Fiber spread is often
stronger in some principal direction than orthogonal to it,
and it has been proposed that exploiting such information
can reduce the leakage of probabilistic tractography methods
into anatomically implausible regions [SCH∗ 07].
Anisotropic fiber spread has been modeled using the
Bingham distribution [KKA07, SCH∗ 07]:
p(v, B) =

1 vT Bv
e
C(B)

Figure 8: Sixth-order tensors showing a fiber with small,
larger, and anisotropic spread (from left to right). The
HOME glyphs (bottom) make it much easier to distinguish
these cases than the polar plot (top).

(14)

where B is a symmetric 3 × 3 matrix with eigenvalues λ1 ≥
λ2 ≥ λ3 and corresponding eigenvectors e1 , e2 , e3 , and C(B)
is a constant that makes p(v, B) integrate to unity over the
unit sphere. We set λ1 = 0, since p(v, B) is invariant under
addition of any real constant to the eigenvalues of B. Then,
e1 is the dominant fiber direction, e2 is the principal direction
of fiber spread, and the magnitudes of λ2 and λ3 define the
amount and anisotropy of fiber spread.
To produce a synthetic model of a spreading fiber, we have
drawn 1000 samples on the sphere uniformly at random and
generated a single fiber model for each of them, weighted
according to the Bingham distribution. From this mixture,
we then created 60 DWIs at b = 1000 s/mm2 and estimated
a linear spherical deconvolution model of order six.
From left to right, Figure 8 shows fiber spread with λ2 =
λ3 = −15 (small and isotropic), λ2 = λ3 = −7.5 (larger
and isotropic), and λ2 = −5, λ3 = −15 (anisotropic), respectively. Polar plots (top) and HOME glyphs (bottom) are
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

In the polar plot, the width of the lobe grows with the magnitude of its peak. Since less fiber spread leads to a larger
density at the dominant direction, the lobe becomes wider as
fiber spread decreases, which is counter-intuitive. This problem does not occur in the HOME glyph, where higher variance around the main direction leads to a wider peak. Moreover, the polar plot makes it very difficult to appreciate the
spread anisotropy, whereas the aspect ratio of the lobe of the
HOME glyph is close to the ratio of λ2 /λ3 .
6.3. Inspecting Fiber Crossings
Since it is known that ODF maxima present a biased estimate
of fiber directions in case of crossings [TCGC04, SS08], it
may appear problematic to use a maximum enhancing glyph
for ODFs. To examine this potential problem, we created
DWIs of synthetic fiber crossings at varying angles and volume fractions, and again estimated spherical deconvolution
models of order six.
Figure 9 compares the resulting ODFs to the fiber directions used in the simulation (gray lines). ODF maxima
are highlighted by colored cylinders. It becomes clear that
the HOME glyph only develops very sharp, pin-like lobes
when maxima are well-separated (left, 78◦ crossing). In such
cases, little bias occurs. As the angle becomes smaller, bias
increases, but maxima are emphasized less.
The lobe of the HOME glyph on the right (60◦ crossing)
exhibits a steep slope, tangential to the true fiber directions.
This is also true for other crossing angles and tensor orders,
and is understood by the fact that given a rank-1 decomposition in the form of Eq. (7), the HOME glyph of an order-l

1150

T. Schultz and G. Kindlmann / A Maximum Enhancing Higher-Order Tensor Glyph

Figure 10: In real data (order six), sharp peaks of the
HOME glyph (a) correspond well to rank-1 terms. Wide
lobes can be interpreted as fiber spread (b) or as unresolved
crossings (c).

7. Conclusion and Future Work
Figure 9: Results on synthetic crossings show that sharp
peaks of the HOME glyph (left) are well-aligned with
true fiber directions (gray lines). When maxima are biased
(right), glyph shape emphasizes them less.

tensor can be re-written as
r

h(v) =

∑ λi (v · ei )l−1 ei

(15)

i=1

In case of a two-fiber crossing, r = 2, e1 and e2 are the
fiber directions (unit-length, but not necessarily orthogonal),
and λ1 and λ2 reflect their respective volume fractions. In
Eq. (15), the contribution of e1 is weighted by cos(φ)l−1 ,
where φ is the angle between v and e1 . Obviously, any vector
v ⊥ e1 is projected unto e2 . However, not only is the weight
of e1 zero, but also the first l − 2 derivatives of this weight
with respect to φ. Thus, h(v) deviates from the direction of
e2 only very slowly as φ increases. This leads to the good
agreement of the glyph shape with the true fiber direction.
On real data, we compared glyph shape to the rank-k approximation from [SS08], which provides unbiased fiber estimates. In this case, we use cylinders to indicate rank-1
terms rather than ODF maxima, and scale their length with
relative volume fractions. In these experiments, sharp peaks
of the HOME glyph corresponded well to terms of the approximation (Figure 10 (a)).
A priori, it is unclear if wide ODF lobes (Figures 10 (b)
and (c)) are due to high fiber spread or to a crossing that has
not been resolved by the measurement or the model. Varying
the parameters of the approximation allows one to explore
both options. We expect that such a combined visualization
of ODFs and inferred fiber directions over a region of interest will help to find parameters for model selection that produce coherent and anatomically plausible fiber directions.

The one-to-one relation between ellipsoids and positive definite second-order tensors provides a well-established way
of reasoning about these abstract mathematical objects in
a graphic and intuitive way. In this work, we have studied
the Higher-Order Maximum Enhancing (HOME) glyph, a
recent generalization of ellipsoids to higher-order tensors
[SWS09]. Our theoretical contributions are a formal proof
of its properties and a clarification of the exact conditions
under which it can be applied.
Even though the mathematical proofs may appear intimidating, implementing the new glyph is almost as simple as
for the polar plot. Contrary to previous findings [PPvA∗ 09],
we have demonstrated that relatively simple optimizations
allow triangle-based implementations to remain interactive
up to several ten thousands of glyphs.
Finally, we have made contributions to a particular application, the visualization of data from High Angular Resolution Diffusion Imaging (HARDI). We have transferred the
traditional way of coloring diffusion ellipsoids to higherorder tensor models. In a side-by-side comparison to the
state of the art, we have demonstrated that the HOME glyph
visualizes situations of fiber spread and crossings more effectively than the polar plot that has been used previously.
When discussing our results with a domain scientist, the
expert found our approach of assigning colors based on peak
directions beneficial and emphasized the importance of interactive glyph-based visualizations for analyzing orientation density functions.
We expect that the HOME glyph will prove helpful both
for the exploration of data that can be modelled with higherorder tensors and to clarify more general mathematical properties of higher-order tensors. As part of our future work, we
are interested in finding scalar invariants that parametrize the
shape of our glyph in an intuitive way.
Acknowledgements
We would like to thank Alfred Anwander (Max Planck Institute for Human Cognitive Brain Science, Leipzig, Gerc 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

1151

T. Schultz and G. Kindlmann / A Maximum Enhancing Higher-Order Tensor Glyph

many) for providing the HARDI dataset and giving feedback on our results. Our implementation makes use of Teem
(teem.sf.net). This work was supported by a fellowship
within the Postdoc Program of the German Academic Exchange Service (DAAD).

The homogeneous form Fi of an individual rank-1 term
can be written as Fi (v) = fi (ξ) = λi cosl (ξ),
Ti = λi v⊗l
i
where ξ denotes the angle between v and vi . Since
fi′′ (ξ) = λi −l cosl (ξ) + l(l − 1) cosl−2 (ξ) sin2 (ξ) , (20)
it follows that

Appendix A: Proof of the HOME Glyph Properties
This appendix uses fundamental concepts from differential
geometry [Top06] to prove the three properties of the HOME
glyph which were stated in Section 3.3. For this, we express
p(v) from Eq. (4) and h(v) from Eq. (9) in the parametric
form that results from writing v in spherical coordinates:


sin(θ) cos(φ)
p(θ, φ) = f (θ, φ)  sin(θ) sin(φ) 
(16)
cos(θ)
The convention in this paper is to use θ ∈ [0, π] as the
inclination from the positive z axis, and φ ∈ [0, 2π) as the
azimuth angle from the positive x axis.
Standard calculus confirms that
1
(17)
T ·l−1 v = ∇F(v)
l
where F is the homogeneous form of the tensor T (Eq. (3)).
We write F in spherical coordinates (cf. fˆ in Eq. (5)) and
compute its gradient in Cartesian coordinates via the chain
rule. This involves partial derivatives ∂{r, θ, φ}/∂{x, y, z},
which can be taken from handbooks like [BSMM04] or from
computer algebra software. We observe from Eq. (5) that
∂ fˆ(r, θ, φ)/∂r = lrl−1 f (θ, φ) and fix r = 1 to obtain
h(θ, φ) = p(θ, φ)

sin(φ) 
fθ (θ, φ) cos(θ) cos(φ) − fφ (θ, φ) sin(θ)
1

+  fθ (θ, φ) cos(θ) sin(φ) + fφ (θ, φ) cos(φ) 
sin(θ)
l
− fθ (θ, φ) sin(θ)

Under these conditions, p = h = ( f , 0, 0) , so the first
property follows immediately. The equations for the first
derivatives of p and h are pθ = (0, 0, − f )T , pφ = (0, f , 0)T ,
hθ = (0, 0, − f − fθθ /l)T , and hφ = (0, f + fφφ /l, 0)T . From
this, it is clear that p · pθ = p · pφ = h · hθ = h · hφ = 0, which
proves property two.
In order to compute principal curvatures, we need to determine the normal vector, nh = hθ ×hφ / hθ ×hφ . For this,
we will first show that
f + fφφ /l ≥ 0.

(21)

According to Section 3.2, we assume that the given tensor
can be written as a sum of rank-1 terms with positive λi ,
so Eq.s (19) hold by linearity of the derivative. Therefore,
nh = (1, 0, 0)T .
At the stationary point, the coefficients of the first (E, F,
G) and second fundamental forms (L, M, N) are:
Ep = f 2

Fp = 0

Gp = f 2

Lp = fθθ − f

Mp = 0

Np = fφφ − f

Eh = ( f + fθθ /l)2

Fh = 0

l −2
f −f
l θθ

Mh = 0

Gh = f + fφφ /l
l −2
f −f
Nh =
l φφ

Lh =

2

Since the eigensystems of all fundamental forms coincide,
it is simple to compare corresponding principal curvatures.
In case of direction θ, the condition for property three reads
l−2
fθθ − f
fθθ − f
> l
.
2
f
( f + fθθ /l)2

(22)

Straightforward simplification transforms this into
2
/l 2 > 0. Using Eq. (21), it is easy to
((2l − 1) f + fθθ ) fθθ
verify that for f > 0 and fθθ = 0, the condition in Eq. (22)
indeed holds. Direction φ is treated in complete analogy.
This concludes the proof of property three.
Appendix B: Hessian in Spherical Coordinates

T

and

λi > 0.

(18)

Without loss of generality, we choose the coordinate system such that the stationary point under investigation is at
(θ = π/2, φ = 0). For brevity, omitting function parameters
θ and φ will imply function evaluation at that point, and
we will omit the terms fθ = fφ = 0 completely. Moreover,
we rotate the coordinate system such that the mixed second
derivatives of f vanish ( fθφ = fφθ = 0).

− f − fθθ /l ≤ 0

fi′′ (ξ)/l ≥ − f (ξ) if

(19)

c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

We obtain second derivatives of the spherical function
f (θ, φ) from the easy-to-compute Hessian H of the homogeneous function F(v) (Eq. (11)) by expressing v in spherical
coordinates, and applying the chain rule to compute
∂v
∂ f (θ, φ) ∂F(v(r, θ, φ))
=
= ∇F(v) ·
∂θ
∂θ
∂θ

(23)

Taking the second derivative requires both the chain rule
and the product rule:
∂2 F(v(r, θ, φ)) ∂vT ∂v
∂2 v
=
H + ∇F(v) ·
∂θ ∂φ
∂θ ∂φ
∂θ ∂φ

(24)

The other second derivatives are given in complete analogy. Since we chose coordinates such that v, e1 = ∂v/∂θ
and e2 = ∂v/∂φ form an orthonormal basis, ∂2 v/(∂θ)2 =
∂2 v/(∂φ)2 = −v and ∂2 v/(∂θ ∂φ) = 0. From property one
of the HOME glyph and Equation (17), it is clear that at
stationary points of f (θ, φ), ∇F(v) · v = lF(v). Therefore,
collecting all second derivatives in Hθφ results in Eq. (12).

1152

T. Schultz and G. Kindlmann / A Maximum Enhancing Higher-Order Tensor Glyph

References
[BMLB94] BASSER P. J., M ATTIELLO J., L E B IHAN D.: MR
diffusion tensor spectroscopy and imaging. Biophysical Journal
66, 1 (1994), 259–267.
[BSMM04] B RONSHTEIN I., S EMENDYAYEV K. A., M USIOL
G., M UEHLIG H.: Handbook of mathematics. Springer, 2004.
[CGLM08] C OMON P., G OLUB G., L IM L.-H., M OURRAIN B.:
Symmetric tensors and symmetric tensor rank. SIAM Journal on
Matrix Analysis and Applications 30, 3 (2008), 1254–1279.
[CM96] C OMON P., M OURRAIN B.: Decomposition of quantics in sums of powers of linear forms. Signal Processing 53, 2
(1996), 96–107.
[DDKA09] D ESCOTEAUX M., D ERICHE R., K NÖSCHE T. R.,
A NWANDER A.: Deterministic and probabilistic tractography
based on complex fibre orientation distributions. IEEE Transactions on Medical Imaging 28, 2 (2009), 269–286.
[EHNP03] E DELSBRUNNER H., H ARER J., NATARAJAN V.,
PASCUCCI V.: Morse-smale complexes for piecewise linear 3manifolds. In Proc. 19th Ann. Sympos. Comput. Geom. (2003),
pp. 361–370.
[Gum03] G UMHOLD S.: Splatting illuminated ellipsoids with
depth correction. In Proc. Vision, Modelling, and Visualization
(VMV) (2003), pp. 245–252.
[HS05] H LAWITSCHKA M., S CHEUERMANN G.: HOT-lines:
Tracking lines in higher order tensor fields. In Proc. IEEE Visualization (2005), Silva C., Gröller E., Rushmeier H., (Eds.),
pp. 27–34.
[HYW03] H ASHASH Y. M. A., YAO J. I.-C., W OTRING D. C.:
Glyph and hyperstreamline representation of stress and strain tensors and material constitutive response. Int. J. Numerical and
Analytical Methods in Geomechanics 27 (2003), 603–626.
[JKM06] JANKUN -K ELLY T. J., M EHTA K.: Superellipsoidbased, real symmetric traceless tensor glyphs motivated by nematic liquid crystal alignment visualization. IEEE Transactions
on Visualization and Computer Graphics (Proc. IEEE Visualization) 12, 5 (2006), 1197–1204.
[Kin04] K INDLMANN G.: Superquadric tensor glyphs. In
EG/IEEE Symposium on Visualization (SymVis) (2004), pp. 147–
154.
[KKA07] K ADEN E., K NÖSCHE T. R., A NWANDER A.: Parametric spherical deconvolution: Inferring anatomical connectivity using diffusion MR imaging. NeuroImage 37 (2007), 474–
488.
[KR02] KOFIDIS E., R EGALIA P. A.: On the best rank-1 approximation of higher-order supersymmetric tensors. SIAM Journal
on Matrix Analysis and Applications 23, 3 (2002), 863–884.
[KSJESW09] K INDLMANN G., S AN J OSÉ E STÉPAR R., S MITH
S. M., W ESTIN C.-F.: Sampling and visualizing creases with
scale-space particles. IEEE Transactions on Visualization and
Computer Graphics (Proc. IEEE Visualization) 15, 6 (2009),
1415–1424.
[LRC∗ 03] L UEBKE D., R EDDY M., C OHEN J. D., VARSHNEY
A., WATSON B., H UEBNER R.: Level of detail for 3D graphics.
Morgan Kaufmann, 2003.
[ÖM03] Ö ZARSLAN E., M ARECI T.: Generalized diffusion tensor imaging and analytical relationships between diffusion tensor
imaging and high angular resolution diffusion imaging. Magnetic
Resonance in Medicine 50 (2003), 955–965.

ˇ
V., VAN A LMSICK M.,
[PPvA∗ 09] P EETERS T., P R CKOVSKA
V ILANOVA A., TER H AAR ROMENY B.: Fast and sleek glyph
rendering for interactive HARDI data exploration. In Proc. IEEE
Pacific Visualization Symposium (2009), pp. 153–160.

[Qi06] Q I L.: Rank and eigenvalues of a supersymmetric tensor, the multivariate homogeneous polynomial and the algebraic
hypersurface it defines. Journal of Symbolic Computation 41
(2006), 1309–1327.
[SCB∗ 08] S HATTUCK D. W., C HIANG M.-C., BARYSHEVA M.,
M C M AHON K. L., DE Z UBICARAY G. I., M EREDITH M.,
W RIGHT M. J., T OGA A. W., T HOMPSON P. M.: Visualization tools for high angular resolution diffusion imaging. In Proc.
Medical Image Computing and Computer-Assisted Intervention
(MICCAI) (2008), Metaxas et al. D., (Ed.), vol. 5242 of LNCS,
Springer, pp. 298–305.
[SCH∗ 07]

S EUNARINE K. K., C OOK P. A., H ALL M. G., E M K. V., PARKER G. J. M., A LEXANDER D. C.: Exploiting peak anisotropy for tracking through complex structures. In
Proc. IEEE Workshop Mathematical Methods in Biomedical Image Analysis (MMBIA) (2007), pp. 1–8.
BLETON

[SS08] S CHULTZ T., S EIDEL H.-P.: Estimating crossing fibers:
A tensor decomposition approach. IEEE Transactions on Visualization and Computer Graphics (Proc. IEEE Visualization) 14, 6
(2008), 1635–1642.
[Str98] S TRANG G.: Linear algebra and its applications, 3rd ed.
Harcourt Brace Jovanovich, 1998.
[SWBG06] S IGG C., W EYRICH T., B OTSCH M., G ROSS M.:
GPU-based ray-casting of quadratic surfaces. In Proc. EG Symposium on Point-Based Graphics (2006), pp. 59–65.
[SWS09] S CHULTZ T., W EICKERT J., S EIDEL H.-P.: A higherorder structure tensor. In Visualization and Processing of Tensor
Fields – Advances and Perspectives, Laidlaw D. H., Weickert J.,
(Eds.). Springer, 2009, pp. 263–280.
[Tau95] TAUBIN G.: Estimating the tensor of curvature of a surface from a polyhedral approximation. In Proc. Fifth International Conference on Computer Vision (ICCV) (1995), pp. 902–
907.
[TCGC04] T OURNIER J.-D., C ALAMANTE F., G ADIAN D. G.,
C ONNELLY A.: Direct estimation of the fiber orientation density function from diffusion-weighted MRI data using spherical
deconvolution. NeuroImage 23 (2004), 1176–1185.
[Top06] T OPONOGOV V. A.: Differential Geometry of Curves
and Surfaces. A Concise Guide. Birkhäuser, 2006.
[TTMM04] T ONG W.-S., TANG C.-K., M ORDOHAI P.,
M EDIONI G.: First order augmentation to tensor voting for
boundary inference and multiscale analysis in 3D. IEEE Trans.
on Pattern Analysis and Machine Intelligence 26, 5 (2004),
594–611.
[Tuc04] T UCH D. S.: Q-Ball imaging. Magnetic Resonance in
Medicine 52 (2004), 1358–1372.
[WMK∗ 99] W ESTIN C.-F., M AIER S., K HIDHIR B., E VERETT
P., J OLESZ F., K IKINIS R.: Image processing for diffusion tensor magnetic resonance imaging. In Proc. Medical Image Computing and Computer-Assisted Intervention (MICCAI) (1999),
vol. 1679 of LNCS, Springer, pp. 441–452.

[PP99] PAJEVIC S., P IERPAOLI C.: Color schemes to represent
the orientation of anisotropic tissues from diffusion tensor data:
application to white matter fiber tract mapping in the human
brain. Magnetic Resonance in Medicine 42, 3 (1999), 526–540.
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.


Pacific Graphics 2009
S. Lee, D. Lischinski, and Y. Yu
(Guest Editors)

Volume 28 (2009), Number 7

The Dual-microfacet Model
for Capturing Thin Transparent Slabs
Qiang Dai1,2†

Jiaping Wang2

Yiming Liu2,3†

John Snyder4

Enhua Wu1,5

Baining Guo2

1 Institute

of Software, Chinese Academy of Sciences
2 Microsoft Research Asia
3 Nanyang Technological University
4 Microsoft Research
5 University of Macau

Abstract
We present a new model, called the dual-microfacet, for those materials such as paper and plastic formed by
a thin, transparent slab lying between two surfaces of spatially varying roughness. Light transmission through
the slab is represented by a microfacet-based BTDF which tabulates the microfacet’s normal distribution (NDF)
as a function of surface location. Though the material is bounded by two surfaces of different roughness, we
approximate light transmission through it by a virtual slab determined by a single spatially-varying NDF. This
enables efficient capturing of spatially variant transparent slices. We describe a device for measuring this model
over a flat sample by shining light from a CRT behind it and capturing a sequence of images from a single view.
Our method captures both angular and spatial variation in the BTDF and provides a good match to measured
materials.
Categories and Subject Descriptors (according to ACM CCS): I.3.7 [Computer Graphics]: Three-Dimensional
Graphics and Realism—Color, shading, shadowing, and texture

1. Introduction
Many common objects are thin-layer transparent slices
bounded by rough surfaces, such as plastic or resin slices,
textured, scratched, or stained glass, and cellulose sheets
such as paper, film and dried leaves. Refractions at the rough
surface interfaces cause complex shading effects such as
spatially-varying light scattering, background blurring, and
anisotropy. Capturing these reflectance properties improves
realism but has proven a challenging problem.
Light transmission through a transparent material can be
represented by a four-dimensional Bidirectional Transmission Distribution Function (BTDF) ρ(i, o), describing how
much light is transmitted when lit from direction i and
viewed from direction o. Unlike the BRDF, o in the BTDF

† This work was done when Qiang Dai and Yiming Liu were visiting students at Microsoft Research Asia.
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

always points to the hemisphere opposite i, representing the
direction of transmitted rather than reflected light.
Based on microfacet theory [CT82], several parametric
BTDF models have been developed [Sta01,WMLT07]. Most
previous works account only for a single rough surface
whereas two refractive interfaces lie between light source
and observer in the case of a thin transparent slab. We assume these two interfaces form two independent, rough surfaces and derive an approximation for light transmission
through the pair, called the dual-microfacet model. Though
each surface can be represented by a separate, spatiallyvarying normal distribution function, we form a virtual surface which provides identical light paths (assuming an infinitely thin slab) and which is determined by a single NDF.
This is critical for developing efficient and robust methods
for acquiring the model from real materials.
Accounting for spatial variation in light transmission then
yields the six-dimensional Spatially Varying Bidirectional
Transmission Distribution Function (SVBTDF) ρ(x, i, o).

1918

Qiang Dai et al. / The Dual-microfacet Model for Capturing Thin Transparent Slabs

Figure 1: SVBTDFs acquired with our method from real world material samples having spatially varying, rough surfaces.

As with an SVBRDF, a straightforward way of measuring
the SVBTDF adapts the gonioreflectometer [DNvGK99] by
placing lamps behind the material sample. Densely scanning over light and view directions requires lengthy capture on expensive devices. Another approach represents the
BTDF using a simple parametric model whose few parameters can be estimated from a sparse set or even a single image [GRBN07]. This reduces the acquisition workload, but
fails to capture the richness of real-world BTDFs, especially
anisotropy.

tiple layer surfaces. More general representations have thus
been proposed to represent the NDF with a tabulated function [PF90, WAT92, APS00]. Microfacet models have also
been applied to transparent materials to model their BTDF
[Sta01,WMLT07]. In [WMLT07], a microfacet-based model
called GGX was proposed to describe light transmission
through a rough surface between media having a different refractive index. A 1D parametric model describes the
NDF with respect to polar angle and can not be applied to
anisotropic materials.

Using our dual-microfacet model, we present a new technique for measuring SVBTDFs from images of a surface
sample taken from multiple light directions and a single
view. A camera-monitor system acquires back-illuminated
images of the material sample. Displaying a single dot on
the monitor at different locations provides a controllable
light direction and yields a 2D BTDF slice at each surface
point. Instead of fitting a parameterized BTDF model to
the captured data [WMLT07, GRBN07], we reconstruct an
NDF from these BTDF slices and finally derive the dualmicrofacet model.

Thin Translucent Slabs were first investigated in [HK93].
Their model is dominated by light scattering inside the object and requires Monte Carlo simulation to evaluate. Simplified models have since been proposed based on a semianalytic representation [Sta01] and limited to multiple scattering in thin-layer materials [DJ05, JMLH01]. Recently a
model for a contamination layer on smooth transparent surfaces was proposed in [GRBN07]. Their results are visually
similar to our model limited to isotropic transparent slabs.

Our major contribution is a new model (dual-microfacet)
for thin transparent slabs. It describes the pair of refraction events at the slab boundaries by a single, local formula.
This avoids costly integration of the two events in rendering (Equation 1) and difficult separation of the two events in
acquisition. Ours is the first method for efficiently modeling
and acquiring SVBTDFs including anisotropy.
2. Related Work
Microfacet Models for describing reflectance off rough
surfaces were introduced to computer graphics by [CT82]
A number of parametric BRDF models based on this theory have been proposed [War92,LFTG97,AS00], which represent the distribution of microfacet normals (NDF) empirically using an analytic expression such as a Gaussian. These models are simple to evaluate and easy to acquire but roughly approximate the underlying microstructure
and miss details in many real-world materials [NDM05].
[IA00] and [WW07] extend the microfacet model to mul-

Our model ignores light scattering inside the object and
only considers scattering due to refraction events on the
bounding surfaces. In capturing of real materials, we separate the multiple scattering component during preprocessing.
Acquisition of Spatially Varying Models from real materials can be straightforwardly done by acquiring 6D data
[DNvGK99] using a gonioreflectomoeter. [GTHD03] proposed a simple device for acquiring a spatially varying Ward
model [War92]. For BTDF models, previous work considers
a single refraction interface only [Sta01, WMLT07]. Using
such models to capture thin-layer materials is hard because
the refracted light at the first interface is inside the object and
can not be measured before it is modified by the next refraction. [WMLT07] proposed a smart method to solve this problem by gluing a hemisphere to the transparent material with
an ideally smooth surface on its dome and a rough surface
to be measured on the planar base of the dome. While the
directional light comes from the dome side, refracted light
exits the hemisphere perpendicularly effectively neglecting
the influence of the second refraction. [GRBN07] proposed
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

1919

Qiang Dai et al. / The Dual-microfacet Model for Capturing Thin Transparent Slabs

ρb . More precisely, it is given by
ρt (i, w) ρb (−w, o) dωw .

ρ(i, o) =

(1)

Ω+

Figure 2: Dual-microfacet model. (a) Refraction through
flat slab. (b) Refraction through rough slab. (c),(d) Equivalent refraction events are produced by a virtual configuration
with a rough surface on one side and a flat surface on the another. The arrows show the directions of light transmission
rather than the incoming or outgoing directions.

a device setup with a laser to measure the phase function at
a particular point on a sample. Both works can only measure
a single surface point at a time, and can only be inefficiently
extended to measure spatial variation by scanning.
Our BTDF model combines the two refraction events together in a single, local formula which enables efficient acquisition of spatially varying materials. We reconstruct our
model using data from a simple device that captures from a
single view direction.

Even with this approximation, (1) has no closed-form reduction in general and thus still entails costly numerical integration to evaluate during rendering. For acquisition, it is hard
to separate the measured data in order to fit ρt and ρb .
We solve this problem by using microfacet theory to
model the rough surfaces and combine the two refraction
events. Surface microstructure is modeled with many tiny
transparent facets, each purely refractive and having the
same refractive index [CT82]. For a thin transparent slab
bounded by rough surfaces as shown in Figure 2(b), the direction of transmitted light is given by Snell’s law:
h1 = −

ηA i + ηG o
η i + ηA o
, h2 = G
.
ηA i + ηG o
ηG i + ηA o

(2)

where h1 and h2 are the microfacet normal directions of the
first and second refraction, respectively. ηA and ηG are the
refractive index of air and the transparent material, respectively. (2) assumes ηG > ηA . Substituting i = −o into (2)
yields the constraint
i + o = − i + ηo

h1 + o − ηo

h2

(3)

where η = ηG /ηA is the relative refractive index.
3. Dual-Microfacet Model
Microfacet theory represents surface microstructure with a
large number of tiny mirror facets, each purely reflective and
having the same refraction index, only with different orientations. The normal distribution function (NDF) D(h) describes the distribution of microfacet orientations on the surface. It satisfies D(h) ≥ 0 and Ω+ (n · h) D(h) dωh = 1 while
the integration is done in half-angle space over the hemisphere
Ω+ = Ω+ (n) = h h · n > 0 .
where h is the normal of microfacet, and n is the surface
normal.
Light traveling through a transparent slab refracts twice
as it enters and exits. When the slab’s bounding surfaces are
ideally flat, light exits with the same direction it had originally as shown in Figure 2(a). The direction changes if the
slab is bounded by a rough surface on both sides as shown
in Figure 2(b). In this case, each refraction on the pair of
boundary surfaces can be considered separately using previous models [Sta01, WMLT07] but this greatly complicates
both rendering and acquisition.
To solve this problem, the first step in our model is to
ignore the offset between the two refraction locations (i.e.,
assume an infinitely thin slab). The overall BTDF ρ is then
roughly a convolution of the top and bottom BTDFs, ρt and
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

Consider the virtual configuration shown in Figure 2(c)
which defines a rough surface on the top side of the slab in
such a way as to yield an outgoing light direction which is
the same as in (b). To find the microfacet normal direction
ht of this virtual configuration, we plug h2 = z+ = (0, 0, 1)
into (3) to yield
ht = −

i + o − o − om z +
i + om

(4)

where om = ηo = (xo , yo , − η 2 − xo2 − y2o ). The corresponding Jacobian multiplies the Jacobian of the two refraction events:
∂ ωht
∂ ωo

=

∂ ωht
∂ ωo

|o · om | |om · ht |
∂ ωi
=
.
∂ ωo
η 2 (i · ht + om · ht )2

(5)

Assuming no light is absorbed within the material slab, the
resulting BTDF is given by
|i · ht |F(i · ht ) F(i · z+ ) G(i, o, ht ) D(ht )
|i · z+ ||o · z+ |
(6)
where F is the Fresnel transmittance and G is the shadowing
term. The function D is the normal distribution function that
is recovered and tabulated in our method. For more details
about the calculation of the Jacobian terms, please refer to
Appendix.
ρ˜t (i, o) =

∂ ωht
∂ ωo

Similar formulas can be derived for the other case in
which the top side is ideally flat and the bottom is rough

1920

Qiang Dai et al. / The Dual-microfacet Model for Capturing Thin Transparent Slabs

as shown in Figure 2(d):
hb =

i + o + i − im z+
o + im

im = η i = ix , iy ,

∂ ωhb
∂ ωo
ρ˜ b (i, o) =

∂ ω hb
∂ ωo

=

η 2 − i2x − i2y
|o · hb |

(im · hb + o · hb )2

(7)

(8)

(9)

|i · hb |F(i · hb ) F(i · z+ ) G(i, o, hb ) D(hb )
|i · z+ ||o · z+ |
(10)

Though real objects exhibit roughness at both boundaries,
these two configurations represent two extreme cases of a
single rough surface. Both virtual configurations produce
similar transmitted light because they are derived to reproduce the same light paths. However, (6) and (10) are different and the two models predict different light scattering
behavior. This difference stems from the basic asymmetry
that light entering a medium of higher index of refraction is
biased toward the “South Pole” axis, while light leaving is
biased away.
Figure 3 shows that our model matches the ground truth
Monte Carlo result quite well in the two extreme cases, (a)
and (b). It is less accurate in an intermediate case (c) where
the ground truth lobe lies between the locations predicted
by our two extreme models. We therefore propose our final
BTDF model as the linear interpolation in logarithm space
between these two virtual configurations:
˜ o) = α ln ρ˜t (i, o) + (1 − α) ln ρ˜ b (i, o).
ln ρ(i,

(11)

The weighting factor α indicates the relative roughness of
the two surfaces (larger α indicates a rougher top surface).
In our model, a single NDF is used to describe the overall
effect to the combined refraction events on both sides. In our

Figure 3: Comparing the virtual configuration with Monte
Carlo photon tracing. (a) Only rough surface on the top. (b)
Only rough surface on the bottom. (c) Both surfaces have
the same level of roughness. The same Gaussian distribution
of the microfacet orientation is used for the Monte Carlo
photon tracing and the NDF D(h) in our model. Refraction lobes predicted by the two models are compared to the
ground truth shown by the gray dashed line.

Figure 4: Our data acquisition device: (a) photograph, (b)
diagram.

experiments, log space interpolation produces a better result
than simple linear interpolation because the transmission effect at the two interfaces is essentially multiplicative.
Figure 5 compares this model with a single-refraction
model (GGX) [WMLT07], based on Monte Carlo photon
tracing ground truth. Our model predicts the refraction lobe
more accurately.
4. Measuring Thin Transparent Slabs
To acquire the dual-microfacet model from a real-world material sample, a camera-monitor device is used to capture
2D BTDF slices at each surface point. Measured 2D BTDF
slices are then interpolated to a regularly-sampled hemispherical function, and the dual-microfacet model is fitted
at each surface point.
4.1. Refraction Data Acquisition
Data is acquired by illuminating the material sample from
the back and capturing its transmitted image from one view.
We display a white dot on a black background on the computer monitor (Dell Flatten Screen CRT Display) at different
screen positions to produce a point light source at different
locations pq as shown in Figure 4(b). A 40×40 grid of dot
positions is scanned, one at a time, yielding a sequence of

Figure 5: Comparison of our model vs. single-refraction.
The same (Gaussian) distribution is used for the NDF in our
model, GGX, Monte Carlo photon tracing. The testing material has the same level of surface roughness on both sides.
The direction of the incoming light in (a), (b) and (c) is 30◦ ,
45◦ and 60◦ , respectively. Our model with α = 0.56 matches
the Monte Carlo result better than GGX.

c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

1921

Qiang Dai et al. / The Dual-microfacet Model for Capturing Thin Transparent Slabs

images Iq for q ∈ S where S represents the set of dot locations. A Canon 30D camera with EF-100 2.8 lens is placed
about 1.0m away and 0.7m above the center of the surface
sample, making an angle of roughly θ = 45◦ from vertical.
The image resolution is 3504×2336. We use a CRT display
instead of an LCD because its radiance is more uniform with
changing viewing angle.
Before capturing, we calibrate the camera’s position and
orientation as in [Zha00]. The color and intensity of the monitor is measured by directly capturing its output. We assume
the CRT produces light that is uniform, both angularly and
spatially.
Dots are displayed over a physical distance ranging from
p0 to p1 as shown in Figure 4(b). This range is roughly 20%
larger than the region of the material sample to be captured
and is shifted in the direction opposite the camera by d cos θ ,
where d is the distance from the material sample to the monitor. In our experiments, we use d = 0.04m and a square material size roughly 0.08m on each side. This yields a range
of light directions producing an average 90◦ angular span
around the ideal refraction direction. Dot positions are determined by capturing an image without the material sample. The dots are displayed simultaneously, detected in the
image, and then projected to the 3D plane (x, y, d).
After capturing, HDR images are reconstructed and rectified. The refraction function at each surface point x can then
be computed from the image sequence Iq , as
R x, iq (x), o =

Iq (x)
z+ · iq (x) Lq

pq − x

2

(12)

where Iq (x) is the color of the pixel at x, pq is the position of
the light source in image q and Lq is its intensity. The lighting direction i is computed as iq (x) = (pq − x)/ pq − x .
Since the camera is quite far away from the sample, we use
the same view direction oc = V / V for all surface points,
where V is the calibrated camera position.
In real materials, the transmission function includes (diffuse) multiple scattering effects as well as spatially-varying
refraction. We model it via
R(x, i, o) = ρd + ks ρ(x, i, o).

(13)

We then separate the diffuse from specular componenets using
ρd = min{R x, iq (x), o |Iq (x) > 0.05Iavg }.
q

(14)

according to the simple threshold technique in [WZT∗ 08].
After separation, measurements of the refractive component
ρ(x, i, o) are irregularly scattered as a function of i because
of spatial variation in the lighting direction, iq (x). We resample them onto a hemicube using the push-pull method
[GGSC96], as in [WZT∗ 08].
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

4.2. Model Fitting
We drop the position parameter x in this subsection since
each point is processed independently and equivalently. After the BTDF slice is recovered, we fit the dual-microfacet
model to the measured data at each point by minimizing the
difference between the refraction measured and prediction of
our model. We assume the shadowing term G(i, o, h) and the
refractive index η are known. The unknown terms are thus
the weighting factor α and the NDF D(h). We propose an iterative method for model fitting which performs two steps in
each iteration. The first estimates the NDF D(h) while fixing
the weight α, while the second searches for the best α while
holding the NDF D(h) constant.
More precisely, the NDF D(h) is estimated in the first step
by minimizing:
2

min ∑ ln ρ iq , oc − ln ρ˜ iq , oc

(15)

D q∈S

For each measurement iq , oc , ρ˜ is defined in (11) in terms
of two normal directions ht and hb which define BTDFs
according to (6) and (10). Because two directions are involved, we solve for the optimal D using a set of linear equations rather than the simple diagonal system of
[NDM05, WZT∗ 08]. The linear system is given by
α D˜ ht + (1 − α) D˜ hb = ln ρ(iq , oc ) − A,
4D˜ h − D˜ h1 − D˜ h2 − D˜ h3 − D˜ h4 = 0,

q∈S

(16)

h ∈ Ω+

(17)

where A = α ln At + (1 − α) ln Ab and D˜ h = ln D(h). At and
Ab are the products of the remaining terms in (6) and (10),
excluding the unknown D(h). oc is the viewing direction
which is fixed and determined by the camera position. S
is the set of light direction dots sampled as described in
Section 4.1. The number of equations generated in (16) is
the number of measurements |S| (“Lights” in Table 1). We
represent the hemispherical function D using a hemicube
[WZT∗ 08].
Equation (17) is added to regularize smoothness on unknowns that may not be adequately constrained by (16)
alone. D˜ hi , i ∈ {1, . . . , 4} in (17) represents the four neighboring cells of h in the hemicube. Boundary hemicube cells
are removed from the set of unknowns and set to ln ε. We
use ε = 1 × 10−6 which assumes the NDF boundary is close
to zero. The number of equations generated in (17) is the
number of non-boundary cells in the hemicube.
After estimating the NDF, the next step searches for an
optimal weight factor α by mean incident direction weighted
by the BTDF:
min
α

Ω+ i ρ(i, oc ) dωi
Ω+ ρ(i, oc ) dωi

−

˜ oc ) dωi
Ω+ i ρ(i,
˜ oc ) dωi
Ω+ ρ(i,

2

.

(18)

The minimum is found by golden section search [PTVF92]
within [0, 1]. We initialize at α = 0.5 and stop iterating when

1922

Qiang Dai et al. / The Dual-microfacet Model for Capturing Thin Transparent Slabs

α changes little (< 0.01). In our experiments, the iteration
converges in fewer than 10 steps.
During a first-pass set of iterations, we constrain D to have
polar symmetry via
D˜ h − D˜ h = 0,

h ∈ Ω+

(19)

Sample
Grid Sheet
Leaf Glass
Rice Paper

Image Res
600×600
400×420
600×600

Lights
40×40
40×40
20×20

NDF Res
32×32
32×32
32×32

η
1.4
1.5
1.55

Table 1: Parameters for various material samples.

where h = (−xh , −yh , zh ) is the polar-mirrored version of h.
This constraint provides a better estimate of D before the iteration has formed a good estimate of α. After convergence,
D(h) is computed once more, in a second pass without (19).
As previously mentioned, we assume the shadowing term
is known. It has only a subtle effect on appearance. Unlike
the case of the BRDF, in which the shadowing term moves
opposite to the Fresnel factor, in a BTDF the shadowing
term behaves consistently with the Fresnel factor, which falls
off sharply away from normal incidence. We use the Smith
model [Smi67] for the shadowing term, as in [WMLT07],
which is controlled by the shadowing roughness parameter αb . Iteration is first performed assuming αb = 0.2, after
which we search for a better αb subject to (15) while keeping
α and D(h) constant using the Levenberg-Marquardt algorithm [PTVF92]. The refractive index η of common materials can be found in a chemistry handbook such as [LBB∗ 08].
4.3. Acceleration
The bottleneck of model reconstruction is the model fitting
step at each surface point (i.e., at each pixel in the acquired
images). Many measured BTDF slices are similar, yielding
redundant fitting computation. We cluster the BTDF slices
ρ(x, i, oc ) to a smaller number of representatives using kmeans clustering. Model fitting is performed only on these
representatives, indexed by j. After their models α, D j are
reconstructed, the models for each non-representative point
α, D i is linearly interpolated from its nearby representatives Ni in the vector space of BTDF slices:
α, D i =

∑ wi j

α, D

j

(20)

j∈Ni

where wi j are the interpolation weights. These are determined by finding the best linear combination of nearby
BTDF slices:

∑ wi j ρ j (i, o)

= ρi (i, o)

(21)

= 1

(22)

j∈Ni

∑ wi j

j∈Ni

We follow the same rules to determine the neighborhood
set Ni in the representatives as in [WZT∗ 08]. In our experiments, we choose 1% of the surface points as representatives, which yields a speed up of roughly 100 times.
5. Experimental Results
We validated our model using various sheets of real-world
transparent materials captured with our simple device. Table

1 lists data for these samples including spatial resolution,
angular resolution of NDFs, and refractive index.
We implemented our accelerated model fitting algorithm
on a PC with Intel CoreTM 2 Quad 2.13GHz CPU and
4GB memory. Data capturing takes about 5-10 hours using
multiple-exposure acquisition. The angular sampling density
for lighting is manually chosen depending on the roughness
of the sample surfaces. Image data processing (including calibration, HDR reconstruction, diffuse separation, and resampling) takes about 3-4 hours, and is dominated by disk I/O.
Model fitting with clustering acceleration takes about one
hour. We integrated our BTDF model into a ray tracer for
rendering results, only refraction on the first surface is rendered.
Figure 1 shows the rendering result of mapping our
SVBTDF model to more complex geometry and under environment lighting. The images show spatially varying and
anisotropic light scattering. Subtle color changes due to refracted light in the red rice paper are captured as well. The
images are rendered with front face only. The tiling resolution in (a) and (c) is 2×2.
Figure 6 shows a comparison of our model with a real image. The captured material is “Grid Sheet”, a piece of plastic
window coating having highly anisotropic micro-structures
as shown in (h). A novel view is used to test our rendering
result in (b) which matches the real appearance in (a). We
also visualize the NDFs (c-g, bottom row) by orthographic
projection for surface points marked in (h). The NDFs constructed are consistent with the ground truth measured by
shooting a laser beam at the same points [GRBN07]. Slight
blurring is due to low hemicube resolution.
Figure 7 compares the blurring effect on a background
image. The leaf glass with rough pattern is put in the front
of the checker board. Our result (b) provides a good match
to the ground truth in (a) and preserves the spatial variation of blurring and anisotropy. However our result does not
match the ground truth exactly, it is mainly due to the resolution limitation of NDF representation and the trade-off between sampled angular range and capturing time. For such a
highly anisotropy material, both the angular range and the
density of the sampled lighting direction should be high,
which would require much more time and storage for data
acquisition and processing.
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

Qiang Dai et al. / The Dual-microfacet Model for Capturing Thin Transparent Slabs

1923

6. Conclusion
We have proposed a novel microfacet-based BTDF for modeling the entire enter-then-exit light path through thin transparent slabs. The model is based on an NDF and a parameter
controlling the roughness ratio between the top and bottom
slab surfaces. Our model is easy to evaluate for rendering
and provides better accuracy compared to single refraction
models. It also enables easy acquisition of spatially varying materials, which we demonstrate successfully on 3 realworld materials using data captured from a simple device.
Our approach is limited to thin, transparent slices. Thick
slabs yield a significant, angularly-dependent offset where
the refracted light strikes the second interface, making our
model inappropriate. In this case, parallax effect will not be
captured. For materials with very sharp specular lobes, dense
sampling of lights is required to capture the specular peak.
Translucent materials with significant internal scattering are
simplified by a diffuse term and thus not captured accurately.
In future work, we are interested in handling the viewdependent shifting of refracted light for transparent slices of
a specified thickness. Generalizing the microfacet model to
capture single and multiple scattering inside translucent materials is another extension. Finally, it is valuable to explore
efficient methods for rendering SVBTDF models.
Acknowledgement: We would like to thank the anonymous reviewers for their valuable comments and insightful
suggestions. This work was supported by the National Basic Research Program of China (Grant No. 2009CB320802),
the National High Technology Research and Development

Figure 7: Blurring effect on background image. (a) Real image. (b) Our Method. (c) GGX Model [WMLT07]. (d) Dirty
Glass Model [GRBN07]. Our result is closest to the real image. The GGX model yields isotropic blurring of the background image and an image shift due to incorrect prediction
of refracted light directions in the dual interface. The Dirty
Glass Model produces only uniform blurring of the background image.

Program of China (Grant No. 2008AA01Z301), and the Research Grant of the University of Macau.
References
[APS00] A SHIKMIN M., P REMOŽE S., S HIRLEY P.:
A
microfacet-based BRDF generator. In Proceedings of ACM SIGGRAPH 2000, Computer Graphics Proceeding, Annual Conference Series (New York, NY, USA, 2000), ACM Press/AddisonWesley Publishing Co., pp. 65–74.
[AS00] A SHIKHMIN M., S HIRLEY P.: An anisotropic phong
BRDF model. Journal of Graphics Tools 5, 2 (2000), 25–32.
[CT82] C OOK R. L., T ORRANCE K. E.: A reflectance model for
computer graphics. ACM Trans. Graph. 1, 1 (1982), 7–24.
[DJ05] D ONNER C., J ENSEN H. W.: Light diffusion in multilayered translucent materials. In SIGGRAPH ’05: ACM SIGGRAPH 2005 Papers (New York, NY, USA, 2005), ACM,
pp. 1032–1039.
[DNvGK99] DANA K. J., NAYAR S. K., VAN G INNEKEN B.,
KOENDERINK J. J.: Reflectance and texture of real-world surfaces. ACM Transactions on Graphics 18, 1 (1999), 1–34.

Figure 6: Model validation. (a) Real image. (b) Synthesized
image using our model. The comparison uses a similar lighting direction; texture mapping in the synthesized image does
not reproduce the global texture pattern. Columns (c-g) compare the NDFs (white, bottom) constructed with our method
with the ground truth (green, top). The corresponding positions of these NDFs are marked in a close-up view of the
captured material (h).

c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

[GGSC96] G ORTLER S. J., G RZESZCZUK R., S ZELISKI R., C O HEN M. F.: The lumigraph. In Proceedings of ACM SIGGRAPH
1996, Computer Graphics Proceeding, Annual Conference Series
(New York, NY, USA, 1996), ACM, pp. 43–54.
[GRBN07] G U J., R AMAMOORTHI R., B ELHUMEUR P., NAYAR
S.: Dirty glass: Rendering contamination on transparent surfaces.
Eurographics Symposium on Rendering (June 2007), 159–170.
[GTHD03] G ARDNER A., T CHOU C., H AWKINS T., D EBEVEC
P.: Linear light source reflectometry. ACM Transactions on
Graphics 22, 3 (2003), 749–758.

1924

Qiang Dai et al. / The Dual-microfacet Model for Capturing Thin Transparent Slabs

[HK93] H ANRAHAN P., K RUEGER W.: Reflection from layered
surfaces due to subsurface scattering. In SIGGRAPH ’93: Proceedings of the 20th annual conference on Computer graphics
and interactive techniques (New York, NY, USA, 1993), ACM,
pp. 165–174.
[IA00] I CART I., A RQUÈS D.: A physically-based BRDF model
for multilayer systems with uncorrelated rough boundaries. In
Proceedings of the Eurographics Workshop on Rendering Techniques 2000 (London, UK, 2000), Springer-Verlag, pp. 353–364.
[JMLH01] J ENSEN H. W., M ARSCHNER S. R., L EVOY M.,
H ANRAHAN P.: A practical model for subsurface light transport. In SIGGRAPH ’01: Proceedings of the 28th annual conference on Computer graphics and interactive techniques (New
York, NY, USA, 2001), ACM, pp. 511–518.
[LBB∗ 08] L IDE D. R., BAYSINGER G., B ERGER L. I., G OLD BERG R. N., K EHIAIAN H. V., K UCHITSU K., ROSENBLATT
G., ROTH D. L., Z WILLINGER D.: Handbook of chemistry and
physics, 88th edition. Chapman & Hall/CRC Press LLC (2008).

Appendix
Jacobian Calculation in Dual Refraction
Figures 2(c) and (d) show the two extreme configurations.
The refractive index of the slab is ηG and the surrounding
is ηA . We use the relative refractive index η = ηG /ηA in all
formulas.
Consider the virtual configuration shown in Figure 2(c)
which defines a rough surface only on the top side of the
slab. The microfacet normal direction ht is determined as
(4), where om = ηo = (xo , yo , − η 2 − xo2 − y2o ). The corresponding Jacobian multiplies the Jacobian of the two refraction events:
∂ ωht
∂ ωo

=

∂ ωht
∂ ωo

∂ ωi
.
∂ ωo

(23)

[LFTG97] L AFORTUNE E. P. F., F OO S.-C., T ORRANCE K. E.,
G REENBERG D. P.: Non-linear approximation of reflectance
functions. In Proceedings of ACM SIGGRAPH 1997, Computer
Graphics Proceeding, Annual Conference Series (New York,
NY, USA, 1997), ACM Press/Addison-Wesley Publishing Co.,
pp. 117–126.
[NDM05] N GAN A., D URAND F., M ATUSIK W.: Experimental
analysis of BRDF models. In Rendering Techniques 2005: 16th
Eurographics Workshop on Rendering (June 2005), pp. 117–126.
[PF90] P OULIN P., F OURNIER A.: A model for anisotropic reflection. In Computer Graphics (Proceedings of ACM SIGGRAPH 90) (Aug. 1990), Baskett F., (Ed.), vol. 24, pp. 273–282.
[PTVF92] P RESS W. H., T EUKOLSKY S. A., V ETTERLING
W. T., F LANNERY B. P.: Numerical recipes in C (second edition). Cambridge University Press (1992).
[Smi67] S MITH B. G.: Geometrical shadowing of a random
rough surface. IEEE Transactions on Antennas and Propagation,
15 (1967), 668 – 671.
[Sta01] S TAM J.: An illumination model for a skin layer bounded
by rough surfaces. In Proceedings of the 12th Eurographics Workshop on Rendering Techniques (London, UK, 2001),
Springer-Verlag, pp. 39–52.
[War92] WARD G. J.: Measuring and modeling anisotropic reflection. In Computer Graphics (Proceedings of ACM SIGGRAPH 92) (New York, NY, USA, 1992), ACM Press, pp. 265–
272.
[WAT92] W ESTIN S. H., A RVO J. R., T ORRANCE K. E.: Predicting reflectance functions from complex surfaces. In Computer Graphics (Proceedings of ACM SIGGRAPH 92) (New
York, NY, USA, 1992), ACM Press, pp. 255–264.
[WMLT07] WALTER B., M ARSCHNER S. R., L I H., T ORRANCE
K. E.: Microfacet models for refraction through rough surfaces.
Eurographics Symposium on Rendering (June 2007), 195–206.
[WW07] W EIDLICH A., W ILKIE A.: Arbitrarily layered microfacet surfaces. In GRAPHITE 2007 (Dec. 2007), ACM, pp. 171–
178.
[WZT∗ 08] WANG J., Z HAO S., T ONG X., S YNDER J., G UO B.:
Modeling anisotropic surface reflectance with example-based microfacet synthesis. ACM Transactions on Graphics (SIGGRAPH
2008) 27, 3 (August 2008), 41:1–41:9.
[Zha00] Z HANG Z.: A flexible new technique for camera calibration. In IEEE Transactions on Pattern Analysis and Machine
Intelligence (2000), vol. 22, pp. 1330– 1334.

Figure 8: Geometry for first ideal refraction event in Figure 2(c), with half-vector hˆt = -i - ηo and normalized halfdirection ht = hˆt / hˆt . We compute the Jacobian by taking
an infinitesimal solid angle perturbation dωo in o , projecting into a perturbation in hˆt and then onto the unit sphere
for ht . Only the 2D incidence plane slice through the full 3D
space is shown.
The first Jacobian in (23) is derived exactly as the Equation 17 in [WMLT07], as shown in Figure 8:
∂ ωht
∂ ωo

=

η 2 |o · ht |
(i · ht + η (o · ht ))2

(24)

Plug om = ηo into (24), we have:
∂ ωht
∂ ωo

=

η |om · ht |
(i · ht + om · ht )2

(25)

A geometry explanation of calculating the second Jacobian
in (23) is shown in Figure 9. The second Jacobian is finally
derived as:
|o · i | |o · om |
∂ ωi
=
=
∂ ωo
η2
η3

(26)

Finally we combined two Jacobian just as (5) in our paper.
Similar formulas can be derived for another extreme case
which the top side is ideally flat and the bottom is rough as
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

Qiang Dai et al. / The Dual-microfacet Model for Capturing Thin Transparent Slabs

shown in Figure 2(d). The microfacet normal direction hb is
determined in (7), where im = η i = ix , iy , η 2 − i2x − i2y .
In this case, the Jacobian is solely related to the second refraction event, as shown in Figure 10, the Jacobian is (9).

Figure 9: Geometry for the second ideal refraction event in
Figure 2(c), with half-vector zˆ+ = ηi + o and normalized
half-direction z+ = zˆ+ / ||zˆ+ ||. We compute the Jacobian by
taking an infinitesimal solid angle perturbation dωo in o,
projecting into a perturbation onto the unit sphere for i .
Only the 2D incidence plane slice through the full 3D space
is shown.

Figure 10: Geometry for second ideal refraction event in
Figure 2(d), with half-vector hˆb = ηi + o and normalized
half-direction hb = hˆb / hˆb . We compute the Jacobian by
taking an infinitesimal solid angle perturbation dωo in o,
projecting into a perturbation onto the unit sphere for hb .
Only the 2D incidence plane slice through the full 3D space
is shown.

c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

1925


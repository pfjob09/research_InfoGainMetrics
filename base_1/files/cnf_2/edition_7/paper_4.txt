DOI: 10.1111/j.1467-8659.2008.01190.x

COMPUTER GRAPHICS

forum

Volume 28 (2009), number 1 pp. 41–55

Partial 3D Shape Retrieval by Reeb Pattern Unfolding
Julien Tierny1 , Jean-Philippe Vandeborre1,2 and Mohamed Daoudi1,2
1 LIFL

(UMR USTL/CNRS 8022), Lille, France
TELECOM ; TELECOM Lille 1, France
{julien.tierny, jean-philippe.vandeborre, mohamed.daoudi}@lifl.fr
2 Institut

Abstract
This paper presents a novel approach for fast and efficient partial shape retrieval on a collection of 3D shapes.
Each shape is represented by a Reeb graph associated with geometrical signatures. Partial similarity between two
shapes is evaluated by computing a variant of their maximum common sub-graph.
By investigating Reeb graph theory, we take advantage of its intrinsic properties at two levels. First, we show that
the segmentation of a shape by a Reeb graph provides charts with disk or annulus topology only. This topology
control enables the computation of concise and efficient sub-part geometrical signatures based on parameterisation
techniques. Secondly, we introduce the notion of Reeb pattern on a Reeb graph along with its structural signature.
We show this information discards Reeb graph structural distortion and still depicts the topology of the related
sub-parts. The number of combinations to evaluate in the matching process is then dramatically reduced by only
considering the combinations of topology equivalent Reeb patterns.
The proposed framework is invariant against rigid transformations and robust against non-rigid transformations
and surface noise. It queries the collection in interactive time (from 4 to 30 seconds for the largest queries). It
outperforms the competing methods of the SHREC 2007 contest in term of NDCG vector and provides, respectively,
a gain of 14.1% and 40.9% on the approaches by Biasotti et al. [BMSF06] and Cornea et al. [CDS∗ 05].
As an application, we present an intelligent modelling-by-example system which enables a novice user to rapidly
create new 3D shapes by composing shapes of a collection having similar sub-parts.
Keywords: 3D shape retrieval, reeb graph theory, partial matching, shape signature, modeling-by-example
ACM CCS: H.3.1 [Information Storage and Retrieval]: Content Analysis and Indexing I.3.5 [Computer graphics]:
Computational Geometry and Object Modelling

abling retrieval of similar objects despite rigid transformations [CTSO03, FMK∗ 03] or even non-rigid transformations
(such as shape bending or character articulation) [HSKK01];
[GSCO07]; [JZ07]. We defer the reader to survey articles
[TV04, BKS∗ 05, IJL∗ 05] for a broad overview of retrieval
methods based on global similarity.

1. Introduction
Three dimensional (3D) shape retrieval systems based on
visual similarity aim at helping human users browsing large
collections of 3D shapes in an interactive and intuitive way. In
this framework, the user specifies a 3D model as an example
query and the system is expected to sort the entries of the
collection by decreasing visual similarity, providing as top
results the most similar entries.
An important literature has been provided for shape retrieval based on global similarity, presenting methods en-

However, other applicative contexts, such as modellingby-example [FKS∗ 04] (where new shapes are created by cutting and pasting existing shape sub-parts) or classification
[HKDH04], might require to retrieve objects with regard to
partial similarity. In such a paradigm, systems are expected

c 2008 The Authors
Journal compilation c 2008 The Eurographics Association and
Blackwell Publishing Ltd. Published by Blackwell Publishing,
9600 Garsington Road, Oxford OX4 2DQ, UK and 350 Main
Street, Malden, MA 02148, USA.

Submitted February 2008
Revised April 2008
Accepted July 2008

41

42

J. Tierny et al. / Partial 3D Shape Retrieval by Reeb Pattern Unfolding

to retrieve objects that have similar sub-parts even if they
visually differ globally.
Unlike shape retrieval based on global similarity, only
few papers have addressed the partial shape retrieval problem, while it is seen as the next challenging open issue by
the shape retrieval community [CTSO03, FMK∗ 03]. Moreover, it is a more general problem than global shape similarity estimation (two globally similar shapes will also be
similar partially) and thus it is a research topic of larger
impact.
Partial shape retrieval state-of-the-art techniques can be
roughly classified into two categories.

curve-skeleton of the shape and then employ the Earth
Mover’s Distance [KSDD03] to evaluate the partial similarity of the skeletons. However, sub-part signature is based
on the euclidean distance between the surface and its skeleton
which makes the method quite sensitive to non-rigid transformations. Biasotti et al. [BMSF06] present an efficient method
based on Reeb graphs and Spherical Harmonics [FMK∗ 03].
However, even if the Reeb graph construction algorithm is
robust to non-rigid transformations (such as shape bending
or character articulation), sub-parts signatures (spherical harmonics) are not, which is slightly detrimental to the overall
robustness of the approach.

On the one hand, local descriptors-based techniques aim
at characterizing the local properties of a large number of
small features extracted on the shape. Then, partial shape
similarity is estimated by feature point-to-point matching
and matching similarity estimation. Liu et al. [LZQ06] propose to use a Monte-Carlo sampling on the surface model
and to capture the local aspect of the shape with spin-image
signatures [JH99]. Funkhouser and Shilane [FS06] present
a more sophisticated sampling strategy and then describe
local geometry with several descriptors based on Spherical Harmonics [FMK∗ 03] but this method is only experimented for global shape retrieval. In order to deal with
the combinatorial explosion due to individual local feature comparison, such approaches use complex data structures to drive the feature matching process, such as priority queues [FS06] or feature clusters [LZQ06] inspired by
text-document analysis. Gal et al. [GCO06] present an interesting geometrical hashing mechanism associated with
a local surface description based on curvature analysis. In
the context of Euclidean partial self symmetry detection,
Mitra et al. [MGP06] use a similar approach by sampling the
surface and associating samples with geometrical signatures
based on normal cycles [CSM03]. Then, the authors propose
a sample pruning strategy specific to symmetry characterization. However, as underlined by Biasotti et al. [BMSF06],
most of local descriptor methods base their partial similarity estimation on point-to-point matching only. This is particularly detrimental in term of re-usability in application
contexts such as modelling-by-example [FKS∗ 04], where
the similar sub-parts have to be explicitly identified and
extracted.

In this paper, we present a fast and efficient structuraloriented approach for partial 3D shape retrieval, based on
Reeb graphs—an expressive topological shape description
which has already shown its utility in several computer graphics applications [BMS00, ZMT05, AHLD07] (see [BGSF08]
for a recent survey). Unlike previous works based on Reeb
graphs [HSKK01, TS05] and which have been specifically
designed for global shape retrieval (using a multi-resolution
strategy), this work presents a framework for partial similarity retrieval (retrieving objects that have similar sub-parts
even if the visually differ globally). Moreover, in comparison with the technique proposed by Biasotti et al. [BMSF06],
this paper introduces a novel description (which is pose insensitive) and a new partial comparison method. The main
contribution of this work is to take advantage of the intrinsic properties of Reeb graph theory to improve both the
shape description and comparison processes. First we segment the shape using a Reeb graph and encode the relations between resulting patches into a dual Reeb graph. We
show this segmentation provides only two types of charts,
called Reeb charts, that have either disk or annulus topology. This topology control enables efficient pose insensitive
sub-part geometrical description based on parameterisation
techniques [WWJ∗ 06, TVD07]. Secondly, we introduce the
notion of Reeb pattern on a Reeb graph along with its structural signatures. We show this information discards Reeb
graph structural distortion and avoids the use of error-tolerant
graph matching algorithms [MB98]. Moreover, Reeb pattern
structural signatures concisely encode the related sub-part
topology and enable to dramatically reduce the number of
combinations to evaluate in the matching process by only
considering the combinations of topology equivalent Reeb
patterns.

On the other hand, structural-based approaches present
the advantage to explicitly identify the surface patches that
have been matched. Moreover, the combinatorial explosion
due to feature comparison can be easily reduced by reasoning on the structure of the shape instead of using complex hashing mechanisms. These methods first segment the
shape and represent it by a graph (or a skeleton [DJ06]) depicting the structural relations between the segments. Then,
partial shape similarity is estimated using graph matching
techniques. Cornea et al. [CDS∗ 05] propose to extract the

After a brief method overview, we describe the Reeb graph
segmentation process and detail the sub-part geometrical signature computation. Then, we introduce the notion of Reeb
pattern and present the partial similarity estimation algorithm based on Reeb pattern unfolding (RPU). Finally, we
show experimental results that demonstrate the performance
improvement and the robustness of our method. We also
describe an intelligent modelling-by-example system that
demonstrates the applicative interest of our framework.

c 2008 The Authors
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

J. Tierny et al. / Partial 3D Shape Retrieval by Reeb Pattern Unfolding

43

2. Method Overview

3. Reeb Graph and Unfolding Signatures

Let M be a closed 2-manifold of arbitrary genus embedded
in R3 . First, we compute the Reeb graph of M to segment
it into a set of charts Ci of controlled topology, which we
call Reeb charts, which have either disk or annulus topology.
Then, for each chart, we compute its unfolding signature λφi
(as introduced in [TVD07]) by measuring the distortion of
its mapping φ i to the canonical planar domain D (either the
unit disk or the unit annulus). Finally, the input manifold is
represented by a dual Reeb graph noted R associated with
the unfolding signatures of the Reeb charts.

Given an input closed 2-manifold M of arbitrary genus, the
first step of the framework, the shape description step, consists in segmenting M using its Reeb graph [Ree46] and to
compute a geometrical signature for each extracted surface
segment.

To measure the partial similarity between two dual Reeb
graphs R1 and R2 , approximations of their maximally similar
common sub-graphs G1∗ and G2∗ are computed. In particular,
to reduce the number of combinations to consider, we use
the following strategy. First, the sets P1 and P2 of topology
equivalent Reeb patterns belonging, respectively, to R1 and
R2 are detected. Then, the set M of all possible mappings m
between topology equivalent Reeb patterns of P1 and P2 (m :
P1 → P2 ) is computed. In practice, the average cardinality
of M is 20. For each mapping m, an expansion algorithm
simultaneously expands the common sub-graphs G1m and G2m
in R1 and R2 .
Each mapping m is scored relatively to the geometrical
similarity S(m) between the two common sub-graphs G1m and
G2m .S(m) is computed by comparing the unfolding signatures
λφi and λφj of the pairs of matched Reeb charts Ci and Cj .
Let m∗ maximize on M the similarity S between its related
sub-graphs G1∗ and G2∗ . The similar sub-parts of two closed 2manifolds M 1 and M 2 are identified by G1∗ and G2∗ . Moreover,
the partial similarity between M 1 and M 2 is given by S(m∗ ).
Algorithm 1 summarizes the overall process.

Algorithm 1 Partial shape retrieval algorithm overview.
Compute the query shape’s Reeb graph Rq
for all Ci ∈ Rq do
Compute Ci unfolding signature.
end For
Compute Rq structural signatures.
for all Rc in the collection index do
Compute the set M of mappings m between
topology equivalent Reeb patterns of Rq and Rc .
for all m ∈ M do
Expand recursively m to patterns’ neighbour charts.
Evaluate S(m).
end for
Return S(m∗ ) as the partial
similarity between Rq and Rc
end for
Sort the collection entries according to their partial
similarity to the query shape.

3.1. Reeb graph segmentation
Definition 1 (Reeb graph) Let f : M → R be a simple
Morse function defined on a compact manifold M. The Reeb
graph R(f ) is the quotient space on M × R by the equivalence
relation (p 1 , f (p 1 )) ∼ (p 2 , f (p 2 )), which holds if f (p 1 ) =
f (p 2 ) and p 1 , p 2 belong to the same connected component
of f −1 (f (p 1 )).
To deal with invariance to rigid transformations and robustness to non-rigid ones, we compute the Reeb graph of
the input 2-manifold (represented by a triangulation noted
T) using a function based on geodesic distances. In particular, to introduce some visual semantics in the segmentation,
we automatically extract feature points (vertices located on
the extremity of prominent components, see implementation
details in Section 3.3). For each vertex v ∈ T , f (v) = δ(v,
vf ) where δ stands for the geodesic distance and vf for the
closest feature point from v. Figure 2(a) shows the level lines
of f and the feature points of T (in green). This computation
of the f function has been preferred to the integral geodesic
approximation [HSKK01] or a harmonic function [NGH04]
because it gives better emphasis on local shape features (like
fingers or ears) thanks to the feature points, which is crucial
for partial matching.
Definition 2 (Reeb chart) Let : M → R(f ) map each point
p of M to its equivalence class in R( f ). Let E = {E 0 , . . . En }
be the edges (maximally connected unions of equivalence
classes containing only regular points of f ) of the Reeb graph
R( f ). Ci = −1 (Ei ) is defined as a Reeb chart.
Figure 2(b) shows a dual Reeb graph (where each edge
Ei is collapsed in a coloured node and where black arcs
represent adjacency relations between edges). Figure 1 gives
more example of feature points, f functions and dual Reeb
graphs. Figure 2(c) and 2(d) show the segmentation of the
hand model into its Reeb charts. Basically, Reeb charts are
the surface patches that correspond to the nodes of the dual
Reeb graph.
Statement 1 (Reeb chart topology) Reeb charts of a compact closed orientable 2-manifold have either disk or annulus
topology whatever the genus of the manifold is.
This statement can be briefly argued as follows. By definition, an edge Ei has two extremities, whose pre-images by
are circles which form the two boundary components of
the closure of the chart Ci . Hence, the closure of the Reeb
charts has two boundary components. Morever, Ci has genus

c 2008 The Authors
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

44

J. Tierny et al. / Partial 3D Shape Retrieval by Reeb Pattern Unfolding

Figure 1: Feature points and f functions (first row) and dual Reeb graphs (second row) of several surface models.

Figure 2: Segmentation of a hand surface model into its
Reeb charts.
zero. Thus Reeb charts have the topology of an open annulus
(by definition, critical points and, particularly, saddle points
equivalence classes are not included in Reeb charts).
Disk-like Reeb charts constitute a specific case. We call a
disk-like Reeb chart a Reeb chart which is adjacent to only
one local extremum of f . As the related boundary component
collapses to a point (the extremum), that kind of chart is given
the topology of an open disk.
In Figure 2(d), disk-like Reeb charts have been coloured
in blue and annulus-like ones in red. Notice that this decomposition brings a certain visual semantic: each of the fingers
of the hand model forms a distinct chart.

Figure 3: Disk-like chart unfolding signature computation.

thumb of the hand of Figure 2 has been mapped to the planar
domain D.
Let ρ(p) ∈ ]0, 1[ be the normalized absolute difference of
f values between O and a point p ∈ Ci , as shown in Figure 3.
Consequently to the Reeb chart definition, the sub-level set
of ρ ({(p 1 , p 2 . . . pn )|ρ(p 1 , p 2 , . . . pn ) < ρ 0 }) have also disk
topology, as illustrated by the white sub-level set in Figure 3.
As ρ increases, the shape of the ρ sub-level sets varies. Thus
it induces an evolution in the distortion introduced by their
mapping to D. Consequently, to capture the evolution of the
sub-level set shape variation, the unfolding signature λφi of
φ i is defined as follows:
λφi (ρ) =

3.2. Reeb chart unfolding signatures
To achieve efficient pose-insensitive geometrical signature
computation for each Reeb chart Ci , we propose to characterize Ci by parameterisation techniques [WWJ∗ 06, TVD07],
especially by its mapping φ i to the canonical planar domain
D. In particular, we propose to compute Ci unfolding signature [TVD07], a concise vector that describes the evolution
of the area distortion introduced by a planar mapping, as
summarized below. Thanks to the Reeb graph properties,
only two cases had to be considered: disk-like charts and
annulus-like charts (cf. statement 1).
Given a disk-like chart Ci , let O be the local extremum
of f it contains and B its boundary. We let φ i map O to the
centre of the unit planar disk, B to its boundary and f level
lines to concentric circles, as shown in Figure 3, where the

ACi (ρ)
ACi (ρ)
=
,
AD (ρ)
πρ 2

(1)

where ACi (ρ) stands for the area of the sub-level set for
parameter ρ on the original surface (Ci ) and AD (ρ) stands
for the area of the sub-level set on D. ACi (ρ) is computed by
summing the areas of the related triangles of T (after having
normalized edge length by f , similarly to ρ).
Roughly, λφi (ρ) depicts the stretch one has to apply on the
chart to map it to a disk as ρ increases.
As shown in [TVD07], as f is based on geodesic distances, the parameterisation (and thus its signatures) is invariant to rigid transformations and robust to non-rigid transformations. Moreover, it is also robust to surface noise.
An analog reasoning can be applied for annulus-like charts.
Let B 1 be the boundary of shortest perimeter of an annuluslike chart Cj and B 2 the other one. In this case, we let φ j

c 2008 The Authors
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

J. Tierny et al. / Partial 3D Shape Retrieval by Reeb Pattern Unfolding

Figure 4: Annulus-like chart unfolding signature.

map B 1 to the inner boundary of the unit planar annulus and
B 2 to its outer boundary, as shown in Figure 4. By defining
the ρ parameter similarly to the previous case, the signature
λφj of φ j is computed as follows (1 is the inner radius of the
unit annulus):
λφj (ρ) =

ACj (ρ)
AD (ρ)

=

ACj (ρ)
π (ρ + 1)2 − π

.

(2)

45

mation). Then topological variations are encoded in the graph
at iterations where connected components of the level line
approximation (contour approximations) split or merge (see
[TVD08] for further details). As the algorithm visits one vertex per iteration, this process is equivalent to considering for
each vertex its visit iteration number as f value. This perturbation simulates value uniqueness (ii). Moreover, as additional
critical points located in areas where f is non-differentiable
are visited iteratively, they are attributed distinctly increasing values, cancelling pairs of extra maxima and saddles (i).
Additionally, if a contour approximation splits in k + 1 sets
from an iteration to another with k ≥ 2 (or if k + 1 contour
approximations merge into one), a multiple k-saddle unfolding strategy [EHZ01] is used to simulate k simple saddles.
This technique transforms degenerate critical points into nondegenerate ones (iii) [EHZ01, CMEH∗ 03].
At this stage of the framework, the input closed 2-manifold
M is concisely represented by a dual Reeb graph R, whose
nodes are accompanied with the unfolding signatures of corresponding Reeb charts. In particular, each unfolding signature is stored as a vector of real values (using a pre-defined
number of samples, 64 in all of our experiments).

3.3. Implementation details
For feature point extraction, among existing techniques
[KLT05, LZ07, TVD08], we used the approach described in
[TVD08] as at least two antipodal feature points are always
guaranteed to be extracted (so f can always be computed).
This technique proposes to identify the extremities of prominent components by intersecting the sets of extrema of two
scalar functions based on the geodesic distances to two automatically extracted antipodal vertices [TVD08]. It runs in
O(n log(n)) steps with n being the number of vertices in
the surface mesh and the extraction is robust to noise and
invariant to isometric transformations.
Regarding the Reeb graph computation, the geodesic distance to feature points function does not necessarily fulfill all
the requirements of a simple Morse function: (i) smoothness,
(ii) distinctly valued critical points and (iii) non-degenerate
critical points. Thus, we propose a strategy based on f perturbation to guarantee Reeb graph intrinsic properties (especially about the degree of its nodes). First, (i) f is not
differentiable in the configurations of the surface where
points are geodesic-equidistant from several feature points. In
the discrete setting, this phenomenon leads to the apparition
of additional maxima and saddles in these configurations. To
cancel these specific critical points, we propose a strategy
based on global perturbation, used in [TVD08] on a similar
function in the context of skeleton extraction. Starting from
the feature points (f minima in this paper), the algorithm iteratively visits the surface mesh by propagation, using a variant
of Dijkstra’s algorithm (which uses f as weight). Let v be the
vertex visited at a given step of such a sweep, the set of vertices candidate for visit (plus the edges linking them) form an
upper-value approximation of f −1 (f (v)) (level line approxi-

4. Reeb Pattern-based matching algorithm
The next step of the framework consists in shape partial
similarity estimation. Given two input 2-manifolds M 1 and
M 2 , the goal is to identify their similar sub-parts and to
evaluate their geometrical similarity.

4.1. Problem statement
Given two dual Reeb graphs R1 and R2 , the goal would be
to find an optimal injective mapping m∗ between a sub-graph
G1∗ ∈ R1 and a sub-graph G2∗ ∈ R2 which maximizes a similarity function S(m∗ ), computed relatively to the geometrical
signatures of the nodes matched by m∗ .
A brute-force approach to this problem consists in computing the set M of all the possible injective mappings
m : R1 → R2 , then identifying through an expansion process the common sub-graphs G1m ∈ R1 and G2m ∈ R2 (such
that m : G1m → G2m is an isomorphism) and finally evaluating their geometrical similarity S(m). The solution of the
problem would be the mapping m∗ ∈ M that would maximize S. Let n and k be, respectively, the number of nodes
of the largest and the smallest of the two dual Reeb graphs
n!
, which
to compare. With such an approach, |M| = (n−k)!
results in an exponential time complexity evaluation process. Moreover, in practice, as underlined by Messmer and
Bunke [MB98], graphs representing real world objects may
be affected by noise or distortion, motivating the use of errortolerant matching algorithm, whose complexity is generally
even greater than exact algorithms [MB98].

c 2008 The Authors
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

46

J. Tierny et al. / Partial 3D Shape Retrieval by Reeb Pattern Unfolding

Figure 5: Structural distortion on two visually similar and
topology equivalent Reeb patterns.
In the following paragraphs, we describe Reeb graph structural distortion and propose a structural signature for Reeb
patterns insensitive to such a distortion (avoiding the need for
error-tolerant matching algorithm). Finally, for partial similarity estimation, we dramatically reduce the search space
of the problem by considering the set of all the possible injective mappings between topology equivalent Reeb patterns
only.
4.2. Reeb pattern and structural distortion
Definition 3 (Reeb pattern) Let M be a compact closed 2manifold embedded in R3 , R(f ) its Reeb graph and Ci an
annulus-like Reeb chart. Let B + be the boundary component
of Ci with highest f value, noted fB + . Let M − be the sub-level
set of M associated to the fB + value (M − = {p ∈ M|f (p) <
fB + }). The Reeb pattern Pi associated to the annulus-like
Reeb chart Ci is the connected component of M − having B +
as only boundary component.
Figure 5 shows an Armadillo with its dual Reeb graph
and zooms in two Reeb patterns P 1 and P 2 and their related
sub-graphs G 1 and G 2 . Moreover, the annulus-like charts
associated to P 1 and P 2 have been marked with a red circle.
Roughly speaking, a Reeb pattern Pi is a surface sub-part
which includes nearby protrusions (this is a set of annulus
and disk-like charts, delimited by Ci boundary). Notice Reeb
patterns are not necessarily defined for each annulus-like
Reeb chart (they are not defined for pairs of charts forming
handles).

Figure 6: Structural signatures of a genus-0 and a genus-1
Reeb pattern.

perturbations on the function can drastically change the properties of the critical points. In particular, in our case, a
slight perturbation on the surface (and thus on the function) can change the sequence of bifurcations and junctions
in the corresponding dual Reeb graph. As a consequence, in
Figure 5, the sub-graph G 1 first bifurcates in the A-labelled
region while the sub-graph G 2 first bifurcates in the Blabelled region. Consequently, no isomorphism exists between G 1 and G 2 while the two related Reeb patterns (the
hands of the Armadillo) are visually similar and topology
equivalent. We refer to this phenomenon as Reeb graph structural distortion.
To overcome this issue, in order to compare topology
equivalent Reeb patterns despite structural distortion, we introduce the notion of structural signature of a Reeb pattern.
Definition 4 (Reeb pattern structural signature) Let M
be a compact closed 2-manifold embedded in R3 and Pi a
Reeb pattern associated to an annulus-like Reeb chart Ci .
Let nD (Pi ) and nA (Pi ) be, respectively, the number of disklike and annulus-like Reeb charts included in Pi . The couple
(nD (Pi ), nA (Pi )) is the structural signature of Pi .
Statement 2 (Structural signature topological properties)
The structural signature of Pi describes Pi topology since
nD (Pi ) and nA (Pi ) are linked by the following relation:
nD (Pi ) = nA (Pi ) + 1 − 3gPi

(3)

with gPi the genus of the Reeb pattern.

Dual Reeb graphs can suffer from noise and distortion.
From our experiences, feature point extraction is very stable
on similar objects. This means very few noise due to inexact feature point extraction will appear. However, dual Reeb
graphs still suffer from distortion.

A proof of Equation (3) is given in Appendix A. By definition, all Reeb patterns are 2-manifolds with one boundary. In
term of topology description, only their genus differs. Thus
their topology is fully described through their structural signature. Moreover, this signature does not encode the way the
bifurcations and junctions are sequenced in the Reeb pattern.
Thus it does not depict structural distortion.

Morse theory [Mil63] states that any smooth function on a
manifold can be transformed into a Morse function by a slight
perturbation, which transforms degenerate critical points into
non-degenerate ones. This result depicts the fact that small

Figure 6 gives two examples of structural signatures of a
genus-0 and a genus-1 Reeb pattern. In the rest of the approach, structural signatures help us both overcoming structural distortion and reducing the search space of the problem.

c 2008 The Authors
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

J. Tierny et al. / Partial 3D Shape Retrieval by Reeb Pattern Unfolding

47

Figure 8: Expansion process from two topolgy equivalent
Reeb patterns P 1 and P 2 . Steps 1, 2 and 3 are depicted by
blue arrows.

Figure 7: Expansion example: for a given combination of
topology equivalent Reeb patterns ((P 1 , P 2 ) and (P 3 , P 4 )),
the expansion algorithm tries to expand as much as possible
the common sub-graphs (in bold in the second row).

4.3. Maximally similar common sub-graph
approximation
In the following paragraphs, we introduce an efficient approximation of the brute-force approach that does not consider all the node-to-node combinations but the topology
equivalent Reeb pattern to topology equivalent Reeb pattern
combinations only.

4.3.1. Reeb pattern combination enumeration
First, the structural signature of each Reeb pattern Pi of each
of the two dual Reeb graph R1 and R2 is computed.
Then, for each identified Reeb pattern Pi , we compute the
set of topology equivalent Reeb patterns (whose structural
signatures are identical) in the other graph. Let P1 and P2 be
respectively the sets of Reeb patterns of R1 and R2 that have
a homologue in the other graph (whose structural signatures
are identical).
Next, we compute the set M of all the possible injective
applications m : P1 → P2 that map a Reeb pattern P1 ∈ P1
to a homologue Reeb pattern P2 ∈ P2 . In our experiments,
the average cardinality of M is 20 (which has no comparison
n!
combinations of the brute-force approach).
with the (n−k)!

algorithm expands the initial mapping m by recursively visiting the nodes adjacent to associated Reeb patterns.
Step 1 Considering R1 and R2 as directed acyclic graphs
(the direction goes towards decreasing f values), the algorithm first visits the parent nodes Ci and Cj of P 1 and P 2 , as
shown in Figure 8 (step 1). If the degree or the type of Ci and
Cj differs, the expansion stops at this point and restarts from
another unvisited pair of topology equivalent Reeb patterns.
Otherwise, the expansion continues. In the case of orientable
2-manifolds, the degree of an equivalence class of a saddle
point in the Reeb graph always equals 3 [Ree46]. As a consequence, two more steps, at most, have to be considered
(labelled 2 and 3 in Figure 8).
Step 2 The step 2 recursively repeats steps 1, 2 and 3 in
this order. This means the expansion continues the same way
as far as visited nodes have the same degree. Moreover, it
stops when nodes corresponding to Reeb patterns explicitly
matched by m are reached.
Step 3 In step 3, the expansion continues with the same stopping condition. However, let CA and CB be two nodes that
have been matched in step 3. If their degree equals 3, a decision has to be taken as for the matching of their children
C 1 , C 2 and C 3 , C 4 (see Figure 8). Children whose Reeb
patterns are explicitly matched by m are by definition associated. Remaining nodes are matched according to their
degree and their structural signature. At this point, if no decision can be taken according to this criterion, the expansion
stops and restarts from another unvisited pair of homologue
Reeb patterns.
The output of this algorithm are two common sub-graphs
G1m and G2m , along with their node and Reeb pattern matches.

4.3.2. Expansion of common sub-graphs
Next, the common sub-graphs G1m ∈ R1 and G2m ∈ R2 are
built for each m thanks to an expansion algorithm that simultaneously visits R1 and R2 , starting by Reeb pattern
associations. As illustrated in the example of Figure 7, this

4.3.3. Intra-Reeb pattern node-to-node matching
The previous algorithm outputs node and Reeb pattern associations. In order to have a full node-to-node correspondence
between the two sub-graphs to compare, we have to find a

c 2008 The Authors
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

48

J. Tierny et al. / Partial 3D Shape Retrieval by Reeb Pattern Unfolding

Figure 9: Intra-Reeb pattern node-to-node matching (bipartite matching approximation).

node-to-node mapping for each pair of topology equivalent
Reeb patterns matched by m (like P 1 and P 2 in Figure 8).
Due to possible structural distortion, there might be no isomorphism between the sub-graphs G 1 and G 2 of P 1 and
P 2.
Consequently, intra-Reeb pattern node matching is driven
by geometrical similarity only running a bipartite matching
algorithm, which tries to match the most similar nodes while
maximizing the sum of similarities on the patterns. In practice, we run a polynomial approximation of this algorithm
as shown in Figure 9. Let CA and CB be, respectively, the set
of disk charts of P 1 and P 2 . For each chart CAi ∈ CA , the
charts of CB are sorted by decreasing values of the geometrical similarity function s ∈ [0, 1], as shown in the example of
Figure 9:
s(CAi , CBj ) = 1 − LN1 (CAi , CBj ),

(4)

where L N1 is the normalized L 1 distance between the unfolding signatures of CAi and CBj . Then, the pair of most
similar charts are matched. If conflicts occur (see CB1 in the
example of Figure 9), only the best matches ((CA1 , CB1 ) in
the example) are kept unchanged until no more conflict persists. By definition of the Reeb pattern structural signature
|CA | = |CB |, thus this algorithm is guaranteed to converge
to a solution. Finally, the same process is achieved for the
annulus-like charts of P 1 and P 2 . At this stage of the algorithm, m is a full node-to-node correspondence between G1m
and G2m .
4.3.4. Similarity estimation
In this step of the comparison, each mapping m is scored
relatively to the geometrical similarity S of associated common sub-graphs G1m and G2m . At this point, several similarity
functions can be defined. In our experiments, we use the
following function:
S(m) =

∀Ci ∈G1m (1

− LN1 (Ci , m(Ci )))α
|Rq |

.

(5)

Figure 10: Reeb chart (bright colors) and pattern (dark
colors) matching between a boy and a centaur. Unmatched
charts are black. Even though the hands do not have the same
number of fingers (some are stuck together on the left model
and count for one), they still have been matched.
In Equation (5), L N1 (Ci , m(Ci )) stands for the normalized L 1
distance between the unfolding signatures of Ci and m(Ci ).
α stands for a corrective parameter whose aim is to amplify
the geometrical similarity contribution (after training, α is
set to 4). Finally |Rq | stands for the number of nodes of the
dual Reeb graph that represents the query model presented to
the system. Notice this similarity measure does not respect
symmetry or triangular inequality (an object can share similar
parts with two other objects that are not similar).
Finally, the mapping m∗ that maximizes S is the approximation of the optimal solution m∗ . Moreover, G1∗ and G2∗
are the approximations of the most similar sub-parts of two
2-manifolds M 1 and M 2 , whose partial similarity is given by
S(m∗ ). Figure 10 shows an example of the approximated optimal mapping m∗ between two sub-graphs G1∗ and G2∗ of two
surface models, along with the node-to-node and pattern-topattern matching.
5. Experiments and Results
To assess the efficiency of the framework, we evaluate its
performance on the SHape Retrieval Contest (SHREC) 2007
partial retrieval benchmark [MPB07], and make some comparisons with the methods competing to this contest.
5.1. Partial retrieval benchmark description
This benchmark is composed of a data-set of 400 manifold models (grouped in 20 classes, see Figure 11) and of a
query-set of 30 manifold models (see Figure 12). The data-set
exhibits diverse variations, from pose change, to shape variability within a same class or topology variation (notice 4 of
the 20 classes contain non-zero genus surfaces). Each query
shares visually similar sub-parts with at least two classes of
the data-set. Figures 13, 14 and 15 show three examples of
typical queries and the models of the data-set retrieved by
our system. Moreover, for a given query, the ground-truth divides the data-set into Highly Relevant, Marginally Relevant

c 2008 The Authors
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

J. Tierny et al. / Partial 3D Shape Retrieval by Reeb Pattern Unfolding

Figure 11: SHREC 2007 data-set snapshot (one class per
row: ants, armadillos, bearings, birds, bustes, chairs, cups,
fishes, four-legs, glasses, hands, humans, mechanics, octopuses, planes, pliers, springs, tables, teddies and vases).

and Non-Relevant class groups. This granularity enables to
precisely evaluate the relevance of the results returned by
the system. In particular, each relevance group is associated
to a specific score, used in the computation of the Normalized Discounted Cumulated Gain (NDCG) vector. Roughly
speaking, the higher is the NDCG[i] value, the more relevant
are the top-i results. Such a performance measure provides
a relevance overview over the whole the data-set. Moreover,
it can take into account several classes for scoring a query,
which is important for partial similarity since a query can be
partially similar to several classes of objects. Furthermore,
it is the only performance measurement taken into account
in the contest (for more details, we defer the reader to the
contest proceedings [MPB07]).

5.2. Experimental setup
The 400 models of the data-set are first indexed off-line.
During the off-line process, the dual Reeb graph and the
related unfolding signatures (using 64 samples) are computed
for each model and stored into the index file of the data-set.
During the on-line process, the dual Reeb graph and the
unfolding signatures of the query are first extracted. Then, its
dual Reeb graph is compared with each graph of the index as
described previously. Finally, the entries of the data-set are
sorted by decreasing values of partial similarity. Depending
on the number of vertices in the query surface mesh and the

49

Figure 12: SHREC 2007 query-set snapshot.

size of the dual Reeb graph, the full processing time of a
query varies from 4 to 30 seconds on a 3GHz P4 PC.

5.3. Framework performance evaluation
First, from a qualitative point of view, Figures 13, 14 and
15 give a good overview of the efficiency of the framework.
For example, in Figure 13, the query is a centaur (half-horse,
half-human) and thus most of the top-results are humanoid
models (first horses are retrieved at rank 15), even if they are
not globally similar to the query. Figure 14 demonstrates the
method’s ability to handle non-zero genus surfaces (the case
of the two outliers, rank 6 and 7, is discussed in the limitation
dedicated Section 5.5).
From a more quantitative point of view, in the first experiment, we compare the average NDCG vector of our approach
with those of the methods competing the contest [CDS∗ 05,
BMSF06] (as reported in the contest proceedings [MPB07]).
Such a vector is the average of the 30 NDCG vectors corresponding to the 30 models of the query-set. Figure 16 shows
the curves corresponding to these vectors. As the RPU curve
is higher than the others, it is obvious that it outperforms related methods. Moreover, to quantify its improvement, we
introduce the NDCG vector gain G, which is the ratio of the
area between two curves and the area below the lowest one:
G(A, B) =

400
i=1 (N DCG[i]A − N DCG[i]B )
.
400
i=1 N DCG[i]B

(6)

c 2008 The Authors
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

50

J. Tierny et al. / Partial 3D Shape Retrieval by Reeb Pattern Unfolding

Figure 13: A query from the SHREC 2007 query-set (a centaur) and the top-7 results retrieved by the system.

Figure 14: A genus-1 query from the SHREC 2007 query-set and the top-7 results retrieved by the system.

Figure 15: Another query from the SHREC 2007 query-set (an Armadillo composed with a plane) and the top-7 results retrieved
by the system. Notice that Armadillos have been retrieved despite their different poses.
(see Section 4.3.4) on the retrieval performances. In particular, we consider the function S 1 that returns the size of the
common sub-graphs (the maximally similar common subgraphs become then the maximum common sub-graphs). We
also consider the function S 2 where the unfolding signatures
have been replaced by the geometrical attributes used by Hilaga et al. [HSKK01]. The related curves are reported in
Figure 17. This figure shows that performances comparable to the other methods are obtained with S 2 . Moreover, it clearly demonstrates the gain provided by unfolding
signatures.
5.4. Robustness evaluation

Figure 16: Average normalized discounted cumulated gain
(NDCG) vectors for Reeb pattern unfolding (RPU), Extended
Reeb Graphs (ERG) and curve-skeleton based many-to-many
matching (CORNEA) on the SHREC 2007 data-set.
With such a measure, the gain on the methods by Biasotti
et al. [BMSF06] and Cornea et al. [CDS∗ 05] is, respectively,
of 14.1% and 40.9%. In the second experiment, we evaluate the impact of the choice of the similarity function S

As the dual Reeb graph construction and the unfolding signature computation are based on normalized geodesic distance
evaluation, the approach is guaranteed to be invariant against
rigid-transformations. Moreover, Figure 15 demonstrates its
robustness against non-rigid transformations, since Armadillos in different poses have been retrieved as top results. In
the third experiment, we investigate the framework robustness against surface noise. In particular, for each element of
the query-set, we added a surface noise whose amplitude is
bounded by, respectively, ±0.5% and ±1% of the lengths of
the bounding box of the model, as shown in Figure 18. The

c 2008 The Authors
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

J. Tierny et al. / Partial 3D Shape Retrieval by Reeb Pattern Unfolding

51

5.5. Discussion and limitations

Figure 17: Contribution of the chart unfolding signatures
to the performances.

Figure 18: Surface noise on a SHREC 2007 query.

As other structural based approaches, the surface decomposition step of the framework introduces a bias in the comparison process. To guarantee stability and performance, this
decomposition has to be stable within a same class of objects
and moreover coherent with the data-set ground-truth. The
bias introduced in the presented technique is based on feature point extraction (which drives the surface segmentation).
Hence, this stage is a critical part of the framework and impacts its performances. In practice, with the SHREC data-set,
feature extraction turns out to be homogeneous within most
classes. As a counter-example, the four legs class is composed
of models representing distinct types of animals, having different protrusions (with or without tail, horns, etc.) and thus
leads to slightly distinct decompositions. In the future, we
would like to investigate other decomposition strategies that
would overcome this issue but still take into account local
shape features.
Moreover, as the decomposition and matching processes
are topology based, the overall framework is quite sensible
to topology variations within a same class of objects. For
example, most of humanoids are modelled with genus zero
surfaces but if a humanoid’s feet are stuck to each other the
related surface will have genus one and consequently the
legs will mainly match with objects having handles. Same
remarks go to the example of Figure 14, where the topology
influences the results: the genus-1 part of the query is matched
with the back of the chair (rank 6) while its left bent appendix
is matched with one of the chair’s (rank 6) and table’s (rank
7) legs (the unfolding signatures are bending insensitive). In
the future, the combination of local and structural approaches
is worth being studied to overcome this issue.

6. Application to Modelling by Example

Figure 19: Robustness evaluation of RPU with a noisy version of the SHREC 2007 query-set. Even with a surface noise
of ± 0.5%, RPU still outperforms state-of-the-art techniques
scores on clean data.

NDCG vectors with such corrupted query-sets have been reported in Figure 19. These curves demonstrate the stability
of the algorithm despite the noise. Moreover, even with a surface noise of ± 0.5%, it stills outperforms ERG [BMSF06]
scores on clean data.

To demonstrate the applicative interest of the framework,
we designed an intelligent modelling-by-example system
[FKS∗ 04]. Figures 20 and 21 show typical use examples.
First, the user queries the data-set through our partial shape
retrieval system. Then, he/she selects on the query the Reeb
patterns (or Reeb pattern sub-parts) he/she wants to remove
(in red, green and blue in figure 20(a)). Next, the system automatically highlights the parts of the retrieved results candidates for swapping, based on our graph matching algorithm.
The user then selects the retrieved results and cut the desired
parts (highlighted or not, figures 20(c), 20(d) and 20(f)).
After scaling, rotating and translating the parts according
to his/her needs, the cut sub-parts are pasted back onto the
query model (figure 20(b)). In our experiments, boundaries
are simply re-meshed but more visually appealing methods
can be employed for gluing parts [SBSCO06]. Thanks to the
partial shape retrieval and the part swapping suggestions, a
novice user can intuitively and rapidly create new 3D shapes

c 2008 The Authors
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

52

J. Tierny et al. / Partial 3D Shape Retrieval by Reeb Pattern Unfolding

this work was to take advantage of Reeb graph theory properties to improve both the shape description and comparison
processes. Extensive experiments demonstrated the improvement of each of these steps, resulting in an overall gain of,
respectively, 14.1% and 40.9% on the methods by Biasotti
et al. [BMSF06] and Cornea et al. [CDS∗ 05]. Moreover, the
robustness to rigid and non-rigid transformations and surface noise has been shown. Finally, queries are processed in
interactive time (from 4 to 30 seconds).
However, shape topological description might be too discriminant in some particular cases. For example, humanoids
can be modelled with closed fists or open hands, resulting in
different Reeb graphs and thus penalized partial similarity.
This is a major drawback of topology-based approaches. In
the future, the combination of local and structural approaches
is worth being studied.
Figure 20: Modelling a cow-horse by example: the user
selects on the query, then on the retrieved results (second
row), the Reeb patterns to be exchanged.

Moreover, input surface models are required to be manifold. In the future, we would like to adapt the framework
to more general mesh models. Reeb graph construction algorithms for non-manifold surfaces can be a starting point
[PSBM07].
Finally, as dynamic meshes (3D plus time) are becoming
more and more popular, in the future, we would like to investigate the use of Reeb graphs of higher dimension manifolds
[EHMP04] for the partial retrieval of 3D dynamic shapes.
We believe this research topic is one of the next challenges
of the shape retrieval community and could result in nice user
applications like animation-by-example systems.

Acknowledgements
The SHREC data-set is courtesy of AIM@SHAPE. A big
extra special super thank goes to Simone Marini (IMATI) for
his help on the benchmark. We also thank the anonymous
reviewers for their help on the paper, especially for their
inspiring remarks about the proof of appendix A. This work
is partially supported by the ANR (Agence Nationale de
la Recherche) through MADRAS project (ANR-07-MDCO015).
Appendix A: nD ( P) = nA ( P) + 1 − 3gP
Figure 21: Modelling a new woman model by example, composing both synthetic and scanned models.

Proof Let f be a simple Morse function defined on a compact
closed and orientable 2-manifold M and R(f ) its Reeb graph.

with high geometric details based on the example parts of
interest retrieved by our system.

Let P be a Reeb pattern defined relatively to R(f ). By
definition, P is a compact 2-manifold with one boundary
component.

7. Conclusion
In this paper, we presented a novel approach for fast and
efficient partial 3D shape retrieval. The main contribution of

Let P be the compact and orientable 2-manifold without boundary obtained by the closure of the boundary of P
(where the unique boundary component of P is glued by contraction to a point, as shown in Figures 22 and 23). Let f be
a simple Morse function defined on P such that it has the

c 2008 The Authors
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

J. Tierny et al. / Partial 3D Shape Retrieval by Reeb Pattern Unfolding

53

number of f local minima, saddles and maxima. In Figures
22 and 23, each critical point is marked with a number of
concentric circles equal to its index i.
Disk-like Reeb chart enumeration

Figure 22: Enumeration of the disk-like Reeb charts of a
Reeb pattern. Left: Original Reeb pattern P. Right: Reeb
pattern P after the closure of the unique boundary component of P. Disk-like Reeb charts are in blue.

Let nD (P ) be the number of disk-like Reeb charts of P . By
definition, each disk-like Reeb chart of P is exactly adjacent
to one local extremum of f . Moreover, the degree in R(f )
of equivalence classes of minima and maxima equals one
[Ree46] (see Figure 22, right). Then, a local extremum of f
can only be adjacent to one disk-like Reeb chart of P . Thus
nD (P ) = μ0 (f ) + μ2 (f ).

(9)

Moreover, by definition, f has exactly the same set of critical
points and critical values on P than f on P, plus one maximum due to the closure of the boundary component of P
(see Figure 22). Consequently, P and P have the same Reeb
chart decomposition at the exception of the chart adjacent
to the additional maximum of f , which is transformed from
an annulus-like Reeb chart (in P, Figure 22, left) to a disklike Reeb chart (in P , Figure 22, right) by the closure of the
unique boundary component of P. Hence
nD (P ) = nD (P ) − 1 = μ0 (f ) + μ2 (f ) − 1.
Figure 23: Enumeration of the annulus-like Reeb charts of a
Reeb pattern. Left: Original Reeb pattern P. Right: Reeb pattern P after the closure of the unique boundary component
of P. Annulus-like Reeb charts are in red.
same set of critical points and critical values on P than f on
P, plus one maximum (due to the closure of the boundary
component of P). f has distinctly valued critical points and
all its critical points are non-degenerate. f is indeed a simple
Morse function. For example, in Figures 22 and 23, f and f
are the height functions. Let R(f ) be the Reeb graph of f
(depicted by black arrows on Figures 22 and 23, right).
On the first hand, the Euler characteristic χ (P ) of P is
given by the generalized Euler relation [FK97] (where g P is
the genus of P ):
χ (P ) = 2 − 2gP .

(7)

On the other hand, the Euler characteristic χ (P ) of P can
also be expressed by the Morse-Euler formula [FK97] since
P is a closed manifold (where k = 2 is the dimension of the
manifold):

(10)

Annulus-like Reeb chart enumeration
Let nA (P ) be the number of annulus-like Reeb charts of
P . R(f ) is a finite and connected 1-D simplicial complex [Ree46]. Consequently, it can be considered as a planar
graph, whose vertices are the equivalence classes corresponding to critical points of f and whose edges correspond to the
Reeb charts of P . Then, the Euler relation for planar graphs
holds
χ (R(f )) = VR(f ) − ER(f ) + FR(f ) = 2,

(11)

where V R(f ) is the number of critical points of f :
VR(f ) = μ0 (f ) + μ1 (f ) + μ2 (f ),

(12)

where E R(f ) is the number of Reeb charts of P :
ER(f ) = nD (P ) + nA (P )

(13)

and where F R(f ) is the number of faces of the planar graph
(with L R(f ) the number of loops in R(f )):
FR(f ) = LR(f ) + 1.

(14)

k

χ (P ) =

(−1)i μi (f ) = μ0 (f ) − μ1 (f ) + μ2 (f ).
i=0
(8)

In Equation (8), μ i (f ) stands for the i th Morse number of f ,
which is equal to the number of f critical points of index i.
In particular, μ 0 (f ), μ 1 (f ) and μ 2 (f ) are, respectively, the

Moreover, R(f ) has g P loops [CMEH∗ 03] (with g P the
genus of P ). Then, Equations (11), (12), (13) and (14) become:
χ (R(f )) = 2 = μ0 (f ) + μ1 (f ) + μ2 (f )
− (nD (P ) + nA (P )) + gP + 1.

(15)

c 2008 The Authors
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

54

J. Tierny et al. / Partial 3D Shape Retrieval by Reeb Pattern Unfolding

[BKS*05] BUSTOS B., KEIM D. A., SAUPE D., SCHRECK T.,
VRANIC D. V.: Feature-based similarity search in 3D object
databases. ACM Computing Surveys 37 (2005), 345–387.

Thanks, to Equation (9), we have:
2 = μ1 (f ) − nA (P ) + gP + 1
nA (P ) = μ1 (f ) + gP − 1.

(16)

Moreover, by definition, f has exactly the same set of
critical points and critical values on P than f on P, plus
one maximum due to the closure of the unique boundary
component of P (see Figure 23). Consequently, P and P
have the same Reeb chart decomposition at the exception of
the chart adjacent to the additional maximum of f , which is
transformed from an annulus-like Reeb chart (in P, Figure
23, left) to a disk-like Reeb chart (in P , Figure 23, right) by
the closure of the unique boundary component of P. Hence
nA (P ) = nA (P ) + 1
nA (P ) = μ1 (f ) + gP .

(17)

Relation between nD ( P) and nA ( P)
Consequently to Equations (10) and (17), Equation (8)
becomes:
χ (P ) = μ0 (f ) − μ1 (f ) + μ2 (f )
χ (P ) = nD (P ) + 1 − (nA (P ) − gP ).

(18)

Therefore, thanks to the Equation (7), we have the following
relations:
nD (P ) + 1 − nA (P ) + gP = 2 − 2gP
nD (P ) = nA (P ) + 1 − 3gP .

(19)

Moreover, by definition, the boundary of a Reeb pattern
is required to be composed of a single connected component. Then, the boundary of a Reeb pattern cannot lie on a
topological handle. Consequently, the closure of the unique
boundary component of P cannot modify its genus gP . Then
gP = gP .

(20)

Thanks to the Equation (20), we have the final result:
nD (P ) = nA (P ) + 1 − 3gP .

(21)

[BMS00] BIASOTTI S., MORTARA M., SPAGNUOLO M.: Surface compression and reconstruction using Reeb graphs
and shape analysis. In Spring Conference on Computer
Graphics (2000), pp. 175–184.
[BMSF06] BIASOTTI S., MARINI S., SPAGNUOLO M.,
FALCIDIENO B.: Sub-part correspondence by structural descriptors of 3D shapes. Computer-Aided Design Journal
38 (2006), 1002–1019.
[CDS*05] CORNEA N. D., DEMIRCI M. F., SILVER D.,
SHOKOUFANDEH A., DICKINSON S., KANTOR P. B.: 3D object
retrieval using many-to-many matching of curve skeletons. In IEEE Shape Modeling International (2005), pp.
366–371.
[CMEH*03] COLE-MCLAUGHLIN K., EDELSBRUNNER H.,
HARER J., NATARAJAN V., PASCUCCI V.: Loops in Reeb graphs
of 2-manifolds. In Symposium on Computational Geometry (2003), pp. 344–350.
[CSM03] COHEN-STEINER D., MORVAN J.-M.: Restricted delaunay triangulations and normal cycle. In Symposium on
Computational Geometry (2003), pp. 312–321.
[CTSO03] CHEN D. Y., TIAN X. P., SHEN Y. T., OUHYOUNG
M.: On visual similarity based 3D model retrieval. Computer Graphics Forum 22 (2003), 223–232.
[DJ06] DEY T. K., JIAN S.: Defining and computing curve
skeletons with medial geodesic function. In Eurographics
Symposium on Geometry Processing (2006), pp. 143–152.
[EHMP04] EDELSBRUNNER H., HARER J., MASCARENHAS A.,
PASCUCCI V.: Time-varying Reeb graphs for continuous
space-time data. In Symposium on Computational Geometry (2004), pp. 366–372.
[EHZ01] EDELSBRUNNER H., HARER J., ZOMORODIAN A.: Hierarchical Morse-Smale complexes for piecewise linear
2-manifolds. In Symposium on Computational Geometry
(2001), pp. 70–79.
[FK97] FOMENKO A., KUNII T.: Topological Modeling for
Visualization. Springer-Verlag, 1997.

References
[AHLD07] AUJAY G., H´ETROY F., LAZARUS F., DEPRAZ C.:
Harmonic skeletons for realistic character animation. In
Symposium on Computer Animation (2007), pp. 151–160.

[FKS*04] FUNKHOUSER T., KAZHDAN M., SHILANE P., MIN P.,
KIEFER W., TAL A., RUSINKIEWICZ S., DOBKIN D.: Modeling
by example. ACM Transactions on Graphics 23 (2004),
652–663.

[BGSF08] BIASOTTI S., GIORGI D., SPAGNUOLO M.,
FALCIDIENO B.: Reeb graphs for shape analysis and applications. Theoretical Computer Science 392 (2008), 5–22.

[FMK*03] FUNKHOUSER T., MIN P., KAZHDAN M., CHEN J.,
HALDERMAN A., DOBKIN D.: A search engine for 3D models. ACM Transactions on Graphics 22 (2003), 83–105.

c 2008 The Authors
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

J. Tierny et al. / Partial 3D Shape Retrieval by Reeb Pattern Unfolding

55

[FS06] FUNKHOUSER T., SHILANE P.: Partial matching of 3D
shapes with priority-driven search. In Eurographics Symposium on Geometry Processing (2006), pp. 131–142.

[MGP06] MITRA N. J., GUIBAS L., PAULY M.: Partial and
approximate symmetry detection for 3D geometry. ACM
Transactions on Graphics 25 (2006), 560–568.

[GCO06] GAL R., CCOHEN-OR D.: Salient geometric features for partial shape matching and similarity. ACM
Transactions on Graphics 25 (2006), 130–150.

[Mil63] MILNOR J.: Morse Theory. Princeton University
Press, 1963.

[GSCO07] GAL R., SHAMIR A., COHEN-OR D.: Pose oblivious shape signature. IEEE Transactions on Visualization
and Computer Graphics 13 (2007), 261–271.

[MPB07] MARINI S., PARABOSCHI L., BIASOTTI S.: SHape
Retrieval Contest 2007: Partial matching track. In SHREC
(in conjunction with IEEE Shape Modeling International)
(2007), pp. 13–16.

[HKDH04] HUBER D., KAPURIA A., DONAMUKKALA R.,
HEBERT M.: Parts-based 3D object classification. In IEEE
Computer Vision and Pattern Recognition (2004), pp. 82–
89.

[NGH04] NI X., GARLAND M., HART J.: Fair Morse functions for extracting the topological structure of a surface
mesh. ACM Transactions on Graphics 23 (2004), 613–
622.

[HSKK01] HILAGA M., SHINAGAWA Y., KOHMURA T., KUNII
T.: Topology matching for fully automatic similarity estimation of 3D shapes. In SIGGRAPH (2001), pp. 203–212.

[PSBM07] PASCUCCI V., SCORZELLI G., BREMER P. T.,
MASCARENHAS A.: Robust on-line computation of Reeb
graphs: Simplicity and speed. ACM Transactions on
Graphics 26 (2007), 58.1–58.9.

[IJL*05] IYER N., JAYANU S., LOU K., KALYANARAMAN Y.,
RAMANI K.: Three-dimensional shape searching: State-ofthe-art review and future trends. Computer-Aided Design
Journal 37 (2005), 509–530.
[JH99] JOHNSON A. E., HEBERT M.: Using spin-images
for efficient multiple model recognition in cluttered 3D
scenes. IEEE Transactions on Pattern Analysis and Machine Intelligence 21 (1999), 433–449.
[JZ07] JAIN V., ZHANG H.: A spectral approach to shapebased retrieval of articulated 3D models. Computer-Aided
Design Journal 39 (2007), 398–407.
[KLT05] KATZ S., LEIFMAN G., TAL A.: Mesh segmentation using feature point and core extraction. The Visual
Computer 21 (2005), 865–875.
[KSDD03] KESELMAN Y., SHOKOUFANDEH A., DEMIRCI M.,
DICKINSO S.: Many-to-many graph matching via metric
embedding. In IEEE Computer Vision and Pattern Recognition (2003), pp. 850–857.
[LZ07] LIU R., ZHANG H.: Mesh segmentation via spectral embedding and contour analysis. Computer Graphics
Forum 26 (2007), 385–394.
[LZQ06] LIU Y., ZHA H., QIN H.: Shape topics: a compact
representation and new algorithms for 3D partial shape retrieval. In IEEE Computer Vision and Pattern Recognition
(2006), pp. 2025–2032.
[MB98] MESSMER B. T., BUNKE H.: A new algorithm
for error-tolerant subgraph isomorphism detection. IEEE
Transactions on Pattern Analysis and Machine Intelligence 20 (1998), 493–504.

[Ree46] REEB G.: Sur les points singuliers d’une forme
de Pfaff compl`etement int´egrable ou d’une fonction
num´erique. Comptes-rendus des S´eances de l’Acad´emie
des Sciences 222 (1946), 847–849.
[SBSCO06] SHARF A., BLUMENKRANTS M., SHAMIR A.,
COHEN-OR D.: Snappaste: An interactive technique for
easy mesh composition. The Visual Computer 22 (2006),
835–844.
[TS05] TUNG T., SCHMITT F.: The augmented multiresolution Reeb graph approach for content-based retrieval of
3D shapes. International Journal of Shape Modeling 11
(2005), 91–120.
[TV04] TANGELDER J. W. H., VELTKAMP R. C.: A survey of
content based 3D shape retrieval methods. In IEEE Shape
Modeling International (2004), pp. 145–156.
[TVD07] TIERNY J., VANDEBORRE J.-P., DAOUDI M.: Reeb
chart unfolding based 3D shape signatures. In Eurographics (2007), pp. 13–16.
[TVD08] TIERNY J., VANDEBORRE J.-P., DAOUDI M.: Enhancing 3D mesh topological skeletons with discrete contour
constrictions. The Visual Computer 24 (2008), 155–172.
[WWJ06] WANG S., WANG Y., JIN M., GG X., SAMARAS D.:
3D surface matching and recognition using conformal geometry. In IEEE Computer Vision and Pattern Recognition
(2006), pp. 2453–2460.
[ZMT05] ZHANG E., MISCHAIKOW K., TURK G.: Featurebased surface parametrization and texture mapping. ACM
Transactions on Graphics 24 (2005), 1–27.

c 2008 The Authors
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.


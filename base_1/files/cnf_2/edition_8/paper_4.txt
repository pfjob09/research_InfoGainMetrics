DOI: 10.1111/j.1467-8659.2007.01042.x

COMPUTER GRAPHICS

forum

Volume 27 (2008), number 1 pp. 47–62

A Dynamic Model of Cracks Development Based on a 3D
Discrete Shrinkage Volume Propagation
Gilles Valette1,2 , St´ephanie Pr´evost1 , Laurent Lucas1 and Jo¨el L´eonard2
1 CReSTIC/SIC/MADS,

EA3804 University of Reims Champagne-Ardenne, Reims, France
laurent.lucas@univ-reims.fr
2 INRA UR1158 Agronomie Laon-Reims-Mons, France

ABSTRACT
We attempt to model and visualize the main characteristics of cracks produced on the surface of a desiccating
crusted soil: their patterns, their different widths and depths and their dynamics of creation and evolution. In
this purpose we propose a method to dynamically produce three-dimensional (3D) quasi-static fractures, which
takes into account the characteristics of the soil. The main originality of this method is the use of a 3D discrete
propagation of ‘shrinkage volumes’ with respect to 2D precalculated paths. In order to get realistic cracks, we
newly propose to take into account a possibly inhomogeneous thickness of the shrinking layer by using a watershed
transformation to compute these paths. Moreover, we use the waterfall algorithm in order to introduce in our
simulation a hierarchy notion in the cracks appearance, which is therefore linked with the initial structure of the
surface. In this paper, this method is presented in detail and a validation of the cracks patterns by a comparison
with real ones is given.
Keywords: natural phenomena, shrinkage, desiccation, soil cracks, cracks patttern, cracks propagation
ACM CCS: I.3.5 [Computer Graphics]: Computational Geometry and Object Modeling – Physically based modeling; I.6.8 [Simulation and Modeling]: Types of Simulation – Visual

BUD04]. In such a context, cracks are known to have a positive effect because they constitute a path for both water and
plants.

1. Introduction
Cracking is a very common phenomenon on many different
types of surface and at several scales, and is thus of interest for
a widescientific community. The work presented here grew
out of a collaboration between computer graphics scientists
and soil scientists, the first being interested in adding plausibility to cracks patterns, to enhance the realism of natural
scenes, the second in the modeling of soil cracking, which is a
very important process governing the evolution of soil structure and having multiple impacts on soil functions [RS91].
This work focuses on a well defined situation: the cracking
of a thin crust at the soil surface during desiccation. Crusts
form during rainfall because of the detachment of soil particles by raindrops and their subsequent redistribution, either
by projection or transport in the flow [LBB93]. Such crusts
are widely present on cultivated soils, and they have a dominant influence on water dynamics [CV92], runoff and erosion
[LALR06] and seedling emergence [Arn65, AT85, RSB00,
c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and
Blackwell Publishing Ltd. Published by Blackwell Publishing,
9600 Garsington Road, Oxford OX4 2DQ, UK and 350 Main
Street, Malden, MA 02148, USA.

On a real soil, the determinism of soil cracking is highly
complex. The location of cracks in particular depends, among
other things, on small variations in soil moisture and soil resistance, on surface topography, on the location of topsoil
aggregates. So it is very difficult to predict exactly where,
when, to what extent, cracking will occur. The geometry of
well established crack networks has been the subject of numerous observations and some modeling attempts [Vel01,
HY00, PMRdM95]. However, although some features of a
crack network remain more or less constant, cracks are not
static and develop or disappear at a minute to day time scale.
We will thus concentrate our effort in the prediction of the
dynamics of the extension and development of cracks, using our method of ‘shrinkage volumediscrete propagation’.
As an extension to this work we also try to propose an

47

Submitted December 2006
Revised April 2007
Accepted August 2007

48

G. Valette, S. Pr´evost, L. Lucas and J. L´eonard / A Model of Cracks Development

alternative method to derive the geometry of the crack network, which is not based on the reproduction of observed
networks characteristics, but which tries to take into account
some easily accessible features of soil surface structure.
The method we present in this paper produces visually interesting images and animations of three-dimensional (3D)
cracks, with different characteristics controlled by a set of
intuitive parameters. As an example of the interest of our
method in the field of Computer Graphics (CG), we have
also applied it to 3D-meshes provided with a parameterization [VPL06a]. This paper is an extended version of a previous paper [VPL06b] where we have presented our model of
cracks. In this paper, after a brief review of related works, we
present this model in detail, giving an extended presentation
of our interpretation of stress relaxation, and we add two new
sections along with more illustrations and visual results: the
use of hierarchical watershed lines (Section 4.3), and the description of the validation of the cracks patterns by means of
two-dimensional (2D) image analysis (Section 6.3).

2. Related Work
In the CG literature, the reproduction of cracks is far from
being constrained to the soil. Cracks are applied to ceramics
[GC01], to paintings [PPD02], to trees [WWL∗ 03] and more
generally to any object represented as a 3D-mesh [OH99,
OBH02]. The models of quasi-static cracks can be roughly
subdivided into three main classes. Geometric models propose algorithms to get cracks pattern close to those produced
by nature. Perrier et al. [PMRdM95] applied a fractal fragmentation algorithm based on Dirichlet tessellation to generate cracks patterns at hierarchical scales. MacVeigh [Mac95]
created patterns based on line segments and circular arcs, with
respect to two characteristics: the cracks intersect at right angles and they are such so as to minimize their lengths. Horgan and Young [HY00] proposed a 2D stochastic geometric
model for 2D cracks patterns in clay soil which produces realistic patterns. However, some particularities are often not
presented by this type of model, as varied widths, the 3D
aspect, the presence of dead branches or the dynamics of
cracking.
On the contrary, physical approaches propose models
which tend to faithfully reproduce the dynamics of natural
cracks patterns. Their main drawback is their slowness. Furthermore, their principal aim is generally not the obtention
of visually interesting results. Skjeltorp and Meakin [SM88]
used a 2D lattice where the nodes are connected through
Hookean springs which break when a critical strain is exceeded. Hirota et al. [HTK98, HTK00] also applied a springnetwork model to compute 2D and 3D cracks formation in
a material. Vogel et al. [VHLR05b] expressed the desiccation, which causes the formation of cracks, by reducing
the relaxed length of springs. Federl [Fed02] adapted the
method of Skjeltorp and Meakin by incorporating growth.

He showed that mass-spring models are limited in their capacity to successfully model fracture formation on growing
domains. Therefore, Federl and Prusinkiewicz [FP04] used
another approach to fracture modeling, introduced for modeling inelastic deformation by Terzopoulos and Fleischer
[TF88] and based on solid mechanics and finite element models. This approach is more accurate but slower than the springnetwork approach.
Gobron and Chiba [GC01] proposed a completely different
“intuitive-physical” approach, based on their 3D cellular automaton (CA) model, for simulating realistic propagation of
various types of cracks on any triangulated surface. Inspired
by this work, Paquette et al. [PPD02] presented a system
for crack generation and peeling on flat layers such as paint.
These methods permit to visualize realistic cracks, but their
parameterization seems to be difficult. Moreover, they are
not directly linked with physical quantities, like those of a
desiccating soil.
O’Brien and Hodgins [OH99] succeeded in modeling and
animating brittle fractures by means of a finite element
method. Then O’Brien et al. [OBH02] applied this approach
to ductile fractures. Both papers present impressive graphical results and recently Iben and O’Brien have extended the
previously presented methods in order to address the issue
of quasi-static fractures [IO06]. They discretize the surface
by means of the finite element methods and can crack any
3D-mesh with an heuristic definition of stress fields. Cracks
appear on vertices and are propagated with a local remeshing.
Our approach differs from the preceding ones in several
original aspects:

r

r

r
r

r

the independent calculation of the cracks path can be done
automatically by using the different algorithms provided,
but it is possible as well to use any crack path network
provided by the user;
the use of a watershed transformation [VS91, Beu04]
to compute the cracks path has been implemented as a
simple way to take into account the thickness of the crust,
which is one of the determinants of the cracks location;
the propagation of the cracks can be either based on geometrical criteria or on a hierarchy using a waterfall algorithm [Beu94];
the calculation of the enlargement of cracks is automatic
and based on a 3D discrete propagation of shrinkage volumes, which takes into account some of the physical characteristics of the soil;
the width of a crack can automatically change during the
process.

3. Approach Overview
Figure 1 presents the pipeline of our cracking method. It takes
as inputs two heightmaps which builds a 3D-grid based model

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

G. Valette, S. Pr´evost, L. Lucas and J. L´eonard / A Model of Cracks Development

49

Figure 1: The pipeline of our cracking method, taking as inputs two heightmaps and producing as an output a triangulated
cracked surface.

Figure 2: Three possible cases for the terrain: (a) the height
H and the shrinking layer thickness T are constant, (b) H is
constant and T is variable, (c) H and T are variable.

which is detailed in Section 3.1. Our method is composed of
three main stages. The first stage is the computation of the
possible cracks paths which is the subject of Section 3.3. The
second stage is the evolution of the cracks: their creation and
their progression are explained in Section 4, and Section 5 is
devoted to the enlargement process and to the calculation of
the vertical shrinkage which can modify the heightmap. The
third stage is the simplest and consists in producing a triangulated surface from the possibly modified heightmap and
the geometry of the cracks, as it is explained in Section 6.1.

3.1 The model of terrain
Before describing our model in detail, we need to define what
we mean by “shrinking surface layer”, which corresponds to
the crust in the case of an agricultural soil. We define it by
its thickness which can be constant or variable. The surface
itself can be flat or raised (Figure 2). It is worth noticing that
the shrinking surface layer can be nil (as shown by T i in
Figure 2(c)).
The two parameters defining the terrain (the height H
and the shrinking layer thickness T) are given in a discrete
way by two heightmaps which are the inputs of our method
(Figure 1). A heightmap can be understood as a grey image:
white is the highest value, and black the lowest value. Except
for the particular case of constant values, these heightmaps
can be randomly generated or obtained by other means
(like laser profile metering of real terrain or erosion simu-

Figure 3: A terrain with its elementary cubic cells (a visible
cell in this image is actually 43 = 64 times bigger than one
actually used for the simulation process), and the detail of
the composition of one cell in our model.

lation algorithms—more precisions are given on this point in
Section 6).
In order to be able to treat the cracks evolution with a 3Dgrid based approach, the terrain is considered as a volume
of elementary cubic cells (Figure 3). We consider that the
heightmaps used for the height of the terrain and the shrinking
layer thickness have the same resolution. Therefore, the pixel
(i, j) of one of these maps corresponds to the cells column
(i, j) of the terrain (and to the particular first cell of this column
which is on the surface).
The soil system is composed of three different kinds of
components: soil, liquid and gas. We use a system where
these three phases are additive. Such a system is provided by
the use of specific volumes. We can write the total volume of
a soil sample as:
Vcell = Vm + Vl + Vg

(1)

where V m is the volume of matter, V l is the volume of liquid
and V g is the volume of gas. The volume of pores V p corresponds to the difference between the volume of the cell and

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

50

G. Valette, S. Pr´evost, L. Lucas and J. L´eonard / A Model of Cracks Development

into a volume of crack. We conclude that we can deduce
the volume of the cracks from a calculation of the shrinkage
volume accumulated in the cracked cells.

Figure 4: Pipeline of the shrinkage calculation. The parameters changed by a step are precised in parentheses.
the volume of the matter. So it is equal to the volume of liquid
and gas:
Vcell = Vm + V p

(2)

V p = Vcell − Vm = Vl + Vg .

(3)

In our model these quantities are stored in each cell as different substates.
3.2 The cracks enlargement
Our calculation of the cracks enlargement is based on the
variation of the pore volume in the soil (Figure 4). For soil
scientists, shrinkage is divided into three stages [OH98]. In
the first stage, called normal or basic shrinkage, the decrease
in the volume of water in saturated soil equals the decrease in
pore volume and the soil remains saturated. In the next stage,
called residual shrinkage, air enters the pores and the water
loss exceeds the decrease in pore volume. The last stage,
called zero shrinkage, occurs when the soil has reached its
densest configuration: water loss is not accompanied by any
further change in volume.
During the two first stages of the shrinkage process, the
pore volume in one cell decreases because of a loss of water due to evaporation which is not entirely compensated by
entering air. This creates a new quantity in this cell, representing a loss of volume. We call this quantity the “shrinkage
volume”. We formalize this new volume V sh by changing
Equation (2):
Vcell = Vm + V p + Vsh ,

(4)

where V cell and V m are constant. This shrinkage volume in
one cell represents the stress created by the shrinkage process
in this cell. This stress must be relaxed, in other words, this
volume must tend to null. As it can not be replaced by liquid
or gas, it must be replaced by some matter: this matter must
come from a neighbor cell, which also needs some matter
to replace its own shrinkage volume, and so on. If at least
a part of this matter is propagated horizontally, we assume
that this phenomenon could explain the formation and the
enlargement of cracks: a cell which is part of a crack is losing
all its matter which is distributed to other cells; in this cell,
the stress is relaxed by transforming the shrinkage volume

However, this model does not permit to distinguish between the cells meant to be cracked and the others. Thus, to
get this information, we use in our method a preexisting 2D
path, assuming that the possible paths of the cracks depend
on the structure of the shrinking layer and not on the dynamics of the shrinkage process. This path gives the position of
all possible cracked cells at the surface of our soil.
3.3 The cracks path
Assuming that the possible cracks path depends only on the
initial structure of the soil surface, we have chosen to precompute this path. Pre-breaking an object is not new. For example,
Neff et al. [NF99] used precomputed patterns in order to reproduce the breaking of an object by a blast, Desbenoit et al.
[DGA05] let the user edit the 2D fracture pattern and the
profile curves and then automatically map this model onto
the surface of the object. Our method uses a precalculated
path, but it is worth noticing that, although the progression of
the cracks is constrained by this path, it remains dynamic: the
cracks network is evolving with the time (cracks are growing,
new cracks appear); moreover, the final crack network can be
strictly included in the precalculated network: our method
can produce dead branches, and can even ignore complete
paths, reflecting the influence of the stress relaxation (i.e. in
our method, the shrinkage volume propagation).
We store the precalculated path as an undirected graph G:
the nodes are points of intersection (or final points of a path),
the edges contain the sequence of discrete points connecting two nodes, each point corresponding to a surface cell of
the shrinking layer. Any binary image with one pixel wide
discrete lines can be used as an input for our method. It can
be designed by the user or computed by an appropriate algorithm, e.g. a Dirichlet tessellation (also called Vorono¨ı tessellation) as in the work of Perrier et al. [PMRdM95]. Horgan
and Young [HY00] proposed an empirical stochastic model
to define the geometry of 2D cracks, such as will form in a
thin layer of soil. We use the results produced by this model
in two ways: statically, as a final pattern from which we extract nodes and edges of our graph, or dynamically, adding
to the edges of our graph information concerning the order
of creation of the crack which owns this edge. Further explanations of using this information in our method are given in
Section 4.3.
The drawback of such methods, which simply try to reproduce the geometry of the crack network, is that they do
not consider any information about the soil itself. For example, one observable feature which probably controls the
location of cracks in a soil crust is the thickness of the crust.
Some justifications of this hypothetized influence are the
following:

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

G. Valette, S. Pr´evost, L. Lucas and J. L´eonard / A Model of Cracks Development

r

r

51

it is well known that failure of the soil often occurs at
the periphery of soil aggregates rather than through aggregates; yet, the periphery of soil aggregates generally
constitutes low local elevation areas where crust thickness tends to be higher;
in contrast, we could expect that a crust of more or less
constant mechanical properties but varying thickness,
such as a depositional crust, will break where the resistance is lower, that is where the crust is thinner.

Because the influence of aggregate location, which has been
often reported, probably dominates the effect of crust thickness on its resistance, and because the thinner parts of a
crust generally corresponds to the borders of the crusted
area, where stress accumulation is limited, we hypothetized
that cracks would appear preferentially where the crust is
the thickest. We thus tried to derive the crack path by applying a watershed transform to the thickness map of the
crust, which constitute the shrinking layer, starting from
the maxima of the thickness map. Nevertheless, it is worth
noticing that it would have been easy as well to start
from the minima, cracks then appearing where the crust is
thinner.
The watershed transform treats a level of gray image as
a relief: the pixel (i, j) is considered as a point with a vertical coordinate proportional to its level of gray. This way,
all the pixels define some landscape. An algorithmic definition of the watershed transform by simulated immersion
was given by Vincent and Soille [VS91] and Beucher has
proposed an improved unbiased implementation of this algorithm [Beu04]. For this algorithm, the watershed transform fills up this landscape with water starting at the local minima (resp. maxima) and, at points where water coming from different basins would meet, builds dams. Thus,
these dams are built where the shrinking layer is the thickest (resp. the thinnest, depending on a preliminary choice).
As a final result, the landscape is partitioned into regions
(or “catchment basins”) separated by dams, called watershed lines or simply watersheds: this network of lines is
adequate to use as a crack pattern. It is well known that
the watershed method produces an oversegmentation of the
image, i.e. many small basins are produced due to many
local minima in the input image. There are two solutions,
smoothing the input image, or using a waterfall algorithm.
According to the scale-space theory for discrete signals, significant image features must be stable with respect to variations in scale [Lin94]. Thus, this drawback can be avoided
by smoothing the image before applying the watershed algorithm. In our case, that means that we can control the number of possible ways for the cracks by more or less smoothing the shrinking layer thickness map. The second solution
is to add the possibility of taking into account a hierarchy
amongst the watershed lines, which makes useless smoothing the shrinking layer image (more details are given in
Section 4.3).

Figure 5: Creation and progression of one crack in three
stages. Stage 1 shows the start point in the middle of an edge.
The crack begins to grow from this point towards the two
nodes of this first edge. The crack stops in 2a because it is an
extremity. In 2b and in 3, the crack chooses to continue on
the right because it is the closest direction to its own primary
direction.

4. Cracks Creation and Progression
Our algorithm for cracks evolution consists of three main
stages: creation of cracks, progression of active cracks, enlargement of cracks. The process can stop because either
there is no more change (the shrinkage process has reached
its maximum and all the edges have been used), or the total
length of cracks is equal to a predefined value, or the elapsed
(simulated) time exceeds a predefined duration. Moreover, as
an image can optionally be rendered and displayed at each
iteration, one can also decide to interrupt the procedure when
an interesting visual result is obtained.

4.1 Creation of cracks
We cannot put a potential start point of one crack in a node of
the graph G, because a node belongs to at least two different
cracks. So we must start from a point of one edge of the
graph G, an edge being a discrete line segment between two
junctions of different cracks. We arbitrarily chose the middle.
To select the points from which a new crack will actually start,
we arrange them in order from the highest down to the lowest
distance to the existing cracks. On this purpose we maintain a
distance map computed from the skeleton of the cracks by an
External Euclidean Distance Transformation [ST94]. When
a start point is selected, it is removed from the list of potential
start points. The choice of the distance as a criterion is based
on the following observation. The cracks of a clay soil tend
to subdivise an area in rather similar in size sub areas, and
they proceed with successive generations: the most recent
generation subdividing the regions created by the previous
one. In order to get a similar behaviour, the creation of a new
crack is made as far as possible from the existing cracks: the
result is to divide the enclosed region in sub areas of more or
less the same size.
In the nature all cracks do not appear at the beginning of the
process, nor do they appear one after the other. This behaviour
can be reproduced by using two parameters to decide if cracks
need to be created: a minimum number of active cracks m, and

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

52

G. Valette, S. Pr´evost, L. Lucas and J. L´eonard / A Model of Cracks Development

0.6
Void ratio

Moisture ratio

0.7

0.5
0.4
0.3
0.2
0.1
0

2

4
6
Time (days)

8

10

(a) Mean relationship between drying time
and moisture ratio for 11 soils from the study
by Hussain et al. [HSC85].

0.74
0.72
0.7
0.68
0.66
0.64
0.62
0.6
0.58
0.56

Void ratio

0.8

0

0.1

0.2

0.3 0.4 0.5
Moisture ratio

0.6

0.7

0.8

(b) Shrinkage curve of a silt loam soil (from
the long term INRA soil structure experiment,
Mons-en-Chaussée, France).

0.74
0.72
0.7
0.68
0.66
0.64
0.62
0.6
0.58
0.56

Experimental curve
Empirical formula

0

2

4
6
Time (days)

8

10

(c) Relationship between drying time and
void ratio obtained by combining Figure (a)
and Figure (b), fitted with the empirical formula
(Vmax = 0.714,Vmin = 0.567, k = 0.072).

Figure 6: Curves on which we base the shrinkage calculation.
a maximum number of active cracks M. A crack is considered
as “active” if it keeps growing at least at one of its extremities.
If the number of active cracks is below m, cracks are created
until their number reaches M. If one chooses m = 0, the
creation proceeds by entire generations. On the contrary, if
one chooses m = M, the creation proceeds by individuals. Of
course, creation is possible only if the list of potential start
points is not empty. Creation can be stopped if a predefined
number of cracks is reached, or if the cracks exceed a maximal
total length.
4.2 Progression of active cracks
When a crack is created, it grows simultaneously at each
extremity (Figure 5). Each extremity grows by adding the
points stored in the current edge of G, up to the distance corresponding to the speed of the crack multiplied by the step
duration, and by choosing the next edge when it reaches a
node. The principle of this choice is to respect direction ϕ
of the crack, which is determined by the edge containing the
start point. A global limit of tolerance α is given, so a crack
tries to find an edge whose angle is the closest to ϕ and in the
range [ϕ − α, ϕ + α]. It stops because either such an edge
does not exist, or the current node is an extremity, or it is attracted by another crack. This attraction occurs if the distance
between the current node and a node from another crack is
below a threshold. Without this attraction, by respecting only
the initial direction, we could obtain unnatural results, like
two close parallel cracks. Attraction adds the benefit that it
promotes a higher compacity of the regions, which is close
to the observation. Finally, a crack can also be stopped if it
arrives at a place where the shrinking layer thickness is below
another threshold. Both of these thresholds are user defined
values.
4.3 Hierarchical creation and progression
Another criterion is taken into account when the edges have
stored an order, creating a hierarchy of paths. In this case,

Figure 7: Three different stages of the Horgan and Young
model [HY00].
the start points are arranged with respect to this order, prior
to their distance to cracks. In the same way, during the progression of a crack, the next edge is the edge whose angle is
in the desired range and whose order has the minimal value
amongst the available edges. These hierarchical paths were
implemented for the Horgan and Young model and the watershed method.
In the case of the Horgan and Young model, this hierarchy
simply reflects the order of creation of each edge (Figure 7).
A result is shown in Figure 14(d).
In the case of the watershed method, it is not possible to get
a hierarchy by applying a watershed transform to a more and
more smoothed version of the original image, because our
method requires that the watershed lines which are present
in some level be also present in the following levels, with
exactly the same path. Thus, this hierarchy is obtained by a
waterfall process also called hierarchical watershed [Beu94].
In our pipeline (Figure 1), the waterfall algorithm takes as
an input the initial image I of the shrinking layer and its watershed lines, which are the result of a classical watershed
algorithm with the local minima of I as seeds. The principle
of the waterfall algorithm consists in merging two catchment
basins and consequently removing the corresponding dam,
when the water of one basin flows into the other (as when
a waterfall occurs in the nature) and conversely. In practice

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

G. Valette, S. Pr´evost, L. Lucas and J. L´eonard / A Model of Cracks Development

53

the crack between two adjacent surface cells is considered as
a triangular prism, optionally truncated (Figure 10(b)). At the
surface, this prism is seen as a rectangle. Having equal values
of w, W, h, and H at both extremities of the crack prism is
an approximation that is used to compute the volume of the
crack but not to display them: as explained in Section 6.1,
when rendering these values can be different at both ends
(but they are the same at the ending/beginning extremities of
consecutive prisms).
The volume of the truncated triangular prism is:
V=

Figure 8: The original image I and five different levels of
hierarchical watersheds. The last level 402 corresponds to
the total number of different levels obtained in this case. This
level contains the ancestor of all the watershed lines (in red).
Notice that one watershed line of a level is present in the
previous levels.
each catchment basin is affected by an immersion level which
is the lowest level of grey belonging to this basin in I. We
store these levels in a sorted list. Then we simulate water rising from the lowest to the highest immersion level in order to
detect the waterfalls. At each detection of a waterfall, a range
is affected at the watershed line between the merging catchment basins. This range corresponds to the hierarchical level
for which this watershed line disappears. It is incremented at
each change of the immersion level and if at least one waterfall has been detected during the previous rising stage. Thus
each iteration removes the watershed lines between merging
catchment basins and the process is stopped when the list of
the immersion levels has been emptied. At the end of the entire process, we obtain a minimum of two catchment basins,
i.e. one watershed line, being the ancestor of all the watershed
lines and thus the root of the hierarchy. Figure 8 shows an example of five different levels of hierarchical watershed lines.
This method allows us to obtain a cracks path in adequacy
with the properties of the initial soil which influence the
thickness of the shrinking layer, the hierarchy between watershed lines giving higher priority to the edges in the thickest
parts of the shrinking layer. Figure 16(b) shows results of this
method.

1
L × (H W − hw)
2

with L the distance between the two extremities, W the width
of the crack, H the depth of the triangular crack, w the width of
the base of the crack, h the difference between H and the real
depth of the crack (Figure 10(b)). In the case of a triangular
shape, we have w = 0 and h = 0. To define the proportions
of the crack, we use two ratios with user defined values: R =
H /W and r = w/W = h/H . The volume can be written now
as:
V=

1
L W 2 R × (1 − r 2 ).
2

5.1 Cracks enlargement calculation
In our model, a crack is composed of a succession of links
between the adjacent surface cells of its path. The portion of

(6)

The crack is oriented, so for each path corresponding to an
edge of G, we are able to determine a first cell and a last cell.
We consider that the shrinkage volume V sh received in this
first cell is equal to V and we deduce from (6) the width and
the depth of the prism:
W =

1
2Vsh
×
LR
1 − r2

H − h = RW × (1 − r ).

(7)
(8)

To get a triangular shape we simply take r = 0. It is worth
noticing that the width of the cracks is not constrained by
the width of the cells. They can either be much smaller than
a cell (like in Figure 10) or span multiple cells in width. Finally, to avoid unnatural regularity, the extremities of the links
between the adjacent surface cells are slightly randomly displaced from the center of the cells (Figure 10(a)).
5.2 Shrinkage calculation
Using Equation (7) implies to estimate the shrinkage volume
V sh . The shrinkage volume is considered to be null at t = 0,
and it is estimated at each iteration from the change in pore
volume V p :
Vsh (t + δt) = Vsh (t) + V p (t) − V p (t + δt).

5. Cracks Enlargement

(5)

(9)

Changes in pore volume are associated to the swelling and
shrinking of the soil during wetting and drying. The intensity of this change can be estimated from the knowledge of
variations in soil water content and from the shrinkage curve
of the soil. We used moisture release versus drying time data

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

54

G. Valette, S. Pr´evost, L. Lucas and J. L´eonard / A Model of Cracks Development

Figure 9: Illustration of the shrinkage volume propagation. In the top images, the shrinkage volume in each cell is visible by
means of a volumetric visualization and the cracks pattern on the surface is drawn in red. The color and the opacity of one
voxel indicate the quantity of shrinkage volume it contains—voxels without any shrinkage volume are transparent. The bottom
images show a visualization of the cracked terrain. It can be seen that the stress relaxation is stronger near the cracks and that
the increasing absorption of shrinkage volume automatically causes a difference in the width of the cracks, reflecting their ages,
the oldest being the largest. For this simulation the distance max of relaxation is 50 cells (10 cm).
from Hussain et al. [HSC85] to obtain a realistic crust mean
drying kinetics (Figure 6(a)). This drying kinetics was then
combined to the shrinkage curve of a soil having a similar
texture (Figure 6(b)) to derive the corresponding relationship
between drying time and void ratio (Figure 6(c)). The following empirical equation,
V p (t) = Vmin + (Vmax − Vmin ) exp(−kt 2 ),

(10)

with V min and V max the minimum and maximum values of
the void ratio, k a coefficient controlling the speed of the
shrinkage process and t the elapsed time, which fits well
the relationship obtained between drying time and void ratio
(Figure 6(c)), was then used in the model to predict variations
in shrinkage volume.

tically (Figure 11(b)). Otherwise, first we calculate the volume V sh (c) which will be distributed from the cell to the valid
neighbor cells. That calculation has two constraints. First, in
order to be able to take care of vertical shrinkage (also called
subsidence) which does not play any role in the cracking
process, it has to use the “geometry factor” rs , commonly
used in the soil science to traduce the repartition between the
horizontal shrinkage and the vertical shrinkage. Secondly,
as we want that a voxel far from a crack contributes less to
the shrinkage volume than a closer one, the result must decrease when the distance increases. Thus, we propose this
equation:
⎧
d
⎨ 1 − 1 × V (c) × 1 −
if d ≤ dmax
sh
rs
dmax
Vsh (c) =
⎩0
if d > d
max

(11)
5.3 Shrinkage volume propagation
The aim of the shrinkage volume propagation is to express
the exchange of matter and pores between the cells, i.e. the relaxation of the stress created by the shrinkage process. This
propagation uses the same distance map as the creation of
cracks (Section 4.1) and starts from the cells whose distance
is equal to D, which is initially the maximum of this map.
At each iteration, we decrement the distance D in order to
treat closer cells, until reaching the cracked cells, which are
at distance zero (Figure 11(a)). If a cell is isolated at its depth,
i.e. there is no closer cell of the shrinking layer in its horizontal neighboring, its shrinkage volume is transmitted ver-

with V sh (c) the shrinkage volume of the cell c, d the distance
of the cell to the cracks, rs the geometry factor which is defined above, dmax the maximum distance of volume exchange
for one crack. This distance can be fixed or can evolve as the
maximum of the distance map. It is worth noticing that, because the propagation is a decreasing function of the distance
to the cracks, the stress relaxation is stronger near the cracks,
which reflects reality. This is illustrated in Figure 9 where the
shrinkage volumes are visible: around the cracks, the shrinkage volumes are consumed by a transformation into crack
volumes. Moreover, we can see that the first cracks benefit
from a more important quantity of shrinkage volume, thus

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

55

G. Valette, S. Pr´evost, L. Lucas and J. L´eonard / A Model of Cracks Development

Figure 11: The principle of the shrinkage volume propagation.
Figure 10: A portion of a crack defined between two adjacent surface cells and the corresponding volume. This figure
shows the approximation used to compute the crack volume.
The rendering stage does not consider that w, W, h and H
must be equal (see Section 6.1).

they become larger, whereas the cracks created later keep
a small width because of a lack of shrinkage volume. This
shows that our model can automatically reproduce the differences in width and depth among cracks, emphasizing their
different ages.
We use the value V sh (c) given by (11) to update V sh (c) for
the next iteration:
Vsh (c) = Vsh (c) − Vsh (c).

(12)

Then, we calculate the proportion V sh (i) of the volume V sh (c)
which will be distributed to a valid neighbor cell i.
Vsh (i) = Vsh (c) ×

d − di
,
j∈N (c) (d − d j )

(13)

where N(c) is the set of valid cells from the horizontal neighboring of c, and d, di , dj the distance to the cracks of the
cells c, i, j, respectively. When all the cells have been visited, the cells which are on the cracks path have received the
shrinkage volume they must transform in void, as detailed in
Section 5.1.
5.4 Vertical shrinkage
We propose to add to the cracking process a vertical shrinkage, which permits to take into account a vertical relaxation
of stress. This avoids unnatural results, especially in case of
flat surface (constant height), which are produced because
the horizontal shrinkage in our method does not change the
relief at all. This vertical shrinkage uses the same volume
shrinkage V sh as for the cracks enlargement, but it does not
affect the cracks, only the heightmap (Figure 4). In order to
reproduce two types of phenomena which are visible in the

nature, we mix two types of calculation: the first one involves
one column of cells, depending on its distance to the cracks
(the farther it is, the more it goes down) and it reproduces a
cupping effect:
Vvsh (c) =

d
Vsh (c),
Dmax

(14)

where d is the distance of c to a crack and Dmax the maximum
of the distance map. The second calculation involves each
region enclosed by cracks, depending on its area (the larger
it is, the more it goes down) and it reproduces a stair effect:
Vvsh (c) =

i∈R(c)

Vsh (i)

max(area)

,

(15)

where R(c) is the region of c and max (area) the maximal
area of the regions (in pixels). The vertical volume shrinkage
of a cell c is therefore given by:
Vvsh (c) =

(1 − k) × Vvsh (c) + k × Vvsh (c)
,
rs

(16)

where rs is the geometry factor and k a coefficient which
determines the contribution of both the column and region
calculations. To get the change of the height H sh of one point
p of the heightmap, we divide this volume by the cell area
Acell , and sum the result for the column C(p) corresponding
to this point:
Hsh ( p) = −

c∈C( p)

Vvsh (c)

Acell

.

(17)

Lastly, we update V sh (c) as in Equation (12):
Vsh (c) = Vsh (c) − Vvsh (c)

(18)

An example of the effect of the vertical shrinkage is given in
Figure 13.

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

56

G. Valette, S. Pr´evost, L. Lucas and J. L´eonard / A Model of Cracks Development

Figure 12: Example of meshing for three portions of a triangular shaped crack (represented by PS and LB ).

Figure 13: The effect of the vertical shrinkage with the
Dirichlet tessellation method.

6. Results and Applications
6.1 Visual results of cracked terrains
At the rendering stage of our method, we dispose of two
series of data: on the one hand, a height map, and on the
other hand, a collection of cracks, each one defined by a sequence of points, each point storing the width and the depth
of the volumetric portion of crack starting from this point.
In order to render the cracked soil, we choose to transform
these data into a triangulated surface. This transformation
is straightforward (an example is given in Figure 12, please
refer to Figure 10(b) for the meaning of PS , PB , LB ): (i) we
transform the pixels of the heightmap into vertices; (ii) we
assemble consecutive portions of a crack as surface polygons
PS , in order to eliminate voids, with respect to the width of
each portion at its beginning; (iii) we seek which vertices of
the heightmap are inside PS , and we remove them; (iv) we
compute the bottom lines LB or the bottom polygons PB corresponding to the bottom of the portions of the cracks; (v)
we transform the edges of all the polygons PS , PB and the
lines LB into vertices, adding a sufficient number of interpolated vertices in order to avoid aliasing; (vi) finally, we get
facets from all the vertices by making a Delaunay triangulation with the freely available library Triangle [She96]. To
rapidly get a result these facets are rendered with OpenGL
with the Phong’s illumination model, as for Figure 14. A better final image can be obtained with a raytracer, POV-Ray for
example, as for Figure 17(c). Notice that step (ii) modifies
the shape of the portions of the crack and consequently, the
previous calculation of the volumes does not exactly match
the rendered cracks, but we consider that the difference is
negligible.
The comparison between Figure 13(a) and (b) shows how
the addition of vertical shrinkage permits to produce more
realistic results on a flat terrain with cracks obtained with a
Dirichlet tessellation. Figure 14 shows results produced on a
flat surface with a constant shrinking layer thickness, with a
path computed with the model of Horgan and Young [HY00]
which is shown Figure 14(a). The local differences in the

Figure 14: Cracks following a path produced by the model
of Horgan and Young on a flat terrain. Our method gives
different widths, highlighting their order of creation, and thus
permits the production of plausible natural cracks.
cracks width and in the final height of the terrain between
Figure 14(c) and (d) are explained by the different dynamics
of creation and progression: on the right figure, they are hierarchical (see Section 4.3). Figure 14(b) shows the different
sizes of the first cracks.
Instead of random or handmade input data, we can use
real or simulated input data. For example, we can obtain the
heightmap by measuring the surface roughness of a real patch
of soil with a laser profile meter: the result is a digital elevation map (DEM). Starting from this DEM, we can simulate
the formation of crust during a rainfall [VPLL06] and then
use the result of this simulation as well for the heightmap

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

G. Valette, S. Pr´evost, L. Lucas and J. L´eonard / A Model of Cracks Development

57

also by the soil state, more precisely by the thickness of the
shrinking layer.
Finally, in addition to non constant height and shrinking
layer thickness (like in Figure 2c) and because our model is
based on a regular 3D-grid, it is easy to define areas in the
terrain with specific initial conditions which will influence on
the cracks formation. An example is given Figure 17, where
we use the EG logo as a heightmap to define wetter areas in the
initial soil. In these areas, the shrinkage volumes are bigger
than in the other areas, thus, the cracks are more numerous
and larger.
Figure 15: Cracks applied to a simulated crusted soil with
the watershed method. Notice the various depths and widths
and the dead branch (close-up).

Figure 16: Another example of cracks applied to a simulated crusted soil. The possible paths are produced by the
non hierarchical watershed transformation (a) and by the hierarchical watershed transformation (b), on the same initial
crust thickness map. Thus, the original watershed lines are
identical, but the choice for the creation and the progression
gives different final patterns.

as for the shrinking layer: this is the case described in
Figure 2(c) (examples of cracks produced by our method
from these input data are given in Figure 16 and 15). The
range of the side of the terrain we simulate is typically between 25 and 30 cm for a depth of 10 cm, and one cell is
a 2 mm side cube (corresponding to the laser profile meter
resolution).
It is worth noticing that cracks present various depths and
widths (the oldest being the largest), and that, even if the
possible path is a connected graph, our method can produce
‘dead branches’, i.e. cracks can be interrupted before joining
another crack, which is close to reality (see for example, the
close-up in Figure 15). Furthermore, because of the use of
a hierarchical or nonhierarchical method, global differences
between the cracks patterns and local differences in the cracks
width are noticeable between Figure 16(a) and (b). The hierarchical watersheds insure that the order in the choice of
the crack paths is influenced not only by the distance to the
existing cracks and the respect of the initial orientation, but

6.2 Time complexity
The major factor in the duration of an iteration during the
cracking process is the dimension of the terrain, and more
precisely the number of the active cells, i.e. the cells of the
shrinking layer. Another significant factor is the total length
of cracks, i.e. the number of cells for which a calculation
of width and depth is required. For example, for a 256 ×
256 × 50 volume, with a constant height of 20 cells for the
terrain and 256 × 256 × 10 active cells, the duration varies
from 5.9 to 10s, for 28 and 97% of “cracked” cells, respectively, i.e. about 800 and 4 000 cells, without the rendering
stage (7–12.4s with the rendering stage), on a Pentium IV
CPU running at 3 GHz with 1 GB of RAM. The total duration of one simulation obviously depends on the number of
iterations required, which can be very low because a few iterations suffice to give an interesting result. Figure 13(b) has
needed 20 iterations, from 4 to 12.5s each, which represent
a total time of 3 min 8s, with a rendering stage at each iteration in order to get an animation. The number of polygons
used for rendering obviously depends on the original grid,
which is is typically 256 × 256 for the flat terrains used for
example in Figure 13 and 279 × 279 for the real patch of soil
shown in Figure 15. These grids give, respectively, 130 050
and 154 568 polygons, but these numbers increase with the
number of cracks, which can be very various. One portion
of crack adds three or four vertices and four or six polygons,
plus the polygons created by the subdivision of the square
which contains this portion (this is shown in Figure 12). To
give an idea, starting from 130 050 polygons, the scenes represented Figure 14(b) and (d) contain, respectively, 172 264
and 254 290 polygons.

6.3 Validation of cracks patterns
For a first validation of our model of cracks, we reduce the
characterization of the cracks patterns to the soil surface,
which is a common approach in the soil science. The pattern
formed by the cracks on the surface of the soil is considered as a binary image composed by the soil (white pixels)
and the cracks (black pixels) and therefore different techniques of 2D image analysis can be used to characterize this

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

58

G. Valette, S. Pr´evost, L. Lucas and J. L´eonard / A Model of Cracks Development

Figure 17: This example shows how initial conditions influence on the final crack patterns. The first and second images (a,b)
show the moisture in the terrain with a volumetric visualization, the level of cyan and the opacity depending on the quantity of
water in one voxel. In the last image (c), we used as a texture an image computed from the quantities of water evaporated during
the simulation, in the first two centimeters (i.e. 10 cells) below the surface.
pattern and its dynamics. We have used binary images of
real cracks which come from different papers [Vel99, Vel01,
VHLR05a] and whose real dimensions were given in order to
scale them with respect of the pixel dimension of our cracks,
i.e. 2mm side (these images are shown in Figure 19). For
comparison, we have computed different series of cracks:
with the Dirichlet tessellation (with 100 and 500 seeds), with
the Horgan and Young model, with the watershed transformation, and with the hierarchical watershed transformation.
We have also added several images of geometric patterns not
similar to cracks patterns (these images contain rectangles,
circles, lines, with different widths and sizes and arbitrarily
disposed).
6.3.1 Fractal dimension
Velde et al. [Vel99] used the fractal dimension D of pore
distributions in 2D space in order to compare and characterize crack networks in different types of soil. Using the box
counting method, they found that their images cover a large
range of values of D from 1.2 to 1.8, i.e. from highly irregular
structures to rather regular ones. Our simulated cracks give
the same range but arbitrary geometrical figures give also the
same range, thus it is not a sufficient criterion. Velde et al.
showed that there is a regular relation between porosity and
the distribution of the pores in their soil images according
to the type of material concerned. We have also found a linear relation for our simulated cracks, with a different slope.
With the measures of a one-cycle field wetting and drying
experiment in a cultivated soil, Velde [Vel01] showed that
the fractal dimension of the crack network changes regularly
with the time. We observe the same regularity with the simulated cracks but with a larger range for the fractal dimension.
Therefore, it is difficult to conclude something with the fractal
dimension and we have chosen two other methods of valida-

tion by comparing the results obtained of both real cracks and
synthesized cracks by means of the Minkowski densities and
the Minkowski functions.
6.3.2 Minkowski densities
This method was applied to the images of the three different
types, each image giving a point in the 3D space defined by
the three global characteristics. These points are shown in
Figure 18. It is noticeable that the points of both the real and
our synthesized cracks seem to fit the same curve, whereas
the points of the geometric figures do not. In Figure 18(c) the
width of the cracks is not taken into account for the calculation
of the Minkowski densities (the cracks patterns are reduced
to their skeleton) and the resulting points are entirely absent
from a part of the curve. Thus, that tends to prove that the
computation of cracks enlargement contributes to produce
more realistic cracks patterns.
The characterization of the geometry and topology of patterns can be obtained by means of Integral-Geometry Morphological Image Analysis (MIA). In the case of a 2D image there are exactly three Minkowski functionals which
correspond to the area, boundary length and connectivity
number of the patterns formed by the pixels in the image
[MDRDH02]. We obtain an estimation of the densities of
these three measures by a method proposed by Ohser et al.
[OSL98] which uses a special linear filtering on the binary
structure and gives the area fraction, the specific line length
and the specific integral of curvature (closely related to the
specific Euler number).
6.3.3 Minkowski functions
Vogel et al. get a more comprehensive characterization of
the structures by using the Minkowski functions [VHLR05a].

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

59

G. Valette, S. Pr´evost, L. Lucas and J. L´eonard / A Model of Cracks Development
Real cracks
Arbitrary figures
Synthesized cracks

Integral of curvature

Real cracks
Arbitrary figures
Synthesized cracks

Integral of curvature

Real cracks
Arbitrary figures
Synthesized cracks

Integral of curvature

0.4

0.4
0.2

0.4

0.2

0

0.2

0

0
0.06
0.05
0.04
0.15
0.02 Line length Area fraction
0.25

0.05
0.15
Area fraction

0.04
0.02 Line length

0.25
0

0.06

0.25
0.15
Area fraction

(a)

0.05

0

(b)

0.04
0.02 Line length

0

0.06

(c)

Figure 18: Minkowski densities obtained with the method of Ohser et al. [OSL98] (filter size v = 10, aspect factor ζ = 1).
The point of a real pattern which is not on the curve corresponds to Figure 19(h) which is visually different from the other real
patterns. Figure (a) and (b) show the same 3D curve from two different points of view. In Figure (c) the width of the cracks
patterns is not taken into account for the calculation of the Minkowski densities.

Figure 19: Binary images of real surface cracks patterns from different articles: (a-d) [Vel01], (e-i) [Vel99], (j) [VHLR05a].
These functions are obtained by recalculating the Minkowski
densities after several successive morphological erosions
with a circular structuring element of increasing size r. The
Minkowski densities are therefore given as a function of r.
We have used a squared Euclidean distance map [ST94] of
the cracks pattern and, as Vogel et al. we have recovered the
different erosions through a segmentation of this map, considered as a grey level image, according to different thresholds
whose values correspond to the different values of r. As before, an estimation of the Minkowski densities was obtained
by the method proposed by Ohser et al. [OSL98].
The top row of Figure 20 shows the Minkowski functions
for images of real cracks patterns, the middle row of this figure shows the results for our final simulated cracks patterns,
and the bottom row shows the results for arbitrary geometrical figures. For the first two rows, the shapes and the ranges
of the curves are very similar, indicating that the structure of
the simulated cracks patterns is not far from the structure of
natural ones. For the arbitrary geometrical figures, the shapes
are roughly identical, with some artefacts due to the uniformity of the pattern, but there are some noticeable differences
in the ranges for the functions of the integral of curvature,
and in general the asymptotes are reached more slowly.
7. Discussion and Conclusion
In this paper, we have detailed a new model of the formation
of cracks due to a thin shrinking layer, like those produced in

a desiccating soil crust. This model however presents several
limitations. The first one is that it is not appropriate to crack
all types of objects because it only works on height maps.
However, in a previous paper [VPL06a], we have presented
an extension of this model to any 3D mesh by means of a
parameterization. This extension was purely visual and did
not have any simulation goal. Because stress release is done
only after the crack paths are computed, a second limitation
is that cracks can follow a path in an area where the stress is
null. Nevertheless, this is not a real problem because in that
case the crack will be invisible. Another limitation coming
from the same cause is that the stress release can only get
cracks to happen where the chosen algorithm precomputed
cracks. That corresponds to our hypothesis that the dynamics of the desiccation process does not influence the possible
path of the cracks but only their progression and their enlargement. Finally, our method does not run in interactive time.
On the other hand, our method is dynamic and can thus give
the evolution of the cracks with the time. The input data are
simple, some of them being related to the physical properties
of the soil, and the parameters controlling the simulation are
intuitive. The two-stage approach adopted gives an increased
flexibility to the user. The computation of the cracks path can
for example be done automatically using the different algorithms provided, including the possibility to use a watershed
transformation algorithm to take into account the influence of
the thickness of the crust, but it is possible as well to use any
crack path network provided by the user. The shrinkage volume propagation is 3D and makes use of information about

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

60

G. Valette, S. Pr´evost, L. Lucas and J. L´eonard / A Model of Cracks Development
Area fraction

Line length
0.08

1
Fig. 19(e)
Fig. 19(f)
Fig. 19(g)
Fig. 19(h)

0.8
0.6

Integral of curvature
0.6

Fig. 19(e)
Fig. 19(f)
Fig. 19(g)
Fig. 19(h)

0.07
0.06

Fig. 19(e)
Fig. 19(f)
Fig. 19(g)
Fig. 19(h)

0.4
0.2

0.05
0
0.04

References
[Arn65] ARNDT W.: The nature of the mechanical
impedance to seedlings by soil surface seals. Australian
Journal of Soil Research 3 (1965), 45–54.

-0.2
0.03

0.4

-0.4

0.02
0.2

-0.6

0.01
0
-20

0

20

40

60

0
-20

80 100 120 140

0

20

(a)

40

60

80 100 120 140

0.06
Hier. watershed
Watershed
Dirichlet (500)
Dirichlet (100)
Horgan & Young

0.4

0.05

60

80

100 120 140

0
-20

0

20

40

60

-0.8
80 100 120 140 -20

0.05
0.6
Circles
Squares
Rectangles
Lines

80

100 120 140

Circles
Squares
Rectangles
Lines

0.4
0.2
0
-0.2

0.03

80 100 120 140

(g)

0
-20

[Beu94] BEUCHER S.: Watershed, Hierarchical Segmentation and Waterfall Algorithm. Morphology and its Applications to Image Processing (1994), 69–76.
[Beu04] BEUCHER S.: Unbiased Implementation of the Watershed Transformation based on Hierarchical Queues.
CMM Internal note, Ecole des Mines de Paris (2004).
[BUD04] BAUMHARDT R. L., UNGER P. W., DAO T. H.:
Seedbed Surface Geometry Effects on Soil Crusting and
Seedling Emergence. Agronomy Journal 96, 4 (2004),
1112–1117.

-0.4

0.02

-0.6

0.01
60

60

0.04

0.2

40

40

0.6

0.06

20

20

(f)
Circles
Squares
Rectangles
Lines

0.07

0

0

(e)

0.8

0
-20

0.2

-0.6

0.08

0.4

Hier. watershed
Watershed
Dirichlet (500)
Dirichlet (100)
Horgan & Young

0.4

-0.4

(d)
1

80 100 120 140

0

0.01
40

60

-0.2

0.03
0.02

20

40

0.04

0.2

0

20

0.6
Hier. watershed
Watershed
Dirichlet (500)
Dirichlet (100)
Horgan & Young

0.07

0.8

0
-20

0

(c)

0.08
1

0.6

-0.8
-20

(b)

[AT85] AWADHWAL N., THIERSTEIN G.: Soil Crust and its
Impact on Crop Establishment: A review. Soil and Tillage
Research 5 (1985), 289–302.

0

20

40

60

(h)

80 100 120 140

-0.8
-20

0

20

40

60

80 100 120 140

(i)

Figure 20: Comparison of the Minkowski functions of real
cracks patterns (a,b,c), simulated cracks patterns (d,e,f) and
arbitrary geometrical patterns (g,h,i). The Minkowski densities: the area fraction (a,d,g), the line length (b,e,h), the
integral of curvature (c,f,i) are estimated by the method proposed by Ohser et al. [OSL98] (filter size v = 10, aspect
factor ζ = 1) and they are represented as functions of the
signed squared distance, corresponding to the level of erosion r. A positive value of r is related to the erosion of white
regions, and a negative value to the erosion of black regions
(i.e. the cracks). The original structure corresponds to r = 0.

the soil itself and its characteristics. Results from our model
looked realistic, and a first attempt to validate the obtained
crack patterns, using 2D image analysis, has shown that these
crack patterns were consistent with real crack network data.
This is an indication that the assumption that the dynamics
of the shrinkage process has little influence on the possible
cracks paths is reasonable.

Acknowledgements
This work is part of the SoDA project (www.sodaproject.com), supported by the regions of ChampagneArdenne and Picardie, with a collaboration of the INRA
Agronomy Unit of Laon-Reims-Mons, France. The authors
would like to thank Pr. No¨el Bonnet for his help for the box
counting method and Pr. Jonathan Shewchuk for his library
Triangle.

[CV92] CASENAVE A., VALENTIN C.: A Runoff Capability
Classification System Based on Surface Features Criteria
in Semi-arid Areas of West Africa. Journal of Hydrology
130 (1992), 231–249.
[DGA05] DESBENOIT B., GALIN E., AKKOUCHE S.: Modeling cracks and fractures. The Visual Computer 21, 8–10
(Sept. 2005), 717–726.
[Fed02] FEDERL P.: Modeling Fracture Formation on
Growing Surfaces. PhD thesis, University of Calgary, Alberta, Canada, Sept. 2002.
[FP04] FEDERL P., PRUSINKIEWICZ P.: Finite Element
Model of Fracture Formation on Growing Surfaces. Lecture Notes in Computer Science 3037 (May 2004), 138–
145.
[GC01] GOBRON S., CHIBA N.: Crack Pattern Simulation
Based on 3D Surface Cellular Automata. The Visual Computer 17 (June 2001), 287–309.
[HSC85] HUSSAIN S., SMILLIE G., COLLINS J.: Laboratory
Studies of Crust Development in Irish and Iraqi Soils.
I. Moisture Content, Penetration Resistance, Aggregate
Size and Seedling Emergence of Spring Barley (Hordeum
Vulgare L.). Soil & Tillage Research, 5 (1985), 33–
53.
[HTK98] HIROTA K., TANOUE Y., KANEKO T.: Generation
of Crack Patterns With a Physical Model. The Visual Computer 14 (1998), 126–137.
[HTK00] HIROTA K., TANOUE Y., KANEKO T.: Simulation
of Three-Dimensional Cracks. The Visual Computer 16
(2000), 371–378.

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

G. Valette, S. Pr´evost, L. Lucas and J. L´eonard / A Model of Cracks Development

[HY00] HORGAN G., YOUNG I.: An Empirical Stochastic Model for the Geometry of Two-Dimensional Crack
Growth in Soil (with discussion). Geoderma, 96 (2000),
263–276.
[IO06] IBEN H. N., O’BRIEN J. F.: Generating Surface Crack Patterns. In Proceedings of the ACM SIGGRAPH/Eurographics Symposium on Computer Animation (Sept. 2006), pp. 177–185.
[LALR06] LE´ ONARD J., ANCELIN O., LUDWIG B.,
RICHARD G.: Analysis of the Dynamics of Soil Infiltrability of Agricultural Soils from Continuous Rainfall-Runoff
Measurements on Small Plots. Journal of Hydrology 326
(2006), 122–134.
[LBB93] LE Bissonnais Y., BRUAND A.: Crust Micromorphology and Runoff Generation on Silty Soil Materials
During Different Seasons. Catena Supplement, 24 (1993),
1–16.
[Lin94] LINDEBERG T.: Scale-Space Theory in Computer
Vision. Kluwer Academic Publishers, Norwell, MA, USA,
1994.
[Mac95] MACVEIGH D. T.: Emulation of Uniform Cracking. In Proceedings of Compugraphics ’95 (Dec. 1995),
Santo H. P., (Ed.), pp. 218–227.
[MDRDH02] MICHIELSEN K., DE Raedt H., DE Hosson J.:
Aspects of Mathematical Morphology. Advances in Imaging and Electron Physics 125 (2002), 119–195.
[NF99] NEFF M., FIUME E.: A Visual Model For Blast
Waves and Fracture. In Graphics Interface (1999),
pp. 193–202.
[OBH02] O’BRIEN J. F., BARGTEIL A. W., HODGINS J. K.:
Graphical modeling and animation of ductile fracture. In
SIGGRAPH ’02: Proceedings of the 29th Annual Conference on Computer Graphics and Interactive Techniques
(New York, NY, USA, 2002), ACM Press, pp. 291–294.
[OH98] OLSEN P., HAUGEN L.: A New Model of the Shrinkage Characteristic Applied to Some Norwegian Soils. Geoderma 83, 1 (Apr. 1998), 67–81.
[OH99] O’BRIEN J. F., HODGINS J. K.: Graphical Modeling
and Animation of Brittle Fracture. In Proceedings of the
26th Annual Conference on Computer Graphics and Interactive Techniques (1999), ACM Press/Addison-Wesley
Publishing Co., pp. 137–146.
[OSL98] OHSER J., STEINBACH B., LANG C.: Efficient Texture Analysis of Binary Images. Journal of Microscopy
192, 1 (Oct. 1998), 20–28.
[PMRdM95] PERRIER E., MULLON C., RIEU M., DE Marsily
G.: Computer Construction of Fractal Soil Structures:

61

Simulation of their Hydraulic and Shrinkage Properties.
Water Resources Research 31 (1995), 2927–2943.
[PPD02] PAQUETTE E., POULIN P., DRETTAKIS G.: The
Simulation of Paint Cracking and Peeling. In Graphics
Interface 2002 Conference Proceedings (2002), pp. 59–
68.
[RS91] RIEU M., SPOSITO G.: Fractal Fragmentation, Soil
Porosity and Soil Water Properties: I Theory. Soil Science
Society of America Journal 55 (1991), 1231–1238.
[RSB00] RAPP I., SHAINBERG I., BANIN A.: Evaporation
and crust impedance role in seedling emergence. Soil Science (2000), 354–364.
[She96] SHEWCHUK J. R.: Triangle: Engineering a 2D Quality Mesh Generator and Delaunay Triangulator. In Applied
Computational Geometry: Towards Geometric Engineering, Lin M. C., Manocha D., (Eds.), vol. 1148 of Lecture
Notes in Computer Science. Springer-Verlag, May 1996,
pp. 203–222.
[SM88] SKJELTORP A. T., MEAKIN P.: Fracture in Microsphere Monolayers Studied by Experiment and Computer
Simulation. Nature 335 (Sept. 1988), 424–426.
[ST94] SAITO T., TORIKAWI J.: New Algorithms for Euclidean Distance Transformation of an n-Dimensional
Digitalized Picture with Applications. Pattern Recognition 27, 11 (1994), 1551–1565.
[TF88] TERZOPOULOS D., FLEISCHER K.: Modeling Inelastic Deformation: Viscoelasticity, Plasticity, Fracture. SIGGRAPH 1988, Computer Graphics Proceedings, Atlanta,
GA 22, 4 (Aug. 1988), 269–278.
[Vel99] VELDE B.: Structure of Surface Cracks in Soil and
Muds. Geoderma 93 (1999), 101–124.
[Vel01] VELDE B.: Surface Cracking and Aggregate Formation Observed in a Rendzina Soil, La Touche (Vienne)
France. Geoderma 99, 3 (2001), 261–276.
[VHLR05a] VOGEL H.-J., HOFFMANN H., LEOPOLD A.,
ROTH K.: Studies of crack dynamics in clay soil: I. Experimental methods, results and morphological quantification.
Geoderma 125, 3-4 (Apr. 2005), 203–211.
[VHLR05b] VOGEL H.-J., HOFFMANN H., LEOPOLD A.,
ROTH K.: Studies of crack dynamics in clay soil II. A
physically based model for crack formation. Geoderma
125, 3-4 (Apr. 2005), 213–223.
[VPL06a] VALETTE G., PREVOST S., LUCAS L.: A generalized cracks simulation on 3d-meshes. In Eurographics
Workshop on Natural Phenomena (Vienna, Austria, Sept.
2006), E. Galin, N. Chiba, pp. 7–14.

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

62

G. Valette, S. Pr´evost, L. Lucas and J. L´eonard / A Model of Cracks Development

[VPL06b] VALETTE G., PREVOST S., LUCAS L.: Modeling and visualization of cracks in a desiccating soil. In
11th International Fall Workshop Vision, Modeling, and
Visualization (Aachen, Germany, Nov. 2006), Aka Verlag,
Berlin, pp. 177–184.
[VPLL06] VALETTE G., PRE´ VOST S., LUCAS L., LE´ ONARD
J.: SoDA Project: a Simulation of Soil Surface Degradation
by Rainfall. Computers & Graphics 30, 4 (Aug. 2006),
494–506.

[VS91] VINCENT L., SOILLE P.: Watersheds in Digital
Spaces: An Efficient Algorithm Based on Immersion Simulations. IEEE Transactions on Pattern Analysis and Machine Intelligence 13, 6 (1991), 583–598.
[WWL∗ 03] WANG X., WANG L., LIU L., HU S., GUO B.: Interactive Modeling of Tree Bark. In PG ’03: Proceedings
of the 11th Pacific Conference on Computer Graphics and
Applications (Washington, DC, USA, 2003), IEEE Computer Society, pp. 83–90.

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.


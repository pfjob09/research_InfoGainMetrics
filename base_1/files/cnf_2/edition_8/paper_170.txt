DOI: 10.1111/j.1467-8659.2007.01110.x

COMPUTER GRAPHICS

forum

Volume 27 (2008), number 6 pp. 1607–1631

Interference Shaders of Thin Films
Yinlong Sun and Qiqi Wang
Department of Computer Sciences, Purdue University, W. Lafayette, IN, USA 47907-1398.
yinlongsun@gmail.com

Abstract
This paper presents a systematic study of light interferences at single thin films. Based on Fresnel’s law, we have
derived generic expressions of reflectance and transmittance for film interference, as well as specific expressions
for free thin films and films coated on transparent or opaque objects. By combining film interference and volume
absorption, we have obtained the reflectances and transmittances of film-coated thin objects such as ribbons.
Illumination models for all interference cases of single thin films are presented, and they have been implemented
and tested for various structures and materials.
Keywords: Light interference, thin film, illumination model, spectral rendering, physically based modeling,
Fresnel’s law, spectral volume absorption.
ACM CCS: I.3.0 Computer Graphics: General; I.3.6 Computer Graphics: Methodology and Techniques

1. Introduction
When light is reflected from or transmits through a thin film
(Figure 1), multiple outgoing rays interfere with each other,
causing the colour of the outgoing light very different from
that of the incident light. Unlike colours generated by pigments or dyes [JW75, WS82], interference colours involve a
phase-coherent superposition of light and depend sensitively
on wavelength, film thickness and material properties of the
relevant media [BW99,Hec98, Lev80].
Phenomena of film interference exist widely in nature. Examples include soap films, oils on water and various filmcoated objects. Currently, the modelling and rendering of
light interference are not supported in common graphics renderers, such as OpenGL, RenderMan and Maya. These renderers adopt the red, green and blue (RGB) triplets as a standard, which is not sufficient to describe light interference.The
lack of interference shaders in these renderers is associated
with the present research status that a systematic study of
illumination models of film interference is inadequate for the
practical use.
To illustrate this point, we summarize the cases of film
interference in Figure 2. Single thin films may be classified
into the categories that the base material is transparent or
opaque. When the base is opaque, only reflection needs to be
handled. When the base is transparent, the category has four
c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and
Blackwell Publishing Ltd. Published by Blackwell Publishing,
9600 Garsington Road, Oxford OX4 2DQ, UK and 350 Main
Street, Malden, MA 02148, USA.

types: free thin films (base is the air), film-coated bulk objects (such as glassware), thin objects with one-side coating
(plastic ribbons of thickness on the scale of 0.1 or 1 mm) and
thin objects with two-side coating (plastic ribbons). Each of
these types may be further classified into the cases of reflection and transmission. The illumination model for a specific
case shown in Figure 2 involves structural and material properties. For example, when the base is opaque, the interference
depends on the spectral optical constants of the material (see
Appendix B). When a film-coated thin object (e.g. plastic
ribbon) is transparent and coloured, the overall colour of the
outgoing light mixes the interference colour due to the film
and the transparent colour due to the volume absorption in
the base, and thus the volume absorptivity of the base is involved. Therefore, different illumination models are needed
for different cases of film interference.
Figure 2 also displays multilayer structures and film flake
particles as major branches of interference shaders. A multilayer structure contains a number of adjacent thin-film layers;
such examples are often seen in optical coating applications
[Dob95, Lev80, Mac69] and on biological surfaces [Fox76,
Sim71]. (Note that a thin object with two-side coating is
not regarded as a multilayer interference structure because
the two films are not adjacent.) Film flake particles refer to
the case that many small flakes are distributed in a surface
layer and interference occurs at each flake, and the associated

1607

Submitted March 2007
Revised November 2007
Accepted November 2007

1608

Y. Sun & Q. Wang / Interface Shaders of Thin Films

have obtained the specific reflectances and transmittances of
free thin films, as well as films that are coated on transparent
or opaque objects. Second, when a film is coated on a transparent thin object (such as a plastic ribbon), the outgoing light
mixes the interference colour of the film and the transparent
colour of the base object. By combining the effects of film interference and volume absorption, we have derived the overall illumination. Finally, the illumination models for all cases
of single thin films shown in Figure 2 have been presented.

Figure 1: Multiple reflected (or transmitted) light rays interfere at a thin film.
coating technique is widely used in painting such asfor automobiles [EKM∗ 01, GMN04, Mey00, WM01].
This paper presents a systematic study of light interference
at single thin films. The new contributions are in three aspects.
First, based on Fresnel’s law, we have derived generic expressions of reflectance and transmittance for film interference
through rigorous calculations. From these expressions, we

We implemented the illumination models of single thin
films using RenderMan [Rag05, Ups90], which provides
a convenient shading language for the user to write new
shaders. Since RenderMan is RGB-based, to describe the
spectral dependency of interference, we converted RGB
colours to spectra with a transformation technique proposed
in a previous study [Sun06].
Section 2 briefly reviews the related work on light interference and spectral rendering. Section 3 presents the calculations of reflectances and transmittances of film interference.
Sections 4–7 develop the illumination models, and Section 8
describes the implementation and rendered results. Section
9 concludes the paper and discusses future directions. Finally, the Appendices provide relevant background materials
as convenient references.

Figure 2: Hierarchy of interference shaders of thin films. This paper focuses on single thin films, which is the first brunch of
interference shaders.
c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

1609

Y. Sun & Q. Wang / Interface Shaders of Thin Films

2. Related Work

3. Interferences of Single Films

Most graphics platforms and software commonly used today,
such as OpenGL [SWN∗ 04], RenderMan [Rag05, Ups90] and
Maya [Der04], adopt RGB triplets as a standard to model light
and objects. The RGB-based approach is simple and efficient,
but insufficient to simulate spectral phenomena such as light
interference. To overcome this limitation, considerable research has been conducted on the spectral approach where
light and objects are described with full spectra. Devlin and
collaborators [DCW∗ 02] gave an excellent review on spectral
rendering.

3.1. Generic case

Early graphics simulations of light interference include
Newton’s rings by Smits and Meyer [SM90] and colour
bands on soap films by Dias [Dia91]. Using a Monte
Carlo ray tracer, Gondek et al. [GMN∗ 94] integrated
the spectral and spatial aspects of surface reflection that
involves interferences of thin films and paints. This work
was extended with more discussion on subsurface refraction and multilayer interference [SGM97]. Sun et al.
[SFD99A] proposed a simple method to render interferences on film-coated transparent objects. On simulating interference phenomena of multilayer structures,
Hirayama and collaborators [HKY∗ 01] applied a recursive
method, and Icart and Arques [IA00] used Abeles matrix with consideration of surface roughness. Recently, Sun
[Sun06] proposed an iridescent shader to render biological
iridescences.
In previous studies of light interference at single thin films,
the focus has been given on the cases of free thin films (both
the adjacent media are the air) and of films that are coated
on transparent bulk objects (in contrast to thin objects such
as ribbons). The case of films coated on an opaque object
has not been studied. Besides, as pointed out earlier, at a film
coated on a transparent thin object (such as a ribbon), the
outgoing light mixes the interference colour of the film and
the transparent colour of the base. However, the combined
effect has not been investigated. Finally, accurate illumination models of interference at thin films need to be derived
based on Fresnel’s law. For example, at a grazing incident
angle because the surfaces reflect light almost completely
at all wavelengths, the interference colour is white. Without considering Fresnel’s law, this effect cannot be modelled
properly.
On other wavelength-sensitive phenomena, Stam [Sta99]
proposed a diffraction shader within the framework of Kirchhoff integral. Sun et al. [SFD∗ 00] developed a diffraction
model from the Huygens-Fresnel principle. Agu and Hill
[AH02] proposed a simple diffraction-shading model to
render iridescent surfaces. The spectral approach has also
been used to render light dispersion [Col97, GS04, Mus89,
SFDC∗ 01, Tho86, WTP00, YKI∗ 88], fluorescence [Glas94,
JF99, WTP01], and volume absorption of homogeneous
transparent objects [SFD99B].

Consider light interference at a thin film as shownin
Figure 1. The film has one interface with the air and one interface with the base material. Assume that the film thickness d f
is below or comparable to the wavelength such that interference occurs (see Appendix D), and that both surfaces of the
film are smooth such that Fresnel’s law is applicable (see Appendix A). Let E˜ 0 be the field of the incident ray, E˜ 1 , E˜ 2 . . .
the fields of the reflected rays, and E˜ 1 , E˜ 2 . . . the fields of the
transmitted rays. (Since these fields involve phases and are
complex, the notations are capped with a tilde.) In the case
that the base is opaque, after light enters the material, E˜ 1 ,
E˜ 2 . . . vanish quickly and thus the transmission is not needed
to consider.
Now we focus on one polarization, that is parallel or perpendicular. In below the Fresnel coefficient r can be either r
or r ⊥ , and correspondingly t can be t or t ⊥ (see Appendix
A). Thus the fields of the reflected rays in Figure 1 are
⎧
E˜ 1 = E˜ 0 ra|f
⎪
⎪
⎪
⎪ ˜
⎪
E 2 = E˜ 0 (ta|f tf|a )rf|b e−iδ
⎪
⎪
⎪
⎪
⎪
⎨ E˜ 3 = E˜ 0 (ta|f tf|a )rf|b (rf|a rf|b )e−2iδ
(3.1)
E˜ 4 = E˜ 0 (ta|f tf|a )rf|b (rf|a rf|b )2 e−3iδ
⎪
⎪
⎪
⎪
..
⎪
⎪
⎪
.
⎪
⎪
⎪
⎩ ˜
E N = E˜ 0 (ta|f tf|a )rf|b (rf|a rf|b ) N −2 e−(N −1)iδ
where r a|f is the amplitude coefficient of reflection in the air
from the film, r f|a the coefficient in the film from the air, t a|f
and t f|a the coefficients of transmission from the air to film
and vice versa, and r f|b the coefficient of reflection in the film
from the base. (In the above subscripts, the first letter stands
for the incident medium and the second for the encountered
medium; that is, ‘a’ for ‘air’, ‘f’ for ‘film’, and ‘b’ for ‘base’.)
The phase angle δ is associated with the film and is given by
[Hec98]
δ = 4πn f d f cos θ f /λ,

(3.2)

where λ is wavelength, n f the index of refraction (IOR) of the
film, d f the film thickness and θ f the ray angle in the film.
The ray angles in different media (Figure 1) are related via
Snell’s law
sin θa = n f sin θ f = n b sin θb ,

(3.3)

where θ a is the incident angle in the air, θ b the ray angle in
the base, and n b the IOR of the base. The total field is the
sum of the fields of all reflected rays:
N

E˜ =

E˜ m = E˜ 0 ra|f
m=1

+ E˜ 0 (ta|f tf|a )rf|b e−iδ

N

(rf|a rf|b )m−2 e−i(m−2)δ (3.4)

m=2

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

1610

Y. Sun & Q. Wang / Interface Shaders of Thin Films

The summation of the geometric series yields
N

(rf|a rf|b )m−2 e−i(m−2)δ =

m=2

3.2. Transparent base material

1 − (rf|a rf|b ) N −1 e−i(N −1)δ
.
1 − rf|a rf|b e−iδ
(3.5)

Since |ra|f rf|b | < 1, as N → ∞,
N

(rf|a rf|b )m−2 e−i(m−2)δ =

m=2

RfilmOnTransp (λ, θa ) =
1
.
1 − rf|a rf|b e−iδ

(3.6)

From the Stokes relations (A.5)–(A.8) in Appendix A, r f|a =
r a|f = −r a|f and t a|f t f|a = t a|f t a|f = 1 − r 2a|f . Applying these
when substituting Eq. (3.6) into (3.4),
E˜ = E˜ 0

ra|f + rf|b e−iδ
.
1 + ra|f rf|b e−iδ

(3.7)

Reflectance is the ratio between the reflected and incident
energies and is generally given by
R(λ) =

E˜ · E˜ ∗
,
| E˜ 0 |2

(3.8)

where E˜ 0 is the incident field, E˜ the reflected field, and E˜ ∗
˜ From Eq. (3.7),
the complex conjugate of E.
˜∗

E˜ · E =

| E˜ 0 |2 ra|f + rf|b e−iδ
1 + ra|f rf|b e−iδ

∗ iδ
ra|f + rf|b
e

∗ iδ
e
1 + ra|f rf|b

, (3.9)

where r ∗f|b is the complex conjugate of r f|b (r f|b is complex
when the base material is opaque). But r a|f is always real
because the IORs of the air and film are real (refer to the last
paragraph in Appendix A). Substituting Eq. (3.9) into (3.8),
we obtain
Rfilm (λ, θa )
=

When the base is transparent, the IOR of the base is real and
thus r f|b is real as well (refer to the end in Appendix A). Thus,
Eq. (3.10) is simplified to

2
ra|f
+ |rf|b |2 + 2ra|f [Re(rf|b ) cos δ + Im(rf|b ) sin δ]
2
1 + ra|f
|rf|b |2 + 2ra|f [Re(rf|b ) cos δ + Im(rf|b ) sin δ]

(3.10)
where Re(rf|b ) and Im(rf|b ) are the real and imaginary parts
of r f|b . Eq. (3.10) is valid no matter the base is transparent or
opaque. For clarity, Eq. (3.10) explicitly shows the incident
angle as a variable and includes ‘film’ in the subscript to
specify that the reflectance applies to film interference instead
of one interface of two media (reflection at one interface is
described by the Fresnel reflectance in Appendix A).
Eqs. (3.1)–(3.10) apply to either parallel or perpendicular
polarization. The reflectance averaged over polarizations is
1
⊥
R¯ film (λ, θa ) =
(λ, θa ) , (3.11)
R (λ, θa ) + Rfilm
2 film
where R film (λ, θ a ) (for the parallel polarization) and R ⊥
film
(λ, θ a ) (for the perpendicular polarization) can be computed
from Eqs. (3.1)–(3.10).

2
2
ra|f
+ rf|b
+ 2ra|f rf|b cos δ
2
2
1 + ra|f
· rf|b
+ 2ra|f rf|b cos δ

. (3.12)

This equation applies to both polarizations. If light absorption in the film is ignorable, the transmittance averaged over
polarizations is
T¯filmOnTransp (λ, θa ) = 1 − R¯ filmOnTransp (λ, θa ), (3.13)
where R¯ filmOnTransp (λ, θa ) is computed from Eq. (3.11).
When light impinges at a film from the side of the base
material, we may conduct a similar calculation as in Section
3.1. But there is a quick way, that is, by switching the subscript ‘a’ for the air with ‘b’ for the base in Eq. (3.12). Note
that Eq. (3.12) is symmetric about the air and base. In other
words, if we switch subscripts ‘a’ and ‘b’, because r f|a =
−r a|f and r b|f = −r f|b (Appendix A), Eq. (3.12) remains the
same. Therefore, the reflectance of film interference for light
incidence from the side of the base is
R¯ filmOnTransp (λ, θb ) = R¯ filmOnTransp (λ, θa ),

(3.14)

where the primed notation implies an incidence from the base
side, and the incident angle in the base is θ b , which is related
to θ a by Eq. (3.3). Combining Eqs. (3.13) and (3.14),
T¯filmOnTransp (λ, θb ) = T¯filmOnTransp (λ, θa ).

(3.15)

3.3. Free films
For a free film, the base material is the air. Soap films are such
examples. In this case, since r f|b = r f|a = − r a|f Eq. (3.12) is
simplified to
RfreeFilm (λ, θa ) =

2
2ra|f
(1 − cos δ)
4
2
1 + ra|f
− 2ra|f
cos δ

.

(3.16)

This result has been obtained in the literature (for example,
see page 411 in [Hec98]). If light absorption in the film is
ignored, the transmittance can be directly computed from the
reflectance, that is,
T¯freeFilm (λ, θa ) = 1 − R¯ freeFilm (λ, θa ),

(3.17)

where R¯ freeFilm (λ, θa ) is given in Eq. (3.16).
1 (if n f = 1.8, r 2a|f = 0.08, which is small
When r 2a|f
enough), the terms containing r 2a|f and r 4a|f in the denominator
in Eq. (3.16) can be ignored so that
2
sin2 (δ/2).
Rfilm (λ, θa ) = 4ra|f

(3.18)

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

Y. Sun & Q. Wang / Interface Shaders of Thin Films

1611

This result can be equally obtained by considering only E˜ 1
and E˜ 2 in the outgoing rays, as shown in the early modelling
work [SFD99A]. In this paper, we will still use Eq. (3.16) to
compute reflectances of free films because Eq. (3.16) is more
accurate and sufficiently efficient in computation.

3.4. Opaque base material
When the base material is opaque, the IOR of the base is
complex and so is r f|b . The reflectance of the film remains
the form as in Eq. (3.10):
RfilmOnOpaque (λ, θa )
=

2
ra|f
+ |rf|b |2 + 2ra|f [Re(rf|b ) cos δ + Im(rf|b ) sin δ]
2
1 + ra|f
|rf|b |2 + 2ra|f [Re(rf|b ) cos δ + Im(rf|b ) sin δ]

(3.19)
The real and imaginary parts of r f|b are given in Eqs. (B.11)
and (B.13) in Appendix B. Note that
|rf|b |2 = [Re(rf|b )]2 + [Im(rf|b )]2 .

(3.20)

3.5. Discussion
To demonstrate the interference behaviours of thin films
and the impacts of the associated parameters, it is useful
to make a numerical study of the equations derived in Sections 3.1–3.4. (This study is also helpful for understanding
the rendered results to be presented in Section 8). First, consider a free film and the effect of film thickness d f . Figure 3 plots the reflectances and transmittances given by Eqs.
(3.16) and (3.17). The film IOR is n f = 1.5 and the incident angle is zero. The reflectances and transmittances in
Figure 3 vary with wavelength in an oscillating pattern. As
the film thickness increases, the peaks and valleys of the
curves change accordingly and the oscillation pace increases
as well. While a reflectance is much smaller than the corresponding transmittance, their summation is equal to 1 for all
wavelengths.
Next, consider the case that the base material is a transparent medium such as glass. Figure 4 displays the reflectances
and transmittances given by Eqs. (3.12) and (3.13) for various
values of the incident angle θ a . The film thickness is d f = 500
nm, the film IOR is n f = 2.2, and the IOR of the base is n b
= 1.5. When θ a = 0◦ , the reflectances or transmittances for
the parallel and perpendicular polarizations and their average
coincide. As θ a increases, results for the two polarizations differ significantly. In particular, when θ a = 60◦ , the reflectance
for the parallel polarization is very small, implying that θ a is
close to the Brewster angle [BW99, Hec98]. Finally, when
θ a = 75◦ , the reflectances and transmittances appear rather
flat, tending to give grey or white colours. This is caused by

Figure 3: Reflectances (solid curves) and transmittances
(dash curves) of a free thin film with different values of film
thickness.
the property of Fresnel’s law that the reflectivity approaches
1 at a grazing incident angle.
Now we make a concrete analysis of the spectral curve of a
reflectance with respect to its maxima and minima. Consider
the normal incidence at a film coated on a transparent base
with n b = 1.5 (corresponding to glass). From Eq. (3.12), since
the absolute values of the amplitude coefficients r a|f and r f|b
are significantly smaller than 1, the maxima and minima of the
reflectance are mainly determined by cos δ in the numerator.
For n f = 1.8 and n f = 2.2, using Eqs. (A.1) and (A.3) in
Appendix A, we can verify that r a|f r f|b < 0 for the normal
incidence. Thus, approximately, R filmOnTransp is maximal when
cos δ = −1 and minimal when cos δ = 1. Using Eq. (3.2),
these conditions are
δ j = 4πn f d f cos θ f /λ(mj) = jπ, j = 0, 1, 2, . . . (3.21)
or
λ(mj) =

4
n f d f cos θ f , j = 0, 1, 2, . . .
j

(3.22)

where the even values of j correspond to the minima and odd
to the maxima. Table 1 displays λ(mj) relevant to the visible
range for various values of d f .
Figure 5 plots the reflectances of a film coated on a transparent base with n b = 1.5. All curves are the results averaged
over polarizations. The legends give the film thickness d f
in nanometers. The film IOR n f is 1.8 for (a) and (b), and
is 2.2 for (c) and (d). The wavelengths for the maxima and
minima of the curves agree with those shown in Table 1. As
d f increases, λ(mj) changes and more extreme values occur in
the visible range. Figure 5 also shows that more energies are
reflected for a larger film IOR (n f = 2.2) than for a smaller
film IOR (n f = 1.8).
Finally, Figures 6 and 7 display the reflectance curves given
by Eq. (3.19) for a thin film that is coated on an opaque

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

1612

Y. Sun & Q. Wang / Interface Shaders of Thin Films

Figure 4: Reflectances (in blue) and transmittances (in brown) of a film coated on transparent material. The dot curves are for
parallel polarization, the dash curves for perpendicular polarization, and the solid curves are results averaged over polarizations.
The film thickness is d f = 500 nm, the film IOR is n f = 2.2, and the base material’s IOR is n b = 1.5. The incident angles are:
(a) θ a = 0◦ , (b) θ a = 30◦ , (c) θ a = 60◦ , and (d) θ a = 75◦ .
Table 1: Approximate wavelengths for the maxima and minima of reflectances of a thin film coated on a transparent material. The values in
the shaded columns correspond to the maxima and in non-shaded columns to the minima. All length values are in unit of nm (nanometers). The
IOR of the base transparent material is 1.5. Refer to Figure 5
(0)

(1)

nf

df

nf df

λm

λm

1.8

50
100
200
250
300
350
400
500
50
100
200
250
300
350
400
500

90
180
360
450
540
630
720
900
110
220
440
550
660
770
880
1100

∞

360
720

2.2

∞

440
880

(2)

λm

360
720
900

220
440
880

λm

(3)

λm

480
600
720
840

360
450
540
630
720

293
528
733
880

material. The base material is copper for Figure 6 and is silver for Figure 7. All curves are the results averaged over
polarizations. When d f = 0, that is, there is no film on the
base, the reflectance is the result given by Eqs. (B.14) and

(4)

440
550
660
770

(5)

(6)

(7)

(8)

(9)

λm

λm

λm

λm

λm

360
432
504
576
720

360
420
480
600

360
411
514

360
450

400

367
440
513
587
733

377
440
502
629

385
440
550

391
489

352
440
528
616
704

(10)

(11)

λm

λm

440

400

(B.15). Since the optical constants of copper and silver vary
with wavelength (Appendix B), we cannot simply estimate
the wavelengths for the maxima or minima of a reflectance.
However, as d f increases, the locations of the peaks and

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

1613

Y. Sun & Q. Wang / Interface Shaders of Thin Films

Figure 5: Reflectances of a film coated on some transparent material with n b = 1.5. The legends specify d f in nanometers (zero
means that there is no film). The film IOR n f is 1.8 for (a) and (b), and is 2.2 for (c) and (d). Refer to Table 1.
valleys of a reflectance change and more extreme values occur
in the visible range, similar to the case of a transparent base.
One difference is that the copper or silver surface is highly
reflective when not coated, and coating does not increase the
reflectance.

where H is the half-way vector defined as
H≡

L+V
,
|L + V|

(4.2)

which equally subdivides L and V (see Figure 9).
4. Free Films
4.1. Effect of point source
Now we discuss the interference at a free film under the illumination of one point source. In practice, a film surface
is usually very smooth, but it is not perfectly flat. Figure 8
shows a microscopic view of a film. The local surface normal
Nl (the bold font denotes a vector) depends on the location
and may differ from the global surface normal N. Given the
lighting direction L (pointing to the source) and viewing direction V (pointing to the viewpoint), not every part of the
film will contribute to the reflection. In Figure 8, the areas at
points P1 and P2 contribute, but the area at Q does not. The
condition for an area to contribute is
Nl = H,

(4.1)

The probability of the areas with Nl satisfying Eq. (4.1)
affects the highlight. This probability is related to the surface
normal distribution and depends on the statistical types and
parameters of the surface such as the surface height deviation
and correlation length [Sun07]. If the surface is a Gaussian
height field, the probability has a form of Gaussian function, as occurring in the well-known Cook-Torrance model
[CT82]. However, considering that practical film surfaces are
usually rather smooth, it is adequate to describe the probability in terms of a Blinn–Phong factor. That is, the reflected
intensity is expressed as
I (λ) = I ps (λ) R¯ freeFilm (λ, θa ) |H · N|q ,

(4.3)

where q is a positive number (larger q for a smoother surface),
I ps (λ) the intensity of the point source (subscript ‘ps’ stands
for ‘point source’), and R¯ freeFilm is computed from Eqs. (3.16)

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

1614

Y. Sun & Q. Wang / Interface Shaders of Thin Films

Figure 6: Reflectances of a film coated on copper. The legends give the film thickness d f in nanometres (zero means that there
is no coated film). The film IOR n f is 1.8 for (a) and (b), and is 2.2 for (c) and (d).
and (3.11). The incident angle θ a can be computed from
θa = arc cos(|H · L|).

(4.4)

Similarly, the transmitted intensity is given by
I (λ) = I ps (λ)T¯freeFilm (λ, θa ) |H · N|q ,

(4.5)

where T¯freeFilm is computed from Eqs. (3.16), (3.11), and
(3.13). In the transmission case, since the source and viewpoint are on different sides of the film, the halfway vector
needs to be determined differently. Let Lt denote the lighting
direction and N point to the side of the viewpoint (Figure 9).
We first compute L, which is the mirror reflection of Lt about
the film,
L = Lt − 2(N · Lt )N.

(4.6)

Then H is computed from Eq. (4.2) and the incident angle
θ from Eq. (4.4). As a verification, consider the special case
that Lt = −V, for which the viewpoint should receive the
maximum intensity of transmission. Since L is the mirror
reflection of Lt about the film, H coincides with N and thus the
Blinn–Phong factor in Eq. (4.5) indeed gives the maximum
intensity.

4.2. Effect of ambient light
Given a point on the film, in contrast to a point source where
light comes from a particular direction, ambient light comes
from various directions. Since a film is usually very smooth,
the reflected intensity from a film due to ambient illumination
is mainly from the mirror-reflection direction and therefore
may be computed by
I (λ) = Iam (λ) R¯ freeFilm (λ, γa ),

(4.7)

and the transmitted intensity is
I (λ) = Iam (λ)T¯freeFilm (λ, γa ),

(4.8)

where I am (λ) is the incident ambient intensity and γ a is the
incident angle. Given the surface normal N and the viewing
direction V, γ a should be computed from
γa = arc cos(|N · V|),

(4.9)

because this angle gives the perfect specular reflection or
transmission. With a fixed viewpoint, γ a varies with the location on the film, as shown in Figure 10, and as a result the
interference colour varies as well.

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

Y. Sun & Q. Wang / Interface Shaders of Thin Films

1615

Figure 7: Reflectances of a film coated on silver. The legends give the film thickness d f in nanometres (zero means that there is
no coated film). The film IOR n f is 1.8 for (a) and (b), and is 2.2 for (c) and (d).

Figure 8: Microscopic view of a film. The local surface
normal directions Nl may differ from the global surface
normal N.

Figure 9: Computing the halfway vectors in the cases of
reflection (left) and transmission (right).

4.3. Total illumination
The total outgoing light has contributions from the ambient
light and the point source. Considering the reflection case
only, the total reflected intensity is
Ir (λ) = kam Iam (λ) R¯ freeFilm (λ, γa )
+ k ps I ps (λ) R¯ freeFilm (λ, θa ) |H · N|q

(4.10)

where I am (λ) is the ambient intensity, I ps (λ) the intensity of
the source, and R¯ freeFilm the reflectance of a free film com-

puted from Eqs. (3.16) and (3.11). Coefficients kam and kps
are introduced to control the weights of the two terms (as the
physical meanings, kam and kps may be regarded as controls
of the brightness of the sources). In Eq. (4.10), θ a is the incident angle for the point source and should be computed from
Eq. (4.4), but γ a is the incident angle for the ambient illumination and should be computed from Eq. (4.9). Because of
this difference, for clarity, we denote the incident angles for
the point source and the ambient light differently. Similarly,

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

1616

Y. Sun & Q. Wang / Interface Shaders of Thin Films

5. Film-Coated Bulk Objects
A bulk object implies that it is thick in depth (in contrast to
thin objects whose thickness is typically on the scale of 0.1 or
1 mm). The object can be opaque or transparent. Real-world
examples include film-coated glassware.
5.1. Opaque base material
Figure 10: The incident angle of ambient illumination varies
with the location on the film.

When the bulk base material is opaque, we only need to
handle reflection. The total reflected intensity is
I (λ) = kam Iam (λ) R¯ filmOnOpaque (λ, γa )
+ k ps I ps (λ) R¯ filmOnOpaque (λ, θa ) |H · N|q

in the case of transmission, the total transmitted intensity is
It (λ) = kam Iam (λ)T¯freeFilm (λ, γa )
+ k ps I ps (λ)T¯freeFilm (λ, θa ) |H · N|q

(4.11)

where T¯freeFilm is the transmittance of a free film and is computed from Eqs. (3.16), (3.11), and (3.13).
When a point source and ambient light are present, the
total outgoing light from the film has contributions from both
reflection and transmission
Itotal (λ) = Ir (λ) + It (λ),

(4.12)

where I r (λ) is given by Eq. (4.10) and I t (λ) by Eq. (4.11).
If the ambient light is uniform in all directions, the ambient
terms for reflection and transmission can be merged such that
the total outgoing intensity is
Itotal (λ) = kam Iam (λ) + k ps I ps (λ) R¯ freeFilm (λ, θa ) |H · N|q
(4.13)
if the point source generates reflection, and is
Itotal (λ) = kam Iam (λ) + k ps I ps (λ)T¯freeFilm (λ, θa ) |H · N|q
(4.14)
if the point source generates transmission. However, if the
ambient light is not uniform in all directions, the ambient reflection and transmission should be kept as separate terms. In
this case, it might be helpful to express the ambient intensity
in the form of I am (λ, ω), where ω is the spatial direction.
I am (λ, ω) can be represented with an environment illumination map for ω in the domain of a hemisphere or sphere.
When multiple point sources are present, the terms for
one point source in Eqs. (4.10)–(4.14) should be replaced
with a summation over all sources. Finally, if comparing Eqs.
(4.10)–(4.14) to a regular Blinn–Phong illumination model,
we see that the diffuse term is absent. This is justified by the
fact that a film surface is so smooth that the diffuse term is
not important.

(5.1)

which is similar to Eq. (4.10) except that R¯ filmOnOpaque should
be computed using Eq. (3.19).
5.2. Transparent base material
When the base material is transparent, we need to consider
four cases of illumination:
1. Reflection in the side of the air.
2. Transmission from the air to the base material.
3. Reflection in the side of the base material.
4. Transmission from the base material to the air.
In Case 1, the illumination equation is
I (λ) = kam Iam (λ) R¯ filmOnTransp (λ, γa )
+ k ps I ps (λ) R¯ filmOnTransp (λ, θa ) |H · N|q

(5.2)

which is similar to Eq. (4.10) except that R¯ filmOnTransp is computed from Eq. (3.12). In Case 2, the transmitted intensity
is
I (λ) = kam Iam (λ)T¯filmOnTransp (λ, γa )
+ k ps I ps (λ)T¯filmOnTransp (λ, θa ) |H · N|q

(5.3)

which is similar to Eq. (4.11) except that T¯filmOnTransp is computed from Eq. (3.13).
In Cases 3 and 4, since light sources are usually not present
inside a transparent object, there is no outgoing light as result of direct illumination. For indirect light, the outgoing
intensity in Case 3 is
I (λ) = I0 (λ) R¯ filmOnTransp (λ, θb ),

(5.4)

and in Case 4 is
I (λ) = I0 (λ)T¯filmOnTransp (λ, θb ),

(5.5)

where I 0 (λ) is the intensity of the incident light. Eqs. (5.4)
and (5.5) will not be used in the rendering in the current paper,
but they are useful for global illumination computation such
as in ray tracing.

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

Y. Sun & Q. Wang / Interface Shaders of Thin Films

1617

Figure 11: Cross-sections of a thin object with one-side coating. Higher-order reflections within the base material layer are
ignored. (a) Incident light from the film side. (b) Incident light from the supportive layer side.
6. Thin Objects with One-Side Coating
Film-coated thin objects such as plastic ribbons need to be
handled specifically. Consider a thin object with one-side
coating. Figure 11 shows the cases of light incidence from
the film side and from the base side. While the thickness d f
of the film is below or comparable to the wavelength such
that interference occurs, the thickness D of the supportive
layer (i.e. the base material) is typically on the scale of 0.1
mm, which is too large to cause interference (see Appendix
D). In spite of that, the supportive layer can contribute with
a transparent colour due to volumetric absorption within the
layer. But on geometric modelling, the supportive layer is
sufficiently thin so that the object can be model in terms of a
single surface.
As the base material, the supportive layer may be opaque
or transparent. If it is opaque, we only need to consider reflection, for which the illumination model is given in Eq. (5.1). If
the base is transparent, we need to consider four illumination
cases (see Figure 11):

Figure 12: Procedure for determining the illumination type
for a point of surface with one-side coating.

A.Light is reflected on the film side.
B. Light transmits from the film to base.
C. Light is reflected on the base side.
D.Light transmits from the base to film.
When a thin object (such as a ribbon) has one-side coating,
as a convention, we specify that the side which the surface
normal points to is coated. Given the viewpoint and a point
source, the specific illumination case is determined by the
procedure in Figure 12.
6.1. Reflection on the film side
In Case A, light is reflected on the film side, as shown in
Figure 11a. In the reflected light, one component is
Ir 1 (λ) = I0 (λ) R¯ filmOnTransp (λ, θa ),

(6.1)

where I 0 (λ) is the incident intensity and R¯ filmOnTransp is given
in Eq. (3.12). Another component involves two interference
transmissions at the film and one Fresnel reflection at the
bottom surface of the supportive layer (Figure 11a). Considering the volume absorption in the supportive layer
(Appendix C), the intensity of the second component is
Ir 2 (λ) = I0 (λ)[T¯filmOnTransp (λ, θa )]2 R¯ b|a (λ, θb )
× exp [−2a(λ)D/ cos θb ]

(6.2)

where the exponential term is due to volume absorption,
with a(λ) as the spectral volume absorptivity. In Eq. (6.2),
R¯ b|a (λ, θb ) is the Fresnel reflectance at the surface between the base and air, and is given by Eq. (A.10) in
Appendix A.

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

1618

Y. Sun & Q. Wang / Interface Shaders of Thin Films

Besides I r 1 and I r 2 , there are contributions from higherorder reflections in the base layer, as indicated by the dashed
arrow in Figure 11a. If we ignore those higher-order contributions, the total reflectance is
R¯ oneSide (λ, θa ) = R¯ filmOnTransp (λ, θa )
2a(λ)D
+ [T¯filmOnTransp (λ, θa )]2 R¯ b|a (λ, θb ) exp −
cos θb
(6.3)

Note that this expression is different from Eq. (6.3), the case
of reflection on the film side.
6.4. Transmission from base to film
From Figure 11b, the transmitted light has one Fresnel transmission at the bottom surface and one interference transmission at the film. Ignoring higher-order reflections in the base
layer, the total transmittance is
T¯oneSide (λ, θa ) = T¯filmOnTransp (λ, θb )T¯a|b (λ, θb )
× exp [−a(λ)D/ cos θb ]

6.2. Transmission from film to base
From Figure 11b, the transmitted light from the film to base
has one interference transmission at the film and one Fresnel
transmission at the bottom surface of the supportive layer.
Ignoring higher-order reflections in the supportive layer, the
total transmittance is
T¯oneSide (λ, θa ) = T¯filmOnTransp (λ, θa )T¯b|a (λ, θb )
× exp [−a(λ)D/ cos θb ]

(6.4)

where the exponential term is due to volume absorption (Appendix C). Note that the transmittance for the entire thin object cannot be derived simply by the difference between 1 and
the reflectance that is given in Eq. (6.3), because some energy
has been absorbed within the volume of the base material.

Comparing Eqs. (6.8) and (6.4), we find
T¯oneSide (λ, θa ) = T¯oneSide (λ, θa ),

(6.9)

that is, the transmittances are equal for incidences on the
film side and on the base side. This can be easily verified using T¯filmOnTransp (λ, θb ) = T¯filmOnTransp (λ, θa ) in Eq. (3.15) and
T¯a|b (λ, θa ) = T¯b|a (λ, θb ) in Eq. (A.13).
In case that the base material does not absorb light, that is,
a(λ) = 0, adding Eqs. (6.7) and (6.8) yields
T¯thinObj (λ, θa ) + R¯ thinObj (λ, θa )
= T¯filmOnTransp (λ, θb )T¯a|b (λ, θb )
+ R¯ a|b (λ, θa ) + [T¯a|b (λ, θa )]2 R¯ filmOnTransp (λ, θb )
≈ R¯ a|b (λ, θa ) + T¯a|b (λ, θb )

6.3. Reflection on the base side
In Case C, light is reflected on the side of the base, as shown
in Figure 11b. The reflected light has a component with one
Fresnel reflection at the surface between the supportive layer
and the air
Ir 1 (λ) = I0 (λ) R¯ a|b (λ, θa ),

(6.5)

where R¯ a|b (λ, θa ) is given in Eq. (A.10). The second component has two Fresnel transmissions at the bottom surface and
one interference reflection at the film, and its final intensity
is
Ir 2 (λ, θa ) = I0 (λ) T¯a|b (λ, θa )

(6.8)

2

R¯ filmOnTransp (λ, θb )

× exp [−2a(λ)D/ cos θb ]

(6.6)

where the exponential term is from volume absorption,
R¯ filmOnTransp (λ, θb ) is the interference reflectance with incident angle θ b , and T¯a|b (λ, θa ) the Fresnel transmittance at the
bottom surface given in Eq. (A.11). Ignoring higher-order
reflections inside the layer, we combine the two components
and use Eq. (3.14) to obtain
R¯ oneSide (λ, θa ) = R¯ a|b (λ, θa )
2a(λ)D
+ [T¯a|b (λ, θa )]2 R¯ filmOnTransp (λ, θa ) exp −
cos θb

× [T¯filmOnTransp (λ, θb ) + R¯ filmOnTransp (λ, θb )]
= R¯ a|b (λ, θa ) + T¯a|b (λ, θb ) = 1
which confirms energy conservation. The conservation is also
confirmed by adding Eqs. (6.3) and (6.4).
6.5. Total illumination
In the reflection case, the total reflected intensity is
Ir (λ) = kam Iam (λ) R¯ oneSide (λ, γa )
+ k ps I ps (λ) R¯ oneSide (λ, θa ) |H · N|q

It (λ) = kam Iam (λ)T¯oneSide (λ, γa )
+ k ps I ps (λ)T¯oneSide (λ, θa ) |H · N|q

(6.11)

where T¯oneSide is the transmittance computed from Eq. (6.4).
The total outgoing light consists of reflection and transmission
Itotal (λ) = Ir (λ) + It (λ),

(6.7)

(6.10)

where R¯ oneSide is the reflectance given by Eq. (6.3) or (6.7).
The total transmitted intensity is

(6.12)

where I r (λ) is given by Eq. (6.10) and I t (λ) by Eq. (6.11).

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

1619

Y. Sun & Q. Wang / Interface Shaders of Thin Films

7.2. Transmission
In Figure 13, the transmitted light has one interference transmission at the top film and one at the bottom film. Ignoring
the higher-order reflections in the supportive layer and using
Eq. (3.15), the final transmittance is
T¯twoSide (λ, θa ) = [T¯filmOnTransp (λ, θa )]2
× exp[−a(λ)D/ cos θb ]

(7.4)

where the exponential term is due to volume absorption.
7.3. Total illumination
In the reflection case, the total reflected intensity is
Ir (λ) = kam Iam (λ) R¯ twoSide (λ, γa )
Figure 13: Cross-section of a thin object with two-side coating. Higher-order reflections within the base material layer
are ignored.

+ k ps I ps (λ) R¯ twoSide (λ, θa ) |H · N|q

(7.5)

where R¯ twoSide is the reflectance given by Eq. (7.3). Similarly,
the total transmitted intensity is
It (λ) = kam Iam (λ)T¯twoSide (λ, γa )

7. Thin Objects with Two-Side Coating
A thin object such as a ribbon may be film-coated on both
sides (Figure 13). In this paper, we assume that the films on
both sides have the same properties (i.e. thickness and IOR).
(In practice, this can be easily achieved using the vapour
deposition technologies [Bun94, GS03, Tra06].) Since the
structure is symmetric about the two sides, we only need to
consider two cases: reflection and transmission.

+ k ps I ps (λ)T¯twoSide (λ, θa ) |H · N|q

(7.6)

where T¯twoSide is the transmittance computed from Eq. (7.4).
The total outgoing light is
Itotal (λ) = Ir (λ) + It (λ),

(7.7)

where I r (λ) is given by Eq. (7.5) and I t (λ) by Eq. (7.6).
8. Image Rendering

7.1. Reflection

8.1. Implementation

In the reflected light, one component is
Ir 1 (λ) = I0 (λ) R¯ filmOnTransp (λ, θa ),

(7.1)

where I 0 (λ) is the incident intensity and R¯ filmOnTransp is given
in Eq. (3.12). Another component involves two interference
transmissions at the top film and one interference reflection
at the bottom film (Figure 13). Considering the volume absorption in the supportive layer, the second component is
Ir 2 (λ) = I0 (λ)[T¯filmOnTransp (λ, θa )]2
× R¯ filmOnTransp (λ, θb ) exp[−2a(λ)D/ cos θb ]
(7.2)
where the exponential term is due to volume absorption. If
we ignore the higher-order reflections and apply Eq. (3.14),
the overall reflectance is
R¯ twoSide (λ, θa ) = R¯ filmOnTransp (λ, θa )
× 1 + [T¯filmOnTransp (λ, θa )]2 exp −

2a(λ)D
cos θb

(7.3)

We implemented all illumination models of single thin films
using RenderMan [Rag05, Ups90]. RenderMan provides the
Slim Tool for the user to write new shaders. This tool allows
convenient combinations of new shaders with the built-in
shaders such as those for bump and texture mappings. Using
the Slim Tool, we can easily control parameters in an illumination model, such as the film thickness, film IOR, Phong
power and ambient and specular coefficients.
Because RenderMan is an RGB-based renderer, to describe
the wavelength dependency of interference, we need to convert RGB colours to spectra, for example, for the incident
light intensities. This was done by applying the iridescent
shading process introduced in a previous publication [Sun06].
This process starts with transforming an input RGB colour to
the CIE XYZ model and then to a spectrum, applies a spectral
illumination model, and transforms the final spectrum back
to an RGB colour. Note that an interference colour may be
located outside the displayable colour gamut. If this occurs,
we need to clamp the interference colour to a displayable
colour and for this we adopted the same approach used in the
previous research [Sun06].

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

1620

Y. Sun & Q. Wang / Interface Shaders of Thin Films

When a film is coated on an opaque object, the optical constants η (λ) and κ (λ) of the object need to be specified. Since
η (λ) and κ (λ) are spectra, in our implementation, they were
specified in terms of six wavelengths evenly sampled from
400 to 700 nm. The function values at the six wavelength
samples were represented using two 3D vectors in RenderMan, each vector offering three input fields of floating-point
numbers. Given any wavelength, the corresponding spectral
value was obtained by a linear interpolation of the values
at the neighbour wavelength samples. This method was also
used to specify the spectral volume absorptivity a(λ) of a
transparent thin object. Usually, six wavelength samples offer a sufficient accuracy to represent smooth spectra. (If more
wavelength samples are needed for higher accuracy, a spectrum could be represented using nine wavelengths or three
3D vectors in RenderMan.)
On geometric modelling, the case that a thin object (such
as a ribbon) with one-side coating needs to be handled specifically to indicate the coating side. Our approach was to let
the surface normal point toward the side with coating. In the
case of a film-coated bulk object, the coating is always outside the object and the surface normal points outside as well.
There is no need to specify the coating side for free films and
thin objects of two-side coating, because these structures are
symmetric about the two sides.
Our implementation used a 1.66 GHz Intel Core Duo
T2300 system with 1GB memory and an NVIDIA GeForce
Go 7800 display adaptor with 256MB on-board memory. The
time for rendering an image of size 800 by 600 pixels typically took about 1 sec.

8.2. Free films
Figure 14 shows the rendered images of a free film for the
reflection and transmission cases (refer to Section 4). The
film’s IOR is 1.5. The film thickness, which varies with surface location, is specified by the greyscale map in the bottom
right corner in the rendered image for the transmission case.
In this map, the darkest area corresponds to d f = 300 nm and
the brightest to d f = 600 nm. The thickness map causes the
variation of interference colour on the film.
The interference colours of the two rendered images in
Figure 14 are complementary. This means that adding the
colours at the corresponding pixels in the two images will
give a white colour. For example, the colour at the centre
is blue in the rendered image for the reflection case, but is
yellow in the rendered image for the transmission case, where
the blue and yellow colours are complementary. This feature
agrees with Eq. (3.17), which shows that the addition of the
reflectance and transmittance of a free film is equal to 1.
To confirm this observation, in Figure 14 we plot the RGB
components for the pixels along two vertical lines (in yellow) that correspond to each other in the two rendered im-

Figure 14: Interferences of a free film. Top: Rendered images
for the reflection case (left) and for the transmission case
(right). The film thickness is given by the greyscale map in
the bottom right corner in the right image. Bottom: Plots of
the RGB components for the pixels along the yellow vertical
lines in the rendered images.
ages. In this plot, the RGB components for the reflection
case are the curves with relatively lower intensities, and the
RGB components for the transmission case are the curves
with relatively higher intensities, and the summations of the
components are flat lines, whose values are close to 255, the
value for the perfect white. The slight difference between an
RGB component in a summation colour and 255 is due to
the limited wavelength samples, which are six in our implementation. Generally speaking, the rendered colours will be
more accurate when more wavelength samples are used in
the implementation.
Finally, note that the colours in the rendered image for the
reflection case are much darker than those in the transmission
case. This is because the film reflectances are much smaller
than the transmittances at the normal incidence of light (refer
to Figure 3).
8.3. Bulk opaque and transparent objects
The vases in Figure 15 were rendered using the illumination
models of film interference for bulk opaque and transparent
objects (refer to Section 5). The base materials for the top,
middle and bottom rows are silver (opaque), copper (opaque)
and glass (transparent), respectively. In each row, the first

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

Y. Sun & Q. Wang / Interface Shaders of Thin Films

1621

Figure 15: Rendered vases of silver (top row), copper (middle row), and glass (bottom row). In each row, the first vase is not
coated with film and the others are coated with film. The rendering conditions are shown in Table 2. The Phong power is set to
q = 10.
Table 2: Rendering conditions for Figure 15. Image column refers
to Figure 15. kam and kps are the ambient and specular coefficients,
and df and nf are the film thickness and IOR

Image column

Film coating

kam

kps

df (nm)

nf

1
2
3
4
5
6

No
Yes
Yes
Yes
Yes
Yes

0.3
0.3
0
0.3
0.3
0.3

0.7
0
0.7
0.7
0.7
0.7

—
250
250
250
250
350

—
2.2
2.2
2.2
1.8
2.2

vase is not coated with film and the others are coated. The
rendering conditions are described in Table 2.
In Figure 15, the vases in Column 2 are rendered with the
presence of the ambient light only. The vase colours vary on
the surface, resulting from different incident angles of the
ambient light [refer to Figure 10 and Eq. (4.9)]. In Column
3, the specular reflection is considered only. The highlight
is controlled by the Phong term with q = 10. The highlight
colour varies slightly, and this is because the incident angle
changes with the location on the object surface given the
fixed viewpoint and point source [refer to Eqs. (4.2)–(4.4)].
The images in Column 4 are the additions of the images in
Columns 2 and 3. The vases in Column 5 have a different
film IOR and in Column 6 have a different film thickness;
both cases result in different interference colours. For the
silver and copper vases, the optical constants are given in
Appendix B. For the glass vases, the IOR is set to 1.5.

From Figure 15, we observe that when a bulk object is
coated with a film, the appearing colours could be entirely
different from the inherent colour of the bulk material. The
rendered colours agree with the numerical results displayed
in Table 1 and Figures 5–7. Also, note that a vase appears
white near its silhouette. This phenomenon is caused by the
property of Fresnel’s law that the reflectance approaches 1 as
the incident light approaches grazing.
To show the dependency of interference colours on the film
thickness, in Figure 16, we have rendered film-coated glass
vases of various film thicknesses. For the vases from left to
right, the film thicknesses are 50, 100, 200, 300, 400 and
500 nm, respectively. The film IOR is 2.2. While the interference colours are different among the vases, the first
vase appears grey, close to the inherent colour of a glass
vase without film coating. This is because the film thickness
is only 50 nm, too small to cause significant interference
colours. Note that the last image (d f = 500 nm, n f = 2.2) in
Figure 15 appears similar to the last image (d f = 350 nm,
n f = 2.2) in Figure 16. For these two images, if referring
to the corresponding reflectances in Figure 5, we find that
their reflectance curves are significantly different although
both have considerable components in the red and blue wavelength regions. This is associated with a colour phenomenon
called metamerism [JW75, WS82]. Therefore, substantially
different parameter values of a film structure may produce
similar interference colours.
Figure 17 shows rendered film-coated craft turtles with
bulk materials of silver, copper, and glass. The film thickness
is 250 nm, and the film IOR is 2.2. The object surfaces are
smooth in the first row, and a bump mapping is used in the

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

1622

Y. Sun & Q. Wang / Interface Shaders of Thin Films

Figure 16: Rendered film-coated glass vases of various film thicknesses. From left to right, the film thicknesses are 50, 100,
200, 300, 400 and 500 nm, respectively. The film IOR is 2.2. The Phong power is set to q = 10.

Figure 17: Rendered film-coated craft turtles. The bulk materials in the left, middle, and right columns are silver, copper, and
glass, respectively. The object surfaces are smooth in the first row, and a bump mapping is used in the second row. The film
thickness is 250 nm and the film IOR is 2.2. One point source is located above of the object. The Phong power is set to q = 20.
The ambient and specular coefficients are 0.5 and 1.
second row. A point source is located above the object. The
Phong power is q = 20. The ambient and specular coefficients
are 0.5 and 1. Note the varying colours of the highlights. The
colours of bump stripes appear white due to the Fresnel’s law
where the reflectivity approaches 1 at a grazing incident angle. To demonstrate the effects of multiple objects in a bright
scene, Figure 18 shows rendered craft turtles on a surface
with a wood texture. The large turtle and the small turtle in
the middle are film-coated, with the same conditions for the
middle and left columns in Figure 17. The bulk materials of
the other two small turtles are copper and silver, both without
coating.

8.4. Ribbons
Figure 19 shows rendered flat ribbons with one-side or twoside coating (refer to Section 7). The conditions are displayed
in Table 3. Besides, the film thickness is 300 nm, the film IOR
is 2.2, and the base IOR is 1.4. A point white source is present
and there is no ambient light. The Phong power is 20.
In Figure 19, the materials of the supportive layer (i.e.
plastic) in the first three rows are transparent and colourless,
that is, the base material does not absorb light. As a result,
the interference colours on the ribbons in the reflection and
transmission cases are exactly complementary. For the mid-

dle three rows, the base material is ‘transparent blue’ (see
Appendix C) and the thickness of the supportive layer is 0.2
mm. In the transmission case, the blue colours due to volume
absorptions dominate the appearances of the ribbons. In the
reflection case, the interference colours (which are green) are
significant in the case of one-side coating facing front and in
the case of two-side coating. However, the interference is less
significant in the case of one-side coating facing back (in row
E), because the regular Fresnel reflection at the front surface
of the supportive layer dominates and generates a grey colour.
In the last three rows, the base material is still ‘transparent
blue’ but the thickness of the supportive layer is 0.1 mm, implying that the volume absorptions are weaker. Thus, in the
transmission case, the blue colours due to volume absorptions
are less dominating and the magenta colours due to interferences make the overall colours purplish. Also, less volume
absorption makes the interference colour more visible for the
reflection in the case of one-side coating facing back (in row
H). Finally, the cases of two-side coating (rows C, F and I)
generate more saturated colours than the cases of one-side
coating. This is reasonable because more interference films
typically lead to sharper outgoing light spectra and thus more
saturated interference colours.
Figure 20 shows rendered helical ribbons with two-side
coating. The conditions are displayed in Table 4. Besides,
the film thickness is 300 nm, the film IOR is 2.2, and the

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

1623

Y. Sun & Q. Wang / Interface Shaders of Thin Films

Figure 18: Rendered craft turtles on a surface with a wood texture in a bright scene. (See description in the text).
Table 3: Rendering conditions for Figure 19. D is the thickness of
the supportive layer. The material of ‘transparent colourless’ means
that there is no volume absorption. For the material of ‘transparent
blue’, the spectral volume absorptivity is given in Appendix C

Figure 19: Rendered flat ribbons for reflection (left column)
and transmission (right column) of one point source. The
conditions are shown in Table 3. Besides, the film thickness
is 300 nm, the film IOR is 2.2 and the base IOR is 1.4. No
ambient light is used and the Phong power is 20.

base IOR is 1.4. A point white source is present and there is
no ambient light. The Phong power is 20. The interference
colours on the ribbons in Figure 20 agree with the results
for the reflection and transmission cases shown in Figure 19.
When the angle between the lighting and viewing directions
is 90 degrees, the interference colours are different from the
reflection and transmission cases because the incident angles
are different.
Figure 21 shows rendered flower-like ribbons with twoside coating. In the left image the base material is transparent and colourless (the base IOR is 1.4). In the right image the base material is ‘transparent blue’ (the base IOR
is 1.4 and the base thickness is 0.1 mm). The film thickness is 230 nm, the film IOR is 2.2. The Phong power is 20.
No ambient light is used, and two point sources are present,

Row

Base material

D (mm)

Coating type

A
B
C
D
E
F
G
H
I

Transparent colourless
Transparent colourless
Transparent colourless
Transparent blue
Transparent blue
Transparent blue
Transparent blue
Transparent blue
Transparent blue

0.2
0.2
0.2
0.2
0.2
0.2
0.1
0.1
0.1

One-side facing front
One-side facing back
Two-side
One-side facing front
One-side facing back
Two-side
One-side facing front
One-side facing back
Two-side

one near the camera and one from the top right. These two
sources generate different interference colours on the ribbons.
Figure 22 shows a rendered flower-like ribbon with two-side
coating that is attached to a gift box. The parameters for the
ribbon correspond to the left case in Figure 21.
9. Conclusion and Future Work
In summary, this paper has presented a systematic study of
the illumination models for light interferences at single thin
films. The new contributions are in three aspects. First, we
have derived generic analytic expressions of reflectance and
transmittance for film interference based on Fresnel’s law,
as well as the specific expressions for free thin films and
films coated on transparent or opaque objects. Second, by
combining the effects of film interference and spectral volume absorption, we have obtained the overall reflectances and
transmittances for film-coated thin objects, such as ribbons.
Finally, the illumination equations for light interferences at

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

1624

Y. Sun & Q. Wang / Interface Shaders of Thin Films

Figure 20: Rendered helical ribbons with two-side coating. The conditions are shown in Table 4. Besides, the film thickness is
300 nm, the film IOR is 2.2 and the base IOR is 1.4. No ambient light is used and the Phong power is 20.
Table 4: Rendering conditions for Figure 20. D is the thickness of
the supportive layer. The material of ‘transparent colourless’ means
that there is no volume absorption. For the material of ‘transparent
blue’, the spectral volume absorptivity is given in Appendix C
Row

A
B
C
D
E
F
G
H
I

Base material

Transparent colourless
Transparent colourless
Transparent colourless
Transparent blue
Transparent blue
Transparent blue
Transparent blue
Transparent blue
Transparent Blue

D (mm)

0.2
0.2
0.2
0.2
0.2
0.2
0.1
0.1
0.1

Angle between
L and
V (degrees)
0 (reflection)
90
180 (transmission)
0 (reflection)
90
180 (transmission)
0 (reflection)
90
180 (transmission)

single thin films have been presented in all cases of single thin
films. These illumination models have been implemented in
an RGB-based renderer and tested on thin films of various
structures and materials.
In previous studies of light interference at single thin films
in computer graphics, illumination models were only available for the cases of free thin films and films that are coated
on transparent objects. The interference reflectances of single
films in previous studies were obtained by considering only
the interference between the two major outgoing rays, but the
effects of Fresnel’s law were not considered. In contrast, in
this paper, we have considered the entire series of the outgoing rays as well as Fresnel’s law. It is important to involve
Fresnel’s law to achieve the rendering realism. In particular,
at a grazing incident angle, both surfaces of a thin film reflect light almost completely at all wavelengths, resulting in
a white colour. Without considering Fresnel’s law, this effect
cannot be modelled properly.

Moreover, for the first time, this paper has derived the
exact analytic interference reflectance of a film that is coated
on an opaque material. In this case, the optical constants
of the material are involved. In addition, we have modelled
the combined phenomena of film interference and volume
absorption. The integration of these phenomena is necessary
to render realistic colours of film-coated ribbons.
The analytic reflectances, transmittances and the associated illumination models derived in this paper can be implemented as new shaders to extend the existing graphics
renderers. As an example, we implemented the interference
shaders in RenderMan and the rendering speeds involving
these shaders are fast. These interference shaders can be conveniently used together with the built-in shaders such as those
for texture and bump mappings.
The research in the current paper could be extended in several directions. First, the derived analytic reflectances, transmittances, and illumination models of thin films could be applied in a rendering procedure or system that handles global
illumination. This can further improve the rendering realism of film-coated transparent bulk objects or ribbons, where
multiple reflections and transmissions generate more bright
and saturated interference colours. Second, the proposed illumination models could be used together with more advanced
mapping techniques. One example is to apply an interference
shader with an environment illumination map. This combination, for example, could be used to render a soap bubble,
where the ambient term in the illumination model for a free
film is associated with the illumination map. Moreover, the illumination models presented in this paper could be improved
further in accuracy. For example, the Blinn–Phong term could
be replaced with an analytic function that describes the surface normal distribution such as in the Cook-Torrance model
[CT82]. Finally, the analytical methods and classification of
film interferences in this paper are useful for handling other
cases of interferences such as for multilayer structures and
flake particles (see Figure 2).

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

1625

Y. Sun & Q. Wang / Interface Shaders of Thin Films

Figure 21: Rendered flower-like ribbons with two-side coating. In the left image, the base material is transparent and colourless
(the base IOR is 1.4). In the right image the base material is ‘transparent blue’ (the base IOR is 1.4 and base thickness is 0.1
mm). The film thickness is 230 nm, the film IOR is 2.2. The Phong power is 20. No ambient light is used, and two point sources
are present, one near the camera and one from the top right.
significant errors. To achieve higher rendering accuracy of
natural phenomena, the spectral approach is better and thus
deserves more research in future.
Appendix A: Fresnel Equations
Here we briefly review on Fresnel equations as a basis of
this paper. For details refer to the literature [BW99, Hec98,
Lev80]. Consider light reflection and transmission at a perfectly smooth interface between media 1 and 2 (Figure A1).
The incident light can be decomposed into components of
parallel and perpendicular polarizations. In the parallel case,
the ratio between the reflected and incident field amplitudes
is
r =

Figure 22: Rendered gift box with a film-coated ribbon. The
condition is similar to the left case in Figure 20.

In computer graphics, RGB triplets and spectral functions
are two approaches to describing light and objects. Currently,
the RGB-based approach is widely adopted as a standard. The
spectral approach is more accurate, but not supported in common graphics platforms and software packages. It is difficult
to use a full spectral approach to simulate film interferences
on complex objects due to the lack of support in advanced
features (such as geometric modelling and mapping techniques) in an entirely spectrally based environment. Since
the RGB-based approach will continue to serve as the basis
in graphics renderers, the practical issues will be on removing
the limitations of common RGB-based renderers as much as
possible. The current paper offers a study for such an extension. With that said, it should be noted that the RGB-based
approach is an approximation that may be associated with

Er
Ei

=

n 2 cos θ1 − n 1 cos θ2
,
n 2 cos θ1 + n 1 cos θ2

(A.1)

and the ratio between the transmitted and incident field amplitudes is
t =

Et
Ei

=

2n 1 cos θ1
,
n 2 cos θ1 + n 1 cos θ2

(A.2)

where θ 1 and θ 2 are the incident and refractive angles, and n 1
and n 2 are the indices of refraction (IORs) of the two media.
In the perpendicular polarization, the ratios for reflection and
transmission are respectively
r⊥ =

Er⊥
n 1 cos θ1 − n 2 cos θ2
=
,
n 1 cos θ1 + n 2 cos θ2
E i⊥

(A.3)

t⊥ =

E t⊥
2n 1 cos θ1
=
.
n 1 cos θ1 + n 2 cos θ2
E i⊥

(A.4)

When light impinges at the same interface but from medium
2 with incident angle θ 2 , the amplitude coefficients r , t , r ⊥
and t ⊥ can be obtained by switching θ 1 with θ 2 , and n 1 with
n 2 in Eqs. (A.1)–(A.4). The Fresnel coefficients are related

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

1626

Y. Sun & Q. Wang / Interface Shaders of Thin Films

From Eqs. (A.5),(A.6),(A.9),and (A.10), the Fresnel reflectances with light incidence in medium 2 are
⎧
R (θ2 ) = |r |2 = |r |2 = R (θ1 )
⎪
⎪
⎨
R⊥ (θ2 ) = |r⊥ |2 = |r⊥ |2 = R⊥ (θ1 )
(A.12)
⎪
⎪
¯ 1)
⎩ R¯ (θ2 ) = R(θ
The combination of Eqs. (A.11) and (A.12) leads to
⎧
T (θ2 ) = T (θ1 )
⎪
⎨
(A.13)
T⊥ (θ2 ) = T⊥ (θ1 )
⎪
⎩
¯
¯
T (θ2 ) = T (θ1 )
If switching the incident and refractive light paths (i.e. switching θ 1 with θ 2 , and n 1 with n 2 ), the Fresnel reflectances and
transmittances remain the same.

Figure A1: Light reflection and transmission at a perfectly
smooth interface between two media.

as
r =

n 1 cos θ2 − n 2 cos θ1
= −r ,
n 1 cos θ2 + n 2 cos θ1

(A.5)

r⊥ =

n 2 cos θ2 − n 1 cos θ1
= −r⊥ ,
n 2 cos θ2 + n 1 cos θ1

(A.6)

t t = 1 − r 2,

(A.7)

t⊥ t⊥ = 1 − r⊥2 ,

(A.8)

and Eqs. (A.5)–(A.8) are known as the Stokes relations. The
negative sign in Eqs. (A.5) and (A.6) implies a phase shift
of π.
Since r and r ⊥ are complex numbers in the general case,
the Fresnel reflectance, which is the percentage of the reflected energy, is the squared modulus of r or r ⊥ :
R = |r | ,R⊥ = |r⊥ | ,
2

2

(A.9)

The Fresnel reflectance averaged over polarizations is
1
R¯ = (R + R⊥ ).
2

(A.10)

When medium 2 is transparent, the Fresnel transmittance can
be obtained from the Fresnel reflectance using the condition
of energy conservation
¯
T¯ = 1 − R.

(A.11)

In general an IOR is a complex number. For an opaque
medium (Appendix B), both the real and imaginary parts of
the IOR are important for computing the Fresnel coefficients.
For a transparent medium (Appendix C), the imaginary part is
much smaller than the real part and can be ignored when computing the Fresnel coefficients (thus the IOR may be regarded
as real). Given a transparent medium, from Eqs. (A.1)–(A.4),
the Fresnel coefficients are real except when a total internal
reflection occurs. In this paper, since the medium interfaces
are parallel (see Figure 1), the ray angle in a medium corresponds to the ray angle in the air via Snell’s law
sin θa = n sin θ,

(A.14)

where θ a is the incident angle in the air and θ is the ray
angle in a medium with an IOR of n. Since the ray angle θ
in the medium results from θ a in the air, it will not cause
a total internal reflection. Therefore, the Fresnel coefficients
of transparent media involved in this paper are real. This
conclusion is used in the calculation in Section 3.
Appendix B: Opaque Material
A complex IOR is generally expressed as
n(λ) = η(λ) + iκ(λ),

(B.1)

where η (λ) is called the simple IOR, κ (λ) the extinction
coefficient, and η (λ) and κ (λ) together are called the optical
constants. Optical constants are inherent properties of material. As examples, Figure B1 displays the optical constants
of copper and silver [Gla95].
Consider light reflection at an interface between a transparent material and an opaque material. Since the incident
medium is transparent, the incident IOR n 1 is real. From
Snell’s law,
sin θ2 =

η − iκ
n 1 sin θ1
n 1 sin θ1
= 2
=
n 1 sin θ1 ,
n opaque
η + iκ
η + κ2
(B.2)

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

1627

Y. Sun & Q. Wang / Interface Shaders of Thin Films

Applying the square operation to Eqs. (B.6a) and (B.6b) and
adding the results, we obtain
(u 2 + v 2 )2 =

η2 − κ 2 − n 21 sin2 θ1
η2 +

2

+ 4η2 κ 2

2
κ2

(B.7)

or
u 2 + v2 =

η2 − κ 2 − n 21 sin2 θ1
η2

+

2

+ 4η2 κ 2

κ2

Combining Eqs. (B.6a) and (B.8),
⎧
⎪
⎪
(η2 − κ 2 − n 21 sin2 θ1 )2 + 4η2 κ 2
⎪ 2
⎪
⎪
=
2u
⎪
⎪
η2 + κ 2
⎪
⎪
⎪
⎪
⎪
η2 − κ 2 2 2
⎪
⎪
⎪
+1 − 2
n sin θ1
⎨
(η + κ 2 )2 1
⎪
⎪
⎪
(η2 − κ 2 − n 21 sin2 θ1 )2 + 4η2 κ 2
⎪
⎪
⎪ 2v 2 =
⎪
⎪
η2 + κ 2
⎪
⎪
⎪
⎪
2
⎪
η − κ2 2 2
⎪
⎪
−1 + 2
n sin θ1
⎩
(η + κ 2 )2 1

(B.8)

(B.9)

Here u and v should take positive values. The reason is that
from Eq. (B.6b) u and v must have the same sign because η
and κ are nonnegative, and considering the case when κ = 0,
u is positive from Eq. (B.4). To verify Eq. (B.9), when κ =
0, (B.9) gives u = cos θ 2 and v = 0, which agrees with Eq.
(B.4).
Figure B1: The optical constants of copper and silver. The
top plot shows the simple IORs [i.e. η(λ)] and the bottom
shows the extinction coefficients [i.e. κ(λ)].

Using u and v given in Eq. (B.9), we can compute the real
and imaginary parts of the Fresnel coefficients defined in Eqs.
(A.1) and (A.3). From Eq. (A.1),
r =

cos θ2 =

=

1 − sin2 θ2

= 1−

η2 − κ 2 − 2iηκ 2 2
n 1 sin θ1
(η2 + κ 2 )2

1/2

(B.3)

Since cos θ 2 is a complex number, we let
cos θ2 = u + iv,

(B.4)

(B.5)

η2 − κ 2 2 2
n sin θ1 ,
(η2 + κ 2 )2 1

2ηκ
2uv = 2
n 2 sin2 θ1 .
(η + κ 2 )2 1

This leads to
⎧
(η2 + κ 2 ) cos2 θ1 − n 21 (u 2 + v 2 )
⎪
⎪
⎪
⎨Re(r ) = (η cos θ + n u)2 + (κ cos θ + n v)2
1
1
1
1
⎪
2
cos
θ
(κu
−
ηv)
⎪
1
⎪
⎩Im(r ) =
(η cos θ1 + n 1 u)2 + (κ cos θ1 + n 1 v)2

r⊥ =
=

Comparing Eqs. (B3) and (B.5), we obtain
u 2 − v2 = 1 −

(η cos θ1 − n 1 u) + i(κ cos θ1 − n 1 v)
(η cos θ1 + n 1 u) + i(κ cos θ1 + n 1 v)

(B.10)

(B.11)

Similarly, from Eq. (A.3),

where u and v are real. The square of Eq. (B.4) gives
cos2 θ2 = u 2 − v 2 + 2iuv.

(η + iκ) cos θ1 − n 1 (u + iv)
(η + iκ) cos θ1 + n 1 (u + iv)

(B.6a)

(B.6b)

n 1 cos θ1 − (η + iκ)(u + iv)
n 1 cos θ1 + (η + iκ)(u + iv)
(n 1 cos θ1 − ηu + κv) − i(ηv + κu)
(n 1 cos θ1 + ηu − κv) + i(ηv + κu)

This leads to
⎧
⎪
⎪
⎪
⎨Re(r⊥ ) =
⎪
⎪
⎪
⎩Im(r⊥ ) =

n 21 cos2 θ1 − (η2 + κ 2 )(u 2 + v 2 )
(n 1 cos θ1 + ηu − κv)2 + (ηv + κu)2
−2η cos θ1 (ηv + κu)
(n 1 cos θ1 + ηu − κv)2 + (ηv + κu)2

(B.12)

(B.13)

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

1628

Y. Sun & Q. Wang / Interface Shaders of Thin Films

Finally, note that the reflectance is
R = |r |2 = [Re(r )]2 + [Im(r )]2

(B.14)

for the parallel polarization and is
R⊥ = |r⊥ |2 = [Re(r⊥ )]2 + [Im(r⊥ )]2

(B.15)

for the perpendicular polarization.
Appendix C: Transparent Material
The general form of an IOR is given in Eq. (B.1). For a
transparent material, the imaginary part κ is much smaller
than the real part η. When computing the Fresnel coefficients,
κ can be ignored and the IOR may be regarded as real. The
validity is shown below.
Consider light propagation over distance x in a homogeneous transparent material. Let us describe the field using a
plane wave
2πin(λ)x
˜
E(x)
= E 0 exp(ikx) = E 0 exp
, (C.1)
λ
where E 0 is the amplitude of the field at x = 0. Substituting
Eq. (B.1) into (C.1),
2πiη(λ)x
2πκ(λ)x
˜
E(x)
= E 0 exp
exp −
, (C.2)
λ
λ
where the first exponential term gives the phase of the light
wave and the second causes an attenuation in the amplitude.
The light intensity is given by
2
˜
˜
I (x) = | E(x)|
= E(x)
· E˜ ∗ (x).

(C.3)

Because
2πκ(λ)x
2πiη(λ)x
E˜ ∗ (x) = E 0 exp −
exp −
,
λ
λ

(C.4)

substituting Eq. (C.4) into (C.3),
I (x) = E 02 exp −

4πκ(λ)x
λ

= I0 exp −

4πκ(λ)x
,
λ
(C.5)

where I 0 is the light intensity at x = 0.
Suppose that κ(λ) of some material is comparable to
1. This means that after light travels over a distance x =
λ, from Eq. (C.5), the intensity attenuates to exp(−4π) ≈
3.5 × 10−6 , implying that light almost vanishes. So this material should not be regarded as transparent. In other words, if
a material is regarded as transparent, then κ(λ) 1 muse be
true. Thus the statement that the IOR of a transparent material
may be regarded as real, which was made at the beginning of
this appendix, has been justified.
Light attenuation in a transparent medium is often described by the Bouguer–Lambertian law material [Eva61,

Figure C1: The top plot is the spectral volume absorptivity
of a ‘transparent blue’ material. The curves in the bottom plot
are the internal transmittances for propagation distances of
x = 0.1 mm and x = 0.2 mm. Refer to Eq. (C.7).
SFD99A]. That is, for a propagation over distance x in a
medium, the light intensity is given by
I (λ, x) = I0 (λ)Tinternal (λ, x),

(C.6)

I 0 (λ) is the initial intensity at x = 0 and
Tinternal (λ, x) = exp[−a(λ)x]

(C.7)

is called the internal transmittance, where a(λ) is the spectral
volumetric absorptivity. Comparing Eqs. (C.6) and (C.7) to
Eq. (C.5), we find
a(λ) =

4πκ(λ)
.
λ

(C.8)

This confirms that κ (λ) is associated with absorption.
Larger values of a(λ) implies stronger absorption powers. Different curves of a(λ) produce different transparent
colours of the material [Eva61, SFD99A]. In particular, when
a(λ) is constant, the material is colourless. If a(λ) = 0 (such
as for colourless glass), the material does not absorb light.

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

1629

Y. Sun & Q. Wang / Interface Shaders of Thin Films

Figure D1: (a) Individual light wave packets 1, 2 and so on are generated due to electronic transitions from higher to lower
energy levels. (b) At a thin layer, the outgoing fields E˜ 1 (t) and E˜ 2 (t) originate from the same incident packet, and are coherent
to cause interference. (c) At a thick layer, E˜ 1 (t) and E˜ 2 (t) originate from different incident packets and are incoherent. Note that
different packets are separated with a dash line along the light path in (c).
Figure C1 plots a(λ) and T internal (λ, x) of a ‘transparent blue’
medium. From Figure C1, we see that the wavelength regions
with large values of a(λ) have low values in T internal (λ, x). The
‘transparent blue’ medium is used for rendering film-coated
ribbons in this paper.

where E˜ ∗ (t), E˜ 1∗ (t), and E˜ 2∗ (t) are the complex conjugates of
˜
E(t),
E˜ 1 (t), and E˜ 2 (t), respectively. Let ϕ 1 (t) and ϕ 2 (t) be the
phases of E˜ 1 (t) and E˜ 2 (t). Then Eq. (D.2) can be expressed
as
I (t) = | E˜ 1 (t)|2 + | E˜ 2 (t)|2

In above we have assumed that the material is homogeneous. If the material contains volumetric particles that scatter light, the material is translucent and particle scattering
should be considered. Such a medium is not involved in this
paper.

+ 2| E˜ 1 (t)| · | E˜ 2 (t)| cos[ϕ1 (t) − ϕ2 (t)] (D.3)
Usually, when we mention light intensity, it refers to the timeaveraged result for a large time interval [0, T ] that contains
many oscillation cycles. That is,
I =

Appendix D: Light Emission and Coherence
From a natural light source such as an incandescent lamp or
sunlight, light waves are generated in packets due to electronic transmissions from higher to lower energy levels, as
illustrated in Figure D1(a). A light packet has a finite length
and the phases are only preserved within a packet [BW99,
Hec98]. For this reason, light interference only occurs at a
layer with thickness below or comparable to the wavelength.
This statement is justified below.
Consider the time-dependent electric fields E˜ 1 (t) and E˜ 2 (t)
of the light rays reflected from the top and bottom surfaces of
a layer, as shown in Figure D1(b) and (c). The total reflected
field is
˜ = E˜ 1 (t) + E˜ 2 (t).
E(t)

(D.1)

1
T

I = I1 + I2 ,

(D.4)

(D.5)

which implies that light interference does not occur.
Wave packets may have different lengths and their average is called the coherence length. Given a light source, the
coherence length may be estimated with (see page 356 in
[BW99])
c

+ | E˜ 2 (t)|2 + E˜ 1 (t) E˜ 2∗ (t) + E˜ 1∗ (t) E˜ 2 (t) (D.2)

I (t)dt.
0

In Figure D1(b), because the layer is thin so that the outgoing
fields E˜ 1 (t) and E˜ 2 (t) originate from the same wave packet,
the phase difference ϕ 1 (t) − ϕ 2 (t) in Eq. (D.3) causes light
interference. In contrast, in Figure D1(c), the layer is thick
so that E˜ 1 (t) and E˜ 2 (t) originate from different packets, and
therefore ϕ 1 (t) − ϕ 2 (t) vary randomly with the time interval
[0, T ]. Thus the time average of the last term in Eq. (D.3)
vanishes, and this leads to

Correspondingly, the time-dependent intensity is
˜ E˜ ∗ (t) = | E˜ 1 (t)|2
˜ 2 = E(t)
I (t) = | E(t)|

T

∼

λ¯ 2
,
λ

(D.6)

where λ¯ is the average wavelength and λ is the range of
wavelength. For white light with wavelength from 400 to

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

1630

Y. Sun & Q. Wang / Interface Shaders of Thin Films

700 nm, λ¯ = 550 nm and λ = 300 nm. This gives a coherence length of about 1000 nm or 1 μm. Applying this to a
layer, if the layer thickness is below or comparable to 1 μm,
E˜ 1 (t) and E˜ 2 (t) can belong to the same wave packet and cause
light interference. Otherwise, if the layer thickness is much
greater than 1 μm, light interference will not occur.

[GM04] GERMER T. A., MARX E.: Ray model of light scattering by pigmented coatings and by coated rough surfaces. Appl. Opt. 43, 6 (2004), 1266–1274.
[Glas94] GLASSNER A. S.: A model of fluorescence and
phosphorescence. In Proc. of the 5th Eurographics Workshop on Rendering (1994), 1994, Haas S., Muller S., Sakas
G., Shirley P., (Eds.), Springer-Verlag, 57–68.
[Gla95] GLASSNER A. S.: Principles of Digital Image Synthesis (1995). Morgan Kaufmann, San Francisco, CA.

References
[AH02] AGU E., HILL F. S., Jr.: Diffraction Shading Models for Iridescent Surfaces. In Proc. IASTED VIIP 2002
(2002), Malaga, Spain.
[BW99] BORN M., WOLF E.: Principles of Optics: Electromagnetic Theory of Propagation, Interference and
Diffraction of Light (1999). 6th ed. Cambridge University
Press, Cambridge, UK.
[Bun94] BUNSHAH R. F., Ed.: Handbook of Deposition
Technologies for Films and Coatings (1994), Noyes Publications, Park Ridge, NJ.
[Col97] COLLINS S.: Wavefront tracking for global illumination solution (1997). Thesis, Trinity College, Dublin.
[CT82] COOK R. L., TORRANCE K. E.: A reflection model
for computer graphics. ACM TOG 1, 1 (1982), 7–
24.

[GS03] GOLDSCHMIDT A., STREITBERGER H.-J.: Basf
Handbook on Basics of Coating Technology (2003). Vincentz Network, Hannover, Germany.
[GMN∗ 94] GONDEK J. S., MEYER G. W., NEWMAN J. G.:
Wavelength Dependent Reflection Functions. In Proc. of
ACM SIGGRAPH 1994 (1994), 1994, (Ed.), ACM Press,
213–219.
[GS04] GUY S., SOLER C.: Graphics gems revisted: Fast
and physically-based rendering of gemstones. In Proc. of
ACM SIGGRAPH 2000, ACM TOG (2004), Los Angeles,
CA, 231–238.
[Hec98] HECHT E.: Optics (1998). 3rd ed. Addison-Wesley,
Reading, MA.
[HKY∗ 01]

[Der04] DERAKHSHANI D.: Introducing Maya 6: 3d for Beginners (2004). CYBEX, Alameda, CA.

HIRAYAMA H., KANEDA K., YAMAJI Y., YAH., MONDEN T.: Visualization of optical phenomena caused by multilayer films based on wave optics.
The Visual Computer 17 (2001), 106–120.

[DCW∗ 02] DEVLIN K., CHALMERS A., WILKIE A.,
PURGATHOFER W.: Tone reproduction and physically
based spectral rendering. In Eurographics 2002, State of
the Art Reports (2002), Saarb¨ucken, Germany, Sep. 2,
2002, 101–123.

[IA00] ICART I., ARQUES D.: A physically-based brdf
model for multilayer systems with uncorrelated rough
boundaries. In Eurograhics Rendering Techniques
(2000).PEROCHE B., RUSHMEIER H., (Ed.), Verlag, 353–
364.

[Dia91] DIAS M. L. Ray tracing interference color. IEEE
Computer Graphics & Appl. 11, 2 (1991), 54–60.

[JF99] JOHNSON G. M., FAIRCHILD M. D.: Full-spectral
color calculations in realistic image synthesis. IEEE Computer Graphics and Applications 19, 4 (1999), 47–53.

MASHITA

[Dob95] DOBROWOLSKI J. A.: Optical Properties of Films
and Coatings (1995). Bass M., van Stryland E. W.,
Williams D. R., Wolfe W. L., (Eds.). McGraw-Hall.
[EKM∗ 01] ERSHOV S., KOLCHIN K., MYSZKOWSKI K.:
Rendering pearlescent appearance based on paintcomposition modelling. Computer Graphics Forum 20, 3
(2001), 227–238.
[Eva61] EVANS R. M.: An Introduction to Color (1961).
John Wiley & Sons, New York, NY.
[Fox76] FOX D. L.: Animal Biochromes and Structural
Colours (1976). University of California Press, Berkeley,
CA.

[JW75] JUDD D. B., WYSZECKI G.: Color in Business, Science and Industry (1975). John Wiley & Sons, New York,
NY.
[Lev80] LEVI L.: Applied Optics: A Guide to Optical System Design (1980). John Wiley & Sons, New York, NY.
[Mac69] MACLEOD H. A.: Thin-Film Optical Filters
(1969). Elsevier, New York, NY.
[Mey00] MEYER G. W.: Computer aided color appearance
design. In First International Conference on Color in
Graphics and Image Processing (CGIP) (2000), SaintEtienne, France, (Ed.), Cepadues-Editions, 195–200.

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.

Y. Sun & Q. Wang / Interface Shaders of Thin Films

1631

[Mus89] MUSGRAVE F. K.: Prisms and rainbows: A dispersion model for computer graphics. In Proc. of Graphics
Interface 1989 (1989), 1989, 227–234.

IASTED International Conference on Computer Graphics
and Imaging (CGIM) (1999), Palm Spring, CA, Oct. 1999,
283–288.

[Rag05] RAGHAVACHARY S.: Rendering for Beginners: Image Synthesis Using Renderman (2005). Focal Press, Amsterdam.

[SFDC∗ 00] SUN Y., FRACCHIA F. D., DREW M. S.,
CALVERT T. W.: Rendering iridescent colors of optical
disks. In Proceedings of the 11th EUROGRAPHICS Workshop on Rendering (EGRW) (2000), Brno, Czech Republic, June 2000, 341–352.

[SGM97] SCHRAMM M., GODEK J., MEYER G.: Light scattering simulations using complex subsurfaces models. In
Graphics Interface 1997 (1997), Toronto, Canada, 1997,
(Ed.), Canadian Information Processing Society, 56–67.
[SWN∗ 04] SHREINER D., WOO M., NEIDER J., DAVIS T.:
Opengl Programming Guide: The Official Guide to Learning Opengl (2004), Version 1.4. 4 ed. Addison-Wesley,
Boston, MA.
[Sim71] SIMON H.: The Splendor of Iridescence Structural
Colors in the Animal World (1971). Dodd, Mead & Company, New York, NY.
[SM90] SMITS B. E., MEYER G. W.: Newton’s colors: Simulating interference phenomena in realistic image synthesis. In Proc. of Eurographics Workshop on Photosimulation, Realism, and Physics in Computer Graphics (1990),
Berlin, June 1990, (Ed.), Springer-Verlag, 185–194.
[Sta99] STAM J.: Diffraction Shaders. In Proc. of ACM SIGGRAPH 1999 (1999), 1999, (Ed.), ACM Press, 101–110.
[Sun06] SUN Y.: Rendering biological iridescences with
Rgb-based renderers. ACM Transactions on Graphics 25,
1 (2006), 100–129.
[Sun07] SUN Y.: Statistical ray method for deriving reflection models of rough surfaces. Journal of the Optical Society of America A 24, 3 (2007), 724–744.

[SFDC∗ 01] SUN Y., FRACCHIA F. D., DREW M. S.,
CALVERT T. W.: A spectrum-based framework for realistic image synthesis. The Visual Computer 17, 7 (2001),
429–444.
[Tho86] THOMAS S. W.: Dispersive refraction in ray tracing. The Visual Computer 2, 1 (1986), 3–8.
[Tra06] TRACTON A. A., (ED.): Coatings Technology Handbook (2006), Taylor & Francis, New York, NY.
[Ups90] UPSTILL S.: The Renderman Companion: A Programmer’s Guide to Realistic Computer Graphics (1990).
Addison-Wesley, Reading, MA.
[WM01] WESTLUND H. B., MEYER G. W.: Applying appearance standards to light reflection models. In Proc. of
ACM SIGGRAPH 2001 (2001), 501–510.
[WTP00] WILKIE A., TOBLER R. F., PURGATHOFER W.:
Raytracing of dispersion effects in transparent materials.
In WSCG 2000 Conf. Proc (2000), Los Angeles, CA, 231–
238.
[WTP01] WILKIE A., TOBLER R. F., PURGATHOFER W.:
Combined rendering of polarization and fluorescence effects. In Proceedings of the 12th Eurograhics Workshop
on Rendering (2001), London, UK, June 25–27, GORTLER
S. J., MYSZKOWSKI K. (Ed.), 197–204.

[SFD99A] SUN Y., FRACCHIA F. D., CALVERT T. W., DREW
M. S.: Deriving spectra from colors and rendering light
interference. IEEE Computer Graphics and Applications
19 (1999), 61–67.

[WS82] WYSZECKI G., STILES W.: Color Science: Concepts
and Methods, Quantitative Data and Formulas (1982). 2nd
ed. Wiley, New York, NY.

[SFD99B] SUN Y., FRACCHIA F. D., DREW M. S.: Rendering the phenomena of volume absorption in homogeneous
transparent materials. In Proceedings of the 2nd Annual

[YKI∗ 88] YUAN Y., KUNII T. L., INAMOTO N., SUN L.: Gemstone fire: Adaptive dispersive ray tracing of polyhedrons.
Visual Computing 4, 5 (1988), 259–270.

c 2007 The Authors
Journal compilation c 2007 The Eurographics Association and Blackwell Publishing Ltd.


DOI: 10.1111/j.1467-8659.2011.02060.x
Pacific Graphics 2011
Bing-Yu Chen, Jan Kautz, Tong-Yee Lee, and Ming C. Lin
(Guest Editors)

Volume 30 (2011), Number 7

Heat Walk: Robust Salient Segmentation of Non-rigid Shapes
William Benjamin, Andrew Wood Polk, S.V.N. Vishwanathan and Karthik Ramani
Purdue University , USA

Abstract
Segmenting three dimensional objects using properties of heat diffusion on meshes aim to produce salient results.
The few existing algorithms based on heat diffusion do not use the full knowledge that can be gained from heat
diffusion and are sensitive to varying kinds of perturbations. Our simple algorithm, Heat Walk, converts the
implicit information in the heat kernel to explicit knowledge about the pathways for maximum heat flow capacity.
We develop a two stage strategy for segmentation. In the first stage we quickly identify regions which are dominated
by heat accumulators by employing a greedy algorithm. The second stage partitions out dissipative regions from
the previously discovered accumulative regions by using a KL-divergence based criterion. The resulting algorithm
is both independent of human intervention and fast because of the globally aware directed walk along the maximal
heat flow capacity. Extensive experimental evidence shows the method is robust to a variety of noise factors
including topological short circuits, surface holes, pose variations, variations in tessellation, missing features,
scaling, as well as normal and shot noise. Comparison with the Princeton Segmentation Benchmark (PSB) shows
that our method is comparable with state of the art segmentation methods and has additional advantages of being
robust and self contained. Based upon theoretical insight the convergence and stability of the Heat Walk is shown.
Categories and Subject Descriptors (according to ACM CCS): I.3.5 [Computer Graphics]: Computational Geometry
and Object Modeling—Geometric algorithms, languages, and systems

1. Introduction
The amount of three-dimensional shape data is exploding
because of the widespread availability of data acquisition
techniques such as laser scanners, medical scanning equipment and tessellation software. Reducing the complexity of
operations in geometry processing requires the division of
a shape into parts which, in turn, can be processed separately and analyzed efficiently. Three-dimensional shape
segmentation is therefore an important operation which has
direct applications in diverse fields like shape search and
matching [BBGO11], skeletonization [KT03] , texture mapping [LPRM02], and mesh simplification [CSAD04]. While
segmentation itself is a well studied problem in many domains including machine learning and data mining, there are
very few methods that can exploit the intrinsic structure of
the three-dimensional data to discover meaningful segments.
The goal of our research is to discover the inherent structure
of the shape without prior knowledge of the number of segments or seed points.
Overview of our method: Given a three-dimensional shape
approximated by a mesh M, we can represent it as a graph
c 2011 The Author(s)
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd. Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ,
UK and 350 Main Street, Malden, MA 02148, USA.

G(V, E) with vertex set V and edge set E. Our objective is
to decompose this graph into salient segments. One can best
understand our model by drawing an analogy to the watershed model: when the water flows from the hills in the direction of least resistance. However, each individual drop only
needs local information in order to decide the direction of
its flow. The collective effect of these local decisions is that
a large volume of water accumulates in the basins of attraction. In the watershed model the flow of water is analogous
to heat flow. The steps in our segmentation pipeline are as
follows (also See Figure 1):
1. Heat flow mapping: This step generates a heat distribution function on the mesh M based on the curvature and
connectivity of the points. In terms of the analogy, this
step determines the topography of the paths of the water
flow from the hills to the basins.
2. Heat walk based accumulator region identification:
In this step we trace the paths from each point to the
closest points of accumulation of heat. Accumulation regions are classified as the regions in which all points trace
their paths to the same termination point. This is analo-

2098

Benjamin et al. / Heat Walk:Robust Salient Segmentation of Non-rigid Shapes

Figure 1: Pipeline of segmentation a) The input model b) Heat Flow mapping.The heat kernel is computed for the model c) The
Heat Walk based accumulator region identification d) Relative Entropy based dissipator region identification

gous to the process of tracing the flow of the water along
the streams to basins of accumulation. The regions of
land whose drops ended in a particular basin are assigned
to the basin. The basins emerge on-the-fly based on the
topology of the mesh and without any prior knowledge
or user input.
3. Relative entropy based dissipator regions identification: Once the heat accumulator regions are identified,
we perform binary classification to determine if a point is
a part of an accumulator or dissipator region. This is done
depending on how close each point is to the uniform distribution of heat. This segments out the flatter regions of
the three dimensional object. In terms of the analogy we
discover the dissipator regions by how quicky they shed
water.
Contributions The main contributions of our paper are:
1. We show that the heat kernel has implicit information
about the shape in Section 3 and provide a method of converting the implicit information about the intrinsic structure of the shape in the heat kernel into explicit knowledge in terms of the segments of the shape.
2. In Section 4 we introduce a greedy algorithm called the
Heat Walk which is globally aware and converges to the
set of exemplars (representatives) for the model.
3. In Section 5 we characterize dissipative regions and describe a method of classifying regions into dissipative regions using a relative entropy method.
4. Our experiments in Section 6 provide a comprehensive
evaluation of the method against a variety of perturbations.

2. Related Work
Mesh segmentation is a non-trivial problem and many methods have been proposed. However, there is a lack of consistency in understanding segmentation as a cognitive process.
A recent benchmark paper on segmentation ameliorates this
issue to an extent [CGF09]. A salient segment can be defined as the perceptually pertinent subset of the shape which
draws or focuses the attention of the viewer to itself relative

to its adjacent regions because of its relative size and degree
of protrusion.
We define Robust Salient Segmentation (RSS) as a segmentation method that decomposes a model into salient segments while being robust to aberrations such as noise, shot
noise, missing data in the form of holes and missing features, topological short circuits, pose variations, variations
in tessellation and scaling. RSS is the overreaching goal of
most segmentation methods. The reader is guided to two recent surveys by Attene et al. [AKM∗ 06,CGF09] and Shamir
[Sha08] which provide an extensive overview of the available mesh segmentation methods.
Our method is related to watershed based methods
[MW99, PKA03] which segment regions into catchment
basins. These methods have very low tolerance to noise because local properties like principal curvatures are easily affected by noise. Spectral Methods like [LZ07] produce very
good segmentations, they however use local properties like
geodesic distances or curvatures which are affected by noise.
Complete adherence to the goal of RSS with no human intervention is a challenging problem because of requirement
for an input parameter like k [STK02] and sensitivity to local
perturbations [LLS∗ 05, LZHM06,KT03,AFS06,LHMR08].
Recently diffusion based methods have shown promise in
achieving the goal of RSS because they exploit the intrinsic
geometry of the shape [SOG09, Gri06]. Our paper is closely
related in spirit to diffusion based methods of segmentation
hence we focus our attention only to these paramount methods.
Diffusion based methods alleviate the problem of pose
variance [dGGV08, SOCG10, CMK∗ , GBAL09]. In [Rus07]
the authors define GPS coordinates on the mesh which are
clustered using a k-means algorithm to segment a shape. The
segmentation achieved is salient and robust to short circuiting, however it needs human input in the form of k. Reuter et
al. [RBG∗ 09] on the other hand use the nodal sets of eigenvectors to segment a shape. The user makes a choice of k
eigenvectors to compose the desired segmentation. Reuter et
al. [Reu10] use the persistence diagrams to construct heirarchical segmentation using eigenvectors of the Laplace Belc 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Benjamin et al. / Heat Walk:Robust Salient Segmentation of Non-rigid Shapes

trami operator while Goes et al. [dGGV08] partition shapes
by iteratively refining segments from initial seeds. However
they do not address the issue of robustness to all kinds of
perturbations.
Two current heat kernel based methods which closely
approach the goal of RSS without human intervention are
Skraba et al. [SOCG10] and Dey et al. [DLL∗ 10] They use
persistence based clustering to identify feature points at local maxima of a vertex valued function, the Heat Kernel Signature [SOG09]. Vertex valued functions are relatively less
stable than edge valued functions on a mesh to all sorts of
local aberrations, specifically shot noise.
Our method also uses the spectrum of the LaplaceBeltrami operator and in addition we also extract more information to subsequently discover the intrinsic geometry
without any assumption on k. In contrast to [SOCG10] and
[DLL∗ 10], we use an edge weighted operator which makes
our method stable under high intensity of perturbations. Existing algorithms based on heat diffusion have not completely addressed the issues of robustness to all kinds of
noise. We present a method that obtains RSS by exploiting
the full information available from the heat kernel.

2099

heat kernel can be approximated by a small geodesic neighbourhood of point x. We define the diffusion radius of a point
as the geodesic distance from the point, within which 90%
of the heat is accumulated. Intuitively, regions that accumulate heat will have a smaller diffusion radius as compared to
regions that dissipate heat.
Relation to Curvature: The heat kernel is related to the
curvature of M. The diagonal values of the heat kernel are
given by ht (x, x) = (4πt)−η/2 ∑i ai t i where a0 = 1 and a1 =
1
6 s(x) where s(x) is the scalar curvature at point x [MP49].
Points of high curvature have a tendency to attract heat.
Thus over a period of time heat tends to accumulate in these
regions. In other words, these points are very slow at dissipating heat compared to the rate at which they receive it. We
call such points accumulators. On the other hand, the flatter regions tend to dissipate heat faster than they receive it.
The heat distribution around such points will nearly be uniform. We call such points dissipators. (See Figure 2) In real

3. Heat Flow and the Heat Kernel
Let M be a Riemannian manifold, µ be a measure defined on
M, and let L2 (M) (abbreviated as L2 ) be the space of square
integrable functions on M. Heat diffusion on M is governed
∂u(x,t)
by the heat equation: ∆u(x,t) = − ∂t where u(x,t) is the
heat distribution at a point x ∈ M at time t, and ∆ denotes
the Laplace Beltrami Operator (LBO). Let f : M → R be
a square integrable function which gives the initial distribution of heat on M at time 0. The heat distribution at a subsequent time t > 0 is denoted by Ht ( f ). The so-called heat
kernel ht : M × M → R is the fundamental solution of the
heat equation, that is, it satisfies for all f ∈ L2 , all x ∈ M,
Ht f (x) = M ht (x, y) f (y) dµ(y).
The heat kernel controls the geometry-dependent propagation of heat across the shape. One can understand ht (x, y)
as the quantity of heat that arrives at location y after time
interval t if unit quantity of heat is inserted at location x.
It is well known that the heat kernel can also be expressed
in terms of the eigenvalues λi and eigenvectors φi of the
LBO [Gri06]:
ht (x, y) = ∑i e−λi t φi (x)φi (y).

(1)

Relation to Geodesic Distance On any weighted Manifold (M, µ) of dimension η, there exists a smooth positive function u(x, y) on M × M such that ∀x ∈ M we

Figure 2: Comparison of heat distribution at the same time t
for a dissipator (left) and accumulator (right), both marked
with a red dot. The distribution of heat in the left figure is
comparatively more uniform than the heat distribution in the
right.
life, instead of a smooth continuous manifold M, we have
to deal with a finite representation of an object as a mesh M.
One can think of the mesh as a graph G(V, E). In order to
calculate the heat kernel on M we need to compute the LBO
on the mesh. The LBO on discrete meshes has been studied extensively and various discretizations have been proposed. The LBO on a surface is related to the mean curvature normal [Xu04], therefore many discretizations try to
approximate this quantity. These schemes converge to the
LBO in the limit while retaining some but not all of the key
structural properties inherent to the continuous setting. We
use the scheme used by Desbrun et al. [DMSB99] which is
one of the faithful representations of the continuous LBO
[WMKG08].

u(x, y) = ht (x, y). Here

In order to define accumulators and dissipators on the
finite mesh we work with px (y) = ht (x, y)/ ∑y ht (x, y), the
probability density function of the heat distribution at point
x and write:

d 2 (x, y) is the geodesic distance between the points x and
y [Gri06]. Intuitively this means that for small values of t the

Ideal Accumulator: The ideal accumulator is a point which
retains all heat to itself. The probability density function of

have limt→0

1
(4πt)η/2

exp −

d 2 (x,y)
4t

c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

2100

Benjamin et al. / Heat Walk:Robust Salient Segmentation of Non-rigid Shapes

the heat distribution is given by
px (y) = δx (y)

(2)

where δx (y) is an indicator function which takes on the value
1 when x = y and 0 otherwise.
Ideal Dissipator: The ideal dissipator would be a point
which distributes heat uniformly over all N = |V | points on
the mesh. The probability density function of the heat distribution in this case is given by
px (y) = 1/N ∀y ∈ V

(3)

In the sequel we present a method for identifying heat accumulator points on the shape while simultaneously assigning
regions to those points.
4. Heat Walk for Identifying Accumulators

Heat Potential: The tendency of a point to attract heat is
expressed formally in terms of its heat potential sm (x). The
heat potential is initialized as the diagonal values of the heat
kernel s1 (x) = ht (x, x) and subsequent values are updated
from previous values via
y∈E

(4)

where m is the count of the steps and E is the set of exemplars, initialized as E = V .
Mutual voting process to choose an exemplar: The exemplar of a point x is the point y which maximizes the
function min(ht (x, y), sm (y)). The mutual voting process described earlier is formalized by
em+1 (x) = argmax min(ht (x, y), sm (y))

Figure 3 shows the incremental steps of the Heat Walk,
at the far left all points are initialized to individual groups,
moving right the primary accumulator regions have already
formed and by the second step 75% of the points have been
grouped into what will be their final grouping. The prominent features of the shape correspond to the accumulator regions. One can see that the smaller clusters gradually merge
into the more stable accumulator regions. The pseudocode
for the Heat Walk is given in the appendix as algorithm 1.
4.1. Theoretical Remarks

The goal of this step is to segment the model into accumulator regions which are sufficiently far apart from each other.
We accomplish this by allowing each point to select a representative point called an exemplar. The points that choose
the same exemplar are aggregated into the same accumulator
region. The regions are merged in subsequent steps until the
process terminates. We call this process the Heat Walk. A
given point will be an exemplar for another point if two conditions are satisfied 1) The heat flow between the two points,
as given by the heat kernel, is large, and 2) The exemplar
itself has a strong tendency to attract heat. In other words it
is an accumulator. Thus the choice of exemplar is a mutual
voting process between the points and the prospective exemplars. The ideas mentioned here are formalized in following
paragraphs.

sm+1 (x) = max min(ht (x, y), sm (y))

itself in a subsequent step from the pool of existing exemplars E. The accumulator regions pointing to an exemplar
are merged into the accumulator region of the new exemplar. The process terminates when each exemplar chooses
itself as its own exemplar, that is, the set of exemplars does
not change between two iterations.

(5)

y∈E

where em+1 (x) is the exemplar for point x.
Pruning and Termination: The points which were not assigned as exemplars to any other point are excluded from
subsequent steps. E is updated as the unique values of em+1 .
Thus the exemplar at a given step chooses an exemplar for

Now we shall show how the Heat Walk, mentioned previously, is closely connected to a random walk. Towards this
end, we define a semiring R(H, ⊕, ⊗) over the set of values, H, generated by the heat kernel distribution ht together
with the binary operations of max (⊕) and min (⊗). The internal laws are defined as ∀{a, b} ∈ H, a ⊕ b = max(a, b),
a ⊗ b = min(a, b).The set of all n-tuples (n-vectors ) over R
is denoted by Rn and the set of all square matrices of order
n is given by Rn×n . Then Equation 4 can be written as a
matrix vector product of ht ∈ Rn×n and sm ∈ Rn in the new
semiring
sm+1 = ht ⊗ sm

(6)

where sm+1 (x) = ⊕y∈E ht (x, y) ⊗ sm (y). This formulation
is analogous to a random walk in the usual semiring
R(H, +, ×) which is defined via sm+1 = ht sm . Instead of being a random walk, this process is a directed walk, which we
call the Heat Walk.
Flow capacity is an idea from max-min algebra to find the
bottlenecks in a path. We define the heat flow capacity c(x, y)
between a point x and its possible exemplar y as c(x, y) =
ht (x, y) ⊗ sm (y).
The exemplar of a point is chosen along the greatest heat
flow capacity. At every step of the Heat Walk, each point
chooses an exemplar according to Equation 5 which can be
rewritten as
em+1 (x) = argmax {c(x, y)}

(7)

y∈E

We can see that the exemplar for a point x is chosen as the
point y that maximizes c(x, y). The heat potential at a point
x is then updated as the maximum capacity.
Convergence: The Heat Walk converges when em (x) =
em−1 (x) for all x, that is, the exemplars in the previous state
are the same as the exemplars in the present state.
Path: The path of the Heat Walk from a point x is the
c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

2101

Benjamin et al. / Heat Walk:Robust Salient Segmentation of Non-rigid Shapes

Figure 3: This figure demonstrates that the Heat Walk converges very quickly to the dominant accumulator regions.

ordered sequence πx = {x, e1 (x), e2 (e1 (x))...} of a point and
its exemplars in the subsequent states.
Optimality of the path: The Heat Walk proceeds along the
path of maximal flow capacity. At every step of the Heat
Walk each point chooses an exemplar. Each step of the walk
is along the maximal flow capacity, thus the entire path from
a point x is along the path of maximal flow capacity.
The Heat Walk generates a tree: Each path from a point
x can be traced to its final exemplar. Going backwards from
the final exemplar to the points we can trace a tree with the
final exemplar at the root and the points as the leaves. From
our observation these trees represent separate regions of the
shape.
Finite Set Reduction: The set of heat flow values on the
mesh is finite. The (⊕, ⊗) operations cannot introduce a new
number to this set. Additionally the pruning operation reduces the number of elements in the set.
Convergence of Heat Walk: The Heat Walk applied to a
finite set must converge. We obtain convergence when the
heat walk returns the same exemplars.
Stability: Stability means that the effects of noise on the
outcome are mitigated. Assume a normal distribution of
noise on the surface of the mesh which perturbs ht (x, y) and
sm . The min operation ⊗ tends to filters out high values of
noise, Then the max operation ⊕ tends to filter low values of
noise, leaving only a narrow band of noise. Thus the effective error is mitigated. Additionally, pruning removes nonexemplars adding to the stability.

5. Identifying Dissipator Regions
After having classified the points into accumulator regions in
section 4, the next step is to discover the dissipator regions.
Dissipative regions correspond to relatively featureless regions. We revisit the idea of the ideal heat dissipators and
accumulators and develop a strategy for classification using the celebrated Kullback-Liebler divergence (KL Divergence) for comparing distributions [CT91]. Recall that the
c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

KL divergence between distributions p and q is given by
DKL (p||q) = ∑ p(y) log
y

p(y)
q(y)

(8)

This is the measure of additional amount of information to
specify p in terms of q. KL-divergence is a non negative
quantity DKL (p||q) ≥ 0, with equality if and only if the distributions p and q are identical. Furthermore, it has the property that it is resistant to local noise because the probability
mass of the heat distribution is relatively invariant to local
perturbation.
An ideal dissipator has a uniform heat distribution. In order for a point to belong to the dissipator region, it must
be less divergent from the uniform heat distribution. On the
other hand, we use the mean of the heat distribution of the
segment as a criteria for determining the divergence of a
point from the accumulator region. Separation of the dissipative region begins by computing the divergence of each
h (x,y)
points’ probability density function px (y) = ∑ th (x,y) with
y t
respect to first the uniform density Eq(3) and later to its re(x,y)
h
spective mean cluster density pC (y) = ∑ ∑ x∈C
where
x∈C ∑y ht (x,y)
C is the cluster. The divergences are compared and when the

Figure 4: a) The HKS function b) The KL divergence of the
points from the uniform distribution. c) KL divergence of the
points from the cluster mean
divergence from the uniform is less than that from the mean
of the cluster the point will be reclassified as a member of
the dissipative region. The pseudocode for this is given in
the appendix as algorithm 2.
Figure 4 shows 3 different functions on the mesh. Fig-

2102

Benjamin et al. / Heat Walk:Robust Salient Segmentation of Non-rigid Shapes

ure 4 a and b provide a contrast between the Heat Kernel
Signature (HKS) and the KL divergence from the uniform
distribution. The KL divergence on the head of the horse is
more informative compared to the HKS and Fig 4 c plots the
KL divergence from the cluster mean of the segments.
6. Experiments
We demonstrate the stability of our method and insensitivity
to the type of mesh employed, pose, noise, scale and topological short circuits. The three-dimensional models used in
our experiments are taken from the PSB [CGF09], as well
as the Tools for non-rigid Shape Comparison and Analysis
(TOSCA) database [BBK08].
6.1. Versatility

Method
Humans
HeatWalk
RandCuts
ShapeDiam
CoreExtra
RandWalks
FitPrim
Kmeans

CD
0.140
0.267
0.150
0.221
0.272
0.297
0.253
0.288

RI
0.081
0.148
0.093
0.143
0.159
0.164
0.145
0.161

HD
0.108
0.234
0.127
0.177
0.177
0.215
0.249
0.268

CE
1
0.082
0.221
0.149
0.152
0.144
0.222
0.265
0.286

2
0.055
0.136
0.083
0.095
0.094
0.123
0.174
0.190

Table 1: Comparison of results of Heat Walk based segmentation of non-rigid models against segmenation based
on Humans [CGF09], Randomized cuts [GF08], Shape
Diameter [SSCO08], Core extraction [KLT05], Random
Walks [LHMR08], Fitting primitives [AFS06] and k-Means
[STK02].The metrics used are Cut Discrepancy(CD), Hamming Distance (HD), Rand Index (RI) and Consistency Error
(CE)

Figure 6: Segmentation for various poses of the cat and goFigure
5:
Segmentation
results
across
wide
rilla model
varieties
of
models.
Further
results
at
https://engineering.purdue.edu/precise/heatwalk
Our algorithm is versatile and is able to produce a visually
pleasing segmentation across a wide range of models such as
humans, animals, toys, furniture, and tools as demonstrated
in Figure 5. The results show that the method is more applicable to nonrigid models like humans, animals etc because
they have strong accumulator regions. Table 1 shows the results of the Heat Walk segmentation compared to available
methods from the benchmark [CGF09] across eleven categories of non-rigid three dimensional models. Please refer
to [CGF09] for details of the metrics. The results show that
the Heat Walk is comparable in performance to the majority
of the methods presented in the benchmark. We do not do
any cut refinement like [GF08, SSCO08, LHMR08, KLT05],
which would improve the quality of the results. While the
PSB serves the purpose for VSS validation, our primary aim
is to study RSS using Heat Walk. The next few sections confirm the robustness of the method using models with added
noise that are not available in PSB.
6.2. Consistency
Next we show that our method is insensitive to pose and
intra class variations in the models (See Figure 6). As can
be seen, the gross characteristics of the segmentation for a

given model are stable across the different poses. The cuts
appear consistently along the joints of the heads and legs of
the gorilla and along the tail, head, and legs of the cat models. Pose invariance of the Heat Walk is caused by the isometry invariance of the heat kernel. We are also interested in

Figure 7: Segmentation for human models: a) articulations
of the same model b) within the same class c) bending near
the joint of the legs and merging of the hands into the body.
consistency across the same class of models (See Figure 7
c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Benjamin et al. / Heat Walk:Robust Salient Segmentation of Non-rigid Shapes

2103

a). The models in Figure 7 b shows consistency for different
models of the human class of models. Figure 7 c shows the
results for the sitting pose of human models. Our method is
unable to identify the arms and head separately in the central
model because the arms are completely fused with the body.
The heat distribution in this case is drastically changed when
compared to a clean model.

Figure 9: Segmentation results on noise corrupted models.
The value at the top of each figure corresponds to the fraction of noise added.

Figure 8: Segmentation is resistant to missing parts (red circles).

The cuts corresponding to the fingers of the hand are largely
insensitive to noise. Up to 10 % noise our method performs
well. At very high noise levels salience of the segments according to cognition studies is lost, so consistency at large
noise values > 10% is not pertinent.

short circuits
# Shorts
CP(%)

10
2.32

# Holes
CP(%)

58
1.23

% Noise
CP(%)

6
1.51

% Perturbed
CP(%)

5.88
3.61

6.4. Shot Noise
Holes
106
154
1.89
2.39
Noise
17
34
2.38
3.9
Shot Noise
17.65
29.41
2.97
5.07

202
3.08

250
3.39

46
5.02

63
6.1

47.06
6.75

52.94
7.28

Table 2: Change Percentage(CP) is a consistency measure
which tells twice the percentage of points in the original segmentation that must change their segment membership to become the new segmentation. The consistency of segmentation
under various kinds of perturbations is high.
Figure 8 a, b and c brings out the consistency between
complete and incomplete models. The resulting segmentation follows the overall theme of segmentation of the complete models. Table 2 shows that our method is consistent
under noise using a consistency metric.
6.3. Resistance to Random Noise
We apply increasing intensity of random normal noise to the
models (See Figure 9). Noise was added to all the points in
the direction of the normal at the point. The noise values
shown on the top of each hand model in Fig 9 gradually increase from 0 to 10 % of the diagonal of the bounding box.
c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Figure 10: Segmenation is robust to shot noise. a,b,c,d,e
show models addition of 11%, 23%, 40%, 51% and 63%
noise to 6% of the points at the bottom with the results
mapped to the original model at the top.
Shot noise is defined as corruption of three-dimensional
data at finitely many points on the mesh which appear as
spikes. We added shot noise to 6% of the points selected
randomly on the model. The shot noise creates local accumulators which can change the heat flow. The images in Figure 10 show the results of increasing amounts of shot noise.
The image on the top shows the results of the segmentation
mapped to the original model. Shot noise in increasing intensity from 10% up to 80% of the model’s bounding box di-

2104

Benjamin et al. / Heat Walk:Robust Salient Segmentation of Non-rigid Shapes

agonal was applied. The results are consistent up to 23 % of
noise. The segmentation of the strong accumulator regions is
consistent for a higher amount of noise. The Heat Walk has
higher resistance to shot noise because the max min operator
decimates any isolated perturbance.
6.5. Resistance to Topological Noise and Short Circuits

Figure 12: Models(large) with 15% of the triangles removed
are still consistent with the models without any missing triangles (small).

t between the two points. Removing some of the paths does
not substantially change the heat flow.
Figure 11: Topological short circuits on the ant, hand and
centaur.
We generated models with increasing levels of short circuits ranging from 1 to 10. The short circuits generated were
located by sampling pairs of points which are close in terms
of Euclidean distance but far apart geodesically. The segmentation results are robust to large numbers of short circuits. Figure 11 a shows the hand and the ant models which
have been short circuited. The total number of short circuits
is 1 on the left side and 10 on the right side. We have increased the transparency to show some short circuits which
are internal. Figure 11 b shows two poses of the centaur
model. The model on the right is well segmented into salient
components. On the left the method fails when a weak accumulator region of the centaur model is short circuited with a
strong dissipative region. Therefore the heat flow is diverted
to the dissipative regions weakening the accumulative region
hence the head merges with the arm. The robustness is due
to aggregation of paths by the heat kernel and also due to the
directed walk.
The second part of this experiment was to create holes
in the models changing the heat flow on the surface. This
was done due to our interest in testing the limit to which the
segmentation is consistent with that of the original models.
We randomly sampled points and removed the corresponding triangles creating holes on the surface. The number of
triangles removed was 5%, 10%, 15%, and 20% of the original triangles in the model. The segmentation was consistent
with up to 15% of the triangles removed, after which the
regions are hardly connected and the disconnected regions
greatly affect the heat flow.(See Figure 12.) The Heat Walk is
robust to missing triangles since the heat kernel between two
points is the exponential sum of all possible paths of length

6.6. Sensitivity to tessellation and scale

Figure 13: Sensitivity to tessellation. The Armadillo models with different qualities of meshes high, medium and low.
The segmentation is consistent across different tessellations
of the model.
We decimated the armadillo model down to several levels of tessellation and observed the behavior of the method.
While the placement of the cuts may vary slightly, the
method by and large recovers the same segmentation as
can be seen in Figure 13. We scaled the ant model keep-

Figure 14: Results of the ant model scaled by ×0.5,×1.5
and ×3.
ing all other aspects of the model constant (See Figure 14
). The segmentation was completely invariant to scale for
c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Benjamin et al. / Heat Walk:Robust Salient Segmentation of Non-rigid Shapes

×0.5,×1.5, ×3 and ×10(not shown). Invariance to tessellation and scale is a result of the choice of the discretization of
the LBO.
6.7. Time

Figure 15: Segmentation over a range of times, from left to
right t = 0.65, t = 1.1, t = 1.6, and t = 3.9.
In this section we explore the the stopping time for heat
diffusion, in order to justify our assumption of time t = 1
throughout all other experiments.Figure 15 shows the choice
of t = 1 is within a wide range of times that return similar
segmentation. In a further experiment a sample of 100 models was taken at random and segmented at different times
logarithmically spaced between t=0.13 and 12. We found
that for 71 % of the models the number of segments did not
change for time between 0.6 to 2.7. Over a smaller interval
between 0.85 and 1.9, 82.3 % did not change. While there
is no single value of time that can be used to described all
shapes, from this experiment it is clear we have chosen a
time that correlates to the global scale and is suitable for
most models. Throughout all experiments the heat kernel
was calculated for t = 1,
7. Limitations

2105

8. Conclusions and Future Work
The Heat Walk algorithm partitions the shape in an unsupervised manner because it is data-driven while discovering the
inherent number of segments. The method does not require
choice of initial seed points and converges in a few iterations.
The strategy of segmenting into accumulative and dissipative
regions is simple and works well for non-rigid objects. Evaluation against state-of-the art methods available in the PSB
show that the method is comparable without cut refinement.
We have tested the limits of the algorithm for normal noise,
shot noise, tessellation, topological noise, topological short
circuits, scale, changes in pose and missing features. Our results show that the method is robust. This is because of the
error mitigation by the max min operator and pruning at every step of the Heat Walk and also the insensitivity of KL
Divergence to noise. Although the choice of time is suitable
for most models, in the future work we would like to derive
model specific optimal times. Additionally, exploiting local
times for cut refinement will further improve the quality of
segmentation.
References
[AFS06] ATTENE M., FALCIDIENO B., S PAGNUOLO M.: Hierarchical mesh segmentation based on fitting primitives. The
Visual Computer 22 (2006), 181–193. 2, 6
[AKM∗ 06] ATTENE M., K ATZ S., M ORTARA M., PATANE G.,
S PAGNUOLO M., TAL A.: Mesh segmentation - a comparative
study. In SMI ’06: Proceedings of the IEEE International Conference on Shape Modeling and Applications 2006 (Washington,
DC, USA, 2006), IEEE Computer Society, p. 7. 2
[BBGO11] B RONSTEIN A. M., B RONSTEIN M. M., G UIBAS
L. J., OVSJANIKOV M.: Shape google: Geometric words and
expressions for invariant shape retrieval. ACM Trans. Graph. 30
(February 2011), 1:1–1:20. 1
[BBK08] B RONSTEIN A., B RONSTEIN M., K IMMEL R.: Numerical geometry of non-rigid shapes. Springer (2008). 6
[CGF09] C HEN X., G OLOVINSKIY A., , F UNKHOUSER T.: A
benchmark for 3D mesh segmentation. ACM Transactions on
Graphics (Proc. SIGGRAPH) 28, 3 (Aug. 2009). 2, 6

Figure 16: At left Heat Walk is able to identify 8 corners
as strong accumulator regions. This is different from the intended segmentation into 6 surfaces. The cylindrical surface
of a glass is oversegmented

[CMK∗ ] C UZZOLIN F., M ATEUS D., K NOSSOW D., B OYER E.,
H ORAUD R.: Coherent laplacian 3-d protrusion segmentation. 2
[CSAD04] C OHEN -S TEINER D., A LLIEZ P., D ESBRUN M.:
Variational shape approximation. ACM Trans. Graph. 23 (August 2004), 905–914. 1
[CT91] C OVER T. M., T HOMAS J. A.: Elements of information
theory. Wiley-Interscience, New York, NY, USA, 1991. 5

When surface characteristics are more appropriate than
salience for segmentation our method will be inappropriate
(See Figure 16). Rigid objects like CAD models may not
contain salient regions resulting in incorrect segmentation.
For objects like a glass or a cylinder which lack dominant
protrusions, the heat walk will oversegment. When the dissipative regions are disconnected with low heat affinities between each other, binary classification of the dissipative regions using KL divergence may fail.This may be corrected
by modifying the magnitude of the uniform heat distribution.
c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

[dGGV08] DE G OES F., G OLDENSTEIN S., V ELHO L.: A hierarchical segmentation of articulated bodies. In SGP ’08: Proceedings of the Symposium on Geometry Processing (Aire-laVille, Switzerland, Switzerland, 2008), Eurographics Association, pp. 1349–1356. 2, 3
[DLL∗ 10] D EY T., L I K., L UO C., R ANJAN P., S AFA I., WANG
Y.: Persistent heat signature for pose-oblivious matching of
incomplete models. Computer Graphics Forum 29, 5 (2010),
1545–1554. 3
[DMSB99] D ESBRUN M., M EYER M., S CHRÖDER P., BARR
A. H.: Implicit fairing of irregular meshes using diffusion

2106

Benjamin et al. / Heat Walk:Robust Salient Segmentation of Non-rigid Shapes

and curvature flow. In SIGGRAPH ’99: Proceedings of the
26th annual conference on Computer graphics and interactive
techniques (New York, NY, USA, 1999), ACM Press/AddisonWesley Publishing Co., pp. 317–324. 3
[GBAL09] G EBAL
˛
K., BAERENTZEN J. A., A ANAES H.,
L ARSEN R.: Shape analysis using the auto diffusion function. In
Proceedings of the Symposium on Geometry Processing (2009),
SGP ’09. 2
[GF08] G OLOVINSKIY A., F UNKHOUSER T.: Randomized cuts
for 3d mesh analysis. ACM Trans. Graph. 27, 5 (2008), 1–12. 6
[Gri06] G RIGOR ’ YAN A.: Heat kernels on weighted manifolds
and applications. Cont. Math 398 (2006), 93–191. 2, 3
[KLT05] K ATZ S., L EIFMAN G., TAL A.: Mesh segmentation
using feature point and core extraction. The Visual Computer 21,
8-10 (2005), 649–658. 6
[KT03] K ATZ S., TAL A.: Hierarchical mesh decomposition using fuzzy clustering and cuts. In ACM SIGGRAPH 2003 Papers
(New York, NY, USA, 2003), SIGGRAPH ’03, ACM, pp. 954–
961. 1, 2
[LHMR08] L AI Y.-K., H U S.-M., M ARTIN R. R., ROSIN P. L.:
Fast mesh segmentation using random walks. In SPM ’08: Proceedings of the 2008 ACM symposium on Solid and physical
modeling (New York, NY, USA, 2008), ACM, pp. 183–191. 2, 6
[LLS∗ 05] L EE Y., L EE S., S HAMIR A., C OHEN -O R D., S EI DEL H.-P.: Mesh scissoring with minima rule and part salience.
Comput. Aided Geom. Des. 22 (July 2005), 444–465. 2
[LPRM02] L ÉVY B., P ETITJEAN S., R AY N., M AILLOT J.:
Least squares conformal maps for automatic texture atlas generation. ACM Trans. Graph. 21 (July 2002), 362–371. 1
[LZ07] L IU R., Z HANG H.: Mesh segmentation via spectral embedding and contour analysis. Computer Graphics Forum 26, 3
(2007), 385–394. 2
[LZHM06] L AI Y.-K., Z HOU Q.-Y., H U S.-M., M ARTIN R. R.:
Feature sensitive mesh segmentation. In Proceedings of the 2006
ACM symposium on Solid and physical modeling (New York, NY,
USA, 2006), SPM ’06, ACM, pp. 17–25. 2
[MP49] M INAKSHISUNDARAM S., P LEIJEL A.: Some properties of the eigenfuncions of the laplace operator on riemannian
manifolds. Can. J. Math (1949). 3
[MW99] M ANGAN A. P., W HITAKER R. T.: Partitioning 3d surface meshes using watershed segmentation. IEEE Transactions
on Visualization and Computer Graphics 5 (October 1999), 308–
321. 2
[PKA03] PAGE D. L., KOSCHAN A. F., A BIDI M. A.:
Perception-based 3d triangle mesh segmentation using fast
marching watersheds. Computer Vision and Pattern Recognition,
IEEE Computer Society Conference on 2 (2003), 27. 2
[RBG∗ 09] R EUTER M., B IASOTTI S., G IORGI D., PATANÏ £¡
G., S PAGNUOLO M.: Discrete laplace-beltrami operators for
shape analysis and segmentation. Computers & Graphics 33,
3 (2009), 381 – 390. IEEE International Conference on Shape
Modelling and Applications 2009. 2
[Reu10] R EUTER M.: Hierarchical shape segmentation and registration via topological features of laplace-beltrami eigenfunctions. Int. J. Comput. Vision 89 (September 2010), 287–308. 2
[Rus07] RUSTAMOV R. M.: Laplace-beltrami eigenfunctions for
deformation invariant shape representation. In SGP ’07: Proceedings of the fifth Eurographics symposium on Geometry processing (Aire-la-Ville, Switzerland, Switzerland, 2007), Eurographics Association, pp. 225–233. 2

[Sha08] S HAMIR A.: A survey on mesh segmentation techniques.
Comput. Graph. Forum 27, 6 (2008), 1539–1556. 2
[SOCG10] S KRABA P., OVSJANIKOV M., C HAZAL F., G UIBAS
L.: Persistence-based segmentation of deformable shapes. In
CVPR Workshop on Non-Rigid Shape Analysis and Deformable
Image Alignment (June 2010), p. to appear. 2, 3
[SOG09] S UN J., OVSJANIKOV M., G UIBAS L.: A concise and
provably informative multi-scale signature based on heat diffusion. Computer Graphics Forum 28, 5 (2009), 1383–1392. 2,
3
[SSCO08] S HAPIRA L., S HAMIR A., C OHEN -O R D.: Consistent
mesh partitioning and skeletonisation using the shape diameter
function. The Visual Computer 24, 4 (2008), 249–259. 6
[STK02] S HLAFMAN S., TAL A., K ATZ S.: Metamorphosis of
polyhedral surfaces using decomposition. In Computer Graphics
Forum (2002), pp. 219–228. 2, 6
[WMKG08] WARDETZKY M., M ATHUR S., K ÄLBERER F.,
G RINSPUN E.: Discrete laplace operators: no free lunch. In ACM
SIGGRAPH ASIA 2008 courses (New York, NY, USA, 2008),
SIGGRAPH Asia ’08, ACM, pp. 19:1–19:5. 3
[Xu04] X U G.: Discrete laplace-beltrami operators and their convergence. Comput. Aided Geom. Des. 21, 8 (2004), 767–784. 3

Algorithm 1 Find Accumulator regions using Heat Walk
1: m ← 0 {step of the Heat Walk}
2: Ex ← {} {the set of exemplars}
3: e ← [1 : N] {point exemplar ids}
4: sm ← diag(ht ) {the array of point heat potentials }
5: while Ex = Unique(e) do
6:
{Unique returns unique elements of a set}
7:
Ex ← Unique(e) {pruning of non-exemplars}
8:
for all x such that x ∈ Ex do
9:
for all y such that y ∈ Ex do
10:
minheat[y] ← {ht [x, y], sm [y]}
11:
end for
12:
e[x] ← argmax
y∈Ex minheat {point exemplars updated}
max
m
13:
s [x] ← y∈Ex
minheat {heat potentials updated}
14:
end for
15:
m ← m+1
16: end while

Algorithm 2 Find Dissipator regions
1: for all x such that x ∈ V do
2:
px ← ht [x, :] {heat distrubution at x}
3:
q1 ← Clustermean {mean heat distrubution of cluster
e[x]}
4:
q2 ← Uni f orm{uniform heat distribtution}
5:
KLC = KLDivergence(p, q1 )
6:
KLU = KLDivergence(p, q2 )
7:
if KLC > KLU then
8:
e[x] ← k + 1 {reassign to dissipator region}
9:
{k: number of clusters}
10:
end if
11: end for

c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.


DOI: 10.1111/j.1467-8659.2011.01959.x
Eurographics / IEEE Symposium on Visualization 2011 (EuroVis 2011)
H. Hauser, H. Pfister, and J. J. van Wijk
(Guest Editors)

Volume 30 (2011), Number 3

A Gradient-Based Comparison Measure for Visual analysis of
Multifield Data
Suthambhara Nagaraj1 , Vijay Natarajan1,2 , and Ravi S. Nanjundiah3
1 Department

of Computer Science and Automation, Indian Institute of Science, Bangalore
email: {suthambhara,vijayn}@csa.iisc.ernet.in
2 Supercomputer Education and Research Centre, Indian Institute of Science, Bangalore
3 Centre for Atmospheric and Oceanic Sciences, Indian Institute of Science, Bangalore
email: ravi@caos.iisc.ernet.in

Abstract
We introduce a multifield comparison measure for scalar fields that helps in studying relations between them. The
comparison measure is insensitive to noise in the scalar fields and to noise in their gradients. Further, it can be
computed robustly and efficiently. Results from the visual analysis of various data sets from climate science and
combustion applications demonstrate the effective use of the measure.
Categories and Subject Descriptors (according to ACM CCS): I.3.6 [Computer Graphics]: Computer Graphics—
Methodology and Techniques

1. Introduction
Data from present day simulations and observations of physical processes often consists of multiple scalar and vector
fields. Studying the interactions between the fields is pivotal
to understanding the underlying phenomenon.
Single scalar fields are typically studied using techniques like isosurfacing, direct volume rendering and contour trees [HJ04,SML06,PWH01,CSvdP04,CSA00]. When
visualizing multiple scalar fields, the above methods can be
used separately on each field and visualized side by side or
as overlays. The relationships and interactions that exist between the fields are often not captured by such methods. Simultaneous visualization of all the fields facilitates the understanding of interactions and relationships between them.
This can be accomplished by employing a comparative approach to capture the relationships between variables.
We present a new gradient-based comparison measure for
scalar fields that is applicable on an arbitrary number of
scalar fields defined on a manifold. The measure captures
the extent of alignment of the gradient vectors at a point. The
distribution of the measure over the domain provides key insights into the interaction between input fields. The measure
satisfies various desirable mathematical properties, can be
computed efficiently, and is practically useful for studying
relationships between multiple scalar fields. We are a team of
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

visualization researchers and a climate scientist who worked
together to apply this measure for analyzing a hurricane simulation data set and a global climate simulation data set. The
analysis helps explain various known meteorological and climatic phenomena. We also demonstrate the effective use of
an aggregated version of the measure to the study of a combustion simulation data set.
The main contributions of this paper are :
• A new multifield comparison measure to capture interactions between multiple scalar fields defined on an ndimensional domain,
• Theoretical results that establish the robustness of the
measure by showing its insensitivity to noise in the scalar
fields,
• An algorithm to compute the measure efficiently, and
• Real world applications to demonstrate the effectiveness
of the measure in studying interactions between scalar
fields in physical phenomena and an extension to vector
fields.
The rest of the paper is organized as follows. We describe
previous work in Section 2. In Section 3, we define the multifield comparison measure and prove its robustness and other
properties. We motivate the use of the measure and explain
its working in Section 4. Computation of the measure is described in Section 5. We describe several applications of the

1102

Suthambhara Nagaraj et al. / A Gradient-Based Comparison Measure for Visual analysis of Multifield Data

measure in Section 6. In Section 7, we discuss the limitations
of the multifield comparison measure and its insensitivity to
noise in a real world data. We conclude the paper in Section 8.
2. Related Work
A popular approach to visualizing multiple fields is to combine them into a single value and then render the combined
volume [CS99, BPRS98]. Woodring et al. [WS06] propose
that the data fields should be rendered together within the
same space for user comparison. They use set operators to
combine the different fields into a single field that extracts
the interesting portions of the data. These set operators can
either combine the color values of the input fields or directly apply the operation in data space. Though combining volumes shows important parts of the data, the interactions between the different variables that are of importance
to the domain scientists are not captured. For multifield time
varying data, Lee et al. [LS09] propose a linear time algorithm to extract trend relationships among variables based
on studying the change of variables over time and how these
changes are related among different variables. Features in
multifield data have been extracted using techniques like
scatter plots [BW08] and variation density plots [NN10].
Multifield data have also been studied using statistical
methods. One important work in this area uses the local statistical complexity [JWSK07] to identify features which may
exhibit the same behavior in the future. Features are identified as complex if the probability that they occur again is low.
In a later work, Jänicke et al. [JBTS08] improve the accuracy
and efficiency of computing the local statistical complexity.
The relationship between the different scalar fields is popularly captured with the help of correlation measures. Sauber
et al. [STS06] use two different techniques to compare different scalar fields at a point. One of them uses the alignment of gradients of the fields and also their magnitudes as
a criterion to measure similarity. When the number of fields
exceed two, pairwise similarity is computed and the least
value is considered. This would detect regions where two of
the fields are highly correlated. An obvious limitation of this
approach is that two fields with low correlation would result in the other fields of the data to be ignored. In the same
paper, the authors also describe a local correlation coefficient to detect linear dependencies between the scalar fields.
The advantage of this method is its insensitivity to scaling
of the data fields. It also has the same limitation as the first
approach. Gosink et al. [GAJ07] also use correlation fields
to study the interactions between the different variables in
multi-field data. The inner product of the gradients of two
fields of interest is computed over principle level sets of a
third field. They use this approach to study combustion in
methane and hydrogen. A limitation with using the inner
product of the gradients is that only two fields can be compared.

Edelsbrunner et al. [EHNP04] also employ a gradientbased approach to measure relationships between scalar
fields. In their work, they introduce a measure to compare
multiple scalar fields both locally at a point as well as over
a region of the domain. In the case of three dimensional Euclidean space and two fields, they show that the measure at a
point reduces to the length of cross product of the gradients
of the fields. This measure, though useful, has a limitation
that the number of scalar fields that can be compared cannot
exceed the dimension of the domain.
In this paper, we also explore a gradient-based approach
to compare scalar fields locally at a point. However, our
method is not limited by the number of fields that can be
compared unlike previous approaches. Our method also extends to time-varying scalar fields and to vector fields. Further, the measure is provably robust to noise in the input
fields.
3. Multifield Comparison Measure
In this section, we introduce a gradient-based comparison
measure for multiple scalar functions. The measure is defined as the norm of a matrix comprising the gradient vectors
of the different functions. We first define the matrix norm
before defining the measure and listing and proving its properties.
3.1. Matrix Norm
Let A be a m × n matrix of real numbers. The norm of the
matrix A, denoted as A , is defined as
A =

max

x =1, x∈Rn

Ax ,

where x represents the Euclidean norm of vector x [HJ85].
We list four properties of the matrix norm that we will use
later to prove key properties of the comparison measure. In
particular, if A and B are matrices of real numbers, then
1. A > 0 if A = 0 and A = 0 iff A = 0.
2. For α ∈ R, α A = |α | A .
3. A + B ≤ A + B and A − B ≥ | A − B |
4. AB ≤ A B .
3.2. Comparison Measure
Let M be a compact Riemannian manifold of dimension n.
Let (x1 , x2 , . . . , xn ) be a local coordinate system such that the
unit tangent vectors form an orthonormal basis with respect
to the Riemannian metric. Let F = { f1 , f2 , f3 , . . . , fm } be a
set of smooth functions defined on the manifold. The derivative at a point p ∈ M is written as a matrix of partial derivatives,

 ∂ f1
. . . ∂∂ xf1 (p)
∂ x1 (p)
n

 .
..
..

dF(p) = 
.

 ..
.
∂ fm
∂ fm
(p)
.
.
.
(p)
∂x
∂x
1

n

c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Suthambhara Nagaraj et al. / A Gradient-Based Comparison Measure for Visual analysis of Multifield Data
Y

1103

lationship:

∂ fi ∂ fi
−
= (A1 εi1 + A2 εi2 + A3 εi3 )
∂x
∂x
and

∂ fi ∂ fi
−
= (B1 εi1 + B2 εi2 + B3 εi3 ).
∂y
∂y

X

Figure 1: Piecewise-linear function defined on a triangle in
a 2D mesh.

We define the multifield comparison measure η pF at point p
as the norm of the matrix dF(p), η pF = dF(p) . The measure η pF satisfies three important properties: symmetry, coordinate system independence and stability. We now state and
prove these properties.
Symmetry. The measure is independent of the permutation
of the functions in F. The proof follows directly from the
definition.
(x1′ , x2′ , . . . , xn′ )

deCoordinate system independence. Let
note a second orthonormal local coordinate system. Let J
denote the Jacobian matrix that transforms the second coordinate system to the first. Since J represents a transformation between orthonormal coordinate systems, |Jv| = |v| for
v ∈ Rn . This implies that J = 1. We first observe that if
dF ′ (p) is the derivative at p for the new coordinate system,
then,
dF ′ (p) = dF(p)J.
This implies that dF ′ (p) = dF(p)J ≤ dF(p) J by
applying Property 4 of the matrix norm. Since J = 1,
we have dF ′ (p) ≤ dF(p) . Similarly, we can prove that
dF(p) ≤ dF ′ (p) by considering the Jacobian that transforms the first coordinate system to the second. This implies
that the matrix norms are equal independent of the coordinate system.
Stability. We prove robustness of the measure when the
scalar functions in the set F are piecewise-linear functions
defined on a triangle mesh. We first observe that the derivative in the interior of a triangle is well defined and is a constant. To simplify the description, we prove stability for a
2D triangle mesh representing a surface. Extension to higher
dimensions is straightforward.
Consider a triangle in the mesh with coordinates as shown
in Figure 1. The function value at any interior point p(x, y)
is given by

Therefore, the difference between the derivative matrices is
dF(p) − dF(p)


A1 ε11 + A2 ε12 + A3 ε13 B1 ε11 + B2 ε12 + B3 ε13


..
..
=

.
.
A1 εm1 + A2 εm2 + A3 εm3 B1 εm1 + B2 εm2 + B3 εm3
 1


ε1 ε12 ε13 A
1 B1

..
..  A

=  ...
.
.  2 B2 .
A
B
3
3
εm1 εm2 εm3
Using Property 3 of the matrix norm,
|η pF − η pF | ≤ dF(p) − dF(p) .
Let ε =

sup

|εi (p)|. Using Property 4 of the matrix

1≤i≤m,p∈M

norm to rewrite dF(p) − dF(p) , we get
|η pF − η pF | ≤ dF(p) − dF(p)

ε11
≤ ...
εm1

m

≤

ε12
..
.
εm2
3

ε13
..
.
εm3

j

∑ ∑ (εi )2

i=1 j=1

A1
√
≤ ( 3m)ε A2
A3

A1
A2
A3
A1
A2
A3

B1
B2
B3
B1
B2
B3

B1
B2 .
B3

The above equation indicates that a finite change in the functions results in a bounded change in the multifield comparison measure. The amount of change additionally depends on
the size of the triangle.
The rows in the matrix dF(p) represent the gradient vectors of the function. It is therefore easy to see (using property
3 from section 3.1) that a bounded change in the gradients
will also result in a bounded change in the comparison measure. The multifield comparison measure is therefore robust
with respect to perturbations in the scalar functions as well
as their gradients.

fi = (A1 fi1 + A2 fi2 + A3 fi3 )x + (B1 fi1 + B2 fi2 + B3 fi3 )y,
p

where the constants (A1 , A2 , A3 , B1 , B2 , B3 ) depend only on
a, b, and c. Consider a perturbation F = { f1 , . . . , fm } of the
functions in the set F, where fi = fi + εi and εi assumes
small values. The partial derivatives satisfy the following rec 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

4. Analyzing Synthetic Functions
We describe the motivation for the definition of the multifield comparison measure by considering the case of one and
two analytic functions. Next, we show how the comparison

1104

Suthambhara Nagaraj et al. / A Gradient-Based Comparison Measure for Visual analysis of Multifield Data
11.3

34.5

8.0

12.7

8.0

(a)

(b)

10.04

9.85

(c)

7.11

(d)

Figure 2: Multifield comparison measure η F computed for synthetic functions defined on a 2D grid with the center as origin.
(a) Two functions f1 (x, y) = (x − 0.25)2 + y2 and f2 (x, y) = (x + 0.25)2 + y2 . The measure η F attains high values on the
Jacobi set and low values where the gradients are orthogonal. (b) The sinusoidal function f1 (x, y) = sin(3(x + y)) and the linear
√
√
function f2 (x, y) = y. (c) Three functions f1 (x, y) = x2 + y2 , f2 (x, y) = 12 ( 3x + y), and f3 (x, y) = 12 (− 3x + y). (d) One
hundred different scalar functions, whose gradient vectors have unit magnitude and directions are chosen uniformly at random
at points on the two axes and are chosen to be some constant at remaining points on the plane.

=

=

Figure 3: Two pairs of equivalent configurations of gradients
of three functions described in Figure 2c. Gradient vectors
subtend an angle of 120◦ at points along the Y -axis (top) and
are more closely aligned with each other at points along the
X-axis.

measure naturally extends to a larger number of scalar functions. We also show that the comparison measure can be used
to capture the variation in gradient vectors over time for time
varying scalar fields and to capture variation in time-varying
vector fields.
One / two scalar functions. In the special case of a single
scalar function, the comparison measure at a point p is equal
to the maximum rate of change of the function, which is essentially the length of the gradient vector at p. The gradient
vector and its length have been used to study the behavior of
a function with respect to the domain [GNP∗ 06]. The proposed measure η F is a natural extension of the notion of
gradients and their relationship to multiple functions.
In the case of two smooth scalar functions, the gradients
along with their mutual alignment is an indicator of the relationship between them [EHNP04, GAJ07, STS06]. Given
two non-zero gradients, the multifield comparison measure
η F assumes the highest value when the gradients are parallel or anti-parallel. This set of points where the gradients
align is called the Jacobi set [EH02]. The Jacobi set has
been previously used to study the relationship between scalar

functions [EHNP04]. The comparison measure assumes a
minimum when the gradients are orthogonal. Orthogonality of the gradients indicates mutual independence of the
functions. Figure 2a shows the computed comparison measure for two paraboloids, f1 (x, y) = (x − 0.25)2 + y2 and
f2 (x, y) = (x + 0.25)2 + y2 defined on a 2D grid. The Jacobi set is the line y = 0 shown in dark red. The dark blue circle joining the centers of the paraboloids is the set of points
where the gradients are orthogonal. Figure 2b depicts another example, a sinusoidal function f1 (x, y) = sin(3(x + y))
and a linear function f2 (x, y) = y. The comparison measure
assumes high values at the Jacobi set (shown in bright red)
and the set of points with orthogonal alignment of gradients
has low values (shown in blue). We note that when the gradient of a function is replaced with its negative, the measure
remains the same. Two different configurations of the gradients yield the same comparison measure if it is possible to
make a transition from one to another by replacing gradients
with their negatives.
Multiple / time-varying scalar functions. Consider
three
√
functions f1 (x, y) = x2 + y2 , f2 (x, y) = 12 ( 3x + y), and
√
f3 (x, y) = 12 (− 3x+y). The multifield comparison measure
(see Figure 2c) is minimum along the Y -axis. The gradient
vectors at points on the Y -axis subtend an angle of 120◦ with
each other, whereas they are more aligned at points on the Xaxis, see Figure 3. Figure 2d shows the comparison measure
computed for hundred different scalar functions defined on a
grid. All gradients have unit magnitude and the direction of
the gradients for points on the X and Y axis are chosen uniformly at random. The gradients of all scalar functions are
chosen to be equal at other points on the plane. We observe
that the values of the comparison measure on the two axes
are low compared to the values elsewhere on the grid. This
indicates that given a set of gradient vectors with fixed magnitudes, the measure takes high values where the directions
are more “coherent”.
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Suthambhara Nagaraj et al. / A Gradient-Based Comparison Measure for Visual analysis of Multifield Data

Given a single time varying scalar field, we construct the
set F of multiple scalar functions with one function corresponding to each time step. The multifield comparison measure in this case measures the variation of the scalar function over time. We extend the measure to compare multiple
vector fields or analyze the variation in time-varying vector
fields by replacing each row in the derivative matrix dF(p)
with the input vector at the point p.
5. Computation
Evaluating the multifield comparison measure at a point requires the solution to a maximization problem. In this section, we describe how this computation can be reduced to
the faster evaluation of the maximum eigenvalue of a positive semi-definite matrix.
Maximum eigenvalue computation. From the definitions
of the multifield comparison measure and the norm of a matrix, we have

η pF =

max

x∈Rn , x =1

xT (dF(p))T (dF(p))x

1
2

.

We rewrite the matrix product (dF(p))T (dF(p)) as U T ΛU,
where U is an orthogonal matrix and Λ is a diagonal matrix
consisting of the eigenvalues of (dF(p))T (dF(p)) as entries
in its diagonal. This follows from the spectral theorem from
linear algebra [HK71]:

η pF =

max

x∈Rn , x =1

xT U T ΛUx

1
2

.

Since the orthogonal matrix U represents a length preserving and invertible transformation, we can write the above
expression as

η pF

=

max

x∈Rn , x =1

T

1
2

x Λx

√
= max{ λ : λ is a diagonal element of Λ}
√
= max{ λ : λ is an eigenvalue of (dF(p))T (dF(p))}.
For piecewise linear functions defined on a triangle mesh,
the derivative matrix dF(p) is constant within a triangle and
can be computed by choosing a local coordinate system.
When the data is available over a structured grid and linearly interpolated along each coordinate axis, the difference
between neighboring points in each axis direction can be
used to approximate the partial derivatives at sample points
and hence compute η F . We note that following an approach
similar to proving stability for piecewise linear functions, we
can show that the comparison measure computed using this
approximation for the gradient is also robust to noise in the
input.
Analysis. The size of the n × n matrix (dF(p))T (dF(p)) depends only on the dimension of the domain. Therefore, the
time taken for computing the measure also depends only on
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

1105
537.22

4.21

(a)

(b)

Figure 4: (a) The hurricane track released by the US National Hurricane Center (source: http://www.nhc.noaa.gov).
The track relevant to the period of simulation is between
point 17 and point 19 when the hurricane struck the coast.
(b) Multifield comparison measure computed for nine pressure fields. The region in red with high values of the comparison measure corresponds to the trace of the eye of the
hurricane. Land is shown in green.

the dimension of the domain and is, in particular, independent of the number of fields m.
6. Applications
We use the multifield comparison measure to study various
real-world data from weather modeling, climate simulations,
and combustion simulations. Observations on the combustion data were compared with prior work described in the
literature. First, we study a simulation of the hurricane Isabel. Next, we apply our multifield comparison measure on a
global wind pattern data set. Finally, we study a combustion
simulation data set by aggregating the multifield comparison measure over the domain at each time step. The data in
the following applications varies in the dimensionality of the
domain and the number of fields – two scalar fields defined
on a 3D domain, multiple time-varying scalar fields defined
on 2D and 3D domains, and time-varying vector fields. In all
cases the analysis is based on the proposed multifield comparison measure η F . We perform experiments on data sets
obtained using a variety of climate models. In Section 6.2,
we describe results from a single climate model. The supplementary material includes figures from our experimental
results on three additional models, which demonstrate the
applicability of the proposed method.
6.1. Isabel Hurricane
Hurricane Isabel struck the west Atlantic region in September 2003. A simulation of the phenomenon was performed
on a 600 × 600 × 100 grid corresponding to a physical volume of 2139km ×2004km ×19.8 km over 48 time steps corresponding to 48 simulated hours [WBK04]. Several quantities were computed by the simulation. The scalar fields relevant to our experiment are pressure (Pf) and the horizontal
wind velocity components (Uf and Vf).

1106

Suthambhara Nagaraj et al. / A Gradient-Based Comparison Measure for Visual analysis of Multifield Data
Uf=55

Vf=66

14
Warm Front

Leading Warm
Front

Uf=-62

(a)

(b)

Vf=-53

(c)

Cold Front

3

(d)

Figure 5: Fronts in Hurricane Isabel at hour 10. (a) Region of simulation. Land mass is shown in red. (b) Volume rendering (top
view) of horizontal wind speed Uf. (c) Volume rendering (top view) of horizontal wind speed Vf. (d) Volume rendering (top
view) of multifield comparison measure η F computed for Uf and Vf showing the rainbands at different fronts. The location of
the fronts is not available from the individual scalar fields Uf and Vf.
Uf=48

Uf=70

19

19

Occlusion

Warm
Front

Uf=-68

(a)

Uf=-58

(b)

Cold Front

(c)

0

0

(d)

Figure 6: Fronts in Hurricane Isabel at hour 40. (a) Volume rendering (top view) of horizontal wind speed Uf. (b) Volume
rendering (top view) of horizontal wind speed Vf. (c) Volume rendering (top view) of multifield comparison measure η F
computed for Uf and Vf showing the rainbands at different fronts. The cold front leads the warm front resulting in an occlusion.
(d) Volume rendering from a different viewpoint .

Hurricane track. The horizontal pressure gradient can be
observed to be high near the eye of the hurricane throughout
the simulation. We study the pressure field at every fifth time
step defined on a 2D slice corresponding to altitude 1500m.
Figure 4b shows the multifield comparison measure computed for the nine pressure fields. The red circular regions
that correspond to high values of the comparison measure
correspond to the hurricane track. Figure 4a shows the track
provided by the US National Hurricane Center for reference.
The results are similar when we compute the multifield comparison measure for all 48 pressure fields. One of the horizontal pressure gradients assumes a high value at the eye
compared to the rest and hence the comparison measure is
higher compared to regions far from the path of the eye.
Rainbands and fronts. Cloud structures associated with an
area of rainfall, called rainbands, occur mainly at boundaries
separating two masses of air of different densities and temperatures, called fronts. The leading edge of the cooler mass
of air is called the cold front and the leading edge of a warm
air mass is called the warm front. The turbulence of the horizontal wind velocity is high near rain bands. We study the
fronts by computing the multifield comparison measure for
the pair of 3D scalar fields Uf and Vf, where the 3D do-

main corresponds to the volume in the altitude range 1500m5800m.
First, we compute the multifield comparison measure for
the fields Uf and Vf in the 10th time step. Figure 5 shows the
result of our experiment as volume rendered images with the
view point located above the volume. In particular, Figure 5d
shows the location of two warm fronts and a cold front. This
information about fronts cannot be extracted from the two
functions individually (see Figures 5b and 5c). The comparison measure successfully captures the relationship between
the fields at the fronts. The warm front leads the cold front
in the 10th time step. The precipitation structures indicated
by light red spots on the rain bands on the land mass were
responsible for heavy rainfall in Florida. Next, we compute
the multifield comparison measure for the fields Uf and Vf
in the 40th hour of simulation. We observe that the warm
front at the north has disappeared, see Figures 6c and 6d .
The previously leading warm front is overtaken by the cold
front resulting in an occlusion.
Value of Study. Both structures discussed above are key to a
comprehensive study of the hurricane. The track of a hurricane or a cyclone generated from a forecast is helpful in predicting the areas susceptible to severe weather. Fronts often
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Suthambhara Nagaraj et al. / A Gradient-Based Comparison Measure for Visual analysis of Multifield Data

1107

give valuable information about severe weather to the forecaster. Rainbands at cold fronts are often strong in nature
and can be responsible for heavy thunder storms. Typically,
occlusion fronts are associated with thunder storms and their
passage results in the reduction of humidity.

filtered out. The red regions match closely with the storm
tracks shown in Figure 7d. We notice that even though the
west coast of South America has trade winds, storms are particularly absent due to lower temperatures. The storm prevalent regions in the Indian, Atlantic, and Pacific oceans have
high values of the comparison measure.

6.2. Global Wind Patterns

Value of Study. Wind patterns give the details of the wind
over a particular place. They cause various local and global
phenomena and are widely studied by climate scientists. For
example, the trade winds are responsible for tropical cyclones over oceans. Storm tracks generated using winds give
us information on regions where storms are more probable.
Computing storm tracks for long periods would require ascertaining tracks of every individual hurricane and cyclone
and plotting them. Our approach simplifies this computation
by considering all 600 time steps together to generate the
distribution of the comparison measure.

Prevailing winds are winds that blow in a dominant direction at a particular point. Movements in the Earth’s atmosphere affect these winds. In regions of mid-latitudes, the
winds blow from west to the east and are known as westerlies. The winds found in the tropics near the equator are
easterlies or trade winds. Figure 7a shows the different prevailing winds on earth. We study wind patterns on earth
using a climate simulation of 50 years between 1960 and
2009 [RBB∗ 03]. The data is available for 600 time steps
corresponding to each month over the period of simulation.
Each time step is a 3D grid with resolution corresponding to
1◦ × 1◦ × 16plev (pressure elevations) on earth. Pressure elevations correspond to pressures varying from 1000 hPa on
the surface to 30 hPa in the upper atmosphere.
Westerlies and trade winds. The wind velocity at a point
on the grid is a vector quantity. We use the monthly wind
velocities as rows in the derivative matrix and compute the
matrix norm for 600 vector fields. The norm η F measures
the variation of the wind velocities over a time period of
50 years. Figure 7b shows the distribution of the computed
comparison measure over a surface corresponding to pressure elevation 925 hPa. Comparing with wind patterns in
Figure 7a, we see that the measure assumes high values in
regions that lie in the path of prevailing winds, particularly
the westerlies found in the regions surrounding Antarctica,
the region of hurricanes in Atlantic, the cyclone prone region between Madagascar and Australia, and the trade winds
across the Atlantic sea traveling towards the Caribbean sea.
The distribution of the comparison measure over the isobar
for pressure level 300 hPa, which corresponds to approximately 30000 feet above sea level, is shown in Figure 7c.
The values of the comparison measure are higher compared
to Figure 7b because friction and other effects can cause the
wind flow at 925 hPa to be less steady than at higher levels such as 300 hPa. We note that the comparison measure
assumes high values over the temperate regions corresponding to the westerly jet. This is a semi-permanent feature of
the mid-latitudes. Many regions in the tropics undergo a seasonal reversal of wind (called the monsoons). Lower values
of the comparison measure over the tropics indicates unsteadiness and corresponds to a seasonal reversal in wind
pattern over this part of the world.
Storm tracks. The regions over the ocean with warm temperatures (> 27◦ C) are susceptible to storms. We filter out
regions with lower temperatures and restrict our analysis to
the months from June to November with the aim of locating
storm tracks. Regions shown in blue in Figure 7e have been
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

6.3. Hydrogen Combustion
We study phases in the combustion of an inhomogeneous
turbulent mixture of fuel and oxidizer. Hydrogen fuel at
300K is mixed with an oxidizer (21% oxygen) at 1200K.
The influence of turbulence on the different phases of combustion is studied in the simulation. The compressed fuel
ignites at multiple spots because of the inhomogeneity in
the air-fuel ratio. Depending on the air-fuel ratio, the flame
either propagates in an outward direction from the ignition
spot or burns out. Further details of the computation can be
found in the description of the simulation by Echekki and
Chen [EC03] and in the description of a visual analysis of
this data by Koegler [Koe01]. The domain of the simulation
is a 600 × 600 grid for 67 time steps. The species mass fractions of the fuel H2 , oxygen O2 , and intermediate HO2 are
given at each grid point for all time steps.
Phases of combustion. We aggregate the multifield comparison measure for a time step t by computing its integral over
the domain D of simulation:

η F,t =

ηxF dx.
x∈D

In our study, we consider all three scalar fields for computing the comparison measure for a time step, i.e. F =
{H2 , O2 , HO2 }. The plot of η F,t over time is shown in Figure 8. We compare our results with a plot of the global
comparison measure κ , introduced by Edelsbrunner et al.
[EHNP04], see Figure 8. The fields used for computing κ
are H2 and O2 . The maximum number of fields that κ can
compare over a 2D domain is two, whereas we are able to
consider all three fields in our analysis.
Following the work of Koegler, the areas in the domain
that eventually ignite can be considered as features. In the
pre-ignition phase, the concentrations of the intermediate
radicals build up in regions that have sufficient mass frac-

1108

Suthambhara Nagaraj et al. / A Gradient-Based Comparison Measure for Visual analysis of Multifield Data

Dark Blue

Red

(a)
1198

1198

14

14

(b)

(c)
1198

14

(d)

(e)

Figure 7: Multifield comparison measure η F computed for wind velocities over the years 1960-2009, where the comparison is
over a set of six hundred 3D vector fields. (a) Map of world showing wind patterns (source: Wikipedia) (b) Distribution of η F
over surface corresponding to pressure elevation 925 hPa. The dark red regions correspond to the wind patterns. (c) Distribution
of η F over surface corresponding to pressure elevation 300 hPa. The temperate regions exhibit higher values. (d) Storm track for
the years 1985-2005 (source: Wikipedia) (e) Distribution of η F after removing regions with low mean temperature (< 27◦ C).
Red regions correspond to the storm tracks. The world map is overlaid for clarity.

tion of H2 . The number of features attains a maximum during time steps 7-14 [Koe01]. This is captured by a knee in
the plot of η F,t . The plot of κ does not indicate changes
that happen in the pre-ignition build up of radicals because
the intermediate HO2 is not considered in the computation.
Ignition (time step 28) happens at areas with high radical
concentrations during the ignition phase and the flame front
spreads to hot enough areas with the right mix of fuel and
oxidizer during the burning phase (time steps 50-55). Ignition and burning are captured by a minimum and a maximum respectively in the plot of η F,t . These phases are also
captured by κ because of the interaction between H2 and
O2 during this time period. The beginning of the extinction

phase (approximately time step 60) where the flame begins
to extinguish is also captured more clearly by a minimum in
the plot of η F,t . We believe that the reason η F,t is able to
capture more information compared to κ is because all three
fields play a role in defining the phases.
7. Discussion
We now discuss some limitations of the multifield comparison measure and describe an experiment to study the sensitivity of the measure to noise in the input.
Limitations. The basic premise behind using the comparison measure to capture relationships in multifield real world
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

κ (H2 , O2 )

η F,t

Suthambhara Nagaraj et al. / A Gradient-Based Comparison Measure for Visual analysis of Multifield Data

1109

the computed comparison measure field after adding a Gaussian noise (standard deviation = 1) to the input fields Uf and
Vf of the 10th time step in the simulation, see Figure 9a. It
should be noted that the noise we have added is large and
quite unlikely to occur in real data sets. We also study the
mean deviation in the comparison measure computed on input with Gaussian noise of different amplitudes. Figure 9b
shows the linear relationships between the observed mean
deviation of η F and the noise, which indicates that the multifield comparison measure is not much sensitive to noise.

Time

8. Conclusions
Figure 8: Analyzing phases of combustion using an aggregate η F,t of the multifield comparison measure over the domain within a time step t. The set F = {H2 , O2 , HO2 }. The
plot of η F,t (blue) over time captures more phases of the
combustion process compared to the plot of the global comparison measure κ (H2 , O2 ) (red) proposed by Edelsbrunner
et al. [EHNP04]. The vertical dashed lines approximately
correspond to the four phases of combustion: pre-ignition,
ignition, burning, and extinction.

ση F

16

0.1

(a)

σin
(b)

Figure 9: Stability in the comparison measure for Isabel.
(a) Volume rendering (top view) of multifield comparison
measure η F computed after adding Gaussian noise (standard
deviation = 1) to the fields Uf and Vf. The rain bands are
still clearly visible. (b) Graph showing near linear relationship between the standard deviation of the noise in the input
σin , and the mean deviation of the comparison measure ση F .

We have described a robust multifield comparison measure
for scalar fields whose distribution over the domain plays
an important role in the visual analysis of the input fields.
The comparison measure is computed locally at all points of
the domain as the maximum eigenvalue of a small sized matrix. We described applications of the comparison measure to
study various simulation datasets from climate science and
combustion studies where the data is represented using multiple 2D, 3D, or time-varying scalar fields. We used the comparison measure to study up to 600 scalar fields defined on
the domain. We list three ideas for future work:
• The multifield comparison measure being sensitive to the
scaling of individual fields may not be always desirable.
One approach to address this issue is to scale the scalar
fields or normalize their gradients. Though this method
would work in some cases, it could bias the results by
scaling up small insignificant gradients. A complete solution remains to be a challenge.
• Integrating the multifield comparison measure into
the query-based visualization framework of Gosink et
al. [GAJ07] will be an interesting task.
• Identification of important isovalues of a scalar function
in multifield data is a challenging problem. A global version of the proposed comparison measure may help locate
these isovalues.
Acknowledgments

data is the fact that the agreement among the different gradient fields can often capture interactions among fields. In
many applications, where this does not hold good, using
the comparison measure or other gradient based comparison measures would be less fruitful. We therefore believe
that gradient based techniques such as ours complements
other well known techniques like the local statistical complexity [JWSK07] and the Pearson correlation coefficient.
Another drawback of the comparison measure is its sensitivity to scaling of individual fields.
Sensitivity to noise. We validate our claim that the comparison measure is insensitive to noise using the hurricane
data described in Section 6.1. The different features present
in the data like the weather fronts are still clearly visible in
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

This work was supported by the Department of Science and
Technology, India under grant SR/S3/EECE/048/2007. Hurricane Isabel data was produced by the Weather Research
and Forecast (WRF) model, courtesy of NCAR and the U.S.
National Science Foundation (NSF). The climate data was
part of the WCRP CMIP3 Multi-Model data repository at
https://esgcet.llnl.gov:8443. We acknowledge the modeling
groups for making their model output available for analysis,
the Program for Climate Model Diagnosis and Intercomparison (PCMDI) for collecting and archiving this data, and the
WCRP’s Working Group on Coupled Modelling (WGCM)
for organizing the model data analysis activity. The WCRP
CMIP3 multi-model dataset is supported by the Office of
Science, U.S. Department of Energy. We thank all reviewers
for their valuable feedback, which helped improve the paper.

1110

Suthambhara Nagaraj et al. / A Gradient-Based Comparison Measure for Visual analysis of Multifield Data

References
[BPRS98] BAJAJ C., PASCUCCI V., R ABBIOLO G., S CHIKORE
D.: Hypervolume visualization: a challenge in simplicity. In
Proc. IEEE Symp. Volume Visualization (1998), pp. 95–102. 2
[BW08] BACHTHALER S., W EISKOPF D.: Continuous scatterplots. IEEE Transactions on Visualization and Computer Graphics 14, 6 (2008), 1428–1435. 2
[CS99] C AI W., S AKAS G.: Data intermixing and multi-volume
rendering. Computer Graphics Forum 18, 3 (1999), 359–368. 2
[CSA00] C ARR H., S NOEYINK J., A XEN U.: Computing contour trees in all dimensions. In Proc. ACM-SIAM Symposium on
Discrete algorithms (2000), pp. 918–926. 1
[CSvdP04] C ARR H., S NOEYINK J., VAN DE PANNE M.: Simplifying flexible isosurfaces using local geometric measures. In
Proc. IEEE Conf. Visualization (2004), pp. 497–504. 1
[EC03] E CHEKKI T., C HEN J. H.: Direct numerical simulation
of autoignition in nonhomogeneous hydrogen-air mixtures. Combustion and Flame 134, 3 (2003), 169–191. 7
[EH02] E DELSBRUNNER H., H ARER J.: Jacobi set of multiple
morse funtions. In Foundations of Computational Mathematics,
Minneapolis (2002), Cambridge Univ. Press, pp. 37–57. 4

[RBB∗ 03] ROECKNER E., BÄUML G., B ONAVENTURA L.,
B ROKOPF R., E SCH M., G IORGETTA M., H AGEMANN S.,
K IRCHNER I., KORNBLUEH L., M ANZINI E., R HODIN A.,
S CHLESE U., S CHULZWEIDA U., T OMPKINS A.: The Atmospheric General Circulation Model ECHAM5. PART 1: Model
Description. Tech. Rep. 349, Max Planck Institute of Meteorology, 2003. 7
[SML06] S CHROEDER W., M ARTIN K., L ORENSEN B.: The Visualization Toolkit An Object-Oriented Approach To 3D Graphics, 4th Edition. Kitware, Inc., 2006. 1
[STS06] S AUBER N., T HEISEL H., S EIDEL H.-P.: Multifieldgraphs: An approach to visualizing correlations in multifield
scalar data. IEEE Transactions on Visualization and Computer
Graphics 12, 5 (2006), 917–924. 2, 4
[WBK04] WANG W., B RUYERE C., K UO B.: Competition data
set and description in 2004 IEEE Visualization design contest,
2004. http://vis.computer.org/vis2004contest/data.html. 5
[WS06] W OODRING J., S HEN H.-W.: Multi-variate, time varying, and comparative visualization with contextual cues. IEEE
Transactions on Visualization and Computer Graphics 12, 5
(2006), 909–916. 2

[EHNP04] E DELSBRUNNER H., H ARER J., NATARAJAN V.,
PASCUCCI V.: Local and global comparison of continuous functions. In Proc. IEEE Conf. Visualization (2004), pp. 275–280. 2,
4, 7, 9
[GAJ07] G OSINK L., A NDERSON J. B ETHEL W., J OY K.: Variable interactions in query-driven visualization. IEEE Transactions on Visualization and Computer Graphics 13, 6 (2007),
1400–1407. 2, 4, 9
[GNP∗ 06] G YULASSY A., NATARAJAN V., PASCUCCI V., B RE MER P.-T., H AMANN B.: A topological approach to simplification of three-dimensional scalar functions. IEEE Transactions on
Visualization and Computer Graphics 12, 4 (2006), 474–484. 4
[HJ85] H ORN R., J OHNSON C.: Matrix Analysis. Cambridge
University Press, 1985. 2
[HJ04] H ANSEN C., J OHNSON C.:
Academic Press, 2004. 1

Visualization Handbook.

[HK71] H OFFMAN K., K UNZE R.: Linear Algebra. Prentice
Hall, 1971. 5
[JBTS08] JÄNICKE H., B OTTINGER M., T RICOCHE X.,
S CHEUERMANN G.: Automatic detection and visualization of
distinctive structures in 3d unsteady multi-fields. Computer
Graphics Forum 27, 3 (2008), 767–774. 2
[JWSK07] JÄNICKE H., W IEBEL A., S CHEUERMANN G.,
KOLLMANN W.: Multifield visualization using local statistical
complexity. IEEE Transactions on Visualization and Computer
Graphics 13 (2007), 1384–1391. 2, 9
[Koe01] KOEGLER W. S.: Case study: application of feature
tracking to analysis of autoignition simulation data. In Proc.
IEEE Conf. Visualization (2001), pp. 461–464. 7, 8
[LS09] L EE T.-Y., S HEN H.-W.: Visualization and exploration
of temporal trend relationships in multivariate time-varying data.
IEEE Transactions on Visualization and Computer Graphics 15
(2009), 1359–1366. 2
Relation-aware
[NN10] NAGARAJ S., NATARAJAN V.:
isosurface extraction in multi-field data.
IEEE Transactions on Visualization and Computer Graphics (2010).
http://doi.ieeecomputersociety.org/10.1109/TVCG.2010.64. 2
[PWH01] P EKAR V., W IEMKER R., H EMPEL D.: Fast detection
of meaningful isosurfaces for volume data visualization. In Proc.
IEEE Conf. Visualization (2001), pp. 223–230. 1
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.


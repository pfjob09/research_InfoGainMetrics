DOI: 10.1111/j.1467-8659.2011.02027.x
Eurographics Symposium on Geometry Processing 2011
Mario Botsch and Scott Schaefer
(Guest Editors)

Volume 30 (2011), Number 5

A Complex View of Barycentric Mappings
O. Weber1

M. Ben-Chen2

C. Gotsman3

K. Hormann4

1 Courant

Institute of Mathematical Sciences, New York University, USA
Science Department, Stanford University, USA
3 Computer Science Department, Technion, Haifa, Israel & Department of Computer Science, ETH Zürich, Switzerland
4 Faculty of Informatics, University of Lugano, Switzerland
2 Computer

Abstract
Barycentric coordinates are very popular for interpolating data values on polyhedral domains. It has been recently
shown that expressing them as complex functions has various advantages when interpolating two-dimensional data
in the plane, and in particular for holomorphic maps. We extend and generalize these results by investigating the
complex representation of real-valued barycentric coordinates, when applied to planar domains. We show how
the construction for generating real-valued barycentric coordinates from a given weight function can be applied
to generating complex-valued coordinates, thus deriving complex expressions for the classical barycentric coordinates: Wachspress, mean value, and discrete harmonic. Furthermore, we show that a complex barycentric map
admits the intuitive interpretation as a complex-weighted combination of edge-to-edge similarity transformations,
allowing the design of “home-made” barycentric maps with desirable properties. Thus, using the tools of complex
analysis, we provide a methodology for analyzing existing barycentric mappings, as well as designing new ones.
Categories and Subject Descriptors (according to ACM CCS): I.3.3 [Computer Graphics]: Picture/Image
Generation—Line and curve generation; G.1.1 [Numerical Analysis]: Interpolation—Interpolation formulas

1. Introduction
Barycentric coordinates have become very popular over recent years for interpolating data values f j that are given at
the vertices v j = (x j , y j ), j = 1, . . . , n of a planar polygon
Ω ⊂ ℝ2 . A set of functions b j : Ω → ℝ, j = 1, . . . , n is called
a set of barycentric coordinates or barycentric basis functions if the b j have affine precision, that is,
n

∑ b j (v)φ(v j ) = φ(v)

(1)

j=1

for any point v = (x, y) inside Ω and any affine function
φ(x, y) = αx + βy + γ with α, β, γ ∈ ℝd . This property is often split into two equivalent properties: that the barycentric
coordinates form a partition of unity,
(2)

j=1

and that any v ∈ Ω can be written as an affine combination
of the polygon’s vertices,
n

∑ b j (v)v j = v.

n

f (v) =

∑ b j (v) f j .

(4)

j=1

If the barycentric coordinates further satisfy the Lagrange
interpolation property
{
1, if j = k,
b j (vk ) = δ jk =
0, if j ∕= k,
then it is clear that f interpolates the given data f j at the vertices v j . Another, sometimes desirable property is the nonnegativity of the barycentric coordinates,
b j (v) ≥ 0

n

∑ b j (v) = 1,

The idea now is to use the weights b j (v) of this affine
combination for blending the data values f j and to define
the function f over Ω as

(3)

j=1

c 2011 The Author(s)
⃝
c 2011 The Eurographics Association and Blackwell PublishComputer Graphics Forum ⃝
ing Ltd. Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ,
UK and 350 Main Street, Malden, MA 02148, USA.

for v ∈ Ω, which guarantees that the function values f (v) are
contained in the convex hull of the data values f j .
The interpolant f in (4) is particularly appealing for applications if the b j are given in closed form. Over the past few
years, a number of recipes for such closed-form barycentric coordinates have been developed. Probably the most

1534

O. Weber & M. Ben-Chen & C. Gotsman & K. Hormann / A Complex View of Barycentric Mappings

(a)

(b)

(c)

(d)

Figure 1: A barycentric mapping is defined by a source polygon (green), a target polygon (orange), and some choice of barycentric coordinates, whose properties are inherited by the mapping. The mapping based on real-valued mean value coordinates (a)
linearly interpolates the edges of the target polygon, is well-defined in the entire plane, but considerably distorts local areas and
angles. The complex Cauchy–Green mapping (b) does not even interpolate the target vertices, is defined only in the interior of
the source polygon, but preserves angles. It is also possible to design complex angle-preserving mappings that interpolate the
target vertices (see Section 4.2), albeit at the price of singularities and fold-overs (c). Interpolation of the entire target polygon
by a truly complex mapping (d) can be achieved by compromising the angle-preservation (see Section 4.3).

well-known are the discrete harmonic (also called cotangent weights) [PP93, EDD∗ 95], mean value [Flo03, HF06],
and Wachspress [Wac75, MLBD02] coordinates. Floater
et al. [FHK06] show that all three are just special cases
of a general family of three-point coordinates (see Section 2), and Ju et al. [JLW07] extend their construction to
higher dimensions. While discrete harmonic and Wachspress coordinates are well-defined only inside convex polygons, mean value coordinates are well-defined for arbitrary simple polygons [HF06], but they are not necessarily
non-negative. Positive mean value coordinates [LKCOL07]
overcome this limitation at the cost of being only C0 continuous. The only known smooth barycentric coordinates
that are non-negative even for arbitrary simple polygons
are the harmonic [JMD∗ 07] and maximum entropy coordinates [HS08], but both do not have a closed form and can
only be approximated numerically. All these coordinates satisfy the Lagrange property and are piecewise linear along the
boundary ∂Ω of the polygon.

1.1. Barycentric mappings
While originally designed for interpolating scalar data, it is
also possible to apply the same methodology to vector data.
In particular, if the data f j is two-dimensional, then f in (4)
may be viewed as a mapping from the plane to itself. This
setting has important applications in two-dimensional computer graphics, in particular for image and shape deformation. In this scenario we have two planar polygons (see Figure 1), a source polygon Ω with source vertices v j and a corˆ with the same number of target
responding target polygon Ω
vertices vˆ j , and we are interested in the barycentric mapping
n

f (v) =

∑ b j (v)vˆ j .

ˆ due to the
the boundary of the target polygon, f (∂Ω) = ∂Ω,
piecewise linear behaviour of the b j along ∂Ω. Moreover, if
the target vertices are the image of an affine transformation
φ : ℝ2 → ℝ2 , that is, vˆ j = φ(v j ), j = 1, . . . , n, then it follows
from (1) that f = φ. Although this might be perceived as
an advantage, affine precision is not very natural in the planar deformation scenario, because affine stretches and shears
produce deformations which do not preserve small details.
To rectify this, Lipman et al. [LLCO08] and Weber et
al. [WBCG09] introduce the so-called Cauchy–Green coordinates, which reproduce conformal mappings. To achieve
this, they depart from the classical barycentric coordinate
scenario by abandoning the Lagrange interpolation property,
and so the images of the source vertices f (v j ) may no longer
coincide with the target vertices vˆ j ; see Figure 1 (b). The
construction of these coordinates relies on the Cauchy integral formula from complex analysis, or the somewhat equivalent Green’s third identity from vector analysis. Weber et
al. [WBCG09] further demonstrate that using complex numbers significantly simplifies the formulation of the barycentric mappings based on Cauchy–Green coordinates and the
proofs of related theorems.
In the complex setting, we interpret the source polygon Ω
as a subset of ℂ and represent its vertices v j = (x j , y j ) as
complex numbers z j = x j + i y j , and similarly for the target
polygon. In analogy to properties (2) and (3), a set of functions c j : Ω → ℂ, j = 1, . . . , n is then called a set of complex
barycentric coordinates, if
n

∑ c j (z) = 1

(6)

j=1

and
n

(5)

j=1

If we use any of the barycentric coordinates mentioned
above, then the boundary of the source polygon is mapped to

∑ c j (z)z j = z

(7)

j=1

for any complex number z = x + i y that represents a point
v = (x, y) inside Ω.
c 2011 The Author(s)
⃝
c 2011 The Eurographics Association and Blackwell Publishing Ltd.
⃝

1535

O. Weber & M. Ben-Chen & C. Gotsman & K. Hormann / A Complex View of Barycentric Mappings

As in the real setting, these conditions are equivalent to
the affine precision property, hence the complex barycentric
mapping

R2

n

g(z) =

∑ c j (z)ˆz j

vj+1

Aj

(8)

v

j=1

reproduces complex affine functions ψ(z) = αz + β with
α, β ∈ ℂ. It is important to note that complex affine functions ψ : ℂ → ℂ are less general than affine transformations
φ : ℝ2 → ℝ2 . In fact, they capture only the subset of similarity transformations, but in the context of image and shape
deformation this restriction is an advantage. Unlike their bivariate real-valued siblings, complex barycentric mappings
do not necessarily reproduce visually disturbing shears and
non-uniform stretches, and thus provide more control for the
design of favourable deformations.

R2

vj+1

v

vj

Bj

vj

Aj¡1

vj¡1
C

vj¡1
C

zj+1

rj+1
z

zj+1

wj

ej

µj

rj
zj

µj¡1

z

dj
zj
wj¡1

rj¡1

ej¡1

1.2. Contributions
zj¡1

zj¡1

The goal of this paper is an in-depth study of the structure
and properties of complex barycentric mappings. We first
present some geometric insight into the general construction of barycentric coordinates and show how the classical
real-valued coordinates (Wachspress, mean value, and discrete harmonic) can be interpreted as a family of complexvalued coordinates (Section 2). We then discuss the expressive power of complex-weighted barycentric maps, showing in which cases the complex formulation is more flexible (Section 3). Using this new flexibility and the insights
into the various components which affect the behaviour of
the map, we give a few examples of new mappings, demonstrating the design considerations involved in hand-crafting
complex maps (Section 4). These examples also showcase
the true power of complex coordinates: the ability to “mix”
the x and y coordinates, instead of treating them separately
as maps based on real-valued coordinates do. Combined together, our results provide an extensive toolbox for analysis
and design of both real-valued and complex-valued barycentric mappings.

for certain “weight functions” β j : Ω → ℝ, where A j (v)
and B j (v) are the signed areas of the triangles [v, v j , v j+1 ]
and [v, v j−1 , v j+1 ], respectively (see Figure 2), with indices
taken cyclically over the valid range 1, . . . , n. Moreover, the
b j in (9) constitute a set of barycentric coordinates for any
choice of functions β j [FHK06, Proposition 5], as long as
the denominator ∑nj=1 b˜ j (z) does not vanish.

2. From real-valued to complex-valued coordinates

Similarly, Weber et al. [WBCG09, Theorem 5] remark
that any set of complex barycentric coordinates c j can be
expressed in the form

It is natural to ask whether the traditional real-valued coordinates can be expressed in some natural complex form.
Of course, any real number is also a complex number and
thus real-valued coordinates are by definition also complexvalued coordinates. However, it has been shown that a
general construction exists, both in the real and the complex case, which transforms arbitrary “weight functions” to
barycentric coordinates. These weight functions are sometimes more useful for analyzing the behaviour of the coordinates than the coordinates themselves, thus we wish to relate real- and complex-valued coordinates in terms of these
weight functions.
c 2011 The Author(s)
⃝
c 2011 The Eurographics Association and Blackwell Publishing Ltd.
⃝

Figure 2: Notation used in the real (top) and the complex
setting (bottom).

2.1. The normal form of barycentric coordinates
First, consider the result of Floater et al. [FHK06, Corollary 3] that any set of barycentric coordinates b j can be written in the form
β j+1 A j−1 − β j B j + β j−1 A j
b˜ j
bj = n
,
b˜ j =
(9)
A j−1 A j
b˜ k
∑
k=1

cj =

c˜ j
,
∑nk=1 c˜k

c˜ j = γ j

r j+1
r j−1
− γ j−1
ej
e j−1

(10)

for certain weight functions γ j : Ω → ℂ, where r j (z) = z j − z
and e j = z j+1 − z j (see Figure 2). Conversely, any choice
of functions γ j in (10) gives a set of complex barycentric coordinates c j [WBCG09, Theorem 4], provided that
∑nj=1 c˜ j (z) ∕= 0, which is actually equivalent to the condition
∑nj=1 γ j (z) ∕= 0 (see Section 3).
This justifies one to refer to the forms (9) and (10) as the
normal form of real and complex barycentric coordinates,
respectively.

1536

O. Weber & M. Ben-Chen & C. Gotsman & K. Hormann / A Complex View of Barycentric Mappings

Both constructions are closely related to the defining
properties of barycentric coordinates. In fact, the normalization from homogeneous coordinates b˜ = (b˜ 1 , . . . , b˜ n ) to
normalized coordinates b = (b1 , . . . , bn ) in (9) takes care
of the latter forming a partition of unity (2), and the linear
transformation B : ℝn → ℝn in (9), that maps the weights
β = (β1 , . . . , βn ) to b˜ = (b˜ 1 , . . . , b˜ n ), guarantees that
n

∑ b˜ j (v)(v j − v) = 0,

j=1

which, together with partition of unity, yields the affine
combination property (3). Geometrically, this means that B
maps into the (n − 2)-dimensional linear subspace of ℝn
that is orthogonal to the two vectors (x1 − x, . . . , xn − x) and
(y1 − y, . . . , yn − y), hence the kernel of B is 2-dimensional.
The normalization further reduces the dimension by one, and
so the (non-linear) space of real-valued barycentric coordinates for any point v ∈ Ω is (n − 3)-dimensional.
For complex-valued coordinates, the two transformations
in (10) correspond analogously to the defining properties (6)
and (7). The only difference is that the kernel of the linear transformation C : ℂn → ℂn , which maps the weights
γ = (γ1 , . . . , γn ) to homogeneous coordinates c˜ = (c˜1 , . . . , c˜n )
and guarantees that
n

∑ c˜ j (v)(z j − z) = 0,

j=1

is only 1-dimensional (essentially, the two real dimensions of ker(B) are combined into one complex dimension). Therefore, the (non-linear) space of complex-valued
barycentric coordinates for any z ∈ Ω is (n−2)-dimensional,
and unlike in the real setting, they are not unique if Ω is a triangle. It is easy to verify that the kernel of C is spanned by
the vector
ej
γ¯ = (¯γ1 , . . . , γ¯ n )
with
γ¯ j =
,
(11)
r j r j+1
hence adding any multiple of γ¯ to γ does not change the corresponding complex coordinates c = (c1 , . . . , cn ).

hence
Im(r j r j+1 ) =

Im(r j−1 r j+1 ) = 2B j .
Substituting (12) into (10) gives
(
)
(
)
e j β j+1 β j r j+1 e j−1 β j β j−1 r j−1
2c˜ j =
−
−
−
A j r j+1
rj
ej
A j−1 r j
r j−1 e j−1
(
)
β j−1
β j+1 β j r j+1 r j−1
+
=
−
+
Aj
rj
Aj
A j−1
A j−1
=

β j+1
β j−1
βj
−
Bj +
,
Aj
A j−1 A j
A j−1

where we used the identity r j+1 A j−1 + r j−1 A j = r j B j in the
last step, which in turn follows from the well-known fact that
α1 Im(α2 α3 ) + α2 Im(α3 α1 ) + α3 Im(α1 α2 ) = 0
for any α1 , α2 , α3 ∈ ℂ. The functions c˜ j are therefore equivalent to the functions b˜ j /2, and the factor 1/2 is cancelled
out by the normalization.
Another justification for the normal form in (9) is that the
Wachspress, mean value, and discrete harmonic coordinates
are given by the simple choice β j (v) = ∥v j − v∥ p with p = 0,
p = 1, and p = 2, respectively. Hence, the complex normal
form of these coordinates follows immediately from Theorem 1.
Corollary 2 The complex normal form (10) of Wachspress,
mean value, and discrete harmonic coordinates is given by
the weight functions
(
)
∣r j+1 ∣ p ∣r j ∣ p
ej
γj =
−
(13)
Im(r j r j+1 )
r j+1
rj
with p = 0, p = 1, and p = 2, respectively.
It is interesting to check in which cases these weight functions are real-valued. For p = 2 this is the case because γ j
simplifies to
γj =

We are now ready to relate the two normal forms.

Then the corresponding complex barycentric coordinates c j
in (10) are equivalent to b j , in the sense that Re(c j ) = b j and
Im(c j ) = 0.
Proof Using the representations r j = (x j − x) − i(y j − y) and
r j+1 = (x j+1 − x) + i(y j+1 − y), we have
[
]
Im(r j r j+1 ) = (x j − x)(y j+1 − y) − (x j+1 − x)(y j − y) ,

x j+1 − x
= 2A j ,
y j+1 − y

and similarly

2.2. The complex form of real-valued coordinates

Theorem 1 For any set of real-valued barycentric coordinates b j , j = 1, . . . , n, let β j be the weight functions from
their representation in (9) and define
(
)
β j+1 β j
ej
γj =
−
.
(12)
Im(r j r j+1 ) r j+1
rj

xj −x
yj −y

e j (r j+1 − r j ) ∣e j ∣2
,
=
Im(r j r j+1 )
2A j

using the fact that αα = ∣α∣2 for any α ∈ ℂ. This also
yields a nice geometric interpretation of the discrete harmonic weight functions as the “aspect ratio” of the triangle
[z, z j , z j+1 ], namely the ratio between the length ∣e j ∣ of its
base [z j , z j+1 ] and its height h j = 2A j /∣e j ∣.
For general p we can rewrite γ j in (13) as
(
)
∣r j+1 ∣ p ∣r j ∣ p
r j+1 − r j
=
γj =
−
Im(r j r j+1 )
r j+1
rj
=

∣r j+1 ∣ p − r j r j+1 ∣r j+1 ∣ p−2 − r j+1 r j ∣r j ∣ p−2 + ∣r j ∣ p
Im(r j r j+1 )
c 2011 The Author(s)
⃝
c 2011 The Eurographics Association and Blackwell Publishing Ltd.
⃝

1537

O. Weber & M. Ben-Chen & C. Gotsman & K. Hormann / A Complex View of Barycentric Mappings

(a)

(b)

(c)

(d)

Figure 3: Barycentric mappings from the green source triangle to the orange target triangle: unique real mapping (a), complex
mappings for γ j = 1, a global similarity (b) and γ j = r j+1 /r j − r j /r j+1 , an angle-preserving vertex interpolant (c), and the
complex mapping from Section 4.3 (d).

and notice that the first and last term are purely real. Applying the simple identities
)
(
)
(
z
z
= 1,
Im
= −1
Im
Im(z)
Im(z)

whose null space is spanned by (1, 1, . . . , 1). The theorem
then follows from the fact that x is in the null space of G if
and only if D−1 x is in the null space of G ⋅ D.

to the second and third term, we find that

3. The expressive power of complex barycentric maps

Im(γ j ) = ∣r j+1 ∣

p−2

− ∣r j ∣

p−2

,

and conclude that γ j is real-valued if and only if p = 2.
In fact, it turns out that the discrete harmonic coordinates
are the only real-valued barycentric coordinates among all
possible constructions (that is, beyond the three-point family
considered in Corollary 2) with a real-valued weight function γ j in the complex normal form, as the following theorem
shows.
Theorem 3 The weight functions γ j in (12) are all realvalued if and only if the weight functions β j are all of the
form β j = λ∣r j ∣2 for some λ ∈ ℝ.
Proof The same line of argument as above shows that
Im(γ j ) =

β j+1
∣r j+1 ∣2

−

⎜
G=⎜
⎜
⎝

0
−∣r1 ∣−2

−∣r2 ∣
∣r2 ∣−2
..
.
⋅⋅⋅
0

0
−∣r3 ∣−2
..
.
0
⋅⋅⋅

1

0
−1

−1
1
..
.
⋅⋅⋅
0

0
−1
..
.
0
⋅⋅⋅

∣r j ∣2

j=1

...
...
..
.
∣rn−1 ∣−2
0

...
...
..
.
1
0

n

∑ c˜ j = ∑ γ j

0
0

⎟
⎟
⎟
⎟.
⎟
−∣rn ∣−2 ⎠
∣rn ∣−2

Multiplying
) with the diagonal matrix
( G from the right
D = diag ∣r1 ∣2 , ∣r2 ∣2 , . . . , ∣rn ∣2 , we get the matrix
⎛
⎞
⎜0
⎜
G⋅D = ⎜
⎜
⎝

In fact, it turns out that any complex function h : ℂ → ℂ
can be written in complex barycentric form under very mild
assumptions. To see this, we first reconsider the complex
normal form in (10) and observe that
n

βj

for the weight functions γ j in (12). Thus, they are all realvalued if and only if the vector (β1 , . . . , βn ) lies in the null
space of the matrix
⎛
⎞
−2
−2
∣r1 ∣
⎜ 0
⎜

One of the consequences of Theorem 1 is that any real
barycentric mapping f in (5) can also be expressed as a complex barycentric mapping g in (8). If we further consider the
simple case of a barycentric mapping between two triangles,
then it is clear that the set of complex barycentric mappings
is a proper superset of the set of real barycentric mappings.
Due to the affine precision property, all real barycentric maps
are equal to the unique affine transformation from source to
target triangle in this case, but complex barycentric maps are
more flexible, even in this simple setting (see Figure 3).

0
0 ⎟

−1
1

⎟
⎟,
⎟
⎠

c 2011 The Author(s)
⃝
c 2011 The Eurographics Association and Blackwell Publishing Ltd.
⃝

j=1
n

=

∑ γj

j=1

n
r j+1
r j−1
− ∑ γ j−1
ej
e
j−1
j=1
n
r j+1
rj
− ∑ γj =
ej
e
j
j=1

n

∑ γj

j=1

r j+1 − r j
=
ej

n

∑ γ j,

j=1

hence
n

(

n

n
r j+1
r j−1
∑ c j zˆ j = ∑ γ j e j zˆ j − ∑ γ j−1 e j−1 zˆ j
j=1
j=1
j=1
/ n
n
r j+1 zˆ j − r j zˆ j+1
= ∑ γj
∑ γ j.
ej
j=1
j=1

)/

n

∑ c˜ j

j=1

Now introducing for j = 1, . . . , n the similarity transformation
s j (z) =

r j+1 (z)ˆz j − r j (z)ˆz j+1
,
ej

which linearly maps the source edge [z j , z j+1 ] to the corresponding target edge [ˆz j , zˆ j+1 ], leads to the normal form of

1538

O. Weber & M. Ben-Chen & C. Gotsman & K. Hormann / A Complex View of Barycentric Mappings

complex barycentric mappings,
n

/ n
g(z) = ∑ γ j (z)s j (z) ∑ γ j (z).
j=1

(14)

j=1

Thus, any complex barycentric mapping is a (normalized)
blending of the linear edge-to-edge mappings s j . Conversely, any choice of weight functions γ j in (14) gives
a complex barycentric mapping. However, care should be
taken to avoid a vanishing denominator Γ(z) = ∑nj=1 γ j (z),
at least for all z ∈ Ω or even all z ∈ ℂ, so that the mapping is guaranteed to be well-defined. In particular, the
weight vector γ = (γ1 , . . . , γn ) must not be a multiple of
γ¯ in (11). A simple choice that guarantees Γ(z) ∕= 0 is to
set γ j (z) = 1 for all j, but the resulting global similarity
g(z) = ∑nj=1 s j (z)/n does not satisfy any interpolation constraints, see Figure 3 (b).
We are now ready to state the full expressive power of
complex barycentric mappings.
Theorem 4 Any complex function h : ℂ → ℂ can be written
as a complex barycentric mapping, as long as source and
target polygon are not similar to each other.
ˆ are not similar to each
Proof First assume that Ω and Ω
other. Then there exists some index j such that the two
similarity transforms s j−1 and s j are not the same. Letting
γ j−1 = s j − h, γ j = h − s j−1 , and γk = 0 for k ∕= j − 1, j
in (14) then gives
g=

(s j − h)s j−1 + (h − s j−1 )s j
h(−s j−1 + s j )
= h,
=
(s j − h) + (h − s j−1 )
s j − s j−1

for any complex function h.
ˆ are similar to each other, then all
However, if Ω and Ω
s j are the same and the previous construction is not possible. In fact, it follows from the reproduction property of
complex barycentric mappings that g is the unique complex
affine function that maps z j to zˆ j for all j = 1, . . . , n. Hence,
for any other complex function h it is impossible to express
it as a barycentric mapping in this situation.
Of course, the statement of Theorem 4 is purely theoretical, because the coordinates depend on the target polygon,
and more importantly, because in practical applications we
do not want to reproduce a specific complex function but
rather aim for a general and simple choice of weight functions γ j that provides favourable barycentric mappings.
3.1. Interpolation conditions
The key to choosing weight functions γ j is understanding
the influence that various properties of γ j have on the resulting mapping. For example, since the similarities s j are
holomorphic functions, g is holomorphic if the γ j are holomorphic, too. This is the case for the Cauchy–Green coordinates [WBCG09], where γ j = log(r j+1 /r j ).
Another desirable property is the interpolation of the target polygon. While real-valued barycentric maps usually

have this feature built-in, the known complex-valued mappings [WBCG09, WG10] generally do not even interpolate
the target vertices. Hence, when designing new complex
mappings, the following sufficient conditions on the weight
functions γ j can be helpful.
Theorem 5 The complex barycentric mapping g in (14) interpolates the j-th target vertex, if
(1)
(2)

lim ∣γ j−1 (z) + γ j (z)∣ = ∞,

z→z j

lim ∣γk (z)r j (z)∣ < ∞,

k = j − 1, j,

lim ∣γk (z)∣ < ∞,

k ∕= j − 1, j.

z→z j

(3)

z→z j

Proof It follows directly from the third condition that
limz→z j c˜k (z) is finite for k ∕= j − 1, j, j + 1, so let us focus
on the remaining three cases. For k = j − 1 we have
(
)
r j−2 (z)
r j (z)
lim c˜ j−1 (z) = lim γ j−1 (z)
− γ j−2 (z)
z→z j
z→z j
e j−1
e j−2
−
z
z
1
j
j−2
lim γ j−1 (z)r j (z) −
lim γ j−2 (z),
=
e j−1 z→z j
e j−2 z→z j
which is finite due to the second and third condition, and
similarly for k = j + 1. Finally, by the first condition,
lim ∣c˜ j (z)∣ = lim γ j (z)

z→z j

z→z j

z j+1 − z
z j−1 − z
− γ j−1 (z)
ej
e j−1

= lim ∣γ j (z) + γ j−1 (z)∣ = ∞.
z→z j

As in the real case, this yields limz→z j c˜k (z)/c˜ j (z) = δ jk (see
e.g. [ZS08, Chapter 2.6]), so
lim ck (z) = lim

z→z j

z→z j

c˜k (z)
∑nl=1 c˜l (z)

= lim

z→z j

c˜k (z)/c˜ j (z)
n
∑l=1 c˜l (z)/c˜ j (z)

= lim c˜k (z)/c˜ j (z) = δ jk
z→z j

and g(z j ) = limz→z j ∑nk=1 ck (z)ˆzk = zˆ j , as required.
Note that the statement of the theorem also holds if γk r j
for k = j − 1, j is discontinuous at z j , as long as the limit
exists and is finite for any direction in which z approaches
z j , that is, limt→0+ ∣(γk r j )(z j + tζ)∣ < ∞ for any ζ ∈ ℂ.
Let us now turn to a similar set of sufficient conditions
that guarantee the interpolation of the target edges.
Theorem 6 Let η j (t) = (1 − t)z j + tz j+1 with t ∈ (0, 1) be
a point on the (open) source edge (z j , z j+1 ) and let ηˆ j (t) be
its image under s j ,
ηˆ j (t) = s j (η j (t)) = (1 − t)ˆz j + t zˆ j+1 .
The complex barycentric mapping g in (14) interpolates the
j-th (open) target edge, if
lim ∣γ j (z)∣ = ∞

z→η j (t)

and

lim ∣γk (z)∣ < ∞,

k ∕= j

z→η j (t)

for all t ∈ (0, 1).
c 2011 The Author(s)
⃝
c 2011 The Eurographics Association and Blackwell Publishing Ltd.
⃝

O. Weber & M. Ben-Chen & C. Gotsman & K. Hormann / A Complex View of Barycentric Mappings

Proof A similar reasoning as in the proof of Theorem 5
shows that limz→η j γk (z)/γ j (z) = δ jk , hence
/ n
n
g(η j ) = lim ∑ γk (z)sk (z) ∑ γk (z)
z→η j

= lim

z→η j

k=1
n (

∑

k=1

/ n
)
)
(
γk (z)/γ j (z) sk (z) ∑ γk (z)/γ j (z)

k=1

k=1

= lim s j (z) = s j (η j ),
z→η j

as required.
4. Designing new complex barycentric mappings
We now use our insight into the structure of complex
barycentric mappings from the previous sections to derive
some recipes for synthesizing new types of these mappings
having desirable properties.

Several authors [JSWD05, LBS06, SJW07] have shown that
three-point real-valued coordinates can also be expressed as
dual/primal ratios involving the primal edge r j and a dual
edge d j between two dual vertices, d j = w j − w j−1 (there
is one dual vertex w j per triangle [z, z j , z j+1 ] in Figure 2),
when considered as complex numbers,
c˜ j = i

4.2. Holomorphic vertex-interpolating mapping
As Mercat [Mer08] points out, complex dual/primal ratios
arise in (15) when the primal and dual edges are not orthogonal. An interesting example is obtained by taking the dual
vertex of [z, z j , z j+1 ] to be its barycentre (z + z j + z j+1 )/3,
or equivalently, after translating everything by −z, to be
w j = (r j +r j+1 )/3. Applying (16) and dividing by i/3 yields
r j+1
rj
−
.
(17)
γj =
rj
r j+1
Since these γ j are holomorphic, the result is a holomorphic
map that interpolates the vertices (but not the edges), according to Theorem 5 and as shown in Figures 1 (c) and 3 (c). As
)
)
(
(
n
n
r j+1
rj
Im(Γ) = ∑ Im
− ∑ Im
rj
r j+1
j=1
j=1
n

=

∑

Im(r j+1 r j )

j=1
n

4.1. Primal/dual vertices

dj
.
rj

= 2 ∑ Aj
j=1

∑

Im(r j r j+1 )

∣r j+1 ∣2
)
1
1
,
+
∣r j ∣2 ∣r j+1 ∣2

∣r j ∣
(

2

n

−

j=1

we conclude that Γ(z) ∕= 0 if z lies in the kernel of Ω, hence
the holomorphic barycentric mapping with weights in (17)
is guaranteed to be well-defined for any convex source polygon. But it is possible to create examples with non-convex
Ω and Γ(z) = 0 for some z ∈ Ω.

(15)

Since r j and d j are always orthogonal for the three-point
coordinates, this ratio is pure real. Combining (10) and (15)
yields the following general relationship between w j and γ j ,
r j r j+1
ej
γj = iwj
⇐⇒ w j = −i γ j
.
(16)
r j r j+1
ej
Note that there is a single (translational) degree of freedom
in choosing the w j ’s, which corresponds exactly to the degree of freedom described by (11) in choosing γ j . This general expression for γ j makes sense since the weight of the
similarity s j should be proportional to the length of e j (a
longer edge has larger influence) and inversely proportional
to the distances of z from z j and z j+1 , that is, to the lengths
of r j and r j+1 .
The barycentric mapping is thus determined by the dual
vertices w j which “represent” the triangles [z, z j , z j+1 ]. It
is well known that for the discrete harmonic coordinates,
w j is the circumcenter of [z, z j , z j+1 ], which is a vertex
of the Voronoi cell of the site z. A generalized version
of these coordinates may be obtained by resorting to the
generalized Voronoi diagram (also known as a power diagram) [MMdGD11]. For this, a disc D j of radius R j is centered at each vertex z j , and w j is then the circumcenter of the
r
triangle [z, y j , y j+1 ], where y j = z j − R j ∣r j ∣ is the intersecj
tion of D j and the ray from z j through z. The simple Voronoi
cell is just the special case where all R j = 0. Note that even
in the general case the coordinates in (15) are pure real.
c 2011 The Author(s)
⃝
c 2011 The Eurographics Association and Blackwell Publishing Ltd.
⃝

1539

4.3. Non-holomorphic interpolating mappings
All the complex mappings presented so far were either holomorphic or real-valued. Using Theorems 5 and 6 we can design non-holomorphic mappings, which are not real-valued,
yet interpolate the target polygon. Our primary goal is not
to advocate the use of these specific mappings, but rather to
demonstrate how to design “tailor-made” coordinates with
desirable properties.
The common starting point for many real-valued coordinates are the weight functions 1/∣r j ∣, as the most basic
requirement is that the influence of a vertex decays as the
distance to that vertex increases. To fulfill the requirements
of Theorem 5, we start off with γvj = 1/∣r j r j+1 ∣, so that
γvj grows to infinity as z approaches either endpoint of the
edge [z j , z j+1 ]. As we additionally require interpolation on
the edges, we define γej = 1/(π − θ j ), where θ j (z) is the
signed angle of the triangle [z, z j , z j+1 ] at z (see Figure 2).
Since θ j (z) converges to π as z approaches any point on the
open edge (z j , z j+1 ) from inside Ω, this γej satisfies the conditions of Theorem 6. Finally, we combine these two quantities, multiply them with the factor ∣e j ∣ to give larger weights
to longer edges, and obtain the Made-to-order Angle Guided
Interpolating Coordinates (or simply MAGIC)
γ j = ∣e j ∣γvj γej =

ej
1
,
r j r j+1 π − Im(log(r j+1 /r j ))

where we used the fact that θ j = Im(log(r j+1 /r j )).

(18)

1540

O. Weber & M. Ben-Chen & C. Gotsman & K. Hormann / A Complex View of Barycentric Mappings

(a)

(c)

(b)

Figure 4: Comparison of the real-valued mean value mapping (a), our complex MAGIC mapping (b), and their average (c).

These coordinates have some interesting properties. First,
it is clear that all γ j (z) are positive for any z not on the boundary of Ω, because θ j (z) ∈ (−π, π). Therefore, their sum Γ(z)
is also positive and the coordinates are well-defined. Second,
it is not too hard to show that the γ j in (18) satisfy the conditions of Theorems 5 and 6, hence the resulting barycentric mapping interpolates the target polygon. However, we
should note that θ j (z) converges to −π as z approaches the
open edge (z j , z j+1 ) from outside Ω, hence neither θ j nor γ j
are continuous across the edge [z j , z j+1 ]. As a consequence,
MAGIC mappings should be used for the interior of Ω only.
Figure 4 shows a comparison between mean value and
MAGIC mappings for a non-convex source polygon. We observe that vertices that are reflex (concave) in the source
polygon tend to repel in mean value mappings, whereas
these vertices act as attractors in MAGIC mappings. A possible explanation is that mean value coordinates divide by
the signed area of the triangle [z, z j , z j+1 ], yielding negative
weights in concave regions. In contrast, MAGIC weights are
always positive.
We found that it is often beneficial to mediate between
both effects and that a simple average of mean value
and MAGIC mappings (i.e., averaging the respective γ j
weights) yields very pleasing deformations as shown in Figure 4 (c). The resulting mapping is well-defined because Γ(z)
is positive both for MAGIC and for mean value coordinates [HF06], hence it is also positive for any convex combination of the two.

The simplest way to design such a mapping s˜ j is to interpret σ j as a complex polynomial and let
s˜ j = zˆ j + (ˆz j+1 − zˆ j )σ j (−r j /e j ).

(20)

This choice of s˜ j clearly satisfies condition (19), because any
point z = ((1 − t)z j + tz j+1 ) on the edge [z j , z j+1 ] satisfies
r j (z) = z j − z = z j − (1 − t)z j − tz j+1 = −te j ,

(21)

and it has the advantage of being holomorphic, so that blending these s˜ j with holomorphic weight functions γ j guarantees that the resulting barycentric mapping
/ n
n
g(z)
˜ = ∑ γ j (z)s˜ j (z) ∑ γ j (z)
j=1

j=1

is also holomorphic.
The idea of quadratic speed functions along the edges also
appeared in the construction of generalized Cauchy coordinates by Weber and Gotsman [WG10, Section 5.2], but in a
slightly different way. If we use, on the one hand, quadratic
speed functions σ j (t) = t + 4α j (1 − t)t and the Cauchy–
Green weight functions γ j = log(r j+1 /r j ) in our approach,
and on the other hand the images of the source edge midpoints,
zˆcj = s˜ j ((z j + z j+1 )/2) = (1/2 − α j )ˆz j + (1/2 + α j )ˆz j+1 ,
as the additional constraints in the continuous case of generalized Cauchy coordinates, then the two resulting mappings
differ only by the term
n

n 2α
αj
j
(ˆz j + zˆ j+1 ) − ∑
s j.
j=1 π i
j=1 π i

∑

4.4. Polynomial edge-to-edge mappings
In Section 3 we derived the normal form (14) of complex
barycentric mappings as a blend of edge-to-edge mappings.
A natural extension of this construction seems to be the generalization of these linear mappings s j to higher-order polynomial mappings, hence changing the “speed” along the target edge [ˆz j , zˆ j+1 ], while maintaining interpolation along the
edge. That is, we replace s j by a mapping s˜ j that satisfies
s˜ j ((1 − t)z j + tz j+1 ) = (1 − σ j (t))ˆz j + σ j (t)ˆz j+1

(19)

for t ∈ [0, 1], where σ j : ℝ → ℝ is a polynomial speed function of some degree d ≥ 1 with σ j (0) = 0 and σ j (1) = 1.
Moreover, σ j should be monotonic on the interval [0, 1], in
order to maintain bijectivity along the edge.

(22)

The derivation of this result is simple but rather lengthy
and omitted here. A comparison of the two mappings is
shown in Figure 5 (a,b). Both mappings do not really pick
up the prescribed speed along the boundary very well. For
our weighted quadratic edge-to-edge mappings (b), the three
constraints (in this example, α j ∕= 0 for the top horizontal
and the two leftmost vertical edges) even have an undesirable global shifting effect, which is explained mainly by the
first term in (22); whereas the second term in (22) explains
the slight shape difference of the two results.
One intrinsic problem of using quadratic speed functions
σ is that they are not bijective on ℝ, and so the resulting quadratic edge-to-edge mapping s˜ folds back onto itself,
c 2011 The Author(s)
⃝
c 2011 The Eurographics Association and Blackwell Publishing Ltd.
⃝

1541

O. Weber & M. Ben-Chen & C. Gotsman & K. Hormann / A Complex View of Barycentric Mappings

(a)

(b)

(c)

Figure 5: Comparison of the complex barycentric mappings based on continuous generalized Cauchy coordinates (a), weighted
holomorphic (b) and non-holomorphic (c) quadratic edge-to-edge mappings.

(a)

(b)

(a)

(b)

Figure 6: Holomorphic (a) and non-holomorphic (b) edgeto-edge mapping s˜ for the speed function σ(t) = t 2 (edge
direction is from top to bottom).

Figure 7: Holomorphic (a) and non-holomorphic (b) edgeto-edge mapping s˜ for the speed function σ(t) = (t + 2t 3 )/3
(edge direction is from top to bottom).

even along the line L defined by the target edge as illustrated
in Figure 6 (a). This problem can be resolved by resorting
to globally monotonic speed functions with odd degree d.
But although they guarantee s˜ to be bijective on L, global bijectivity cannot be achieved this way. Often the singularities
of s˜ appear rather close to the target edge, as shown in Figure 7 (a), which in turn can have undesirable effects on the
overall barycentric mapping.

edge [ˆz j , zˆ j+1 ]. Figure 8 shows an example with the mean
value weights from (13). For linear s j , the mapping is the
classical mean value mapping and not bijective in this case.
However, the mapping can be made bijective by using cubic s˜ j from (20) to decrease the interpolation speed around
the concave target vertex and the vertex diagonally across.
Whether or not this is possible for any source and target
polygon is an interesting question for future research.

To overcome the latter problem, another option is to extend the polynomial behaviour along the edge orthogonally
into the complex plane and let
[ (
)
]
s˜ j = zˆ j + (ˆz j+1 − zˆ j ) σ j Re(−r j /e j ) + Im(−r j /e j )i .
Again, it follows from (21) that these s˜ j satisfy (19). In contrast to the choice in (20), these edge-to-edge mappings are
not holomorphic, but they have the advantage of being bijective as long as σ j is bijective; see Figures 6 (b) and 7 (b).
Using these non-holomorphic edge-to-edge mappings in the
example above, we observe in Figure 5 (c) that the resulting
barycentric mapping does a much better job in picking up
the prescribed boundary behaviour, at the price of not being
holomorphic.
In general, the extra degrees of freedom in the overall
complex barycentric mapping that we gain by considering
polynomial instead of linear edge-to-edge mappings may be
used to improve the quality of the mapping, for example,
to make it more conformal or bijective. We implemented
an interactive tool where the user controls each polynomial
mapping s˜ j by specifying the images of d − 1 uniformly distributed points from the source edge [z j , z j+1 ] on the target
c 2011 The Author(s)
⃝
c 2011 The Eurographics Association and Blackwell Publishing Ltd.
⃝

5. Conclusion
Complex barycentric mappings provide a flexible tool for
designing planar deformations. They are appealing for interactive applications like image deformation because of two
reasons. On the one hand, they can be evaluated efficiently
by the formulas (8) or (14), on the other hand it is relatively
easy to realize a variety of properties, including interpolation
constraints and angle-preservation.

(a)

(b)

Figure 8: Comparison of the classical mean value mapping
(a), which interpolates edges linearly, and a modified complex version based on cubic edge-to-edge mappings (with the
same mean value γ j ) (b).

1542

O. Weber & M. Ben-Chen & C. Gotsman & K. Hormann / A Complex View of Barycentric Mappings

One key insight of our research is that the edge-based normal form (14) has a number of advantages over the classical vertex-based form (8). First, it automatically takes care
of the affine precision property. Second, we show in Theorem 1 that barycentric mappings based on classical realvalued coordinates can easily be expressed in the complex
form (14). This allows one to consider blends between them
and other purely complex barycentric mappings, which in
turn can improve the quality of the mapping significantly as
shown in Figure 4 (c). Third, both vertex and edge interpolation constraints can easily be modelled into the weight functions γ j by respecting the sufficient conditions in Theorems 5
and 6, as shown in Sections 4.2 and 4.3. Finally, the normal
form (14) opens up the way to further generalize complex
barycentric mappings by modifying the edge-to-edge mappings s j as demonstrated in Section 4.4. This new flexibility
can be used to create bijective interpolating mappings, which
so far could be achieved only with Wachspress mappings between convex source and target polygons [FK10].
So far, we explored the advantages of blending polynomial edge-to-edge mappings only interactively, but we believe that the full potential of this approach will crop up
when the additional degrees of freedom are determined by
minimizing an appropriate energy that measures the overall conformality or bijectivity of the mapping. Another interesting direction that we consider worth exploring is the
connection of this approach to moving least squares coordinates [MS10], which are similar in spirit, as they also allow
for polynomial behaviour along the edges.

Acknowledgements
O. Weber was partially supported by NSF IIS grant 0905502.
M. Ben-Chen was partially supported by the Weizmann
Institute Women in Science Award, NSF FODAVA grant
0808515, and NSF IIS grant 0914833. We would like to
thank the anonymous reviewers for their valuable comments
that helped improve the final version of this paper considerably.

References
[EDD∗ 95] E CK M., D E ROSE T., D UCHAMP T., H OPPE H.,
L OUNSBERY M., S TUETZLE W.: Multiresolution analysis of
arbitrary meshes. In Proceedings of SIGGRAPH (Los Angeles,
Aug. 1995), pp. 173–182. 2
[FHK06] F LOATER M. S., H ORMANN K., K ÓS G.: A general
construction of barycentric coordinates over convex polygons.
Advances in Computational Mathematics 24, 1–4 (Jan. 2006),
311–331. 2, 3
[FK10] F LOATER M. S., KOSINKA J.: On the injectivity of
Wachspress and mean value mappings between convex polygons.
Advances in Computational Mathematics 32, 2 (Feb. 2010), 163–
174. 10
[Flo03] F LOATER M. S.: Mean value coordinates. Computer
Aided Geometric Design 20, 1 (Mar. 2003), 19–27. 2

[HF06] H ORMANN K., F LOATER M. S.: Mean value coordinates
for arbitrary planar polygons. ACM Transactions on Graphics 25,
4 (Oct. 2006), 1424–1441. 2, 8
[HS08] H ORMANN K., S UKUMAR N.: Maximum entropy coordinates for arbitrary polytopes. Computer Graphics Forum 27, 5
(July 2008), 1513–1520. Proceedings of SGP. 2
[JLW07] J U T., L IEPA P., WARREN J.: A general geometric construction of coordinates in a convex simplicial polytope. Computer Aided Geometric Design 24, 3 (Apr. 2007), 161–178. 2
[JMD∗ 07] J OSHI P., M EYER M., D E ROSE T., G REEN B.,
S ANOCKI T.: Harmonic coordinates for character articulation.
ACM Transactions on Graphics 26, 3 (July 2007), Article 71, 9
pages. Proceedings of SIGGRAPH. 2
[JSWD05] J U T., S CHAEFER S., WARREN J., D ESBRUN M.: A
geometric construction of coordinates for convex polyhedra using polar duals. In Proceedings of the Third Symposium on Geometry Processing (Wien, July 2005), pp. 181–186. 7
[LBS06] L ANGER T., B ELYAEV A., S EIDEL H.-P.: Spherical
barycentric coordinates. In Proceedings of the Fourth Symposium
on Geometry Processing (Cagliari, June 2006), pp. 81–88. 7
[LKCOL07] L IPMAN Y., KOPF J., C OHEN -O R D., L EVIN D.:
GPU-assisted positive mean value coordinates for mesh deformations. In Proceedings of the Fifth Symposium on Geometry
Processing (Barcelona, July 2007), pp. 117–123. 2
[LLCO08] L IPMAN Y., L EVIN D., C OHEN -O R D.: Green coordinates. ACM Transactions on Graphics 27, 3 (Aug. 2008),
Article 78, 10 pages. Proceedings of SIGGRAPH. 2
[Mer08] M ERCAT C.: Discrete complex structure on surfel surfaces. In Discrete Geometry for Computer Imagery, Coeurjolly
D., Sivignon I., Tougne L., Dupont F., (Eds.), vol. 4992 of Lecture Notes in Computer Science. Springer, 2008, pp. 153–164.
7
[MLBD02] M EYER M., L EE H., BARR A., D ESBRUN M.: Generalized barycentric coordinates on irregular polygons. Journal
of Graphics Tools 7, 1 (2002), 13–22. 2
[MMdGD11] M ULLEN P., M EMARI P., DE G OES F., D ESBRUN
M.: HOT: Hodge-optimized triangulations. ACM Transactions
on Graphics 30, 4 (Aug. 2011). Proceedings of SIGGRAPH. 7
[MS10] M ANSON J., S CHAEFER S.: Moving least squares coordinates. Computer Graphics Forum 29, 5 (July 2010), 1517–
1524. Proceedings of SGP. 10
[PP93] P INKALL U., P OLTHIER K.: Computing discrete minimal
surfaces and their conjugates. Experimental Mathematics 2, 1
(1993), 15–36. 2
[SJW07] S CHAEFER S., J U T., WARREN J.: A unified, integral
construction for coordinates over closed curves. Computer Aided
Geometric Design 24, 8–9 (Nov.–Dec. 2007), 481–493. 7
[Wac75] WACHSPRESS E. L.: A Rational Finite Element Basis,
vol. 114 of Mathematics in Science and Engineering. Academic
Press, New York, 1975. 2
[WBCG09] W EBER O., B EN -C HEN M., G OTSMAN C.: Complex barycentric coordinates with applications to planar shape
deformation. Computer Graphics Forum 28, 2 (Apr. 2009), 587–
597. Proceedings of Eurographics. 2, 3, 6
[WG10] W EBER O., G OTSMAN C.: Controllable conformal
maps for shape deformation and interpolation. ACM Transactions on Graphics 29, 4 (July 2010), Article 78, 11 pages. Proceedings of SIGGRAPH. 6, 8
[ZS08] Z ILL D., S HANAHAN P.: A First Course in Complex
Analysis With Applications. Jones and Bartlett Publishers, 2008.
6
c 2011 The Author(s)
⃝
c 2011 The Eurographics Association and Blackwell Publishing Ltd.
⃝


DOI: 10.1111/j.1467-8659.2011.01933.x
Eurographics / IEEE Symposium on Visualization 2011 (EuroVis 2011)
H. Hauser, H. Pfister, and J. J. van Wijk
(Guest Editors)

Volume 30 (2011), Number 3

Topological Features in
2D Symmetric Higher-Order Tensor Fields
T. Schultz
Computation Institute, University of Chicago, USA — t.schultz@uchicago.edu

Abstract
The topological structure of scalar, vector, and second-order tensor fields provides an important mathematical
basis for data analysis and visualization. In this paper, we extend this framework towards higher-order tensors.
First, we establish formal uniqueness properties for a geometrically constrained tensor decomposition. This allows
us to define and visualize topological structures in symmetric tensor fields of orders three and four. We clarify that
in 2D, degeneracies occur at isolated points, regardless of tensor order. However, for orders higher than two,
they are no longer equivalent to isotropic tensors, and their fractional Poincaré index prevents us from deriving
continuous vector fields from the tensor decomposition. Instead, sorting the terms by magnitude leads to a new
type of feature, lines along which the resulting vector fields are discontinuous. We propose algorithms to extract
these features and present results on higher-order derivatives and higher-order structure tensors.
Categories and Subject Descriptors (according to ACM CCS): I.4.7 [Image Processing and Computer Vision]: Feature Measurement—Invariants

1. Introduction
Feature extraction is a common strategy to deal with the
large and complex datasets generated by modern scientific
experiments and simulations. In visualization, topological
methods are an established way of finding geometric features such as structurally important points, curves, or surfaces in spatial data. As a preprocess for interactive visualization, this reduces the amount of information the rendering pipeline and the user need to handle. For the scientist,
the features might be the objects of ultimate interest, or they
may guide subsequent analysis with other tools.
Topological methods are most widely used to visualize
scalar [BPS98] and vector fields [HH89, PVH∗ 03]. Topological features have also been extracted from second-order
tensor fields, both symmetric [DH94,TSH01,ZPP05,STS07,
SNAHH11] and asymmetric [ZP05, ZYLL09]. However, we
are not aware of any attempts to define topological features in higher-order tensor fields, which arise in applications like diffusion MRI [ÖM03, HS05, SS08], computer vision [SWS09], or when considering the higher-order derivatives of any smooth scalar field.
This gap in the visualization literature is unfortunate,
since problems such as high information density, which have
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

contributed to the popularity of topological methods in vector and second-order tensor data, are even more grave in
higher-order tensor fields. We believe that the lack of suitable tools for visualization contributes to the fact that higherorder derivatives are used only rarely and higher-order tensors are picked up only reluctantly as a more general mathematical model. Therefore, it is the goal of this paper to explore topological features in higher-order tensor fields.
For this initial study, we consider steady symmetric 2D
tensor fields of orders three and four. We formally characterize the uniqueness properties of a constrained higher-order
tensor decomposition and use it to define vector fields that
hold all the information from the tensors. Topological features in those fields include degenerate points and lines along
which the fields are discontinuous, a novel type of feature
that is not present in second-order tensor topology. Experiments substantiate the applicability of the resulting algorithms for feature extraction.
2. Background and Related Work
2.1. General Notions
We define a field to be a Ck continuous function f : D → R
on a compact domain D ⊂ Rd . The exact order of differen-

842

T. Schultz / Topological Features in 2D Symmetric Higher-Order Tensor Fields

tiability k will be assumed as needed. The codomain R of a
scalar field is R; for a vector field, it is Rr ; for a symmetric second-order tensor field, it is Rr×r ; higher-order tensor fields are defined accordingly (e.g., Rr×r×r in the thirdorder case). In all our examples, the dimensions in the domain and codomain agree, r = d = 2.
Topological analysis often focuses on generic properties.
Formally, a property is generic in some topological space X
iff there exists an open dense subset U ⊂ X that has the desired property. In practice, this guarantees that the property
is preserved under small perturbations, and that any element
of X that does not have the property can be approximated
arbitrarily closely by another element that does.
2.2. Vector Field Topology
The topological analysis of a steady vector field f(x) is based
on its streamlines, the trajectories of massless particles that
are advected by f. Streamlines stop when f(x) = 0. When
the dimensions of the domain and the codomain of a vector
field agree and in the absence of constraints (such as noslip boundaries), this generically happens at isolated critical
points. Based on the vector field Jacobian, they are classified
as saddles, attracting or repelling nodes or foci, or centers
[HH89]. In 2D, additional points of interest occur near walls
(attachment and detachment nodes) and at the boundary of
the domain (incoming and outgoing points).
The topological skeleton of a 2D vector field consists of
these isolated points, the streamlines that connect to saddles
(separatrices), and periodic orbits. It partitions the domain
of the field into regions of uniform asymptotic behavior, i.e.,
all streamlines in the same region start and end in a common
critical point, closed streamline, or segment of a boundary.
2.3. Second-Order Tensor Field Topology
An n × n symmetric matrix T can be written in terms of n
real eigenvalues λi and orthonormal eigenvectors vi :
n

T=

∑ λi vi ⊗ vi .

(1)

i=1

Based on this spectral decomposition of a tensor field
T(x), we may define n eigenvector fields v¯ i (x) = λi (x)vi (x)
that contain all the information of the original tensor field.
The orientation in eigenvector fields is undefined, v¯ i and −¯vi
are equivalent, but tangent curves (hyperstreamline trajectories [DH93]) can still be integrated.
In the framework of Delmarcelle and Hesselink [DH94],
tensor field topology is defined to be the topology of the
derived eigenvector fields. The locations x at which hyperstreamlines in v¯ i (x) stop are places in which λi (x) = λ j (x)
for at least one j = i. In this case, the spectral decomposition is not unique, since vi and v j can be replaced by any orthonormal pair v˜ i and v˜ j that spans the same space. In unconstrained 2D data, this generically happens at isolated points,

which are called degenerate points and take the place of critical points in vector field topology. Zheng et al. [ZPP05] have
transferred this framework to 3D, where degeneracies form
structurally stable features lines. Our work presents a different generalization, to 2D higher-order tensor fields.

2.4. Higher-Order Tensors
The coefficients ti1 i2 ...i of an order- tensor T with respect
to some basis form a multi-way array with indices, each
ranging from 1 to the dimension of the tensor. The coefficients of a symmetric tensor are invariant under any index
permutation σ: ti1 i2 ...i = tiσ(1) iσ(2) ...iσ( ) . This greatly reduces
the number of free parameters in the tensor, from 2 to + 1
for a two-dimensional tensor. When writing out tensor coefficients, we will only consider these non-redundant entries.
In recent years, applications and decompositions of
higher-order tensors have been an active topic of research.
An excellent introduction is given by Kolda and Bader
[KB09]. Within the visualization community, there is still
relatively little work on higher-order tensors. Hlawitschka
and Scheuermann [HS05] define a higher-order analog of
hyperstreamlines; Schultz and Seidel [SS08] use low-rank
tensor approximation to achieve more accurate fiber estimates in diffusion MRI. From fourth-order tensors that occur
in solid mechanics, Neeman et al. [NBJ∗ 08] extract secondorder tensors that can be visualized with traditional tensor
glyphs. Schultz and Kindlmann [SK10] present a sharpened
glyph for symmetric higher-order tensors. None of these previous works have followed a feature-based visualization approach, which is the main focus of our paper.
Palacios and Zhang [PZ07] have used symmetric 2D
order- tensor fields to represent -way rotational symmetries, which play a role in remeshing and pen-and-ink surface sketching. Even though the authors provide a topological analysis of singularities and separatrices, their analysis is specific to rotational symmetries, which form a twodimensional linear subspace of the +1-dimensional higherorder tensor space. Therefore, these existing results do not
carry over to the more general case discussed in our paper.

3. Higher-Order Tensor Field Topology
We will generalize vector field topology to higher order tensors by deriving a set of vector fields that contain all the information from the tensors, and considering their topology.

3.1. The Canonical Decomposition
A symmetric rank-1 matrix is defined as the outer product
v ⊗ v of some vector v with itself. In analogy, a symmetric
rank-1 order- tensor is defined as the -fold outer product,
which we denote by v⊗ . Any symmetric tensor T can be
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

843

T. Schultz / Topological Features in 2D Symmetric Higher-Order Tensor Fields

timization techniques. The definition of topological features
in higher-order tensor fields requires an analytical solution.

written as a sum of symmetric rank-1 terms,
R

T =

∑ λi v⊗i ,

(2)

i=1

where we assume that all vi are normalized and scaling is
performed through the λi [CGLM08]. The symmetric tensor
rank is defined as the smallest integer R for which an exact
decomposition is possible. Eq. (2) is known as the symmetric
outer product decomposition, or the symmetric canonical decomposition. In an alternative, but equivalent formulation, it
has been studied in considerable depth by Reznick [Rez92].
3.2. A Geometrically Constrained Decomposition
Even though Eq. (2) can be regarded as a generalization of
the spectral decomposition, it does not define vector fields
suitable for topological analysis, since the result may not be
unique. In fact, there is a one-dimensional fiber of solutions
for all even-order 2D tensors [CM96]. This is also true for
second-order tensors; the only reason why the spectral decomposition in Eq. (1) is generically unique is the orthogonality constraint on the vi .
Kyrgyzov and Erdogmus [KE10] argue that a natural relaxation of orthogonality for n two-dimensional vectors is
a fixed spacing of π/n between neighbors. Consequently,
they propose to decompose symmetric order- tensors with
a fixed frame of rank-1 terms:
T =

∑ λi v⊗i

with vi =

i=1

cos(−θ + (i − 1)π/ )
. (3)
sin(−θ + (i − 1)π/ )

This geometrically constrained decomposition has + 1
degrees of freedom: in the λi , and one more in the angle θ, which determines the joint rotation of the vi . Since
this matches the number of free parameters in the symmetric
tensor T , Kyrgyzov [Kyr10] expresses the hope that Eq. (3)
might offer a one-to-one reparameterization. However, an
equal number of parameters is not a sufficient condition for
uniqueness, and no formal proof has been presented.
Two key contributions of our work are a proof that, at
least for orders = 3 and = 4, this constrained decomposition always exists, and a full characterization of the cases
in which it is unique. Our analysis reveals that some tensors T can be written in the form of Eq. (3) regardless of
the choice of θ. Since these tensors do not possess a unique
constrained decomposition, we treat them as a higher-order
analog of degenerate tensors in second-order fields, which
provide the geometric features of central interest in topological visualization: Degenerate points in 2D [DH94] and
degenerate lines in 3D [ZPP05].
3.3. Analytical Solution
In order to find the rotation θ in their constrained decomposition, Kyrgyzov and Erdogmus [KE10] explore various opc 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Our strategy for its derivation is analogous to the Jacobi method for matrix diagonalization, which is explained
briefly in Section 3.3.1. We observe that when the angle θ in
Eq. (3) is known, the higher-order tensor can be written in
a special form. In analogy to the diagonal form of a secondorder tensor, it allows us to easily solve for the λi . We then
derive an analytical solution for the value of θ. Except for the
degenerate cases that will be used to define topological features, there are isolated solutions within θ ∈ (−π, π], corresponding to reorderings of the terms in Eq. (3). Our analysis
is for tensors of orders three and four, but we conjecture that
it carries over to 2D tensors of arbitrary order.
3.3.1. The Second-Order Case
When a symmetric second-order tensor T is written in a
basis that consists of its orthonormal eigenvectors (v1 =
(1, 0)T , v2 = (0, 1)T ), its coefficient matrix becomes diagonal, with the eigenvalues λi as diagonal elements:
T=

λ1
0

0
.
λ2

(4)

Given a general symmetric matrix with entries ti j , the angle θ by which the matrix needs to be rotated to attain diagonal form can be found by solving
tan(2θ)(t22 − t11 ) = 2t12

(5)

for θ [Jac46]. When T is isotropic (T = αI, where I is the
identity matrix), both sides of Eq. (5) are zero, regardless of
θ. This is the degenerate case on which topological visualization of 2D second-order tensor fields is founded.
3.3.2. The Third-Order Case
Let us now consider the coefficients of a symmetric thirdorder tensor when the first basis vector is aligned with the
vector v1 in the decomposition, i.e.,
v1 =

1
0

v2 =

1/2
3/4

v3 =

−1/2
.
3/4

(6)

Substituting into Eq. (3) gives the tensor coefficients
t111 = λ1 +

1
(λ2 − λ3 )
8

3
t122 = (λ2 − λ3 )
8

t112 =

3
(λ2 + λ3 )
64

t222 =

27
(λ2 + λ3 ) .
64

(7)

Eq. (7) reveals that when the tensor is in this canonical
frame, t112 and t222 are linearly dependent,
t222 − 3t112 = 0.

(8)

This condition is analogous to the diagonality constraint
in the second-order case (t12 = 0) in the sense that it allows

844

T. Schultz / Topological Features in 2D Symmetric Higher-Order Tensor Fields

for simple computation of the scalars λi in Eq. (3), by solving the linear system in Eq. (7):
1
4
4
λ1 = t111 − t122 λ2 = √ t112 + t122
3
3
3
4
4
λ3 = √ t112 − t122 .
3
3

(9)

In analogy to the Jacobi rotation in Eq. (5), we can compute the angle θ by which we need to rotate the third-order
tensor such that Eq. (8) holds. It is found by writing the
coefficients t˜112 and t˜222 of a rotated tensor T˜ in terms of
the rotation angle θ and the original coefficients of T . Let
c = cos(θ) and s = sin(θ). Then,
t˜112 = c2 st111 + (c3 − 2cs2 )t112 +
(s3 − 2c2 s)t122 + s2 ct222
3

2

2

(10)
3

t˜222 = s t111 + 3s ct112 + 3sc t122 + c t222 .
After substituting this into Eq. (8), algebraic simplification and trigonometric equalities yield
tan(3θ) (t111 − 3t122 ) = t222 − 3t112 .

(11)

Within θ ∈ (−π, π], this equation has three solutions. They
correspond to reorderings of λi and the corresponding vi , so
generically, the decomposition in Eq. (3) is indeed unique
up to these trivial permutations. After the rotation, the λi
are given by Eq. (9). The degeneracy that we will use for
topological visualization of third-order tensor fields occurs
when Eq. (11) holds for all θ. This happens iff
t111 − 3t122 = 0

and t222 − 3t112 = 0.

(12)

3.3.3. The Fourth-Order Case
The symmetric fourth-order case can be treated in full analogy to the previous section. When writing the tensor coefficients ti jkl in the basis whose first vector is aligned with v1 ,
we find the linear dependence
t1112 = t1222 ,

(13)

leading to the following formulas for λi :
λ1 = t1111 − t1122

λ2 = 2(t1122 + t1112 )

λ3 = t2222 − t1122

λ4 = 2(t1122 − t1112 ).

(14)

A Jacobi-like angle θ can be computed from
tan(4θ)(t1111 + t2222 − 6t1122 ) = 4(t1222 − t1112 ).

(15)

The four solutions within θ ∈ (−π, π] again correspond to
reorderings of the terms in Eq. (3), and a degenerate case, in
which θ is undetermined, occurs when
t1111 + t2222 − 6t1122 = 0

and t1222 − t1112 = 0.

(16)

3.4. Isotropic vs. Degenerate Tensors
Isotropic matrices, T = αI, exhibit rotational invariance:
Their quadratic form T (x) = xT Tx is constant for all unitlength x. Similarly, we call a higher-order tensor T isotropic
iff its homogeneous form T (x) = T · x (the -fold inner
product between T and x) is constant on the unit circle.
Since the homogeneous forms of odd-order tensors are
odd functions, T (−x) = −T (x), the only isotropic odd-order
tensors are zero tensors. Even-order isotropic tensors are obtained by setting all λi in Eq. (3) to some common value. It is
known [SWS09] that the average of T (x) over the unit circle
for an even-order rank-1 tensor T = λv⊗ equals
1
2π

T (x) dx = λ
x =1

( − 1)!!
,
!!

(17)

where the double factorial !! is defined via the recursion
!! = × ( − 2)!!, 1!! = 0!! = 1. It follows that we obtain
an even-order tensor I ( ) whose homogeneous form is unity
on the unit circle if we choose λi = ( − 2)!!/( − 1)!!. All
other isotropic tensors are multiples of it,
T = αI ( ) .

(18)

In Section 3.2, we have defined degenerate tensors as tensors T that can be written in the form of Eq. (3) for all
choices of θ. For matrices ( = 2), the isotropic and the degenerate case coincide. For = 3 and = 4, the definition
of degeneracy leads to two independent linear constraints,
i.e., it is fulfilled within a subspace of codimension two.
Isotropic tensors form a zero-dimensional (odd ) or a onedimensional (even ) proper subspace of these degenerate
tensors. Thus, a subspace of tensors with order > 2 are
degenerate, but not isotropic. For these tensors, Eq. (3) has
an indeterminacy that does not simply amount to reordering
the terms, and which is not caused by a lack of orientational
information in the tensor (i.e., isotropy).
Fig. 1 illustrates a third-order (a) and a fourth-order (b)
example of such a non-isotropic degeneracy. The respective
tensor is shown with a polar plot p(x) = |T (x)| x for x = 1,
where color indicates the sign of T (x) (red is positive, blue is
negative). We also show the scaled vectors v¯ i = λi vi , which
contain all information from the tensor. For even , the vectors are without orientation, i.e., v¯ i and −¯vi are equivalent,
so we show them as line segments (since all λi in our example are positive, we do not use color coding here).
From different choices of θ, we get different decompositions that all fulfill the constraint in Eq. (3), and all sum to the
same tensor, t111 = 0, t112 = 1, t122 = 0, t222 = 3 in (a) and
t1111 = 2, t1112 = 0, t1122 = 1, t1222 = 0, t2222 = 4 in (b). The
two-dimensional subspace of degenerate third-order tensors
is spanned by scaling and rotating the example in (a). In
addition to rotation and scaling, the three-dimensional subspace of degenerate fourth-order tensors accounts for adding
any multiple αI (4) of the identity.
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

845

T. Schultz / Topological Features in 2D Symmetric Higher-Order Tensor Fields

ering rotations of the frame of all vi in Eq. (3) as a whole.
The angle θ of the frame is given in Eq. (11) and Eq. (15) as
q tan( θ) = p,
(a) Possible decompositions of a degenerate third-order tensor.

(19)

where p and q are linear functions of tensor coefficients and,
by definition, p = q = 0 at the degeneracy.
In analogy to vector [HH89] and second-order tensor
topology [DH94], we investigate degeneracies based on a
first-order approximation of the tensor field. If we parameterize a circle around the degeneracy by ψ ∈ [0, 2π), the
first-order approximation of p and q can be written as

(b) Possible decompositions of a degenerate fourth-order tensor.

Figure 1: Even though these higher-order tensors are not
isotropic, they do not have a unique decomposition into geometrically constrained rank-1 terms. All other degenerate
cases can be derived from the examples visualized here.

3.5. Topological Features in Derived Vector Fields
3.5.1. Degenerate Points
We have seen above that, at least for ∈ {2, 3, 4}, degeneracies form a subspace A of codimension two within the
space of all 2D order- tensors. Due to its two spatial dimensions, the tensor field forms a 2D subspace B in the
same + 1-dimensional space, i.e., a space of codimension
− 1. Assuming non-degenerate configurations of the fields,
the occurance of a degeneracy within the 2D field lies in
the transversal intersection of A and B, so codim(A ∩ B) =
codim(A) + codim(B) = 2 + − 1 = + 1. Since this equals
the dimensionality of the full order- tensor space, we will
generically observe zero-dimensional degeneracies, degenerate points, regardless of the tensor order . This reasoning
is analogous to the proofs given by Damon [Dam98] and by
Zheng et al. [ZPP05] for the fact that degeneracies in secondorder 3D tensor fields form lines; we refer to these papers for
a more formal treatment of transversal intersections.
Even-order isotropic tensors form a subspace of codimension . By the same argument, their dimensionality in order2D tensor fields is 2 − . This means that generically, they
only occur in second-order fields, where they coincide with
degenerate points. If they occur in the higher-order case, they
can be transformed into a non-isotropic degeneracy by an arbitrarily small perturbation.
3.5.2. Poincaré Index of Degenerate Points
An important property of a critical point in a vector field
v(x) is its Poincaré index, defined as the number of counterclockwise revolutions of the vector v(x), as x moves in counterclockwise direction along a closed curve that contains the
critical point in question, but no other degeneracy.
We adapt this definition of the Poincaré index by considc 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

(p)

(q)

p(ψ) ≈ pˆ sin(ψ + ψ0 ) q(ψ) ≈ qˆ sin(ψ + ψ0 ).

(20)

Substituting Eq. (20) into Eq. (19) reveals that along the
circle, θ takes on each value in (−π, π] exactly once, rotating the frame of all vi in Eq. (3) by ±2π/ . For = 2, this
leads to the well-known Poincaré indices of trisectors (−1/2)
and wedges (1/2) [DH94]. The fact that they are half-integers
reflects the non-orientability of eigenvectors in the presence
of a degeneracy. For > 2, a Poincaré index of ±1/ makes it
impossible to partition the vectors from the decomposition
into vector fields without introducing discontinuities that
originate in degeneracies.
Fig. 2 illustrates this with examples from a third- (a) and
a fourth-order field (b): Along a closed curve around the degeneracy, the joint frames of three and four vectors, respectively, vary continuously. However, when we follow any individual vector (e.g., the one marked in cyan), we find that
when we return to the initial starting point, the vector has not
been rotated back to the vector that we started with, but to a
different vector in the same frame, ±2π/ apart.
The Poincaré index of a degeneracy in a second-order tensor field is known to be 12 sign(ad − bc) [DH94], where:
1 ∂(t11 − t22 )
2
∂x
∂t12
c=
∂x

a=

1 ∂(t11 − t22 )
2
∂y
∂t12
d=
.
∂y
b=

(21)

From Eq. (11), an analogous rule can be derived for thirdorder tensor fields. Here, the index is 13 sign(ad − bc) with
∂(3t122 − t111 )
∂(t − 3t112 )
, c = 222
,
(22)
∂x
∂x
and b and d are corresponding partial derivatives with respect to y. Finally, the index of a degenerate point in a fourthorder tensor field is 14 sign(ad − bc), with:
a=

a=

∂(6t1122 − t1111 − t2222 )
∂x

c=4

∂(t1222 − t1112 )
. (23)
∂x

We will draw degenerate points in red when they have a
positive index, yellow when their index is negative. A more

846

T. Schultz / Topological Features in 2D Symmetric Higher-Order Tensor Fields

(a) Third-order tensor field

(b) Fourth-order tensor field

Figure 2: Around degenerate points (yellow/red), it is impossible to partition the vectors from the decomposition into
continuous vector fields.

detailed characterization of degenerate points, comparable
to the differentiation between single and double wedges in
second-order tensor topology, is left to future work.
3.5.3. Lines of Discontinuity
We have learned in the previous section that partitioning the
vectors around a degeneracy inevitably leads to discontinuities. A natural way of defining vector fields that are at least
piecewise continuous is to sort the rank-1 terms according to
their λi . In this case, discontinuities in vector direction occur
when λi = λ j for some pair i = j.
In the second-order case, this leads to the major and minor eigenvector fields, v¯ 1 (x) and v¯ 2 (x). Discontinuities are
restricted to degenerate points, which are the only locations
at which λ1 = λ2 . The reason why this single equality acts
as a codimension-two constraint is that it also eliminates the
degree of freedom that is otherwise present in jointly rotating v¯ 1 and v¯ 2 . In higher-order fields, the constraint λi = λ j
only defines a codimension-one subspace, so the locations at
which the constraint is fulfilled form structurally stable lines.
Rotating θ in Eq. (3) by π/ amounts to multiplying one
of the vi by −1. For odd , the scaled v¯ i has a fixed orientation, so the rotation flips the sign of the corresponding λi .
To account for this indeterminacy, we sort the λi by absolute value in tensor fields of odd order. When talking about
“larger” and “smaller” λi , we refer to an ordering by signed
value when is even, by absolute value when is odd.
In third-order tensor fields, we can distinguish major
and minor lines of discontinuity, depending on whether the
larger or the smaller |λi | coincide. All degenerate third-order
tensors are rotated and scaled variants of the example in
Fig. 1 (a). As illustrated there, |λ1 | = |λ2 | and |λ2 | = |λ3 |
are both attained exactly once within θ ∈ [0, π/3). Since θ
is rotated by ±2π/3 around a degeneracy, we conclude that
a major and a minor line of discontinuity originate from the
degeneracy, and continue through it.
In regions without a degeneracy, we can define continu˜ i (x) via a conous and signed, but unsorted scalar fields λ

(a) Third-order tensor field

(b) Fourth-order tensor field

Figure 3: Major (blue), medium (cyan), and minor (green)
lines of discontinuity on bilinear cells; tensors at the corners
are shown with glyphs, degenerate points with red dots.

tinuously varying frame of vi . This is analogous to locally
orienting the eigenvectors in a second-order tensor field. It
clarifies that lines of discontinuity are closed curves, the zero
˜ i −λ
˜ j and λ
˜ i +λ
˜ j . They originate from degenlevel sets of λ
erate points, but can also occur in their absence. This also
helps us to understand the two cases in which lines of discontinuity in third-order tensor fields cross in absence of a de˜i = λ
˜ j = 0; two lines pass
generacy. The first occurs when λ
˜
˜ j and λ
˜ i = −λ
˜ j.
through this point, corresponding to λi = λ
Since we are sorting by magnitude, they are both minor lines.
˜ 1 | = |λ
˜ 2 | = |λ
˜ 3 |, where the three lines
The second case is |λ
˜ 1 | = |λ
˜ 2 |, |λ
˜ 1 | = |λ
˜ 3 |, and |λ
˜ 2 | = |λ
˜ 3 | meet. This is the
|λ
only location at which the type of the involved lines changes
between major and minor.
In addition to rotation and scaling, degenerate fourthorder tensors can differ from the example in Fig. 1 (b) by
some multiple of the identity αI (4) . However, addition of an
isotropic tensor only offsets all λi by some constant amount,
so it does not influence equalities of the type λi = λ j . We
conclude from Fig. 1 (b) that all three types of lines (major, minor, and medium, which do not exist in the third-order
case) will pass through a degeneracy. Moreover, λ1 = λ2 and
λ3 = λ4 are attained at the same θ, so the major and minor
lines will be tangential to each other.
Outside of degeneracies, major and minor lines cross
without affecting each other, at any angle. Analogous to
third-order tensor fields, we obtain triple crossings between
major and medium (λ1 = λ2 = λ3 ) or minor and medium
(λ2 = λ3 = λ4 ) lines, at which they change their type. Except
at degenerate points, crossings of all three types of lines are
non-generic. Also, minor lines no longer self-intersect, since
we are now sorting by signed rather than absolute value.
Figure 3 shows lines of discontinuity in bilinear cells
whose vertices have been set to randomly generated thirdand fourth-order tensors, shown with polar plots. All crossings can be observed as explained in our analysis.
Lines of discontinuity are not separatrices, and a full topoc 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

847

T. Schultz / Topological Features in 2D Symmetric Higher-Order Tensor Fields

logical analysis would additionally extract those. However,
we believe that it is fundamental to fully understand the limit
sets of a vector field before considering separatrices, so we
concentrate on that aspect in this initial work.

˜
2. Approximate ∆ = λi − λ j by a linear function ∆(α)
=
(s)
(e)
(1 − α)∆ + α∆ along the edge, and solve for the po˜
sition α where ∆(α)
= 0. Interpolate the tensor coefficients at this point, solve for the exact values of λi (α)
and λ j (α), and compute the relative error

4. Implementation
δ=

4.1. Extracting Degenerate Points
Just like in the vector and second order tensor case, degenerate points in third- and fourth-order tensor fields are given
by two linear constraints on their coefficients, so they can be
located numerically in full analogy to the methods from 2D
vector and tensor topology. For details, we refer to [Tri02].
On a linear cell, substituting the parameter-dependent tensor coefficients into Eq. (12) or Eq. (16) leads to a system of
two linear equations in two unknowns, which has at most
one isolated solution within the cell. On a bilinear cell, it
leads to a system that is quadratic in one of the variables and
yields up to two isolated solutions.
4.2. Extracting Lines of Discontinuity
Unlike separatrices, which have to be integrated from certain
limit points, lines of discontinuity can be identified from local information alone, based on the fact that λi = λ j for some
i = j. Given fixed tensor coefficients, Section 3.3 provides
an analytical solution for λi . Unfortunately, with parameterdependent coefficients, the equations become too complex
to directly solve for the curves along which λi = λ j .
Finding lines of discontinuity numerically is facilitated by
the fact that along a linearly interpolated edge, p and q in
Eq. (19) change linearly, so θ varies monotonically, and by
less than π/ . This allows us to find the correspondence between the vector frames at the two endpoints of an edge.
The correct correspondence is determined by the rotation
of the joint frame along the edge. Similar to Eq. (22) and
Eq. (23), the direction of this rotation is given by the derivatives of p and q. Along a linear edge, they are proportional
to pdiff = (pe − ps , qe − qs )T , where ps , qs , pe , and qe are
the values of p and q at the start and end of the edge, respecT
⊥
tively. Define the vector p⊥
s = (qs , −ps ) . If ps · pdiff > 0,
(s)
the correspondence of a vector vi at the start of an edge
(e)

is given by the unique vector v j

at its end that forms the

(s)
vi

smallest angle with
in counterclockwise direction. If
·
p
<
0,
it
is
the
closest
vector in clockwise direction.
p⊥
s
diff
Given this correspondence, intersections between a linear edge and the feature lines can be found with an adaptive refinement scheme that is similar in spirit to a previous
approach from the tensor topology literature [TKW08], but
independent in its specific algorithmic steps:
1. If for any i = j, the sign of λi − λ j differs at the two endpoints, the edge is intersected by a line of discontinuity.
Otherwise, it is ignored.
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

|λi − λ j |
.
|λi | + |λ j |

(24)

3. If the second step produced a sufficiently accurate approximation (δ < 10−4 in our experiments), return α.
Otherwise, subdivide the edge at its midpoint, and recursively apply steps 1–3 to both parts.
If we are looking for |λi | = |λ j |, we need to consider zero
crossings of λi + λ j in addition to those of λi − λ j . This
relatively simple method does not produce false positives
and it finds the discontinuities up to the desired accuracy,
but it may not find all intersections, since ∆ might change
sign multiple times along the edge. A higher detection rate
is achieved by prescribing a minimum recursion depth. However, zero crossings can be arbitrarily close to each other, so
finding them all is an ill-conditioned problem.
Computing the tangent of a line of discontinuity involves
the gradients ∇λi . Unfortunately, the derivatives that are easily computed from the tensor field are the gradients of the
tensor components ∇ti jk , and analytically deriving the Jacobian Jt→λ that is needed to compute ∇λi from ∇ti jk is
unwieldy. Instead, from Eq. (7) and the derivatives of ti jk
with respect to θ, which are obtained from equations like the
ones in Eq. (10), we compute the much simpler

 ∂t
∂t
∂t
∂t
111

∂λ

(3)

Jλ→t

 .1
=
 ..

111

∂λ3

∂θ

111

∂t222
∂λ2

∂t222
∂λ3

∂t222
∂θ

.. 

. 

..
.

..
.

∂t222
∂λ1


1


0
=

0

0

111

∂λ2



1
8

− 18

− 34

3
64
3
8
27
64

3
64
− 38
27
64

λ1 +
− 14

3
4 (λ2 + λ3 )

5
8 (λ3 − λ2 ) 


3

(λ
+
λ
)
2
3
4


(25)

9
8 (λ2 − λ3 )

and obtain the derivative vector d = (λ1 , λ2 , λ3 , θ )T
by solving the linear system Jλ→t d = t with t =
(t111 , . . . ,t222 )T . The fourth-order version of Jλ→t is


1
1 14 0
λ4 − λ 2
4
0 1 0 − 1 λ1 − 1 (λ2 + λ4 )
4
4
2


(4)
1
1
.
Jλ→t = 
(26)
0

0 4 0
4
1
1
1
0
0 −
(λ + λ ) − λ 
0

4
1
4

1

1
4

4

2

2

4

3

λ2 − λ 4

Note that at degenerate points, derivatives of λi and θ are
undefined, as Jλ→t becomes singular. At any other point
(x, y) on the line along which λi − λ j = 0, we compute the
2D gradient g(x, y) = ∇λi − ∇λ j by taking partial derivatives ∂t/∂x and ∂t/∂y in the tensor field and solving for

848

T. Schultz / Topological Features in 2D Symmetric Higher-Order Tensor Fields

the partial derivatives ∂d/∂x and ∂d/∂y using the Jacobian
Jλ→t , as described above. The tangent is orthogonal to g.
These basic ideas were used to create Fig. 3. A sampling
of the curves was obtained by sweeping axis-aligned edges
over a bilinear grid, and each detected feature intersection
is visualized with a short line segment that is aligned with
the curve tangent. If some application should require an explicit representation of curve topology, our analysis provides
all ingredients for tracking them: Intersection with edges can
be used to find seed points, tangents and normals can be used
for prediction and correction steps, and the analysis in Section 3.5.3 clarifies which bifurcations must be treated.

(a) Third-order degeneracies in a noise-free synthetic MR image.

5. Experiments
5.1. Higher-Order Derivatives
Just like the first-order partial derivatives of a smooth scalar
field f (x) make up the gradient vector ∇ f (x), and the
second-order derivatives form the symmetric Hessian matrix H(x), third-order partial derivatives ∂3 f (x)/∂xi ∂x j ∂xk
produce a symmetric third-order tensor field T (x).
We have computed such third-order derivatives from
three synthetic MR images, created using the BrainWeb [CKK∗ 97] normal brain template with T1 weighting
and 1 mm slice thickness. The first example (closeup in
Fig. 4 (a)) is noise-free. In the second and third case, we
added 3% (Fig. 4 (b)) and 5% (Fig. 4 (c)) noise with respect to white matter signal intensity and a spatially varying gain field, which multiplies image intensities by values in the range of [0.8, 1.2]. Such bias arises from different sources [STBA94] and varies over the image in complex
shapes. The noisy images were also rotated by 10◦ to simulate subject motion between acquisitions.
The third-order tensors were interpolated bilinearly, and
degenerate points were extracted. Even though they do not
have a clear interpretation in terms of the depicted brain
anatomy, the same is true for image keypoints that are
presently used in computer vision [TM08]. Such features can
provide useful landmarks for tasks like image registration,
tracking, or object recognition if we are able to reliably recover and match them in a transformed version of the image,
no matter if they have a clear semantic interpretation.
In Fig. 4 (b) and (c), the degeneracies from the perturbed
images are rendered as crosses. To facilitate the comparison, the features from (a) are rotated with the image and
overlaid as circles. Few features vanish in the degraded image, even though some are introduced by the noise. A large
number of the feature points remain close to their original
locations, and preserve their type (index). The degenerate
points benefit from their invariance under rotation and uniform scaling, which reduces the impact of the gain field. The
fact that higher-order derivatives are sensitive to noise can be
addressed by scale space analysis [Lin98]. Our experiment

(b) Rotation, noise, and spatially varying gain applied to (a).

(c) Same as (b), with higher level of noise.

Figure 4: Degeneracies in third-order derivatives provide
feature points that are fairly robust under rotation and typical MR image degradations. For comparison, points from (a)
are overlaid on (b) and (c) as circles.

used a fixed Gaussian scale σ = 2; we plan to study the persistence of our features over scale as part of our future work,
and we hope to evaluate their merit relative to more established keypoints from the computer vision literature.
5.2. Higher-Order Structure Tensors
Given a color image as a vector-valued function f(x) over
some image domain Ω ⊂ R2 , its order- structure tensor
Sρ (x) at scale ρ is defined as [SWS09]
3

Sρ (x) = Gρ

∑

i=1

⊗

∇ fi (x)
∇ fi (x)

2

.

(27)

Here, Gρ denotes convolution with a Gaussian kernel with
standard deviation ρ, and the sum is taken over RGB components fi (x).
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

T. Schultz / Topological Features in 2D Symmetric Higher-Order Tensor Fields

849

proach could be refined sufficiently to serve as an ingredient
in a method for unsupervised texture segmentation.

6. Conclusion and Future Work

(a) A photograph of Bergen

(c) Number of degeneracies
as a function of ρ

(b) Major lines at ρ = 3

(d) Major lines at ρ = 7

Figure 5: The major lines of discontinuity in the higherorder structure tensor field of a given image (a) indicate
meaningful regions at different scales (b/d).

The major eigenvector of a second-order structure tensor
provides an estimate of the locally dominant gradient direction [Di 86]. We have found experimentally that the major
vector field v¯ 1 (x) from the constrained decomposition of
a fourth-order structure tensor is generally closely aligned
with this estimate, except around the lines of discontinuity.
The analysis in Section 3.5.3 has shown that these lines are
closed, so they partition the image domain Ω into regions in
which the fourth-order structure tensor estimate of the principal gradient direction varies continuously.
Figure 5 illustrates these lines in a structure tensor field
that has been computed from a color image of Bergen, Norway. The black-and-white version is only used for visualization, to distract less from the lines. The major lines of
discontinuity are clearly related to semantic structures in the
picture, like the windows and rooftops of the houses, even
though they are less expressive when no clear gradients are
present (e.g., in the sky region).
The level of detail in the lines varies with the chosen scale
ρ. Using the number of degenerate points as a measure of
topological complexity, Figure 5 (c) shows that many unstable features exist at small scales (ρ < 2). Major features,
such as the ones in Subfigure (d), are preserved up to much
larger scales. In the future, it would be interesting to track
these features over scale, to study the topology at even higher
orders ( = 6 or = 8), and to combine it with the idea
of nonlinear structure tensors [BWBM06]. Possibly, this apc 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Methods for the extraction of geometric features from
higher-order tensor fields are needed to achieve concise and
effective visualizations, but are largely unexplored. Similar to previous work on second-order tensor fields [DH94,
ZPP05], we have approached this problem from a mathematical, application-independent perspective, by formally
extending established concepts of topological visualization
to 2D symmetric higher-order tensor fields, and studying the
resulting structures.
Starting from the observation that a continuous decomposition into a unique set of vectors is required to apply
the concepts of vector field topology, we derived an analytical solution for a geometrically constrained decomposition [KE10]. We showed that, at least for orders = 3 and
= 4, it leads to continuous and unique results, except at isolated degenerate points, which provide topological features.
This allowed us to derive vector fields that contain all
the information from the higher-order tensor field. Due to
the fractional Poincaré index of the degenerate points, these
vector fields are only piecewise continuous. The lines along
which discontinuities occur are a new type of topological
feature. We clarified their behavior for orders three and four.
We have developed algorithms to numerically extract degenerate points and lines of discontinuity, and applied them to
higher-order derivatives and higher-order structure tensors.
The geometric constraint from [KE10] is the only
symmetric higher-order tensor decomposition that we are
presently aware of that yields unique vector fields, and thus
lends itself to topological analysis. Our future work will try
to identify alternative constraints that may lead to unique and
efficiently computable tensor decompositions, and might be
more interpretable in applications such as diffusion imaging. Since many medical and scientific datasets are threedimensional, we will also pursue 3D tensor decompositions.
We believe that ultimately, the combination of application-specific constraints and reliable numerical methods for
tensor decomposition will allow us to produce expressive visualizations of higher-order tensor fields, a type of scientific
data whose complexity still presents a challenge at the current state of the art. We consider our present work an important first step towards that goal.

Acknowledgements
I would like to thank Lek-Heng Lim and Gordon Kindlmann
(University of Chicago) for valuable discussions. This work
was supported by a fellowship within the Postdoc Program
of the German Academic Exchange Service (DAAD).

850

T. Schultz / Topological Features in 2D Symmetric Higher-Order Tensor Fields

References
[BPS98] BAJAJ C., PASCUCCI V., S CHIKORE D.: Visualization
of scalar topology for structural enhancement. In Proc. IEEE Visualization (1998), Ebert D. S., Rushmeier H., Hagen H., (Eds.),
pp. 51–58.
[BWBM06] B ROX T., W EICKERT J., B URGETH B., M RÁZEK
P.: Nonlinear structure tensors. Image and Vision Computing 24,
1 (2006), 41–55.
[CGLM08] C OMON P., G OLUB G., L IM L.-H., M OURRAIN B.:
Symmetric tensors and symmetric tensor rank. SIAM Journal on
Matrix Analysis and Applications 30, 3 (2008), 1254–1279.
[CKK∗ 97] C OCOSCO C. A., KOLLOKIAN V., K WAN R. K.-S.,
P IKE G. B., E VANS A. C.: BrainWeb: Online interface to a 3D
MRI simulated brain database. NeuroImage (Proc. Int’l Conf.
Functional Mapping of the Human Brain) 5, 4 (1997), S425.
http://www.bic.mni.mcgill.ca/brainweb/.
[CM96] C OMON P., M OURRAIN B.: Decomposition of quantics in sums of powers of linear forms. Signal Processing 53, 2
(1996), 96–107.
[Dam98] DAMON J.: Generic structure of two-dimensional images under gaussian blurring. SIAM Journal on Applied Mathematics 59, 1 (1998), 97–138.
[DH93] D ELMARCELLE T., H ESSELINK L.: Visualizing secondorder tensor fields with hyperstreamlines. IEEE Computer
Graphics and Applications 13, 4 (1993), 25–33.
[DH94] D ELMARCELLE T., H ESSELINK L.: The topology of
symmetric, second-order tensor fields. In Proc. IEEE Visualization (1994), Bergeron R. D., Kaufman A. E., (Eds.), pp. 140–147.
[Di 86] D I Z ENZO S.: A note on the gradient of a multi-image.
Computer Vision, Graphics, and Image Processing 33 (1986),
116–125.

imaging and high angular resolution diffusion imaging. Magnetic
Resonance in Medicine 50 (2003), 955–965.
[PVH∗ 03] P OST F. H., V ROLIJK B., H AUSER H., L ARAMEE
R. S., D OLEISCH H.: The state of the art in flow visualisation:
Feature extraction and tracking. Computer Graphics Forum 22,
4 (2003), 775–792.
[PZ07] PALACIOS J., Z HANG E.: Rotational symmetry field design on surfaces. ACM Transactions on Graphics (Proc. ACM
SIGGRAPH) 26, 3 (2007), 55.
[Rez92] R EZNICK B. A.: Sums of even powers of linear forms.
Memoirs of the American Mathematical Society 96, 463 (1992),
1–155.
[SK10] S CHULTZ T., K INDLMANN G.: A maximum enhancing
higher-order tensor glyph. Computer Graphics Forum (Proc. EuroVis) 29, 3 (2010), 1143–1152.
[SNAHH11] S REEVALSAN -NAIR J., AUER C., H AMANN B.,
H OTZ I.: Eigenvector-based interpolation and segmentation of
2D tensor fields. In Topological Methods in Data Analysis and
Visualization, Pascucci V., Tricoche X., Hagen H., Tierny J.,
(Eds.). Springer, 2011, pp. 139–150.
[SS08] S CHULTZ T., S EIDEL H.-P.: Estimating crossing fibers:
A tensor decomposition approach. IEEE Transactions on Visualization and Computer Graphics (Proc. IEEE Visualization) 14, 6
(2008), 1635–1642.
[STBA94] S IMMONS A., T OFTS P. S., BARKER G. J., A RRIDGE
S. R.: Sources of intensity nonuniformity in spin echo images at
1.5 T. Magnetic Resonance in Medicine 32, 1 (1994), 121–128.
[STS07] S CHULTZ T., T HEISEL H., S EIDEL H.-P.: Topological
visualization of brain diffusion MRI data. IEEE Transactions on
Visualization and Computer Graphics (Proc. IEEE Visualization)
13, 6 (2007), 1496–1503.

[HH89] H ELMAN J., H ESSELINK L.: Representation and display
of vector field topology in fluid flow data sets. Computer 22, 8
(1989), 27–36.

[SWS09] S CHULTZ T., W EICKERT J., S EIDEL H.-P.: A higherorder structure tensor. In Visualization and Processing of Tensor
Fields – Advances and Perspectives, Laidlaw D. H., Weickert J.,
(Eds.). Springer, 2009, pp. 263–280.

[HS05] H LAWITSCHKA M., S CHEUERMANN G.: HOT-lines:
Tracking lines in higher order tensor fields. In Proc. IEEE Visualization (2005), Silva C., Gröller E., Rushmeier H., (Eds.),
pp. 27–34.

[TKW08] T RICOCHE X., K INDLMANN G., W ESTIN C.-F.: Invariant crease lines for topological and structural analysis of tensor fields. IEEE Transactions on Visualization and Computer
Graphics (Proc. IEEE Visualization) 14, 6 (2008), 1627–1634.

[Jac46] JACOBI C. G. J.: Über ein leichtes verfahren die in
der theorie der säcularstörungen vorkommenden gleichungen numerisch aufzulösen. Journal für die reine und angewandte Mathematik 30 (1846), 51–94.

[TM08] T UYTELAARS T., M IKOLAJCZYK K.: Local invariant
feature detectors: A survey. Foundations and Trends in Computer
Graphics and Vision 3, 3 (2008), 177–280.

[KB09] KOLDA T. G., BADER B. W.: Tensor decompositions
and applications. SIAM Review 51, 3 (2009), 455–500.

[Tri02] T RICOCHE X.: Vector and Tensor Field Topology Simplification, Tracking, and Visualization. PhD thesis, Fachbereich
Informatik, Universität Kaiserslautern, 2002.

[KE10] K YRGYZOV O. O., E RDOGMUS D.: Numerical optimization of a sum-of-rank-1 decomposition for n-dimensional
order-p symmetric tensors. Neurocomputing 73, 16–18 (2010),
3323–3327.

[TSH01] T RICOCHE X., S CHEUERMANN G., H AGEN H.: Tensor topology tracking: A visulization method for time-dependent
2D symmetric tensor fields. Computer Graphics Forum 20, 3
(2001), 461–470.

[Kyr10] K YRGYZOV O. O.: Non-redundant Tensor Decomposition. PhD thesis, Northeastern University, Boston MA, 2010.

[ZP05] Z HENG X., PANG A.: 2D asymmetric tensor analysis. In
Proc. IEEE Visualization (2005), Silva C., Gröller E., Rushmeier
H., (Eds.), pp. 3–10.

[Lin98] L INDEBERG T.: Edge detection and ridge detection with
automatic scale selection. International Journal of Computer Vision 30, 2 (1998), 117–154.
[NBJ∗ 08] N EEMAN A. G., B RANNON R., J EREMI C´ B.,
VAN G ELDER A., PANG A.: Decomposition and visualization of
fourth-order elastic-plastic tensors. In IEEE/EG Symposium on
Volume and Point-Based Graphics (2008), Hege H.-C., Laidlaw
D., Pajarola R., Staadt O., (Eds.), pp. 121–128.

[ZPP05] Z HENG X., PARLETT B., PANG A.: Topological lines
in 3D tensor fields and discriminant hessian factorization. IEEE
Transactions on Visualization and Computer Graphics 11, 4
(2005), 395–407.
[ZYLL09] Z HANG E., Y EH H., L IN Z., L ARAMEE R. S.: Asymmetric tensor analysis for flow visualization. IEEE Transactions
on Visualization and Computer Graphics 15, 1 (2009), 106–122.

[ÖM03] Ö ZARSLAN E., M ARECI T.: Generalized diffusion tensor imaging and analytical relationships between diffusion tensor

c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.


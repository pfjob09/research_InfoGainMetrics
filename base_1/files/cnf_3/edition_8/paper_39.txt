Two-Channel Technique for High Dynamic Range Image Visualization
L. Capodiferro(*)(+), E. D. Di Claudio(**)(++), F. Iacolucci (**), A. Laurenti, G. Jacovitti (**)(+++)
(*)
Fondazione “Ugo Bordoni”, Roma, Italy
(**)
INFOCOM Dpt., University of Rome “La Sapienza”, Roma, Italy
(+)
lcapodiferro@fub.it (++) dic@infocom.uniroma1.it (+++)gjacov@infocom.uniroma1.it

Abstract
Advances in digital imaging technologies make
increasingly available high quality images
characterized by High Dinamic Range (HDR) of
color components. Usual display devices are unable
to visualize the information content of HDR images,
especially in presence of light. For this reason
special compression techniques for image rendering
on conventional displays have been developed. In this
work a new technique based on simultaneous
compression of low frequency radiance variations
and detail enhancement is presented. In this work a
method working in the transform domain of an edge
oriented wavelet transform is presented. Lowfrequency components and high resolution wavelet
coefficients are separately manipulated before image
reconstruction in order to reduce the overall dynamic
range. The effectiveness of the technique is shown by
means of significant examples.
Keywords: High Dynamic Range Images, Range
compression, Complex Edge Wavelet

1. Introduction
New video camera technologies produce images
with high dynamic ranges, able to capture details
simultaneously in bright as well as in dark areas. In
practice, part of the visual information contained is
such images is lost, since most usual display systems
employed in multimedia applications are not able to
reproduce high dynamic range images, especially
under unfavorable screen lighting conditions.
This is especially troubling in some applications
where detail visibility is important, such as in virtual
museums, high quality cinema, medical imagery, etc.
______________________________________________________
This material is based upon work supported by the IST programme
of the EU in the project IST-2000-32795 SCHEMA

For this reason, special techniques for dynamic
range compression have been developed. Their role is
similar to the one played by audio compressors for
reproduction of high dynamic musical performances
with normal audio equipments.
Different methods for dynamic range compression
exist. In this work, we focus our attention on two
approaches that constitute the basis of the technique
presented here. We are referring to the so called
homomorphic approach and to the gradient based
approach. The homomorphic filtering is an early
technique 0based on viewing the image i(x,y) as the
product of a reflectance component r(x,y) and of a
illuminance component l(x,y). It is assumed that the
largest luminance variations across the image are
caused by l(x,y), which varies slowly compared to
r(x,y). Homomorphic filtering consists of taking the
logarithm of the image, which is the sum of the
reflectance and the illuminance logarithmic
components. Then, the low frequency components
are properly attenuated and the final image is
obtained by taking the inverse of the logarithm. Such
a technique yields simultaneous dynamic range
reduction and detail enhancement. The main limit of
such a technique is that the hypothesis of smoothness
of the illuminance is often violated so that artifacts
may appear in correspondence of abrupt illuminance
variations.
Conversely, the gradient based approach 0focuses
on abrupt changes of the image, where the luminance
gradient assumes high values. The method consists of
representing the image by its gradient and of
attenuating it in a progressive way with a smooth
non-linear law. The image is then recovered by
integrating the modified gradient with proper
boundary conditions. Even thought the method takes
into account gradients at different scales, it does not
directly control attenuation of high dynamic ranges
caused by smooth luminance changes.
In the present approach, homomorphic filtering
and gradient reduction are jointly applied, thus

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

enabling for powerful detail preserving dynamic
range compression.
The method is based on an image decomposition
scheme wich establishes a linear correspondence
between the image and its gradient components plus
the low-pass component. In the following section,
such a decomposition scheme is preliminarly
discussed.

§ r
·
g s(1) ( r,ϑ ) = g s(0) ( r ,ϑ ) ¨ − e − jϑ ¸
© s
¹

Therefore g s(1) ( r,ϑ ) pertains to the class of the socalled
“Circular Harmonic Functions” (CHFs),
defined as complex polar-separable functions with
harmonic angular shape:
hn ( r , ϑ ) = p n ( r ) ⋅ e jnϑ

2. Edge based image decomposition
Let us consider an image, where (x,y) denotes the
generic point of the image plane in cartesian
coordinates, and let us introduce the scaled Gaussian
kernel:
§ x2 + y2 ·
¸
s 2 ¸¹

1 1 −¨¨©
g ( x, y ) =
e
π s2
(0)
s

(1)

iG ( x , y ; s ) = g s(1) ( x, y ) ∗ i ( x , y )

2x 1
e
s2 π s2

−j

2y 1
e
s2 π s2

(3)

S

which

is

s2
∇G ( x, y )
2

rewritten in
y as:
r = x 2 + y 2 ; ϑ = tg −1
x

Gs(1) ( ρ , ϕ ) = j 2π
= j 2πρ e − jϕ

Let us now define the following normalized
operator:
(4)
polar

coordinates

and

The Fourier transform Gs(1) (ξ ,η ) of g s(1) ( x, y ) is
also significantly expressed in the polar coordinates
ρ = ξ 2 + η 2 ; ϕ = tg −1 η as
ξ

§ x2 + y 2 ·
−¨
¨ s 2 ¸¸
©
¹

For
each point
(x,y),
the
argument
Arg∇GS ( x, y ) of the complex smoothed gradient
indicates the direction of the gradient i.e. the
direction along which the directional smoothed
derivative has its largest absolute value ∇iG ( x, y ) .

g s(1) ( x, y ) =

I (ξ ,η )

I G (ξ ,η ; s ) denote Fourier
transforms of i ( x, y ) and iG ( x, y; s ) .

where

­∂
½
∂
∇GS ( x, y ) = ® g s(0) ( x, y ) + j g s(0) ( x, y ) ¾
∂y
¯ ∂x
¿
=−

(8)

(2)

Let us now assembly for mathematical
convenience the two filters above in one (smoothed)
complex gradient operator

§ x2 + y 2 ·
−¨
¨ s 2 ¸¸
©
¹

(7)

In the Fourier domain, referring to the the spatial
frequency coordinates ξ and η , we have:
I G (ξ ,η ; s ) = Gs(1) (ξ ,η ) ⋅ I (ξ ,η )

∂ (0)
∂
g S ( x, y ) ; g S(0) ( x, y )
∂x
∂y

(6)

where p n (r ) is the “radial profile”, and n is the
“order” of the CHF, corresponding to its angular
periodicity. It has been shown in 0 that the function
(6) pertains to a class of admissible complex wavelet.
Based on the Complex Gradient Wavelet g s(1) ( r,ϑ )
the integral CGW transform of the image is defined
as:

where s is a dilation factor.
The smoothed gradient is calculated with a pair of
filters extracting the horizontal and the vertical
components:

(5)

s

2

e

s

2

−(π s ρ )

ρ e − jϕ Gs(0) ( ρ , ϕ )

(9)

2

Let us now consider a discrete, dyadic sequence of
scales sk = a 2 k , where a is a positive real number
and k is an integer number indicating the
“resolution” order. The dyadic CGW transform is
then formed by smoothed gradients ik ,1 ( x, y ) . Since
the frequency response of g s(1) ( x , y ) vanishes at zero
frequency , the transform must be completed with a
low-pass component of the image i0 ( x, y ) obtained
with an operator g (0) ( x, y ) .
Thus, the image is decomposed as:

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

I k ,1 (ξ ,η ) = Gs(1)
(ξ ,η ) ⋅ I (ξ ,η )
k

(10)

where I k ,1 (ξ ,η ) are the Fourier transforms of the
components ik ,1 ( x, y ) at different resolutions sk , and
I 0 (ξ ,η ) = G (0) (ξ ,η ) ⋅ I (ξ ,η )

In the present application, we consider three
different resolution levels: low (k=2), medium (k=1)
and high (k=0).
Since these operators cover the whole spectrum, it
is possible to recover the original image from the
multiscale smoothed gradients of the original image
according to the following synthesis formula:

I (ξ ,η ) =

¦I

k ,1

(1) ∗
sk

(ξ ,η ) ⋅ G

k =0

2

¦G
k =0

(1)
sk

(ξ ,η ) + I 0 (ξ ,η ) ⋅ G (ξ ,η )
(0)

2

(ξ ,η ) + G (0) (ξ ,η )

ηk ( x, y ) =

(11)

where I 0 (ξ ,η ) is the Fourier transform of the low
pass component i0 ( x, y ) .

2

To this purpose, the gradient layers magnitudes are
first normalized as follows:

2

(12)

(14)

Aµ k

where µk is the average magnitude of

ik ,1 ( x, y )

and A is an adjustable parameter.
Then the local “gradient attenuation factor”
ψ ( x, y ) is computed as follows:

ψ ( x, y ) =

[η0 ( x, y) ⋅η1 ( x, y) ⋅η2 ( x, y)]

B

η0 ( x, y ) ⋅η1 ( x, y ) ⋅η2 ( x, y )

u ( x, y ) =i0,1 ( x, y ) ⋅ψ ( x, y )

Based on the above decomposition, the dynamic
range compression works as follows.
First, the luminance image, say i(x,y), is derived
from a generic color image c(x,y). Then, the
logarithm of the input image (log-image) is
calculated as:

(15)

where B is an adjustable parameter playing a
major role, typically ranging from 0.5 to 1 . Since
the
gradient
attenuation
factor
B < 1,
ψ ( x , y ) decreases with the gradient strength if the
product of the normalized gradient exceeds the unity,
and increases otherwise.
The modified high resolution gradient is
calculated by the point-wise product:

3. Dynamic range compression

i ( x , y ) = log [1 + i ( x, y )]

ik ,1 ( x, y )

(16)

As a result, the high resolution gradient is
attenuated wherever it is large and is amplified
wherever it is small.
As far as the low pass component is concerned, its
modified version l(x,y) is obtained in a very simple
way :

(13)

Operating in the frequency domain, the log-image
is
decomposed into the low pass component
i ( x, y ) , and the high, medium and low resolution
0
complex gradient components
i0,1 ( x, y ) , i1,1 ( x , y ) ,
i2,1 ( x, y ) according to the CGW previously described.
At this point dynamic range compression is
separately applied to the low-pass and to the gradient
components.
As far as the gradient is concerned, similarly to 0
the simultaneous use of all gradient components for
image representation is avoided, to prevent “halo”
artifacts. Thus, the high resolution component
i0,1 ( x, y ) of the log-image only is actually modified

and employed for subsequent reconstruction.
However, all the gradient layers are involved for
determining the modification of the high resolution
gradient, in order to take into account relatively
smooth amplitude changes.

l ( x, y ) = C ⋅ i0 ( x, y )

(17)

where C is a low-frequency attenuation
parameter.
The compressed log-image is synthesized using a
reduced reconstruction formula based on the
modified low pass component and the modified high
resolution gradient only :
∗

U (ξ ,η ) ⋅ Gs(1)
(ξ ,η ) + L(ξ ,η ) ⋅ G (0) (ξ ,η )
0
IC (ξ ,η ) =
2
2
Gs(1)
(ξ ,η ) + G (0) (ξ ,η )
0

(18)
where IC (ξ ,η ) is the Fourier transform of the
compressed
log-image, U (ξ ,η ) is the Fourier
transform of the modified high resolution gradient

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

and L(ξ ,η ) is the Fourier transform of the modified
low-pass component.
Finally, the dynamic range compressed image
iC ( x, y ) is obtained as:
iC ( x , y ) = exp ª¬i ( x, y ) º¼ − 1

(19)

4. Results and conclusion
The method described so far as been tested on
several gray scale images and color images.
Incidentally, color image processing is analogous to
the one employed in 0. Specifically, referring to the
RGB components r(x,y), g(x,y) and b(x,y), the RGB
components of the compressed image are calculated
as:

References
[1] J.T.G. Stockam , Image processing in the context of a
visual model. Proceedings of the IEEE, Vol. 60, pp. 828842.
[2] R. Fattal, D. Lischinski, M. Werman. Gradient Domain
High Dynamic Range Compression. In SIGGRAPH 2002,
San Antonio, Texas, USA, July 21-26, 2002, pp. 249-256.

[3] G. Jacovitti, A. Neri, Multiresolution circular harmonic
decomposition IEEE Trans. on Signal Processing, Vol. 48,
No. 11, pp. 3242-3247, November 2000.

S

§ r ( x, y ) ·
rC ( x, y ) = ¨
¸ iC ( x, y )
© i ( x, y ) ¹

(20)

S

§ g ( x, y ) ·
g C ( x, y ) = ¨
¸ iC ( x, y )
© i ( x, y ) ¹

(21)

S

§ b( x, y ) ·
bC ( x, y ) = ¨
¸ iC ( x, y )
© i( x, y ) ¹

(22)

where S is a color saturation parameter.
In the foregoing some examples of dynamic range
compression of color images are reported in gray
scale.
Let us remark here that the double compression
mechanism implies that parameters of the gradient
based and of the homomorphic sections have to be
balanced. In particular, it is required that for a given
value of B (which regulates the gradient compression
degree), the value of C is chosen so that the low-pass
component is consistent with the modified gradient.
In practice, C must be kept sufficiently low to avoid
an “haze effect” due to the prevalence of low-pass
components. For instance, for B=0.9, corresponding
to a moderate gradient compression, a satisfactory
value of C is 0.3.

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

Figure 1a: Original image

Figure 1b : Image after dynamic range
compression

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

Figure 2a: Original image

Figure 2b: Image after dynamic range
compression


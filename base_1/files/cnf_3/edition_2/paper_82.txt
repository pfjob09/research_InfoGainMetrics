2010 14th International
Information
Conference
Visualisation
Information Visualisation

Visualization of positive data by rational cubic spline interpolant
Muhammad Sarfraz,

Malik Zawwar Hussain and Tahira Sumbal Shaikh

Department of Information Science, Kuwait University
Adailiya Campus, P.O. Box 5969, Safat 13060, Kuwait
e-mail: prof.m.sarfraz@gmail.com

Department of Mathematics, University of the Punjab,
Lahore-Pakistan.
e-mail: malikzawwar@math.pu.edu.pk

Abstract— This paper discusses the problem of constructing

data. In particular, an algorithm for quadratic spline
interpolation is given by McAllister and Roulier [11].
Rational functions have been discussed by Sarfraz [9] in a
parametric context.
The theory of methods, in this paper, has number of
advantageous features. It produces C 2 interpolant. No
additional points (knots) are needed. In contrast, the
quadratic spline methods of Schumaker [14] require the
introduction of additional knots when used as shape
preserving methods. The interpolant is not concerned with
an arbitrary degree as in [4]. It is a rational cubic with cubic
numerator and cubic denominator. The rational spline curve
representation is bounded and unique in its representation.
The paper begins with a definition of the rational
function in Section 2, where the description of rational cubic
spline, which does not preserve the shape of a positive data,
is made. This section reviews it for the scalar representation
so that it can be utilized to preserve the scalar valued data.
The positivity problem is discussed in Section 3 for the
generation of a C 2 spline which can preserve the shape of a
positive data. The sufficient constraints, on the shape
parameters, have been derived to preserve and control the
positive interpolant. The Section 4 discusses and
demonstrates the scheme when a data set has features of
positivity. The Section 5 concludes the paper.

positive cubic spline interpolation. To obtain smooth curve for
positive data, piecewise rational cubic function has been used.
In the description of rational interpolant, two families of
parameters have been constrained to preserve positive shape of
the data, the rational spline scheme has a unique
representation. In addition, to preserve the shape of positive
data sets, the degree of smoothness attained is C 2 .
Keywords- Data visualization; Rational spline; Interpolation;
Shape preserving; Positive

I.

INTRODUCTION

Smooth curve representation has great significance to
visualize the scientific data in the area of computer graphics
and in particular data visualization. Particularly, when the
data is obtained from some complex function or from some
scientific phenomena, it becomes crucial to incorporate the
inherited features of the data. Moreover, smoothness is also
one of the very important requirements for pleasing visual
display.
Ordinary spline schemes, although smoother, are not
helpful for the interpolation of the shaped data. Extremely
misguided results, violating the inherited features of the
data, can be seen when undesired oscillations occur. For
example, for the positive data set in Table1, the
corresponding curve in Figure 1 is not as may be desired by
the user for a positive data. The user would be interested to
visualize it as it is displayed in Figure 3. Thus, unwanted
oscillations which completely destroy the data features, are
needed to be controlled. Another example of positive data
set in Table 2, the corresponding cubic Hermite spline curve
is shown in Figure 4, which has destroyed the features of
positivity as may be desired corresponding to Figure 6.
This paper examines the problem of shape preservation
of positive data sets. In recent years, various authors have
worked in the area of shape preservation [1–18]. In this
paper, the shape preserving interpolation has been discussed
for positive data, using rational cubic spline. The motivation
to this work is due to the past work of many authors, e.g.
quadratic and cubic spline interpolation techniques have
been adopted in [1, 4, 6, 8, 14-17] for the shape preserving
curves, in which degree of smoothness attained is C1 .
Sarfraz, Hussain and Butt [17], Delbourg and Gregory [6],
have discussed the piecewise cubic interpolation to positive
1550-6037/10 $26.00 © 2010 IEEE
DOI 10.1109/IV.2010.82

II.

RATIONAL CUBIC SPLINE WITH SHAPE
CONTROL

Let ( xi , fi ) , i = 1, 2,3,K , n be given set of data points
where x 0 < x1 < x 2 < K < x n . Let

f i +1 − f i
, i = 1, 2,3,K , n − 1 .
hi
Consider the following rational cubic function:
hi = xi +1 − xi , Δi =

( 2.1)

S ( x ) ≡ S ( xi )
U i (1 − θ ) + viViθ (1 − θ ) + wiWiθ 2 (1 − θ ) + Z iθ 3
3

=

where

554
564

2

(1 − θ )3 + viθ (1 − θ )2 + wiθ 2 (1 − θ ) + θ 3

( 2.2 )

θ=

x − xi
,
hi

( 2.3)

i = 1, 2,3,K , n − 1.

The derivative parameters di' s are unknown, for an
appropriate end conditions d1 and d n can be determined, the

The rational function

( 2.2 )

only unknown are d 2 , d3 , L , d n −1 , these unknown can be
determined by solving the above linear system.

is C1 by imposing the

following interpolatory properties:

S ( xi ) = fi ,

S ( xi +1 ) = fi +1 ,

1
S ( ) ( xi ) = di ,

⎫⎪
⎬
1
S ( ) ( xi +1 ) = di +1 , ⎪⎭

This is also diagonally dominant for the following
constraints on the shape parameters:

( 2.4 )

vi , wi > 2,

which provide the following manipulations:

and hence has a unique solution for d i ' s . As far as the
computation method is concerned, it is much more
economical to adopt the LU-decomposition method to solve
the tridiagonal system. The solution is also bounded with
respect to the vi ' s and wi ' s since, for vi , wi ≥ α > 2, it

U i = fi , Z i = fi +1 ,
Vi = fi +

hi di
hd
, Wi = fi +1 − i i +1 ,
vi
wi

( 2.5)

1
where S ( ) ( xi ) denotes derivative with respect to x and

can be shown that max d i ≤ ⎡⎣α / (α − 2 ) ⎤⎦ max Δi .

di

A. Shape control analysis

denotes derivative value given at the knot xi . This leads the

The parameters

piecewise rational cubic ( 2.2 ) to the following piecewise

Pi (θ )

Qi (θ )

pulled towards the point ( xi , f i ) in the neighborhood of the

( 2.6 )

,

vi ' s, and wi ' s can be utilized properly

to modify the shape of the curve according to the desire of
user. Their effectiveness, for the shape control at knot
points, can be seen that if vi , wi −1 → ∞ then the curve is

Hermite interpolant S ∈ C 2 ⎡⎣ x1 , xn ⎤⎦ :

S ( x ) ≡ Si ( x ) =

i = 1, 2,..., n − 1

knot position

where

xi . This shape behavior can be observed by

looking at Si ( x ) in Eq. ( 2.6 ) . This form is similar to that
of Berstein-Bézier formulation. One can observe that when
vi , wi −1 → ∞ then Vi , Wi −1 → fi .
The interval shape control behaviour can be observed
by rewriting Si ( x ) in Eq. ( 2.6 ) to the following simplified

Pi (θ ) = f i (1 − θ ) + viViθ (1 − θ ) + wiWiθ 2 (1 − θ ) + fi +1θ 3 ,
3

2

Qi (θ ) = (1 − θ ) + viθ (1 − θ ) + wiθ 2 (1 − θ ) + θ 3 .
3

2

Now to make the rational function ( 2.2 ) C 2 , one needs to
impose the 2nd derivative continuity at knot xi
2
2
S ( ) ( xi + ) = S ( ) ( xi − ) ,

i = 2,3,K , n − 1 .

This implies
2
{wi Δi − ( vi − 1) di − di +1}
hi

2
=
{−vi −1Δi −1 + ( wi −1 − 1) di − di −1}
hi −1

form:

:

S ( x)
= fi (1−θ ) + fi +1θ

( 2.7 )

⎡(1−θ ) ( di − Δi ) + θ ( Δi − di +1 ) + θ (1−θ ) Δi ( wi − vi ) ⎤⎦ hiθ (1−θ )
.
+⎣
Qi (θ )

( 2.10 )

When both vi , wi −1 → ∞ it is simple to see the convergence
to the following linear interpolant:

( 2.8)

S ( x) = fi (1 −θ ) + fi +1θ .

which then leads to the consistency equations:

hi di −1 + ⎡⎣ hi ( wi −1 − 1) + hi −1 ( vi − 1) ⎤⎦ − hi −1di +1
= hi −1 wi Δi + hi vi −1Δ i −1 ,

( 2.11)

It should be noted that the shape control analysis is valid
only if the bounded derivative values are assumed. A
description of appropriate choices for such derivative values
is made in the following subsection:

( 2.9 )

565
555

B.

⎧( a, b ) :
⎪
⎪36 fi fi +1 a 2 + b 2 + ab − 3Δ i ( a + b ) + 3Δi2
⎪
R2 = ⎨
⎪+3 ( fi +1a − fi b )( 2hi ab − 3 fi +1a + 3 fi b )
⎪
+4hi fi +1a3 − fi b3 − hi2 a 2b 2 > 0
⎪
⎩

Determination of derivatives

{ }

(

'

In most applications, the derivative parameters di s

are not given and hence must be determined either from the
given data ( xi , fi ) , i = 1, 2,3,K , n or by some other means.

(

In this article, they are computed from the given data in
such a way that the C 2 smoothness of the interpolant ( 2.6 )

Pi' ( 0 ) =

POSITIVE SPLINE INTERPOLATION

Let
us
assume
positive
( xi , fi ) , i = 1, 2,3,K , n, so that x 0 <

set

of

fi
( vi − 3) + di ,
hi

Pi' (1) = di +1 −

x1 < x2 < K < xn

( P ( 0) , P (1)) ∈ R ,
'

i

'

i

Pi' ( 0 ) >

1

−3 fi
,
hi

Pi' (1) <

3 fi +1
.
hi

Qi (θ ) , so initial conditions on vi , wi are:

This leads to the following constraints:
vi > mi , wi > M i ,

the interpolant ( 2.6 ) depends on the positivity of the cubic

where

Since Qi (θ ) > 0 for all vi , wi > 0, so the positivity of

⎧⎪ −h d ⎫⎪
mi = max ⎨0, i i ⎬ ,
fi ⎪⎭
⎪⎩
Further

polynomial Pi (θ ) . thus the problem reduces to the

vi , wi for which the

polynomial Pi (θ ) is positive. Now Pi (θ ) can be expressed

⎧⎪ h d ⎫⎪
M i = max ⎨0, i i +1 ⎬ ,
fi +1 ⎪⎭
⎪⎩

( 3.5 )
( 3.6 )

( P ( 0 ) , P (1) ) ∈ R ,

as follows:

'

i

Pi (θ ) = α iθ 3 + βiθ 2 + γ iθ + δ i ,

f i +1
( wi − 3) .
hi

Now ( 3.2 ) is true when

data

and f1 > 0, f 2 > 0, ..., f n > 0. In this paper, sufficient
conditions are derived on piecewise rational cubics under
which C 2 positive interpolation is preserved.
As vi , wi > 0 guarantee strictly positive denominator

determination of appropriate values of

( 3.4 )

We have

is maintained. These methods are the approximations based
on various mathematical theories.
III.

)

)

⎫
⎪
⎪
⎪
⎬
⎪
⎪
⎪
⎭

'

i

2

if

( 3.1)

⎡φ12 ( vi ) + φ2 2 ( wi ) + φ1 ( vi ) φ2 ( wi ) ⎤
⎥
36 fi fi +1 ⎢
⎢ −3Δ i (φ1 ( vi ) + φ2 ( wi ) ) + 3Δ i2
⎥
⎣
⎦

where

α i = (1 − wi ) f i +1 − (1 − vi ) fi + ( di +1 + di ) hi ,

⎡ 2hiφ1 ( vi ) φ2 ( wi )
⎤
+3 ⎡⎣ fi +1φ1 ( vi ) − fiφ2 ( wi ) ⎤⎦ ⎢
⎥
⎣⎢ −3 fi +1φ1 ( vi ) + 3 fiφ2 ( wi ) ⎦⎥

γ i = hi di + ( vi − 3) fi ,

+4hi ⎡ fi +1φ13 ( vi ) − fiφ23 ( wi ) ⎤ − hi2φ12 ( vi ) φ22 ( wi ) > 0,
⎣
⎦
where

βi = wi fi +1 + ( 3 − 2vi ) fi − ( di +1 + 2di ) hi ,

δ i = fi .
For

the

strict

inequality

(for

positive

data)

( 2.6 ) , according to Butt and Brodlie [4], Pi (θ ) > 0

φ1 ( vi ) = Pi' ( 0 ) ,

in

'

i

Theorem 1 For strictly positive data, the rational cubic
interpolant ( 2.6 ) preserves positivity if and only if

( 3.2 )

'

i

1

2

⎧⎪
−3 f i
3f
, b < i +1
R1 = ⎨( a, b ) : a >
hi
hi
⎪⎩

⎫⎪
⎬,
⎪⎭

φ2 ( vi ) = Pi ' (1) .

if and

only if

( P ( 0) , P (1) ) ∈ R ∪ R ,

( 3.7 )

either ( 3.5 ) or ( 3.7 ) is satisfied.

( 3.3)

IV.

EXAMPLES AND DISCUSSION

For the demonstration of C 2 positive rational cubic
curve scheme, the derivatives will be computed from the
linear system defined in ( 2.9 ) . Here we choose the values

566
556

vi = wi = 3, to generate the initial

90

default curves. The initial default curve is actually the
following cubic curve:

80

Si ( x ) = fi (1 − θ ) + φiθ (1 − θ ) + ϕiθ 2 (1 − θ ) + f i +1θ 3 , ( 4.1)

60

of shape parameters

3

70

2

y-axis

where φi = 3 fi + hi di , and ϕi = 3 fi +1 − hi di +1 .
Further modification can be made by changing these
parameters interactively.

50
40
30
20

TABLE I.

AKIMA’S DATA SET.

i
xi

1

2

3

4

5

6

7

8

9

10

11

0

2

3

5

6

8

9

11

12

14

15

yi

10

10

10

10

10

10

10.5

15

30

60

85

10
0

0

Figure 3.

2

4

6

8
x-axis

10

12

14

16

C 2 Positive curve is obtained from positive data set in Table 1,
having α i = 4.50 = βi , ri = 2.75 = si , ∀i.
TABLE II.

OXYGEN LEVELS IN THE FLUE GAS.

i
xi

1

2

3

4

5

6

7

0

2

4

10

28

30

32

yi

20.8

8.8

4.2

0.5

3.9

6.2

9.6

25

20

y-axis

15

Figure 1. Default shape preserving spline of positive data in Table 1.

10

5

90
80

0

70

-5

y-axis

60
50

5

10

15

x-axis

20

25

30

35

Figure 4. Default shape preserving spline of positive data in Table 2.

40

Our presented C 2 scheme can be easily compared with
the previous scheme developed in [17]. The data in Table 1
is a scientific data (Akima’s data) discussed in [17], another
data in Table 2 has been taken from an experiment showing
oxygen levels in the flue gas (see [17]) and data in Table 3
is any arbitrary positive data. The Figures 1, 4 and 7 are the
default curves to the positive data in Tables 1, 2 and 3
respectively. These resulting curves are neither positive nor
preserving the shape. It is clear from the Figures 1, 4 and 7

30
20
10
0

0

0

2

4

6

8

10

12

14

16

x-axis

Figure 2.

C1 Positive curve is obtained from positive data in Table 1.

567
557

14

that the ordinary spline curves do not guarantee to preserve
the positive shape of the data. Figures 2, 5 and 8 are C1
positive curves by implementing the scheme developed [17]
to the positive data in Tables 1, 2 and 3 respectively. These
curves are positive but not smooth. Finally the Figures 3, 6
and 9 are obtained by applying the scheme developed in this
paper. This scheme generates visually pleasant, smooth,
positive C 2 curves, by assigning different values to shape
parameters.

12
10

y-axis

8
6
4

25

2
0

20
-2

15

0

2

4

6
x-axis

8

10

12

y-axis

Figure 7. Default shape preserving spline of positive data in Table 3.
14

10
12

5

0
0

5

Figure 5.

10

15

x-axis

20

25

30

y-axis

10

35

8
6

1

C Positive curve is obtained from positive data in Table 2.

4

25
2
0

20

0

Figure 8.

y-axis

15

2

4

6
x-axis

8

10

12

C 1 Positive curve is obtained from positive data in Table 3.

14
10

12
10

0

0

5

Figure 6.

10

15

x-axis

20

25

30

y-axis

5

35

6
4

C 2 Positive curve is obtained from positive data in Table 2, by
taking α i = 4.55 = β i , ri = 0.5, si = 0.5, ∀i.
TABLE III.

8

2
0

ANY ARBITRARY POSITIVE DATA SET

i
xi

1
0

2
2

3
3

4
9

5
11

yi

0.5

1.5

7

9

13

0

Figure 9.

2

6
x-axis

8

10

12

C 2 Positive curve is obtained from positive data in Table 3, by
assuming ri

568
558

4

= 14.75, si = 14.75, ∀i

V.

CONCLUSION

[5]

A rational cubic interpolant, with two families of shape
parameters, has been utilized to obtain C 2 positivity
preserving interpolatory spline curves. The shape constraints
are restricted on shape parameters to assure the shape
preservation of the data. The rational spline scheme has
been implemented successfully and it demonstrates nice
looking visually pleasant and accurate results. The user has
not to be worried about struggling and looking for some
appropriate choice of parameters as in the case of ordinary
rational spline having some control on the curves.
In future, this curve scheme can be extended for
surface case. Moreover, some other shapes of data, like
monotony and convexity, can also be considered for further
research. The authors are in the process of completing it as a
subsequent paper.

[6]
[7]
[8]
[9]
[10]

[11]

[12]
[13]

REFERENCES
[1]

[2]

[3]

[4]

[14]

Asim, M. R., Mustafa, G. and Brodlie, K., Constrained visualization
of 2D positive data using modified quadratic Shepard method, WSCG
Posters Proceedings, February 2-6, 2004, Plzen, Czech Republic,
Union Agency - Science Press, (2004).
Brodlie, K. W. and Mashwama, P. and Butt, S., Visualization of
surface data to preserve positivity and other simple constraints,
Computers and Graphics, 19(4), (1995), 585-594.
Brodlie, K. W., Asim, M. R. and Unsworth, K., Constrained
visualization using Shepard interpolation family, Computers and
Graphics forum, 24(4), (2005), 809-820.
Butt, S. and Brodlie, K. W., Preserving positivity using piecewise
cubic interpolation. Computers and Graphics, 17(1), (1993), 55-64.

[15]
[16]

[17]
[18]

569
559

Constantini, P., Boundary-valued shape preserving splines, ACM
Transactions on Mathematical Software, 23(2), (1997), 229-251.
Delbourgo, R. and Gregory, J. A., Shape preserving piecewise
rational interpolation, SIAM J. Stat. Comput., 6, (1985), 967-976.
Floater, M. S., Total positivity and convexity preservation, J. Approx.
Theory, 96, (1999), 46-66.
Gregory, J. A., Shape preserving spline interpolation, ComputerAided Design, 18(1), (1986), 53-57.
Gregory, J. A. and Sarfraz, M., A rational cubic spline with tension,
Computer Aided Geometric Design, 7, (1990), 1-13.
Kong, V. P., Ong, B. H. and Saw, K. H., Range restricted
interpolation using cubic Bzier triangles, WSCG, Feb 2-6, 2004,
Plzen Czech Republic, Union Agency -Science Press, (2004).
Mcallister, D. F. and Roulier, J. A., An algorithm for computing a
shape preserving osculatory quadratic spline, ACM Transcations on
Mathematical software, 7, (1981), 331-347.
Nadler, E., Non-negativity of bivariate quadratic functions on
triangle, Computer Aided Geometric Design, 9, (1992), 195-205.
Piah, A. R. Mt., Goodman, T. N. T. and Unsworth, K., Positivitypreserving scattered data interpolation, Mathematics of Surfaces,
(2005), 336-349.
Schumaker, L. L., On shape preserving quadratic spline interpolation,
SIAM Journal of Numerical analysis, 20,(1983), 854-864.
Sarfraz, M., Interpolatory rational cubic spline with based point and
interval tension, Computer and Graphics, 16(4), (1992), 427-430.
Sarfraz, M., Visualization of positive and convex data by a rational
cubic spline interpolation, Information Sciences, 146, (2002), 239254.
Sarfraz, M., Butt, S. and Hussain, M. Z., Visualization of shaped data
by rational cubic spline interpolation, 25, (2001), 833-845.
Schmidt, J. W., Positivity, monotone and S-convex interpolation on
rectangular grids, Computing, 48, (1992), 363-371.


Integrated Visualization System for Monitoring Security in Large-Scale
Local Area Network
Shinichi Mukosaka∗
Graduate School of Information Systems

Graduate School of Information Systems

University of Electro-Communications

University of Electro-Communications

A BSTRACT
In monitoring security of enterprise or campus networks, detecting attacks from internal network to external network is becoming
more and more important. After detecting such attacks, ﬁnding the
location of the target PC is sometimes needed. This paper describes
a visual security monitoring system for large-scale local area network. The system integrates three information, logical, temporal,
and geographical information, in one 3-D visualization. The system
also provides effective interaction capabilities and ﬁltering mechanism. IDS logs obtained at the computer center of our university
were visualized, and typical examples such as botnet activities and
SSH brute force attack were discussed.
Keywords: information visualization, information security, local
area network, intrusion detection
Index Terms:
C.2.0 [Computer-Communication Networks]: General—Security and Protection C.2.0 [ComputerCommunication Networks]: General—Security and Protection C.2.3 [Computer-Communication Networks]: Network
Operations—Network Monitoring H.5.2 [Information Systems]:
Information Interfaces and Presentation—User Interfaces
1

Hideki Koike†

I NTRODUCTION

As network attacks, such as virus, worms, botnet, and so on, increase, real-time monitoring of such attacks by using intrusion detection systems (IDS) becomes more and more important. However, since the size of its logs is huge and most of alerts in the logs
are false positives, it is very difﬁcult to analyze the IDS logs.
To support this task, visualization systems which effectively use
information visualization techniques are being proposed and developed [1, 4, 3]. These systems read and analyze the IDS logs, and
visualize source IP addresses and their port numbers, destination IP
addresses and their port numbers, and time transition of amount of
attacks. Since some typical attacks are displayed as visual patterns,
it is reported that it is much easier to ﬁnd attacks by using such
visualization systems than by using text-based tools.
Usually, the focus of such security monitoring was on the attacks
from external network to internal network. By detecting worms or
SSH brute force attacks rapidly, the administrator took appropriate
actions such as closing the attacked port or prohibiting connection
from the source of attack by re-conﬁguring ﬁrewalls.
On the other hand, the attack from internal network to external
network is becoming a serious issue in most enterprises as well as
universities. For example, when some PCs are infected by virus,
they start attacking other PCs in internal network and then other
PCs in external network. Some users in internal network use P2P
software to illegally download software or multimedia contents. In
∗ e-mail:muko@vogue.is.uec.ac.jp
† e-mail:koike@acm.org

Asia-Pacific Symposium on Visualisation 2007
5 - 7 February, Sydney, NSW, Australia
1-4244-0809-1/07/$20.00 © 2007 IEEE

both cases, if the organization does not detect and stop such activities, the organization would be claimed and might be accused.
In such internal network monitoring, geographical information
is sometimes needed. In external network monitoring, we can only
obtain logical information such as IP addresses of source and destination and temporal information such as time transition of amount
of attacks. On the other hand, in the internal network monitoring,
we can obtain geographical information such as the location of network routers or PCs. Identifying the location of target PCs is sometimes important. When the administrators detect the IP address of
the PC, they can send an alert to the administrators of the subnet
where the target PCs belong. However, in emergent situation, the
administrators need to go to the building and disconnect the PCs
from network.
To summarize, the internal network monitoring system should
provide logical, temporal, and geographical information, and these
information should be highly integrated. Based on the discussion
above, we developed a visual security monitoring system for largescale local area network.
The next section describes related work on visualization-based
network monitoring system. Section 3 describes the system we developed. Section 4 shows example visualizations based on the real
logs obtained at the computer center of our university. Section 5
discusses advantages of our approach and future work.
2 R ELATED WORK
IDS RainStorm [1] visualizes a large-scale LAN of campus network, which has 2.5 class B IP address spaces. Its main view,
whose vertical axis represents IP address and horizontal axis represents time, shows all alerts of a day. Because of the resolution of the
screen, one raw pixel represents 20 addresses. Its color shows priority of the alarms. By selecting any IP address, the system changes
to zoom view. In this view, the right vertical axis represents external
IP addresses. Lines shows connections between external IP address
and local IP address.
NVisionIP [4] visualized a class B network on one display. Its
horizontal axis shows subnets and its vertical axis shows hosts in
each subnet. When showing detailed information, the user can see
trafﬁc of tens of hosts port by port. Moreover, the detailed trafﬁc of
each host can be seen.
IP Matrix [3] is a visualization system to show economically
higher or lower 16 bits of addresses in 2-D plane. They showed
propagation of several worms by using this technique.
Starmine [2] is a visualization system for cyber attacks. They
proposed to integrate logical, temporal, and geographical information in one 3-D visualization. Based on Snort logs, it visualized
sources of attacks on IP Matrix. They also visualized amounts of
attacks at “the sources of attacks” on a world map using Geo IP,
which converts IP address to latitude and longitude.
3 S YSTEM
This section describes a visual security monitoring system we developed. The system was developed to support system administrators of the computer center of our university. They are in charge of
monitoring our campus network (class-B). If they ﬁnd any security

41

a local network which has the same higher 16 bit, we assigned the
third octet to the vertical axis and the forth octet to the horizontal
axis.
Since all IP addresses of this network are not allocated to computers, the administrators want to know which IP addresses are really used. Moreover, they want to know the port numbers which
are opened on each PC. In cooperation with the computer center,
we performed a portscan by using Nmap to know which hosts are
active and which ports are opened. The ports between 0 and 1023
on all hosts were scanned.
3.4 Time-diagram

Figure 1: Overview

incidents, such as attacks by external hosts, unauthorized P2P connection, or IRC chats which might be caused by bot program, they
immediately broadcast its alert to admin mailing list.

The time-diagram is shown perpendicular to the IP Matrix Its horizontal axis represents time, and the right-hand side is newer. The
vertical axis represents amounts of attacks detected by IDS. Colors
are used to distinguish each time graph. In security monitoring, it is
more important to compare values of the network than to know their
exact values. For example, one graph is increasing or decreasing or
another graph behaves differently compared to other graphs.
The time-graph plane could be moved along the IP Matrix plane.
The administrator can change the focused forth octet. In its special
case, when the forth octet is 0, the graph shows the total amount of
attacks to each subnet. This is because information on each subnet
is more important than information on individual host. In addition, since the forth octet value 0 means subnet, it is intuitive to the
network experts. As a result, the administrator can understand the
overall of the network at a glance. Moreover, by exchanging the
vertical axis and the horizontal axis, the administrator can see the
time transition of attacks of each network address.
3.4.1 Local map

Figure 2: Information ﬂow

3.1 Log collection
The computer center is deploying two IDSs, proventia and snort, at
the boundary of the internal network and the external network. The
snort produces about 500 MB of logs and the proventia produces
about 20 - 100 MB of logs in a day. Both logs are saved in ASCII
format. In the following examples, the system visualized the logs
in ofﬂine mode. But it is possible to read and visualize them in
real-time.

In general, there is no relation between the geographical location of
PCs and their IP addresses. Therefore, it is difﬁcult to know where
the focused PC is located just by seeing its IP address. However,
if the administrator knows where the focused PC is located when
he/she detects any attacks to or from that PC, he/she could visit the
building where the PC is located and take an appropriate measure.
We developed a GUI tool to connect IP addresses and its geographical location. Once the relation between IP addresses and
their geographical location are conﬁgured, their relations are shown
as lines between IP Matrix and map. If all the lines are drawn, the
visualization becomes hard to see. Therefore, the system shows the
lines if the number of lines are less than 0 after applying some ﬁlters
to be described later.
3.4.2 Port number

3.2 Visualization
Figure 1 shows an overview of our visualization system. As shown
in this ﬁgure, there are three planes, time-diagram (left), IP Matrix
(right), and campus map (bottom). The user can see these three
information simultaneously. These three visualizations are highly
integrated, and if the user interacts with one of these planes, other
two planes change their views immediately.
3.3 IP Matrix
In order to show IP address space, we used IP Matrix which was
proposed by Ohno et.al. [3]. The IP Matrix shows the ﬁrst octet
and the second octet of IP address to monitor Internet space, or
the third octet and the fourth octet of IP address to monitor local
networks, both on 2-D Matrix format. Since our target network is

42

Figure 3: Visualization of TCP port and interaction

Destination port number in IDS logs often shows what service is
attacked. Therefore, we could see a trend of attacks by seeing the
amount of attacks to destination port. In our visualization system,
there is an additional visualization which shows amount of attacks
to the destination ports. The vertical axis represents port number,
and the horizontal axis represents amount of attacks to each port. A
bottom quarter of the vertical axis shows so-called well known ports
between 0 and 1024 and other three quarter shows ports between
1024 and 65535. The well known ports often become targets of
attacks because they include important services such as web, mail,
DNS, and so on. If every ports are laid out equally on the vertical
axis, these important well known ports use only 1.56 % of the axis.
In that case, the administrators might fail to ﬁnd attacks to these
ports.
We also used a zooming interface such as presented in LensBar
[5]. If the administrator set a cursor on a particular point of the
vertical axis, consecutive ports before and after the selected port
are expanded such as shown in Figure 3. When the administrator
clicks a mouse button in this situation, the expanded view is ﬁxed
and does not change even if the mouse is moved. By selecting any
port from these expanded ports, the administrator can set their focus
to that port. On the other hand, it is rather difﬁcult to select any
ports between 1024 and 65535. In this case, the administrator can
set their focus by typing a port number.
3.5 Operation
The system is highly interactive. The administrator can change
viewpoint, set ﬁlters, switch between inbound and outbound attacks, and exchange vertical and horizontal axis of IP Matrix.

and time-diagram are good at monitoring IP addresses and time
transition, respectively. The expansion view is good at analyzing
three types of information (i.e. logical, temporal, and geographical) simultaneously. Although many 3-D visualization system can
change its views freely, it is sometimes difﬁcult to get appropriate
view. Therefore, we provided the limited number of views which
are necessary to analyze.
3.5.3 Filtering
It is difﬁcult to read entire logs because they are too huge in size.
Many expert administrators use UNIX “grep” command to ﬁnd the
log entries they focus. Therefore, it is necessary to provide the
similar ﬁltering mechanism in visualization system. Our system
provides some ﬁltering capabilities, such as focusing on one port,
some ports, particular range of ports, or all ports except for one
port. For example, when the administrator want to see ports except
for SSH, he/she would type “port -22” in command mode such as
shown in Figure 7. When the port is selected, related information
is shown on IP Matrix and time-diagram. And the relation between
IP addresses and their actual locations are shown by lines.
4

E XAMPLES

In this section, we will show some visualization results we obtained
when monitoring our campus network.
4.1 Botnet

3.5.1 Command
There are GUI (Graphical User Interfaces) and CUI (Character User
Interfaces) to perform operations. The GUI is better in interactivity,
but it is slower when performing accurate operation. Since the target users of our system are computer experts, the system provides
CUI mode for faster operations.
3.5.2 Change of viewpoint

Figure 5: An activity of a bot program

Figure 4: An expansion view

In order to solve occlusions in 3-D visualization, the system
provides a capability of viewpoint change. The administrator can
choose a perspective overview as shown in Figure 4, IP Matrix
view, time-diagram view, or expansion view. These four views
can be changed just by typing a key, and the transition from one
view to another is smoothly animated. The perspective overview
is good at recognizing whole information at a glance. IP Matrix

Figure 5 shows a screenshot when the system detected alerts on
IRC chat, which is well known to be used as a communication channel of botnet. Botnet is malicious network which is illegally operated by a remote attacker. The bot program connects to an IRC
server to receive an order from the attacker. Since IRC server often
uses 6667 port, the communication shown in this ﬁgure is suspicious. We applied a visual ﬁlter focusing on 6667 port and focusing
on outbound attacks.
It is observed that there are alerts on 6667 port at some hosts. A
blue line is very similar to a purple line. It is supposed that these
PCs have been infected by bot. By seeing the map, it is understandable that these two hosts are located at different building. So the
administrator sent alert emails to both departments. Later the administrator visualized other days’ logs and observed that the subnet
including the host colored by blue also produced an alert on IRC
server. It means that this subnet is not only infected by bot client
but also infected by bot server. It concluded that this subnet should
be investigated in detail.

43

are important for the users. Moreover, these views can be changed
smoothly with animation in order to reduce the users’ cognitive load
when changing their views in 3-D.
The irregular layout of port numbers is another example. If we
simply visualize all ports in one dimension, it does not ﬁt in the
screen. On the other hand, we assigned more space to well known
ports than other ports because the well known ports are important
and there are more attacks to these ports. Moreover, we added
zooming interface to the port view.
The IP Matrix is very concise and space economical. We found
it very suitable for visualizing local area network.

Figure 6: Visualizing only attacks to SSH.

5.2 Future work
By using our system, an overview of attack trend is easily understood. To make the system more practical, it is necessary to add
capabilities to show detailed information of each attack. For example, it is hard to understand exact IP address just by seeing IP
Matrix. Therefore, we will show an IP address and alert names
automatically when the mouse cursor is on a particular point.
There are several false detections which are easy to identify. For
example, the Windows Update produces an IDS alert. To overcome
this issue, we will add other ﬁlters which eliminates well known
false detections.
In addition, the system used the results by portscans. However,
such results should be updated periodically. The automatic scanning mechanism should be combined.
Finally, we will keep monitoring our campus network in cooperation with staffs at computer center and evaluate the system.
6 C ONCLUSION
This paper described a visual security monitoring system which integrates three different information, logical information, temporal
information, and geographical information. These three kind of information is very important to monitor network securities. And it
is very important to have the geographical information with logical
IP address particularly in case of monitoring large-sized local area
network.

Figure 7: Hiding attacks to SSH

4.2 SSH brute force attack
SSH brute force attack is an attack which repeatedly tries to log
in to the system by changing password. Since this attack makes
one connection for one authentication, a lot of alerts are displayed
compared to other attacks. If we visualized all attacks including
SSH brute force attack, the visualization becomes very messy and
the administrator might miss other attacks. Figure 6 shows attacks
to TCP 22 port (i.e. SSH port), and Figure 7 shows a visualization
without this attack by ﬁltering out the attacks to TCP 22 port. By
hiding the SSH brute force attack, it is easier to see other attacks.
5 D ISCUSSION
We describe the advantages and proposed future work of this system.
5.1 Advantages
We showed our visualization system to expert system administrators at the computer center. They mostly gave us positive comments. Particularly, displaying the relation between IP addresses
and their physical locations were welcomed.
After showing the ﬁrst prototype of the system, they gave us
some requests including command operation, port number ﬁltering.
Then we added such functionality to the system.
The visual design of the system was done very carefully. For
example, we did not allow users to change their views freely in
3-D space. Instead, we provided limited number of views which

44

ACKNOWLEDGEMENTS
The authors would like to thank Prof. Hideaki Tsuchiya and Mr.
Yoshiharu Saiki at the computer center of the University of ElectroCommunications, who allowed us to use IDS logs and provided us
useful comments.
R EFERENCES
[1] K. Abdullah, C. Lee, G. J. Conti, J. A. Copeland, and J. T. Stasko. IDS
RainStorm: Visualizing IDS Alarms. IEEE Workshop on Visualization
for Computer Security (VizSEC 2005), page 1, 2005.
[2] Y. Hideshima and H. Koike. STARMINE : A Visualization System for
Cyber Attacks. Asia Paciﬁc Symposium on Information Visualisation
(APVIS2006), 60:131–138, 2006.
[3] H. Koike, K. Ohno, and K. Koizumi. Visualizing Cyber Attacks using IP Matrix. IEEE Workshop on Visualization for Computer Security
(VizSEC 2005), page 11, 2005.
[4] K. Lakkaraju, R. Bearavolu, A. Slagell, W. Yurcik, and S. North.
Closing-the-Loop in NVisionIP: Integrating Discovery and Search in
Security Visualizations. In IEEE Workshops on Visualization for Computer Security (VizSEC2005), page 9, Washington, DC, USA, 2005.
IEEE Computer Society.
[5] T. Masui. LensBar - Visualization for Browsing and Filtering Large
Lists of Data. In INFOVIS ’98: Proceedings of the 1998 IEEE Symposium on Information Visualization, pages 113–120, Washington, DC,
USA, 1998. IEEE Computer Society.


2009 Sixth International Conference on Computer Graphics, Imaging and Visualization

A Locatable Zero Watermarking Scheme and Visualization for 3D Mesh Models
Zhang Jiawan1, Pan Gang1, Jiang Chen1, Zhou Xiaozhou2
1
Tianjin University, 2University of Alberta
{jwzhang@tju.edu.cn, pangang@tju.edu.cn, tjujiangchen@gmail.com, xzhou3@cs.ualberta.ca}
the 2D image zero watermarking research [22][23]. But
the research on zero watermarking for 3D mesh models
is just at the beginning. In this paper, a robust zerowatermarking method based on octree-codec would be
described, which can resist both global and local attack.
On the whole, our scheme consists of two steps:
generating zero-watermark of original mesh without
embedding, detecting the zero-watermark from the
processed mesh without the orginal one. We also
visualize the changed-region on the original or processed
3D models after compute the similarity of watermarks
between them. In this way, not only can we achieve the
goal of integrity checking, but also locate the changedregion and visualize the tendency of derivation by means
of our merit of similarity. There are many possible
applications: mesh simplification, reverse engineering
(comparison between a CAD model and a numerical
model of the real object), mesh segmentation, mesh
processing algorithm characterization, etc.

Abstract
Nowadays, most 3D mesh model protections are
based on embedding watermarking system. These
methods have to change the original mesh data to
achieve the watermarking. Considering the sensitivity
and complexity of 3D mesh data, this paper proposes a
disturbing free 'zero-watermarking' algorithm, which is
based on octree partition. For each octant, we employ
parameterization and Singular Value Decomposition
(SVD) to analyze the 3D geometry signal and construct
the zero-watermark with corresponding octree-codec.
The integrity of protected 3D mesh can be checked
through computing the similarity of watermark between
original and processed mesh. Moreover, the results are
represented in a visual way, which means the tendency of
deviation and changed region will be colored according
to our merits of similarity. The Experiment results verify
that the algorithm is robust to various attacks including
affine transformation, vetex reordering, noise addition,
cropping, simplifying, and even mixed attack.

2. Related Work

Keywords--- Zero watermarking; Octree; Planar
parameterize; SVD; SSIM; Visualization

In 1997, Ohbuchi [11] presented the first digital
watermarking algorithm for 3D mesh models in the
Proceedings of ACM Multimedia 97. This showed that
digital watermarking technology had transferred from 2D
multimedia to 3D polygonal models. In the following
year, they published many correlative articles [9] [11]
[15] [14] [10]on the mesh watermarking. Subsequently,
many new methods were proposed. According to the
domain which the watermark was embedded in, these
algorithms can be classified into two categories: spatial
domain
watermarking
and
transform
domain
watermarking.
Two of the most representative and historic spatial
domain methods are the Triangular Similarity Quadruple
(TSQ) and the Tetrahedral Volume Ratio (TVR) [9].
Praun and Hoppe [16] applied Spread-spectrum filters to
the triangular mesh. The basic idea of the Wanger's
method [21] is embedding the watermark into the pixel
value's lower bits. Benedens proposed two kinds of
watermarking algorithms with high capacity [1]: Vertex
Flood Algorithm (VFA) and Temporal Frame Averaging
(TFA). Besides, he also developed other two methods
named Normal Bin Encoding and Affine Invariant

1. Introduction
Along with the explosive growth of 3D products for
the animation and CAD, the problem of copyright
protection for 3D models has attracted more and more
attentions recently. Digital watermarking is one solution
for this problem. The basic idea of watermarking
technique is watermark embedding and detection.
However, since the process of embedding will disturb the
data of 3D triangular mesh (the most prevalent
presentation of 3D models), it is not appropriate for 3D
mesh. For example, many kinds of 3D models, like the
architectural ones, are very sensitive to microscopic
changes, which could cause enormous altering of
structural properties.
An approach called 'zero-watermarking' is needed to
change the traditional methods that watermark is
embedded into the objects, so that the watermarked item
is distortion-free. There have been some achievements in
978-0-7695-3789-4/09 $25.00 © 2009 IEEE
DOI 10.1109/CGIV.2009.49

510

Fig1. Flow Chart of Algorithm Proposed In This Paper.
Embedding, both are based on the surface normal's
alteration [12], which can withstand the simplification
attack only. The first transform domain watermarking
method was presented by [3], who implemented the lazy
wavelet transform to decompose the mesh model into a
spectral domain. Yin [25] employed the multi-resolution
decomposition of polygonal mesh shapes to separate a
mesh. Ohbuchi [13] used eigenvectors of the Laplace
matrix as the orthogonal basis to get the pseudo spectrum
of vertices' coordinates. This approach performs well but
needs large amount of computation. Another method
proposed in [19] was mainly based on two ideas: PCA
(Primary Component Analysis) preprocess method for
3D meshes given in [7], and lossless octree coding
theory proposed in [2]. It has a big embedding space and
is robust against translation, rotation, uniform scaling
and vertex reordering attacks with blind detection. But
the way to present the relativities between two models is
challenged and this method can not locate the changedregions on the 3D models.
Nevertheless, all of the algorithms above have to
disturb the data of meshes to perform embedding. In our
zero-watermarking scheme, we use watermarking
generation instead of embedding. Inspired by Zhou's
framework [26] for geometric signal processing, we
transform the original signals defined on meshes to
planar signals. Therefore, we can easily generate
watermark by using 2D multimedia watermarking
techniques. Visualization is a more effective way to
analyze and compare 3D meshes. Silva [20] provided a
method to represent the computed figures of merit, but it
fails in visualizing the differences between the merits of
two meshes. We improve several steps and adjust it to
showing our results.

3.1. Octree partition and codc
Various types of spatially-based tree structures have
been found to be effective in supporting searching
operations [17] and domain discretization operations [18]
[24]. The specific tree structure investigated here is an
octree structure. We introduce octree partition for four
reasons:
1) Multi-scale solution;
2) Locate changed-region;
3) Low time complexity;
4) Invariant to uniform scaling and translation.
The octree structure can be defined by enclosing the
domain in a mesh which represents the root of the octree,
and then subdividing the whole mesh into the eight
octants of the root by bisection in all three directions.
Those octants are then recursively subdivided to
whatever levels are desired (we specify the level to 5 in
our experiment). However, there is an exception in the
subdivision process when the octants turn out to be a
disconnected or a non-convex 3D mesh, which is not
isomorphic with any 2D plane. In that case, we continue
subdividing until the all of the octants meet the
requirements of a convex triangular mesh, serving as a
proper input for parameterization. In addition, because
octree partition is very sensitive to rotation of 3D meshes,
PCA is used to preprocess 3D meshes to make sure the
model at a unique posture [19].

3.2. Zero Watermark Generation
In this section, the methods used in generating zerowatermark will be described in detail. For each node in
octree the following steps are performed:
(1) Planar parameterization. The mean value
coordinates parameterization method is introduced by
Floater [4] [5].
By deriving an application of the mean theorem for
harmonic functions, the barycentric coordinates are
unconditionally positive. This method is an
approximation of the discrete conformal mapping, a
guaranteed one to one mapping when the border is

3. Zero Watermarking Schemes for 3D Mesh
Model
The method proposed in this paper is suitable for the
triangular mesh model only. Figure 1 shows the process
of this scheme.

511

convex. Fig 2 shows the result of Floater
parameterization with a square border. Points with three
dimensional coordinates in space have been mapped to
points on the plane.

weight of

S F . WM is the watermark of a single

singular value vector and ( N × K ) numbers of WM
construct the watermark vector. Due to characteristics of
the mean value coordinates parameterization, the amount
of points in the central part of the plane is larger than the
boundary area. When converted to the mapping matrix,
the values in the middle become bigger correspondingly.
This will make some peaks appear in the watermark
vector. The acme's value is so huge that the balance
between each part is destroyed. We re-balance the
watermark vector by limiting the biggest value of the
vector. A threshold TV is used. Once WM exceeds this
2

threshold, set it to

Fig 2. Floater Parameterization

TV S.

After generating the watermark vector for every
node in the octree, we use the corresponding codec to
encode and then register them in the IPR information
database. Finally, the triangular 3D mesh model will be
protected by the legitimate copyright.

(2) Construct coordinate mapping matrix. Setting
the same interval in x coordinate and y coordinate, the
parameterization plane is separated into blocks with the
same size. Count the number of vertices which in the
sub-block and construct the N × N mapping matrix by
filling the amount of the points into the corresponding
cell.

3.3. Watermark Detection
First, the zero-watermark (a set of watermark
vectors with corresponding codec) registered in the IPR
information database will be extracted. Second, calculate

(3) Analysis and Process. The PCA and DWT have
been used to preprocess image [6]S. However, singular
value decomposition is a more effective feature
extraction method because the singular values have such
properties: 1) can capture the basic structure of the
matrix data and represent the matrix's algebra nature; 2)
are not sensitive to the distortion of the data. The SVD is
performed on M × N matrix A :

the size of the sub-block K = N / L with the length of
watermark vector L . Third, perform PCA preprocess
described in [19]. Next, the watermark blind detection
begins. See Tab. 1 for the pseudocode of this process.
Algorithm 1: WATERMARKDETECTION(ObjectMesh)

A = USV T
(1)
Where U and V are M × M orthogonal matrix
and N × N orthogonal matrix, respectively, and S is a
M × N diagonal singular value matrix. Elements on the

diagonal line are named singular values of the image
matrix A . We break the N × N mapping matrix into
K × K sub-matrix, and then run the local SVD on these
sub-matrices respectively. After that, the result will be

(N × K )2 vectors which contain

K singular values in
the ascendant order.
(4) Generation. Loss of the significant information
is inevitable along with the decrease of dimensions.
Therefore, the high similarity between zero watermark
vectors extracted from different 3D models is a big
problem all the zero-watermarking methods are facing.
There is a trend of rapid decay when sorting the Singular
Values in descending order, so it is the previous largest
singular value reflecting the main features of the matrix.
We construct the zero-watermark using following
formula:

WM = S F × W + S S

The similarity of

VW and VW ' could be analyzed by

correlation test [8]. However, it focuses on the difference
between each other but ignores the structure signal inside
the matrix. Instead of the correlation test, we use the
Structural Similarity Index Method (SSIM) introduced in
[27]. This theory assumes that the Human Visual System
mainly depends on the structure information, and
changes to the structure of the image will affect its
quality. The similarity measurement system is a
combination of three comparisons: Luminance
Comparison, Contrast Comparison and Structure

(2)

S F is the first biggest singular value, S S is
the second biggest singular value and W represents the
Where

512

Figure 3: Visualization Mode with Color Scale. (a) is original mesh; (b) is deformed one. (c) and (d) are
visualized results on original and deformed models. The whole mesh are showed on the top right corner.
Comparison. The overall structure
measure between signals X and Y is:

SSIM ( x, y ) =
Where

μX

similarity

(2μ X μY + c1 )(2σ X Y + c2 )

(μ

2
X

)(

+ μY2 + c1 σ X2 + σ Y2 + c2

is the mean intensity,

deviation. The constant

σX

)

the size of the sub-block is set to 64 × 64.
Correspondingly, the length of zero watermark vectors is
64. All the models selected in the test are the triangular
mesh models.
There are two kinds of similarity: one is between the
different models' zero mark, the other is between the
same original model's zero marks. If the distinction
between the two categories is not obvious, the
algorithm's reliability will be questioned. So we test the
SSIM values between 4 different models' watermark
vector respectively, and all of these values are less than
10-2, showing a good reliability of our algorithm.
To test the performance of the algorithm against the
attacks, we examine lots of common attack methods. The
following explains why the zero watermarking scheme
show robustness against these attacks.
In general, we classify attack into two catalogues:
the lossless attack and the lossy one. We regard
translating, uniformed scaling, rotating and vertex
reordering as lossless attack. Translating and uniformed
scaling attack is invariant in the Octree partition step;
rotating attack is adjusted in PCA preprocess; vertex
reordering could be solved by parameterization, because
the distribution of points in the plane and the relative
position of each point are irrelevant to grid topological
data which is changed. We regard cropping, tampering,
simplifying and disturbing as lossy attack. Local attack,
like cropping and tampering, can be accurately marked in
our colored model; global attack, like simplifying and
disturbing, will also be demonstrated according to the
differentiation. Figure 4 illustrates our scheme on the evil
head model. Our scheme has detected the deformed
region, which is marked by rainbow color scale.

(3)

is the standard

c1 and c2 are included to avoid

μ X 2 + μY 2 and σ X 2 + σ Y 2 are
very close to zero. And the σ XY can be estimated as:
instability when both

σ XY =

1 n
∑ ( X i − μ X )(Yi − μY )
N − 1 i =1

(4)

Psossible value of SSIM is a number between -1 and 1.

3.4. Visualization
After watermark detection, we get a set of SSIM
values Q with octree-codec. However, it is still difficult
to quantify the value of two meshes' difference because
SSIM describes a general trend but not accurately. So we
represent the difference in a visual way. In our
visualization mode, we present the original model, the
processed model and two colored model. Although the
colored model is similar to the original model, the
presence of color can mask some features, which is the
reason why the original model is also presented. Figure 3
shows this visualization mode. (c)(d) are colored using a
rainbow color scale, mapping the SSIM value 1 to blue
and the minimum value obtained to red.
In fact, the rainbow color map should not be
perceived as being linear, so mapping values linearly is
not strictly correct. However, we use it because we are
focusing on basically qualitative information rather than
quantitative information.

4. Conclusions and Further Work
This paper proposed a novel zero-watermarking
scheme and visualization for 3D triangular mesh model.
The proposed octree-based scheme can generate zerowatermarking and locate unauthorized modifications
even if multiple illegal changes are made on a model
simultaneously. For the zero-watermarking process, the
proposed system parameterizes the 3D mesh into 2D

4. Experiments
To evaluate the robustness of the proposed scheme,
computer simulations are performed. In the experiment,
the size of the mapping matrix is set to 512×512; and

513

Figure 4: Results. (a) is the original model. The evil head model has 12,977 vertices and 25,888 faces. (b) (e) (h)
are the same view of the deformed model. (c) (f) (i) and (d) (g) (j) are results visualized on original model and
deformed one. (b) (c) (d) are half-global disturbed attacked models and its visualization,(e) (f) (g) are local
attacked model examples, (h) (i) (j) are global simplifying ones.
mesh, and then transforms it into the coordinate mapping
matrix, which is considered as the source signal of
watermark construction. We employ the SVD to analysis
the matrix and construct the zero-watermark. After that,
we introduced a way how to use the SSIM to evaluate the
watermarks' similarity. As a result, we locate
unauthorized modifications on the mesh and color it
using a common color scale.

References
[1]

[2]

5. Acknowledgment

[3]

This research is based in part on Zhang Junjin's
master thesis. We thank Zhang Junjin for providing the
previous work. In particular, we thank anonymous
reviewers for their valuable comments.
This work has been supported by National Natural
Science Foundation of China under Grant No.60673196,
the Natural Science Foundation of Tianjin, P.R.China,
under Grant No. 07F2030 and No.08ZCGYSF00401.

[4]
[5]
[6]
[7]

514

O. Benedens. Two high capacity methods for embedding
public watermarks into 3d polygonal models. Proceeding
of Multimedia and security-workshop at ACM
Multimedia 99 Orlando, pages 95–99, 1999.
Su Cai, Yue Qi, and Xukun Shen. 3d data codec and
transmission over the internet. volume 2007, pages 53 –
56, Perugia, Italy, 2007.
Satoshi Kanai Hiroaki Date. Digital watermarking for 3d
polygons using multiresolution wavelet decomposition In
Proc. Sixth IFIP WG 5.2 GEO-6, pages 296–307, 1998
Michael S. Floater. Parameterization and smooth
approximation of surface triangulations. Comput. Aided
Geom. Des., 14(3):231–250, 1997.
Michael S. Floater. Mean value coordinates. Computer
Aided Geometric Design, 20:2003, 2003.
A. Kaarna and P. Toivanen. Digital watermarking of
spectral images in pca/wavelet-transform domain.
volume 6, pages 3564–3567 vol.6, July 2003.
A Kalivas, A Tefas, and I Pitas. Watermarking of 3D
models using principal component analysis [J]. IEEE
International Conference on Acoustics, Speech, and

[8]

[9]
[10]

[11]

[12]

[13]

[14]

[15]

[16]

[17]

[18]
[19]

[20]

[21]

[22]

[23] Sun feng et al Yang Shuguo, Li Chunxia. Study on the
method of image non-watermark in dwt domain. Journal
of Image and Graphics, 8(1):664–669, 2003.
[24] Shephard MS Yerry MA. Automatic three-dimensional
mesh generation by the modified-octree technique. Int. J.
Numer. Meth. Eng, Eng, 1984.
[25] KK Yin, ZG Pan, JY Shi, and D Zhang. Robust mesh
watermarking based on multi-resolution processing.
COMPUTERS & GRAPHICS-UK, 25(3):409–420, JUN
2001.
[26] Kun Zhou, Hu-Jun Bao, and Jiao-Ying Shi. Unified
framework for digital geometry processing. Jisuanji
Xuebao/Chinese Journal of Computers, 25(9):904 – 909,
2002.
[27] Bovik A C Zhou Wang and Simoncelli E. Structural
Approaches to Image Quality Assessment to Appear in
Handbook of Image and Video Processing(Second
Edition). Academic Press, New York, USA, 2005.

Signal Processing (ICASSP'03), Apr 6-10, 2003(5): 676679.
M Mrak, S Grgic, and M Grgic. Picture quality measures
in image compression systems. In Proceedings of the
Eurocon 2003 conference, p. 233-237, Ljubljana,
Slovenia, 2003.
R. Ohbuchi, H. Masuda, and M. Aono. Embedding data
in 3D models, volume 1309, pages 1 – 1. Darmstadt,
Germany, 1997.
Ryutarou Ohbuchi, Hiroshi Masuda, and Masaki Aono.
Data embedding algorithms for geometrical and nongeometrical targets in three-dimensional polygonal
models. Computer Communications, 21(15):1344 –
1354, 1998.
Ryutarou Ohbuchi, Hiroshi Masuda, and Masaki Aono.
Watermarking three-dimensional polygonal models
through geometric and topological modifications. IEEE
Journal on Selected Areas in Communications, 16(4):551
– 560, 1998.
Ryutarou Ohbuchi, Akio Mukaiyama, and Shigeo
Takahashi.
A
frequency-domain
approach
to
watermarking 3d shapes. Computer Graphics Forum,
21:373–382, 2002.
Ryutarou Ohbuchi, Shigeo Takahashi, Takahiko
Miyazawa, and Akio Mukaiyama. Watermarking 3d
polygonal meshes in the mesh spectral domain. Pages 9 –
17, Ottawa, Ont., Canada, 2001.
Masuda H Ohbuchi R and Aono N. Watermarking
multiple object types in three-dimensional models. In
Proceedings of theWorkshop onMultimedia Security at
ACM M ultimedia’98, pages 83–91, 1998.
Masuda H Ohbuchi R and Aono N. Watermarking threedimensional polygonal models through geometric and
topological modification. IEEE Journal of Selected Areas
in Communications, April 1998.
H. Hoppe R. Praun and A. Finkelstein. Robust mesh
watermarking. In Computer Graphics Proceedings,
Annual Conference Series, ACM SIGGRAPH,
21(15):49–56, 1999.
Hanan Samet. Applications of spatial data structures:
Computer graphics, image processing, and GIS.
Addison-Wesley Longman Publishing Co., Inc., Boston,
MA, USA, 1990.
O’Bara RM Beall MW Shephard MS, de Cougny HL.
Automatic grid generation using spatially-based trees.
CRC Handbook of Grid Generation, Boca Raton, 1999.
Jun Shu, Yue Qi, Su Cai, and XuKun Shen. A novel
blind robust digital watermarking on 3d meshes. In
DMAMH ’07: Proceedings of the Second Workshop on
Digital Media and its Application in Museum &
Heritage, pages 25–31,Washington, DC, USA, 2007.
IEEE Computer Society.
S Silva, J Madeira, and BS Santos. Polymeco – a
polygonal mesh comparison tool. pages 842–847. IEEE
COMPUTER SOC, 2005. 9th International Conference
on Information Visualisation, London, ENGLAND, JUL
06-08, 2005.
Michael G Wagner. Robust watermarking of polygonal
meshes. In GMP ’00: Proceedings of the Geometric
Modeling and Processing 2000, page 201, Washington,
DC, USA, 2000. IEEE Computer Society.
Cheng-Ru Wang and Duan Li. Image zero-watermarking
utilizing wavelet zerotree structure and pca. Guangdian
Gongcheng/Opto-Electronic Engineering, 32(4):75 –
77+85, 2005.

515


2009 Sixth International Conference on Computer Graphics, Imaging and Visualization

Smoothing arc splines by cubic curves
Zulfiqar Habib
Department of Computer Science
FAST National University
of Computer & Emerging Sciences
B-Block, Faisal Town, Lahore, Pakistan
zulfiqar.habib@nu.edu.pk, drzhabib@hotmail.com
Abstract

but such arcs are not as easy to use, and are not as flexible
as B-splines. Li & Meek in [11] have considered an application of a pair of quadratic rational B´ezier or cubic curves to
smoothing arc splines of G1 continuity by replacing C-, S-,
and J-shaped biarcs passing through the joints of contact.
In their method, the number of spiral pieces in a single segment could be six for the C-shaped transition and is five for
the S- and J-shaped transitions with a larger angle θ < π.
In this paper a method is discussed for the replacement
of all the above mentioned three types of G1 biarcs with
their corresponding G2 transitions having just one inflection point in their curvature, i.e., maximum three spiral segments in a transition curve. These transitions are between
two circular arcs tangent to each other or between a straight
line and a circular arc tangent to each other. Walton & Meek
[19] and Habib & Sakai [8] considered planar G2 transition
between two circles with a single fair cubic B´ezier curve.
They showed there is no curvature extremum in the case of
an S-shaped transition, and there is a single curvature extremum in the case of C-shaped transition. However, their
method does not provide any solution for transition curves
when circular arcs on both sides are tangent to each other.
Such cases are discussed in [18] but without any estimation of number of curvature extrema in transition curves.
J-shaped case is presented in [21] but again there is no discussion on transition when straight line and circular arc becomes tangent to each other. Keeping in view the above
mentioned problems, the objectives of our paper are:

Arc splines are planar, tangent continuous, piecewise
curves made of circular arcs and straight line segments.
They are important in manufacturing industries because
of their use in the cutting paths for numerically controlled
cutting machinery, highway route and robot paths. This
paper considers how to smooth three kinds of G1 biarc
models: the C-, S-, and J-shaped, by replacing their parts
by a single G2 cubic B´ezier function. All kinds of transition
curves have just one inflection point in their curvature. Use
of a single curve rather than two functions has the benefit
because designers and implementers have fewer entities to
be concerned.
Key words: Arc splines; G2 continuity; Cubic B´ezier
function; Curvature extrema; Spiral; CAD

1 Introduction
Arc splines curves made of circular arcs and straight line
segments are used to reduce the excessive number of data
points with minimum alternation of the original profiles
[13, 14, 11]. They are important for computer controlled
cutting machines, for highway route planners as a natural
curve along which to plan the center line of a road, and for
non-holonomic (car like) robot paths [12, 22]. We consider
a cubic B´ezier function, common to all modern design systems and extensively used in [1, 9, 10, 15, 17, 16, 3].
The curvatures of G1 arc splines are strictly controlled
978-0-7695-3789-4/09 $25.00 © 2009 IEEE
DOI 10.1109/CGIV.2009.27

Manabu Sakai
Department of Mathematics
& Computer Science
Kagoshima University
Kagoshima 890-0065, Japan
msakai@sci.kagoshima-u.ac.jp

• To find a suitable method for the replacement of G1
biarcs with maximum three G2 spiral pieces by using
199

a single cubic B´ezier function for all types of transition
curves.

is G1 continuous and it has a continuous curvature [2]. G2
continuous curves are considered smoother than G1 continuous ones.
The term ‘spiral’ refers to a curved line segment whose
curvature varies monotonically with constant sign. Based
on Kneser’s theorem [4], any circle of curvature of a spiral
encloses all smaller circles of curvature and is enclosed by
all larger circles of curvature. So we cannot find the transition curve with a single spiral segment between the two
tangent circles or the intersecting circles.

• To modify the method of Habib & Sakai [8] for the
C- and S-shaped transitions, when both circular arcs
are tangent to each other, with the guarantee of the
unique inflection point in the curvature of G2 transition curves.
• To find a method for the J-shaped G2 transition curve,
when the straight line and circular arc are tangent to
each other, with the guarantee of just one inflection
point in its curvature.

3 Smoothing arc splines

• To find the sufficient conditions for the unique inflection point of the curvature of the transition curve.

(2.2)

We consider the smoothing of the arc spline, i.e., the
shapes of the C-, S- and J-shaped joints of G1 contact to the
ones of G2 contact from a larger circle Ω0 with center C0
and radius r0 (the straight line for J-case) to a smaller circle
Ω1 with center C1 and radius r1 , where μ = r0 /r1 (> 1).
Figures 1, 2, and 3, show G2 continuous cubic spiral transition curves from circle to circle C-shaped, circle to circle Sshaped, and straight line to circle J-shaped, respectively. In
these figures, the point of contact of both circles, or straight
line and circle is shown as small circle.
From now on, N means the number of the curvature extrema on the transition curve. Since the smaller circle Ω1
does not lie completely inside the lager circle Ω0 , Kneser’s
theorem implies that N ≥ 1. Therefore, we obtain a sufficient condition for N = 1 by use of Descartes’ rule of
signs on the number of the positive roots. For ease of presentation, we describe the biarc model in a local coordinate
system. In practical implementation of the smoothing arc
splines , a global coordinate system is required. The conversion of one coordinate system to another is a simple matter
of transformation.
A cubic B´ezier curve z(t) = (x(t), y(t)), has eight degrees of freedom in the interval t ∈ [0, 1], and is represented
as

A curve is G1 continuous if it is continuous and has a
continuous unit tangent vector. A curve is G2 continuous if

z(t) = (1 − t)3 p0 + 3t(1 − t)2 p1 + 3t2 (1 − t)p2 + t3 p3 ,
(3.1)
where pi , i = 0, . . . , 3, be the four distinct control points,
shown as small disks in Figures 1, 2, and 3. We assume
throughout this paper that the start point of transition curve
z(t) is at origin, i.e., p0 = (0,0). As cubic B´ezier curves
can be parameterized and transformed (affine maps), this

2 Notations and conventions
To aid concise writing of mathematical expressions, the
symbols · and × are used to denote the usual inner product and signed z-component of the three-dimensional crossproduct of two vectors in the xy plane, respectively, e.g.,
a · b = ax b x + ay b y = a
a × b = ax b y − ay b x = a

b cos θ,
b sin θ,

where θ is the counterclockwise angle from a to b.
The signed curvature of a parametric curve P (t) in the
plane is
P (t) × P (t)
,
(2.1)
κ(t) =
3
P (t)
when P (t) is non-zero. Positive curvature has the center
of curvature on the left as one traverses the curve in the
direction of increasing parameter. For non-zero curvature,
the radius of curvature, positive by convention, is 1/|κ(t)|.
The derivative κ (t) of the curvature in (2.1) yields
κ (t) =

φ(t)
P (t)

5,

where
φ(t)

=

d
{P (t) × P (t)}
dt
−3{P (t) × P (t)}{P (t) · P (t)}.
P (t)

2

200

obtained by choosing the constraints

condition will not cause any loss of generality.

3.1

h = p2 r0 ,

C-shaped transition curve

2 sin θ
.
3

p = m sec θ

In addition to conditions in (3.2), we require that the
larger circle Ω0 touches inside the osculating circle Ω1 , i.e.,
0

C 0 − C 1 = r0 − r1 ,

C0

where centers of both circles are

r1

1

C0 = (0, r0 ),

2Θ
p3

C1

1

p2

r0

C1 = z(1) − r1 (sin 2θ, − cos 2θ), (3.5)

respectively. Above condition gives a quadratic equation
in u(= tan2 θ) whose solution for u with D = 2μ +
2
{1 + (1 − m)μ} (> 0) is

k

tan2 θ =

(3.6)
√
1 + (1 − m)μ + (1 − m − m )μ ± (μ − 1) D
.
m2 μ2
2

h
p0

g

1

p1

Θ

From (2.2) and all the above discussion, we find that the
curvature of the C-shaped transition curve (3.3) has only
one inflection point for (μ, m), limited by (3.7) and

For C-shaped transition curve between two circles, we
need the following conditions:
(i) p0 = (0, 0),
(v) (p2 − p1 )
(vi) z (1)

μ 9 − 32m + 36m2 − 12m3
2

−3(1 − m)

(ii) κ(0) = 1/r0 ,

(iii) κ(1) = 1/r1 ,

(iv) z (0)

(1, 0),

3.2

(cos θ, sin θ),

(cos 2θ, sin 2θ).

y(t) =

(3.8)

9 − 28m + 22m2 > m(3m − 2).

S-shaped transition curve

(3.2)

p2

Let the given angle from pi+1 − pi to pi+2 − pi+1 , i =
0, 1,is θ(∈ (0, π/2)), as shown in Figure 1, i.e., angle from
the tangent at start point z (0) to the tangent at end point
z (1) of transition curve is (0, π).
The desired C-shaped family of transition curves z(t),
satisfying the above conditions, with a parameter m is
=

2

The G2 transition curve exists if the larger solution of (3.7)
√
is positive, i.e., for −1 + 3 < m < 1, we have
√
√
(1 + 3)(3 − m2 ) − (1 + 2 3)m
1<μ<
.
(3.7)
m(−2 + 2m + m2 )

Figure 1. C-shaped transition curve for (m =
0.8), and (r0 , r1 ) = (2, 1).

x(t)

(3.4)

p0

g

p1

Θ
Θ h

k

0

p3

1

Figure 2. The S-shaped transition curve for
(m = 0.6) and (r0 , r1 ) = (2, 1).

2mr1 tμ
(3 − 3(1 − m)t + (1 − 2m)t2 )μ
3
(3.3)
+t2 cos 2θ tan θ,
2mr1 t2 μ
2t cos2 θ + m(3 − 2t)μ tan2 θ,
3
201

Here we consider an S-shaped transition curve z(t) of
the form (3.1) with the following conditions:
(i) p0 = (0, 0),

(vi) z (1)

(iv) z (0)

(1, 0)

p3

(cos θ, sin θ),

(1, 0).

(3.9)

4
mr1 tμ {9μ − 3(3 − 2m)tμ
27
+t2 (3 + (3 − 4m)μ) tan θ,
8 2 2
y(t) =
m r1 t (3 − 2t)μ2 tan2 θ,
27
obtained by choosing the constraints

(i) p0 = (0, 0),
(3.10)

(1, 0),

(vi) z (1)

(cos 2θ, sin 2θ),

(iii) κ(1) = 1/r1 ,

(v) p1 = (1 − m)p0 + mp2 ,

y(1) + r1 cos 2θ = r1 ,

(3.16)

(3.17)

where center of circle is

(3.11)
C1 = z(1) − r1 (sin 2θ, − cos 2θ).
(3.12)

(3.18)

Here the curvature of the transition curve should have
only one inflection point. The desired J-shaped family of
transition curves z(t), satisfying the above conditions, with
a parameter m is

respectively. From above condition, we have
9(1 − μ + μ2 ) − 6mμ(1 + μ) − 2m2 μ2
,
2m2 μ2
(3.13)
where the positive right hand side of above expression requires
3(1 − μ + μ2 )
m<
.
(3.14)
μ 1 + μ + 3(1 + μ2 )
tan2 θ =

x(t)

=

rt
t(9 − 5t) + m(9 − 18t + 8t2 )+
4(1 − m)
(1 − m)t2 (2 cos 2θ + cos 4θ) sec2 θ tan θ,

y(t)

We can derive from (2.2) and the above discussion that
the curvature of the S-shaped transition curve (3.10) has
only one inflection point for (μ, m), limited by (3.14) and

= 2rt3 sin2 θ.

(3.19)

From all the above discussion and (2.2), we conclude
that the curvature of the J-shaped transition curve (3.19) has
just one inflection point for (μ, m), limited by

40 2m2 μ2 (53 + 86μ + 53μ2 )
−6mμ(1 + u)(37 − 38μ + 37μ2 )

(ii) κ(0) = 0,

(iv) z (0)

where centers of both circles are
C1 = z(1) − r1 (0, 1),

p2

where θ ∈ (0, π/2) and m ∈ (0, 1).
In addition to the above conditions, we also assume that
the osculating circle Ω1 with radius r1 is tangent to the xaxis, i.e.,

8 sin θ
.
27
In addition to conditions in (3.9), we also assume that
the larger circle Ω0 touches outside the osculating circle Ω1 ,
i.e.,

C0 = (0, r0 ),

h

k

Here we consider a J-shaped transition curve z(t) of the
form (3.1), as shown in Figure 3, with following conditions:

p = mμ sec θ

C 0 − C 1 = r0 + r1 ,

p1

Θ

1

Figure 3. The J-shaped transition curve for
(m = 0.5) and (r1 , θ) = (1/2, π/12).

=

h = p2 r0 ,

g

p0

Let the angle between pi+1 − pi to pi+2 − pi+1 , i = 0, 1,
is θ ∈ (0, π/2), as shown in Figure 2. The tangents at start
point z (0) and at end point z (1) are parallel. Here the
curvature of the transition curve should change sign to allow
an inflection point in S-shaped transition curve.
The desired S-shaped family of transition curves z(t),
satisfying the above conditions, with a parameter m is
x(t)

J-shaped transition curve

(ii) κ(0) = 1/r0 ,

iii) κ(1) = −1/r1 ,
(v) (p2 − p1 )

3.3

max (d0 , d1 ) ≤ m < 1,

(3.15)

+9(13 − 24μ + 34μ2 − 24μ3 + 13μ4 ) < 0.

202

(3.20)

5 Comparison
A pair of conics are used in [11] to smooth a C-shaped
curve and a cubic B´ezier curve is used to smooth S- and Jshaped curves. We have used a single cubic B´ezier function
for all types of transition curves providing designers and
implementers fewer entities to be concerned.
In examples of [11], S- and C-Shaped transitions comprise three spiral pieces while the J-shaped transition comprises two spiral pieces. With a larger angle θ, the number
of spiral pieces increases up to six for the C-shaped transition and up to five for the S- and J-shaped transitions. We
have provided sufficient conditions for the unique inflection
point of the curvature of the transition curves, i.e., there are
maximum three spiral pieces in a single cubic segment for
all kind of transition curves.
Further in [11], the curvature plots in Figures 9 and 11 of
smoothed version of arc spline in Figure 8 and 10, respectively, have very clear overshoots. Whereas in our method,
the curvature plot of arc spline approximation in 4 is more
smoother and it has significantly less overshoot.

(a) A spiral spline

(b) The curvature plot of spiral spline

Figure 4. A smoothed version of the arc
spline of Fig. 6 in [11].

6 Conclusion and future research work
We presented a method for smoothing a G1 arc-spline by
replacing its three types of parts (C-, S-, and J-shaped) with
G2 spiral transition curves. The main advantages of our
method are that all kind of transition curves can be achieved
from a single cubic B´ezier function of fixed and low degree,
and are comprising of just one inflection point in their curvature.
A PH (Pythagorean Hodograph) quintic curve has the attractive properties that its arc-length is a polynomial of its
parameter, and its offset is rational. A quintic is the lowest
degree PH curve that may have an inflection point. These
curves have been discussed in [6, 5, 7, 20]. In our future
research work, the results for the cubic G2 curve will be extended to PH quintic G2 transition curves for smoothing a
G1 arc-spline.

where
d0

=

d1

=

9
,
39 − 4d − 4d2
1
51 − 16d − 16d2 −
10(9 − 4d − 4d2 )
1521 − 1152 − 896d2 + 512d3 + 256d4 ,

for d = cos 2θ.

4 Numerical Example
An arc spline of Figure 6 in [11] has five elements. This
example contains three types of joints: J-, C-, and S-shaped.
The total arc-length of this arc spline is 465. A smoothed
version of this arc spline and its curvature plot is given in
Figure 4. The total arc-length of this smoothed version is
441 approximately.

Acknowledgment
This work is supported by Higher Education Commission (HEC) and FAST National University of Computer &
Emerging Sciences, Pakistan.
203

References

[15] M. Sarfraz. Curve fitting for large data using rational cubic splines. International Journal of Computers and Their
Applications, 10(3), 2003.
[16] M. Sarfraz. Designing objects with a spline. International
Journal of Computer Mathematics, 2008.
[17] M. Sarfraz and A. Masood. Capturing outlines of planar images using bezier cubics. Computers & Graphics, 31:719–
729, 2007.
[18] Sarpono, Z. Habib, and M. Sakai. Fair cubic transition
between two circles with one circle inside or tangent to
the other. Numerical Algorithms, October 2008. In press,
http://dx.doi.org/10.1007/s11075-008-9252-1.
[19] D. J. Walton and D. S. Meek. Planar G2 transition between
two circles with a fair cubic B´ezier curve. Computer Aided
Design, 31(14):857–866, 1999.
[20] D. J. Walton and D. S. Meek. G2 curve design with a pair of
Pythagorean hodograph quintic spiral segments. Computer
Aided Geometric Design, 24(5):267–285, 2007.
[21] D. J. Walton, D. S. Meek, and J. M. Ali. Planar G2 transition
curves composed of cubic B´ezier spiral segments. Computational and Applied Mathematics, 157(2):453–476, 2003.
[22] Z. Yao and A. Joneja. Path generation for high speed machining using spiral curves. Computer-Aided Design & Applications, 4:191–198, 2007.

[1] D. A. Dietz, B. Piper, and E. Sebe. Rational cubic spirals.
Computer-Aided Design, 40:3–12, 2008.
[2] G. Farin. Curves and Surfaces for Computer Aided Geometric Design: A Practical Guide. Academic Press, NewYork,
4th edition, 1997.
[3] T. N. T. Goodman and D. S. Meek. Planar interpolation
with a pair of rational spirals. Computational and Applied
Mathematics, 201:112–127, 2007.
[4] H. Guggenheimer. Differential Geometry. McGraw-Hill,
New York, 1963.
[5] Z. Habib and M. Sakai. G2 Pythogorean hodograph quintic transition between circles with shape control. Computer Aided Geometric Design, 24(5):252–266, 2007.
http://dx.doi.org/10.1016/j.cagd.2007.03.004.
[6] Z. Habib and M. Sakai. On PH quintic spirals joining two circles with one circle inside the other.
Computer-Aided
Design,
39(2):125–132,
2007.
http://dx.doi.org/10.1016/j.cad.2006.10.006.
[7] Z. Habib and M. Sakai. Transition between concentric or
tangent circles with a single segment of G2 PH quintic
curve. Computer Aided Geometric Design, 25(4-5):247–
257, 2008. http://dx.doi.org/10.1016/j.cagd.2007.10.006.
[8] Z. Habib and M. Sakai.
G2 cubic transition between two circles with shape control.
Computational and Applied Mathematics, 223:133–144, 2009.
http://dx.doi.org/10.1016/j.cam.2007.12.024.
[9] Z. Habib, M. Sarfraz, and M. Sakai.
Rational cubic spline interpolation with shape control.
Computers & Graphics, 29(4):594–605, 2005.
http://dx.doi.org/10.1016/j.cag.2005.05.010.
[10] M. Held and S. C.
A smooth spiral tool
path for high speed machining of 2d pockets.
Computer-Aided Design, 41(7):539–550, July 2009.
http://dx.doi.org/10.1016/j.cad.2009.04.002.
[11] Z. Li and D. Meek. Smoothing an arc spline. Computers &
Graphics, 29:576–587, 2005.
[12] T. Liang, J. Liu, G. Hung, and Y. Chang. Practical and flexible path planning for car-like mobile robot using maximalcurvature cubic spiral. Robotics and Autonomous Systems,
52(4):312–335, 2005.
[13] D. S. Meek, B. Ong, and D. J. Walton. A constrained
guided G1 continuous spline curve. Computer Aided Design, 35:591–599, 2003.
[14] D. S. Meek and D. J. Walton. The family of biarcs that
matches planar, two-point G1 Hermite data. Computational
and Applied Mathematics, 212:31–45, 2008.

204


Fifth International Conference on Computer Graphics, Imaging and Visualization
Visualisation

Algorithm for TSS mapping using satellite data for Penang Island, Malaysia
H. S. Lim, M. Z. MatJafri, K. Abdullah, A. N. Alias, J. M. Rajab and N. Mohd. Saleh
School of Physics,
Universiti Sains Malaysia,
11800 Penang, Malaysia
E-mail: hslim@usm.my, mjafri@usm.my, khirudd@usm.my
Tel: +604-6533888, Fax: +604-6579150
signals has also been developed for water quality mapping and
monitoring [8].
Monitoring water quality in reservoir using conventional
sampling technique is time consuming and the measured
samples are unable to represent the detailed distribution
patterns. However remote sensing imagery can provide a
synoptic view of the study area that can be related to the
collected water samples based on the proposed water quality
algorithm. The calibrated algorithm can be applied to the
imagery for mapping the water quality in Malaysia. In this
study, the selected water quality parameter was total
suspended solids (TSS).
The main objective of the present study is to test the
performance of our proposed algorithm for mapping total
suspended solids in marine environments around Penang
Island, Malaysia using Landsat TM image. We also attempted
to apply a simple correction technique to the satellite image.

Abstract
The traditional sampling method for environmental
monitoring of aerosols is time consuming and expensive.
Remote sensing data have been widely used in environmental
studies like land cover change, flood observation,
environmental pollution monitoring. This study is dealing with
obtaining water pollution using Landsat TM data over Penang
Strait, Malaysia. With the availability of remotely sensed and
in situ data sets the derivable geophysical parameters is
sediment (suspended matter) concentration. The proposed
algorithm is based on the reflectance model that is a function
of the inherent optical properties of water, which can be
related to its constituent’s concentrations. Regression and
accuracy analysis is performed using SPSS analysis software.
Water samples locations were determined using a handheld
GPS. The digital numbers were extracted corresponding to the
ground-truth locations for each band was converted into
radiance and reflectance and later used for the calibration of
the developed algorithm. The efficiency of the present
proposed algorithm, in comparison to other forms of
algorithm, was also investigated. Based on the values of the
correlation coefficient (R) and root-mean-square deviation
(RMS), the proposed algorithm is considered superior. The
proposed algorithm is considered superior to other tested
algorithms based on the values of the correlation coefficient,
R=0.94 and root-mean-square error, RMS=5 mg/l. The
calibrated TSS algorithm was used to generate the water
quality map. The TSS map was color-coded and geometrically
corrected for visual interpretation.

2. Study area
The study area is the Penang Island, Malaysia,
located within latitudes 5o 12’ N to 5o 30’ N and longitudes
100o 09’ E to 100o 26’ E. The map of the region is shown in
Figure 1. The satellite image was acquired on 8 February
2007. Water samples were collected simultaneously with the
satellite images acquisition from a small boat. The sampling
locations were determined using a handheld Global
Positioning System (GPS). Water samples were analysed in
the laboratory to determine the TSS by using the standard
method as suggested by Strickland and Parson (1972) [3].

Keywords--- Algorithm, TSS, Landsat TM

1. Introduction
Water quality is an important factor for human health
and quality of life. This has been recognized many years ago
[1]. Traditionally, monitoring of water quality is carried out
through shipboard water sampling and laboratory analysis.
Such methods are not only labour-intensive, but sampling is
also discrete in time and space. Remote sensing was an
alternative way to solve the problem for water quality
modelling. Satellite imagery has been widely used for water
quality studies in coastal regions and in inland lakes [2-7]. An
algorithm using multi-spectral radiance detected by the TM

978-0-7695-3359-9/08 $25.00 © 2008 IEEE
DOI 10.1109/CGIV.2008.18

376

Then equation (4) can be simplified to
R

c

b
Qa

(6)

where c = a constant
The inherent optical properties are determined by the contents
of the water. The contributions of the individual components
to the overall properties are strictly additive [14]. The total
absorption coefficient at wavelength, O, a(O), can be
considered to be the sum of absorption due to pure water,
aw(O), phytoplankton, ac(O), non-chlorophyllos particles of
biological and terrestrial origin, ap(O), and dissolved organic
matter or yellow substance, ay(O) [14]. Thus
a( O ) aw ( O )  ac ( O )  ap ( O )  ay ( O )

The absorption of pure seawater is practically the
same as the pure water in the visible region (400-700nm).
Absorption by dissolved salts is known to be negligible in this
region [14]. The absorption related to each substance is
expressed as the product of its concentration C
(phytoplankton), P (non-chlorophyllous particles), or Y
(yellow substance) and its corresponding specific absorption
coefficients ac*(O), ap*(O) and ay*(O) respectively.

Figure 1 Study area

3. Optical model of water
A physical model relating radiance from the water
column to the concentrations of the water’s constituents
provides the most effective way to analyze remotely sensed
data for water quality studies. Remote sensing reflectance, R,
is related to the irradiance reflectance just beneath the water
surface, Rird [9] and is calculated as:
R

(1  U )(1  V ) R
ird
n 2 (1  rR)Q

Therefore the total absorption
*
*
*
a( O ) aw ( O )  a c ( O )C  a p ( O )P  a y ( O )Y (8)
Similarly for the back-scattering coefficients [15]

bb ( O )

(3)

= internal Fresnel reflectance
= air-water Fresnel reflection at the interface
r = water-air reflection
n = refractive index (1.34)
Q =S
Equation (1), according to a study [9] can be approximated as
R
(4)
R 0.182 ird
Q

bb ( O )

b
a

(9)

*

*

*

b bw ( O )  b bc ( O )C  b bp ( O )P  b by ( O )Y

(10)

The symbol * denotes specific coefficients. The magnitude of
bbw(O) is 0.5bw(O) because the molecular volume-scattering
function of pure sea water, bw(O), is symmetrical [16].
For a case involving three water quality components,
e.g. chlorophyll, C, suspended sediment, P, and yellow
substance, Y, the simultaneous equations using equations (6)
to (8) for the three channels ( O1 , O 2 and O3 ) can be expressed

For estuaries water, backscatter is much less significant than
absorption [10]. Therefore, the irradiance reflectance just
below the water surface [11, 12, 13] is:

0.33

bbw ( O )  bbc ( O )  bbp ( O )  bby ( O )

where bbw(O), bbc(O), bbp(O), and bby(O) are the back-scattering
coefficients of water, chlorophyll, suspended matter and
yellow substance respectively. Then

where U
V

Rird

(7)

as:

(5)

R (O1 )

where
b = backscattering coefficient
a = absorption coefficient

377

R2

*
*
*
c [0.5bw (O1 )  bc (O1 )C  b p (O1 ) P  bby ( O1 )Y ]
Q [a w (O1 )  ac* (O1 )C  a *p (O 1 ) P  a *y ( O1 )Y ]

(11)

R ( O2 )

R2

c [0.5bw (O2 )  bc (O2 )C  b p (O2 ) P  bby ( O2 )Y ]
Q [a w (O2 )  ac* (O2 )C  a *p (O 2 ) P  a*y ( O2 )Y ]

R (O3 )

R3

c [0.5bw (O3 )  bc (O3 )C  b p (O3 ) P  bby ( O3 )Y ] (13)
Q [ a w (O3 )  ac* (O3 )C  a *p (O 3 ) P  a*y ( O3 )Y ]

*

*

*

*

*

(12)

*

where
bw (Ȝ)

= pure water backscattering coefficient

b (Ȝ)

=

chlorophyll

coefficient
b*p (Ȝ)

=

sediment

coefficient
b *y (Ȝ)

= yellow substance specific backscattering

coefficient
aw (Ȝ)

= pure water absorption coefficient

a (Ȝ)

= chlorophyll specific absorption coefficient

a (Ȝ)
a *y (Ȝ)

= sediment specific absorption coefficient

*
c

*
c

*
p

specific
specific

backscattering
backscattering

= yellow substance specific absorption

Figure 2 Raw satellite image

coefficient
C
P

A simple atmospheric correction, namely darkest
pixel technique was performed in this study. This is a very
simple correction, based on 2 assumptions:
• The first assumption is that in the darkest water pixel of the
image there is total light absorption and the radiation light
recorded by this pixel comes from the atmospheric path
radiance.
• Secondly it is assumed that the atmospheric path radiance is
uniform all over the image. The radiation of the darkest water
pixel (assumed to represent the atmosphere) is subtracted from
the whole image. The darkest pixel is found by searching for
the lowest values over water for all wavelengths. The pixel
with the lowest value for each band was selected as the
darkest pixel. The proposed algorithm is considered superior
to other tested algorithms based on the values of the
correlation coefficient, R=0.93 and root-mean-square error,
RMS=9 mg/l.
Finally, the TSS maps were generated using the
proposed calibrated algorithm. The colour digital image was
geometrically corrected using cubic convolution method of
second order polynomial. This produced a smoother goecoded
image. In addition, image smoothing was then performed on
the map to remove random noise and the generated map was
colour-coded for visual interpretation (Figure 3).

= chlorophyll concentration
= suspended sediment concentration

4. Regression Algorithm
TSS concentrations can be obtained by solving the
simultaneous equations (11), (12) and (13) to yield the series
consisting of the terms in R1, R2 and R3 (ignoring higher order
terms):
P = eo+e1R1+e2R2+e3R3+ e4R1R2+ e5R1R3+ e6R2 R3+ e7R1
2
+e8R22+e9R32 (14)
where the coefficient ej, j = 0, 1, 2, … are the functions related
to the coefficients used in equations (11), (12) and (13) which
are to be determined empirically from multiple regression
analysis. This equation is used to relate reflectance values
from the image bands to the observed TSS concentrations. In
this study, we used digital number (DN) instead of R values.

5. Data Analysis and Results
A colour digital image of SPOT (2433 pixels by 2069
lines) covering Penang Island, Malaysia was chosen in this
study. The spatial resolution of the image pixel is 10 m. Figure
2 show the raw SPOT 5 satellite scene.
The digital numbers (DN) for each band
corresponding to the sea-truth locations were determined. The
(DN) for each location of water sample was determined for
each band using various window sizes. In this study, The DN
values were extracted using window sizes of 3 by 3 pixels
because the data produced higher correlation coefficient.

378

[3]

[4]

[5]

[6]

[7]

[8]

Figure 3 TSS map around Penang Island, [Color
code: Blue = TSS < 100 mg/l, Green = TSS = 101-150
mg/l, Yellow = TSS = 151-200 mg/l, Brown = TSS =
201 – 250 mg/l and Red = TSS > 250 mg/l

[9]

[10]

Conclusion
[11]

This water quality study by using Landsat TM
satellite imagery produced successful results with high degree
of accuracies. The developed algorithm produced high R and
low RMS values. Futher studies have to be conducted to
improve the results.

[12]

[13]

Acknowledgements

[14]

This project was carried out using the USM short
term grants and Science Fund. We would like to thank the
technical staff who participated in this project. Thanks are also
extended to USM for support and encouragement.

[15]

References

[16]

[1] Sivertun, A. and Prange, L. (2003) Non-point source critical
area analysis in the Gisselo watershed using GIS.
Environmental Modelling & Software, 18, 887–898.
[2] Allee, R.J., and Johnson, J.E., 1999, Use of satellite imagery to
estimate surface chlorophyll-a and Secchi disc depth of Bull

379

Shoals, Arkansas, USA. International Journal of Remote
Sensing, 20, 10571072.
Baban, S.M., 1993, Detecting water quality parameters in the
Norfolk Broads, U. K., using Landsat imagery. International
Journal of Remote Sensing, 14, 12471267.
Dekker, A.G., and Peters, S.W.M., 1993, The use of Thematic
Mapper for the analysis of eutrophic lakes: a case study in the
Netherlands. International Journal of Remote Sensing, 14,
799821.
Ekstrand, S., 1992, Landsat TM based quantification of
chlorophyll-a during algae blooms in coastal waters.
International Journal of Remote Sensing, 13, 19131926.
Forster, B.C., Xingwei, I.S., and Baide, X., 1993, Remote
sensing of water quality parameters using landsat TM.
International Journal of Remote Sensing, 14, 27592771.
Ritchie, C.J., Cooper, C.M., and Schiebe, F.R., 1990, The
relationship of MSS and TM digital data with suspended
sediment, chlorophyll and temperature in Moon Lake,
Mississippi. Remote Sensing of environment, 33, 137-148.
Abdullah, K., M. Z. MatJafri, Z. B. Din, Y. Mahamod, and R.
Rainis, 2002,“Remote Sensing of Total Suspended Solids in
Coastal Waters of Penang, Malaysia”, Asian Journal of
Geoinformatics, 2(2), 53–58.
Doxaran, D., Froidefond, J. M., Lavender, S. and Castaing, P.
(2002), Spectral signature of highly turbid waters application
with SPOT data to quantify suspended particulate matter
concentrations. Remote Sensing of Environment, 81, 149í161.
Gohin, F., Druon, J. N. and Lampert, L. (2002), A five channel
chlorophyll concentration algorithm applied to SeaWiFS data
processed by SeaDAS in coastal waters. International Journal
of Remote Sensing, 23(8), 1639í1661.
Morel, A. and Prieur, L. (1977), Analysis of variation of ocean
color. Limnology and Oceanography, 22, 709 – 722.
Siddorn, J. R., Bowers, D. G. and Hoguane, A. M. (2001),
Detecting the Zambezi river plume using observed optical
Properties. Marine Pollution Bulletin, 42(10), 942í950.
Kirk, J. T. O. (1984), Dependence of relationship between
inherent and apparent optical properties of water on solar
altitude. Limnology and Oceanography, 29, 350í356.
Gallegos, C.L. and Correl, D.L. (1990), Modeling spectral
diffuse attenuation, absorption and scattering coefficients in a
turbid estuary. Limnology and Oceanography, 35, 14861502.
Prieur, L. and Sathyendranath, S., (1981), An optical
classification of coastal and oceanic waters based on the
specific spectral absorption curves of phytoplankton pigments,
dissolved organic matter and other particulate materials,
Limnology and Oceanography, 26, pp. 671-698.
Gallie, E.A. and Murtha, P.A. (1992), Specific absorption and
backscattering spectra for suspended minerals and chlorophylla in Chilko Lake, British Columbia. Remote Sensing of
Environment, 39, 103118.


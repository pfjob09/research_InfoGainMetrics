Fifth International Conference on Computer Graphics, Imaging and Visualization
Visualisation

Post Processing of Breast Phantom MRI-156 Images Using Snake
Algorithm
Wan Eny Zarina W.Abd. Rahman1, Arsmah Ibrahim1, Zainab Abu Bakar1,
Rozi Mahmud2, Md Saion Salikin3, Mazani Manaf11
1
Faculty of Information Technology & Quantitative Sciences, Universiti Teknologi
MARA, 40450 Shah Alam, Selangor, Malaysia
2
Faculty of Medicine, Universiti Putra Malaysia, Serdang, Selangor, Malaysia.
3
Faculty of Health Sciences, Universiti Teknologi MARA, Jalan Othman, Petaling
Jaya, Selangor, Malaysia
{wan_eny@tmsk.uitm.edu.my, arsmah@tmsk.uitm.edu.my,
zainab@tmsk.uitm.edu.my, rozi@medic.upm.edu.my, saion@gmail.com,
mazani@tmsk.uitm.edu.my}
1. Introduction

Abstract

Breast cancer is one of the major causes for
the increase of mortality among women. This
type of cancer is one that occurs in the breast
tissues where a group of abnormal cells tend to
have abnormal growth patterns. According to
the National Cancer Society of Malaysia (NCS)
[1], it is reported that in 2003, 3,738 (31.8%)
women were diagnosed with breast cancer.
Based on this number the probability a woman
develops breast cancer is found to be 1/19 [2].
In addition to that, the University Malaya
Medical Centre (UMMC) Malaysia also reports
that between 1993-2003 there are a total of
1,818 breast cancer patients being treated at the
centre. The number keeps on increasing from
the year 1993 to 2003 [3]. These figures can
surely cause an alarming fear amongst women.
According to American Cancer Society (ACS),
early breast cancer survival (Stage I) is 98% ,
but when women go to the hospital with stage
IV, there is only 20% chance of survival.
Hence, detecting the onset of breast cancer as
early as possible can probably address the
alarming fear factor.
Mammogram is known to be the most
effective way to detect early breast cancer. The

Mammography is a known method for the
early detection of breast cancer. However, the
mammograms which are in black and white
and in the shade of grey have some limitations
in portraying the abnormalities.
Image
segmentation is a very crucial process in
detecting
abnormalities
in
computed
radiography mammographic images. Active
contours which are known as ‘snake’ are
dynamic algorithms which can be used to
perform the image segmentation. In order to
test the applicability of the snake algorithm in
performing segmentation, the breast phantom
MRI-156 images are used. Only the breast
phantom images at the exposures of 25 kV, 28
kV and 35 kV with milliampere (mAs) of 0.5
are considered. It is found that when the image
is divided into four equal regions, the detection
of abnormalities in the image is more effective
as compared to the image processed as a
whole.
Keywords-Mammogram, Segmentation,
Snake Algorithm, Breast Phantom

978-0-7695-3359-9/08 $25.00 © 2008 IEEE
DOI 10.1109/CGIV.2008.43

350

two most common features that radiologist
normally look for in an image are the
calcifications and masses. These abnormalities
are the two most important early signs of breast
cancer [4]. Calcifications are the small calcium
deposits within the breast that appear as bright
spots in the mammogram. There are two types
of calcifications; macrocalcifications and
microcalcifications. Macrocalcifications are
coarse and they are frequently associated with
benign conditions.
On the other hand,
microcalcifications are small and they are
associated with malignant conditions [5], [6].
Microcalcifications are specks of calcium that
may be found in an area of rapidly dividing
cells. When many are seen in a cluster, they
may indicate a small cancer. About half the
cancers detected appear as these clusters.
Masses (or lump) can be categorised as benign
or malignant. However, locating and detecting
these abnormalities are not an easy task.
Although mammogram produces high
resolution images at low radiation doses, there
are still limitations [7]. Morrow et. al [8] agree
that mammograms are amongst the most
difficult of radiological images to interpret.
This is due to the fact that the contrasts of the
images are normally low. To add to these
difficulties in identifying the abnormalities, the
background of the images can be affected by
noise or blocked by anatomical structures such
as the ducts and glands. Furthermore, the
microcalcifications as well as the masses, cysts
and fatty tissues all appear as white patches on
the images. According to Xu et. al [9],
approximately 15% of all breast cancers are
missed by conventional mammography while
75% of identified breast lesions turn out to be
benign. This fact motivates the search for new
technologies and a more effective detection
technique.

compressed breast consisting 50% glandular
and 50% adipose tissues [10]. They are made
to represent appropriate details ranging from
visible to invisible abnormalities on the
mammographic image. Hence, the breast
phantom includes the breast surface and the
underlying abnormalities: the fibres, specks
and the masses which are referred to as
characteristic details.
Specifically, the
phantom [10] consists of six fibres with
diameters of 1.56, 1.12, 0.89, 0.75, 0.54 and
0.40 mm;
five clusters of specks with
diameters of 0.54, 0.40, 0.32, 0.24 and 0.16
mm and five masses with decreasing diameters
and thicknesses of 2.00, 1.00, 0.75, 0.50 and
0.25 mm as depicted in Figure 1;

Figure 1: Mammographic phantom image

The fibres, specks and masses represent the
fibrils,
microcalcifications
and
masses
respectively in real mammographic images.

3. Active Contours (Snake)
Active contours or snake were first
proposed by Kass et. al. [11], [12]. The
contour is represented as a parametric curve
v( s ) = [x(s ), y(s )]
(1)
where s is the contour length and x and y
represent the coordinates on the contour. The
parameter s is usually normalized.
The original contour has the ability to
deform from its initial shape and position. It
then converges to an object in the image and
subsequently fit into the object’s boundary.
The contour that best fit the object’s boundary
can be accomplished by minimising the total
energy. So, as the snake moves towards an

2. The Breast Phantom
The breast phantom is a model of the breast.
Phantoms refer to a test object used to simulate
radiographic characteristics of compressed
tissue. This phantom contains components
which radiographically model aspects of breast
disease and cancer. In this research, the breast
phantom model MRI-156 is used.
It is
approximately equivalent to a 4.2 cm thick of

351

object’s boundary, the energy is minimised.
The equation of the snake’s energy can be
written as
1

E snake =

෾[E

snake

3.1. Scoring Criteria
The scoring criteria is based on the
Mammography Quality Control manual [10] as
shown in Table 1.

( v( s ))] ds

0

1

Table 1: Scoring criteria for phantom

෾

= [ Eint ernal ( v( s )) +Eimage ( v( s ))
Characteristic
Details

0

+ Econstra int s ( v( s ))] ds

(2)

The internal energy, Eint ernal of equation (2)
can be written as
Į( s ) vs ( s ) + ȕ( s ) vss ( s )

Mass

4

3

3

This system can be used to guide
radiologist in determining good or poor quality
images. An image is considered to be of good
quality if the total number of score for
minimum visible quantity is at least 10. If the
total number is less than 10, then the image is
considered to be of poor quality.

snake along the image features,
Econstra int s is the constraints energy which
pushes or pulls the snake away from or
towards user-defined objects.

Eint ernal =

Specks

Minimum Visible
Quantity

where
Eint ernal is the internal energy of the snake
which keeps it from bending too much,
Eimage is the image energy which guides the

2

Fibers

4. Implementation

2

The implementation process involves seven
steps;

2

The first order term vs ( s ) represents the
stretching force of the snake while the second
order term, vss ( s ) represents its bending force.

Step 1: Data collection
The phantom images are collected at three
different exposure factors; 25kV, 28kV and
35kV. Figure 2 shows the three images;

The image energy, Eimage of equation (2) can
be written as a summation of three different
energy functionals i.e. the line, edge and
termination;

Eimage = Wline Eline + Wedge Eedge + Wterm Eterm

(a)
(b)
(c)
Figure 2: Phantom at (a) 25kv, (b) 28kv
and (c) 35kv

The energy constraint of equation (2) comes
from external constraints. The snake algorithm
will iteratively deform its initial contour to try
to find an object’s boundary with minimum
total energy.

Step 2: Crop the image
The image is cropped to remove the
unnecessary area using Adobe Photoshop CS2
software. Then the cropped image is saved in
JPEG (.jpg) format.
Step 3: Pre-processing
This step is carried out to remove the noise
and increase the contrast. Median filter is
applied to remove noise. This is then followed

352

by histogram stretching to enhance the images.
Both processes are carried out using Matlab
R2006a software.

Figure 3 shows the preprocessed images
which are free of noise and more enhanced.
Then scoring of the images are carried out.
The following tables show the number of
characteristic details in the original and
preprocessed images.

Step 4: Perform scoring
Perform scoring on the pre-processed
images. If the total number of score is at least
10, then proceed to the next step. Otherwise,
stop further processes.

Table 2: Scoring for phantom images at
(a) 25kV, (b) 28kV and (c) 35kV

Step 5: Image consideration
For each exposure, two types of images are
considered:
i) The whole image
ii) The divided image (four equal
regions)

Characteristic Original Preprocessed
Details
image
Image
0
4
Fibers
1
3
Specks
3
5
Masses
4
12
TOTAL
SCORE
(a) Scoring of Phantom at 25kV

Step 6: Application of snake algorithm
Apply the snake algorithm by first choosing
an initial contour and setting the iteration
count. This can be carried out by using Matlab
R2006a software.

Characteristic Original Preprocessed
Details
Image
Image
0
1
Fibers
1
1
Specks
2
4
Masses
3
6
TOTAL
SCORE
(b) Scoring of Phantom at 28kV

Step 7: Perform scoring
Perform scoring to check the capability of
snakes in detecting the characteristic details in
the phantom image.

5. Results and Discussions
The following results show the images and
scoring
I)
after preprocessing stage
II)
after the applications of snake
algorithm for images which is
- processed as a whole
- divided into four regions

Characteristic Original Preprocessed
Details
Image
Image
0
0
Fibers
0
0
Specks
1
3
Masses
1
3
TOTAL
SCORE
(c) Scoring of Phantom at 35kV

I. Phantom images after preprocessing

From Tables 2(a), 2(b) and 2(c), it is found
that at the exposure factor of 25kV, the total
score is 12, at 28kV, the total is 6 and at 35kV,
the total is 3. Since the total score at 28 kV
and 35kV is less than 10, the image quality is
considered poor. In addition, images which
cause additional artifacts were also considered
of poor image quality.
Hence, further
processes for these images will not be
considered. Only the phantom at 25kV will
proceed to the next step where the snakes
algorithm will be applied.

The following images are obtained after the
applications of median filter and histogram
stretching;

(a) Image at 25kV

(b) Image at 28kV

(c) Image at 35kV

Figure 3: Phantom Images

353

which is obviously more than one. Scoring of
the images is then carried out.
Table 3 below shows the total scores for the
original image and total scores after the
application of snake algorithm for the whole
image and divided images.

II Phantom image at 25kV
For phantom image at 25kV, two types of
images are considered:
i)
the whole image,
ii)
the divided image.

Table 3: Scoring after the application of
snake algorithm

The snake algorithm is then applied to these
images.

Characteristic
Details

i) Phantom image considered as a whole.
The snake algorithm is applied to the whole
phantom image and this algorithm has
detected only one mass as shown below;

Original
Image

Fibers
Specks
Masses
TOTAL
SCORE

Whole
Image

0
1
3
4

0
0
1
1

Divided image
T
L

B
L

T
R

B
R

0
0
1
1

2
0
0
2

0
0
2
2

0
0
2
2

From Table 3, it is found that when the
image is considered as a whole, the snake is
able to detect only 1 mass. On the other hand,
when the image is divided into four equal
regions, the snake is able to detect a total of
seven characteristic details. This shows that
image division provides better results.

Figure 4: The phantom image
ii) Phantom image divided into 4 regions.
The image is divided into four equal
regions. These regions are denoted by the
top-left (TL), top-right (TR), bottom-left
(BL) and bottom-right (BR) regions. The
snake algorithm is applied to all four
regions. Once done, the regions will be
combined as in Figure 5;

6. Conclusions
The results show that the snake algorithm is
able to segment and increase the sensitivity of
detection of characteristic details of breast
lesions in the mammogram image. When the
image is divided into smaller regions, the
ability of snake is further improved. It is hoped
that by utilizing the snake algorithm,
improvement in the detection of mass and
microcalcifications in the original mammogram
images can be further improved.
It is suggested that the image be divided
dyadically. Then parallel computing can be
adopted to improve the computational
complexity.

7. Acknowledgements

Figure 5: The divided phantom image

This work is supported by the Ministry of
Science Technology and Innovation (MOSTI)
Malaysia under the grant 01-01-01-SF0077.

From Figure 5, it can be seen that each divided
region (TL, BL, TR and BR) successfully
showed the underlying characteristic details

354

[12] Kass, M., Witkin, A. and Terzopoulus.
Snakes: Active Contour Models, International
Journal of Computer Vision, 1(4), pp 321-331,
1987.

The authors would also like to
acknowledge Siti Salmah Yasiran for her
contributions.

8. References
[1]

[2]
[3]

[4]

[5]
[6]

[7]

[8]

[9]

[10]
[11]

National Cancer Society of Malaysia. Second
Report of the National Cancer Registry Cancer
Incidence in Malaysia, 2003. Ministry of
Health Malaysia. Retrieved on 23rd Nov at
http://www.crc.gov.my, 2003.
Omar Hasan Kasule et al. Epidemiology of
breast cancer in Malaysia. Biomed Imaging
Interv J;1(1):e6-14, 2005.
Kanser Payudara-Fakta dan Statistik, Pusat
Sumber, Kolej Radiologi, Pusat Perubatan
Universiti Malaya,. Retrieved on 21st Nov,
2007. at www.radiologymalaysia.org/breast
health/BM/maklumat/fakta dan statistik.htm.
Cheng, H.D., Cai, X.P. Chen, X.W. Hu, L.M.
Lou,X.L.
Computer Aided Detection and
Classification of Microcalcifications in
Mammograms: A Survey. Pattern Recognition
36, pp. 2967-2991, 2003.
American Cancer Society: Cancer Reference
Information. Breast Cancer section. Atlanta,
Ga; 2000.
Berg WA, Gutierrez L, NessAiver MS, et al.
Diagnostic Accuracy of Mammography,
Clinical Examination, US, and MR imaging in
preoperative Assessment of Breast Cancer.
American Cancer Society: Cancer Reference
Information. Radiology 2004 Dec; 233(3): 83049, 2004.
Mammography and Beyond:
Developing
Techniques for the Early Detection of Breast
Cancer, Institute of Medicine, National
Academy Press, Washington D.C., 2000.
Morrow W.M., Raman, B.P. Rangaraj M.R.
Joseph, E.L.D.
Region-Based Contrast
Enhancement of Mammograms.
IEEE
Transactions on Medical Imaging pp 392-405,
11(3). 1992.
Xu, L. I, Hagness, S.C., van Veen, B.D. and
van der Weide, D. Experimental Investigation
of Microwave Imaging via Space-Time
Beamforming for Breast Cancer Detection.
2003 IEEE MTT-S International Microwave
Symposium Digest, 2003.
American College of Radiology (ACR),
Mammography Quality Control Manual, 1999.
Kass, M., Witkin, A. and Terzopoulus. Snakes:
Active Contour Models, Proceedings of the
First International Conference of Computer
Vision, ICCV ’87, pp 259-268., 1987.

355


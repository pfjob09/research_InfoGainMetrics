Fifth International Conference on Computer Graphics, Imaging and Visualization
Visualisation

An Approach to the Feature-Based Comparisons for the Rational Curves
Chanon Aphirukmatakun, Natasha Dejdumrong
Department of Computer Engineering
King Mongkut’s University of Technology Thonburi
Bangkok,10140, Thailand
Email: chanon ap@hotmail.com, natasha@cpe.kmutt.ac.th

Abstract

be classified into two categories: non-rational and rational
polynomial curves. A non-rational polynomial curve (or
polynomial curve) can be expressed in the forms of polynomial functions and its control points. The sequence of
control points is used to determine the shape of the curve.
The blending functions are used to specify the types of
polynomial curve. Nowadays, there are several kinds of
polynomial curves such as Bezier [3], Said-Ball [4], WangBall [5] and DP curves [2]. However, the rational curves
have similar properties except they have the weights for the
control points. The weights of the control points also affect
the shape of the curve.
Two polynomial curves can be directly compared by using the control point comparison methods [1]. However,
rational and polynomial curves cannot be readily compared
to each other because they have different weights. Thus,
to compare polynomial and rational curves, the algorithm
used for converting between two types of curves must be
taken into account.
In this paper, an algorithm to convert from a rational
curve into a polynomial curve is introduced. Therefore, the
algorithm used for comparing two polynomial curves can
be applied for comparing two rational curves and verified
between polynomial and rational curves.

In image processing, the curve comparisons can be
achieved by extracting the curve information from the
bitmapped images. The revealed curves are represented
in the forms of the sets of pixel information. Thus, the
determination of curve matching is to compare pixel by
pixel, which is time consuming. On the contrary, for vector graphics images, there have been no methods written
in the literatures referred about directly comparing the
parametric curves either in the rational or non-rational
(polynomial) forms. In this paper, the relationships between two curves can be classified into 4 main categories:
Curve Congruence, Curve Proportion, Curve Similarity
and Curve Difference. The comparison algorithms for
two given parametric curves either non-rational or rational curves are then established. These algorithms can be
simply determined by verifying some important geometric
features, e.g., the blending functions, the locations of their
control points and their weights. In this connection, since a
rational curve can be transformed into a non-rational one,
the curve comparison algorithms for polynomial curves
can also be applied for the cases of the rational curves.
Keywords— Curve Comparisons, Polynomial Curves, Rational Curves.

2 Definitions for Polynomial Curve Comparisons

1 Introduction
Typically, architects and geometric modelers use CAD
applications in the design of curves and surfaces and save
them into the databases for future uses. Retrieving their
work from the databases, the image files can be searched
by using only keywords defined in the forms of texts. However, they have to remember the names of their work. An
alternative method is to querying for matched curves by
only drawing a desired curve. Then, the corresponding
curves matched in the image bank will be displayed. Thus,
seeking for the curves requires a technique of curve comparisons.
Curves in Computer Aided Geometric and Design can

978-0-7695-3359-9/08 $25.00 © 2008 IEEE
DOI 10.1109/CGIV.2008.60

Let C1 and C2 be two polynomial curves of the same
degree and the same blending functions.
Definition 1. (Curve Congruence) Two polynomial
curves are congruent, denoted by C 1 ∼
= C2 , if all following conditions are satisfied:
1. All corresponding distances between two adjacent
control points of two curves are the same measure.
2. All corresponding angles at interior control points of
two curves are the same measure.

115

3. All corresponding angles between two adjacent interior normal vectors of two curves are the same measure.
Definition 2. (Curve Proportion) Two polynomial curves
are proportional , expressed by C 1 ∼ C2 , if all following
conditions are satisfied:
1. All corresponding distances between two adjacent
control points of two curves are different but all corresponding ratios for the distances between two adjacent control points of two curves are the same measure.
2. All corresponding angles at interior control points of
two curves are the same measure.
3. All corresponding angles between two adjacent interior normal vectors of two curves are the same measure.
Definition 3. (Curve Similarity) Two polynomial curves
are similar, denoted by C 1 ≈ C2 if one or more following
conditions are satisfied:
1. All corresponding ratios for the distances between
two adjacent control points of two curves are nearly
the same.
2. All corresponding angles at interior control points of
two curves are likely the same.
3. All corresponding angles between two adjacent interior normal vectors of two curves are approximately
the same.
Definition 4. (Curve Difference) Two polynomial curves
are different, denoted by C 1 = C2 if they are not congruent, proportional or similar.

{bj }nj=0 and the weights {wj }nj=0 , if the curves are congruent. The conversion matrix can be expressed as follows:
⎡
⎤
⎤
⎡
w0 b0
w0 p0
⎢ w1 b1 ⎥
⎢ w1 p1 ⎥
⎢
⎥
⎥
⎢
⎢
⎥ = (Mw · Mw )−1 · Mw · Mw · ⎢
⎥,
..
..
⎣
⎦
⎦
⎣
.
.
wn bn
where the (m + n + 1) × (m + 1)
expressed by
⎡
c0,0 w0
0
⎢ c0,1 w1
c
w0
1,0
⎢
⎢
..
..
⎢
.
.
⎢
w
c
c
Mw = ⎢
⎢ 0,n n 1,n−1 wn−1
⎢
0
c1,n wn
⎢
⎢
..
..
⎣
.
.
0

(1)
matrix, M w , can be
⎤

...
...
..
.

0
0
..
.

...
...
..
.

cm,0 w0
cm,1 w1
..
.

⎥
⎥
⎥
⎥
⎥
⎥,
⎥
⎥
⎥
⎥
⎦

. . . cm,n wn

0

(2)
and the (m + n + 1) × (n + 1) matrix M w can be shown
as follows:
⎤
⎡
0
...
0
c0,0 w0
⎥
⎢ c0,1 w1
c1,0 w0
...
0
⎥
⎢
⎥
⎢
..
..
..
..
⎥
⎢
.
.
.
.
⎥
⎢
⎥
w
c
w
.
.
.
c
w
c
Mw = ⎢
n,0 0 ⎥ ,
⎢ 0,m m 1,m−1 m−1
⎥
⎢
0
c
w
.
.
.
c
w
1,m
m
n,1
1
⎥
⎢
⎥
⎢
..
..
.
.
.
.
⎦
⎣
.
.
.
.
0
0
. . . cn,m wm
(3)
and
cij =

n m
i
j
m+n
i+j

.

(4)

Proof:
Given two rational B´ezier curves of degree n and degree m
respectively, two curves are equivalent if

3 The Conversion from a Rational B´ezier
Curve into the other Rational B´ezier
Curve with different weights
Comparing two rational B´ezier curves is a difficult
task because they have different set of weights. Thus,
the proposition 1 is introduced for the conversion from a
rational B´ezier curve into the other rational B´ezier curve of
the same weights. Two rational B´ezier curves can then be
compared by using the control point comparison methods.

wm pm

n
n
i=0 wi bi Bi (t)
n
n
i=0 wi Bi (t)

=

m
m
j=0 wj pj Bj (t)
.
m
m
j=0 wj Bj (t)

(5)

Multiplying both sides by the product of two denominators, it is obtained that
n

wi bi Bin (t)

i=0

m

wj Bjm (t) =

j=0

m

wj pj Bjm (t)

j=0

n

wi Bin (t).

i=0

(6)
Rearranging (6), we have

Proposition 1. The rational B´ezier control points of degree m, given by {p i }m
i=0 , with the determined weights,
denoted by {w i }m
i=0 , can be transformed into the other
rational B´ezier curve of degree n with the control points,

n

m

i=0 j=0

wi bi wj Bin (t)Bjm (t) =

m

n

wj pj wi Bjm (t)Bin (t).

j=0 i=0

(7)

116

4 The Conversion from Rational into Polynomial B´ezier Curves

Then,
n

m

i=0 j=0

m+n
ci,j wi bi wj Bi+j
(t) =

m

n

j=0 i=0

m+n
ci,j wj pj wi Bi+j
(t).

(8)
Let

m

n

C1 (t) =
i=0 j=0

and

m

n

C2 (t) =
j=0 i=0

m+n
ci,j wi bi wj Bi+j
(t),

(9)

m+n
ci,j wj pj wi Bi+j
(t).

(10)

Proposition 2. The rational B´ezier control points of degree m, denoted by {b i }m
i=0 , with the predefined weights,
given by {w i }m
i=0 , can be transformed into a polynomial
B´ezier curve of degree n with the control points, {p j }nj=0 ,
if two curves are congruent. The conversion matrix can be
defined as follows:
⎡
⎤
⎤
⎡
p0
w0 b0
⎢ p1 ⎥
⎢ w1 b1 ⎥
⎢
⎥
⎥
⎢
⎢ .. ⎥ = (Mw ·Mw )−1 ·Mw ·M· ⎢
⎥ , (16)
..
⎣ . ⎦
⎦
⎣
.
pn
wm bm

C1 (t) and C2 (t) can be rewritten in the matrix forms as
follows:
C1 (t) =

w0 b0

C2 (t) =

w0 p0

w1 b1
w1 p1

···
···

wn bn
wn pn

· M w · B1 ,
(11)
·Mw ·B2 , (12)

where
⎡
⎢
⎢
B1 = ⎢
⎣

B0m+n (t)
B1m+n (t)
..
.

⎤

⎡

⎢
⎥
⎢
⎥
⎥ , B2 = ⎢
⎣
⎦

m+n
(t)
Bm+n

B0m+n (t)
B1m+n (t)
..
.

⎤
⎥
⎥
⎥.
⎦

where the (m+ n+ 1)× (n+ 1) matrix M w can be defined
by the Equation (2) , and the (m + n + 1) × (m + 1) matrix
M can be expressed as follows:
⎤
⎡
c0,0
0
...
0
⎢ c0,1
c1,0
...
0 ⎥
⎥
⎢
⎢ ..
..
..
.. ⎥
⎥
⎢ .
.
.
.
⎢
⎥
⎥.
c
.
.
.
c
c
(17)
M=⎢
0,n
1,n−1
m,0
⎢
⎥
⎢ 0
⎥
c
.
.
.
c
1,n
m,1
⎢
⎥
⎢ .
.. ⎥
..
..
⎣ ..
.
. ⎦
.

(13)

m+n
(t)
Bm+n

Since B1 = B2 and C1 (t) = C2 (t), the equation can be
rewritten as:
⎤
⎤
⎡
⎡
w0 b0
w0 p0
⎢ w1 b1 ⎥
⎢ w1 p1 ⎥
⎥
⎥
⎢
⎢
Mw · ⎢
=
M
(14)
·
⎥
⎥.
..
..
w ⎢
⎣
⎣
⎦
⎦
.
.
wn bn

wm pm

0

The approximate solution can be obtained by using
pseudo inverse shown as follows:
⎡
⎤
⎡
w0 b0
w0 p0
⎢ w1 b1 ⎥
⎢ w1 p1
⎢
⎥
⎢
⎢
⎥ ≈ (Mw · Mw )−1 · Mw · Mw · ⎢
..
..
⎣
⎣
⎦
.
.
wn bn

Rational and polynomial B´ezier curves have the different set of weights because all weights of the polynomial
curve are 1. Thus, to compare the rational and polynomial
B´ezier curves, the rational B´ezier curve must be converted
into the polynomial B´ezier curve. Then, the rational and
polynomial B´ezier curves can be compared by using polynomial curve comparison. The proposition 2 is defined for
converting from rational into polynomial B´ezier curves.

0

. . . cm,n

Proof:
This proof is similar to the proof in Proposition 1. For the
conversion from a rational B´ezier curve into a polynomial
B´ezier curve, all weights of polynomial B´ezier curve are
set to 1, i.e., {wj }nj=0 = 1. Thus, in Mw , each wj will
be substituted by 1. This completes the proof.

the
⎤
⎥
⎥
⎥.
⎦

wm pm
(15)

Remarks: It is remarked that the correctness of the rational B´ezier curve, B 2w (t), converted from the given rational
B´ezier curve, B 1w (t), depends on the number of raised degrees. However, the integration of the difference square
(D ) between the rational B´ezier curve and its converted
curve can be used to determine the correctness of the conversion. It is shown by the following equation.

This completes the proof.
Remarks: It can be noticed here that there are no two
congruent rational curves of different set of weights, except their weight sets are proportional to each other. Thus,
the previous proposition is the proof for the similarity of
two curves although it should be the proof for congruence.

D=

117

1
t=0

(B2w (t) − B1w (t))2 dt.

(18)

Similarly, the correctness of the polynomial B´ezier curves,
B(t) converted from the rational B´ezier curves, B w (t) depends on the number of the increased degree. The integration of the difference square (D ) between the rational
B´ezier curve and its converted curve can be expressed by
the following equation.

End Algorithm

7 An Algorithm for Conversion from Rational into Polynomial B´ezier Curves with
Accurate Result

(19)

The algorithm is similar to the algorithm 1 except in the
first step, the proposition 2 is used instead of the proposition 1.

5 An Accuracy Computation Formula for
both Conversions

8 An Algorithm for Rational Curve Comparison

D=

1
t=0

(B w (t) − B(t))2 dt.

Two rational curves can be compared by converting
the two curves into polynomial curves and using polynomial curve comparison. An algorithm for comparing two
rational curves can be explicitly shown in the following
algorithm.

The conversion from a rational B´ezier curve into the
other rational B´ezier curve and the conversion from rational into polynomial B´ezier curves can only produce the
approximate results. However, the correctness of the conversions depends on the number of the increased degrees.
In this connection, the algorithm should compute the accuracy of the result from the conversion in each step of the
degree increment. The accuracy of the converted curve can
be determined by the integration of the difference square
defined in Equation (19). However, for improving the performance of the algorithm, the accuracy can be computed
from the distances between two endpoints of the compared
curve and its converted curve (δ) as
δ = |p0 − p0 | + |pn − pm | ,

Algorithm 2:
1. Convert two rational curves into two rational B´ezier
curves.
2. Convert two rational B´ezier curves into two polynomial B´ezier curves.
3. Apply the B´ezier degree elevation in order to obtain
two polynomial curves of the same degree.

(20)

where p0 and p0 are the first control points and p n and pm
are the last control points of two rational B´ezier curves of
degree n and m, respectively.

4. Measure all distances between two adjacent control
points of two curves and compare them between two
curves.

6 An Algorithm for Conversion from a Rational B´ezier curve into the other Rational
B´ezier Curve with Accurate Result

5. Measure all ratios for the distances between two
adjacent control points of two curves and compare
them between two curves.

The conversion from a given rational B´ezier curve into
the other rational B´ezier curve can be defined by the following algorithm.

6. Measure all angles at interior control points of two
curves and compare them between two curves.
7. Measure all angles between two adjacent interior
normal vectors of two curves and compare them between two curves.

Algorithm 1:
1. Convert the rational B´ezier curve of degree m into
the other rational B´ezier curve of degree m + 1 by
using the proposition 1.

8. Determine whether two curves are similar or proportional.

2. Compute for the distances between two corresponding endpoints of curve and its converted curve by
using Equation (20).

• If all measurements from 4 to 7 are approximately the same, two rational curves similar.

3. If the distances between two endpoints of the curve
and its converted curve are not satisfied by the predetermined correctness of the conversion, increase the
degree by 1 and repeat from the steps 1 to 2 until the
distances between two endpoints of the curve and its
converted curve are satisfied by the determined correctness of the conversion.

• If the measurement from 4 are different but
the other measurements are approximately the
same, then two rational curves are said to be
proportional.
• Otherwise, two rational curves are different.

118

9. If the result of the comparison is different, reverse
the sequence order of control points of two curves
and repeat from the steps 1 to 8 again.

by converting the rational B´ezier curve into the polynomial
curve as shown in Figure 4.

11 Conclusions

End Algorithm

In this work, the problem of the curve comparisons for
either rational or non-rational curves can be reduced into
the problem of the comparisons for two polynomial curves.
Any curve utilised in the comparison can be transformed
into an intermediate form represented by the B´ezier polynomial curve of a specific degree. Consequently, the algorithms for evaluating two polynomial curves can be applied
for (1) the determination of two polynomial curve comparisons (2) two rational curve comparisons, and (3) the comparisons of polynomial and rational curves.

9 An Algorithm for Rational and Polynomial Curve Comparison
The rational and polynomial curves can be compared by
converting the rational curve into the corresponding polynomial curve. Then, the previous algorithm will be applied
for the polynomial-polynomial curve comparison.

10 Experiments and Results
Example 1: Conversion from a Rational B e´ zier Curve
into the Other Rational B´ezier Curve
Given a set of points, p = {(1, 1), (2, 5), (8, 4), (10, 1)}
and a set of the weights, w = {2, 1, 1, 1} of a
rational B´ezier curve as shown in Figure 1 (Left).
The rational B´ezier curve with a set of weights,
w
=
{1, 1, 1, 2} converted from the previous
curve will have the set of control points, b =
{(1.00, 1.01), (1.42, 2.84), (5.60, 6.20), (10.03, 1.07)} as
shown in Figure 1 (Right).

Acknowledgment
This work was supported by the laboratory of CAGD
and Animation (CADLAB), the department of computer
engineering, KMUTT.

References
[1] C. Aphirukmatakun and N. Dejdumrong. An approach
to polynomial curve comparison in geometric object
database. International Journal of Computer Science,
2(4):240–246, 2007.

Example 2: Conversion from the Rational B e´ zier Curve
into the Polynomial B´ezier Curve
A polynomial B´ezier curve converted from a
given rational B´ezier curve as shown in Figure
2 (Left) with the set of control points, b =
{(1, 1), (2, 5), (3, 4), (4, 1), (5, 2), (6, 5)}, and the set of
weights, w = {2, 1, 1, 2, 1, 1} is shown in Figure 2
(Right).

[2] J. Delgado and J. M. Pe˜na. A Shape Preserving
Representation with an Evaluation Algorithm of Linear Complexity. Computer Aided Geometric Design,
20(1):1–20, March 2003.
[3] G. Farin. Curves and Surfaces for Computer Aided Geometric Design: A practical guide. Academic Press,
Morgan Kaufman Publishers, San Francisco, 5th edition, 2002.

Example 3: Rational B´ezier Curve Comparison
Two rational B´ezier curves illustrated in Figure 1 (Left and
Right) can be compared by using the algorithm 2. The
result is shown in Figure 3.

[4] H. B. Said. Generalized Ball Curve and Its Recursive
Algorithm. ACM Transactions on Graphics, 8:360–
371, 1989.

Example 4: Rational and Polynomial B e´ zier Curve
Comparison
The rational B´ezier curve in Figure 2 (Left) and the polynomial B´ezier curve in Figure 2 (Right) can be compared

[5] G. J. Wang. Ball Curve of High Degree and Its Geometric Properties. Appl. Math.: A Journal of Chinese
Universities, 2:126–140, 1987.

119

Figure 1: A rational B´ezier curve with control points, {b i }ni=0 , and weights, {wi }ni=0 (Right) converted from a given
rational B´ezier curve with control points, {p i }ni=0 , and weights, {wi }ni=0 (Left).

Figure 2: A polynomial B´ezier curve with control points, {p i }ni=0 (Right) converted from a given rational B´ezier curve with
control points, {b i }ni=0 , and weights, {wi }ni=0 (Left).

Figure 3: Two rational B´ezier curves can be compared by converting into polynomial curves.

Figure 4: Polynomial and rational B´ezier curves can be compared by converting the rational curve in the other polynomial
curve.

120


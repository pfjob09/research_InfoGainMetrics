Approximating Subdivision for Quadrilateral Nets with 4-Valence
Topology
Limei Zhang

∗

Zhongxuan Luo

Department of Mathematics,

Department of Information and Computer

Dalian University of Technology ,China.
zlm@dlfu.edu.cn

Weizhong Liu
Science,Saitama University,Japan.

luozx@cnv-it.com

wzliu@ke.ics.saitama-u.ac.jp

C 2 and C 1 continuous surfaces over regular meshes

Abstract
scheme is presented for quadrilateral nets with 4-

respectively . Other methods constructed are Loop
√
scheme[7],Butterﬂy algorithm[5] , 3 skill [9] and oth-

valence topology which generates the limit surface of

ers[8,12] .These methods have properties such as uni-

In the paper,a new approximating subdivision

1

C in the limit at the regular face and quasi-tangent

formity of representation ,numerical stability and code

plane continuous at the irregular rigion.The main ad-

simplicity .Zorin[13] gives some comparison of Loop

vantage of the scheme comparing with other algorithms

scheme,Butterﬂy algorithm, Catmull-Clark skill and

is limit surfaces generated by the scheme can hold the

Doo-Sabin method and obtains that the limit surfaces

shape of initial control polyhedra better than others

can not hold the initial nets very well when applying

.So the criterion satisﬁes important requirements for

the above methods to a cube.

practical applications in computer graphics and engi-

Our primary motivation is to build a new subdivision

neering.

scheme for quadrilateral nets so that the limit surfaces
can approximate and hold the shape of the initial con-

1. Introduction

trol nets .Because the operation of one step acting on a
polygon in Chaikin scheme[2] looks as if cutting corners

We can summarize the basic idea of subdivision

of the original control polygon and the 4-point inter-

as follows:subdivision deﬁnes a smooth curve or sur-

polatory scheme of Dyn[4] likes pilling up peaks along

face as the limit of a sequence of successive reﬁne-

the initial polygon,we start with the curve subdivision

ments . Subdivision method has widely appeared in

which combines the above two schemes.In the surface

geometric modelling , mechanical design and computer

subdivision,the natural way to deﬁne reﬁnement oper-

graphics.In order to generating smooth surfaces from

ators for quadrilateral nets is therefore to modify a ten-

initial control nets through successive reﬁning, impor-

sor product scheme like [1,3,8] such that special rules

tant questions are the construction of reﬁnements and

for the vicinity of non-regular regions are found .The

the analysis of convergence of the corresponding sub-

referring subdivision scheme for quadrilateral nets with

division scheme.The classic methods have solved the

4-valence topology generates limit surfaces of C 1 in the

question very well .The schemes marked the begin-

limit at the regular faces and quasi-tangent plane con-

ning of subdivision for surface modelling are derived

tinuous at irregular faces. The results show the nicer

by Catmull-Clark[1] and Doo-Sabin[3],which produce

properties in keeping the geometric contour of the ini-

Proceedings
of the International Conference on Computer Graphics, Imaging and Visualization (CGIV’04)
∗ Institute
tial control nets.
of Science,Dalian Fisheries University ,China
0-7695-2178-9/04 $20.00 © 2004 IEEE

1

The organization of the paper is as follows.Section

old ones.Evidently the resulting limit curve interpolates

2 presents the curve subdivision rules .Section 3

the initial control points.The control points in P n+1 of

gives some preliminary knowledge about the topol-

four-point interpolatory are deﬁned by the rulers

ogy of nets.In Section 4,the reﬁnements of surface are

pn+1
= pni
2i

stated.Section 5 gives the convergence analysis of the

1
n
n
n
n
pn+1
2i+1 = ( 2 + w)(pi + pi+1 ) − w(pi−1 + pi+2 )

scheme for curve and surface respectively .in Section

(2.2)

6,we outline some applications of the algorithm and

The limit curve is of C 1 when the parameter w satis-

leave some open problems.

fying 0 < w <

1
8

and the subdivision process looks as

if successive pilling up peaks along the initial polygon.

2. Reﬁnement for curves

Based on the geometric feature of the above two subdivision schemes and in order to obtain scheme which

To establish our notation,we start with a
curve

subdivision

subdivision

scheme

scheme.The
is

canonical

Chaikin’s

either cutting corners or piling up peaks,we propose

curve

algorithm

a new subdivision scheme using the vector of the four-

[2]

point interpolatory and the parameters of Chaikin algo-

which computes quadratic B-splines,with uniform

rithms.The polygon P n = (pnj ) is mapped to a reﬁned

knots,recursively.Chaikin’s algorithm starts with a

polygon P n+1 = (pn+1
) by applying the following rules
j

control polygon.The polygon is then transformed into

3
1
pn+1
= −wpni−1 +( +w)pni +( +w)pni+1 −wpni+2
2i
4
4

a new polygon with twice as many vertices by inserting
new control points 1/4 and 3/4 the way between old
process is then repeated over and over.Formally,let

1
3
n
n
n
n
pn+1
2i+1 = −wpi−1 +( +w)pi +( +w)pi+1 −wpi+2 (2.3)
4
4

P 0 = [p00 , p01 , · · ·] denote the vector of initial control

where 0 < w <

points(for now we shall ignore boundaries and assume

constraint problem derived from the constraint condi-

inﬁnite length vectors of control points or closed con-

tions of C 1 -continuity.The scheme generates limit curve

trol polygon).Also let P i denote the control polygon

of C 1 and the proof of this in section 5. Fig.1 shows one

obtained by applying the subdivision process i times

round of subdivision of ours.Fig.2 gives the comparison

vertices along each segment of the control polygon.The

0

the vector P

by P

n+1

These weights are the solutions of a

of the approximating extent of the limit curves and the

to P .The subdivision process successively replaces
n

1
8

initial polygon generated by Chaikin’s method,Dyn’s

.For Chaikin’s algorithm the

control points in P n+1 are computed from

skill and our algorithm respectively.

pn+1
= 34 pni + 14 pni+1
2i

1 n
3 n
pn+1
2i+1 = 4 pi + 4 pi+1

3. About 4-vanlence topology

(2.1)

Risenﬁsld[11] proves that the curve obtained at the

We assume that there are no isolated vertices or

limit by repeating this subdivision process is the

edges in our original closed nets and we call this process

0

and uni-

interior subdivision because all the vertices of the con-

form knots.The operation of every step of subdivision

trol polyhedron are interior vertices.We observe two dif-

curve in Chaikin scheme [2] looks as if cutting corners

ferent types of subdivision schemes,depending on how

of the original control polygon.

the underlying grid is reﬁned,primal and dual.In a pri-

quadratic B-spline with control polygon P

Another 4-point interpolatory subdivision scheme

mal scheme,every square of the grid is divided into

given dy Dyn[4] is an insertion algorithm since all the

four squares,usually by halﬂings in each direction to

points at stage n of the algorithm are carried over to

get the ﬁner grid.The old grid is a subgrid of the new

Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIV’04)
one.Dual schemes also divide
stage n+1 and new points are inserted in between the
0-7695-2178-9/04 $20.00 © 2004 IEEE

2

every square in the coarse

5. Convergence analysis

grid into four ,but then the polyhedral dual is taken to
be the new grid.The extension of the tensor-product

The generating function formalism lends itself well

biquadratic B-spline subdivision by Doo and sabin is a

to deriving suﬃcient conditions for subdivision schemes

dual subdivision scheme.After dual subdivision for ar-

to be C k .The scheme step can be compactly written in

bitrary valence polyhedra all control points intersected

a single equation

by 4 edges.A key observation is that all new vertices

=
pn+1
j

intersected by 4 edges after dual subdivision although

α2i−j pni

(5.1)

i∈Z

faces may have diﬀerent amount of sides .
where

The one that every vertex intersected by 4 edges in

α = (αj ) = [· · ·, 0, 0, −w, −w, 14 + w, 34 + w, 34 + w,

a closed quadrilateral nets is called 4-vanlence topol-

1
4

ogy. All of our work established for closed grids with
4-valence topology .If the initial closed control polyhe-

+ w, −w, −w, 0, 0, · · ·]

(5.2)

From this we can see immediately that

dron don’t belong to 4-valence topology we can sub-

α2j = 1,

divide it through any dual subdivision rule like Doo-

α2j+1 = 1

j∈Z

Sabin skill. We call a spacial face (the face stated here

(5.3)

j∈Z

needn’t lie in one plane) with 4-edges regular and a

After some computation of Dyn[6]we see that the sub-

face with non 4-edges irregular .After several applica-

division step can be expressed in the generating func-

tions of a uniform reﬁnement operators the topological

tion formalism as a simple multiplication of the corre-

structure of any quadrilateral net consists of large reg-

sponding symbols:

ular regions with isolated singularities of the initial net.

P n+1 (z) = α(z)P n (z 2 )

(5.4)

where
P n (z) =

4. Reﬁnement for surfaces

pnj z j , α(z) =
j

αj z j

(5.5)

j

Now we give some results from Dyn[6].
Lemma 5.1 Let S be a subdivision scheme deﬁned by

In this section we address the problem of building
subdivision surfaces,that are C continuous over regu-

a mask satisfying (5.3).Then there exists a subdivision

lar closed polyhedra.

scheme S1 with the property

1

dP n+1 = S1 P n

The natural way to deﬁne reﬁnement operators for
quadrilateral nets is therefore to modify a tensor prod-

where P n = S n P 0 ,and (dP n )j = 2n (pnj+1 − pnj ).

uct scheme such that special rules for the vicinity of

Lemma 5.2 S is a uniformly convergent subdivision

non-regular regions are found.For a regular quadrilat-

scheme,if and only if

eral net the new point is deﬁned by the sixteen points

sion scheme,then it determines a unique compactly sup-

3-edges face and 5-edges face ,let’s see Fig.4, Fig.5 reand 0 < w <

1
8

=

converges uniformly to the

Lemma 5.3 If S is a uniformly convergent subdivi-

the position.(see ﬁg. 3).For the irregular faces ,such as
spectively.The conditions α = −w,β =

1
2 S1

zero function for all initial data P 0 .

around it.The weights are diﬀerent with the change of

3
4 +w,γ

(5.6)

ported continuous function S ∞ P 0 .

1
4 +w

Lemma 5.4 Let S be a subdivision scheme with a

are still real in Fig.3-Fig.5. We omit

characteristic L-polynomial

the reﬁnements when 5 < n since the law of them can

1+z k
Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIV’04)
α(z) = (
) q(z)
be found through comparing Fig.3,Fig.4 and Fig.5.
2z
0-7695-2178-9/04 $20.00 © 2004 IEEE
3

(5.7)

satisfy

If the subdivision scheme Sk ,corresponding to the L∞

0

polynomial q(z),converges uniformly then S P ∈ C

k

λ1 = 1, λ2 = λ3 < 1, | λi |<| λ2 |, ∀i ≥ 4

for any initial control polygon P 0 .
Lemma 5.5 If S is a subdivision scheme of the form

(5.11)

above and 12 Sk+1 converges uniformly to the zero func-

The subdivision matrix is of block circulant matrices

initial control polygon P 0 .

ber so we omit the detail here.The number of edges is

and the dimension of the matrix is = 9× the edges num-

tion for all initial data P 0 then S ∞ P 0 ∈ C k for any

the order of the Hankel matrix and 9 is the order of the

The smoothness analysis of the limit curve can be

block matrix . The limit surface is quasi-tangent plane

derived from the above lemmas .Given S being a sub-

continuous since the eigenvalues of the subdivision ma-

division scheme deﬁned by the rules satisfying(2.3),the

trix satisfy (5.11)(See Tab.1). We omit the masks when

characteristic L-polynomial of this scheme derived from
the method Dyn[6]is

Table 1: Leading eigenvalues of the subdivision maa(z) = −wz
( 34

+ w) +

−4

( 14

− wz

−3

+ ( 14
2

+ w)z

+ w)z − wz − wz

−2

3

+

( 34

+ w)z

−1

trix

+

n=3

(5.8)

−wz

za(z)
1+z =
1
( 4 + w)z −1

1
16 1.0
1
32 1.0
1
48 1.0
1
64 1.0

=

+

+

2
4

+ ( 14 + w)z − wz 3

n=6

w λ1 λ2 = λ3 λi≤4 λ1 λ2 = λ3 λi≤4 λ1 λ2 = λ3 λi≤4

Hence the characteristic L-polynomial of 12 S1 is
1 (1)
(z)
2a
−3

n=5

(5.9)

0.4433 0.25871.0 0.6836 0.33501.0 0.7458 0.4171
0.4001 0.25141.0 0.6810 0.31191.0 0.7488 0.3979
0.3847 0.25051.0 0.6802 0.30211.0 0.7494 0.3908
0.3764 0.25031.0 0.6797 0.29621.0 0.7496 0.3872

The scheme converges uniformly to a continuous limit
function due to || 12 S1 || =

1
2

< 1. In order to analyze

the smoothness let’s observe the scheme of
characteristic L-polynomial of 12 S2 is
(1)
1 (2)
(z) = za1+z(z)
2a
−2
−1

2[−wz

+ wz

the mount of edges is more then 6.In fact the bigger the

1
2 S2 .The

n,the slower the shrinkage .

=

+

1
4

+ 14 z + wz 2 − wz 3 ]

6. Conclusion and discussion

(5.10)

and norm || 12 S2 || < 1 when 0 < w < 18 . S1 converges

The described algorithm is useful in practical ap-

uniformly,hence the scheme produces C (R) functions.

plications because the smoothness surface is achieved

From the diﬀerentiability of the limiting curves gen-

by simple applying the original control nets.When

erated by the curve scheme,the smoothness of the lim-

dealing with open polyhedron,it is not possible to

iting surfaces generated by inﬁnitely reﬁning a regular

reﬁne the ﬁrst or the last edge by the origi-

quadrilateral net follows immediately.This is a simple

nal 4-point since rules requires a well deﬁned 2-

tensor product argument. For the irregular faces using

neighborhood.Therefore,another rules for the boundary

the facility subdivision matrix is eﬀective. It is well

points are needed.Extrapolated points can be deﬁned

known that the tangent plane continuity of the limit

like Kobbelt [8].The limit surface can be controlled well

surface of a subdivision scheme depends on the eigen-

when extrapolated points are selected with light distur-

structure of the subdivision matrix.We shall use the

bance. Fig.6 and Fig.7 demonstrate the smoothness in

analysis given by Rief [10] to study the smoothness of

the regular and irregular cases respectively. Fig.8 and

the limit surfaces of our subdivision scheme. We say

Fig.9 show the comparison of the subdivision of Doo-

a subdivision scheme at a point quasi-tangent plane

Sabin and ours over a cube .As we pointed out in the

1

Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIV’04)
previous section,the limit
continuous if the eigenvalues of the subdivision matrix
0-7695-2178-9/04 $20.00 © 2004 IEEE

4

surface holding the shape of

√
[9] Kobbelt,L.” 3-subdivition in computer graphics pro-

initial control grids after ours subdivision over a cube

ceedings”,

better in a way .

Annual Conference Series,ACM SIG-

GRAPHSGGRAPH 2000,103-112.

This paper is mainly based on a new subdivision
scheme to enlarge the methods in modelling.There is

[10] Rief,U.”A Uniﬁed Approach to Subdivision Al-

much systematic work that needs to be done.For exam-

gorithms

ple. (1)The regularity and injectivity about the char-

,1995,12:153-174

acteristic map of the eigenvectors corresponding the

near

Extraordinary

Vertices”,CAGD

[11] Riesenfeld.R.F.”On Chaikin’s algorithm”, Computer

subeigenvalues are open problems.Especially the anal-

Graphics and Image Processing ,1995,4:304-310.

ysis of the eigenstructure in theory is an interesting
[12] Velho,L.Zorin,D.,”

issue. (2)Using the technique of LOD to reconstruct a

4-8

subdivition

”,

CAGD,2001,5:397-427.

real-life model is necessary for detecting the practica-

[13] Zorin,D.Schr˜
oder,P.Caltech.” Subdivition for mod-

bility of our algorithm.Currently,we can only solve the

eling and animation”, SGGRAPH Course Notes

problem for speciﬁc model.

2000,65-102.

References
[1] Catmull,
B-spline

E.Clark,J.,”Recursively
Surfaces

on

Arbitrary

pn+1
pn+1
2i+1 n
2i
pni ........................................p..i+1
.
....pn+1
...
pn+1
... 2i+2
2i−1...
...
.
...
.....
n+1 .
... n+1
p2i−2...
...pn2i+3
.
pni−1 .....
.
.
p
.
..
.. i+2

Generated
Topological

Meshes”,CAD,1978,10:350-355.
[2] Chaikin,G.”A Algorithm for High Speed Curve Generation”,Computer Graphics and Image Processing,

Figure 1: The sketch map of curve subdivision

1974,3:346-349.
[3] Doo,D.Sabin,M.”Behaviour of Recursive Division Surfaces Near Extrairdinary Points”, CAD,1996,10:356360.
[4] Dyn,N.,Levin,D.,”A 4-point Interpolatory Subdivision
Scheme for Curve Design”,CAGD,1987,4:257-268.
[5] Dyn,N.,Levin,D.,And Gregory,J.A.”A Butterﬂy Subdivition Scheme for Surface Interpolation with Tension
Control”, ACM Trans.Gr.9,2, 1990,4:160-169.
[6] Dyn,N.”Subdivition

scheme

aided geometric design”,

in

computerter-

Advances in Mumeri-

cal(W.Light,ed),vol.2,Clarendon Press,1992,36-104.
[7] Loop,C.,”Smooth Subdivision Surfaces Based on Triangles”,Master’sthesis, University of Utah, Depart-

Figure 2: Initial octagons and results after 3 times re-

ment of Mathematics,1987.

ﬁning .(a) Chaikin’s scheme;(b)the 4-point interpola-

[8] Kobbelt,L,”Interpolatory

Subdivision

on

tory subdivision method ;(c)the algorithm presented

Open

here.

Quadrilateral Nets with Arbitrary Topology”,In
Proceedings of Eurigraohics 96,Computer Graphics

Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIV’04)
Forum,1996:409-420.
0-7695-2178-9/04 $20.00 © 2004 IEEE

5

γ
α

α

β

αγ

α2

α
β
γ

α2

αβ

βγ

β2

αγ

γ2

βγ

α2

α

αβ

αγ

αβ

αβ
αγ
α2

Figure 3: Subdivision masks for regular faces

(a)

(b)

2

αβ + αγ

αβ
αγ

α
β2

αβ
αγ

Figure 7: Subdivision for 5-edges mesh,(a)control polyhedron;(b)subdivision for 6-times

α2
α ✯✶
2
2
βγ + γ2 ❨❃
αβ + αγ + γ2
(b)
(c)

✗✿ 2
αβ + γ2
(a)

2

Figure 4: The irregular reﬁnement(n=3).(In (b) and
(c) we omit the masks when they are the same with
the regular case .)

..
..
O ..........

..
..
..

(a)

(b)

α2 αγ αβ α2
βγ β 2 αβ
αβ
Oγ 2
αγ
✲
βγ
✕
α2 +2αγ
2
αβ α2
(c)

Figure 8: Results after one and three times for a cube
using the Doo-Sabin scheme

Ã Ä

Figure 5: The irregular reﬁnement n=5 (In (a) and
(c) the ’O’point’s mask is the average of the masks of
the points around it.(In (a) and (b) regular topology
can be found after joining dotted lines)

Figure 9: Results after subdividing one time using Doo(a)

Sabin skill and then two times using our method for a

(b)

cube
Figure 6: Subdivision for 4-edges mesh,(a)control polyProceedings
of the International for
Conference
hedron;(b)subdivision
6-timeson Computer Graphics, Imaging and Visualization (CGIV’04)
0-7695-2178-9/04 $20.00 © 2004 IEEE

6


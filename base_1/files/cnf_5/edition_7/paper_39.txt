Efficient Method for Geometric Attribute Estimation
Chen Xi, Ke Yinglin, Li An
College of Mechanical and Energy Engineering
Zhejiang University, Hangzhou 310027, China
Abstract

branches, named numerical and analytical method [2].
The first method is based on triangle mesh. It defines

A new method is proposed to estimate the discrete

normal vector as a weighted average of the adjacent

geometric attributes, such as normal vector and curvature.

triangles [3][4][5], and obtains curvature from an

The method contains two steps: points sampling and 4D

ensemble of directional curvature estimates. Flynn et al.

Shepard interpolation. In the first step, we extract points

[2] proposed an algorithm for computing the curvature

from point cloud and estimate the attribute of the sampled

between two points which uses the surface normal change

points. During the second step, we interpolate a global

between the points. Krsek et al. [6] discuss the angular

4D Shepard surface over these sampled points and

deficit at a vertex as a measure of the curvature but this

compute the attribute of each point in point cloud. This

may causes problems with noisy data. Using compensated

method is very effective for using a new global surface

normal and triangle center, R. Sacchi et al. [7] develop a

model.

as

different method which work well on error-filled data. As

segmentation, feature extraction, data preprocessing and

mentioned above, all the list methods have to be applied

etc. Application examples are given to verify the proposed

on the triangle mesh. To approach them, triangulation is

method.

usually inevitable. Since constructing and storing

It

benefits

many

applications

such

1. Introduction

thousands of triangle mesh is a heavy burden to the
system, it may be a little difficult to apply this kind of

Reverse engineering is a technology that can transform

methods to point cloud. The analytical method is

real part into CAD model and further derive new product

performed in a different way. Generally speaking, the

by model analyzing and modification. Data acquisition is

method fits a smooth surface in the local coordinate

the first step of reverse engineering. To capture surface

system and calculates the curvature or normal by the first

information, either contact or non-contact inspection can

and second partial derivatives of the surface. Sander [8]

be used. Among them, optical method is probably the

estimate normal vector by tangent plane fitting and then

most popular one for its fast acquisition rates [1].

calculate the point’s curvature by a parabolic surface. This

However, it creates dense and error-filled data points

surface has simple presentation and easy to built, but

which affects the efficiency and quality of CAD model

limited by the surface property, it only can be used to

reconstruction. To solve the problems, some critical

compute the attribute of single point. As a result, large

operations such as data compression, noise filtering and

amount of local surface patches have to be constructed to

segmentation have to be performed. To preserve the basic

estimate the attribute of each point in point cloud. Low

shape information recorded in the original point data, all

efficiency limits the application of analytical methods.

the operations mentioned above have to be approached

To solve above problems, our method adopts a global

according to the geometric attribute of underlying surface.

model but local surface patches. As a result, it is very

The methods for attribute estimation fall into two basic

effective while dealing with huge amount of points. Its

1 and Visualization (CGIV’04)
Proceedings of the International Conference on Computer Graphics, Imaging
0-7695-2178-9/04 $20.00 © 2004 IEEE

main steps can be described as follows. At first, we
extract points from point cloud based on 3D grids [9].
Then, attribute of the sampled points (normal vector and
curvature) is computed. Finally, a global 4D Shepard
surface, interpolated over this sampled points, is

Step

3.

Calculate

the

distance

increment

~
d ( p i , p j ) between pi and the points pj in N (G),

~
d ( p i , p j ) = ( xi − x j + y i − y j + z i − z j ) .

constructed in the space (x, y, z, ı), where (x, y, z)

Step 4. Sort point pj according to the increment

presents point’s position and ı is the point’s attribute.
Based on the surface, every point’s attribute can be

~
d ( pi , p j ) from minimum to maximum, select top 25

estimated easily. In the following sections, some key

points as the neighbors of pi.

technologies contained in the above steps are discussed in
detail.

There are two advantages for using this simple and
efficient searching algorithm. The first, through spatial
grid structure, we can find the required neighbors by

2. Normal estimation

reviewing few points in N (G). While in the past, we have

The tangent plane Tp(pi) associated with the data point

to spend lots of time searching neighbors from whole

pi is represented as data point pi, together with a unit

point cloud. The second, we search neighbors with the

normal vector ni. The unit normal vector ni is a vector
which satisfy the following equation according to the least
squares method.

min =

¦ (( p − p ) ⋅ n )
i

2

distant

increment

d ( pi , p j ) =

(x

~
d ( pi , p j )

distance

− x j ) + ( y i − y j ) + (z i − z j ) ,
2

i

but
2

2

i

p∈Nbhd ( pi )

considering that subtraction need 2 units of time,

Where Nbhd(pi) define the point set composed by the

multiplication

points in the neighbor hood of pi.

simplification shorten the computation time greatly. The

Experiment revealed that taking 24-32 neighbors of pi
to estimate the normal vector was an effective trade-off
accuracy.

We

square

root

7

[8],

above

scheme works very well.
To further obtain the correct principle direction, we

have

have to consistent the estimated normal orientation. This

efficient

problem can be solved by a graph optimization algorithm

developed

an

method

search

to

but

application proves that our k-nearest neighbor searching

between computation time
and

3,

[10].

these

k-nearest neighbors. During

3.

sampling process, we have
divided point cloud into

4D Shepard Interpolation

Fig. 1. 26 neighbors.

grids by cell planes in three

Based on the consistent normal orientation, curvature of

orthogonal directions [9], assume G is the grid contain pi

the

and N (G) is the set of non-empty neighbors of G. The

transformation

main steps of method can be described as follows

information of sampled points, we can further deal with

Step 1. Search the non-empty grids among 26
neighbors of G and add them to set N (G) (Fig. 1).
Step 2. Check the number of points in N (G), if the
number of points less than 24, for each grid in N (G)
execute step 1 to search more neighbors. If there are more
than 24 points, execute step 3.

sampled

other

points

points
method

is

estimated
[8].

conveniently

Using

by

coordinate

the

geometric

through

4D

Shepard

interpolation.
Assume there are 2D scattered points
and a real number set

2 and Visualization (CGIV’04)
Proceedings of the International Conference on Computer Graphics, Imaging
0-7695-2178-9/04 $20.00 © 2004 IEEE

{( xi , y i )}iN=1

{ f i }iN=1 , The basic interpolation

problem is searching a smooth bivariate function F (x,y),

ª (R − d k )+ º
wk ( x , y , z ) = «
»
¬ Rd k ¼

which takes on certain prescribed values:

F ( x k , y k ) = f k , k = 1, N .

2

(R is the given

radius, estimated from the size of grid).

This problem is very important in many fields. The

Comparing with basic Shepard method, 4D Shepard

inverse distance weighted method is usually adopted to

surface F (x, y, z) is more powerful for the ability of

solve it. This method is developed by Shepard. The basic

processing point cloud with arbitrary structure. If set

Shepard’s function is

ık = ck (ck is the curvature of sampled points), the surface
will interpolate over ck, for an arbitrary point p(x,y,z) in

N

F ( x , y ) = ¦ wk ( x , y ) f k
k =1

where,

N

¦w

k

( x, y ) ,

point cloud, its curvature c(p) can be obtained by Eq.(1)

k =1

conveniently. Assume the sampled points around p is pj,

wk ( x, y ) = d kµ and typically µ = −2 ,

the corresponding curvature is c(pj), actually, c(p) is
calculate by a convex linear combination of c(pj). Same
method can also be used to estimate the other attributes

d k = (( x − x k ) 2 + ( y − y k ) 2 )1 / 2

such as principle direction and normal vector.

Considering that point cloud is very complex, it is
difficult to construct a one-to-one mapping between point
cloud and x-y plane, so it is difficult to construct Shepard

4.

Extruded surface extraction based on
estimated principle direction

surface model directly. In this paper we don’t use Shepard
method to construct 3D surface, but expand it to 4D.

In the past, considering that curvature estimation is a

is

time consuming procedure, many technologies has to

{( x k , y k , z k )}kN=1 the attribute of sampled points is

avoid using it. Since estimation speed is greatly improved

{σ k }kN=1 , here we construct a 4D Shepard surface F(x, y,

effectively deal with point cloud. Here we describe one of

Assume

the

scattered

3D

sampled

points

by our method, several new technologies are proposed to
them briefly.
Extruded surface is an important feature in the most

z)ˈwhich satisfy the condition:

F ( x k , y k , z k ) = σ k , k = 1,2,, N .

industry parts. Until now it is still difficult to recognize or

Rewrite the Shepard function as [11]

Here a new algorithm is adopted to approach it.

N

F ( x , y , z ) = ¦ wk ( x , y , z ) f k
k =1

After estimating the curvature of each point in point

N

¦w

extract those feature parameters from complex point cloud.

k

( x, y, z ) (1)

cloud, we average the minimal principle direction

k =1

m (x, y, z) to get an initial extruded direction
where,

E( x, y, z ) ,

µ

wk ( x, y, z ) = d k , µ = −2 ,

d k = (( x − xk ) 2 + ( y − y k ) 2 + ( z − z k ) 2 )1 / 2 ,
In applications, we further improve the computational
efficiency by modification of

wk ( x, y, z ) [12]

where x =

1 n
1 n
1 n
xi , y = ¦ y i , z = ¦ z i (n is
¦
n i =1
n i =1
n i =1

number of points in point cloud)[13].
The initial extruded direction will be optimized by a
discrete integral method. Firstly, plane P, perpendicular to
the initial extruded direction, is constructed. Points in
point cloud will be projected to the plane. If the extruded

3 and Visualization (CGIV’04)
Proceedings of the International Conference on Computer Graphics, Imaging
0-7695-2178-9/04 $20.00 © 2004 IEEE

direction is accurate, the projected points will converge to

show the result of extruded surface extraction.

a profile curve (Fig 2(b)), other else, the result of

The first example, contains 57,597 points. The

projection will be a profile belt (Fig 2(a)). Assume s is the

estimated curvature is displayed in Fig. 3(a). In the Fig.,

area of belt; we can get accurate extruded direction while

points are colored according to their curvature. Color

s get its minimum value. s is calculated by a discrete

from red to blue is used to present the curvature from

integral method as follows.

maximum to minimum. Fig. 3(b) displays the second

Step 1. Subdivide plane P by 2D bin cells, assume the
bin cells contain projected points is BinCell[i].
Step 2. Calculate the area of projected belt as

example which is composed of 10,015 points. As a part
used in aircraft machining, it contains several complex
feature surfaces. From the Fig., we can identify them
clearly.

n

s = ¦ BinCell[i ] .

Fig. 4 displays the result of extruded surface extraction.

i =1

The first example is a freeform object (Fig. 4(a)), we

We rotate the projected plane; the optimized extruded

design this complex object with a section curve and an

direction will be obtained while the objective function

extruded vector (0.000000, 0.000000, 31.514678), then,
some points are sampled from this object and input to the

n

f = ¦ BinCell[i ] getting its minimum value.
i =1

algorithm in 4, finally we obtain the extruded direction
(0.000229, 0.000081, 31.514585), the error of angle is

accurate extruded line

BinCell[i]

4.42× 10-4 degree. The second example is a blade piston
(Fig. 4(b)), this part is widely used in the aircraft engine.

P

The estimated extruded direction of this model is
˄-4.589273, -0.172624, 0.000209˅. Two examples prove
that the proposed algorithm can be applied in the industry
field.
Initial extruded line

(a) Initial extruded line.
accurate extruded line

BinCell[i]

(a) Part of automobile

(b) Part of aircraft

Fig. 3. Result of curvature estimation.
optimized extruded line

(b) Optimized extruded line
Fig. 2. Extruded surface extraction.

5.

Application examples
Four examples are cited in this section. The first two

(Fig. 3) show the estimated curvature. The rest (Fig. 4)

(a) Freeform feature

(b) Blade piston

Fig. 4. Result of extruded surface extraction.
4 and Visualization (CGIV’04)
Proceedings of the International Conference on Computer Graphics, Imaging
0-7695-2178-9/04 $20.00 © 2004 IEEE

The Shepard interpolation adopted by the proposed

6. Comparison of algorithms

method will lead to wrong interpolated curvatures near

The two algorithms described earlier are compared in

sharp features of the surface. The third test proves that.

this section using two test surfaces. The algorithms are

The test surface, containing blend feature, is defined

denoted by CT, CI in the figures: CT Coordinate

firstly (Fig. 5(c)), then, the point cloud, describing the

Transformation Method [8], CI Curvature Interpolation

surface, is generated to test two algorithms. During the

Method (proposed method).

test, blend radius is changed gradually. From the result of

To test the stability of algorithm, we define a test
surface and sample it to simulate point cloud obtained by
a laser plane range finder. The test surface is a cylinder
which defined by

x = u , y = v , z = r 2 − (u sin α − v cos α ) 2 ,

test (Fig. 5(d)) we find the proposed method is inaccurate
while dealing with sharp feature.

7. Conclusion
In this paper, an efficient method is proposed for
geometric attribute estimation. The main contribution of

u , v ∈ {− 50..50} , ( α = 15 $ , r = 100 ).

the paper lies in following two aspects: (a) applying a new

The sampled point cloud contains 100 range points in a

estimation process; (b) a practical scheme for k-nearest

rectangular grid spaced 10 units apart, parallel to the x-y

neighbors searching. The examples have proved that the

coordinate plane. Gaussian noise with same distribution

method could be used to deal with measured data with

was added independently to all three point coordinates.

arbitrary structure. It can be applied in many fields such

This only gives a good simulation of real range data if the

as reverse engineering, virtual reality, computer vision

resolution of each of the axes is the same. A range of

and etc. The estimation method isn’t accurate enough

standard

while dealing with sharp feature. It needs further work.

deviation

was

used

{1, 2.5, 3.4, 4.6, 5.4, 6} units.

corresponding

surface model “4D Shepard surface” to accelerate the

to

The result of test is

8. Reference

displayed in Fig. 5(a). From the figure we can find that

[1] T. Várady, R. R. Martin and J. Cox, “Reverse Engineering

the proposed method (CI) is more robust to noise. It is

of Geometric Models ʊ an Introduction”, Computer-Aided

caused by the smooth effect of the Shepard function.

Design, vol. 29, no. 4, pp.255-268, 1997.

The second test is used to check the performance of

[2] P.J. Flynn, A.K. Jain, “On Reliable Curvature Estimation”,

algorithm while dealing with large amount of data points.

IEEE Conference on Pattern recognition, San Diego, pp.

It is approached with a Dimension 4550 workstation. To

110-116. 1989.

do the test, we change the sample field of cylinder to

[3] D. Meek, D. Walton, “On surface normal and Gaussian

obtain a series of point cloud with vary amount of data

curvature approximations given data sampled from a

points. Fig. 5(b) shows the result of the test. Obviously,

smooth surface”, Computer Aided Geometric Design, vol.

4D Shepard surface is more efficient In the practical

17, no. 6, pp.521-543, 2000.

application when the number of points rise to 30284,

[4] J.L. Brown, “Vertex based data dependent triangulations”,

using curvature interpolation method (CI) we just take

Computer Aided Geometric Design, vol. 8, no. 3, 239–251.

5016 points as samples to construct the 4D Shepard

1991.

surface and then compute curvature of every point in

[5] L.A. Shirman, C.H. Séquin, “Local surface interpolation

point cloud, whole procedure spend 5 seconds. However

with Bézier patches”, Computer Aided Geometric Design

using coordinate transformation method (CT), it will

vol.4, no. 4, 279–295. 1987

spend you nearly 15 minutes.

[6] P. Krsek, G. Lukács and R. R. Martin, “Algorithms for

5 and Visualization (CGIV’04)
Proceedings of the International Conference on Computer Graphics, Imaging
0-7695-2178-9/04 $20.00 © 2004 IEEE

computing Curvatures from Range Data”, in: R. Cripps

[10] H. Hoppe, T. DeRose, T. Duchamp, J. McDonald and W.

(Ed.), The Mathematics of Surfaces VIII, pp.1-16, 1998.

Stuetzle, “Surface reconstruction from unorganized points”,

[7] R. Sacchi, et al. “Curvature estimation for segmentation of

Computer Graphics (SIGGRAPH’92 Proceedings), pp.

triangulated surfaces”, Proceedings of 3-D Digital Imaging
and Modeling, Ottawa, Ontario, Canada: IEEE, pp. 536-543.

71~78, 1992.
[11] Ke Yinglin, Chen Xi “Efficient curvature estimation based
on 4D Shepard surface” Journal of Zhejiang University

1999.
[8] M. Ernest et al. “Surface Parametrization and Curvature

(Engineering Science), (to be published).

Measurement of Arbitrary 3-D Objects: Five Practical

[12] Richard Franke, “Scattered Data Interpolation: Tests of

Methods”, IEEE Transactions on Pattern Analysis and

Some Methods”, Mathematics of computation, vol. 38, no.

Machine Intelligence, vol. 14, no. 8, pp.833-839, 1992.

157, pp.181-200, 1982.

[9] W. Sun, C. Bradley, Y. F. Zhang, H. T. Loh, “Cloud data

[13] Ke Yinglin, Li An “Extruded surface extraction based on

modeling employing a unified non-redundant triangular

unorganized point cloud in reverse engineering” Journal

mesh”, Computer-Aided Design, vol. 33, no. 2, pp.183-193,

of Computer-Aided Design & Computer Graphics (to

2001.

be published).

(a) Stander deviation of mean
curvature with varying noise

(b) Algorithm performance while processing
large amount of measured points

r

(c) Test model

(d) Stander deviation of mean curvature
with varying blend radius.
Fig.5. Comparison of algorithms

6 and Visualization (CGIV’04)
Proceedings of the International Conference on Computer Graphics, Imaging
0-7695-2178-9/04 $20.00 © 2004 IEEE


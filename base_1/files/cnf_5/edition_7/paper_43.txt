A Choice of Weights for Convex Combination Methods in Estimating Partial
Derivatives
1st

Y. Ooi, 2ndL. H. T. Chang, 3rdY. P. Wong, 4thA. R. M. Piah
1st,4th
School of Mathematical Sciences, University of Sciences of Malaysia, 11800 USM PULAU
PINANG, MALAYSIA.
2nd
Communication Skills and Entrepreneurship Centre, Northern Malaysia University College of
Engineering, 01000 KANGAR, PERLIS, MALAYSIA.
3rd
Faculty of Information Technology, Multimedia University, 63100 CYBERJAYA, SELANGOR,
MALAYSIA.
1st
2nd
{ ooiyongson@hotmail.com, lawrence@kukum.edu.my, 3rdypwong@mmu.edu.my,
4th
arahni@cs.usm.my}
G  x, y 

Abstract
Weights in convex combination methods are
important parameters in the estimation of partial
derivative values in three dimensional scattered data
points. In this paper, we introduce the three angles of the
base triangle as weights in order to have more options for
weight variety.
Keywords--- Partial derivative estimation, Convex
combination method.

z k  ax  x k   bx  x k  y  y k 
2

 c  y  y k   d  x  x k   e y  y k 
2

Its partial derivatives may be written as

and

wG
wx

2a  x  x k   b y  y k   d

wG
wy

2c y  y k   bx  x k   e

And the partial derivative values at point k are simply

1.

Introduction

In order to create a smooth surface interpolating three
dimensional scattered data points, first order partial
derivatives are needed at the very least for obtaining
tangential or C1 continuity interpolants (Böhm et al. [1],
Farin [2]). Unfortunately, these partial derivative values
are not easily available from raw three dimensional
scattered data points and we have no choice but to
estimate them. There are available methods such as the
least-squares minimisation method (Renka & Cline [3]) as
well as the convex combination method (Goodman et al.
[4]) that we shall briefly discuss.
In the least squares minimisation method, we assume
a parabolic bowl or a quadratic function z G x, y  that
interpolates point k at its vertex and approximates a
specified number of neighbouring points:

wG
x k , y k  d
wx
and

wG
x k , y k  e
wy

However, the least squares minimisation method
requires a huge computation and programming effort
which is why Goodman et al. proposed the convex
combination method. This method greatly reduces
computation time and the programming effort is also
minimal.
In the convex combination method, first of all, the
data points have to be triangulated based on the x-y
coordinates. If we are estimating the partial derivatives at
point k, we need to know the gradients of the triangles
surrounding point k, i.e. T1 , T2 , …, Tn . If point k is a
boundary point, we also need to know the gradients of the
c
c
c
adjoining neighbouring triangles, i.e. T1 , T2 , …, Tn , as
well (see Figure 1).

Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIV’04)
0-7695-2178-9/04 $20.00 © 2004 IEEE

T1

T1

kx

T2

T3
T3

2.

c

T2

Weight options

Let us look at the three different shapes of triangles
as shown in Figures 2(a), 2(b) and 2(c). Figure 2(a)
shows a “short and fat” triangle, 2(b) a “long and thin”
triangle and 2(c) an almost equilateral triangle.

c

c

k
Figure 1. Point k with its triangles

ș
Let g 1 , g 2 , …, g n be the gradients of T1 , T2 , …,
c
c
c
Tn respectively. Also, let g 1 , g 2 , …, g n be the
c
c
c
gradients of T1 , T2 , …, Tn respectively. We may code
the convex combination method as

Figure 2(a). Short and fat triangle

k

n

F cx k , y k 

w1 g 1  w2 g 2    wn g n
w1  w 2    w n

h

¦ wi g i
i 1
n

¦w

i

i 1

ș

for the estimation of partial derivatives at non-boundary
points and

F cx k y k 

§ §§
c
gi
1 ·¸
¨ ¨¨ 2


g
i
¨ ¨¨w
c¸
wi
n
¨ ¨ © i wi ¹
¦
¨ wi ¨
1
1
i 1
¨ ¨

wi w c
¨ ¨
i
¨ ¨
© ©

··
¸¸
¸¸
¸¸
¸¸
¸¸
¸¸ ¸
¸
¹¹

h

Figure 2(b). Long and thin triangle

n

¦w

i

k

i 1

for the estimation of partial derivatives at boundary
points.
In their paper introducing the convex combination
method to estimate partial derivatives, Goodman et al.
1
, as
used the reciprocals of the base triangle areas, w
'
weights. Later, Martin (Chang & Wong [5]) suggested
1
using the reciprocals of the base triangle altitudes, w
,
h
radiating from point k as weights.
In this paper, we propose using the angles of the base
triangles, w T , measured at point k as weights. In the
following sections, we explain the rationale behind our
suggestion and a comparison test is carried out to gauge
the accuracy of the partial derivatives estimated from the
three different weights.

ș
h

Figure 2(c). Almost equilateral triangle

As mentioned in Section 1, Goodman et al. use the
reciprocal of the base triangle areas as weights. Base
triangle areas are size sensitive but not shape sensitive.
Therefore, if the triangles taken into consideration have
almost similar areas but different shapes, the weights will
not differ much. It is in this consideration that Martin
(see Chang & Wong [5]) suggested using the reciprocals
of the triangular altitudes radiating from point k as

Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIV’04)
0-7695-2178-9/04 $20.00 © 2004 IEEE

weights. In this way, the shapes of the triangles play a
significant role in weight determination. Weights based
on the reciprocal of the altitudes of the base triangles are
more shape sensitive in the sense that for thin triangles
like in Figure 2(b), the altitudes, h, have greater values
1
which means the weights, w
, are lesser in value.
h
Similarly, the altitudes of short and fat triangles, like in
Figure 2(a), have lesser values and this means these
weights have greater values.
It is also in this consideration of the triangular
shapes that we suggest using the angles, w T , around
point k of the base triangles as weights. These should
agree with the reciprocals of the altitudes of the base
triangles. As seen in Figure 2(a), the triangle has a short
altitude and a big angle at point k, yielding a big weight.
Figure 2(b) shows a triangle with a long altitude and a
small angle at point k, hence yielding a small weight.

Figure 3. Delaunay triangulation of the 36 test
data points

Two well-known functions are used in our tests:
1. Saddle function
F1 x, y 

1.25  cos5.4 y 
6  63x  1

2

2. Franke’s exponential function

3.

Results and discussion
F2 x, y  0.75e

In order to carry out the tests for the different weights
in the convex combination method, we use the test
domain of a unit square of 36 points used by Whelan [6].
These points are triangulated using Delaunay’s
triangulation method (Brassel & Reif [7]).
The
coordinates of these 36 points is tabled in Table 1 and the
resulting Delaunay’s triangulation is shown in Figure 3.
Table 1. 36 test data points
Point
No.
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18

Coordinates
x
y
0.00
0.00
0.50
0.00
1.00
0.00
0.15
0.15
0.70
0.15
0.50
0.20
0.25
0.30
0.40
0.30
0.75
0.40
0.85
0.25
0.55
0.45
0.00
0.50
0.20
0.45
0.45
0.55
0.60
0.65
0.25
0.70
0.40
0.80
0.65
0.75

Point
No.
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36

Coordinates
x
y
0.80
0.85
0.85
0.65
1.00
0.50
1.00
1.00
0.50
1.00
0.10
0.85
0.00
1.00
0.25
0.00
0.75
0.00
0.25
1.00
0.00
0.25
0.75
1.00
0.00
0.75
1.00
0.25
1.00
0.75
0.19
0.19
0.32
0.75
0.79
0.46

§ 9 x  2 2   9 y  2 2 ·
¸
¨
¸
¨
4
¹
©
§ 9 x  7   9 y  3 
¨
¨
4
©
2

 0.50e

2

 0.75e
·
¸
¸
¹

§ 9 x 12 9 y 1 ·
¸
¨

¨
10 ¹¸
© 49

 0.20e  9 x  4 

2

 9 y  7 2



All the partial derivative values for these 36 points
are obtained and the errors between the estimated and the
actual derivative values are compared.
Besides
comparing the errors of the partial derivative values, we
also compare the angles, ȥ, between the actual and the
estimated vectors at all the data points. The reason for
this comparison is due to the fact that steeper slopes have
gradients of much higher values than almost horizontal
slopes but the scales of angles are uniform throughout
from the horizontal to the vertical. Therefore, the angle
between the two vectors at each data point may be
suitably used to gauge the accuracy of the convex
combination method when using different weights. The
resulting errors are tabled in Tables 1, 2 and 3.
Table 2. Comparison of the mean absolute errors
for all 36 points
w

Function
Saddle

w

1
h

w T

wz
wx

0.084480

0.081809

0.087176

wz
wy

0.107790
0.115365
0.340011

0.103958
0.110563
0.311411

0.106612
0.116955
0.333559

0.391382
0.259395

0.375929
0.242411

0.395082
0.263329

\
Franke’s

1
'

wz
wx

wz
wy

\

Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIV’04)
0-7695-2178-9/04 $20.00 © 2004 IEEE

Table 3. Comparison of mean absolute errors for
non-boundary points
w

Function
Saddle

w

1
h

w T

wz
wx

0.084480

0.081809

0.087176

wz
wy

0.107790
0.115365
0.340011

0.103958
0.110563
0.311411

0.106612
0.116955
0.333559

0.391382
0.259395

0.375929
0.242411

0.395082
0.263329

\
Franke’s

1
'

wz
wx
wz
wy

\

Table 4. Comparison of maximum absolute errors
for all 36 points
w

Function
Saddle

wz
wx
wz
wy

\
Franke’s

wz
wx
wz
wy

1
'

w

1
h

w T

0.298376
(6)

0.290634
(6)

0.298868
(26)

0.380398
(26)
0.372427
(26)
0.972078
(3)

0.408416
(26)
0.423347
(26)
0.835827
(1)

0.441016
(26)
0.482822
(26)
1.081507
(17)

1.138082
1.124918
(10)
(1)
0.847979
0.834933
\
(23)
(23)
*The values in brackets are the point numbers.

1.083952
(7)
0.758175
(23)

In Table 1, we can see that using the reciprocals of
the base triangular altitudes as weights yields the best
accuracy when comparing the mean absolute errors for all
the 36 points.
Table 2 shows the partial derivative values only at
the non-boundary points. Once again, we see that the
reciprocals of the base triangular altitudes yield the
smallest errors in most of the cases.
For boundary points, although we do not table the
mean absolute errors, our tests show that using the
reciprocals of the base triangular areas as weights result in
a slightly better accuracy when compared to the other
weights.

Conclusions
In summary, although both the angle and the
reciprocal of the triangular altitude have the same analogy
in terms of weight value, there are some differences in the
results obtained. It should be noted that these weights
need only be calculated once and stored in the computer’s
memory to be recalled whenever needed. On the average,
weights based on the reciprocals of the triangular altitudes
yield better results but it should also be noted that
computation using weights based on the angles of the
triangles requires only one division.

Acknowledgement
We would like to thank Mr. C.S. Ng for offering us
help with the Visual Basic programming.

References
[1] W. Böhm, G. Farin and J. Kahmann. A survey of curve
and surface methods in CAGD.
Computer Aided
Geometric Design 1, 1-60. 1984.
[2] G. Farin. Triangular Bernstein-Bézier patches. Computer
Aided Geometric Design 3, 83-127. 1986.
[3] R. J. Renka and A. K. Cline. A triangle-based C1
interpolation method.
Rocky Mountain Journal of
Mathematics 14(1), 223-237. 1984.
[4] T. N. T. Goodman, H. B. Said and L. H. T. Chang. Local
derivative estimation for scattered data interpolation.
Applied Mathematics and Computation 68, 41-50. 1995.
[5] L. H. T. Chang and Y. P. Wong. Partial derivative
estimation using convex combination methods.
In
Proceedings of the 7th Asian Technology Conference in
Mathematics 2002 (W. C. Yang, S. C. Chu, T. de Alwis and
F. M. Bhatti, eds.), 477-486. 2002.
[6] T. Whelan. A representation of a C2 interpolant over
triangles. Computer Aided Geometric Design 3, 53-66.
1986.
[7] K. E. Brassel and D. Reif. A procedure to generate
Thiessen polygons. Geographical Analysis 11(3), 289-303.
1979.

Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIV’04)
0-7695-2178-9/04 $20.00 © 2004 IEEE


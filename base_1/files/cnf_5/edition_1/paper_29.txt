2011 Eighth International Conference Computer Graphics, Imaging and Visualization

A Visualization System for Tomato Plant Modeling
Wei-long Ding, Hu-jun Jin, Zhi-jun Cheng, Qi Chen
College of Computer Science & Technology, Zhejiang University of Technology, Hangzhou,
China
{wlding@zjut.edu.cn }
Abstract

time and money than the traditional experiments in
practice. And virtual crop owns great value to popularize
advanced technology and botanical knowledge,
especially for agrarian countries. Besides, it will benefit
greatly to 3D animation, commercial advertisement, and
landscape design, etc [1].
As one of the main fruit crops, modelling tomato
growth is always a focus of research in the field of crop
model. Computer modelling and visualization of tomato
development has an important role in agricultural study,
because the spatial information may be used to calculate
such things as how leaf shape and internodes length
affect canopy penetration by light. Simulated
performance of hypothetical tomato architectures could
suggest target forms for tomato breeders and genetic
engineers. In this article, an efficient software system for
visually simulating tomato plant was designed and
implemented based on the techniques of Parametric Lsystem, Computer Graphics, etc. The remainder of the
paper is organized as following: Section 2 introduces the
structure and the function of system; Section 3
introduces key techniques to implement the system;
Section 4 shows the interface design and Section 5
finally draws the conclusion and points out some
potential topics for the future work.

Virtual crop models make great significances to the
research of quantification of field evapotranspiration,
design of plant type, and optimization of cultural
practices. Because most existing plant-modeling systems
require the user to have specific biological knowledge
about plants, thus it is often a hard and laborious task by
using these systems to create a three-dimensional plant
model. Moreover, there is lack of software tools to
specially simulate the structures and growth process of a
certain kind of crop. With regard to those statuses of
virtual plant modeling, in this article a powerful and
convenient tomato plant modeling system is developed
with the integrated platform of Visual C++ 6.0 and
OpenGL. Based on the growth laws and the topological
structure’s character of tomato plant, Parametric Lsystem is used to simulate the topological structures of
tomato plant. The technique of parametric triangular
meshes is used to model different organs of tomato, and
the surface-rendering techniques in Computer Graphics
are used to render the created shapes of tomato plant at
both organ and individual levels. Based on the
accumulated temperature model, the system can predict
the growth status of tomato plant, and give some
suggestion of tomato planting.

2. Relative works

Keywords--Tomato
plant,
Visualization,
Geometric
modeling,
Architecture
modeling,
Rendering

L-system is a usual method and a mathematical
theory to model plant morphology and plant growth,
which was proposed by the American biologist, A.
Lindenmayer, in 1968 [2]. In 1984, Smith utilized the Lsystem as a tool to create the image of plant
[3].
Prusinkiewicz, used the L-system to produce realistic
image of trees, bushes, and owers [4], and proposed
different kinds of L-system, such as Parametric Lsystem, Timed L-system, stochastic L-system. Moreover,
there are many other specialists in computer graphics
apply themselves to the research of the L-system and its
application in plant modelling and simulation. For
instance, Hanan J and Prussinkiewicz P, simulated the
movement pattern of pest and the influence between pest
and the plant structure [5] by using of L-system.
Meinhardt H and Prusinkiewicz P employed L-system to

1. Introduction
In recent years, virtual crop now has been a
hotspot in the fields of digital agriculture. This
technology has integrated many core technologies
involved in computer graphics, agronomy, multimedia
and mathematics. Virtual crop plays important roles in
research and development of agriculture. By using
virtual crop, for example, virtual experiments in virtual
farms can be carried out to explore the growth rule of a
plant and thus help farm managers to make proper
decisions. Moreover, virtual experiments can save more
978-0-7695-4484-7/11 $26.00 © 2011 IEEE
DOI 10.1109/CGIV.2011.13

160

study the shape of seashell [6]. Their researches
expanded the conception of L-system and made it
develop very quickly. There are some different kinds of
L-systems as mentioned above, but they all are a string
rewriting system, which uses an axiom and a set of
productions to generate a character string by finite
recursive operations, and the character string can be
interpreted as the structure of a plant. L-systems are
suitable for describing the morphologic architectures of
plants.
Virtual crop development starts from the mid-1990s.
In the year of 1995, Room et al proposed a virtual cotton
model to help the research, management and training of
cotton cultivation [7]. Fournier et al combined 3D
architectural model of maize with its process-based
model, and thus built an ADEL-maize model to simulate
the process of maize development [8]. Kaitaniemi P et al
presented a spatial simulation model of grain sorghum,
which can capture the dynamic interaction between
partitioning and morphogenesis with a visual way [9].
Recently, many successful virtual crop models with
special functions have been built, for example, virtual
maize models [10~11] and virtual tomato models [12,13]
based on large-scale measured data, virtual wheat models
[14] based on the analysis to the process of plant type
formation.

for ( int i=0; i< the number of surfaces to form one
leaf; i++)
{ Assign the points to the variable ptmol;
glBegin(GL_TRIANGLE);
for (int j=0; j<the number of points to form the
current surface; j++)
{ save the index value of the current surface;
set the normal line (glNormal3f) of the
current surface;
set the vertexal coordinate of the current;
surface(glVertex3f);
ptmol++; }
glEnd();}
3.1.3. Fruit modeling. According to the analysis of
shapes and parameters of tomato fruit, we adopt the
modeling method of branches to simulate the shape of
tomato fruit. To use this technique for fruit shape
modeling, the first step is to get the current direction of
turtle (A), shown in Figure 1(a).The second step is to get
one line of edge (B) and set B along the axis of rotation
A, shown in Fig.1b.Thus, we can create the surface of
tomato fruit(S). It is very important to get the coordinate
of each radius, shown in Fig.1c.We divide the fruit into
twenty parts, and each part has fifty control points. We
respectively simulate these parts, and then integrate them
into a fruit, shown in Fig.1d.

3. Key technologies of system implement
3.1. Tomato organs’ modeling

a) direction (A)

3.1.1. Branches modeling. We adopt a method of
polyhedral joints to simulate the branches and develop a
function with four parameters (the spatial position, the
direction, the radius, and the length of cylinder) to
conveniently draw a cylinder. The pseudo-code of this
algorithm is given as the followings:
Step 1: Select one point P1 at circle I, and set the

c) radius (R , r)

b) edge(B)

d) fruit

Figure 1 the shape of tomato fruit
The modeling of tomato growth can be divided
into three stages:
First stage: Rapid growth, fruit colour is green,
which last 10 to 20 days, shown in Fig.2a.
Second stage: slow growth, fruit colour is from
green to red, which last 30 to 40 days, shown in Fig.2b.
Third stage: slow growth, fruit colour is red, last
10 to 15 days, shown in Fig.2c.
The pseudo-codes of this algorithm are given as
the followings:
Step1: draw the shape of fruit, this pseudo-code
similar to the algorithm shown in the section of 3.1.1.
Step2: if(day<=first stage)
{G size=G size+ first speed
G colour=green}
else if (day<=second stage)
{G size=G size+ second speed
G colour=from green to red}
else if(day<=third stage)
{G size=G size+ third speed
G colour=red}

value of θ

is 0.
Step 2: Select another point P2 at the same circle,
and set the value of central angle between P1 and P2 is
π /20.
Step 3: Add the height value of H to the points P1
and P2 get the points P3 and P4, and then draw a

rectangle with the points P1~P4. Let θ += π /20, assign
the coordinate value of P2 to P1;

Step 4: if ( θ = =2 π )
End the algorithm;
else
Go to the Step 2.
3.1.2. Leaves modeling. The leaves of tomato plant
are simulated by using the parametric triangular meshes.
The pseudo-code of this algorithm is given as the
followings:
Step 1: Read the discrete data of leaves from the
database of organs.
Step 2: Assign the position and the vector of each
discrete point to the variable pfxl;
Step 3:

161

}
TempString =temp;
}

a) First stage b) second stage c) third stage
Figure 2 the different stages of tomato fruit

Step 4: for(int i=0;i<GString.GetLength();i++)
{
if(Age!= ‘P’)
{switch(GString[i])
{ case ‘F’: draw stem; break;
case ‘f’: draw branches; break;
case ‘L’: draw leaf blade; break;
case ‘h’: draw fruit; break;
……
case ‘[’: put down the current position and direction
to the stack; break;
case ‘]’: put out the current position and direction to
the stack; break;
default: break; }
}
}
Step 5: while (day<140)
{if(day%10==0){ turn to Step3,Step4}
else { scale plant modules = scale plant
modules + different variable }}
According to the algorithm of Parametric L-system,
the topological structure of tomato plant and its growth
process are simulated. Fig.3 gives examples of the
simulated tomato plant at different growth stages.

3.2. Modeling single tomato plant
The spatial characteristic of tomato plant at each
growth stage, which includes the topology and the
sequence of activities of various plant modules, is
analyzed to deduce the parameters of L-system, such as
axiom and productions. We divide the architecture of
tomato plant into base, growth unit, fruit and plant with
the scale of organ, and suppose that the growth unit is
made of an internode, an axillary meristem and a leaf.
On the basis of this, we can deduce the axiom and
productions to describe the spatial structure of tomato
plant as the followings:
V= [A, B,S, H,h,L,F,f, [, ], +, -,/,I,o]
ω= FA(0)
(1)
P = [P1, P2, P3, P4];
P1:A→iF/B[ofS[+l(0)][-l(0)]ofl(0)]A(0);
(2)
P2: B→oF;
(3)
P3: S→of[+l(0)]of[-l(0)]S(0);
(4)
P4: H→[if[/ih(0)]]/ [if[/ih(0)]]/ [if[/ih(0)]];
(5)
Where, Symbol means:
[: push the current state of turtle into the stack
]: pop a state from the stack and assigns it as the current
state of the turtle
‘+’: turn left (counter-clockwise) with certain angle
‘-’: turn right (counter-clockwise) with certain angle
‘I’: turn up (counter-clockwise) with certain angle
‘o’ :turn down (counter-clockwise) with certain angle
‘/’:rotate direction of turtle with certain angle
‘F’: stem
‘f’: branch
‘h’: fruit
‘L’, ‘l’:leaf
In the axiom and the production of P1,P2, P4 and
P5, the number 0, are the value of organs age.
The pseudo-code to simulate the topological structure of
tomato plant is given as followings:
Step 1: Define an array, TempString, to store the
string created at each iteration step;
Step 2: assigned the axiom to the array,
TempString;
Step 3:
for (int j=0;j< iteration times ;j++)
{ for (int i=0;i<the length of TempString; i ++)
{ switch(TempString[j]) {
case ‘A’: temp+=P1; break;
case ‘B’: temp+=P2; break;
case ‘S’: temp+=P3; break;
case ‘Age’:
if(Age==Stop Age)
temp+=‘P’;
else Age=Age+1;
break;
default: temp+=TempString[j]; break;}

Figure 3 Modeling growth process of tomato
plant

3.3. Modeling the group of tomato plant
The modeling of natural scenes, such as forest,
garden, grassland, has been a challenging task in the field
of Computer Graphics. To simplify the modeling
process, we use a simple method to modeling the group
of tomato plant. Firstly, we simulate the individual
tomato plant by using Parametric L-system, and then
duplicate the individual tomato plants and places them
one by one into the designated positions. Fig.4 gives two
examples of group modeling of tomato plant by using
our method. The advantage of this technique is simple,
and the quantity of tomato plant is not limited. However,
the modeling speed of this method is low and wastes a
lot of memory space.

162

α , β ,γ

The value of
can be calculated by using the least
square method according to the data obtained in the
experiments of different growth periods of tomato.
3) The radius of fruit
Suppose the internode is a sphere (ρ=1), the following
formula can give the radius of fruit,
a) Flowering stage

rkF (i ) = 3

3 ⋅ q kF (i )
4 ⋅π

(4)
To use those formulas, it needs some parameters
(e, α, β, γ, etc), and they can be obtained by the result of
agricultural experiments.
On the basis of this, our system can calculate the
geometrical features of tomato plant, which are shown in
Fig.7 (e). Users can compare the real growth status with
the simulated results, and through the interaction
between the computer and the user, the system will give
some suggestion of tomato planting to the user

b) Fruiting stage
Figure 4 Modeling groups of tomato plants

3.4. Accumulated temperature

4. Implementation and results

The available accumulated temperature model of
greenhouse tomato is an ecophysiological model which
expresses the relationship between the growing process
of different organs and the available accumulated
temperature. This model is provided by agricultural
scientist and built under the hypothesis of suitable water
and fertilizer condition. It is a bridge that connects the
morphogenetic model and the knowledge model of our
system.

Based on the algorithms mentioned above, a
software tool for tomato plant modelling is developed.
The algorithm is written in c++ language with the
OpenGL library, and it is implemented on a PC with
Pentium IV 1.83 GHz CPU, 1.5GB RAM. Based on the
SDI in MFC, the main interface is divided into three
parts (Action-operating area, animation- displaying area,
process-controlling area) by using the technique of
window segmentation, shown in Fig.5.

q O (i )

) obtained by different organs
The biomass ( k
above the ground of the tomato at different growth stages
can be figured out according to the available
accumulated temperature model. According to the
obtained biomass, using of the following formulas [15,
16] can get the parameters of different organ and the
individual tomato plant.
1) The surface area of leaf
Suppose the density (ρ) of leaf equals to one, then

q O (i )

. Therefore, the
leaf’s volume equals to its quality k
surface area of leaf can be calculated by the formula:

S kL (i ) =

q kL (i )
e

Figure 5 a screen shot of the system in
operation

(1)

Where e is the thickness value of a blade.
2) The length and radius of internode
Suppose the internode is a cylinder (ρ=1), then its
quality, diameter and length satisfy the following
formula:

The main framework is shown in Fig 6. The main
modules of the developed system are composed of
database, model library, knowledge library, and humancomputer interface, etc.
1) The module of architectural models, which provides
the topological information describing the relationships
and distribution states of different organs, such as the
quantity, positions, types, and mutual structure
relationship of the organs growing up in each growth
period.
2) The module of geometrical models, which describes
the whole structure of a tomato plant and 3D geometrical
information of the stem, leaves, and panicle, such as

3
q kI (i ) = π (d kI (i )) 2 × l kI (i )
4

(2)
If the quality of internode in a certain period, its
diameter can be gotten by the formula:

d kI (i ) = α × q kI (i ) 2 + β × q kI (i ) + γ

(3)

163

length and radius of a branch, magnitude of a branching
angle, etc.
3) The module of rendering models, which employs the
techniques of Computer Graphics, including texture
mapping, illumination calculation, depth blanking and
projection, to dispose the 3D structure of a tomato plant
and make the figures true to nature.
4) The module of three-dimensional objects, are
responsible for creating various organs of the tomato
plant, which consists of algorithms to generate cylinder,
ellipsoid, leaf, flower, fruit, etc.
5) The module of human computer interface, including
the display of 3D image and animation of tomato plant
growth, the algorithm of creating and playing animation.

a) Sets the topology b) Sets environmental c) Set geometry

d) Select simulation of growth

e)

f) Compare with simulation g) Suggestion of planting
Figure 7 the process of creating realistic images
of tomato plant

Figure 6 main framework
This system provides an integrated development
environment for users to model, simulate and visualize
the three-dimensional shapes and the growth process of
the tomato plant, which can run in the platform of
Windows NT and Windows 2K. The software tool can
simulate different three- dimensional images and the
growth process of different tomato plant with appropriate
parameters. And it provides convenient dialogs to
interactively modify and render the overall shape or the
single organs of a tomato plant. Moreover, it can control
the spatial architecture of a tomato plant, and the
simulated shapes will change immediately when the
simulation parameter changes.
To create visually realistic images of tomato plant,
the modeling process is simply described in Fig.7, from
step a) to step g).When creating the tomato plants, the
user first sets the information of topology, such as the
angle between branch and stem, the bend parameter of
principal axis. Then the user sets the parameters of the
accumulated temperature, and the illumination. The user
also can adjust the shape by using the geometry editor
and set the growth condition. After the individual image
is accomplished, the system will give the result of
simulation. By comparing the real growth status with the
simulated results, the system will give some suggestion
of tomato planting to the user.

Conclusions and future work
The key idea of this paper is to construct a
simulation system for realistic simulating tomato plant in
virtual environment. This system provides an integrated
development environment for users to model different
shapes and the growth process of tomato plant by setting
different parameters. Parametric L-system is used to
simulate the topological structures of tomato plant. And
different algorithms are used to model different organs of
tomato. The experiment results show that the developed
system of virtual tomato modeling is doable and
effective, and the generated three-dimensional images of
tomato plant are realistic.
Due to the complicated structures and growth
process of tomato plant, in the future we would like to
explore the following issues: 1) the algorithm of tomato
leaf modeling is only accurate for a certain stage, but not
suitable for the constantly changing of leaf shape during
the growing process. So the proposed algorithm for
tomato leaf modeling needs to be improved. 2) How to
combine the architectural model with the functional
model of the tomato plant in a certain way, and to
visually simulate the interactions between the tomato
plant and the environment. 3) When modeling of a group
of tomato plants, the system will be slow down due to
the complexity of the algorithm, thus the optimization
algorithm to this issue would be studied in the future.

Acknowledgements
This research program has been supported by Key
Technologies R&D Program of Science and Technology

164

Department of Zhejiang Province (No. 2008C120612),and National Natural Science Foundation of China
under Grant No.60901081 and No.30771247.

[16] Dong, Q.-X., Wang, Y.-M.,et al. (2003). Tomato growth
modeling based on interaction of its structure-function.
Proceedings of 2003’ International Symposium on Plant
Growth Modeling, Simulation, Visualization and their
Application, Beijing, Tsinghua University Press and
Springer, pp.250-262.

References
[1] Guo, Y, Li, B. G.(2001). New advances in virtual plant
research. Chinese Science Bulletin, vol.46,pp.273-280.
[2] Lindenmay, A. (1968). Mathematical models for cellular
interaction in development, Parts I and II. Journal of
Theoretical Biology, 18, pp.280-315.
[3] Smith, A. R. (1984). Plants, fractals and formal languages.
Computer Graphics. 18(3), pp.1-10
[4] Prusinkiewicz, P., Lindenmayer, A.(1990). The Algorithmic
Beauty of Plants, Springer Verleg, New York.
[5] Hanan, J., Prusinkiewicz, P., et al.(2002). Simulation of
insect movement with respect to plant architecture and
morphogenesis. Computer and Electronics in Agriculture,
35, pp.255-269
[6] Meinhardt, H., Prusinkiewicz, P., Fowler, D. R. (1990). The
Algorithmic Beauty of Sea Shells (Virtual Laboratory).
Springer-Verlag, Berlin.
[7] Room, P. M., Hanan, J. S. (1995). Virtual cotton: a new
tool for research, management and training. In: Constable G
A, et al. Proceedings of the World Cotton Research
Conference-1: Challenging the Future, Brisbane,
Melbourne: CSIRO Australia, pp.40-44.
[8] Fournier, C., Andrieu, B.(1999). ADEL-maize: an L-system
based model for the integration of growth processes from
the organ to the canopy. Agronomie, (19), pp. 313-327.
[9] Kaitaniemi, P.,Hanan, J. S.,Room, P. M.(2000). Virtual
sorghum: visualization of partitioning and morphogenesis.
Computers and Electronics in Agriculture, (28), pp.195205,.
[10] Guo, X. Y., Zhao, C. J., Xiao, B. X., et al. (2007). Design
and implementation of three-dimensional geometric
morphological modelling and visualization system for
maize. Transactions of the Chinese Society of Agricultural
Engineering, vol.23, pp.144－148.
[11] Ma, Y. T, Wen, M. P., Guo, Y., et al. (2008). Parameter
optimization and field validation of the functionalstructural model GREENLAB for maize at different
population densities. Annals of Botany, vol.101, pp.11851194.
[12] Dong, Q. X., Louarn, G., Wang, Y. M.; Barczi, J. F.,de
Reffye, P. (2008).Does the structure- function model
GREENLAB deal with crop phenotypic plasticity induced
by plant spacing? A case study on tomato”. Annals of
botany, vol. 101, pp.1195-206.
[13] Ding, W. L., Ma, P. L., Cheng, Z. J. (2008). Visual
modelling and simulation of plant growth based on plant
functional- structural mutual feedback mechanism.
Transactions of the Chinese Society of Agricultural
Engineering, vol.24, pp.165-168.
[14] Wu, Y. L., Cao, W. X., Tang, L., et al. (2009). OpenGLbased visual technology for wheat morphology.
Transactions of the Chinese Society of Agricultural
Engineering, vol.25, pp.121－126.
[15] P. De Reffye, Hu, B.-G.(2003). Relevant qualitative and
quantitative choices for building and efficient dynamic
plant growth model:GreenLab case. Proceedings of 2003’
International Symposium on Plant Growth Modeling,
Simulation, Visualization and their Application.
Beijing,Tsinghua University Press and Springer, pp.87107.

165


A way to real-time ocean wave simulation
Huaiqing He a, Haohan Liu a, Fantao Zeng a, and Guoqing Yang b*
a

College of Computer Science and Technology, Civil Aviation University of China, Tianjin 300300, China
b
the Civil Aviation Administration of China

ABSTRACT
This paper presents a way named spectrum-texture coordinate translation to solve real-time ocean wave simulation
problem. It is found by experiment tests and comparisons. Based on viewpoint analysis, different ways are adopted to
simulate wave. Spectrum-model is used to simulate the near ocean area scene and texture coordinate translation is used
to simulate the far ocean area scene. By this way, simulation fidelity and real-time can be achieved synchronously.
Keywords: spectrum-texture coordinate translation, real-time wave simulation, spectrum analysis, texture mapping

1. INTRODUCTION
The simulation of natural phenomena has always been one of the most challenging research directions in computer
graphics. The two evaluation targets for simulation results are fidelity and real-time. It is well known that ocean wave is
a very complex phenomenon. Its shape changes from time to time. Different reasons lead to all kinds of ocean waves.
How to simulate them lifelike becomes very difficult.
There is, of course, a substantial body of literature on ocean surface simulation, both in computer graphics circles and in
oceanography. There are also some good examples such as the films Water world and Titanic.
From the view of computer graphics, the common used methods to simulate wave can be classified into three categories:
The first one is based on wave analysis [1] [2] [3] [4] [5], in which wave surface is represented by directly constructed
parameter surface. For example,

n

z = f ( x, y, t ) = ¦i =0 Ai sin( wi t + φi ) ˈin which Ai , wi , φi changes with time.

Because wave function reflects wave properties, it can simulate wave motion such as wave addition, reflection,
refraction and so on. But it cannot simulate complex wave phenomena, such as wave broken up. Its characteristics are
simple, real-time and low requirement for hardware. It is often used in which there is no higher requirement for fidelity.
The second one is based on physical model [6] [7] [8], in which classical hydrodynamics is used to describe wave motion.
For example, Navier-Stokes equation is often used to build fleet water wave model. The wave is automatically generated
in terms of initial and boundary condition and approaches to real physical phenomena. But the solution is so difficult that
it needs quantity of computation and cannot generate the scene in real-time.
The third one is based on particle system [3] [9], in which wave is divided into micro particles and each particle moves in
some law. It can solve spray and wave fragmentized problem which cannot be solved by the above two methods. But the
problem it faces is how to draw particles. If the particle selected is point, ball or line, the real effect cannot be achieved.
The better way is to draw many invisible curve surfaces so that the nearer water particles are fused into one invisible
curve surface and farer ones are drawn into small water balls. Likewise, there are quantities of calculation and worse real
time in this way. It is often used with the other methods.
Although these ways are effective, how to build an accurate ocean wave model to satisfy the above evaluation targets is
still an unsolved problem.
This paper tries to solve the problem integrating the knowledge of oceanography. First, wave spectrum model is used.
The detailed process is described in part 3. Second, texture-coordinate translation is employed to simulate ocean wave. It
*

Further author information :( Send correspondence to Huaiqing He.)
Huaiqing He: E-mail: hehuaiqing@yahoo.com.cn, Telephone: 08602224092482

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

is described in part 4. By comparison, we combine the advantages of the two methods into a new way named spectrumtexture coordinate translation. By this way, simulation fidelity and real-time can be achieved synchronously.

2. RELATED WORK
[1]

Nelson L.Max utilizes the sum of the former N items of infinite series to imitate waves. He draws waves around the
island at dusk by ray tracing.
Gary A.Mastin [2] etc. finish white-noise image filtering and synthesization by means of the energy spectrum of wave
under the effect of wind-force and Fourier transformation. They gain the wave texture model of ocean surface.
Alain Fournier and William T. Reeves [3] simulate the ocean wave based on Gerstner wave model and simulate spray by
particle system.
Peachey [4] adopts the linear combination of sine function and quadric function to imitate the profile of wave.
Jerry Düsseldorf [5] synthesizes a patch of ocean waves from a Fast Fourier Transform (FFT) prescription. Meanwhile, he
focuses on the optical properties of water relevant to the graphics problem.
Anita T.Layton and Michiel van de Panne [6] proceed from two-dimensional shallow water equation and simplify the
equation by semi-Lagrange to imitate the collision effect between wave and barriers in the pond.
Chen [7] simulates ocean wave by solving two-dimensional hydraulics equation (Navier-Stokes) with numerical value
iteration.
Based on the hydraulic equations, XuYingqing [8] presents a physical model to simulate glide and wave. By adjusting the
initial values of the equations, people can really simulate different wave states. In order to simulate foams and sprays, the
particle system is used.
Based on the existing observation and research results of oceanography, Yang Huaiping [9] etc. utilize relevant formulas
about wave frequency spectrum and directional spectrum to simulate ocean wave quickly.
Zhu Shiqiang [10] etc. give a method to realize 3-dimension wave simulation based on Longuet-Higgins model and double
superimposition model. The objective is to achieve style and soul unites.

3. OCEAN WAVE SIMULATION BASED ON SPECTRUM ANALYSIS
3.1 related fundamentals
From medium-term of 1940’s, ocean kineticist Neummn and Pierson etc. presented a wave analysis method by random
process, that is spectrum analysis way. From then on describing wave by random process becomes a main means in
ocean wave research.
Plentiful of observation results show that ocean wave is normal random process in narrow band spectrum, its amplitude
submits to Rayleigh distribution, and its sinusoidal phase submits to uniform distribution between range [0, 2±].
People present many models describing ocean wave, such as Longuet-Higgins model and double superimposition model.
Longuet-Higgins model describes water fluctuating on a fixed point by many cosine wave superimpositions. Meanwhile
it supposes that waves are generated on a plane and proceed along a fixed matching direction:
∞

η ( x, t ) = ¦ ζ n cos( wn t − k n x + ε n ) 



n =1

Where ζ n , wn , k n , ε n represents the amplitude, circle frequency, wave numbers and initial phase of the nth cosine wave
respectively. X is wave position and t is time vector.
This model just imitates the wave from main wind direction. But the real ocean wave is constructed by the wave from
different direction. Then the double superimposition model is used:
n

m

η ( x, y, t ) = ¦¦ ζ ij cos(wi t − k i [ x cosθ j + y sin θ j ] + ε ij )
i =1 j =1

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

(2)

Where ζ ij , wi , k i ,θ i , ε ij represents the amplitude, circle frequency, wave numbers, direction angle and initial phase of the
composed wave respectively. ( x, y) is some point coordinate on the wave surface. ε ij can be selected randomly
between 0 ~ 2π . k i and wi meet the hue dispersion relation:

wn2 = gk n tanh( k n d )

(3)

where g is acceleration of gravity and d is water depth.
The model is used to simulate ocean wave in this paper. Next the calculation ways for each parameter in the model will
be determined in terms of the theory of ocean spectrum.

3.2 the calculation of each parameter in the model
(1) Amplitude
The amplitude is calculated by energy partition of wave spectrum. Figure 1 shows the energy distribution of spectrum.
From the figure 1, energy=

1 2
gζ = area = Sζ w∆w . So,
2

w1

ζ = 2Sζ (w)∆w = 2 ³ Sζ (w)dw = 2E(wi )
w2

E ( wi ) is the area.

Choose w1 , w2 ,..., wn so that the energy in each frequency interval is equal. Then the calculation for amplitude

ζ is

described as following.

w

Define accumulation spectrum is. E ( w) = ³ Sζ ( w)dw Because

the

0

B

−
density of ocean power spectrum is Sζ ( w) = A e w4 ˈ
5
w
w

E ( w) = ³
0

B

B

A − w4
A − w4 .
e dw =
e
5
4B
w

wi

Then S ( w)dw = E ( w ) − E ( w ) . In terms of energy partition
i
i −1
³ ζ

Fig.1. The energy distribution of spectrum

idea, let E ( wi ) − E ( wi −1 ) = 1 E (∞ ) = A ,
M
4 BM

wi −1

Where M is partition energy shares. Then
ζ =

(2) Wave counts
According to

A
2 BM

linear

(4)

fluctuation theory, wave counts and circle frequency satisfy dispersion
kD
− kD
, where g is acceleration of gravity and D is water depth. While D is bigger
relation: w 2 = gk tanh( k , D ) = gk e − e
kD
e + e kD
2
than half of wavelength, k = w / g .
(3) Direction angle
Because the motion of ocean wave has some direction, the value of direction angle is generally˷-60oˈ+60o˹Ǆ
(4) Representative frequency w
The frequency range [ w1 , w2 ] is determined first. It relies on the precision required. Figure 2 shows two kinds of
common spectrum model.The energy fastens on ˷0.2ˈ3.5˹in different spectrum models. This interval is generally
selected as frequency range. M representative frequencies w are randomly chosen in [ w1 , w2 ] by random generator.
(5) Random phase
It is randomly selected in [0, 2 π ] by random generator.
(6) Number of cell regular wave
Suppose the number of cell regular wave is n. It is determined according to real-time and visual reality. The bigger n is,
the more the generated wave approaches the real wave. But the calculation is larger. Figure 3 shows real-time wave ren-

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

Fig.2.

(a) JONSWAP spectrum in different wind areas

(b) Neumann spectrum

dering speed on 40*20 triangular meshes while n value is different.

Fig.3.

Comparison of rendering speed in different n value

So n value must be chosen reasonably.
(7) Partition counts M of frequency w in spectrum energy distribution figure
M is determined by the way similar to n.
Based on the above, ocean wave is described as
following equation by (2) and (4) on the premise of
stable and normal process:
(a) Initial texture position

ζ =

A
4 BM

n

M

¦¦ cos[k

ij

( x sin θ i + y cos θ i ) + wij t + ε ij ] (5)

i =1 j =1

This way is complex and has quantities of calculation.
It achieves fidelity requirement, but is not real-time.

(b) After texture coordinate translation one time

4. OCEAN WAVE SIMULATION BASED
ON TEXTURE COORDINATE
TRANSLATION

Texture coordinate translation is a simple way to
simulate ocean wave. We take a line wave meshes as an
example to explain its basic realization process.
(1) We choose highly smooth texture sample picture
to complete texture mapping, which may be described
(c) After texture coordinate translation another time
by a segment of continuous conic. Curve position in
Fig. 4. Sketch map on texture coordinate translation
each mesh represents corresponding texture value on
texture picture. Figure 4 gives the sketch map in different states after translating the texture on mesh surface.
(2) Every time after graph rendering, texture coordinates are translated to a new position.
(3) Repeat (2) time after time. Then wave fluctuation effect is gotten.
Related description can be found in [11].
This way is simple, is completed easily and satisfies real-time requirement. Its rendering speed is 22 frames/second or so.
But its motion model is so simple that its simulation result has more difference from the real natural phenomena,
especially in near ocean area.

5. ocean wave simulation based on spectrum-texture coordinate translation
Although the way of texture coordinate translation has some defection, its simulation effect on far ocean area approaches
real state. Meanwhile it is real-time and has fast rendering speed. So we decide to combine spectrum analysis with

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

texture coordinate translation. Based on viewpoint analysis spectrum-model is used to simulate the near ocean area scene
and texture coordinate translation is used to simulate the far ocean area scene. We named this way spectrum-texture
coordinate translation.
(1) Building both wave mesh arrays. The first array saves the wave meshes near the viewpoint and the second one saves
the wave meshes far the viewpoint.
(2) Render wave based on mesh arrays. According to the distance from viewpoint different way is utilized.
(3) The texture coordinate translation speed in far ocean area has close relation with wind speed. By quantities of
experiments and experience observation, a approximate function relation is built as:
y = A log a x
(6)
Where A is the radio of single texture and whole ocean surface texture width, and is usually a constant; a is basic wind
speed. While wind speed is less than a, the ocean wave is approximately still. According to the relation between wind
speed and meaningful wave height, a is approximately selected in [3, 4].

6. EXPERIMENT COMPARISON
6.1 Simulation results comparison
We make experiments on microcomputer. Its configuration is PIII800, 128M memory and 64M display card. In the
procedure of simulation, we divide a plane into numbers of triangular meshes, and then transform it into a threedimensional surface. Subsequently, we apply different ways on the surface (60*30). The simulation results of each
method are shown as follows:

Fig.5. Three-dimensional triangular meshes (60*30)

Fig.7. The simulation results by the way of spectrum analysis

Fig.6. The simulation results by the way of texture coordinate translation

Fig.8. The simulation results by the way of spectrum-texture coordinate
translation

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

From the simulation results, the way of spectrum-texture coordinate translation can achieve the effect of spectrum
analysis and excel the texture coordinate translation.

6.2 Rendering speed comparison
Figure 8 and Figure 9 shows the rendering speed
comparison results. The experiment results show that the
presented spectrum-texture coordinate translation can
improve the rendering speed larger and does not change
the simulation fidelity. Although the maximum rendering
speed in spectrum-texture coordinate translation is only
20fps on current hardware configuration, it is acceptable.
Fig.8. The rendering speed test for texture coordinate translation

Fig.9. The rendering speed comparison for spectrum-texture coordinate translation and spectrum analysis

7. CONCLUSION
While simulating ocean wave, we employ both methods: spectrum analysis and texture coordinate translation. Based on
that we present spectrum-texture coordinate translation method.
In texture coordinate translation, wave height on each mesh point need not be calculated. So it is simple and has fast
rendering speed. But its defection is obvious that motion model is simple and wave translation is just observed near
viewpoint. Altogether this way is real-time and less fidelity.
In spectrum analysis, a mathematical corresponding relation between wave average energy fluctuation and fluctuation
amplitude is built. During a fixed frequency range the energy in every frequency interval is parted. Then the
transformation equation between wave height and frequency is built by integral transformation. Finally the wave
fluctuation equation is gotten according to Longuet-Higgins. The generated wave is real by this way. Because the height
of all mesh points must be computed while generating each frame image, it has large calculation quantity so that it is not
real-time.
The spectrum-texture coordinate translation combines the advantages of former two methods. Based on viewpoint
analysis spectrum-model is used to simulate the near ocean area scene and texture coordinate translation is used to
simulate the far ocean area scene. Experiment results show that its rendering speed improves 2 frames or so compared to
spectrum analysis on 60*30 mesh division. Meanwhile because the method integrates the knowledge of oceanography, it
preserves the fidelity.

ACKNOWLEDGMENTS
I am grateful to other authors who give me great support. Thanks also to the Civil Aviation Administration of China, which
provides the fund.

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

REFERENCES
Nelson L. Max. Vectorized Procedural Models for Natural Terrain˖Waves and Islands in the Sunset. Computer
Graphics, 1981.8:317-323
2. Gary A.Mastin, Peter A.Watterberg, John F.Mareda. Fourier Synthesis of Ocean Scenes IEEE CG&A, 1987.3:16-23
3. Alain Fournier. A Simple Model of Ocean Waves, SIGGRAPH’86: 75-83
4. Peachey D R. Modeling waves and surfaces. Computer Graphics, 1986,20(4): 65-74
5. Jerry Tessendorf. Simulating Ocean Water. In Simulating Nature: Realistic and Interactive Techniques, SIGGRAPH
2001 Course Notes 47.
6. Anita T Layton, Michiel van de Panne. A numerically efficient and stable algorithm for animating water waves. The
Visual Computer, 2002,18:41-53
7. Chen J X, Lobo N D V. Toward interactive-rate simulation of fluids with moving obstacles using Navier-Stokes
equations. Graphical Model and Image Processing, 1995,57(2): 107-116
8. Xu Yingqing, Su Cheng, Li Hua and Liu Shenquan. Physically Based Simulating of Water Currents and Waves.
Chinese J. Computers, 1996,9:153-159
9. Yang Huai-Ping, Sun Jia-guang.Wave Simulation Based on Ocean Wave Spectrums. Journal of System Simulation,
2002,9:1175-1178
10. Zhu Shiqiang. Research on 3-dimension simulation of wave. Watercraft engineering, 1999,6: 7-9
11. Fantao Zeng, Huaiqing He, Guoqing Yang. Real-time Wave Simulation Based on Texture-mapping. Fourth
international conference on virtual reality and its applications in industry, proceedings of SPIE, (5444): 46-53
1.

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE


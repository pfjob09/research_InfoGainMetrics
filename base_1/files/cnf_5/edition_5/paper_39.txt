A method for teletext display
Kaixiong Su, Yihong Peng
Dept. of Information and Communication Engineering
Fuzhou University, Fuzhou, China
{skx@fzu.edu.cn, effier@tom.com }
Abstract
During these years, the population of Chinese
cable TV consumers is increasing quickly. There are
over thirty TV stations providing teletext service. At
the same time, there are new requirements to
teletext. This paper introduces the teletext standard of
[5]
ETS300706 and it’s display method on the OSD
without VBI module. Teletext data extraction from
MPEGII stream and data decoding in the set-top box
are focused in this paper. A new method is used to
cache packets quickly and display pages steadily on
the OSD. The experiment shows that how the
customers select their favorite page to watch from
Teletext screen.

Keywords--- Teletext, ETS300706, STB, VBI, data
packet

teletext and cable television system, it can provide users
with more types of services such as stock information, email or telephone enquiries.[4] In May 1997 the European
Telecommunications Standards Institute defined enhanced
teletext specification to standardize teletext coding,
transmission and reception. After a few years of
development and the number of television users increasing,
information transmission through teletext becomes more
and more important.
It’s common on the market at present to use the OSD
with VBI hardware module to watch teletext program. But
this way is not compatible with digital TV signal. And we
can solve this problem by using set-top box.
First, VBI&STB mode of teletext and data elements
will be introduced followed by the discussion about
teletext data reception through set-top box and display on
TV. A new method for caching teletext packets quickly
and displaying pages steadily is proposed. Finally, there is
the summary and outlook for teletext development.

1. Introduction

2. VBI & STB Teletext Mode

Chinese broadcast TV has developed from analogue
era to digital era. After the fiber-optic network between
cities is built up, the digital broadcast TV will provide a
convenient interface for data transmission. After the audio
and video broadcast, data broadcast is the emergence of a
new generation of service in the television system. The
data broadcast based on DVB can provide public
information broadcast, distance education, financial
business news, data program, multimedia program, highspeed Internet access and other operational data. Teletext is
one of the most common applications.
Teletext is a service that transfers the stored data
information to the subscribers’ TV screen in a so-called
"frame" (page). It adopts a single-direction transmission
manner. Through teletext, news bulletin and other
information will usually be programmed into subtitles or
pages on television stream. Through the combination of

There are two ways to display teletext: VBI and STB
mode.
VBI mode is a common method to decode teletext data.
China adopts 625 Lines 25 fields television system.
Depending on availability, Lines 6 to 22 and 318 to 335
may be used to carry teletext data packets.[1] VBI teletext
system is composed of three independent systems:
broadcast system, transmission system and receiving
system. The broadcast system is used for editing and
producing teletext programs. The teletext is inserted into
VBI certain transmission lines without affecting the normal
TV program broadcast. Teletext data is separated and
processed by receiving terminal equipment. Teletext
decoding module is needed to watch real-time teletext
pages. Currently the stock receiver based on VBI teletext is
available in domestic market.[8]

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006

With the development from analog network to digital
network, digital television customers in China have
reached 10 million. Customers will use digital set-top box
to watch TV. VBI mode needs a teletext decoding module,
while the STB mode just processes teletext data through
set-top box, and then displays it on the OSD. It uses
software decoding to replace hardware decoding; it may
changes at any time according to the version of teletext
without changing hardware. So it has greater flexibility and
economizing effect. Here realization and improvement of
STB mode is introduced.

3 Organization of Teletext Data Elements
First introduce the data structure of teletext below.
Four teletext presentation Levels are defined[5]:
Level 1: Alpha mosaic characters, spacing attributes, fixed
color palette, 24 rows of 40 columns.
Level 1.5: Extends the character repertoire
Level 2.5: Extends the language repertoire, increases the
color palette with re-definable colors, introduces nonspacing attributes, allows a number of simple re-definable
characters, and provides side panels for additional text or
graphics.
Level 3.5: Extends the number of re-definable characters
and their complexity, introduces different font styles and
proportional spacing.

3.2 Elements of a Teletext Page
A page means one picture we see on TV. As shown in
figure 1, the body of a page normally consists of one or
more directly displayable packets in the range X/1 to X/24,
and optional extension or non-display packets in the range
X/25 to X/28. Packets containing no information do not
need to be transmitted. The transmission of a given page
begins with, and includes its page header packet. It is
terminated by and excludes the next page header packet
having the same magazine address in parallel transmission
mode, or any magazine address in serial transmission
mode. Displaying page numbers are from 100 to 899. Page
address number FF in any magazine may be used for time
filling and as a terminator. Latter eight bytes of a page
header packet may in addition be used to transmit time
related information. Extracting the real time clock data can
show local time. Enhanced teletext has non-displayable
packets that include re-definable characters or re-definable
palettes.

3.1 Elements of a Teletext Packet
Each teletext packet has 45 bytes. Bytes 1, 2 and 3,
the clock run-in and framing codes sequences, enable
packets to be identified and synchronization to be
established within the decoder. The packet address is
defined by bytes 4 and 5, comprising magazine and packet
number elements. Bytes 6 to 45 carry address, control code
and character data depending on the address of the packet.
There are three main types of teletext packet: page
header, normal packets intended for direct display and nondisplayable packets. Page header includes magazine
number, page number, subcode number, control code and
time information. Packets 1 to 24 are displayed directly on
OSD, which include magazine number and packet number
without page number. The last 40 bytes are used for
displaying. Packet 24 is used for navigational purposes,
which provides users with faster links. Packets 26, 28 and
29 are non-display packets for enhanced specification.
Packet 26 is used to address character locations within a
page and define new characters to be written to these
locations. Packet 28 specifies page’s function and coding.
Packet 29 has the same functions (apart from page function
and coding) as that defined for packets 28. Packet 27 and
24 combination can provide users with links to the relevant
pages.

Figure 1: The body of a page

3.3 Elements of a Teletext magazine
A magazine consists of one or more pages, numbered
from 0 to FF, which can display at most 100 pages,
normally transmitted repeatedly in numerical sequence.
The magazine may also contain data in packet 29. Packet
29 relates to all pages with magazine address, character set
designation, side-panels, CLUT, default row and screen
colors and so on. It is normally transmitted at least once in
each cycle of the magazine. As pages of teletext may not
be conveyed in the order of magazine number, the same
magazine pages can be buffered to meet the user’s habit.

3.4 Elements of Teletext Service
The service may contain teletext pages in one or more
magazines (the most eight), and/or service related data in
packets with X = 0 (8) and Y = 30, and/or other data in
packets with Y = 30 or Y = 31, as shown in figure 2. Any

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006

packets with Y = 30 or Y = 31 are not page- or magazinerelated. Magazines may be transmitted in numerical
sequence (serial magazines), or interleaved (parallel
magazines). It can be identified by control code. Since
charging of teletext service generally adopts the monthly
rent. Users who have registered can have teletext service.

mainly adopted to process the data extracted from PES by
PTI module. PTI will release a signal to notify
TTX_FilterMonitor
when
the
data
is
ready.
TTX_FilterMonitor saves the needed data in a buffer, and
divides the data into two streams at the same time; one
serves as VBI data that communicates with
VBIOutputTask by message, the other one is used as STB
data that will go into STBOutputTask. The VBIOutputTask
compatible with VBI teletext decode module. Decoding
using the hardware may enhance the speed, but the present
decoding card usually can only solve Level1.5 teletext
standard. The VBIOutputTask transmits an integrity page
of teletext data to DMA, then uses OSD decoding module
to display data on screen. The STBOutputTask caches
several pages data, and then uses the software decoding to
display teletext on television screen.

Figure 2: Elements of service

3.5 Byte Coding
The 8-bit bytes of data packets may be coded using one of
the four methods:
[1] 7 data bits plus one bit odd parity.
[2] 4 data bits plus 4 bits Hamming protection.
[3] 18 data bits plus 6 bits Hamming protection over 3
consecutive bytes.
[4] 8-bit data.

4

Displaying of Teletext

This project bases on embedded real time operating
system platform,[3] On the foundation of basic driver
module that ST company offers and the set-top box can
offer audio, video demodulation module and menu
function etc., we adopt the technology of the multi-layer
software and service-oriented mentality to design. And
divide the module according to different services,
guarantee comparative independence of every module, use
the unified interface among different modules. This project
is suitable for DVB-T, DVB-C and DVB-S. The software
code has very strong portability and flexibility.
Programming language is C language.

4.1 Data Communication between Tasks
Figure 3 is the flow chart of data communication
between tasks. Through PTI module’s analysis, descramble
and demultiplex,
MPEG2 stream
enters into
TTX_FilterMonitor task. TTX_FilterMonitor task is

Figure 3: The data communication of tasks

4.2 Flow Chart of Software
Figure 4 is the flow chart of software. Parse PMT
module completes the PMT establishment. The teletext
language may be determined by parsing PMT table’s
teletext descriptor. Teletext descriptor in PSI PMT is used
to mark a MPEG2 stream that carries EBU teletext data. It
is located in a program map section, after ES_info_length
field. This descriptor is as follows:[2]
teletext_descriptor(){
descriptor_tag
descriptor_length
for(i=0; i<N; i++){
ISO 639_language_code
teletext_type
teletext_magazine_number
teletext_page_number }}
ISO_639_language_code 24b field includes teletext
language in three character language codes. According to
ISO 8859_1 each character is coded in 8 bits, which are
inserted into 24 bits field in order. When the language is

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006

determined, the font’s position can be located to choose the
appropriate characters to display. The teletext decoding
module and the caching data module use signals to
synchronize the time delay between caching and
displaying.

Figure 4: Software architecture

4.3 Method of Quick Cache and Non-flicker
Display
The teletext data in MPEG2 stream can be transmitted
in serial mode or parallel mode. In the former, the data is
transmitted according to the order of page number within
single magazine, so user can switch pages faster. In the
latter mode, different pages of different magazines are
transmitted in overlapping way. In this way user can switch
magazines faster. Considering the memory size and the
user’s watching habit, the filtering algorithm of filtering
data within single magazine is adopted. Therefore the time
for users to wait for a new magazine is decided by the
teletext transmission cycle (2 ~ 4 seconds). Teletext data is
transmitted in serial mode usually, and some data packets
certainly are not the teletext data packets, so the pure
teletext data should be filtered in cache module in advance.
Once has completed one page, the filter task will inform
the display module to takes the data and release buffer
immediately, and perform decoding and displaying
operations. Caching, decoding and displaying are operated
at the same time to reach a high speed. The number of the
cached pages depends on the memory size. If the memory
is large enough, cache 100 pages one time, with about 1K
data in each page. The more pages are cached one time, the
faster user can switch pages.
According to the spacing attribute, every character
and mosaic has its background and foreground color. If the
characters are displayed one by one with background and
foreground color, the picture could not be displayed
fluently. So it is advised to display the whole background
color and then the whole foreground color within a page.
There may be some new real-time packets to update a
given page. If the whole page is updated at one time, the
OSD will have flicker. To avoid flicker, we can compare
each line, then just update the new packets.

5

Results and Performance

As mentioned above, the filter and the display time are
very important for weighting performance. Users are
hardly feeling the delay of time when they are watching the
identical number of pages. When switch the magazines, the
average of display time delay (including initialization and
decoding time) is about 3 seconds. As each set-top box is
independent of each other, the average data from ten settop boxes can be obtained. Table 1 compares the
advantages and disadvantages of STB mode and VBI
mode. It shows that STB mode can compatible with VBI
mode, decode digital TV signal and support more teletext
display levels. STB mode also has little delay time of
changing magazines.
Table 1: Support functions of
VBI mode and STB mode
Support function
VBI mode STB mode
Compatible with STB mode
No
Yes
Compatible with VBI mode
Yes
Yes
Need VBI hardware module
Yes
No
Need set-top box
No
Yes
The delay time of changing
<0.5s
<0.5s
pages with the same magazine
The delay time of changing
<5s
<3s
magazines
Level 1
Level 1
Level 1.5
Support ETS300706 level
Level 1.5
Level 2.5
Level 3.5
Besides the teletext mode, data can also be transmitted
in subtitle (ETS300743) or data broadcast (EN301192)
mode. The subtitle mode only applies in the current video's
subtitle, time requirement of which is very strict.[6] All pure
teletext data is start with 0x02 byte, while the tele-subtile
data starts with 0x03 byte. Tele-subtitle's function is
similar to subtitle, but its display mode is of more variety,
and the decoding method does not need duplicate
programmed. However the time request is quite strict and
the filter does not allow time delay. Data broadcast mode
uses OC data transmission recommended by DSMCC,
which may transmit HTML data, just like browse the web
pages. But the terminal set-top box needs to equip an
analyzing browser, and the frequency spot must be
monopolized. The filter of which is quite complex. A big
memory to store data is also needed. It requires long
filtering time. It takes 3 to 6 seconds to switch two levels
of webs. Compared with the data broadcast, teletext has the
advantages of direct-viewing, quick filtering, fewer data,
simpler decoding, diverse display mode and so on.

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006

The performances show that the design and
implementation of this system works well and can be
deployed in the real broadcast environment in the future.
Our work would be a valuable reference for companies and
practitioners.

system and economical development can develop more
interactive services. The teletext system is of promising
future.

6

[1] Kaixiong Su, Liting Guo, Digital Satellite TV Reception
Technique, People's posts and telecommunication publication,
2002, pp.52~58.
[2] TaoFang, Digital television service information and coding,
2003, pp.146
[3] Jean.J.Labrosse, MicroC/OS-II The Real-Time Kernel ˄
second version ˅ , Beijing aviation university publishing
company, 2003
[4] Chengyuan Peng and Petri Vuorimaa, Interactive Digital
Teletext Service, Proceedings of the 6th world Muticonference on
Systemics, July 14-18, 2002, pp181-186
[5] ETS 300 706: Enhanced Teletext specification, European
Telecommunications Standards Institute,
1997, pp.11-20.
[6] European Broadcasting Union,Digital
Video Broadcasting (DVB) Subtitling systems
ETS300743, European Broadcasting Union
1997.
[7] P.Weitzel,J.R.Hunter,Teletext-Old Digits In a New Age.
http://www.bbc.co.uk
[8] VBI Satellite TV Data Broadcast Principle of Introduction
http://www.qhrtvu.edu.cn/net/bulit-vbi.htm

Conclusions

This paper introduces the structure of teletext data. The
design of extracting teletext data from PES and decoding
data in the set-top-box are focused. The design allows
displaying teletext steadily on the OSD without VBI
module, and is compatible with VBI pattern. The result of
debugging shows that, consumers can select their favorite
pages, just like reading a book. The software is
programmed on the application programming interface
which independent of the hardware, it may be easily
revised and transplanted.
Using the teletext system we can effectively develop
more extra services, such as stock market, financial
information, electronic publication, long-distance teaching
and Internet broadcast service. Since the cable television
network frequency band is rich in resources with ensured
transmission quality, it has provided a solid foundation for
the teletext development. Transforming the current system
to interactive system with quick transmission speed, steady

References

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006


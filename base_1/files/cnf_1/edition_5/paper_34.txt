Spectra transformed for model-testing and visual exploration
Palmyra Catravas∗
ECE Department
Union College
Schenectady, NY

A BSTRACT
The presence of highly tangled patterns in spectra and other serial
data exacerbates the difficulty of performing visual comparison between a test model for a particular pattern and the data. The use of
a simple map that plants peaks in the data directly onto their corresponding position in a residual plot with respect to a chosen test
model not only retrieves the advantages of dynamic regression plotting, but in practical cases also causes patterns in the data to congregate in meaningful ways with respect to more than one reference
curve in the plane. The technique is demonstrated on a polyphonic
music signal.

reference line used. The vertical distance between peaks and several reference lines can be interpreted in a meaningful way. Computation of the residuals is bypassed, which avoids a number of a
priori assumptions that can potentially bias the result. These include assumptions made in performing the peak fit and assumptions required to associate a spectral peak with a particular index,
n. Finally, an additional dimension of information (the spectral
intensity) is included in the plots. In other related work, mappings of pitch onto cyclic curves, including the spiral, helix, and
taurus[13, 6], spiral maps of serial data[3, 15], and a pairing of sinusoidal and spiral maps[5] have been investigated.

Index Terms:
I.5.5 [Pattern recognition]: Implementation—
Interactive systems

3

1 I NTRODUCTION
Serial representation of data is not ideal for the visual identification
or separation of multiple, interwoven patterns. Even in the case of
a single pattern, small systematic deviations from a trial model for
the pattern become hard to judge from the stretched-out representation. Paradoxically, serial data sets often exhibit these problems
even when the underlying data contains elegant symmetry, a red flag
that the visualization technique may be unnecessarily encumbering
the processes of data exploration, hypothesis generation and analysis. Addressing this type of visualization bottleneck ameliorates
one’s ability to explore and present global trends in data, and to
avoid limiting the presentation to a small, localized window when
comparing data with model.
An intuitive, straightforward mapping for spectra is defined below that transforms the serial representation of the spectrum in such
a way that the advantages of the tried and true approaches for presenting visual comparison with a model, such as static and dynamic
regression plots, are recovered. The approach strives for consistency with Gestalt Laws of Perceptual Organization and utilizes the
Gestalt principles of proximity and apparent motion to reveal related groupings in the data. The technique can easily be applied to
other serial data sets (dependent on time, space, etc.) by treating
frequency, below, as a dummy variable.
2 R ELATED W ORK
The potential to introduce a dynamic variable into visualization as
a tool for exploring data through animation was recognized early,
during a time when such visualizations were heavily limited by
computing power [7]. The importance of motion in visualization
and the visual analysis of serial data continues in contemporary research [1, 3, 14, 15, 11, 12].Regression diagnostics incorporating
animation were a focus of the research performed by Fowlkes et
al., and Cook et al. [10, 2, 8]. The current method produces plots
that resemble residual plots for special cases, but departs from the
earlier work in a number of ways as a result of working with serial data. Unlike standard residual plots, the x-axis is not the only
∗ e-mail:

catravap@union.edu

IEEE Symposium on Visual Analytics Science and Technology 2007
October 30 - November 1, Sacramento, CA, USA
978-1-4244-1659-2/07/$25.00 ©2007 IEEE

3.1

M ETHOD
Mapping Definition

The transformation is straightforward to implement, and will be
given first for the special case of a harmonic series model and then
for other models. The following procedure compacts a spectrum
from its serial form to one in which a spectral peak sequence is
compared with a harmonic series model. The frequency axis, F, is
mapped onto a curve in the x − y plane in such a way that the target spectral peak sequence, the harmonic series, appears along the
x-axis. The set of parametric equations,
x=n

(1)

F
− n,
Ftest

y=

where n is an integer, sets consecutive harmonics of a test fundamental frequency, Ftest , along the x-axis. Restriction to the horizontal strip, −1/2 ≤ y < 1/2, avoids redundancy. This procedure
corresponds to slicing a spectrum into segments of length Ftest , normalizing each segment to a length of one, and centering the nth segment vertically about the horizontal axis at x = n. The value of a
function of frequency (such as Fourier transform amplitude, phase,
power spectral density, etc.) is assigned to the z-axis. Scanning Ftest
to produce an animated sequence of images is one way to introduce
motion into the technique.
When several harmonic series are simultaneously present in the
data, they spatially separate in the map, permitting visual identification. When the test fundamental, Ftest , differs from the fundamental, Fo , of a harmonic series in the data, the harmonics of Fo
lie along a line with slope that depends on Fo − Ftest . When Ftest is
scanned through Fo , the row of harmonic positions pivots about the
origin, falling along the x-axis when Ftest = Fo . Prior knowledge of
Fo is not needed. When Ftest is twice Fo , the odd and even harmonics separate spatially to the horizontal lines at y = 0 and y = −1/2,
respectively.
To extend the technique to other models for the target spectral
pattern, a user-defined sequence of peak positions, Fn , which can
depend on n, Ftest , ... and other parameters is mapped onto the xaxis using,
x=n
y=

(2)

F − Fn
.
Ftest

215

1 + n2 Btest ,

(3)

Here, motion is produced by scanning either the inharmonicity parameter, Btest or by scanning Ftest . More than one free scan parameter recovers the case of a partial regression plot.
4 EXAMPLE
When the spectrum of an excerpt of polyphonic music is displayed, the partials (overtones) related to each pitch appear in nonconsecutive order in the spectrum, making relationships between
partials difficult to judge, especially for high partial numbers. The
spectrum of the overtone cluster produced in the aftersound at the
end of the first phrase of the Copland Piano Variations (1932) is
analyzed here as the example. The signal, acquired from a Steinway concert grand, was of one second duration and was sampled
at 44.1 kHz. Note the difficulty of visually extracting the patterns
directly from the spectrum in serial form, shown in Fig. 1a. In
frames b) and c) of Fig. 1, snapshots extracted from a dynamic
scan, there is organized energy along the x-axis when Ftest = 65.4
Hz and Ftest = 138.6 Hz, indicating energy at the harmonics of both
fundamentals. In frame c), the odd and even partials related to the
lower pitch also appear in diagonal.
5 POTENTIAL AREAS OF APPLICATION
Visual pitch identification contrasts with numerical techniques used
for pitch identification in the detailed feedback rapidly provided
about trends of sub-groups of spectral peaks with respect to a
model. As a result, it has potential utility when paired with the
numerical techniques, especially if the latter overproject the data in
some way (providing a single number as an output, for example.)
Because harmonics appear in many contexts in nature, the example above extends to data from other disciplines. For example, intermodulation frequencies that appear in power engineering, such as
in cycloconverter spectra, sometimes interwave so strongly that the
highly symmetric characteristics of the underlying families of harmonics and sidebands that compose the spectrum disappear from
view. Such spectra under balanced and unbalanced conditions contain different distributions of odd and even harmonics, and a way
to graphically transform the spectra in order to distinguish between
the two cases at a glance would be useful. Additional audio applications are being developed [4]. The technique works well with
time-dependent or spatially dependent data. Spatial data set candidates include measurements of periodic nanoscale structures or
measurements of optical gratings, such as those with polynomial or
other custom-defined groove definitions.
6 CONCLUSION
A technique for comparing patterns in spectra with a target model
by spatially compacting the spectrum has been described. Motion
facilitates the identification of related sets of peaks in the plots. The
spectrum of a sample of polyphonic music was transformed from a
visually indigestible serial form to one which revealed information
about its spectral content. The technique is intended as an aid in the
process of data exploration and hypothesis generation, as a visual
complement to quantitative techniques.
R EFERENCES
[1] L. Bartram. Perceptual and interpretative properties of motion for information visualization. Proc. 1997 workshop on new paradigms in
information visualization and manipulation, pages 3–7, 1997.

216

power spectrum, dB

0

0

-20
-40
-60

-70

-80
0

500

b)

1000
1500
frequency, Hz

2500

c)

Ftest=138.6 Hz

Ftest=65.4 Hz
0.5

0.5

-0.5

2000

F / Ftest - n

Fn = nFtest

a)

F / Ftest - n

Motion may be produced by varying Ftest or any other parameter.
Nonuniform mappings in x and y, such as log-log and log-linear,
produce additional linear references for some models.
When the model is a harmonic series, Fn = nFtest , recovering
Eqn. 1. An example of an inharmonic model for Fn (often used in
the analysis of piano spectra) is [9]

-0.5
0

n

20

0

n

20

Figure 1: Visual polyphonic pitch identification. The spectrum of the
aftersound of a polyphonic overtone cluster, a), is analyzed for two
values of Ftest , and shows the the presence of overtones with fundamentals near b) 65.4 Hz and c) 138.6 Hz. In c) the odd and even
partials related to the fundamental at 65.4 Hz reappear, grouped
separately in space. Because the fundamentals are not related by
a factor of two, one set of partials systematically deviates from the
reference lines at y=0 and y=1/2 in c), while the other set agrees (for
low partial numbers only) with the target model along the x-axis. The
curvature is due to inharmonicity of the partials.

[2] R. Becker, W. Cleveland, and A. Wilks. Dynamic graphics for data
analysis. Statistical Science, 2:355–395, 1987.
[3] J. V. Carlis and J. A. Konstan. Interactive visualization of serial periodic data. In UIST ’98, pages 29–38, New York, 1998. ACM Press.
[4] P. Catravas. A graphical, motion-based method for exploring spectra
containing harmonics, sidebands and other patterns. 123rd Convention
of the Audio Engineering Society, submitted, 2007.
[5] P. Catravas. Tracking harmonics and artifacts in spectra using sinusoidal and spiral maps. 122nd Convention of the Audio Engineering
Society, preprint 7123, 2007.
[6] E. Chew and Y.-C. Chen. Real-time pitch spelling using the spiral
array. Computer Music Journal, 29(2):61–76, 2005.
[7] W. S. Cleveland and M. E. McGill, editors. Dynamic Graphics Statistics. Chapman and Hall, 1988.
[8] R. D. Cook, S. Weisberg, D. B. Carr, D. Pregibon, A. C. Atkinson,
L. Tierney, and R. E. Welsch. Regression diagnostics with dynamic
graphics. Technometrics, 31(3):277–291, 1989.
[9] N. H. Fletcher and T. D. Rossing. The Physics of Musical Instruments.
Springer-Verlag, New York, 1998.
[10] E. B. Fowlkes. User’s manual for an on-line interactive system for
probability plotting on the ddp-224 computer. Technical report, ATT
Bell Laboratories Technical Memorandum, Murray Hill, N. J., 1971.
[11] D. A. Keim. Information visualization and visual data mining. IEEE
Trans. on Vis. and Comp. Graph., 8(1):1–8, 2002.
[12] W. Muller and H. Schumann. Visualization method for timedependent data - an overview. Proceedings of the 2003 Winter Simulation Conference, pages 737–745, 2003.
[13] R. N. Shepard. Structural representations of musical pitch. In
D. Deutsch, editor, The Psychology of Music, pages 344–390. Academic Press, 1982.
[14] S. F. Silva and T. Catarci. Visualization of linear time-oriented data:
a survey. Proc. of the First Intl. Conf. on Web Information Systems
Engineering, 1:310–319, 2000.
[15] M. Weber, M. Alexa, and W. Muller. Visualizing time-series on spirals. Proc. IEEE Symposium on Info. Vis., pages 7–13, 2001.


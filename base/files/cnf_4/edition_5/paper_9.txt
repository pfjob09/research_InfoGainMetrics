Directed Graphs and Rectangular Layouts
(Extended abstract)
Adam L. Buchsbaum∗

Emden R. Gansner†

Suresh Venkatasubramanian‡

AT&T Labs - Research

A BSTRACT
RPremises

This paper deals with the problem, arising in practice, of drawing a
directed graph as a collection of disjoint, isothetic rectangles, where
the rectangles of the nodes of each edge must touch and where the
placement of the rectangles respects the ordering of the edges. It
provides characterizations for those graphs having the special type
of rectangular layout known as a rectangular dual. It then characterizes the st-graphs having rectangular layouts in terms of the
existence of certain planar embeddings and the non-existence of a
particular subgraph.
Keywords: rectangular dual, rectangular layout, contact graph
Index Terms: G.2.2 [Discrete Mathematics]: Graph Theory—
Graph Algorithms H.5.2 [Information Interfaces and Presentation]:
User Interface—GUI
1

I NTRODUCTION

We consider the problem of drawing a directed graph using disjoint, isothetic rectangles for the nodes, such that (u, v) is an edge
in the graph if the corresponding rectangles Ru and Rv touch, with
Ru above or to the left of Rv . Figure 1 provides an example, showing a directed tree drawn both using the traditional, straight-line
drawing and as a collection of rectangles.
The problem arises in the context of providing a graphical user
interface to a relational database support system which allows users
to model and administer their database. Users can specify their
own schemas using entity-relationship models [17]. It is assumed
that there are no cycles among the relationships in the schema.
The system then displays the database entities as rectangular buttons. Clicking on a button provides information related to the corresponding entity type, such as detailed descriptions of the entity
attributes or information about specific records. Experience indicates the benefit of juxtaposing buttons that correspond to related
entities. In addition, if the relationship is one-to-many, the button
corresponding to the “many” entity is positioned below or to the
right of the “one” entity, to emphasize this sense of directionality.
There are no additional constraints. In particular, even if two entities are not related, their rectangles may abut. Viewing the database
schema as the obvious directed tree, with entities as vertices and relations as edges, and allowing undirected cycles, leads to the graph
drawing problem stated above.
This problem generalizes the concept of rectangular layouts, in
which an undirected graph G is drawn using disjoint rectangles for
nodes, and two nodes are adjacent in G if and only if the two corresponding rectangles are adjacent. Without directionality, the problem has been well-studied (e.g., [5, 6, 10, 11, 12]). In particular,
there are effective characterizations for graphs having rectangular
∗ e-mail:

alb@research.att.com
erg@research.att.com
‡ e-mail: suresh@research.att.com

† e-mail:

Asia-Pacific Symposium on Visualisation 2007
5 - 7 February, Sydney, NSW, Australia
1-4244-0809-1/07/$20.00 © 2007 IEEE

Premise

RElement

Element

RCard

IOC

RPPort

Detail

Port

RLPort

LPort

Pvc

Gateway

Trunk

RPremises
RElement
Premise Element Detail
Gateway RCard
Port
IOC
Trunk
RPPort
LPort
RLPort
Pvc

Figure 1: Traditional drawing and rectangular layout of tree.

layouts, and some provable bounds on the size of the layouts. The
more restricted problem of rectangular duals [3, 9, 14, 7, 15, 16],
and related problems, such as proximity drawing [2, 8] and rectangle of influence drawings [13, 4], have an extensive literature.
In this paper, we explore what effect the directionality constraint
has. Specifically, we define a (strong) rectangular layout of a graph
G to be a set R of isothetic rectangles whose interiors are pairwise
disjoint, along with a one-to-one map R from the vertices of G into
R such that for any two vertices u, v, the boundaries of Ru = R(u)
and Rv = R(v) touch in more than one point with
R(u) above or to the left of R(v)

(1)

if and only if (u, v) is an edge in G. It is immediate that only acyclic
graphs can have a rectangular layout. Thus, we assume that any
graph is a directed acyclic graph (dag). In addition, we assume that
all graphs are directed and connected, with no loops or multiple
edges, and have at least 4 vertices.
A weak rectangular layout allows two rectangles to touch even
without an edge between the corresponding vertices. As the shearing argument given in Lemma 2.4 in Buchsbaum et al.[5] extends
to directed graphs, we can limit ourselves to strong layouts.
In Section 2, we consider the special case of directed rectangular
duals, where the rectangles in a rectangular layout form one large
rectangle. We give several characterizations for graphs having a
rectangular dual. Then, in Section 3, we show that, for st-graphs,
we have the same characterization as in the undirected case after
accounting for one forbidden subgraph.
2 D IRECTED RECTANGULAR DUALS
For the case of rectangular layouts of undirected graphs, it has been
useful (e.g., see [5, 6, 10, 11, 12]) to consider the case where the
rectangles form a partition of an enclosing rectangle. We take a
similar approach here. A rectangular dual of a graph G is a rectangular layout in which the union of the rectangles is a rectangle.
Let G be a planar st-graph1 with embedding E . Let br = (v0 =
s, v1 , ..., vn = t) be the right boundary path of E from s to t. Let
bl = (u0 = s, u1 , ..., um = t) be the left boundary path of E from s to
1 Concerning the definition and basic properties of st-graphs, see [1]. For
all embeddings of st-graphs, we assume that s is above t and all edges are
directed downward.

61

t. Any vertex not in br or bl is an interior vertex. Add four vertices
N, E, S, and W so that N is above and to the right of G, W is above
and to the left of G, S is below and to the left of G, and E is below
and to the right of G. We say the boundary of E is embeddable if
we can find 0 ≤ i ≤ n and 0 ≤ j ≤ m such that G extended with the
nodes N, E, S, and W and the edges (N, vk ), 0 ≤ k ≤ i, (vk , E), i ≤
k ≤ n, (W, uk ), 0 ≤ k ≤ j, and (uk , S), j ≤ k ≤ m, is planar, and all
of the vertices vk and uk have indegree and outdegree ≥ 2.
Figure 2 shows an embedded planar st-graph and an extension
exhibiting an embeddable boundary.
N
W

s
s

be the next outedge to the left. Since e is in T1 and e is not the
leftmost outedge of v, we must have that e is the rightmost inedge
of w. Since w has indegree at least 2, there must be another inedge
of w just to the left of e. This means that {v, u, w} forms a face and e
is the rightmost inedge of u, so that e is in T1 . This implies that any
outedge to the left of an outedge in T1 is also in T1 , and therefore all
T1 are to the left of all T2 outedges. A symmetric argument holds
for the inedges.
Figure 2(b) illustrates the edges belonging to the sets T1 and T2
as defined in the theorem.
Once the four vertices N, E, S,W are attached, the amount of
variation in constructing an REL is limited by the following theorem. We say an edge is a middle edge if it has the form shown by
the dotted edge in Figure 3.

t
E

t

(a)

Figure 3: Middle edge

S

(b)

Figure 2: (a) st-graph G (b) extended st-graph G with edge sets T1
(dotted) and T2

Theorem 1 A dag G has a directed rectangular dual if and only if
G is a planar st-graph with an embedding E such that:
1. all interior faces are triangles
2. all interior vertices have indegree and outdegree ≥ 2.
3. the boundary of E is embeddable.
Proof. For necessity, the first two conditions are obvious. As for
the third, if G has a rectangular dual, attaching 4 rectangles to the
sides of the layout shows that the boundary is embeddable.
Let G be G extended with the vertices N, E, S,W , the edges from
condition 3), and the edges (N, E) and (W, S). Note that for any
vertex v in G, its rightmost inedge and outedge form two edges of
a triangle in G . The similar property holds for the leftmost inedge
and outedge.
For sufficiency, we show how to construct a regular edge labeling
(REL) in the sense of He [6] on G . Given an REL, his construction
produces a rectangular dual for the underlying undirected graph of
G . It is simple to verify that the construction honors edge directions, thereby giving us a (directed) rectangular dual for G .
We now show how to construct the necessary REL. Recall that an
REL is a partition of the directed edges2 into 2 sets T1 and T2 such
that, for each vertex v, the edges adjacent to v consist of the inedges
of T1 , followed by the inedges of T2 , followed by the outedges of T1 ,
followed by the outedges of T2 , in the counterclockwise direction.
Each of the four subsets must be non-empty.
We define T1 to include the leftmost outedge and the rightmost
inedge of every vertex. Let T2 be the complement of T1 . To show
that the four subsets of edges around a vertex are non-empty, it suffices to show that the leftmost inedge and the rightmost outedge of
each vertex will be in T2 . Let e = (v, w) be the rightmost outedge
of v. Since v has outdegree at least 2, e cannot be the leftmost outedge. In addition, if (u, v) is the rightmost inedge of v, we must
have a face {u, v, w} with an edge (u, w), so e cannot be the rightmost inedge of w. Thus, e must be in T2 . The symmetric argument
holds for the leftmost inedge of v.
To see that the edges are appropriately ordered, let e = (v, w) be
an outedge of v in T1 . If e is not the leftmost outedge, let e = (v, u)
2 For

undirected graphs, constructing an REL requires that a direction be
assigned to each edge. Here we use the given direction.

62

Theorem 2 If G is a dag satisfying the three conditions of Theorem 1, then any edge e satisfies exactly one of the following:
1. e is the leftmost inedge and/or the rightmost outedge of a vertex
2. e is the leftmost outedge and/or the rightmost inedge of a vertex
3. e is a middle edge
Proof. We have already observed, as part of the proof of Theorem 1, that the first two sets are disjoint. To complete the proof,
we simply have to show that any edge not in one of the first two
sets must be a middle edge. This is almost immediate. If e = (u, v)
is not the rightmost outedge of u nor the rightmost inedge of v,
the face to the right of e must be composed of the three edges
(u, v), (u, w), (w, v) for some vertex w. Since the same must be true
for the face to the left of e, we see that e is a middle edge.
Theorem 2 shows that the only choices in constructing an REL,
once the graph is embedded, concern where to put the middle edges.
It is a simple observation that any middle edge can be in either T1 or
T2 , so the number of distinct directed rectangular duals is 2m , where
m is the number of middle edges.
There is a simple sufficient condition for property 3) in Theorem 1, namely, that, on the right and left boundaries of E , no vertex
with indegree 1 appears after any vertex with outdegree 1. Consider the right boundary br = (v0 = s, v1 , ..., vn = t) of E . Let k be
the largest index so that vk has indegree < 2. Let l be the smallest
index so that vl has outdegree < 2. Let i be any value k ≤ i ≤ l,
and add the edges (N, v j ), 0 ≤ j ≤ i and (v j , E), i ≤ j ≤ n. By hypothesis, the extended graph is planar. Each v j in G has indegree
and outdegree at least 1. If it has indegree 1, the edge (N, v j ) was
added, so it has indegree 2 in the extended graph. The analogous
results hold for the outdegrees in br , and for the left boundary of E .
This condition characterizes the biconnected graphs with directed rectangular duals. (We consider a dag biconnected or not
according to that property holding in the underlying undirected
graph.)
Theorem 3 A biconnected dag G has a directed rectangular dual
if and only if G is a planar st-graph with an embedding E such that:
1. all interior faces are triangles
2. all interior vertices have indegree and outdegree ≥ 2.

a

3. on the right and left boundaries of E , no vertex with indegree
1 appears after any vertices with outdegree 1.

b
e

u

Proof. We have already noted how the three properties, along with
Theorem 1, imply the existence of a directed rectangular dual. Conversely, if G has a directed rectangular dual, any vertex v on b r with
indegree 1 must correspond to a rectangle on the top boundary. Any
vertex u on br appearing before v is therefore also on the top boundary with a rectangle to its right. If u has outdegree 1, then its rectangle and the rectangle to its right both must also lie along the bottom
boundary, which would correspond to a cut edge in the graph, contrary to G being biconnected. This shows it has outdegree ≥ 2.
It is simple to apply this result to the cases where condition 3) is
trivially satisfied.
Corollary 1 A biconnected dag G has a directed rectangular dual
with a single rectangle on both the right and left sides if and only
if it satisfies properties 1) and 2) of Theorem 3 and all vertices of
one boundary path have outdegree ≥ 2, and all vertices of the other
boundary path have indegree ≥ 2.
Analogous results hold when the degree constraints are only applied to one side.
Theorem 3 clearly fails for non-biconnected graphs. A chain has
a rectangular dual but condition 3) does not hold. The next theorem,
however, allows us to apply the theorem to the block decomposition
of non-biconnected graph.
Theorem 4 A dag G has a rectangular dual if and only if
1. its block tree is a chain
2. each interior block has a directed rectangular dual with a single rectangle on both the left and right sides
3. both the first and last blocks have rectangular duals, with a
single rectangle on the right or left side, respectively.
Proof. Given the 3 conditions, joining the rectangular duals in
the order specified by the block tree chain, abutting or identifying
the side rectangles as necessary, gives a dual for the whole graph.
On the other hand, if G has a rectangular dual, any rectangle R v
corresponding to a cut point v must be as wide or as high as the
whole rectangle. By a 90◦ rotation, we can assume it is as high. By
dividing the rectangular dual at Rv , splitting Rv into 2 rectangles if
both its indegree and outdegree are greater than 1, we end up with
rectangular duals for 2 proper subgraphs of G, and can complete
the proof by induction using Theorem 3 for the base case.
3 ST-G RAPHS WITH RECTANGULAR LAYOUTS
As with the undirected case, any graph with a (directed) rectangular layout is a subgraph of some graph with a (directed) rectangular
dual. Thus, the results from Section 2 can help us characterize certain classes of graphs with rectangular layouts.
We start with some definitions and lemmas. We let F denote the
graph shown in Figure 4(a). From the next lemma, we also refer to
F as forbidden.
Lemma 1 Let G be a biconnected planar st-graph with an embedding such that all interior faces are triangles. The condition that
all interior vertices have indegree and outdegree ≥ 2 is equivalent
to G not containing an induced subgraph isomorphic to F .
Proof. If G has F as a subgraph, we can assume, by symmetry,
that its embedding is as shown in Figure 4(a). Consider the set
formed by u and all vertices within the quadrilateral, and pick one
w with the minimum y coordinate. Then the only possible outedge
is (w, v), and w has outdegree 1.

c

v

(a)

d

(b)

(c)

Figure 4: (a) The forbidden graph F . (b) Quadrilateral face (c) Triangulation of a quadrilateral face

To show the opposite direction, we can assume, without loss of
generality, that G has a vertex u with outdegree 1. Let (u, v) be the
unique outedge. The two triangular faces common to (u, v) must
have the form (w, u), (w, v), (u, v) and (z, u), (z, v), (u, v). Therefore,
G has the subgraph (w, u), (w, v), (z, u), (z, v) isomorphic to F .
For a planar embedding of a graph, a filled triangle is defined to
be a length-3 cycle with at least one vertex inside the induced region. Note that, for rectangular duals, the role of a filled triangle is
usually played by a separating triangle, a length-3 cycle whose removal separates the graph into two non-trivial components. For the
more general problem of rectangular layouts, these two concepts
are not equivalent. A planar embedding of a graph might have a
filled triangle but no separating triangle (e.g., K4 ), and vice versa.
Lemma 2 Let E be an embedding of a planar st-graph G. If E has
a filled triangle, G has an interior vertex with outdegree or indegree
1.
Proof. Consider a filled triangle with edges (v, u), (v, w) and (u, w).
If there is any vertex inside the triangle whose y coordinate is the
same or less than that of u, pick the one x with the smallest y coordinate. Then the only possible outedge of x is (x, w) and x has
outdegree 1. A symmetric argument holds if any vertex inside the
triangle has y coordinate the same or more than that of u.
We can now characterize planar st-graphs having a rectangular
layout.
Theorem 5 Let G be a planar st-graph. G has a rectangular layout if and only if G has no subgraph isomorphic to F and has an
embedding with no filled triangles.
Proof. F has no rectangular layout, so it cannot be a subgraph of
any graph having one. In addition, if G has a rectangular layout,
it is a subgraph of a graph H with a rectangular dual. By Theorem 1, H has an embedding with all interior faces triangles and all
interior vertices having outdegree and indegree greater than 1. By
Lemma 2, the embedding for H, and hence G, has no filled triangle.
To show the converse, first assume that G is biconnected and let
E be an embedding of G. For each non-triangular face F, let n
be the length of the longest boundary path (i.e., the path has n + 1
vertices). If n = 2, then F must look like Figure 4(b). Add a single vertex and four edges to form the graph in Figure 4(c). The
added edges are dotted. To maintain a valid planar embedding of
an st-graph, we need to vertically shift down node c and all nodes
reachable from it by a directed path by a uniform amount, as indicated in the figure.
If n > 2, insert n − 2 vertices to form a path in the interior from
the top vertex of F to the bottom. Alternately connect the vertices
along the longest boundary path to the inserted vertices as indicated
in Figure 5(a). The added edges are dotted. Similarly triangulate the
shorter side, connecting the highest boundary path node to all of the
remaining added vertices. None of these operations can introduce a
filled triangle, a cut vertex, or a subgraph isomorphic to F .
After processing all non-triangular faces, the resulting graph is
still biconnected and acyclic, with a planar embedding with all interior faces triangular. In addition, there is no subgraph isomorphic

63

s
v

w
t
(a)

(b)

Figure 5: (a) Triangulation of a non-quadrilateral face (b) Triangulating a boundary path

to F . Thus, by Lemma 1, every interior vertex has indegree and
outdegree at least 2.
To be able to invoke Theorem 3, we need to make sure the graph
satisfies property 3. For a given boundary path, if there is any node
of indegree 1 appearing after a node of outdegree 1, let n be the
number of vertices on the boundary path from s to t. If n < 4 and
property 3 is not satisfied, it is easy to see that the graph is not
biconnected. We therefore assume n ≥ 4. Let the vertices on the
boundary path be s, v, . . . , w,t. Add n − 3 new vertices on a path
from v to w. Then triangulate the face as indicated in Figure 5(b)
for the case n = 6. As usual, the added edges are dotted. This
process eliminates any vertices of outdegree 1 before a vertex of
indegree 1, and maintains the hypotheses of the theorem.
We now can apply Theorem 3 to get a rectangular dual for the
extended graph. Removing the rectangles corresponding to added
vertices gives a rectangular layout for G.
Finally, if G is not biconnected, we can use induction, with the
base case of a biconnected graph dealt with above. Pick a cut vertex
v in G. Possibly replicating v if both its indegree and outdegree
are greater than 1, we can split G at v into two smaller st-graphs,
each satisfying the hypotheses of the theorem. By induction, we get
rectangular layouts for each. Necessarily, in any rectangular layout
of an st-graph, the source and sink nodes correspond to the upper
left and lower right rectangles, respectively. As in Theorem 4, we
can join the layouts together, identifying rectangles if necessary for
replicated nodes, to obtain a rectangular layout for G.
Except for the forbidden subgraph, Theorem 5 is identical to
Corollary 3.5 in Buchsbaum et al.[5]. Note that if all face boundary
paths have length at least 2, there can be no filled triangles. The example of Figure 6(a) shows how the triangulation used in the proof
a
b

e
c
d

(a)

(b)

(c)

Figure 6: (a) Filled triangle yielding F (b) All embeddings with filled
triangle (c) Subgraph F but no filled triangle

of the theorem fails in the case of filled triangles. The graph is
the same as that of Figure 4(c) but we assume it also has an edge
(a, d), giving the filled triangle (a, d), (a, c), (c, d). When the auxiliary node (e) and (dotted) edges are added, we have a forbidden
subgraph (a, d), (e, d), (a, c), (e, c).
Both conditions of the theorem are necessary in order to have a
rectangular layout. Figure 6(b) shows an example of an st-graph
with no forbidden subgraph all of whose embeddings have a filled
triangle. Figure 6(c) shows an example of an st-graph with a forbidden subgraph but no filled triangle. Of course, neither has a
rectangular layout.

64

4 S UMMARY AND FUTURE WORK
In this paper, we considered the extension of the problem of rectangular layouts to directed graphs. We presented characterizations
for which graphs have rectangular duals, and which st-graphs admit
rectangular layouts.
As for future work, we believe Theorem 5 can be extended to
general dags by requiring the embedding to be upward planar. Also,
in analogy with the undirected case, there are many avenues open
for further research. In particular, given the original motivation
for the problem, it would be nice to have a layout algorithm with
provably tractable running time and provable area or width bounds,
similar to the results presented by Buchsbaum et al.[5] for the undirected problem.
ACKNOWLEDGEMENTS
The authors wish to thank the referees for their helpful comments.
R EFERENCES
[1] G. D. Battista, P. Eades, R. Tamassia, and I. Tollis. Graph Drawing: Algorithms for the Visualization of Graphs. Prentice-Hall, Upper
Saddle River, NJ, 1999.
[2] G. D. Battista, W. Lenhart, and G. Liotta. Proximity drawability:
A survey. In Proc. Graph Drawing, DIMACS Int’l. Wks. (GD’94),
volume 894 of Lecture Notes in Computer Science, pages 328–39.
Springer-Verlag, 1994.
[3] J. Bhasker and S. Sahni. A linear algorithm to find a rectangular dual
of a planar triangulated graph. Algorithmica, 3:247–78, 1988.
[4] T. Biedl, A. Bretscher, and H. Meijer. Rectangle of influence drawings
of graphs without filled 3-cycles. In Proc. 7th Int’l. Symp. on Graph
Drawing ’99, volume 1731 of Lecture Notes in Computer Science,
pages 359–68. Springer-Verlag, 1999.
[5] A. L. Buchsbaum, E. R. Gansner, C. M. Procopiuc, and S. Venkatasubramanian. Rectangular layouts and contact graphs. Technical
Report TD-59JQX5, AT&T Labs – Research, 2005.
http:
//www.research.att.com/areas/visualization/
papers videos/pdf/BuchsbaumGPV06.pdf.
[6] X. He. On finding the rectangular duals of planar triangular graphs.
SIAM Journal on Computing, 22(6):1218–26, 1993.
[7] X. He. A simple linear time algorithm for proper box rectangular
drawings of plane graphs. Journal of Algorithms, 40(1):82–101, 2001.
[8] J. W. Jaromczyk and G. T. Toussaint. Relative neighborhood graphs
and their relatives. Proceedings of the IEEE, 80:1502–17, 1992.
[9] G. Kant and X. He. Regular edge labeling of 4-connected plane graphs
and its applications in graph drawing problems. Theoretical Computer
Science, 172:175–93, 1997.
[10] K. Ko´zmi´nski and W. Kinnen. Rectangular duals of planar graphs.
Networks, 15:145–57, 1985.
[11] K. Ko´zmi´nski and W. Kinnen. Rectangular dualization and rectangular dissections. IEEE Transactions on Circuits and Systems,
35(11):1401–16, 1988.
[12] Y.-T. Lai and S. M. Leinwand. A theory of rectangular dual graphs.
Algorithmica, 5:467–83, 1990.
[13] G. Liotta, A. Lubiw, H. Meijer, and S. H. Whitesides. The rectangle
of influence drawability problem. Computational Geometry: Theory
and Applications, 10:1–22, 1998.
[14] T. Matsumoto, K. Mizunoand, and T. Watanabe. Drawing a rectangular dual to meet prescribed constraints. In Proc. IEEE Int’l. Symp. on
Circuits and Systems, volume 3, pages 1772–1775, 1997.
[15] M. S. Rahman, T. Nishizeki, and S. Ghosh. Rectangular drawings
of planar graphs. In Proc. 10th Int’l. Symp. on Graph Drawing ’02,
volume 2528 of Lecture Notes in Computer Science, pages 244–55.
Springer-Verlag, 2002.
[16] M. S. Rahman, T. Nishizeki, and S. Ghosh. Rectangular drawings of
planar graphs. Journal of Algorithms, 50(1):62–78, 2004.
[17] R. Ramakrishnan and J. Gehrke. Database Management Systems.
McGraw-Hill, Boston, MA, 2000.


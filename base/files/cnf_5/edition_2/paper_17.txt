2009 Sixth International Conference on Computer Graphics, Imaging and Visualization

The hierarchical perception model for crowd simulation
Sun Libo, Liu Yan, Sun Jizhou, Lu Wenyu
School of Computer Science and Technology, Tianjin University, Tianjin 300072, China
{slb1210@yahoo.com.cn, daisy_liu@tju.edu.cn, jzsun@tju.edu.cn, fatcatlwy@gmail.com}
Abstract

combine it to the environment[1][2], that is, the
individual knows how to get to the certain goal as he
walks, or shoot the rays to gain the intersection with the
static and mobile objects to decide where to go next[3].
However, relatively little effort has been placed upon the
changes of the perception as the density of the crowd
increases.
In this paper, we present a hierarchy perception
model to describe the differences between the perception
of the agent in different density. It includes low density
and high density perception module. Although the
components of them are same, the control methods are
distinct, that is, the parameters of the perceptual filters,
the frequency of the update of the contents in the shortterm and long-term memory are dealt with differently.
As a result, our model provides realistic crowd
perception as well as authentic environment information
for each individual among the crowd to make appropriate
decisions.
This paper is organized as follows: in the next
section, we briefly review related works. Section 3
focuses on the details of our hierarchy perception model
for the crowd. In section 4 we describe our results. We
discuss our conclusions in section 5.

This paper proposes a hierarchical perception
model for simulation of crowd perception in different
density. In this model, there are two tiers: the low density
and high density perception modules. They are both
composed of perceptual filters, short-term and long-term
memory. However, considering the changes of the
perception as the density increases, we adopt different
methods to model them. We also take into account the
impact of the human subjective factors on the selection of
the object the virtual agent focuses. Our hierarchical
perception model can well reflect the characteristics of
the human perception; moreover, it can provide more
plausible information for the virtual human among the
crowd to respond properly to certain event.
Keywords--- hierarchical perception model; crowd
density; perceptual filter; short-term memory; long-term
memory; crowd simulation

1. Introduction
The crowd simulation has attracted much attention
in recent years due to its remarkable applications in
entertainment industry, urban engineering, architecture,
training, education and virtual heritage. Real-time crowd
simulation is difficult because it should guarantee the
realistic behaviors of animated virtual crowd as well as
producing the convincing visual effect. The researchers
almost focus on one aspect of the two or search for the
balance between them. But anyway, perception,
planning, behavior and how to integrate them are very
important factors that should be taken into account.
Perception is the premise to understand the
surrounding environment and respond appropriately for
each autonomous virtual human among the crowd. To
reflect the characteristic of the human perception
accurately is crucial to the realism of the various and
complex crowd behaviors. By now, much work has been
done to realize the navigational behaviors, synthesize the
crowd motion and simulate the psychology, the emotion
and the cognitive ability of the individual of the crowd.
To the perception of the crowd, most researchers either
978-0-7695-3789-4/09 $25.00 © 2009 IEEE
DOI 10.1109/CGIV.2009.43

2. Related works
In general, there are two main approaches to
simulate the crowd. One is microscopic, which focuses
on the behavior of the individuals; the other one is
macroscopic, which is to view the crowd as a whole. The
former is concerned with the realism of the behavior of
each individual, thus the perception, the memory, the
planning, the psychology and the emotion of every agent
are taken into account so that each agent could react
differently to the same event. The latter aims at
achieving real time simulation for very large crowds,
thus the behavior of each individual is not important as
long as the overall crowd movement looks realistic.
The perception information which most researchers
are concerned with includes the vision, the audition, the
touch and the memory. The ergonomics studies show
that more than 80 percent of the information sensed by
humans is provided by the visual organ, so the vision is
mostly studied and simulated by the researchers. There
106

are four categories of methods: synthetic vision[4],
which is a process that relies on the rendering of the
scene surrounding an agent and then extracts the
information from the vision image, such as the color and
so on; Database access[5], which interrogates a database
containing a description of all the objects in the
environment and extracts the position of objects that are
within the field of view for the character; Geometric
vision[6], which maintains a set of perception pipelines
for each agent and a pipeline is composed of filters that
coordinate themselves in order to extract relevant
information from the data sent by the associated sensor;
The last one integrates the former three methods to gain
the balance between the computation accuracy, the
efficiency and the realism[7]. D.Thanlmann[4] also
simulated the audition through modeling a 3D acoustic
environment and gaining the position and semantic
information about the sound events. Takeshi[8] proposed
a psychological perception model for simulating
pedestrian behaviors in a crowded space. It was
composed of visual memory and sensor. The memory
stored the position and the speed of the other agents and
the visual sensor obtained the environmental information
on a semicircular front region of the agent. Wee Lit
Koh[3] established a basic sensory module and a shortterm memory module to support realistic navigation. He
also thought it was necessary to model human attention
and proposed that each agent should have a specific
number of attention points depending on the agent’s
roles and actions.

Fig1. The structure of the perception model for
crowds

3.1. The low density level perception module
The perceptual filters
¾ Visual filter
Through the relative positions between the eye of
the human and each object, the visual filter determines
which object can be seen by the agent. The process is
done as follows: firstly we decide whether the objects are
in the visual range of the agent, then judge whether
certain object is sheltered by the other large ones through
the classical visibility computation method. Figure 2
shows the basic field of vision for human beings. It is a
limited sector region in horizontal direction. Taking the
focus direction F as the symmetry axis, the size of the
region is determined by four parameters, namely, the
best line-of-sight Rv1 , the largest line-of-sight Rv 2 , the
best viewing angle ϕv1 and the largest viewing angle ϕv 2 .
Generally, the focus direction is the direction the agent
faces, but when a particular object is focused by the
agent, it becomes the direction of the line which connects
the head and the center of the particular object.
According to the statistical data in ergonomics, the value
of the angle is ϕv1 ≈ 60° , ϕv 2 ≈ 110° . The largest line-ofsight Rv 2 is decided by the size of the object projected in
the human eye. The visual range can be represented as:

3. Hierarchical Perception Model for Crowd
The perception model we propose consists of two
tiers: a low density level and a high density level
perception module. They are both responsible for
providing the exact information about the environment.
The difference is that when the density increases, the
neighboring agents will impose more mental stress on
each other so that the visual and audile range will
decrease to some extent and the contents of the shortterm memory will change quickly while that of the longterm memory won’t update any longer. The goal is to
provide the more realistic information for the crowd to
react reasonably to certain event.
As shown in Figure 1, the perception module, both
the low density and high density level, includes the
perception filters, the short-term memory and the longterm memory. The perception filters—the visual, the
audile and the tactile filter—remove the information
beyond the scope that can be sensed by the sensory
organs and provide the real environment information of
the static obstacles and the moving agents and objects.
The sensed information is stored in the short-term
memory if the number of being perceived is less than
three times. But if the static obstacles or the agents who
are relatively static to the observer are sensed by three or
more, they are put in the long-term memory.

Rv 2
R
= kV , v 2 = kV 12
D
Rv1

(1)

kV is the unit of the line-of-sight and means the ratio
between the largest line-of-sight and the size of the
object. It can be used to weigh the visual ability. kV 12 is
the ratio between the largest line-of-sight and the best
line-of-sight.

Fig2. The range of the vision
Audile filter and Tactile filter
The hearing and the feeling are not restricted by the
direction the agent faces, so we can integrate the audile
and tactile sensor with the visual sensor to expand the

¾

107

2) The deviation from the current focus direction
of the agent. The more deviated the objects from the
focus direction, the lower the focus factor is.
3) The speed of the object. The impact of the
speed on the focus factor is a little complicated. Both too
fast and too slow objects reduce the attention of the
virtual agent. We consider the best perception speed V0 is
the speed which the virtual human is most interested in.
In other words, humans are more concerned with the
objects which have the salient features and distinguish
themselves from the other objects.
In short, to one agent, the subjective factors are
invariant and the objective factors determine the object
the agent focuses; but to the crowd, it is the subjective
and objective factors that influence the focus of each
agent together so that each individual can react different
to the same event. That is to say, it is more likely for the
observer to focus on certain object if he is a more
extraverted, less neurotic man with the age closer to the
critical age and meanwhile that object is nearer away
from the observer, less deviated from the focus direction
of the observer and its speed is closer to V0 .
Based on above considerations, we give the value of
the focus factor of the object or agent A in following
formulas:

perceptual range of the virtual agent. The perceived
range is the main parameter for the audile and tactile
filters. In comparison with the visual range, the audile
range is smaller and the tactile perception is constrained
in the scope of the objects that are in contact with the
agent. The audible range is a sphere region with the
radius Rh and the tactile range is also a sphere region
with the radius R f which is determined by the size of the
virtual agent and the object.
By combining three perceptual filters, we establish a
general perception region for the virtual agent, as shown
in Figure 3. It is noteworthy that the perception region is
not static and is decided by different control parameters.
As the environment and the objects vary, the control
parameters are changing correspondingly, resulting in the
dynamic change in the general perception region.

Fig3. The region of general perception for virtual
agent
¾ Focus factor
We have analyzed the perception characteristics for
human beings and find that there are several subjective
factors of the observer which play an important role in
the determination of the objects they are interested in:
1) Gender. The males are more concerned with
moving objects and are more competitive, aggressive and
dominant while the females prefer to communicate with
others.
2) Age. Obviously, children like walking randomly
and less care about the vehicles and other persons.
Adults have more awareness about safety.
3) Personality. The Five Factor Model [9] is the
most popular computational model which defines the
following dimensions: Openness refers to how willing
people are to make adjustments in notions and activities
in accordance with new ideas or situations.
Conscientiousness means how organized and persistent
in achieving goals. Extraversion is defined as a trait
characterized by a keen interest in other people and
external events. Agreeableness concerns with
cooperation and social harmony. Neuroticism refers to
the tendency to experience negative emotions. Extroverts
enjoy being with people and often experience positive
emotions. People high in Neuroticism respond
emotionally to events that would not affect most other
people.
In addition, there are several objective factors of the
perceived objects which influence the focus of an
observer. They are:
1) The distance. The nearer the object is away
from the observer, the more likely it will attract attention.

fA = a

OAi F
OA i F

+

b
OA

+

c
− d ( y − ycrit )2 + e(E − N ) + fQ (2)
Va − V0

⎧1, sex = male and A = object or sex = female and A = agent
Q=⎨
⎩0, otherwise

(3)

OA is the vector from the observer to the object or

agent A; F is the focus direction; Va is the speed of the
object or agent A; y is the age of the observer and ycrit is
the critical age; E and N indicate the Extraversion and
Neuroticism of the personality of the observer separately
and their values are between 0 and 1. Q indicates the
impact of the gender and its mathematical description is
given in formula 3. a, b, c, d , e, f are the scale factor of
each item, representing the weight of every factor. Their
values are set empirically within the range of [1, 100].
Moreover, their differences are not significant unless we
want to emphasize the influence of certain factor.
The memory model
The memory model is responsible for storing and
recording the perceived information and it provides the
basis for the virtual agent to respond naturally to the
environment. For example, when the virtual human first
enters an unknown environment, he doesn’t know how to
get to the assigned place and it is normal that he will try
several times before he achieves it. But if he is already
very familiar with the surroundings, it is unreasonable
that he still searches a place many times which results
from no memory.
¾ The short-term memory
According to the results of a psychological
experiment, the capacity of short-term memory is fixed
to 7, that is, an agent can memorize the positions and
speeds of 7 other agents at most. At the same time, the

108

agent will forget some information as the time passes.
The object, which is recorded earlier and isn’t updated
all the time, is easier to be forgotten. Therefore, we adopt
the fixed-size queue to store the relevant information to
well simulate the human short-term memory. After the
object in the world model is filtered by the perceptual
filters and considered as the perceived one, the shortterm memory generates the corresponding perceptual
information according to the filtering process and stores
it in the queue effectively. Each item of information can
be expressed in the form of six-tuple:

low density level perception module, we just describe the
differences between them in this section.
The perceptual filters
As the density of the crowd increases, the visual and
audile range of the virtual agent must be affected and
decreased to some extent. That is to say, the two
parameters for the visual filter, the best line-ofsight Rv1 and the largest line-of-sight Rv 2 , and the main
parameters for the audile filter, the radius Rh will be
reduced due to high density. We use Rv1' , Rv 2' and Rh ' to
represent the corresponding parameters of the visual and
audile filters in high density. Their values are determined
by the following formulas in which ρ is the density of
the crowd and ρcrit is the critical density of the crowd.

perception = ID, object , sensor , focus, time, frequency

ID is the storage sign of the perceptual information
in the short-term memory and it is unique. object is the
identification number of the perceived object in the
world model and we can get the specific information of
the object through it. sensor ∈ {vision, hearing , feeling}

⎧ Rv1' = kRv1 , Rv 2' = kRv 2
⎪⎪ '
⎨ Rh = kRh
⎪k = exp(- ρ / ρ )
crit
⎪⎩

indicates the perceptual filter which senses the
object. focus represents the focus factor of the object and
the object with largest focus in the memory model
determines the focus direction of the agent. time records
the perceived time of the object for the last time.
frequency expresses the sensed times of the object.
When the queue is full, we check whether the
perceived object is already in the short-term memory. If
it is, we will change the time to the current time and
increase the frequency by one. Otherwise we compare
the time of each object or agent with current time to
calculate their difference, and then we determine which
is more than the assigned value and replace it with the
current item; but if each one doesn’t exceed the assigned
value, we compute the focus of each item of information
and make the current one to substitute for the item with
the smallest focus . As a result, the forgotten
characteristic of humans is well simulated.
¾ The long-term memory
When the frequency of the item of the information
for certain object or agent exceeds three and the object is
static or the agent is relative static to the observer, we
remove the item from the short-term memory and add it
to the long-term memory. The capacity of the long-term
memory is infinite according to the statistical data of
humans. Therefore, the size of the queue to store the
information in long-term memory is not fixed. Generally,
the information of the environment is saved in the longterm memory since the obstacles around the agent are
almost static. As the agent knows more about the
environment, he remembers the information of the scene
which is important to him continuously. In that case, he
possesses the ability to self-learn about the environment,
which is very significant to select the proper behaviors
for virtual humans.

(4)

The memory model
¾ The short-term memory
The focus factor is also influenced by the increase of
the density of the crowd. When the information of the
surrounding objects and agents increases rapidly, maybe
the agent doesn’t know which one he should care about.
Therefore, the impact of the focus factor on how the item
of the information in the short-term memory is replaced
is not so significant. We just consider the time as the
unique basis for substitution. Moreover, the frequency of
the replacement of the information becomes higher
because the number of the perceived objects is large.
¾ The long-term memory
It is difficult for the frequency in the short-term
memory to reach 3 due to the rapid increase of the
information. Thus when the density of crowd is high, it is
impossible to shift the information in the short-term
memory to that in the long-term memory. In other words,
there is no addition of the item of information in the
long-term memory generally.

4. Results
In this paper, we validate the proposed hierarchical
perception model through a series of experiments. Figure
4 shows the effect of general perception for the virtual
agent in static 3D environment. The cones and the balls
represent the perceptual objects in the scene. The colors
of the objects indicate the perceived state. Object 1 and
others, shown as red, are in the best visual area in front
of the virtual agent. The yellow represents the object that
is in the largest visual area of the agent and the white
indicates the object that can’t be perceived by the agent.
Comparing with object 3, object 2 is closer to the agent,
but because the volume of object 3 is much larger than
that of object 2, object 3 is in the largest visual area
while object 2 can’t be sensed. Similarly, object 4 is in
the best visual area of the agent. Object 5 is sheltered by
object 6, so it is out of vision. Object 7 is behind the
agent and can’t be perceived by the visual sensor.

3.2. The high density level perception module
Because the components in the high density level
perception module are almost the same with those in the

109

However, it is in the tactile range and is shown as blue.
Object 8 and 9, shown as green, indicate that they are in
the audile range. Object 10 is out the range of all
perceptual sensors, so it can’t be perceived.

¾

Density-based perception can imitate the
characteristics and differences of perception in
different situations.
¾ The capacity restriction on the short-term memory
can provide more plausible effect well fitted in with
human memory characteristics as the crowd density
increases.
¾ The addition of the information about the static
obstacles or relative static agents to the observer
perceived often to the long-term memory can reflect
the cognitive ability of the humans to the
environment.
¾ The consideration of the impact of the human
subjective and objective factors on the focus factor
can well simulate the selection of the objects the
humans are interested in.
Our future work includes a development of a more
human-like behavior control model and integrating the
hierarchical perception model to it. It is hoped that the
behavior control model can display more plausible
behaviors of the crowd with the accurate information
provided by the perception model.

Figure4. The general perception of the agent in
static environment
Figure 5 shows the impact of the short-term memory
on the perceived result. In figure 5a, agent 5 is perceived
by agent 1 and shown as green, so the information of
agent 5 is put in the short-term memory. In figure 5b,
agent 5 is out of the vision of agent 1, but the short-term
memory of agent 1 still stores relevant information of
agent 5, so agent 1 considers it as a perceived agent. In
figure 5c, since agent 1 can’t get new information of
agent 5 for a long time, agent 1 forgets agent 5 which is
shown as white.
In figure 6a, obstacle 1 is sensed by agent 1, and as
agent 1 walks, he continually gets the information of
obstacle 1 shown in figure 6b. In figure 6c, when the
times obstacle 1 sensed by agent 1 exceeds 3, the
information of obstacle 1 is recorded in the long-term
memory and is shown blue. Similarly, in figure 7a, agent
2 is relative static to agent 1. In figure 7b, agent 2 is
perceived by agent 1 for 3 times and the information of
agent 2 is also stored in the long-term memory of agent 1.
In figure 8a, agent 3 is most interested in agent 2 by
comparing the focus factor of each perceived agent. In
figure 8b, agent 2 changes the moving direction and
agent 3 also adjusts the direction to make it accord with
that of agent 2.
Figure 9 shows the influence of the crowd density
on the perception. In figure 9a, the density is low and the
visual range of agent 1 is relative large. In figure 9b, the
visual range of agent 1 decreases due to the increase of
the crowd density.
In figure 10a, agent 1 remembers agent 2, agent 3
and agent 9 in the short-term memory, but the
information of the perceived objects is too much for him
to memorize, so in figure 10b, he forgets agent 2, 3 and 9
quickly and keeps agent 7 and 8 in mind instead.
The above experiments show that the hierarchical
perception model can not only reflect human’s
perceptual characteristics, but also provide plausible
environment information for the crowd to make
reasonable decisions.

Acknowledgements
This work was supported by the Technologies
Research and Development Cultivation Program of
Tianjin under Grant No. 06YFGZGX06200, the Applied
Basic Research and Cutting-Edge Technology Research
Scheme of Tianjin under Grant No. 08JCYBJC14300,
National Science Foundation of China under Grant No.
60776807, Key Topic of 863 Program under Grant No.
2006AA12A105 and Key Projects in the Science and
Technology Pillar Program of Tianjin under Grant No.
08ZCKFGX04100.

References
[1]

[2]

[3]

[4]
[5]

5. Conclusions and future work

[6]

We have proposed a hierarchical perception model
to simulate realistic crowd perception. The contributions
of our method may be summarized as follows:

[7]

110

Nuria Pelechano. Modeling realistic high density
autonomous agent crowd movement: social forces,
communication, roles and psychological influences:
[Ph.D.dissertation].
Philadelphia:
University
of
Pennsylvania, 2006.
Shao W., TERZOPOULOS D. Environmental modeling
for autonomous virtual pedestrians. In SAE Symposium
on Digital Human Modeling for Design and Engineering,
2005.
W.L. Koh, Lin Lin, Suiping Zhou. Modelling and
Simulation of Pedestrian Behaviours. Proceedings of the
22nd Workshop on Principles of Advanced and
Distributed Simulation, 2008, 43-50.
H. Noser, D.Thanlmann. Synthetic Vision and Audition
for Digital Actors. Computer Graphics Forum, 1995,
14(3): 325-336.
C. Reynolds. Flocks, herds and schools: A distributed
behavioral model. ACM Computer Graphics, 1987,
21(4): 25-34.
C. Bordeux, R. Boulic, D. Thalmann. An Efficient and
Flexible Perception Pipeline for Autonomous Agents.
Computer Graphics Forum, 1999, 18(3):23-30.
TERZOPOULOS D., TU X., GRZESZCZUK R.:
Artificial fishes: autonomous locomotion, perception,

[8]

behavior, and learning in a simulated physical world.
Artificial Life, 1994, 1(4): 327-351.
T Sakuma, T Mukai, S Kuriyama. Psychological model
for animating crowded pedestrians: Virtual Humans and
Social Agents. Computer Animation and Virtual Worlds,
2005, 16(3-4): 343-351.

[9]

TERZOPOULOS R. McCrae, O. John. An introduction
to the five-factor model and its applications. Journal of
Personality, 1992, 60(2): 175-215.

(a)
(b)
(c)
Figure5. The short-term memory capability of the virtual agent

(a)

(b)
(c)
Figure6. The long-term memory storing the static obstacle

(a)
(b)
Figure7. The long-term memory storing the agent relative static to the observer

(a)
(b)
Figure8. The impact of the focus factor on the perception

(a)
(b)
Figure9. The impact of the crowd density on the visual range

(a)
(b)
Figure10. The quick update of the contents for the short-term memory

111


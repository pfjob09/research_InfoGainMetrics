2009 Sixth International Conference on Computer Graphics, Imaging and Visualization

Digital Video Watermarking in the Discrete Wavelet Transform Domain
Putra Sumari
School of Computer Sciences
Universiti Sains Malaysia
11800, Penang, MALAYSIA
putras@cs.usm.my

Sadik. A.M .Al-Taweel
School of Computer Sciences
Universiti Sains Malaysia
11800, Penang, MALAYSIA
sadik@cs.usm.my

Fabriano in Italy, which has played a major role in the
evolution of paper industry. After their invention,
watermarks quickly spread in Italy and then all over Europe.
These were called physical watermarks because they were
found on the physical media. Nowadays, physical
watermarks are commonly used to authenticate important
documents such as banknotes and passports. One of the
challenges in the video and image watermarking is the
geometric manipulations of the watermarked data. It is
known that a small amount of rotation or scaling can
dramatically disable the receiver from detecting the
watermark. Geometric transformations are yet to be solved
because of their high computation complexity,
implementation difficulties, and poor performance [12].
Thus,
geometric
manipulation
destroys
the
synchronization of the watermark embedding and detection
process. The detection of watermark requires a synchronized
step to locate the embedded watermark in the content. Some
of the video watermarking techniques are based on the
spread spectrum approach which targets the geometric
distortions and operation in the 3D wavelet domain and
BCH codes, and 3D interliving by incorporating an effective
temporal synchronization technique [4, 5].
Reviews on many other techniques that transform the
video watermarking into discrete wavelet transform domain
to handle the geometric distortions, attacks, and applications
can be found in [6,7] . In [8], the proposed technique works
in the space domain and it is robust against geometric
transformations like image cropping and resizing. [9]
Presented robust geometric attack techniques such as shift,
rotation, scaling and cropping in the spatial domain by
employing image registration techniques. The weakness of
the existing algorithms includes the low bit rate of the
watermark. Some algorithms embed only 1 bit information
as watermark.
In [10] a spatial domain reference watermark was used
to achieve invariance on the geometric attacks, and they
introduced two modes: the first one is to detect the
registration pattern correctly and the other mode is to detect
the watermark after registration. In this paper, we propose
an oblivious video watermarking technique based on the
DWT. The embedded data rate is high and robust. The
experimental results show that the embedded watermark is
robust and invisible. This paper is organized as follows:
section 2 describes the proposed algorithm and the
embedding strategy. Section 3 describes the experiential
results.

Abstract— Nowadays, the digital copyrights are the
common concern in the Multimedia Digital production
industry and these copyrights apply various watermarking
techniques. In this paper we present a method for a robust
watermarking insertion in a video frame. The proposed
method works on the uncompressed video based on the spread
spectrum communication. The researchers applied the
technique in the discrete wavelet transform domain (DWT).
The results showed that the watermark has high perceptual
invisibility and robust against JPEG compression, geometric
distortions such as Downscaling, Cropping, and Rotation, as
well as noising. The watermark was successfully extracted
from the video after various attacks.
Keywords--- Data hiding, video watermarking, geometric
attacks

I.

INTRODUCTION

Multimedia and digital data, such as video, music, text,
and image are usually transferred without any degradation
and they are easily copied. Concerns over the ownership
protection, data protection, and other security issues have
arose, and the general solution is the digital watermarking,
which can be used to identify the illegal copying and the
ownership authentication by inserting information into the
digital data in a visible or invisible way. In order for a
watermark to be useful, it must be perceptually invisible and
robust against various possible attacks and image processing
by those who seek to corsair the material [1,2].
There has been much emphasis on the robustness of
watermarking against the signal processing operations.
However, it has become clear that a very small amount of
geometric distortions can prevent the detection of a
watermark in many watermarking techniques. This problem
is more pronounced in blind detection that needs no original
information during the watermark detection. Digital
watermark is a code that is embedded inside some innocentlooking cover data. Typically, this information is required to
be robust against any intentional removal by malicious
parties. In contrast to cryptography, where the existence but
not the meaning of the information is known, watermarking
aims to hide entirely the existence of the information.
Watermarking has existed since approximately the 13th
century and the past watermarks were used on papers to
identify the mill which made them [3].
The oldest watermarked paper was found in archives
dates back to 1292 and it originated from the town of
978-0-7695-3789-4/09 $25.00 © 2009 IEEE
DOI 10.1109/CGIV.2009.12

133

II.

THE PROPOSED ALGORITHM

In this algorithm we improve the watermarking
technique which was designed by Hartung and Girod [11].
In their work, they presented an algorithm for embedding
the digital watermarks into compressed and uncompressed
video sequences. The basic principle is borrowed from the
spread spectrum communications. In the spread spectrum
communication, a narrow band signal is transmitted over a
much larger bandwidth such
that the signal energy that present in any single
frequency is undetectable.
Similarly, the watermark bits are spread by a large factor
called chip-rate so that it is imperceptible.

Figure 2 Random sequence generator

B. WATERMARK EMBEDDING
The host video frame is transformed into one level DWT
decomposition by using the Haar filter. The lowest
frequency sub-band coefficients (LL) are selected for
embedding.
Wi is added to the digital video signal Vi, to produce the
watermarked video signal, Vi′:

A. WATERMARK GENERATION
Let N be the total number of pixels in the video signal. A
chip-rate refers to the amount of information bits that is
being spread (See Figure 1). Let cr be the chip-rate. Then, a
N
total of
information bitS could be embedded in the
cr
Video signal. Let aj ∈ {-1,1} be the sequence of information
bits that has to be embedded into the video stream.

Vi′ = Vi + Wi

(5)

Watermarked video frame is produced after applying
IDWT to the embedded result as shown in Figure (3).

Figure 1 Spreading by using the chip_rate

This sequence is spread by a large factor, which is the chiprate cr, to obtain the spread sequence bi:
bi=aj, Where (j-1) . cr + 1 ≤ i < (j-1) . cr + cr

(1)

The spread sequence bi is then modulated by a pseudo
noise sequence
pi, pi ∈ {-1,1} , i=1, 2, …, N

(2)

Such a sequence can be generated by the feedback shift
register or by any other random number generator. By using
shift registers, at each clock time, the register shifts all the
contents to the right (Figure 2). The sequence pi is generated
according to the recursive formula:
pi = c1 pi -1+ c2 pi -2 + …..+ cn pi -n

Figure 3 Watermark embedding process in the DWT domain

C. WATERMARK EXTRACTION
The watermark is extracted without using the original,
unwatermarked signal, by using demodulation where the
filtered watermarked video signal is multiplied by the same
pseudo noise signal Pi that was used for embedding. This is
followed by summation of window of length with the chip
rate, yielding the sum Sj for the Jth information bit:

(3)

The modulated signal is then scaled with the scalar α.
Wi = α.bi . pi , i=1,2,…..,N

(4)

Where Wi is the spread spectrum watermark.

134

( j −1).cr + cr

( j −1).cr + cr

i = ( j −1).cr +1

i = ( j −1).cr +1

∑ Pi .v~i =

sj =

∑

The result of cropping 50% of the watermarked frame is
shown in Figure (9). The watermark frame of the video is
rotated-17° by using the bilinear interpolation. The detection
score is 0.52. See Figure (10).
Figure (11) shows the detection score after 50% scale
down attack with correlation = 0.4734. For noise attack,
Gaussian noise with mean 0 and variance 0.005 are used on
the watermarked frame. Figure (12) shows the detection
score. The correlation value is 0.5. Salt and pepper noise
with density of 0.02 is also added to the watermarked signal.
See Figure (13). In most cases, although the correlation
between the original and extracted watermark is relatively
small, the watermark is distinguishable in the random
watermark set.

Pi .v i

∑

1

+

( j −1).cr + cr

∑ P .P .α .b

i
i = ( j −1).cr +1

∑

i

i

(6)

i

2

∑

∑

1 and
2 represent the
Where the two terms
contribution to the correlation sum from the filtered video
signal and the filtered watermark signal respectively.

∑

1 is zero. This means
Let us assume that the sum
~
that the video signal has been filtered out in V and that Pi.
αi. bi ≈ Pi. αi. bi which means that the high pass filtering
has a negligible influence on the white pseudo noise
watermark signal. Under these assumptions, we have:

s j = ∑1 + ∑ 2 ≈

( j −1).cr +cr

∑ Pi .α .b
2

i

i

= Pi 2 .α i .a j .cr

(a)Watermarked video frame

(c) Watermark image

TABLE 1 THE PARAMETER OF TEST VIDEO SEQUENCE

(7)

i =( j −1).cr +1

Video test
sequence
Size
GOP
Chromatic format
Frames rate(fps)
Bit rate(Kbps)
Frame number

Thus, sj, is a calculation of the embedded information bit
in the video frame.

Sign(s j ) = sign(a j .Pi 2 .cr.αi ) = sign(a j ) = a j
> 0

(b) original video frame

Figure 4 Video watermarking examples

(8)

Flower

Susi

Mobl

352x240
37
4:2:0
29.9
1500
450

352x240
37
4.2.0
29.79
1500
450

352x240
37
4.2.0
29.79
1500
450

The recovery of the watermark bits is more robust, if the
original, unwatermarked signal is available. The signal can
be subtracted from the watermarked video signal before
demodulation instead of the filtering operation because the
subtraction removes the interference between the video
signal and the embedded watermark.
III.

EXPERIMENTAL RESULTS

(a)original frame

To evaluate the algorithm, the video clips with 352×240
are used as shown in the table (1) and they are spread with
chip-rate = 8. We use the PSNR (peak signal to noise ratio)
to estimate the performance of the invisibility and the
detection ratio of the watermarks to estimate the
performance of robustness. Figure (4) shows the
watermarked frame with PSNR=40.17 dB, original frame,
and watermark frame. Figure (5) shows the cropped
watermarked frame where only the centre of the frame
remains. Figure (6) shows the 50% scaled down
watermarked frame. Figure (7) shows the rotated
watermarked frame. Typical correlation result of the
detected watermark after compression attack, and the
detection is shown in Figure (8). A 3 ×3 averaging filter
with coefficients of 1/9 is used in the LPF. The LPF attack
causes the decoded watermark to be noisy with the
correlation of 0.616. Although the correlation is relatively
small, the detection score remains acceptable.

(b)cropped

Figure 5 Cropped watermarked frame

(a)original frame

(b) Downscaled

Figure 6 Scaled down watermarked frame

(a)original frame

(b)Rotated

Figure 7 rotated watermarked frame

135

Table
Tennis
352x240
37
4.2.0
29.69
1500
450

0.8

0.6

0.6

Correlation

Correlation

0.8

0.4

0.4

0.2

0.2

0

0

-0.2

100

200

300

400

500

600

700

Random Watermarks

800

900

-0.2

1000

400

500

600

700

800

900

1000

0.8

0.6

0.6

Correlation

Correlation

300

Figure 11 Random watermark detection results under the scale
Down attack.

0.8

0.4

0.4

0.2

0.2

0

0

100

200

300

400

500

600

700

Random Watermarks

800

900

-0.2

1000

Figure 9 Random watermark detection results under the cropping attack.

100

200

300

400

500

600

700

Random Watermarks

800

900

1000

Figure 12 Random watermark detection results under the Gaussian
noise attack.

0.8

Correlation

0.8

Correlation

0.6

0.4

0.6

0.4

0.2

0.2

0

0

-0.2

200

Random Watermarks

Figure 8 Random watermark detection results under the compressed

-0.2

100

100

200

300

400

500

600

700

800

900

-0.2

1000

Random Watermarks
Figure 10: Random watermark detection results under the rotation attack

100

200

300

400

500

600

700

Random Watermarks

800

Figure 13 Random watermark detection results under
pepper attack

136

900

1000

the salt and

IV.

Conclusions

Int. Conf. Computational Intelligence Multimedia
Applications, Sep. 27–30, 2003, pp. 260–265.
[5] H. Liu, N. Chen, J. Huang, X. Huang, and Y. Q. Shi “A
robust DWTbased video watermarking algorithm,” in Proc.
IEEE Int. Symp. Circuits Systems, vol. 3, May 26 29, 2002,
pp. 631–634.
[6] G. C. Langelaar, I. Setyawan, and R. L. Lagendijk,
“Watermarking digital image and video data. A state-of-theart overview,” IEEE Signal Process. Mag., vol. 17, no. 5,
pp. 20–46, Sep. 2000.
[7] A. D. Gwenael and J. L. Dugelay, “A guide tour of video
watermarking,”Signal Process.: Image Commun., vol. 18,
no. 4, pp. 263–282, Apr. 2003.
[8] R. Lancini, F. Mapelli, and S. Tubaro, “A robust video
watermarking technique in the spatial domain,” in Proc. 4th
EURASIP-IEEE Region 8 Int. Symp. Video/Image
Processing Multimedia Communications, June 2002, pp.
251–256.
[9]
C. V. Serdean, M. A. Ambroze, M. Tomlinson, and J. G.
Wade,
“DWTbased
high-capacity
blind
video
watermarking, invariant to geometrical attacks,” in Proc.
IEE Vision, Image, Signal Processing, vol. 150, 2003, pp.
51–58.
[10] C. V. Ambroze, M. A. Tomlinson, and J. G. Wade, “Adding
robustness to geometrical attacks to a wavelet based blind
video watermarking system,” in Proc. IEEE Int. Conf.
Multimedia Expo, vol. 1, Aug. 26–29, 2002, pp. 557–560.
[11] Hartung F., Girod B. (1998).”Watermarking of
Uncompressed and Compressed Video”. IEEE Transaction
on Image Processing, Vol. 66, No. 3.
[12] M. Awrangjeb, M. Murshed, and G Lu “Global Geometric
Distortion Correction in Images” Multimedia Signal
Processing, 2006 IEEE 8th Workshop on Publication Date:
3-6 Oct. 2006

Robustness against the geometric distortions is one of
the most important requirements of the digital video
watermark and still image. In this paper, we propose a
framework for a robust digital video watermarking which
embeds an image into digital video by transforming the host
frame of the video to one level DWT decomposition. We
have illustrated the robustness of our framework for video
watermarking against numerous video degradations,
including compressed attack, noise attack, and video frame
cropping, downscaling, and rotation.
ACKNOWLEDGMENT
The authors would like to thank the Universiti Sains
Malaysia (USM) for supporting this study.
REFERENCES
[1]

[2]

[3]
[4]

Voloshynovskiy, S., Pereira, S., Herrigel, A., Baumgartner,
N., & Pun, T.(2000). Generalized watermarking attack
based on watermark estimation and perceptual
remodulation. Paper presented at the Proceedings of SPIE
3971, Security and Watermarking of Multimedia Content II,
San Jose, CA.
Voloshynovskiy, S., Pereira, S., Pun, T., Eggers, J.J., & Su,
J. K. (2001). Attacks on digital watermarks: classification,
estimation based attacks, and benchmarks. IEEE
Communications Magazine,39(8), 118–126.
Karzenbeisser S., Perircolas F.(2000). Information Hiding
Techniques for Steganography and Digital Watermarking.
Artech House.
Y. Li, X. Gao, and H. Ji, “A 3D wavelet based spatialtemporal approach for video watermarking,” in Proc. 5th

137


Simulation of Interactive Cutting Tool for Craniofacial Osteotomy Planning

1

Mohammad Azam Rana11, Halim Setan1, Zulkepli Majid1 & Albert K. Chong2
Department of Geomatic Engineering, Faculty of Geoinformation Science & Engineering,
Universiti Teknologi Malaysia
2
School of Surveying, University of Otago, Dunedin, New Zealand
mazamrana@hotmail.com, halim@fksg.utm.my, zulkepli@fksg.utm.my,
chonga@albers.otago.ac.nz
Abstract

Engineers and scientists from many fields are using
three-dimensional reconstruction for visualization and
analysis of physical data. Recent advances in medical
imaging and surgical techniques have made possible
the correction of severe facial deformities and
fractures. Surgical correction techniques often involve
the direct manipulation – both relocation and surgical
fracture – of the underlying facial bone. Craniofacial
surgeons now a days use 3D models of human face to
diagnose and analyze abnormalities and hence to plan
their basic surgery procedures. To work with these 3D
models, it is desirable to develop methods that allow
one to interactively manipulate and alter the geometry
in an intuitive and efficient manner. In the case of
medical/craniofacial data, a baseline interactive task
would be to simulate cutting, removal and realignment
of tissue. In this paper, we propose a method to
simulate a cutting tool using an oriented cube that
allows the simulation of tool thickness as well as
performing the desired cutting operations on threedimensional models. This method can be employed
interactively, allowing the user to perform the task in
an intuitive and easy manner. The tool can be used for
osteotomy planning and has been tested on models up
to 500,000 polygons in size and the time for cutting
varies from 15 ms for small objects (mandible) to 875
ms for large models (complete skull).
Keywords: Craniofacial, Osteotomy,
Cutting Tool, Surgery Planning.

Simulation,

1. Introduction
The lateral cephalogram has been a valuable tool for
conventional planning. However, this radiograph only
represents a composite of the sagittal plane. For the
majority of patients with congenital and acquired

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007

craniomaxillofacial anomalies, the deformity is threedimensional in nature and many patients are
asymmetric [1]. A single radiograph is therefore
inadequate for description of the entire deformity, for
complete skeletal analysis and for treatment planning
[2].
A maxillofacial intervention is traditionally planned
by means of lateral X-ray images. Using these socalled
cephalograms,
distances
(based
on
cephalometric landmarks) are measured and compared
to their normal values. In this way a surgeon derives a
surgical plan. But with this preoperative workup, the
post-operative appearance can be predicted only to a
limited extent due to the lack of 3D movements and its
consequences [3]. Most of the deformities are threedimensional in nature such as bilateral positioning of
zygoma or treatment of facial asymmetries [1]. Such
3D problem cannot be addressed by 2D cephalometric
radiographs and planning mainly depends upon the
surgeons’ expertise and their mental 3D perceptions of
the deformities.
In the case of facial malfunctions caused by caraccidents, tumors, congential dysmorphologies,
maxillofacial surgery is required. 2D cephalogram is
the low-cost solution but it cannot address the 3D
nature of abnormalities. One 3D attempt is the use of
tangible skull models produced by stereolithography
etc. These models make realistic bone surgery
simulation possible. However, disadvantages include a
large extra cost of the model, a considerable
preparation time and loss of concerning soft tissues.
Instead of tactile models, 3D software planning
systems can include capability for osteotomy
simulation, cephalometric reference data for guidance
during repositioning etc.
Complex maxillofacial malformations continue to
present challenges in analysis and correction. Current
surgical procedures attempt to re-establish functional
and aesthetic anatomy by repositioning displaced

skeletal elements or by grafting and contouring
abnormal bony contours. Computer-generated threedimensional imaging of maxillofacial anatomy,
obtained from spatially mapped data by Computed
Tomography (CT) and magnetic resonance imaging
(MRI) techniques, can provide the accurate life size
and shape of an object such as the skull. Threedimensional visualization is the essence and aim of
three-dimensional imaging systems [4].
Cutting is a common manipulation encountered in
simulations such as surgical training, clothing design
and CAD/CAM manufacturing. A number of
techniques have been developed to simulate cutting
surface and volumetric meshes [5]. The common
element missing from these previous cutting tools is
the ability to represent various forms of cutting using
realistic tools on irregular meshes in real-time. The
goal of this paper is to demonstrate how by using a
very simple scheme, one can model widely differing
behaviors of virtual tools within a surgical simulation
environment.
The surgical correction of hemifacial microsomia,
for example, often needs multisegment bone relocation
with a combination of different transformations and
eventually multidirectional osteodistraction [6]. Such
complex deformities need interactive and precise
cutting tools. Common approaches offer planer cut
only and the specification of suitable cut planes is
cumbersome. Also the planar tools lack the simulation
of tool thickness. In a new approach, we are able to
simulate an interactive cutting tool using a cube. The
tool, can be oriented to any direction suitable for the
cutting, can be moved to any 3D location, and can
allow changes in tool size interactively.
This paper is organized as follows: In Section 2, we
give an overview of the related work; Section 3
illustrates the methods; 3.1 deals with simulation of the
tool, 3.2 demonstrates the use of the cutting tool for
osteotomy planning; 3.3 describes the efficiency of the
algorithm and shows the cutting time for various mesh
sizes. Finally, we summarize our conclusions in
Section 4.

directly drawn onto the model’s surface. The
osteotomy lines can be drawn either by dragging the
moue onto the surface or by specifying several points
on top of the 3D model in successive order.
A number of researchers have obtained results in
the field of computational maxillofacial surgery
planning [8]. Such as Koch [9] describes a system
based on linear elasticity, where osteotomies are
specified on 2D pictures. Filip et. al [3] and Voss [10]
use a 3D “virtual knife" and emphasize the real-time
aspects of simulation. Zachow et al [11] use a
specialized version of the Amira visualization system
for most parts of the toolchain, including mesh
generation. A number researcher [12][1][13][14] has
simulated cutting operation for osteotomy planning
using a cutting plane.

3. Method
For osteotomy planning, a cutting tool is defined on
the surface representation of the bone, and then the
cutting action is performed. In contrast to other
approaches, where surgeons have to draw trajectory on
the bone surface and define depth along the trajectory,
we use a predefined size and thickness for the cutting
tool. Once the tool is activated, its size and thickness
can be changed according to requirement and then the
actual cutting action is performed on the volume data
itself. Each separated bone fragment can be identified
as an independent object that can be further
manipulated. The size, position and orientation of the
cutting tool can be changed interactively to enable the
simulation of different procedures. Figure 1 illustrates
the block diagram for cut tool interaction loop.

2. Related Work
Osteotomy planning on 3D bone models,
reconstructed from tomographic data, becomes more
and more relevant in computer-assisted surgery. A 3D
planning of complex bone cuts for a correction of
dysmorphisms is extremely important and makes
absolute sense for the spatial understanding of the
resulting
bone
alignment
including
all
interdependencies, for the fixation and stabilization of
bony fragments [7]. Some researchers [7], [6] use lines

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007

Figure 1: Schematic diagram for tool interaction

3.1 Simulation of Cutting Tool
In order to simulate bone cutting, i.e. an osteotomy,
the program requires a mathematical description called
the Boolean operation, which is the subtraction of one
volume from another. The basis of the Boolean engine

is triangle-to-triangle intersection. The intersecting
points of the triangles are called pierce points and
indicate where edges of one triangle intersect the plane
of another.
Most of previous approaches use a plane as a
cutting tool and lack the simulation of tool thickness.
In order to simulate tool thickness, we use an oriented
cube instead of a cutting plane. To actually perform
cutting on the volume data, the Boolean operation have
been used, which subtracts the tool intersection volume
from the 3D model. When the user applied the cut,
cutting procedure continues, firstly, with the definition
of six planes representing the oriented cube and then
using these six planes for definition of Boolean
operation for performing the actual cut operation. We
use Visualization Toolkit (VTK) to implement this
cutting algorithm using Boolean operation. Figure 2
shows the pseudo code for the algorithm.

Figure 2: Pseudo code for the algorithm
In order to move the tool to any 3D position, we
use the translation and rotation matrices, multiply them
with the current position of the tool to get the new
values for each vertex of the cube and then update the
tool to new position accordingly. Figure 3 shows the
pseudo code for tool movement.
The system provides the flexibility to apply any
craniofacial operation on the bone structure and
manipulate it at will. These changes are made with the
simulated cutting tool with which the bone is split into
fragments. Afterwards, each bone segment is defined
as a unique object that can be further manipulated. The
cutting tool can be changed in size and orientation to
enable the simulation of different procedures. As an
example of a surgical procedure, Figure 4 through
Figure 10 shows the separation and alignment of a
mandible.

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007

Figure 3: Pseudo code for tool movement

3.2 Osteotomy Planning
In order to perform craniofacial osteotomy
planning, the cutting tool model is positioned with
respect to the bone using toolbar controls that allow
moving the tool along or around any of the three axes.
Once the desired position is achieved (Figure 5 and
Figure 6), the cut operation is performed (Figure 7) and
resulting object is displayed. Additional tool
positioning and cuts can be made in the case of
multiple or complex osteotomies as illustrated in the
schematic diagram in Figure 1. After performing cut
operations, the operator identifies and names the
resultant components (Figure 8). Repositioning is the
final step in every osteotomy simulation. The
movement of each bone fragment to the new position
(Figure 9) can be made using the toolbar controls.
Once the proposed final position of the bone fragments
is achieved, the objects are merged into a single object
(Figure 10).

Figure 4: A skull extracted

Figure 5: Cutting tool

from CT data

positioned on left side of
mandible

planning on common desktop PCs without requiring
any additional hardware.

4. Results and Discussion

Figure 6: Cutting tool

Figure 7: After application

positioned
mandible

of cutting tool

to

separate

Figure 8: Separation
mandible from skull

of

Figure 9: Aligning
the mandible

Figure 10: Skull after alignment of mandible

3.3 Algorithm Efficiency

A new approach for simulation of cutting tool for
craniofacial surgery planning has been demonstrated.
With this method the tool thickness can be simulated.
We have tested the algorithm to simulate a very thin
tool up to a thickness of 0.01 mm. The cut surface for
such a thin tool is very smooth. Figure 4 shows the 3D
model of skull extracted from CT data, which has been
used for demonstration of the proposed cutting tool for
osteotomy planning. Figure 5 through Figure 10 show
the results for tool positioning, cutting, fragment
alignment and merging of the different bone fragments
into a single bone model. The method can easily be
used to plan any type of osteotomy for craniofacial
surgery.
We have tested the performance of the algorithm.
Table 1 shows the results of time taken (in
millisecond) for cutting various mesh sizes. The
system used for this purpose comprises of an IBMcompatible Personal Computer (PC), configured as an
Intel® Pentium-IV® 2.8 GHz processor (Intel Inc.,
CA, USA) with 1.00 GB RAM, an ATI RADEON
display card with 256 MB RAM. The operating system
was Microsoft® Windows XP 2002, Home Edition,
Service pack 2. The cutting time for small mesh is
about 15 ms and for complete skull consisting of about
50000 triangles is about 875 ms. This demonstrates
that the method can be used to perform osteotomy
planning on low cost PCs. Secondly, no extra hardware
is required; the method is very easily used for
osteotomy planning using only mouse.

References
[1]

Table 1: Performance of cutting algorithm

Cutting Performance
# Triangles
588
5906
41972
49999

Time (ms)
15
125
719
875

In order to estimate the algorithm efficiency, we
used few 3D meshes of varying sizes and calculated
the time to perform cut operation. Table 1 shows the
results of cutting times in milliseconds for these
meshes. As shown in Table 1, the cutting is performed
very quickly and the method is suitable for osteotomy

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007

[2]

[3]

[4]

Troulis, M. J., Everett, P., Seldin, E. B., Kikinis, R. and
Kaban, L. B. (2002). Development of a threedimensional treatment planning system based on
computed tomographic data. Int. J. Oral Maxillofac.
Surg. 2002; 31: 349–357.
Gateno,
J.
(1999).
Accuracy
of
custom
stereolithographic templates for the installation of an
external multiplanar distractor. J Oral Maxillofac Surg
1999: 57: 96.
Filip, S., Johan V. C., Joseph S., Guy M. and Paul S.
(1999). A Simulation Environment for Maxillofacial
Surgery Including Soft Tissue Implications. Lecture
Notes In Computer Science; Vol. 1679: 1210 - 1217.
Springer-Verlag.
Xia, J., Samman, N., Yeung, R.W.K., Wang, D., Shen,
S.G.F., Ip, H.H.S. and Tideman, H. (2000). Computerassisted three-dimensional surgical planning and
simulation. 3D soft tissue planning and prediction. Int.

J. Oral Maxillofac. Surg. 29:250-258.
Cynthia, D.B, Steven, S., Anil M., Kevin M., Simon,
W. and Richard B. (2002). A survey of interactive
mesh-cutting techniques and a new method for
implementing generalized interactive mesh cutting
using virtual tools. J. Visual. Comput. Animat. 2002;
13: 21–42.
[6] Watermark, A., Zachow, S. and Eppley, B.L. (2005).
Three-dimensional
Osteotomy
Planning
in
Maxillofacial Surgery Including Soft Tissue Prediction.
The Journal of craniofacial Surgery. 16(1): 100-104.
[7] Zachow, S., Gladilina, E., Saderb, R. and Zeilhoferc,
H.F. (2003). Draw and cut: intuitive 3D osteotomy
planning on polygonal bone models. International
Congress Series 1256 (2003) 362–369.
[8] Schmidt, J.G., Berti, G., Fingberg, J., Cao, J. and
Wollnyy, G. (2004). A Finite Element Based Tool
Chain for the Planning and Simulation of MaxilloFacial Surgery. European Congress on Computational
Methods in Applied Sciences and Engineering
(ECCOMAS 2004).
[9] R.M. Koch. Methods for Physics Based Facial Surgery
Prediction. PhD thesis, Institute of Scientific
Computing, ETH Zurich, 2001, Diss.No.13912.
[10] G Voss, JK Hahn, W Muller and R Lindeman. (1999).
Virtual cutting of anatomical structures. Stud Health
Technol Inform. 1999
[11] Zachow, S., Gladilin, E., Zeilhofer, H.F., and Sader, R.
[5]

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007

(2001) Improved 3D Osteotomy Planning in Craniomaxillofacial Surgery. Medical Image Computing and
Computer-Assisted Intervention - MICCAI 2001: 4th
International Conference Utrecht, The Netherlands,
October 14-17, 2001, Proceedings.
[12] Girod, S., Keeve, E. and Girod, B. (1995). Advances in
interactive craniofacial surgery planning by 3D
simulation and visualization. Int. J. Oral &
Maxillofacial Surgery. 24:120-125.
[13] Andre, N., Katja, B., Rainer, W., Andreas, R. and
Michael, R. (2005). Advanced virtual corrective
osteotomy. International Congress Series 1281 (2005)
684–689.
[14] Keeve, E., Girod, S. and Girod, B. (1996). Craniofacial
Surgery Simulation. Proceedings of the 4th
International Conference on Visualization in
Biomedical Computing. VBC'96, Hamburg, Germany,
September 22-25, pp. 541-546, 1996.


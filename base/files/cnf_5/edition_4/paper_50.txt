Improved Co-occurrence Matrix as a Feature Space for Relative Entropy-based
Image Thresholding
information about gray level transition

I. El-Feghi*, N. Adem**, M. A. Sid-Ahmed***,
M.carries
Ahmadi***
probability. It also
spatial details of the
idrisel@gmail.com, nadia_adem06@yahoo.com, ahmadi@uwindsor.com, ahmed@uwindsor.com
* Higher Industrial Institute, Misurata-Libya,** El-Fath University, Tripoli-Libya , ***Department
of Electrical & Computer Engineering, University of Windsor
Abstract
In this paper, a thresholding
technique suitable for noisy background
images is proposed. The proposed algorithm
uses an improved co-occurrence matrix as
feature spaces. The threshold value is
obtained by maximizing the relative entropy.
Experimental results show that the proposed
method outperforms other thresholding
techniques especially on the presences of
noise in the background of the input image.
Keywords: image thresholding, cooccurrence matrix, relative entropy
1. Introduction
Image thresholding is an important
step in many image processing applications. It
can be use as a separate block or as a preprocessing step in applications such as Object
Character Recognition (OCR). Segmentation
or thresholding is basically dividing the image
into several object is such a way that similar
pixels are grouped together in on segment.
Although a number of image thresholding
techniques are available now, image
thresholding is still a challenging problem and
there no yet an optimal technique that can
always produce acceptable results with all
image types. An ideal image in which there is
a clear cut between the black and the white
regions can be easy thresholded. However, in
real life most images do not have clear cut
between its different regions making it
difficult to
to find a proper threshold value. A
large number of image thresholding
techniques are available in the literatures [13]. An more detailed reference of thresholding
techniques can be found in [4]. Relative
entropy has been successfully applied to
image thresholding [5-8]. It is a measure of
pixels mismatch. The co-occurrence matrix
which is used as features space, carries the

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007

image, these special details related to the
information of a pixel and its neighboring
pixels. The co-occurrence matrix has problem
of distinguishing noise pixels from image
pixel and objects edge pixels from interior
pixels. If more local neighborhoods pixels of
pixel information are considered instead of the
only two neighborhoods with the same other
concepts of that feature space, those problems
could be avoided and the information of an
image is adequately utilized. This idea is
introduced through this paper and it’s applied
in thresholding of a noisy image based on
relative entropy.
2. Co-occurrence matrix
Given a digitized image I of size H× W
with L gray levels, the image components are
defined as I = [ f ( x, y)] HxW where f(x,y) is
the gray-level of the pixel at location (x,y) and
its value is form 0 to L-1. According to [8],
the co-occurrence matrix of an image which
carry information about the transition of
intensities between adjacent pixels is defined
as T = [t ij ]L×L , where tij is the element of
row i and column j of co-occurrence matrix T
is defined as follows:
H −1 w −1

t ij = ∑∑ δ ( x, y )

(1)

x =0 y = 0

Where

⎧ ⎧ f ( x, y) = i, f ( x, y + 1) = j
⎪ ⎪
⎪1if ⎨and / or
δ ( x, y) = ⎨ ⎪
⎪ ⎩ f ( x, y) = i, f ( x + 1, y) = j
⎪0 otherwise
⎩

(2)

By normalizing the total number of transitions
in the T matrix, the transition probability from
i to j gray level is obtained.

3. Proposed Co-occurrence Matrix
To overcome the drawbacks of the cooccurrence matrix which is constructed by
considering only two neighboring points, more
local neighborhoods of pixel information are
considered instead of only two pixels.
The proposed co-occurrence matrix
contains information regarding the transition
of intensities between an information pixel
and the average of three pixels in the right
column and another three in left column of
information pixel column also. It also contains
information related to the transition of
intensities between an information pixel and
the average of three pixels in the next row and
another three in previous row of information
pixel row. The proposed co-occurrence matrix
is defined as follows:

4. Comparison between Traditional and
Proposed Co-occurrence Matrices
To clarify the advantage of using the
proposed matrix as space feature for relative
entropy based thresholding in utilizing the
information of an image, let’s consider a noisy
image of size 7×6 as shown in figure 1. The
shown image is to be thresholded. The objects
of gray-level g1 are to be distinguished from
the background of gray-level g2.
N
N

N

A0
B0
C0
D0
E0

A1
B1
C1N
D1
E1

A2
B2
C2
D2
E2

A3
B3
C3N
D3
E3
N

T = [t ij ] LxL

(3)

Fig.1 7x6 pixels image with noise

(4)

The object pixels are labeled as
C0,1,2&3 while the background labeled as
D0,1,2&3. Pixels labeled with N are noise pixels.
According to the definition of cooccurrence matrix of an image, all the pixels
A0 A 1 A2 & A3 are mapped into a point (g2,g2)
as well as the pixels C3N E0 E1 E2 & E3.
Although their adjacent pixels are different,
they are mapped into the same location. For
example there are noisy pixels adjacent to A0,
A1 and E0 whereas the other pixels are not
adjacent to a noisy pixel, both pixel groups
will be mapped into the same point in the cooccurrence matrix. The pixels D0...3 are not
neighboring any A pixels and pixels C3N
which is an object pixels ravaged by noise will
be mapped to the same point in the cooccurrence matrix.
It is clear that with the use of the
traditional co-occurrence matrix many
information about the image will be lost.
However, large amount of information about
the image could be preserved using the
proposed co-occurrence. Using the same
image of figure 1 with the proposed cooccurrence matrix the, pixels A0 mapped to
(g2,(3g 1+5g 2)/8) and (g 2,(g1+7g 2)/8), C1N
(g2,(6g1+2g 2)/8)
and
mapped
to
(g2,(6g 1+2g 2)/8)
&
E3
mapped
to

H − 2 w−2

t ij = ∑∑δ ( x, y )
x= 0 y = 0

Where

⎧ ⎧ f (x, y) = i, g c (x, y +1) = j
⎪ ⎪
⎪1if ⎨and / or
(5)
δ (x, y) = ⎨ ⎪
⎪ ⎩ f ( x, y) = i, g r ( x + 1, y) = j
⎪0 otherwise
⎩
Where g c ( x, y ) is the average intensity of
columns adjacent to f(x,y) defined as:
1
gc(x, y) =
[f (x−1, y−1)+kf(x, y−1)+ f (x+1, y−1)
(6)
4+2k
+ f (x−1, y+1)+kf(x, y+1)+ f (x+1, y+1)]

g r ( x, y )

is the average intensity of rows
adjacent to f(x,y) and defined as:
1
[ f (x−1, y −1) +kf(x−1, y) + f (x −1, y +1) (7)
4+2k
+ f (x+1, y −1) +kf(x+1, y) + f (x +1, y +1)]

gc (x, y) =

k is a constant used to reflect how much the
adjacent pixels of a pixel information f(x,y)
contribute in the both averages, through this
paper it defined to equal two.

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007

(g2,(2g 1+6g 2)/8) and (g2,(4g 1+4g 2)/8). If the
threshold vector is chosen to be
((3g 1+5g 2)/8,(3g 1+5g 2)/8) pixels A0 & E3 will
be treated as the background pixels whereas
pixel C1N which is extreme pixel from the
ambient, will be treated as an object pixel.
We note that pixels with different
properties will be mapped to different points
on the proposed co-occurrence matrix which
means this matrix will carry more information
about the image; hence better thresholding can
be obtained.
5. The Thresholding Algorithm
In this section we present a
thresholding algorithm based on relative
entropy and the proposed co-occurrence
matrix as a feature space.
Relative entropy can be used as a
measure of a thresholding; the smaller entropy
value means that he thresholded image is
closer to the thresholding one. However, the
relative entropy value depends on the value of
the threshold vector. Let (T,S) be the threshold
vector. It partitions the co-occurrence matrix
into four quadrants, namely A, B, C & D as
shown in figure 2.
T
S

L-1

A

C

D

B

i
Gray level

The probabilities in each quadrant are defined
as follows:
T

S

i =0 j =0

PC =

L-1

S

L-1

ij

i =T +1 j =S +1
T

∑ ∑ Pij , PD = ∑

i =T +1 j =0

L −1

∑ ∑P
L −1

∑P

ij

(8)

i =0 j = S +1

Pij is the joint probability of gray level i and
the row or column average level j. Note that
Pijt is the analogue to Pij in the thresholded

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007

i =0 j =0

Pij

t

(9)

PA
t
P
= qA =
ij A
(T + 1)(S + 1)
PB
t
P
= qB =
ij B
( L − T − 1)(L − S − 1)

(10)

PC
t
P
= qC =
ij C
( L − T − 1)(S + 1)
PD
t
P
= qD =
ij D
(T + 1)(L − S − 1)

Equation (9) can be written as:
L-1 L−1
t
J{{Pij};{ Pij }} = ∑ ∑ Pij log Pij
i =0 j =0
L-1 L−1
t
− ∑ ∑ Pij log Pij = −H ({P })
ij
i =0 j =0
t
t
t
t
− ( P log q + P log q + P log q + P log q ).
A
A
B
B
C
C
D
D

H({Pij})

L − 1, L − 1

j

Pij

The Pijt in each quadrant of figure 2 is defined
as:

{P }
ij

Fig. 2 co-occurrence matrix partitioned
by the threshold (T,S)

L-1 L −1

J{{Pij};{ Pijt }} = ∑∑ Pij log

Where

L-1

PA = ∑∑ Pij , PB =

image. The relative entropy between theses
two probabilities distributions is defined by:

is

the

entropy

(11)
of

and its independent of (T,S).

i = 0, j = 0

Equation (11) provides an effective criterion
to measure thresholding performance. A good
threshold vector value should be one that
minimizes the relative entropy given by
equation (11).
6. Experimental results
To verify that the proposed cooccurrence matrix gives a better result than the
traditional one, it is applied to a noisy coin
image shown in Figure 3(a). The image is
contaminated with Gaussian white noise with
mean 0 and variance of 0.03. Figure 3(b)
shows the results obtained using the
conventional co-occurrence matrix and (c) is

the results of applying the proposed cooccurrence matrix. The value of k in eq.(7) is
obtained empirically. The shown results are
obtained with K=2.
7. Conclusions
In this paper, an improvement of the
co-occurrence matrix was presented. The cooccurrence matrix was modified in a way such
that the information of an image is adequately
utilized. An algorithm of thresholding a noisy
image based on the concept of relative
entropy, with the proposed co-occurrence
matrix as a feature space was presented. The
algorithm was applied with use once with
traditional and another with proposed cooccurrence matrix concepts on a noisy image
as shown in experimental results. The
improved co-occurrence matrix has a higher
robustness out performance the conventional
co-occurrence matrix when dealing with noisy
images.

(a)

(a)

8. References
[1] P. Saha, and J. Udupa, “Optimum Image
Thresholding via Class Uncertainty and
Region Homogeneity,” IEEE Trans. PAMI,
vol. 13, no.7, July 2001.
[2]
W.
Tsai,
“Moment-Preserving
Thresholding: A New Approach,” Computer
Vision, Graphics, and Image Processing, vol.
29, pp. 377-393, 1985.
[3] L.K. Hug, M.J.J. Wang, Image
“Thresholding by Minimizing the Measures of
Fuzziness,” Pattern Recognition, 28 (1995),
pp:41-51
[4] P. K. Sahoo, S. Soltani and A. Wang, “A
Survey of thresholding techniques,” CVGIP,
vol.41, pp: 233-260, 1988.
[5] T. Pun, “A New Method for Gray-Level
Picture Thresholding Using the Entropy of the
Histogram,” Signal Processing, vol. 2, pp.
223-237, 1980.
[6] A.K.C. Wong and P.K. Sahoo, ªA GrayLevel Threshold Selection Method Based on
Maximum Entropy Principle,” IEEE Trans.
Systems, Man, and Cybernetics, vol. 19, pp.
866-871, 1989.

(b)

Fig. 3 (a) Original noisy image, (b) image
thresholded using conventional co-occurrence
matrix

[7] C. Chung, K. Chen, J. Wang and M.
Althouse, “A Relative Entropy-Based
Approach to Image Thresholding,” Pattern
Recognition, vol. 27, No. 9, pp: 1275-1289,
1994
[8] Hui Zhu, Z. Fu and Z. Li, “ A New Image
Thresholding Method based on Relative
Entropy, “ In proc. of International
Conf. on Communications, Circuits and Syste
ms, vol 1, pp:634-637, 2002.

(c )
Fig.3 (c) image thresholded using the
proposed conventional co-occurrence matrix

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007


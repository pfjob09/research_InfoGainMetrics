Radon Transform Based Real-Time Weed Classifier
Muhammad Inam ul Haq 1, Abdul Muhamin Naeem 2, Irshad Ahmad 3, Muhammad Islam 4
1
Center of IT, Institute of Management Sciences, Peshawar.
2
Department of Computer Sciences, Farabi College Peshawar
3
Department of Computer Sciences, Islamia College Peshawar.
4
Department of Telecom Engineering, FAST-NU Peshawar.
{inamix@imsciences.edu.pk, (abdulmuhamin, iakhalil2003)@yahoo.com, m.islam@nu.edu.pk}
Abstract

A machine vision system to detect and discriminate
crop and weed plants in a commercial agricultural
environment was developed and tested. Images are
acquired in agricultural fields under natural illumination
were studied extensively, and a weed classifier based on
Radon Transform is developed. This classifier is
specifically developed to classify images into broad
(having broad leaves) and narrow (having narrow
leaves) classes for real-time selective herbicide
application. The developed system has been tested on
weeds in the lab; the results shows reliable performance
and significantly less computational efforts on images of
weeds taken under varying field conditions. The analysis
of the results shows over 93.5% classification accuracy
over a database of 200 sample images with 100 samples
from each category of weeds.
Keywords--- Ecology, Image Processing, Radon
Transform, Real-Time Recognition, Weed detection.

efficiently by adjusting the herbicide dose to specific
weed [10].
In order to perform a localized weed treatment, local
weed population must be evaluated on the field. Only
automatic weed detection can be economically justified
[7, 8].
Species based identification of weeds is not
necessary for its precise treatment. All weeds with the
same treatment can be placed in one class, but this might
create classes with high variance in spectral response,
because weeds might have very different optical
characteristics. A well considered choice of weed
categories should be based on treatment and
morphological properties of weeds. Classification into
narrow and broad leaves seems particularly interesting
because these weed groups are treated with different
herbicides and have different optical characteristics [11].
The treatment of weeds, i.e. use herbicides, only where it
is needed and not on the whole field, will be a great
environmental and economical benefit.

1.2. Related Work

1. Introduction
1.1. Background
Increasing farm sustainability and protecting water
quality are two major goals of current agricultural
research. Total variable costs in 2002 for U.K were
within a range of £1,720/ha and £1,870/ha for main crop
potatoes, of which herbicides accounted for between 3%
and 4% of costs, fungicides accounted for about 8% of
variable costs and nematicides accounted for about 14%16% of variable costs. United States farmers applied
about $16 billion of herbicides in 2005 (The Value of
Herbicides in U.S. Crop Production: 2005 Update,
CropLife Foundation), representing a significant portion
of the variable costs of agricultural production.
Although weeds are not evenly distributed on field,
weed treatments are mostly applied with the same dose
over the entire field, while the herbicides are used more

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007

Much research has investigated strategies to control
weeds with less herbicide to reduce production costs and
to protect the environment.
A verity of visual characteristics that have been used
in plant identification can be divided into three
categories: Spectral Reflectance, Morphology and
Texture. The photosensor-based plant detection systems
[2] can detect all the green plants and spray only the
plants. A machine-vision guided precision band sprayer
for small-plant foliar spraying [3] demonstrated a target
deposition efficiency of 2.6 to 3.6 times that of a
conventional sprayer, and the non-target deposition was
reduced by 72% to 99%.
A system that could make use of the spatial
distribution information in real-time and apply only the
necessary amounts of herbicide to the weed-infested area
would be much more efficient and minimize
environmental damage. Therefore, a high spatial
resolution, real-time weed infestation detection system

seems to be the solution for site-specific weed
management.

2. Methodology
2.1 Software Development
The concept of the automated sprayer system (shown
in figure 5) includes camera, Central Processing Unit
(CPU) and two dc pumps for spraying.
The images were taken at a distance of 4 meter and at
angle of 45 degree with the ground. Agriculture fields
are selected for this type of study.
The software is developed in Matlab. A Graphical
User Interface (GUI) is developed that shows the
Original image, processed image and the result of the
proposed algorithm. The image resolution was 240 pixel
rows by 320 pixel columns.

Images are classified by Radon transform [J.Radon] is
the integral transform consisting of the integral of a
function over the set of all lines. The original
formulation of the Radon transform is as follows:

R{I}(d,φ) = ∫ I (d cosφ − s sinφ, d cosφ + s sinφ),ds
R

with the projection along the lines cl (d,φ) with the
parameterization as given in Figure 1.

2.2 Image Pre Processing
The first stage of feature extraction algorithms is preprocessing operation to segment all weeds from the
background.
To distinguish weeds from background objects in a
color image, a color segmentation image-processing step
is conducted where objects are classified into one of two
classes (weed and background) by their color difference
in red, green and blue color space. Meyer el al. (1998)
indicated that weeds in field images must be carefully
segmented; otherwise the feature extraction will yield
unreliable results from analyzing soil and weeds. Thus,
adequate image segmentation quality is necessary. One
simple technique for separating pixels into weed or
background class is to calculate an offset excessive green
(OEG) value from the RGB image. Each pixel in the
RGB image is replaced with the following calculated
value:
OEG = 128 + (G – B) + (G – R)
(1)
Where R, G, B are red, green, and blue intensities of a
pixel respectively.
After the OEG image is generated, a threshold value
is selected, based on the color differences, to separate
weeds and the background.

Figure 1: The normal parameterization of a line.
Hence Cl is a line in two dimensions having distance

d from the origin, through the normal to the origin and at
the angle

φ

along x-axis and the line.

The Radon Transform mostly used in tomography,
X-Rays, CT Scans. The Radon transform can also be
used for shape detection. Radon Transform in two
dimensional plan is the integral of a function over the set
of all lines. Suppose a line represented by xcosθ + ysinθ
= s, having s as shortest distance from the line to the
origin and θ is the angle the line makes with the y-axis,

3. Radon Weed Classifier
Weeds are generally green in color, having highly
irregular leaf shape, and an open plant structure which
makes it very challenging to be recognized in the field.
To identify weeds and classify them into one of two
classes i.e. broad and narrow, we need feature extraction
algorithm to be developed.
One of the first stages in image analysis especially for
morphological image classification is the feature
extraction, such as lines, edges, curves or simple
textures, from an image. In this paper we classify images
by use of curve detection.

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007

Figure 2: Geometry of the Radon Transform.
To extract a threshold value, Radon Transform is
applied on canny edge detected image of grayscale of

original weed image. An economic chemical application
threshold based on sum of intensities of detected curves
was considered in the simulation test since information
about weed numbers in unit area and average weed size
(age) could be used to make the decision to skip some
low weed density control zones or to decide between
multiple application rates for different weed infestation
levels.

[6]

[7]

4. Results and Discussion
Figure 3 and 4 shows the original, grayscale, canny
edge detected image and resultant graphs. The
algorithms give 100% accuracy to detect the presence or
absence of weed coverage for areas where weeds are
detected; results show over 93.5% classification
accuracy over 200 sample images with 100 samples from
each class as shown in Table 1. The results obtained for
different distance under a constant threshold value favor
a selected height for more promising results. It is evident
that from Table 2 that distance of 4 meter shows good
results. Thus an optimum height becomes a requirement
for data extraction.

5. Conclusion
A real-time weed control system is developed and
tested in the lab for selective spraying of weeds using
vision recognition system. In this paper, feature
extraction based system for weed classification and
recognition is developed. The system shows an effective
and reliable classification of images captured by a video
camera.

6. Future work
In this paper weed image, which has one dominant
weed species can be classified reasonably accurate. But
the case of more than one weed classes cannot be
accurately classified. Further research is needed to
classified mixed weeds. One way is to break the image
into smaller region. With smaller region, there will be
less possibility to find more than one weed classes in this
small region.

7. References
[1]
[2]

[3]
[4]
[5]

J.Bernd, 1991. Digital image processing concepts,
algorithms and scientific applications. Berline:
Springer-Verlage.
D.E.Guyer, G.E.Miles, M.M. Shreiber, O.R.Mitchell,
and V.C.Vanderbilt, 1986. Machine vision and image
processing for plant identification. Transactions of
the ASAE 29(6): 1500-1507.
J. E.Hanks 1996. Smart sprayer selects weeds for
elimination. Agricultural Research. 44(4): 15.
R.M.Haralick, K.Shanmugam, and I.Dinstein, 1973.
Features for images classification. IEE Transactions
on systems, man, and cybernetics. 3:610-621.
B.L.Steward, and L.F. Tian. 1998. Real-time weed
detection in outdoor field conditions. In proc. SPIE

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007

[8]
[9]

[10]

[11]

3543, Precision Agriculture and Biological Quality,
eds. G.E. Meyer and J.A. DeShazer, 266-278.
Bellingham, Wash.:SPIE.
L.F.Tian, and D.C.Slaughter, 1998. Environmentally
adaptive segmentation algorithm for outdoor image
segmentation. Computers and Electronics in
Agriculture 21(3): 153-168.
Gareth Loy and Alexander Zelinsky 2003. R Fast
Radial Symmetry for Detecting Points of Interest.
IEEE Transactions on Pattern Analysis and Machine
Intelligence, VOL. 25, NO. 8.
G.Naghdy, J. wang, and P. Ogunbona. 1996. Texture
analysis using Gabor wavelets. IS&T/SPIE Symp.
Electronic Imaging. Proc. SPIE 2657: 74-85
J.S.Weszka, C.R. Dyer, and A. Rosenfeld. 1976. A
comparative study of texture measures forterrain
classification. IEE Transactions on systems, man,
and cybernetics 6: 269-285
D.M Woebbecke, G.E. Meyer, K. Von Bargen, and
D.A. Mortensen. 1995b. Shape features for
identifying weeds using image analysis. Transactions
of the ASAE 38(1): 271-281.
Franz, E., Gebhardt, M.R. & Unklesbay, K.B. 1991.
The use of local spectral properties of leaves as an
aid for identification weed seedlings in digital
images. Transactions of the American Society of
Association Executives 32(2): 682-687

Table 1: Results of the Weed Classifier
Weeds Type

Results found correct %

Broad Weeds

94%

Narrow Weeds

93%

No or Little Weeds

100%

Table 2: Classification Accuracies using Variable
Camera Distance
Camera
Distance

Broad
Weeds

Narrow
Weeds

3 meter

Presence
or
Absence
100%

80%

75%

4 meter

100%

94%

93%

5 meter

100%

73%

70%

Figure 3: Results of Radon Transform Based Weed Classifier on Broad Weed Image

Figure 4: Results of Radon Transform Based Weed Classifier on Narrow Weed Image

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007

Camera

CPU

Parallel Port

Parallel Port

Decision Box

Output Port

Solid State Relay

Sprayer

Figure 5: Flow Chart of Sprayer System

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007


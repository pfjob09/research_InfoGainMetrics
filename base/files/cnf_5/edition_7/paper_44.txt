Constrained C1 Interpolation on Rectangular Grids
E.S. Chan, V.P. Kong, B.H. Ong
School of Mathematical Sciences, Universiti Sains Malaysia, 11800 Penang, Malaysia
{ceshm@hotmail.com, kongvp@hotmail.com, bhong@cs.usm.my}
Abstract
This paper is concerned with the range restricted
interpolation of data on rectangular grids. The
interpolant is constrained to lie on the same side of the
constraint surface as the data. Sufficient non-negativity
conditions on the Bézier ordinates are derived to ensure
the non-negativity of a bicubic Bézier patch. The method
modifies Bézier ordinates locally to fulfill the sufficient
non-negativity conditions. The C1 interpolating surface is
constructed piecewise as a convex combination of two
bicubic Bézier patches with the same set of boundary
Bézier ordinates. The set of admissible constraint
surfaces include polynoimal surfaces of the form z = C(x,
y) where C(x, y) = ∑i3=0 ∑ 3j = 0 ai , j xi y j and the ai,j are real
numbers, as well as C1 spline surfaces consisting of
polynomial pieces of the form z = C(x, y) on the
rectangular grid.
Some
graphical examples are
presented.

1. Introduction
The problem of positivity preserving interpolation is of
practical interest. Physical quantities like concentration
when represented visually should not admit negative
values since negative values are physically meaningless.
A number of works have been done for the univariate case
but not much has been done for the more general problem,
range restricted interpolation for both the univariate and
bivariate cases. As we are concerned with the constrained
bivariate interpolation to data on a rectangular grid, we
mention some of the work done in this respect. Mulansky
and Schmidt [5] present a non-negative interpolation to
gridded data by C1 biquadratic splines on a refined
rectangular grid. They derive sufficient non-negativity
conditions on the first partial derivatives and mixed
second partial derivatives by using the corresponding
results for the univariate quadratic splines with additional
knots [4] and the tensor product structure for the spline
space. There exist an infinite number of interpolants
meeting the constraints. The selection of the interpolant is
based on a fit-and-modify approach or the minimization
of a suitable objective functional.

Brodlie, Butt & Mashwama [1] construct C1 bicubic
splines on rectangular grids addressing the problem of
generating interpolants subject to linear constraints as
lower and upper bounds. The results of Schmidt and Heß
[6] for the univariate case are used to derive sufficient
non-negativity conditions on the first partial derivatives
and second mixed partial derivatives. These derivatives
are estimated and the estimated values are projected onto
the valid intervals defined by the sufficient non-negativity
conditions. This interpolation method is local.
In [7] a local C1 scheme for interpolating data on a
rectangular grid subject to lower and upper constant
bounds has been constructed. The interpolant is piecewise
an average of two blending surfaces, each being obtained
by blending between two boundary curves of the patch by
using univariate rational cubics. The weights of the
rational cubics are chosen to ensure that the blending
surfaces lie within the given bounds.
In this paper the construction of range restricted
bivariate C1 interpolants to data on a rectangular grid is
considered. We derive in Section 2 sufficient conditions
on the Bézier ordinates to ensure non-negativity for a
bicubic Bézier patch by using the univariate result on nonnegativity in [3] and some simple observations. A local
scheme applying these sufficient non-negativity
conditions for C1 non-negativity preserving interpolation
is constructed in Section 3. The interpolating surface is
obtained piecewise as the convex combination of two
bicubic Bézier patches, each with the same set of
boundary Bézier ordinates. In Section 4, we extend the
results to range restricted interpolation which considers as
lower and upper constraints polynomial surfaces of the
form C ( x, y ) = ∑i3=0 ∑ j =0 a i , j x i y j , where the ai,j are real
numbers, as well as C1 spline surfaces consisiting of
polynomial pieces of the form z = C(x, y) on the
rectangular grid. Two numerical examples are presented
graphically in the last section.

2. Sufficient non-negativity conditions for a
bicubic Bézier patch
A bicubic Bézier patch is defined as
P(u, v) = ∑i3= 0 ∑3j = 0 bi , j Bi3 (u ) B3j (v) , u, v ∈ [0, 1], (2.1)

Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIV’04)
0-7695-2178-9/04 $20.00 © 2004 IEEE

where Bk3 are cubic Bernstein polynomials and bi,j are the
Bézier ordinates of P. Consider a unit square with vertices
U1, U2, U3 and U4. Given positive Bézier ordinates at the
vertices, i.e. we may assume
{b0,0, b3,0, b0,3, b3,3} = { α l, β l, γ l, l },

(2.2)

with l > 0 and α ≥ β ≥ γ ≥ 1, our aim is to derive
sufficient conditions on the remaining Bézier ordinates for
the Bézier patch to be non-negative.
e2
U4
U3
e3
U1

P(u , s)
e1

U2

Figure 1. Notation on a rectangle.
Denote the edges along U1U2, U4U3, U1U4 and U2U3
by e1, e2, e3 and e4 respectively (see Figure 1). A curve on
P along a line segment parallel to e1 is given by
u ∈ [0, 1], (2.3)

where s is a constant between 0 and 1. Observe that for
each fixed s, P (u , s ) , u ∈ [0, 1], is a cubic Bézier curve
with

∑3j =0 bi , j B3j ( s) ,

i = 1, 2, 3 as the Bézier ordinates.

Clearly, if all these curves are non-negative, then the
patch P(u, v) is non-negative. Similarly, a curve on P
along a line segment parallel to e3 is given by
P(t, v) =

∑3i = 0 ∑3j = 0 bi , j Bi3 (t ) B3j (v) ,

v ∈ [0, 1],

–27 λ2 a4 + 108 λ2 a3 + (288 λ – 162 λ2) a2
+ (108 λ2 – 320 λ + 256) a – 27 λ2 + 32 λ = 0,

(2.7)

then P(u, v) ≥ 0, ∀ u, v ∈ [0, 1].

Proof In view of (2.6), in order that the four boundary
curves P(u, 0), P(u, 1), P(0, v), P(1, v) are positive, it
suffices to have b1,0, b2,0, b1,3, b2,3, b0,1, b0,2, b3,1, b3,2 ≥
– l / 3a , a > 1. Without loss of generality, we may assume
b0,0 = l. We shall distinguish two cases.
(i) when b3,3 = γ l (i.e. l and γ l are at diagonal vertices)
(ii) when b3,3 ≠ γ l (i.e. l and γ l are at adjacent vertices).
For case (i), we consider a curve along a line segment
parallel to e1 which is given by (2.3). We will derive
conditions for the curve in (2.3) to be non-negative. Let

e4

P(u, s) = ∑3i = 0 ∑3j =0 bi , j Bi3 (u ) B3j ( s ) ,

If b1,0, b2,0, b1,3, b2,3, b0,1, b0,2, b3,1, b3,2, b1,1, b2,1, b1,2, b2,2
≥ – l / 3a , where a is the smallest solution in (1, 5] of

(2.4)

where t is a constant between 0 and 1.
Based upon Theorem 1 quoted from [3] and some
simple observations below we derive our sufficient nonnegativity conditions in Proposition 1.

Theorem 1 Let r(x) = A(1–x)3 + 3B(1–x)2x + 3C(1–x)x2 +
Dx3, x ∈ (0, 1), where A, D > 0, and B < 0 and /or C < 0 .
Then r(x) < 0 for some x ∈ (0, 1) [resp. r(x) = 0 for only
one point in (0, 1)] if and only if
3B2C2 + 6 ABCD – 4(AC3 + B3D) – A2D2 >0 [resp. = 0].
(2.5)
Denote ∆ = 3B2C2 + 6 ABCD – 4(AC3 + B3D) – A2D2.
Observe that if A, D > 0, B = –A/3 and C = –D/3, then
∆ = 4AD(A–D)2. Thus in this case if A ≠ D , then r(x) as
defined above will be negative for some x ∈ (0, 1).
However if min{A, D} = l > 0, B = C = – l / 3a ,
where a >1, then r(x) ≥ l( a − 1) / 4a , ∀ x∈[0, 1]. (2.6)

∑3j =0 b0, j B3j (s) , B(s) = ∑3j = 0 b1, j B3j (s) ,
C(s) = ∑3j = 0 b2, j B3j ( s ) and D(s) = ∑3j = 0 b3, j B 3j ( s ) ,
A(s) =

then (2.3) becomes
P(u, s) = (1–u)3A(s) + 3(1–u)2uB(s)
+ 3(1–u)u2C(s) + u3D(s).

(2.8)

(2.9)

Observe that A(s) ≥ l( a − 1) / 4a , D(s) ≥ γ l(a − 1) / 4a ,
B(s), C(s) ≥ – l / 3a , 0 ≤ s ≤ 1. By Theorem 1, in order for
P(u, s) ≥ 0, it suffices to have
3B2C2 + 6ABCD – 4(AC3 + B3D) – A2D2 = 0,

D = γ l(a − 1) / 4a
and
A = l(a − 1) / 4a ,
B = C = −l / 3a . That is, it suffices to have f(a) =0 where

where

f(a) = –27γ 2a4 + 108γ 2a3 + (288γ – 162γ 2)a2
+ (108γ 2 – 320γ + 256)a – 27γ 2 + 32γ.
Observe that f(1) = 256 > 0 and f(5) ≤ 0, thus there exists
a0 ∈ (1, 5] with f(a0) = 0. If there exists more than one a0,
then the smallest one in (1, 5] is chosen.
For case (ii) where b3,3 ≠ γ l, there are two
possibilities; either b3,0 = γ l or b0,3 = γ l. When b3,0 = γ l,
we consider again a curve along a line segment parallel
to e1 which is given by (2.9). Then we know A(s) ≥
l( a − 1) / 4a , D(s) ≥ βl( a − 1) / 4a , B(s), C(s) ≥ – l / 3a ,
s ∈ [0, 1]. For P(u, s) ≥ 0, it suffices to have a satisfying
– 27β 2a4 + 108β 2a3 + (288β – 162β 2)a2
+ (108β 2 – 320β + 256)a – 27β 2 + 32β = 0.

(2.10)

u,

When case (ii) occurs with b3,0 = γ l, the same argument
above is repeated by considering a curve along a line
segment parallel to e3 and we will also obtain (2.10).

v ∈ [0, 1], where {b0,0, b3,0, b0,3, b3,3} is as given in (2.2).
Let λ = γ if l and γ l are values at the diagonal vertices,
otherwise λ = β .

Suppose now the boundary Bézier ordinates have
already been determined by using the derivatives defined
at the vertices and their values have been ensured to be

Proposition 1 Let P(u, v) =

∑3i = 0 ∑3j = 0 bi, j Bi3 (u ) B3j (v) ,

Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIV’04)
0-7695-2178-9/04 $20.00 © 2004 IEEE

not less than the lower bound – l / 3a as stated in
Proposition 1. Then we shall derive two sets of less
stringent lower bounds for inner Bézier ordinates, i.e. a
lower bound which is less than or equal to – l / 3a
suggested in Proposition 1, by considering curves in (2.3)
and (2.4) respectively. We shall need the following lemma
which can be obtained using simple calculus.

Lemma 1 Let r(x) be as in Theorem 1.
(i) Suppose A = 0 and D > 0.
For r(x) ≥ 0, it is necessary that B ≥ 0.
If C < 0, then r(x) ≥ 0 if and only if B ≥ 0 and 3C2 ≤ 4BD.
(ii) Suppose A > 0 and D = 0.
For r(x) ≥ 0, it is necessary that C ≥ 0.
If B < 0, then r(x) ≥ 0 if and only if C ≥ 0 and 3B2 ≤ 4AC.
(iii) If A = D = 0, then r(x) ≥ 0 if and only if
B ≥ 0 and C ≥ 0.
Let us first consider P as a surface consisting of curves
along line segments parallel to e1, i.e. curves P(u, s) as
given by (2.3). These are cubic Bézier curves with Bézier
ordinates given by A(s), B(s), C(s) and D(s) as in (2.8). As
all the Bézier ordinates for A(s) and D(s), s ∈ [0, 1] are
already fixed, the minimum values A and D respectively
for A(s) and D(s), s ∈ [0, 1], can be easily obtained.
Suppose that B(s) ≥ B, C(s) ≥ C for s ∈ [0, 1] and B =
C, we would like to find an optimum negative value for B
and C by using Theorem 1 so that P(u, v) ≥ 0 for u, v ∈
[0, 1] and then by using B and C to determine a less
stringent lower bound for the inner Bézier ordinates.
By Theorem 1, for P(u, s) ≥ 0 it suffices to have
3 B2 C2 + 6 ABCD – 4 ( AC3 + B3D ) – A2 D2 = 0.
This equation is solved for B and C with B = C. Observe
that B, C ≤ – l / 3a .
The lower bound for b1,1 and b1,2 is obtained from the
relation B(s) ≥ B, i.e. (1–s)3 (b1,0 – B) + 3(1–s)2s (b1,1 –
B) + 3(1–s)s2 (b1,2 – B) + s3 (b1,3 – B) ≥ 0. Let b1,1 – B =
b1,2 – B = m1. As b1,0, b1,3 ≥ – l / 3a , then (b1,0 – B) ≥ 0
and (b1,3 – B) ≥ 0 . For the case (b1,0 – B) > 0 and (b1,3 –
B) > 0, by Theorem 1, in order that B(s) – B ≥ 0 it
suffices to have
3 m14 + 6 m12 (b1,0 – B) (b1,3 – B) – 4 m13 [(b1,0 – B) +
(b1,3 – B)] – (b1,0 – B)2 (b1,3 – B)2 = 0.
This equation is solved for the value of m1 which is
negative. For the other three cases, i.e. (b1,0 – B) = 0 and
(b1,3 – B) > 0, (b1,0 – B) > 0 and (b1,3 – B) = 0, (b1,0 – B)
= 0 and (b1,3 – B) = 0, by Lemma 1, in order that B(s) – B
≥ 0 it suffices to have m1 = 0. Thus B(s) – B ≥ 0 if b1,1
≥ kB and b1,2 ≥ kB , where kB = m1 + B and m1 ≤ 0.
Similarly the lower bound kC for b2,1 and b2,2 is
obtained from the relation C(s) ≥ C, i.e. (1–s)3(b2,0 – C) +
3(1–s)2s(b2,1 – C) + 3(1–s)s2(b2,2 – C) + s3(b2,3 – C) ≥ 0.

We conclude that by ensuring b1,1 ≥ kB, b1,2 ≥ kB, b2,1 ≥ kC
and b2,2 ≥ kC, then P(u, s) ≥ 0, ∀ u, s ∈ [0, 1].
In order to obtain the second set of lower bounds, we
consider P as a set of curves along line segments parallel
to e3, i.e. curves of the form given by (2.4). By repeating
similar arguments as above, we obtained lower bounds lB
and lC such that by ensuring b1,1 ≥ lB, b2,1 ≥ lB, b1,2 ≥ lC
and b2,2 ≥ lC , then P(s, v) ≥ 0, ∀ s, v∈[0,1].
Hence, P(u, v) ≥ 0, ∀ u, v ∈ [0, 1] by ensuring
b1,1 ≥ h1, b1,2 ≥ h2, b2,1 ≥ h3, b2,2 ≥ h4

(2.11)

where h1, h2, h3, h4 are given by one of the following two
sets, Q = { h1 = kB, h2 = kB, h3 = kC, h4 = kC } or T = { h1
= lB, h2 = lC, h3 = lB, h4 = lC }. Either of these sets of
lower bounds could be used.
Observe that indeed h1, h2, h3, h4 ≤ – l / 3a and so they
are less stringent lower bounds for the inner Bézier
ordinates than the one stated in Proposition 1.

3. Generation of non-negativity preserving
interpolating surface
Given functional values { fp,q } at the grid nodes
Vp,q(xp, yq) of a rectangular grid with fp,q > 0, 0 ≤ p ≤
m, 0 ≤ q ≤ n, where p, q are positive integers and x0
< x1 < . . . < xm, y0 < y1 < . . . < yn. We would like to
construct an interpolating C1 non-negativity preserving
functional surface S(x, y) through all the fp,q.
To construct the interpolating surface S, first we define
S(xp, yq) = fp,q, p = 1, , m , q = 1, , n . The partial
derivatives Sx and Sy at each grid node are estimated by
using the three points difference approximation. The twist
at each grid node is estimated by using Adini’s twist [2].
Though the resulting surface is dependent upon the
derivative estimation method, we shall focus on the
generation of the non-negative surface patches.
On each rectangle in the domain, S will be constructed
as a convex combination of two bicubic Bézier patches.
These two bicubic Bézier patches, denoted as P1 and P2,
will have the same set of boundary Bézier ordinates but
they may have different inner Bézier ordinates. Denote
the edges of the rectangle under consideration as e1, e2, e3
and e4 (see Figure 1). These patches are constructed such
that P1 is C1 with its adjacent patches along the common
boundaries e3 and e4 while P2 is C1 with its adjacent
patches along the common boundaries e1 and e2 . Let the
bicubic Bézier rectangular patches Pk, k = 1, 2 be given as
Pk(u, v) = ∑i3= 0 ∑3j = 0 bik, j Bi3 (u ) B3j (v) , u, v ∈ [0, 1].

L

L

It suffices just to consider the patch P1 since P1 and P2
are constructed in the same manner. The Bézier ordinates
b01,0 , b11, 0 and b01,1 are given by
b01,0 = P1(0, 0) = S(Vp,q) = fp,q,

Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIV’04)
0-7695-2178-9/04 $20.00 © 2004 IEEE

1 ∂P1
(0, 0)
3 ∂u
1
= S(Vp,q) + ( xp+1,q – xp,q)
3
1 ∂P1
= P1(0, 0) +
(0, 0)
3 ∂v
1
= S(Vp,q) + ( yp,q+1 – yp,q)
3

b11,0 = P1(0, 0) +

b01,1

∂S
(Vp,q),
∂x

∂S
(Vp,q)
∂y

where Vp,q, Vp+1,q, Vp+1,q+1, Vp,q+1 are the vertices of the
domain rectangle under consideration. All the bi1, j (except
b11,1 , b11, 2 , b21,1 , b21, 2 ) are similarly determined.

With these Bézier ordinates, the resulting Bézier patch
may not ensure non-negativity. In view of Proposition 1,
we shall impose upon these boundary Bézier ordinates the
condition bi,j ≥ – l / 3a , where l = min {S(Vp,q), S(Vp+1,q),
S(Vp+1,q+1), S(Vp,q+1)} and a as described by (2.7). This is
achieved by modifying the partial derivatives at the
vertices if necessary. The derivatives Sx and Sy at a vertex
are modified by scaling each of them with a positive
factor α < 1. The scaling factor α is obtained by taking
into account all the rectangular patches sharing that
vertex.
G

H
4
O

A

.

2
C

derivatives for Pk . For example, b1k,1 is given by
1 ∂ 2 Pk
(0, 0) + b1k, 0 + b0k,1 – b0k,0
9 ∂u∂v
∂ 2S
1
(Vp,q)
= (xp+1,q – xp,q) ( yp,q+1 – yp,q)
∂x∂y
9

b1k,1 =

E

(x p , yq )

1
B

F
3

1 , α1
Then we define α1 = min { α OA
OC }. α2 , α3 and α4
are similarly defined for rectangles 2, 3 and 4
respectively. Lastly, in order to fulfill the non-negativity
preserving conditions stated in Proposition 1 for all the
boundary Bézier ordinates adjacent to O, we choose
αO = min { α1, α2, α3, α4 }.
For the boundary node U which belongs to one or two
rectangles of the rectangular grid, αU is defined in a way
similar to that for a node shared by four rectangles. The
only difference is that we consider only one or two
rectangles instead of four.
If at any node O, αO < 1, then the x and y partial
derivatives at O are redefined as αO times the
corresponding initial values and the Bézier ordinates
adjacent to O in each rectangle are redetermined by using
the modified derivatives Sx(O) and Sy(O). The boundary
Bézier ordinates of all the Bézier patches are determined
by repeating the above process at all the nodes Vi,j.
Now to define the inner Bézier ordinate bWk , for Pk, k
= 1, 2 where W ∈ { (1, 1), (1, 2), (2, 1), (2, 2) }, initial values
for bWk are determined by the mixed second order partial

D

Figure 2. Vertex O with its associated
rectangles.
Consider the four rectangles which share vertex Vp,q(xp,
yq). For simplicity, we denote the vertex Vp,q as O and its
adjacent vertices as A, B, C, D, E, F, G, H respectively
(see Figure 2).
1
For rectangle 1, α OA
is defined as follows. If
1 ∂S
l
S(O) –
(O) (xp – xp–1) ≥ – 1 ,
3a1
3 ∂x

+ b1k, 0 + b0k,1 – S(Vp,q)
and the expressions for b2k,1 , b1k, 2 and b2k, 2 are similar.
These initial values for the inner Bézier ordinates are
the same for both patches P1 and P2. However the
resulting Bézier patch with these inner Bézier ordinates
may not ensure non-negativity. We modify the inner
Bézier ordinates if necessary in order to ensure the
surface patch Pk is non-negative and is C1 across two of
the boundaries of the rectangle. It suffices to describe the
determination of the inner Bézier ordinates for P1.

where l1 = min {S(O), S(A), S(B), S(C)} and a1 is as
1
described by (2.7) for rectangle 1, then α OA
= 1,
1
is defined by the equation
otherwise α OA
1 1 ∂S
l
S(O) – α OA
(O) (xp – xp–1) = – 1 .
∂
x
3a
3
1
1 , if
Similarly for the scalar α OC
l
1 ∂S
S(O) –
(O) (yq – yq–1) ≥ – 1 ,
3 ∂y
3a1
1
1
= 1, otherwise α OC
is given by the equation
then α OC
l
1 1 ∂S
S(O) – α OC
(O) (yq – yq–1) = – 1 .
∂y
3a1
3

V p , q +1

V p −1, q +1

V p +1, q +1

a12, 2

a 31, 2 = b01, 2

b11, 2

a 12,1

a 31,1 = b01,1

b11,1

V p −1, q

V p,q

V p +1, q +1

Figure 3. Two adjacent rectangular patches.
Consider two adjacent bicubic patches Q1 and P1 with
Bézier ordinates ai1, j and bi1, j respectively (see Figure 3).
With a 31, j = b01, j ,

j = 0, 1, 2, 3, the necessary and

sufficient conditions for C1 continuity along the
boundaries Vp,qVp,q+1 where p ≠ 0 and p ≠ m are

Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIV’04)
0-7695-2178-9/04 $20.00 © 2004 IEEE

b11, j = b01, j + h p ( a 31, j – a 12, j ) / h p −1 ,

(3.1)

where hk = xk+1 – xk , k = p–1, p, j = 0, 1, 2, 3. Observe
that the cases j = 0 and j = 3 in (3.1) will be
automatically fulfilled since the Bézier ordinates adjacent
to Vp,q and Vp,q+1 are determined by using the x and y
partial derivatives at the corresponding vertices.
If a 12,1 < h3Q while b11,1 ≥ h1P , where h3Q and h1P are
the lower bounds obtained in (2.11) for a 12,1 and b11,1
respectively. We reset a12,1 to be equal to h3Q and make an
adjustment to b11,1 according to (3.1). For the other case
when b11,1 < h1P while a12,1 ≥ h3Q , we reset b11,1 equal to
h1P and adjust a12,1 according to (3.1) in order that the two
adjacent patches are C1 along common boundary. Observe
that the case where a 12,1 < h3Q and b11,1 < h1P will never
occur. Indeed if a 12,1 < h3Q , then a 12,1 < b01,1 , and in order
that the C1 condition holds, we have b11,1 ≥ b01,1 ; hence b11,1
≥ h1P . Using the same argument, we examine a 12, 2 and
b11, 2 , and modify if necessary.
Along the boundary V0,qV0,q+1, inner Bézier ordinates
adjacent to it are determined by ensuring that they satisfy
(2.11). We determine inner Bézier ordinates adjacent to
boundary Vm,qVm,q+1 in same manner.
The inner Bézier ordinates for the patch P2 on each
rectangle are determined in a similar way, so that P2 is
non-negative and C1 with its adjacent patch across the
common boundaries e1 and e2. The interpolating surface
patch P on the rectangle is defined as a convex
combination, that is P = c1P1 + c2P2 where
c1 = v2(1–v)2 / ( u2(1–u)2 + v2(1–v)2 ),
c2 = u2(1–u)2 / ( u2(1–u)2 + v2(1–v)2 ).

L

L

L

they are modified if necessary so that the sufficient nonnegativity conditions are fulfilled and the construction of
G proceeds as in Section 3. As the non-negativity
preserving interpolating surface G is piecewise a convex
combination of bicubic Bézier patches, thus so is S.
The arguments above have also been extended to
admit constraint which is a C1 piecewise polynomial
surface consisting of polynomial pieces of the form in
(4.1) on the rectangular grid.

5. Numerical examples

c1 and c2 ensure that P = P1 and ∂P / ∂u = ∂P1 / ∂u on e3
and e4, P = P2 and ∂P / ∂v = ∂P2 / ∂v on e1 and e2. Hence
P interpolates all the given data at the vertices of the
rectangle and is C1 across all its boundaries. The
interpolating surface S is the composite surface
defined as S | R = PR , where R is a rectangle in the
domain and PR is the patch constructed as described
above on the rectangle R. Thus S is a non-negativity
preserving C1 surface interpolating the given data.

4. Generation of range restricted
interpolating surface
We would like to extend our scheme for a larger set of
constraints besides the plane z = 0. We consider the
constraint surfaces of the form z = C(x, y) where
C(x, y) = ∑3i = 0 ∑3j = 0 ai , j xi y j , ai,j are real numbers

L

Given the functional data points (xi, yj, fi,j),
i = 1, , m , j = 1, , n , lying on one side of the
constraint surface z = C(x, y). We would like to generate a
C1 interpolating surface z = S(x, y) which lies on the same
side of the given constraint surface as the data.
Suppose that the data points lie above the constraint
surface. The partial derivatives Sx, Sy and Sxy at (xi, yj) are
estimated as in Section 3. Let G(x, y) = S(x, y) – C(x, y).
A new set of data points (xi, yj, fi,j*), i = 1, , m ,
j = 1, , n , is derived from the original data set and the
constraint function C(x, y) by letting fi,j* = fi,j – C(xi, yj).
Then the construction of the C1 interpolating function S(x,
y) subject to the constraint surface z = C(x, y) is reduced
to the construction of the function G(x, y) so that it is nonnegative and C1, with G(xi, yj) = fi,j*. With the initial
partial derivatives of G as
Gx(xi, yj) = Sx(xi, yj) – Cx(xi, yj),
Gy(xi, yj) = Sy(xi, yj) – Cy(xi, yj),
Gxy(xi, yj) = Sxy(xi, yj) – Cxy(xi, yj),

(4.1)

because C(x, y) can be expressed as a bicubic Bézier
patch on each rectangle in the domain.

We shall illustrate the range restricted interpolation
scheme with two numerical examples. The linear
interpolant to the test data of the first example is shown in
Figure 4. The given data lie between the constraint planes
z = 6.51 and z = –0.01. The unconstrained interpolating
surface which is piecewise a convex combination of two
bicubic Bézier rectangular patches is shown in Figure 5. It
oscillates and crosses the upper and lower bounding
planes. The range restricted interpolating surface in
Figure 6 does not oscillate unnecessarily and it lies within
the upper and lower bounding planes.
The data of the second example sampled from the
surface z = cos xy lie above the C1 constraint surface

−0.28 x 2 − 0.3 y 2 + 0.9,
z=
3
2
2
− 0.3 x − 0.3 y + 0.166 x + 0.9,

( x, y ) ∈ [−2.5, 0] × [ −2.5, 2.5]
.
( x, y ) ∈ [0, 2.5] × [ −2.5, 2.5]

Figure 7 shows the linear interpolant. The unconstrained
interpolating surface has crossed the constraint surface as
shown in Figure 8 while the constrained interpolating
surface in Figure 9 stays above the constraint surface as
required.

Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIV’04)
0-7695-2178-9/04 $20.00 © 2004 IEEE

Acknowledgements
We gratefully acknowledge the financial support of the
Fundamental Research Grant.

References
[1] Brodlie K. W., Butt S. and Mashwama P. Visualization of
Surface Data to Preserve Positivity and Other Simple
Constraints. Computers and Graphics 19, 585-594, 1995.
[2] Farin G. Curves and Surfaces for Computer Aided
Geometric Design, 4th ed, Academic Press Inc., 1996.
[3] Goodman T.N.T., Ong B.H. and Unsworth K. Constrained
Interpolation Using Rational Cubic Splines. In Nurbs for Curve
and Surface Design, Farin G. (ed.), SIAM, 59 – 74, 1991.

[4] Mulansky, B. and J. W. Schmidt. Powell-Sabin Splines in
Range Restricted Interpolation of Scattered Data. Computing
53, 137 – 154, 1994.
[5] Mulansky, B. and Schmidt J.W. Nonnegative Interpolation
by Biquadratic Splines on Refined Rectangular Grids. In
Wavelets, Images and Surface Fitting, P.-J. Laurent, A. Le
Mehaute, and L. L. Schumaker (eds.), A K Peters, Wellesley,
379 – 386, 1994.
[6] Schmidt Jochen W. and Heß Walter. Positivity of Cubic
Polynomials on Intervals and Positive Spline Interpolation, Bit
28, 340 – 362, 1988.
[7] Wong Heng Cheang, Positivity Preserving Surface
Interpolation, M. Sc Thesis, Universiti Sains Malaysia, 1994.

Figure 7. The linear interpolant.
Figure 4. The linear interpolant.

Figure 5. The unconstrained interpolating
surface and the two constraint planes.

Figure 6. The constrained interpolating surface
(without displaying the upper constraint plane).

Figure 8. The unconstrained interpolating
surface and the constraint surface.

Figure 9. The constrained interpolating surface
and the constraint surface.

Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIV’04)
0-7695-2178-9/04 $20.00 © 2004 IEEE


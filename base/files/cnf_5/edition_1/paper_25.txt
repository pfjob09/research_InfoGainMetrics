2011 Eighth International Conference Computer Graphics, Imaging and Visualization

Forest smoke detection using CCD camera and spatial-temporal variation of
smoke visual patterns
JoonYoung Kwak, ByoungChul Ko, Jae-Yeal Nam
Dept. of Computer Engineering, Keimyung University, 1000 Sindang-dong, Dalseo-gu, Daegu,
704-701, Korea
{ akisama@kmu.ac.kr, niceko@kmu.ac.kr, jynam@kmu.ac.kr}
this area, where the main smoke detection methods can
be summarized as follows.
T√∂reyin et al.[1] used a Hidden Markov Model
(HMM) to mimic the temporal behavior of smoke using
the periodic behavior of smoke boundaries. In addition,
the boundaries of smoke regions are represented in a
wavelet domain, and the high frequency nature of the
boundaries of smoke regions are used as a basis for
modeling.
Yuan et al.[2] used motion information using the
upward behavior of smoke. Thus, a candidate region is
declared a smoke region if the ratio of the upward
directions against other directions is over a pre-defined
threshold.
Gubbi et al. [3] proposed outdoor smoke detection
approach based on wavelets and support vector machine.
Characterization of smoke was carried out by extracting
wavelet features from approximate coefficients and three
levels of detailed coefficients. Then binary support
vector machine is used for smoke verification.
Gonzalez et al. [4] proposed outdoor smoke
detection algorithm using a stationary wavelet transform
(SWT) to remove high frequencies on horizontal, vertical,
and diagonal details. The inverse SWT is then
implemented and finally the image is compared to a nonsmoke scene in order to determine the possible regions of
interest (ROI).
Ham et al. [5] proposed a forest-fire smoke detection
algorithm using Fuzzy Finite Automata (FFA) and
spatial-temporal visual features. Using the key-frame
difference and Gaussian Mixture Color Model, candidate
smoke blocks are extracted more accurately. For smoke
verification, three two-dimensional PDFs estimated from
the average and entropy of the intensity, the average and
skewness of wavelet, and motion information are then
applied to the FFA.
The remainder of this paper is organized as follows.
Section 2 describes the detection of candidate smoke
blocks using the key-frame difference and spatialtemporal visual feature extraction is introduced in
Section 3. The smoke-block verification using random
forest is then introduced in Section 4. Section 5 evaluates

Abstract
This paper proposes a new forest smoke detection
method using spatial-temporal visual features extracted
from camera images and a pattern classification
technique. First, moving regions are detected by
analyzing the frame difference between two consecutive
key frames. Since smoke regions generally have a similar
color, simple texture, and upward motion, the intensity,
wavelet coefficients, and motion orientation are
extracted as visual features. In addition, random forests
are constructed using training data and then used for
smoke verification process with four smoke classes. The
proposed algorithm is successfully applied to various
forest smoke videos and shows a better detection
performance when compared with other methods.
Keywords: forest smoke, spatial-temporal visual
feature, key frame, random forest, ensemble trees

1. Introduction
With the rapid increase in natural disasters caused
by environmental disruption, new engineering solutions
are needed for automatic warning and safety systems. In
particular, the increasing occurrence of large-scale fires
across the world has created an urgent need for research
on automatic fire detection as an early warning system.
In general, since smoke appears before flames,
sensors that can detect smoke are required for early fire
warning systems. In the case of forest smoke,
conventional sensors such as infrared sensors, optical
sensors, or ion sensors cannot detect smoke due to the
extended distance between the sensors and the burning
point. Therefore, current studies [1-5] have investigated
the use of CCD cameras to overcome the drawbacks of
traditional sensors and provide dependable smoke
detection results. Despite the clear importance of forest
smoke detection, there have only been a few studies in

978-0-7695-4484-7/11 $26.00 ¬© 2011 IEEE
DOI 10.1109/CGIV.2011.40

141

frames to consider the feature variation and reduce the
feature dimension.
Furthermore, as high frequency information is not
sensitive to lighting changes or more prominent features,
to discriminate a forest smoke from a smoke-colored
object, the average of wavelet energy and skewness of
the wavelet energy is computed from candidate smoke
blocks using a linear combination of high frequency
coefficients after a Daubechies wavelet transform.
Third, smoke tends to continuously move upward
because of heat convection; hence, the motion
orientation is estimated between the current and previous
key frames. After estimating the motion for each block
(b), the orientation of the motion is discretized into eight
directions, and each discrete direction is coded as 1‚Äì8,
respectively according to our previous study [6].
The final dimension of the feature vector for one
block is 5. The final feature vector is normalized to unit
length using the Gaussian normalisation method.

the accuracy and applicability of the proposed smoke
detection method based on experiments, and some final
conclusions and areas for future work are presented in
Section 6.

2. Detection of candidate smoke block
In this research, the images are divided into 32x24
blocks for real-time processing. Unlike indoor smoke,
forest smoke has a relatively slow spreading speed, as
the surveillance cameras for detecting smoke are
installed at extended distances. Therefore, a general
frame difference cannot detect moving regions in the
case of a forest smoke. Thus, to overcome this problem,
key-frames are selected from a video sequence whenever
the frame differencing is over a certain threshold ( T 1 ).

if ( Kframe [ k ]  frame [i ] ! T1 )
Then

Kframe [ k  1]

frame [i ];

(1)

k  ; i  ;

4. Smoke block verification using random
forests

Else i  ;
where T 1 is an adjustable parameter according to the
application. Using the new key-frame Kframe [k+1] and
previous key-frame Kframe [k], a block ( Bb ) at position

A random forest is a decision tree ensemble
classifier with each tree grown using some type of
randomization. Random forest has the capacity to
process huge amounts of data with high training speeds
based on a decision tree [7].
In the training procedure, the random forest starts by

b in the current key-frame is declared as a moving block
using the following formula:
Bb

¬≠¬∞1
¬Æ
¬∞¬Ø0

¬¶ Kframe[k ](x, y)  Kframe[k  1](x, y) ! T

( x , y )¬èb

2

(2)

choosing a random subset I c from the training data I .
At node n, the training data I n is iteratively split into

Otherwise
(k t 1)

left and right subsets I l and I r by using the threshold

After detecting the candidate smoke blocks, the
image is scanned to group the blocks into clusters based
on block connectivity using morphological closing.

and split function. After training of the random forest,
the test candidate blocks are applied to the trained
random forest. The final class distribution is generated
by an ensemble of each distribution of all trees L = ( l1 ,

l2 ,‚Ä¶, lT ) using equation (3). In equation (3), T is the
number of trees, and we choose ci as the final class f of
an input block if the average of P(ci | lt ) has the maximum
value.
Figure 1. Candidate smoke blocks after moving
block detection using key frames

f

¬≠1 T
¬Ω
max ¬Æ ¬¶ P(ci | lt )¬æ
i 1 to 4 T
¬Ø t1
¬ø

(3)

3. Spatial-temporal visual feature extraction
In this paper, the four smoke classes are defined as
VH, H, L, and VL, and these classes correspond to ‚Äúvery
high,‚Äù ‚Äúhigh,‚Äù ‚Äúlow,‚Äù and ‚Äúvery low,‚Äù respectively.
These classes mean the possibility of fire smoke.
As shown in Figure 2, if the maximum value for
smoke classes indicates class VH or H and it is over the
predefined minimum threshold, the candidate block is
declared a real fire-flame block.

Smoke regions generally have a higher intensity and
frequency than the background as well as an upward
motion with irregular fluctuation patterns in the time
domain [6]. Thus, to consider the above characteristics
over time, the variations in the intensity, wavelet energy,
and motion orientation are used to generate random
forests classifier.
First, since a smoke region has a relatively higher
intensity value and little contrast, the average intensity
value and skewness are estimated from the candidate
block and its corresponding blocks in the 100 preceding

142

smoke region. As seen in Figure 3, the proposed
approach outperformed T√∂reyin‚Äôs and Ham‚Äôs method
with an average true positive rate (ATPR) of 93.2%
compared to 92.8% and 55.8%, and an average false
positive rate (AFPR) of 2.2% compared to 7.2% and
11.8%. However, an average missing rate (AMR) of
proposed method showed somewhat lower rate than
Ham‚Äôs method as 4.6% vs. 0% due to some errors of
optical flow.

Figure 2. Classification process using feature
vector with trained random forests. In this
example, the test block is classified into the
second class H because it has a maximum
posterior probability of 1.0.
Figure 3. The performance test results
between proposed method and two
comparative methods.

The decision trees of random forests are trained
using candidate blocks extracted from training video
sequences that included eight forest smoke and non
smoke videos.

In particular, T√∂reyin‚Äôs method produced a higher
MR, since it detected candidate smoke regions from
every frame using the frame difference. However, since
forest smoke moves very slowly, due to the extended
distance between the camera and location of the smoke,
many true smoke regions were missed.
As shown in Figure 3, T√∂reyin and Ham‚Äôs method
showed a higher FP rate at 11.8% and 7.2%, where the
main reason for the higher error was due to moving
smoke-colored object being confused with a fire-smoke.
However, the proposed algorithm was able to remove
above false positives using the motion orientation and
verify real smokes using the random forest classifiers.
Figure 4 shows the smoke detection results for the
four smoke videos when using the proposed method.

5. Experimental Results
The proposed forest smoke detection system was
implemented using an Intel Core 2-Quad processor PC
with an image size of 320 √ó 240 pixels. To evaluate the
performance of the proposed algorithm, T√∂reyin‚Äôs
algorithm [1] and Ham‚Äôs algorithm [5] which perform
well among existing algorithms, are compared with the
proposed method. The test is performed using five video
sequences which used in Ham‚Äôs experiment [5] as shown
in Table 1.
Table 1. Properties of the test videos
Video
Sequence

Number of
frames

Movie 1

457

Movie 2

735

Movie 3

956

Movie 4

781

Movie 5

566

Description

6. Conclusion
Since smoke appears before flames, smoke detection
is particularly important for early fire detection systems.
To consider the smoke characteristics over time, the
spatial-temporal visual patterns of intensity, wavelet
energy and motion orientation have been used for
generating feature vector from 100 consecutive frames.
For smoke verification, random forest was most effective
method in a small number of training data and low
feature dimension, with high computational performance
and accuracy. The proposed algorithm was successfully
applied to various forest smoke videos and showed a
better detection performance.

Forest-smoke

Movie 1, 2, 3, 4 and 5 are general forest smoke
videos. The comparative results are presented in Figure 3
where the true positive (TP) rate means correctly
detected smoke, the false positive (FP) rate means
recognizing a non-smoke region as a smoke region, and
the missing rate (MR) means not recognizing a real
143

[6]

[7]

(a) Movie 1

(b) Movie 2

(c) Movie 3

(d) Movie 4

(e) Movie 5
Figure 4. Smoke detection
proposed algorithm

results

using

Acknowledgements
This work was supported by Basic Science Research
Program through the National Research Foundation of
Korea (NRF) funded by the Ministry of Education,
Science and Technology (MEST) (2011-0004033)

References
[1]

[2]

[3]

[4]

[5]

B.U. T√∂reyin, Y. Dedeoglu. and A. E. Cetin, Contour
based smoke detection in video using wavelets, In
Proceeding 14th European Signal Processing
Conference, EUSIPCO, 1-5, 2006.
F. Yuan, A fast accumulative motion orientation model
based on integral image for video smoke detection,
Pattern Recognition Letter, Vol. 29, 925-932, 2008.
J. Gubbi, S. Marusica, and M. Palaniswamia, Smoke
detection in video using wavelets and support vector
machines, Fire Safety Journal, Vol. 44 (8), 1110-1115,
Nov. 2009.
R.G. Gonzalez, V. A. Aquino, R. R. Romero, O.
Starostenko, J. R. Asomoza, J.M. Cortes, Wavelet-based
smoke detection in outdoor video sequences, In
Proceeding 53rd IEEE International Midwest
Symposium on Circuits and Systems, MWSCAS, 383387, Aug. 2010.
S.J. Ham, B.C. Ko, and J. Y. Nam, Vision based forest
smoke detection using analyzing of temporal patterns of
smoke and their probability models, In Proceeding
IS&T/SPIE Electronic Imaging, 7877-9, 1-6, Jan. 2011.

144

B. C. Ko, H. J. Hwang, and J.Y. Nam, Nonparametric
membership functions and fuzzy logic for vision sensorbased flame detection, Journal of Optical Engineering,
Vol. 49(12), 1-11, 2010.
L. Breiman, Random Forests, Machine Learning, 45, 532, 2001.


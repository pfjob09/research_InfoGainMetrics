2011 Eighth International Conference Computer Graphics, Imaging and Visualization

Rational Bi-cubic Functions Preserving 3D Positive Data
Malik Zawwar Hussain
Department of Mathematics
University of the Punjab
Lahore, Pakistan.
e-mail: malikzawwar@math.pu.edu.pk

Muhammad Sarfraz
Department of Information Science
Kuwait University, Adailiya Campus,
Kuwait
e-mail: prof.m.sarfraz@gmail.com

by Hussain and Sarfraz [6], to preserve the shape of positive
planner data. The authors in [6], developed the data
dependent sufficient conditions on free parameters to
preserve the shape of planar data. Sarfraz and Hussain [8]
used the rational cubic functions with two free parameters to
visualize the shape of curve data. They developed the data
dependent constraints on the free parameters to visualize the
shape of data.
In this paper a positivity problem is discussed using
bicubic partially blended C1 rational functions. The method
proposed is developed in such a way that unlike [1, 2], no
extra knots are needed to preserve the shape of the data.
The paper is organized in such a way that Section 2
reviews [8]. Extended rational bicubic function is discussed
in Section 3. The positivity problem is discussed in Section
4. The bicubic positive rational function is demonstrated in
Section 5. Finally Section 6 concludes the paper.

Abstract— A positive rational cubic function [8] has been
extended to positive rational bi-cubic partially blended
function to visualize the shape of 3D positive data. To preserve
the shape of positive data, simple data dependent constraints
are derived on the free parameters in the description of
rational bi-cubic partially blended functions. The developed
scheme is local and C 1 .
Keywords- Rational Bi-cubic functios, Free parameters, 3D
posiive data, Contraints, Visualization

I.

INTRODUCTION

Shape preserving techniques gained a lot of attention in
recent years. Several authors [1-12] made their contributions
in this regard. Positivity is an important shape property. In
many physical situations entities are meaningful only when
they are positive. For instance, presentation of probability
distribution is always positive. Likewise data are always
positive when samples of population are under
consideration. Its application is also found in the
observation of gas discharge during certain chemical
experiments.
Brodlie et al [1], used a bi-cubic polynomial to preserve
the shape of positive surface data. The algorithm developed
in [1] works by inserting one or two knots where the data
looses shape. Sarfraz et al [10] used the rational cubic
function to visualize the positive data. First they constructed
data dependent constraints on free parameters to visualize
the shape of positive curve data and then they extended it to
positive rational bi-cubic partially blended function (Coonspatches) to visualize the shape of positive surface data. Butt
and Brodlie [2] used cubic polynomials to preserve the
shape of positive curve data when slopes were also given at
the data points. The algorithm in [2] works by inserting one
or two knots to preserve the shape of positive data
The problem of positivity preserving of scattered data
interpolation is discussed by Piah et al. [9]. Chang and
Sederberg [3] discussed the problem of non-negative
interpolation. They considered non-negative data arranged
over a triangular mesh and interpolated each triangular
patch using bivariate quadratic function. The two
interpolating schemes to preserve the shape of data lying on
one side of the straight line by using rational cubic spline is
presented by Goodman et al [4]. In [5], Goodman surveyed
the shape preserving interpolating algorithms for 2D data.
The rational cubic function in its most general form is used
978-0-7695-4484-7/11 $26.00 © 2011 IEEE
DOI 10.1109/CGIV.2011.15

Madiha Amjad, Misbah Irshad
Department of Mathematics
University of the Punjab
Lahore, Pakistan.
e-mail: misbah1109@hotmail.com

II.

RATIONAL CUBIC FUNCTION

Let  xi , fi  ; i 1, 2,3,  n be the given set of data points
where x1  x2    xn and fi , di are the function values and
derivative values respectively. A piecewise rational cubic
function is defined as:
pi T 
S  x  { Si  x 
(1)
qi T 
where
pi T 

f i 1  T    vi f i  hi d i  T 1  T 
3

2

  wi f i 1  hi d i 1  T 2 1  T   T 3 f i 1

qi T 

1  T 

3

 viT 1  T   wiT 2 1  T   T 3
2

x  xi
, hi xi 1  xi
hi
The rational cubic function has the following properties:

T

S  xi 

fi , S  xi 1 

fi 1 , S 1  xi 

S    xi 1 
1

1

d i and

di 1

S  x  denote the derivative with respect to xi and di
denotes the derivative values (given or estimated by some
1
method) at knot xi . S  x   C   > x0 , xn @ has vi and wi as
47

free parameters in the interval > xi , xi 1 @ . One can note that

3



when vi wi 3, the rational cubic function becomes Cubic
Hermite polynomial. The following theorem is easily
derived from the description of the rational cubic (1).

S x, y j

¦ 1  T 



i 0

3 i

T i Ai

with

Theorem 1. For a strictly positive data, the rational cubic
function (1) preserves positivity if the free parameters are
satisfying the following conditions:

A0

Fi , j ,

A1

vi , j Fi , j  hi Fi ,xj ,

wi , j Fi 1, j  hi Fi ,xj

A2

­ hd ½
°­ h d °½
vi ! Max ®0, i i ¾ and wi ! Max ®0, i i 1 ¾
f i °¿
°¯
¯ f i 1 ¿

A3

Fi 1, j

q1 T 

1  T 

 vi , j 1  T  T  wi , j 1  T T 2  T 3

3

2

3

RATIONAL BI-CUBIC FUNCTION

III.



S x, y j 1

The piecewise rational cubic function (1) is extended to bicubic partially blended rational function S  x, y  over the

rectangular domain D= > a, b @ u > c, d @. Let

of > a, b @ and > c, d @ respectively. Rational bi-cubic function
is defined over each rectangular patch:
0,1, 2,  , m  1, j

S  x, y 

 AFB

(2)

















S x, y j 1 º
»
S xi , y j 1 »
»
S xi 1 , y j 1 »
¼

wi , j 1 Fi 1, j 1  hi Fi ,xj 1

B3

Fi 1, j 1

1  T 

3

 vi , j 1 1  T  T  wi , j 1 1  T T 2  T 3
2

3 i

¦ 1  M  M i Ci
i 0

(5)

q3 M 
vˆi , j Fi , j  h j Fi ,yj ,

C0

Fi , j , C1

C2

wˆ i , j Fi , j 1  h j Fi ,yj 1

C3

Fi , j 1

1  M 

3

3

S  xi 1 , y 

 vˆi , j 1  M  M  wˆ i , j 1  M  M 2  M 3
2

¦ 1  M 
i 0

3i

M i Di
(6)

q4 M 

with

1  T  1  2T  , a1
2
1  M  1  2M  , b1
2

x  xi
,M
hi



B2

q3 M 

where

T

vi , j 1 Fi , j 1  hi Fi ,xj 1 ,

with

A= ª¬-1 a0 T  a1 T  º¼ ; B= ª¬-1 b0 M  b1 M  º¼

b0

(4)

Fi , j 1 , B1

S  xi , y 

ª
0
S x, y j
«
F= « S  xi , y 
S xi , y j
«
«S  x , y  S x , y
i 1
i 1
j
¬

T i Bi

q2 T 

3

where

a0



i 0

3 i

B0

q2 T 

0,1, 2,

, n  1 as:
T

¦ 1  T 

with

S : a = x0 < x1

 < xm = b and S : c = y0 < y1 <  < ym = d be the partitions

º, i
ºuªy u y
I ªx , x
j  1 »¼
¬ i i  1 ¼ «¬ j

(3)

qi T 





y  yj
hj

T 2  3  2T 
M  3  2M 

D0

Fi 1, j ,

D1

vˆi 1, j Fi 1, j  h j Fi y1, j ,

D2

wˆ i 1, j Fi 1, j 1  h j Fi y1, j 1

D3

Fi 1, j 1

2

.

q4 M 



S x, y j , S x, y j 1 , S  xi , y  and S  xi 1 , y  are rational
cubic function (1) defined on the boundary of rectangular
patch > xi , xi 1 @ u ª¬ y j u y j 1 º¼ as:

48

1  M 

3

 vˆi 1, j 1  M  M  wˆ i 1, j 1  M  M 2  M 3 .
2

IV.

­° h j Fi y1, j ½°
­° h j Fi y1, j 1 ½°
vˆi 1, j ! Max ®0,
¾ and wˆ i 1, j ! Max ®0,
¾
Fi 1, j ¿°
¯°
¯° Fi 1, j 1 ¿°

POSITIVE RATIONAL BI-CUBIC FUNCTION





Let xi , y j , Fi , j be the positive partially blended surface
data defined over a region I
that Fi , j ! 0 i, j , i

> xi , xi 1 @ u ª¬ y j u y j 1 º¼ ; such

0,1, 2,, m  1, j

We can conclude above discussion in the following
theorem:

0,1, 2, , n  1 . The

bi-cubic partially blended surface patch (2) satisfies all the
properties of boundary curves. The bi-cubic partially
blended surface (2) is positive if boundary curves S x, y j ,







Theorem 2. The sufficient conditions for a piecewise
rational bi-cubic function to be positive over a rectangular
region I= I > xi , xi 1 @ u ª¬ y j u y j 1 º¼ in (2) is:



S x, y j 1 , S  xi , y  and S  xi 1 , y  defined in (3), (4) (5)

and (6) are positive. Now,





S x, y j ! 0 if

3

¦ 1  T 

­° hi Fi ,xj ½°
­° hi Fi x1, j
vi , j ! Max ®0,
w
Max
,
!
¾ i, j
®0,
Fi , j ¿°
¯°
¯° Fi 1, j

3 i

T i Ai ! 0 and q1 T  ! 0 .

i 0

­° hi Fi ,xj 1 ½°
­° hi Fi x1, j 1 ½°
!
,
vi , j 1 ! Max ®0,
w
Max
®0,
¾
¾
i , j 1
Fi , j 1 ¿°
¯° Fi 1, j 1 ¿°
¯°

Thus





­° h j Fi ,yj ½°
­° h j Fi ,yj 1 ½°
ˆ
!
vˆi , j ! Max ®0,
w
Max
,
®0,
¾
¾
i, j
Fi , j ¿°
¯° Fi , j 1 ¿°
¯°

S x, y j ! 0 if
­° hi Fi x1, j ½°
­° hi Fi ,xj ½°
and
!
vi , j ! Max ®0,
w
Max
¾
®0,
¾
i, j
Fi , j ¿°
¯°
¯° Fi 1, j ¿°

­° h j Fi y1, j
vˆi 1, j ! Max ®0,
Fi 1, j
°¯

Similarly,





S x, y j 1 ! 0 if
3

¦ 1  T 

T i Bi ! 0 and q2 T  ! 0 .s

Thus,





vi , j

­° hi Fi ,xj
li , j  Max ®0,
Fi , j
¯°

wi , j

­° hi Fi x1, j ½°
mi , j  Max ®0,
¾ ; mi , j ! 0
¯° Fi 1, j ¿°

S x, y j 1 ! 0 if
vi , j 1

­° hi Fi ,xj 1 ½°
­° hi Fi x1, j 1 ½°
! Max ®0,
and
!
w
Max
¾
®0,
¾
i , j 1
Fi , j 1 ¿°
¯°
¯° Fi 1, j 1 ¿°

We can continue with the same logic and have:
S  xi , y  ! 0 if

3

¦ 1  M 

3i

i 0

­° h j Fi ,yj 1 ½°
­° h j Fi ,yj ½°
ˆ
! Max ®0,
w
Max
and
!
¾
®0,
¾
i, j
Fi , j ¿°
¯°
¯° Fi , j 1 ¿°

S  xi 1 , y  ! 0 if

3

¦ 1  M 
i 0

3i

M i Di ! 0 and q4 M  ! 0

S  xi 1 , y  ! 0 if

49

½°
¾ ; li , j ! 0
¿°

vi , j 1

­° hi Fi ,xj 1 ½°
si , j  Max ®0,
¾ ; si , j ! 0
Fi , j 1 ¿°
¯°

wi , j 1

­° hi Fi x1, j 1 ½°
ti , j  Max ®0,
¾ ; ti , j ! 0
¯° Fi 1, j 1 ¿°

M i Ci ! 0 and q3 M  ! 0

Thus,
S  xi , y  ! 0 if
vˆi , j

½°
­° h j Fi y1, j 1 ½°
¾
¾ , and wˆ i 1, j ! Max ®0,
°¯ Fi 1, j 1 ¿°
¿°

The above conditions can be rearranged as following:

3 i

i 0

½°
¾
¿°

vˆi , j

­° h j Fi ,yj ½°
ni , j  Max ®0,
¾ ; ni , j ! 0
Fi , j ¿°
¯°

wˆ i , j

­° h j Fi ,yj 1 ½°
oi , j  Max ®0,
¾ ; oi , j !
¯° Fi , j 1 ¿°

vˆi , j

­° h j Fi y1, j
pi , j  Max ®0,
Fi 1, j
¯°

wˆ i , j

­° h j Fi y1, j 1 ½°
ki , j  Max ®0,
¾ ; ki , j ! 0
¯° Fi 1, j 1 ¿°

½°
¾ ; pi , j ! 0
¿°

i 0,1, 2,, m  1 ; j 0,1, 2, , n  1 in rational bicubic function (2) to attain positive surface.

The algorithm, for efficient computation, can be designed as
follows:
Algorithm 1

V.

Step 1. Given the  m u n  positive data points

x , y ,F  ;i
i

j

In this section, positivity preserving scheme developed in
Section 4 is illustrated through examples. The positive data
in Table 1 is generated from the following function:

0,1, 2, , n  1

0,1, 2,, m  1, j

i, j

x
i, j

Step 2. Approximate the derivatives F and Fi ,yj at knots.

F  x, y 

Step 3. Determine the values of free parameters
vi , j , vi , j 1 , wi , j , wi , j 1 , vˆi , j , vˆi 1, j , wˆ i , j , wˆ i 1, j by using
Theorem 2.
Step 4. Insert the values of Fi , j , Fi ,xj , Fi ,yj ; i



Exp Sin( x 2  5 / y 2 )



This data is generated by taking the values truncated to four
decimal places.

0,1, 2,  , m ,

0,1, 2,  , n

j

DEMONSTRATION

and

vi , j , vi , j 1 , wi , j , wi , j 1 , vˆi , j , vˆi 1, j , wˆ i , j , wˆ i 1, j ,

TABLE I.

y/x
-3
-2
-1
1
2
3

-3
2.2949
0.74212
1.5372
1.5372
0.74212
2.2949

-2
2.7036
1.4647
0.78083
0.78083
1.4647
2.7036

A POSITIVE DATA

-1
0.46916
0.43108
2.1314
2.1314
0.43108
0.46916

1
0.46916
0.43108
2.1314
2.1314
0.43108
0.46916

3

3

2.5

2.5

1

1.5
1

0.5

0.5

0
-0.5
3

0
3
2

2

3

1
1

y-axis

-3

y-axis

x-axis

Figure 1. Bi-cubic Hermite Spline.

n
i, j

o
i, j

p
i, j

-2
-3

-3
x-axis

Figure 2. Positive rational bi-cubic function.

Figure 1 is produced by using bi-cubic Hermite spline from
the data set in the Table 1 which fails to preserve shape of
data. Figure 2 is generated from the same data set by using
scheme developed in section 4 with
t
i, j

0
-1

-2

-2
-3

1
-1

-1

-2

s
i, j

2
0

0

-1

m
i, j

3

1

2
0

l
i, j

3
2.2949
0.74212
1.5372
1.5372
0.74212
2.2949

2

1.5

z-axis

z-axis

2

2
2.7036
1.4647
0.78083
0.78083
1.4647
2.7036

k
i, j

It can be seen that Figure 2 preserves positivity.
The positive data in Table 2 is generated from the following
function:

8.

F  x, y 

50

xSin 2 x 

ySiny
Sin 2 x

TABLE II.

y/x
-3
-2
-1
1
2
3

-3
21.267
2.0157
1.1937
1.1937
2.0157
21.267

-2
91.327
3.7032
3.1642
3.1642
3.7032
91.327

A POSITIVE DATA.

-1
42.262
2.5214
1.7842
1.7842
2.5214
42.262

1
42.262
2.5214
1.7842
1.7842
2.5214
42.262

100

2
91.327
3.7032
3.1642
3.1642
3.7032
91.327

3
21.267
2.0157
1.1937
1.1937
2.0157
21.267

100

80

80

60

z-a xis

z-axis

60
40

40

20

20

0
-20
3

0
3
2

2

3

1
0

1

-3

y-axis

x-axis

Figure 3. Bi-cubic Hermite Spline.

t
i, j

n
i, j

o
i, j

p
i, j

-3

-3
x-axis

k
i, j

used. The developed scheme has been demonstrated over
some data set generated from positive functions and they
provide visually pleasing surfaces.
REFERENCES
[1] Brodlie, K.W. , Mashwama, P.and
Butt, S.
Visualization of surface data to preserve positivity and
other simple constraints, Comput. Graphics 19(4)
(1995) 585-594.
[2] Butt, S. and Brodlie, K.W. Preserving positivity using
piecewise cubic interpolation, Comput. Graphics
17(1)(1993)55-64.
[3] Chang, G.and Sederberg, T.W.Non-negative quadratic
Bezier triangular patches, Comput. Aided Geom.
Design 11 (1994) 113-116.
[4] Goodman, T. N. T., Ong, B. H. and Unsworth, K.,
Constrained interpolation using rational cubic splines,
Proceedings of NURBS for Curve and Surface Design,
G. Farin (eds), (1991), 59-74.
[5] Goodman, T.N. T., Shape preserving interpolation by
curves, Algorithm for Approximation IV, J. Levesley, I.
J.Anderson and J. C. Mason (eds.), University of
Huddersfeld Proceeding Published, (2002), 24-35.

8.

It can be seen that Figure10 preserves positivity.
VI.

-2

Figure 4. Positive rational bi-cubic function.

Figure 3 is produced by using bi-cubic Hermite spline from
the data set in the Table 1 which fails to preserve shape of
data. Figure 4 is generated from the same data set by using
scheme developed in section 4 with
s
i, j

0
-1

-2

-2
-3

y-axis

1
-1

-1

-2

m
i, j

2
0

0

-1

l
i, j

3

1

2

CONCLUSION

1

In this paper, a C piecewise rational bi-cubic partially
blended function is used to preserve the positive shape of
the surface data. Data dependent constraints are derived on
free shape parameters in the description of rational bicubic
functions in order to achieve the positive shape of the data.
The choice of arithmetic mean is adopted to compute the
derivatives. But, in general, choice of derivative parameters
is left at user’s wish as well. Any numerical derivatives, like
arithmetic, geometric or harmonic mean choices can also be

51

[6] Hussain, M.Z. and Sarfraz, M. , Positivity-preserving
interpolation of positive data by rational cubics, Journal
of Computational and Applied Mathematics, 218(2),
(2008), 446-458.
[7] Sarfraz, M., Butt, S. and Hussain, M.Z. Simulating a
model for the scientific data, in: Proceedings of the
International Conference on Operations and
Quantitative Management, Jaipur, India, January 3-5,
(1997), 267-274.
[8] Sarfraz, M. and Hussain, M.Z. Data visualization
using rational spline interpolation, J. Comput. Appl.
Math. 189 (2006) 513-525.

[9] Piah, A. R. Mt., Goodman, T. N. T. and Unsworth, K.,
Positivity-preserving scattered data interpolation,
Mathematics of Surfaces, (2005), 336-349.
[10] Sarfraz, M., Hussain, M.Z. and Asfar Nisar, Positive
data modeling using spline function, Applied
Mathematics and Computation, Vol 216 (2010), 20362049.
[11] Scmidt, J. W. and Hess, W. Positivity interpolation with
rational quadratic splines, Computing 38 (1987) 261267.
[12] Scmidt, J. W. and Hess, W. Positivity of cubic
polynomial on intervals and positive spline
interpolation, BIT 28 (1988) 340-352.

52


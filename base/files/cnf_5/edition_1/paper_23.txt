2011 Eighth International Conference Computer Graphics, Imaging and Visualization

A Region-Based Image Segmentation by Watershed Partition and DCT Energy
Compaction

1st CHI-MAN PUN

2nd NING-YU AN

3rd MIAO CHENG

Department of Computer and
Information Science, University of
Macau
Macau SAR, China
cmpun@umac.mo

Department of Computer and
Information Science, University of
Macau
Macau SAR, China
ya97414@umac.mo

Department of Computer and
Information Science, University of
Macau
Macau SAR, China
mcheng@umac.mo

combines watershed and region merging by intensity and
texture extraction. To the best knowledge of ours, the most
widely investigated texture representation methods have
been windowed Fourier transforms, the Gabor representation
[5, 6], Wavelet transforms [7, 8], local histograms, and the
local structure tensor, etc. However, the main drawback of
Gabor filtering is that the excessive computational effort is
usually avoided, and the applicability of wavelet method is
quite limited especially for the region area that is not big
enough. To address these limitations, the discrete cosine
transform is adopted for texture representation, resulting in a
fast segmentation approach.
Furthermore, the main procedure of the presented method
can be summarized into several steps. Firstly, the improved
watershed transform is implemented in the input gray-scale
image and the image is divided into several disjoint regions,
while each region is labeled by a unique number. Second, the
regions are combined according to their similarities which
are calculated by intensity mean, intensity variance and
region pixels until they reach a certain amount. Finally, the
residual regions are merged corresponding to region
similarities by involving texture information.
The rest of the paper is organized as follows. In Section 2,
we give a brief review on improved watershed
transformation as well as the knowledge about discrete
cosine transform. In Section 3, details of the proposed
algorithm for cost computing and region merging will be
described. Experimental results are presented in Section 4.
Conclusions are given in Section 5.

Abstract—An image segmentation approach by improved
watershed partition and DCT energy compaction has been
proposed in this paper. The proposed energy compaction,
which expresses the local texture of an image area, is derived
by exploiting the discrete cosine transform. The algorithm is a
hybrid segmentation technique which is composed of three
stages. First, the watershed transform is utilized by
preprocessing techniques: edge detection and marker in order
to partition the image into several small disjoint patches, while
the three features: region size, mean and variance are used to
calculate region energy for combination. Then in the second
merging stage, the DCT transform is used for energy
compaction which is a criterion for texture comparison and
region merging. Finally the image can be segmented into
several partitions. The obtained results show good
segmentation robustness and efficiency, when compared to
other state of the art image segmentation algorithms.
Keywords-Image segmentation, energy compaction, cosine
transform, watershed

I.

INTRODUCTION

In the literature, segmentation has been known as the
process of dividing an image into a subset of connected
regions based on an application defined criteria. For natural
scenery images, it usually means the separation of the image
into its constituent objects or feature types (e.g. sky, trees,
buildings, etc) [1, 2]. Despite the plenty of research outcome
on such topic, it still continues to be a challenging problem
in image processing. The difficulties mainly results from the
fact that different people can define textures in applicationdependent ways or with different perceptual motivations, and
there is no generally agreed-upon definition.
Among
the
different
segmentation
methods,
unsupervised image segmentation algorithms have been
widely applied for its generalization, which can be broadly
divided in three categories: region-based, graph-based and
model-based ones. More specifically, region-based image
segmentation approaches [3, 4] try to separate connected
image regions by grouping neighboring pixels based on
brightness, color, and texture. Afterwards, adjacent regions
are merged, under some criterion involving homogeneity or
region boundary sharpness.
In this paper, our work focuses on the region-based
algorithm, and a novel approach is proposed, which

978-0-7695-4484-7/11 $26.00 © 2011 IEEE
DOI 10.1109/CGIV.2011.27

II.

THE RELATED WORK

A. The Watershed Transform and Improvement
In geography, a watershed is the ridge that divides areas
drained by different river systems. The well-known
watershed segmentation algorithm is the classic discrete
Vincent-Soille flooding watershed algorithm [9-11]. The
output of the watersheds algorithm is the input image into its
different catchment basins, each of which is characterized by
a unique label from 1 to n. At the same time, watershed
points are equidistant to two nearest connected catchment
basins that are characterized by 0.
However, the main disadvantage of this approach is oversegmentation. Therefore, some pre-processing may be
necessary to produce a segmentation that better reflects the
131

arrangement of objects within the image. To achieve such
purpose, we compute the gradient magnitude of the image
which has high pixel values along object edges, and low
pixel values everywhere else via Sobel liner filtering method
(See Figure 1 and equation 5), which can detect edge
strength and direction resulting in a better noise-suppression
(smoothing) characteristic.
After using the filter to enhance the gradient, the markercontrolled method is employed to reduce the number of
regions [12]. Finally, the watershed transformation is
performed for marker-modified gradient image, and the
resulting image is shown in Figure 1.

Figure 2. a includes 5 irregular regions, and b is the expression of the
algorithm while the white blocks are 5 maximum rectangles in the 5
regions.

C. The Discrete Cosine Transform
The most common 2-D DCT definition [15-17] is
N −1 N −1
π (2 x + 1)u
π (2 y + 1)v
] cos[
]
C (u , v) = α (u )α (v)¦ ¦ f ( x, y ) cos[
x =0

2N

y =0

2N

(1)

­° 1 / N

α (u ) = ®

for

u=0

°¯ 2 / N

for
u≠0
The definition of α (v ) is the same as α (u ) .

(2)

The DCT transform transforms the whole image to a
coefficient energy matrix by intensities, and also it depicts
excellent energy compaction for highly correlated images.
Since the uncorrelated image has more sharp intensity
variations than the correlated image, the former has more
high frequency content than the latter.
For low frequency image, DCT operation provides ideal
energy compaction in the low frequency region. Furthermore,
when images have progressively high frequency and spatial
contents, the transform coefficients spread over low and high
frequencies. Some examples are shown in Figure 3.

Figure 1. Segmentation of watershed Figure 1.b (250 regions after
watershed transform) is much better than Figure 1.a (2356 regions after
watershed transform) which does the watershed transformation directly

B. The Maximum Rectangle In An Irregular Reigon
Now, the image is substituted by region adjacency graph
and each region is disjointed with the others. The regions
have irregular shapes but the DCT transform need to be
implemented on rectangle, so we get the maximum
rectangle in a region for substituting the texture of the whole
region. Apparently, some deviation is brought with the
substitution, but fortunately the primary features in the
regions can be preserved [13, 14].
Firstly, the contour of the irregular region is obtained
which is composed of a series of pixels. Then we extend the
width from the pixel along the direction of and the length
along the direction of until the boundary obstacles are
encountered. The maximum rectangle area and its
correlative information extending from pixel are recorded
and we compare all the rectangles from region boundary to
get the biggest one finally. The result of the algorithm is
shown in Figure 2.

Figure 3. Energy compaction of DCT

Figure 3 comprises of 2 image classes. The left images
are the original images while the right images are energy
compaction pictures. Comparing Figure 3 (a) with Figure 3
(b), the former image has more regular intensity variations
than the latter one. Consequently, transform coefficients of

132

the former spread over some regular points in middle and
high frequencies and its variation is periodical while the
energy of the latter is distributed over most part of the
corresponding energy image.
According to the characteristic of DCT transform, we can
extract texture and distinguish regions with different texture
by comparing their high, middle or low frequency energy
compaction.
III.

Variance =

1
N

N

¦(X

i

− X )2

(4)

i =1

Where, Xi is gray value of each pixel and X denotes
mean gray value. Variance is a measure of pixels' gray value
variation and deviation in a region. And the formulation of
adjacent region cost is

wa,b = (va × vb ) ∧ rV1× (1.5 × e1 + 0.2 × e2) (5)

FAST REGION MERGING ALGORITHM

Here, va denotes the number of pixels in region a. e1,
e2 denotes the difference of gray value and variance in
adjacent regions a, b. The coefficients 1.5 and 0.2 are
determined by the experimental results. The parameter rV1
is the weight of region size, which is set to 1.5.
Step 3: In this procedure, the minimal wi,j among all
the region cost is selected for merging.
Step 4: W, V, and E are updated during the process.
Step 5: Judge whether the region amount is less than
the threshold T. If not, iterate step3 to step5.
Generally, in the stage, region amount T is set to 100,
due to that the small patches can be combined with other
regions just by their size and intensity, while the texture is
not involved in the stage.

An important aspect of our merging algorithm is how to
define the similarities (We call it region cost) between the
adjacent regions. Based on watershed segmentation and
region similarities, the main stages of our algorithm are
described as follows: in stage 1, the over-segmented regions
which are separated from watershed transform are merged
until a certain amount the according to region features:
intensity mean and intensity variance. In stage 2, keep on
merging the residual regions by their intensities and cosine
energy. The detailed merging algorithm is given below.

B. Merging Considering Region Textures
The initial condition in the stage is the output of
several regions in stage 1 and the primary steps are the same
as stage 1. However, the method of computing region cost is
different from above. Textures of most parts of regions are
taken into account, and the cost between two regions is
defined:

wa ,b = (va × vb ) ∧ rV 1× (e1 + 5 × e3)

(6)

Here, the definition of va , vb e1 , rV1 is the same as
(5). rV1 is set to 0.5.
For any two regions a and b, the cosine transform
matrix is extracted by transforming the contents of the
region’s maximum rectangle to cosine coefficient. d1 and d2
are defined as rows and columns of cosine coefficient
matrix in a, d3 and d4 are defined as rows and columns of
the matrix in b, respectively.
Then the matrices are divided into 9 parts averagely,
where d1 and d2 are divided by 3. The 9 parts of matrix
have different frequencies from low to high. Then, we
compare the coefficient between two matrices.
Vector1 or Vector2 contain 9 elements, and each
element is the summation of the absolute value of different
part in the coefficient matrix. For example, Vector1 (1) is
the summation of one-ninth of the matrix on the top left. For
comparison, Vector1 and Vector2 are normalized by their
size.

Figure 4. Region cost calculation flowchart

A. Region Merging By Intensities
After watershed transform, the definition of the data
structure is:
G = (V, E, W)
(3)
Where V denotes the set of nodes representing
different regions, E denotes the set of edges between the
adjacent nodes and W denotes the sets of adjacent region
dissimilarity (cost).
Input: Each region is labeled by a unique number from
1 to N, and the edges segment the regions are labeled by 0.
Step 1: Search the whole graph and find the right or
lower neighbors of each region.
Step 2: Calculate the mean of pixels, the variance and
the pixel’s amount in each region.

­Vector1 = Vector1 /(d1 * d 2)
®
¯Vector 2 = Vector 2 /( d 3 * d 4)
Then the cosine frequency energy is given as:

133

(7)

9

e3 = ¦ (max(Vector1(i ),Vector 2(i ))
i =1

(8)

/ min(Vector1(i ),Vector 2(i )))
Here, e3 estimates the difference of frequencies
between adjacent regions, that is, the characteristics of
texture is described by the parameter.
According to the merging cost, merging process
repeats until required amount of regions is obtained.
IV.

EXPERIMENTAL RESULT

In the experiment, the parameter to be fixed is the
number of segmented regions S1 after first segmentation
stage. If the initial image’s resolution is high, S1 can be
large since that each region is enough for feature extraction,
otherwise S1 should be small. The resolution of images
“Lena”, “Baboon” is 256*256, so the effect of segmentation
is best when S1 is 100 by our test.
The obtained segmentation of ‘Lena’ between our
method and Normalized-Cut algorithm is shown in Figure 5.
The N-cut method segment the image with the resolution of
128*128. We implement the program with the resolution of
256*256, and the result is presented in figure 5. Our method
partitions the object more accurately, which improves
performance and convenient for some operations
subsequently.

Figure 6. The comparison of segmentation of ‘Baboon’ between
Normalize Cut (a) algorithm and our method (c). The image ‘Baboon’ is
divided into 5 regions.

V.

CONCLUSIONS

In this paper, we propose a novel image segmentation
approach based on watershed transformation, DCT transform
and region merging. We improve the watershed transform by
preprocessing techniques: edge detection and marker. Then
during region merging, the region size, mean and variance
features are used to calculate region cost for combination in
the first stage, and in the second merging stage we utilize
DCT transform for texture comparison. Finally the image is
segmented into several partitions which can be controlled
easily.
The proposed algorithm is evaluated for several grayscale
images, and the results are attractive with respect to most
cases, which can accurately extract the segmentation
compared with the well-known Normalized-Cut method.
In the future work, it is worthwhile to improve the
computational complexity of the proposed method so that
more efficiency can be achieved. And its extension for the
segmentation of color images is also a possible research
topic.
REFERENCES

Figure 5. The comparison of segmentation of ‘Lena’ between Normalize
Cut algorithm and our method. a is divided 5 regions by N-Cut algorithm. c
is divided by our method.

[1]

Besides, the comparison of the image “Baboon” is
shown in figure 6. The intensity’ difference of regions is
small in figure 6; therefore the distinction of each part is
evident by texture. From the results, it is obvious that our
method is able to partition the different texture parts into the
accurate regions, and it looks more precise and reasonable.

[2]

[3]

[4]

[5]

134

Bomans, M., et al., 3-D segmentation of MR images of the
head for 3-D display. Medical Imaging, IEEE Transactions
on, 1990. 9(2): p. 177-183.
Xianghua, X. and M. Mirmehdi, RAGS: region-aided
geometric snake. Image Processing, IEEE Transactions on,
2004. 13(5): p. 640-652.
Karoui, I., et al. Region-Based Image Segmentation Using
Texture Statistics And Level-Set Methods. in Acoustics,
Speech and Signal Processing, 2006. ICASSP 2006
Proceedings. 2006 IEEE International Conference on. 2006.
Deng, Y. and B.S. Manjunath, Unsupervised segmentation
of color-texture regions in images and video. Pattern
Analysis and Machine Intelligence, IEEE Transactions on,
2001. 23(8): p. 800-810.
Clausi, D.A. and D. Huang, Design-based texture feature
fusion using Gabor filters and co-occurrence probabilities.
Image Processing, IEEE Transactions on, 2005. 14(7): p.
925-936.

[6]

Hofmann, T., J. Puzicha, and J.M. Buhmann. An
optimization approach to unsupervised hierarchical texture
segmentation. in Image Processing, 1997. Proceedings.,
International Conference on. 1997.
[7] Unser, M., Texture classification and segmentation using
wavelet frames. Image Processing, IEEE Transactions on,
1995. 4(11): p. 1549-1560.
[8] Hsi-Chia, H., Texture segmentation using modulated
wavelet transform. Image Processing, IEEE Transactions on,
2000. 9(7): p. 1299-1302.
[9] Vincent, L. and P. Soille, Watersheds in digital spaces: an
efficient algorithm based on immersion simulations. Pattern
Analysis and Machine Intelligence, IEEE Transactions on,
1991. 13(6): p. 583-598.
[10] Soille, P., Morphological Image Analysis: Principles and
Applications. ., Springer-Verlag, 2003.
[11] Vincent, L., Morphological grayscale reconstruction in
image analysis: applications and efficient algorithms. Image
Processing, IEEE Transactions on, 1993. 2(2): p. 176-201.

[12] Najman L., a. S., M. "Geodesic saliency of watershed
contours and hierachical Segmentation." IEEE Trans. Pattern
Anal. Machine Intell. Vol.18: p. 1163-1173.
[13] C. C. Cheng; J. S. Tsai;Global cutting for the maximum
rectangular block from arbitrary closed region. International
Journal of Machine Tools & Manufacture, 2004: p. 14231430.
[14] Takahashi, T. Dropping method for rectangle packing
problem. in Circuits and Systems, 2000. Proceedings.
ISCAS 2000 Geneva. The 2000 IEEE International
Symposium on. 2000.
[15] Ahmed, N., T. Natarajan, and K.R. Rao, Discrete Cosine
Transfom. Computers, IEEE Transactions on, 1974. C-23(1):
p. 90-93.
[16] Strang, G., The Discrete Cosine Transform. SIAM Review,
1999. 41: p. 135-147.
[17] Khayam, S., The Discrete Cosine Transform (DCT): Theory
and Application. WAVES lab technical report, May,2004.

135


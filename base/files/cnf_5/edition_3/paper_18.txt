Fifth International Conference on Computer Graphics, Imaging and Visualization
Visualisation

Fair path planning with a single cubic spiral segment
Zulfiqar Habib
Department of Computer Science
National University
of Computer & Emerging Sciences
B-Block, Faisal Town, Lahore, Pakistan
zulfiqar.habib@nu.edu.pk

Abstract

an S-shaped transition, (iv) straight line to straight line, and
(v) circle to circle where one circle lies inside the other with
a C oval transition (fifth case).
Meek, Walton, and Goodman [18, 19, 21, 20, 5] have
considered cubic and PH quintic splines to solve the above
mentioned five cases but the fifth case used in highway design has not been solved completely and the zero curvature at the one end point of transition curve has been widely
used. Dietz and Piper [2] have numerically computed values to aid in adjusting the selection of control points for
building cubic spiral interpolations without zero curvature
(at end point) restriction, and a table is developed which
helps us in selecting the inner control points of a particular parametric cubic spiral to interpolate end conditions via
matching given end positions and tangents. Another table
is developed that matches tangent angles and curvatures at
the end points of the cubic spiral. It helps us to solve the
fifth case. Habib & Sakai [7, 9] theoretically described the
use of a single cubic or PH quintic B´ezier spiral segment to
solve the fifth case but their scheme does not match given
end positions and tangents.
This paper aims to improve the existing methods of
Meek, Walton, Goodman, Dietz, Piper, Habib and Sakai
[18, 19, 21, 20, 5, 2, 7, 9] for a C-shaped transition between
two circles with a single cubic spiral segment. Since there is
no closed form for the roots of a general quintic polynomial,
we first transform the unit interval [0, 1] to [0, ∞) and then
apply a sufficient condition for non positive roots to derive
as theoretically as possible the spiral conditions on the positions and tangents at the endpoints. Like [2] our method

Spirals are curves of monotone curvature with constant
sign and therefore such curves are free from singularities
(loops, cusps), inflection points, and local curvature extrema. These properties make the study of spiral segments
an interesting problem both in practical and aesthetic applications. An important issue in this paper is to design spiral
transitions preserving G2 Hermite conditions. This paper
aims to improve the existing methods of a C-shaped transition between two circles with a single cubic spiral segment.

1 Introduction
In curve and surface design, it is often desirable to have
a spiral transition curve of G2 contact. The purpose may be
practical, e.g., in highway designs, railway routes, satellite
path planning, robotics, and in different CAD applications
[12, 9, 8, 11, 10, 14, 16, 17]. Planer spirals have monotone
curvature and are free from singularities (loops and cusps)
and inflection points [3]. Spirals have curvature extrema at
their end points (i.e., no internal curvature extrema), this
makes spirals important for both physical and aesthetic applications [1, 4, 13, 15, 22]. This paper considers cubic spiral function common to all modern design systems.
The transition curves of G2 contact have been considered for joining the following pairs of objects: (i) straight
line to circle (J-shaped transition), (ii) circle to circle with
a broken back C-shaped transition, (iii) circle to circle with

978-0-7695-3359-9/08 $25.00 © 2008 IEEE
DOI 10.1109/CGIV.2008.61

Manabu Sakai
Department of Mathematics
& Computer Science
Kagoshima University
Kagoshima 890-0065, Japan
msakai@sci.kagoshima-u.ac.jp

121

does not pose the zero curvature restriction at the end point.
However instead of tables, our method provides a numerical method to find the middle control points for constructing
spirals conforming to given positional and tangential conditions, which is more convenient for the designer.

two conditions on the curvature establish the spiral:
κ(t) ≥ 0,

(2.3)

A G2 point of contact of two curves is a point where the
two curves meet and where their unit tangent vectors and
signed curvatures match.

2 Background
2.1

κ (t) ≥ 0

3 Description of method

Notations and conventions

The usual Cartesian co-ordinate system is presumed.
Boldface is used for points and vectors. The Euclidean
norm or length of a vector a is denoted by the notation
a =

a2x + a2y ,

and a b means the vector a is parallel to vector b. The
positive angle of a vector a is the counterclockwise angle
from the vector (1, 0) to a. The derivative of a function f
is denoted by f . To aid concise writing of mathematical
expressions, the symbol × is used to denote the signed zcomponent of the usual three-dimensional cross-product of
two vectors in the xy plane, e.g.,
a × b = ax b y − ay b x = a

p3
p0

b sin θ,
Figure 1. Spiral transition between two circles with given end point p0 and p3 , tangents,
and curvatures.

where θ is the counterclockwise angle from a to b. a · b
denotes the usual inner product.
The signed curvature of a parametric curve P (t) in the
plane is:
P (t) × P (t)
,
(2.1)
κ(t) =
3
P (t)

Let pi , i = 0, . . . , 3 be four given control points. The
cubic B´ezier curve defined by them has eight degrees of
freedom and is represented as

when P (t) is non-zero. Positive curvature has the center
of curvature on the left as one traverses the curve in the
direction of increasing parameter. For non-zero curvature,
the radius of curvature, positive by convention, is 1/|κ(t)|.
The derivative κ (t) of the curvature in (2.1) yields:
κ (t) =

φ(t)
P (t)

5,

z(t) = (1 − t)3 p0 + 3t(1 − t)2 p1 + 3t2 (1 − t)p2 + t3 p3 ,
(3.1)
where 0 ≤ t ≤ 1. Its signed curvature k(t) is given by
(2.1).
We assume throughout this paper that p0 =(-1,0) and
p3 =(1,0). As in [2], the tangent lines for the parametric cubic at t = 0, 1, and the horizonal axes for a triangle where the length of the lower two sides are d0 =
2sinφ1 /sin(φ0 + φ1 ) (for the side touching p0 ) and d1 =
2sinφ0 /sin(φ0 + φ1 ) where 0 < φ0 < φ1 < π/2. This
condition restricts the curves to spiral arcs of increasing
curvature [6]. As spirals may be parameterized and transformed (affine maps), this condition will not cause loss

(2.2)

where
φ(t)

=

d
{P (t) × P (t)}
dt
−3{P (t) × P (t)}{P (t) · P (t)}.
P (t)

2

The term ‘spiral’ refers to a curved line segment whose curvature varies monotonically with constant sign. Following

122

4 Spiral Regions and Examples

of generality. Parameterized spirals may be of increasing or decreasing curvature by changing the direction of
parametrization. If both f0 and f1 are constraint to be between 0 and 1, parametric cubic spiral will be free from
inflection points. For convexity, this and angle restriction is
necessary [2].
Figure 1 shows a spiral segment between two circles (one
containing the other), tangential conditions φ0 , φ1 , and circles of curvatures at p0 and p1 .
The ratios (f0 , f1 ) are extensively used in this paper:
f0 =

|p1 − p0 |
,
d0

f1 =

|p2 − p3 |
d1

Figures 2 and 5 show the plot of the spiral region for
the ratios f0 and f1 . The darker region is obtained from
Test1, whereas the Test 2 belongs to both darker and lighter
regions. In order to achieve the spiral segment we first use
Tests 1 and 2 to find the possible values of f0 and f1 which
allow a spiral segment. Now using any value of f0 and f1
from the spiral region we can see that the curvature remains
monotone and the resulting arcs are spiral.
Figures 3 shows a spiral segment with starting point p1
at (-1, 0) and ending point p3 at (1, 0). The tangent angles
of starting and ending tangents are (φ0 , φ1 ) = (π/10, π/8)
where φ0 and φ1 conform to 0 ≤ φ0 ≤ φ1 ≤ π/2. Figure
4 shows the curvature plot of spiral segment in 3 which is
monotone.
Similarly Figures 6 is another spiral segment for (φ0 , φ1)
= (π/4, π/3) and its corresponding curvature plot is given
in Figure 7.

(3.2)

to see
p1

=

p2

=

2f0 sinφ1
(cosφ0 , −sinφ0 ),
sin(φ0 + φ1 )
2f1 sinφ0
(cosφ1 , sinφ1 ). (3.3)
p3 −
sin(φ0 + φ1 )
p0 +

To ensure that the parametric cubic curve (3.1) is free from
inflection points, the ratios (f0 ,f1 ) are taken to be from zero
to one. Then the curvatures at the endpoints are given
κ(0) =
κ(1) =

(1 − f1 )sinφ0 sin2 (φ0 + φ1 )
,
3f02 sin2 φ1
(1 − f0 )sinφ1 sin2 (φ0 + φ1 )
.
3f12 sin2 φ0

5 Conclusion
We tried to improve the existing methods for the spiral
transitions with given positional, tangential, and curvature
conditions by following a numerical approach. The conditions formulated in Tests 1 and 2 allow greater flexibility in
spiral design than was allowed by the tabular approach developed in [2]. Moreover, formula based approaches suffer
from lesser space complexity issues than tabular approaches
in software implementations.

(3.4)

For t = 1/(1 + s), we use (2.2) for the derivative of curvature κ(t), which is
5

z (t) κ (t) =

2592sinφ0sinφ1
(1 + s)5 sin2 (φ0 + φ1 )

5

ci si , (3.5)

i=0

where
ci = f (f0 , f1 , φ0 , φ1 ) ,

6 Future Research Directions

i = 0, .., 5.

Future research work on the topic discussed above can be
continued along various directions. For example the conditions of two tests can be further relaxed to allow for greater
flexibility. Secondly, in a broader perspective this paper just
deals with spirals between circles with non-coinciding centers and work should be done to include concentric circles
in the domain as well. Finally, all the above mentioned objectives can also be tried with PH (Pythagorean hodograph)
spiral segments [9, 8, 11] for more flexible constraints, although it would be computationally more expensive.

Now the cubic B´ezier transition curve of the form (3.1) is a
spiral if
Test 1
ci ≥ 0, i = 0, .., 5,

(3.6)

or
Test 2
ci ≥ 0, i = 0, 2, 3, 5,
√
c4 + 2 c5 c3 ≥ 0,
√
c1 + 2 c2 c0 ≥ 0.

(3.7)

123

0.55

1.0

0.8

0.50

0.45

f1

f1

0.6

0.4
0.40
0.2

0.35
0.45

0.0
0.0

0.2

0.4

0.6

0.8

0.50

0.55

1.0

0.60

0.65

f0

f0

Figure 5. Spiral region plotted between f0
(along x-axis) and f1 (along y-axis) for
(φ0 , φ1 ) = (π/4, π/3)

Figure 2. Spiral region plotted between f0
(along x-axis) and f1 (along y-axis) for
(φ0 , φ1 ) = (π/10, π/8)

1.0
1.0

0.05
0.10
0.15

0.5

0.5

0.5

0.5

0.1

1.0

0.2

1.0

0.3
0.4

Figure 3. Spiral curve for (φ0 , φ1 ) = (π/10, π/8)
and (f0 , f1 ) = (0.8, 0.5)

Figure 6. Spiral curve for (φ0 , φ1 ) = (π/4, π/3)
and (f0 , f1 ) = (0.6, 0.4)

Κ t

Κ t

0.45

1.2

0.40

0.35

1.0

0.30

0.8

0.2

0.4

0.6

0.8

1.0

t

0.2

Figure 4. Curvature plot of spiral in Figure 3

0.4

0.6

0.8

1.0

Figure 7. Curvature plot of spiral in Figure 6

124

t

Acknowledgment

[13] A. Kelly and B. Nagy. Reactive nonholonomic trajectory
generation via parametric optimal control. The International
Journal of Robotics Research, 22(7/8):583–601, 2003.
[14] T. Liang, J. Liu, G. Hung, and Y. Chang. Practical and flexible path planning for car-like mobile robot using maximalcurvature cubic spiral. Robotics and Autonomous Systems,
52:312–335, 2005.
[15] Y. Nakamura and T. Suzuki. Planning spiral motions of nonholonomic free-flying space robots. Journal of Spacecraft
and Rockets, 34(1):137–143, 1997.
[16] M. Sarfraz, editor. Advances in Geometric Modeling. Wiley,
England, 2003.
[17] M. Sarfraz, editor. Geometric Modeling: Techniques, Applications, Systems and Tools. Kluwer, Netherlands, 2004.
[18] D. J. Walton and D. S. Meek. A planar cubic B´ezier spiral.
Computational and Applied Mathematics, 72:85–100, 1996.
[19] D. J. Walton and D. S. Meek. Planar G2 curve design
with spiral segments. Computer Aided Design, 30:529–538,
1998.
[20] D. J. Walton and D. S. Meek. G2 curve design with a pair of
Pythagorean hodograph quintic spiral segments. Computer
Aided Geometric Design, 24:267–285, 2007.
[21] D. J. Walton, D. S. Meek, and J. M. Ali. Planar G2 transition
curves composed of cubic B´ezier spiral segments. Computational and Applied Mathematics, 157(2):453–476, 2003.
[22] Z. Yao and A. Joneja. Path generation for high speed machining using spiral curves. Computer-Aided Design & Applications, 4:191–198, 2007.

This work is supported by Kagoshima University,
Kagoshima, Japan and National University of Computer &
Emerging Sciences, Lahore, Pakistan.

References
[1] H. Burchard, J. Ayers, W. Frey, and N. Sapidis. Designing
fair curves and surfaces, chapter Approximation with aesthetic constraints. 1993.
[2] D. A. Dietz and B. Piper. Interpolation with cubic spirals.
Computer Aided Geometric Design, 21(2):165–180, 2004.
[3] G. Farin. Curves and Surfaces for Computer Aided Geometric Design: A Practical Guide. Academic Press, NewYork,
4th edition, 1997.
[4] G. M. Gibreel, S. M. Easa, Y. Hassan, and I. A. El-Dimeery.
State of the art of highway geometric design consistency.
ASCE Journal of Transportation Engineering, 125(4):305–
313, 1999.
[5] T. N. T. Goodman and D. S. Meek. Planar interpolation
with a pair of rational spirals. Computational and Applied
Mathematics, 201:112–127, 2007.
[6] H. Guggenheimer. Differential Geometry. McGraw-Hill,
New York, 1963.
[7] Z. Habib and M. Sakai. An answer to an open problem on
cubic spiral transition between two circles. Computer Algebra - Design of Algorithms, Implementations and Applications, 1514:46–52, 9 2006. ISSN: 1880-2818.
[8] Z. Habib and M. Sakai. G2 Pythogorean hodograph
quintic transition between circles with shape control.
Computer Aided Geometric Design, 24:252–266, 2007.
http://dx.doi.org/10.1016/j.cagd.2007.03.004.
[9] Z. Habib and M. Sakai. On PH quintic spirals joining two circles with one circle inside the other.
Computer-Aided
Design,
39(2):125–132,
2007.
http://dx.doi.org/10.1016/j.cad.2006.10.006.
[10] Z. Habib and M. Sakai.
G2 cubic transition between two circles with shape control.
Computational and Applied Mathematics, xx:xxx–xxx, 2008.
http://dx.doi.org/10.1016/j.cam.2007.12.024, In press.
[11] Z. Habib and M. Sakai. Transition between concentric
or tangent circles with a single segment of G2 PH quintic curve. Computer Aided Geometric Design, 25:247–257,
2008. http://dx.doi.org/10.1016/j.cagd.2007.10.006.
[12] Z. Habib, M. Sarfraz, and M. Sakai.
Rational cubic spline interpolation with shape control.
Computers & Graphics, 29(4):594–605, 2005.
http://dx.doi.org/10.1016/j.cag.2005.05.010.

125


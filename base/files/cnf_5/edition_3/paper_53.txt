Fifth International Conference on Computer Graphics, Imaging and Visualization
Visualisation

Comparison of Denoising Techniques Applied on Low-field MR Brain Images
NF Ishak(1), MJ Gangeh(2), R Logeswaran(1,3)
(1) Faculty of Engineering, Multimedia University, (2) Technische Universiteit Eindhoven, the
Netherlands, (3) Soongsil University, Korea.
{nur.faiza@mmu.edu.my, M.Gangeh@tue.nl, loges@ssu.ac.kr}
images. In this paper, we investigate the application of
denoising algorithms on low-field MR images. The main
attribute of these images is their low-resolution as stated
in [7]. Five popular denoising techniques are evaluated in
this paper, namely median filter, Gaussian filter, Wiener
filter, anisotropic-diffusion filter (Perona-Malik), as well
as the bilateral filter.
All these algorithms share the same basic
characteristic: denoising is achieved by averaging and
using low-pass filtering. The assumption is that noise is
captured by the high frequency coefficients, thus by
filtering these coefficients, the unwanted noise is
removed. Unfortunately, edges also have high frequency
components and by removing the noise, high frequency
components belonging to edges are also removed. One
method to avoid this is by using geometry driven
diffusion technique to preserve edges while remove
noise.
The structure of the paper is as follows. The next
section briefly discusses previous research work in this
field. Section III describes the five algorithms used
throughout the investigation. Our implementation setup
of the denoising techniques is explained in Section IV,
followed by the experimental results in Section V.
Finally, the conclusion is presented in Section VI.

Abstract
Low-field Magnetic Resonance Imaging (MRI) is
vital for sensitive surgery to allow real-time imaging in
the operation theatre. In this paper, we demonstrate
implementations of denoising algorithms on low-field
MR brain images. A major concern in denoising lowfield MR brain images is the poor quality images
secondary to a worsening signal-to-noise ratio (SNR)
compared with the high-field MRI scanners. This paper
gives some useful insight on the application of preprocessing techniques towards segmenting and labeling
the brain images. Promising results are reported for
anisotropic diffusion filtering.
Keywords--- Image denoising, image processing,
low-field MRI.

1. Introduction
In a wide variety of applications, it is necessary to
smooth an image while preserving its edges. The gray
levels often overlap that makes the segmentation process
more difficult. Filtering is perhaps the most fundamental
operation in many biomedical image processing
applications, where it reduces the noise level and
improves the quality of the image. Any post-processing
task such as segmentation, feature extraction and
labeling may benefit from the reduction of noise. In
general, the problem of how to select a suitable
denoising algorithm is dependent on the specific targeted
application. From the noisy image equation in (1), the
goal of image denoising methods is to recover the
original image from a noisy measurement:
r (i) = s (i ) + n(i )

2. Literature review
In the recent years, there has been a fair amount of
research on denoising techniques. According to [8], the
Gaussian filter performs well in smooth areas of the
image while it removes the details of the edges. As a
consequence, the Gaussian convolution is optimal in flat
parts of the image but edges and textures are also
blurred.
Numerous approaches have been proposed for
bilateral filters, representing a large class of non-linear
filters. When smoothing black-and-white images with a
standard low-pass filter, intermediate levels of gray are
produced across edges [4], thereby producing blurred
images. A bilateral filter allows intensity values to be
remapped by a range filter to avoid the loss of details
from occurring. On the other hand, the use of a narrow
spatial window is reported in [9] in order to prevent

(1)

where r(i) is the observed value, s(i) is the true value and
n(i) is the noise perturbation at a pixel i. However, the
denoising methods should not alter the original image s.
Numerous denoising approaches have been
proposed in the literature, such as anisotropic diffusion
[1], wavelets [2, 3], bilateral filters [4, 5] and nonnegative sparse coding [6]. However, these techniques
are applied to high-field magnetic resonance (MR)

978-0-7695-3359-9/08 $25.00 © 2008 IEEE
DOI 10.1109/CGIV.2008.26

345

over-smoothing structures of sizes comparable to the
image resolutions, which will lead to the necessity of
performing more iteration in the filtering process.
Most of the abovementioned papers presented
promising results, yet their suitability for low-field MR
images has not been reported.

where div is the divergence operator. ∇ and ∆ are the
gradient and Laplacian operators, respectively. It reduces
to the isotropic heat diffusion equation I t = c∆I if
c( x, y, t ) is a constant.

According to [1], anisotropic diffusion encourages
smoothing within a region in preference to smoothing
across the boundaries. The smoothing will take place
separately in each region with no interaction among
regions, so that the boundaries remain sharp.

3. Methodology
Five algorithms have been taken for comparison in
this study. In the following subsections, each algorithm
and theoretical implications with this system are
summarized based on previous research work.

3.5. Bilateral filters
Bilateral filtering is a non-iterative and local
approach to edge-preserving smoothing. The idea
underlying bilateral filtering is to do in the range of an
image what traditional filters do in their domain. In short,
it combines both domain and range filtering.
However, according to [5], bilateral filtering is a
non-iterative method only if a wide spatial window is
used, which may over-smooth sharp ridges and gutters in
the image. Therefore, it is necessary to strike a balance
between the size of the spatial window and the number
of iterations that need to be used.

3.1. Median filters
Median filter is a non-linear digital filtering
technique. Consider each pixel in the image, and sort the
neighboring pixels into order based upon their
intensities. The value of the pixel is replaced by the
median of the gray levels in the neighborhood of that
pixel. The median value m of a population (set of pixels
in a neighborhood) is that value, in which half of the
population has smaller values than m, and the remainder
have larger values than m.

4. Experiments

3.2. Gaussian filters
In order to judge the performance of the five
algorithms mentioned above, experiments are described
here for three different slices of low-field MRI from a
patient with brain tumor, as shown in Fig. 1. The lowfield MR images were taken at 0.5 T (Tesla) and have a
resolution of 128 × 128 pixels, while the high-field MR
images were taken at 1.5 T with 512 × 512 pixels
resolution.
We then compare the high-field MR images to lowfield MRI, which is susceptible to noise due to its low
signal-to-noise ratio (SNR) [7]. The first row of Fig. 1
shows a normal brain, while the second row shows the
brain part which contains the tumor. The third row shows
an example of bleeding in the brain.
We now consider the case of median filters, where it
replaces a pixel by the median of all pixels in its
neighborhood. For median filtering, the smoothing
process depends on the window size used. To denoise
low-field images in this experiment, we chose to use the
window size of 3-by-3 neighborhood. Larger values of
M-by-N causes edges to disappear, hence being unable to
determine the exact frame of each brain structure. If we
run the process using smaller windows, noise is still
retained in the images.
As for Gaussian filters, images typically vary slowly
over space. Thus, nearby pixels are likely to have similar
values. On the other hand, Gaussian filters use a matrix
of M-by-N with a standard deviation in order to smooth
the area. By choosing the standard deviation value
wisely, the degree of blurring can be adjusted
accordingly. From the observation combined with
previous research work, larger standard deviations tend
to make the processed image more blur.

Traditional filters such as Gaussian low-pass filters
compute a weighted average of pixel values in the
neighborhood, in which the weights decrease with
distance from the neighborhood center. The degree of
smoothing is determined by the standard deviation of the
Gaussian, where larger standard deviation requires larger
convolution kernels in order to be accurately represented.

3.3. Wiener filters
Wiener filtering is known to be the optimal
estimator for the true underlying image. It can be
represented by (2),
G (u, v) = F (u, v) × H (u, v)

(2)

where F is the Fourier transform of an ideal version of
the given image, H is the blurring function and G is the
processed image. (u,v) refer to the pixel position. Its
main advantage is the short computational time it takes
to find a satisfactory solution.

3.4. Anisotropic-diffusion filters
Anisotropic diffusion filters adjust smoothing
strength to the boundaries to reduce the noise while
preserve the edges. Consider the anisotropic diffusion
in (3),
I t = div(c ( x, y, t )∇I ) = c( x, y, t )∆I + ∇c × ∇I

(3)

346

The basic mechanism of the Wiener filter is similar
to Gaussian filters. The only difference is that we use
Fourier transform and inverse Fourier transform. There
are two variables to be considered besides the size of
image, namely, normalized intensity and degree of
blurring. Usually, the normalized intensity values range
from 0.1-0.9 and must be lesser than the degree of
blurring so that it will not overcome the intensity.

The desired parameters of bilateral filters are its
simplicity, local and non-iterative scheme. It combines
gray levels based on both their geometric closeness and
their photometric similarity. Bilateral filters depend on
two sigma values. The degree of denoising depends on
sigma 1 (spatial-domain) and sigma 2 (intensity-domain).
Throughout the experiments, sigma 2 is set less than
sigma 1. The time taken however depends on the
bilateral filter window size, where longer time is needed
for a larger window size.

5. Results

(a)

(b)

(c)

(d)

(e)

(f)

The denoised brain images are shown here to
compare the performance of denoising algorithms
explained in the previous section. We have applied our
denoising framework to three different types of low-field
MR images in Fig. 1, with the results given in Fig. 2-4.
The first set of results is from the normal brain slice,
where Fig. 2 shows the processed images using the
different algorithms. The fine texture is gone in Fig. 2(d)
and (e), thus smoothes the brain image. However, there
is still noise retained in Fig. 2(a)-(c). By using bilateral
filter, the overall shading is preserved because it is well
within the band of the domain filter and almost
unaffected by the range filter. The same goes for the
anisotropic diffusion that managed to retain the sharp
edges.

Figure 1 High-field (left) and low-field (right)
comparison for normal brain (first row), with
tumor (second row), and with bleeding region
(third row)
Figure 2 Results for normal brain tissue,
corresponds to the algorithms
(a) Median, (b) Wiener, (c) Gaussian, (d)
Perona-Malik, (e) Bilateral.

In anisotropic filters like Perona-Malik, images are
filtered by studying their evolutions under nonlinear
partial differential equations (PDEs). Edges are enhanced
temporarily before slowly blurring them out. The main
parameters which control the behavior of the smoothing
process in anisotropic diffusion are the number of
iterations and the diffusion factor which determines the
level of gradient intensity where diffusion is at its
maximum [10]. We have to adjust the diffusion factor
according to the noise level. The number of iterations
determines how many times the smoothing process is
repeated.

Referring to Fig. 3, in the brain with tumor image,
we see the differences before (Fig. 1(d)) and after
denoising for the five techniques. Notice that most of
fine texture has been filtered away, and yet all contours
are as crisp as in the original image for Fig. 3(d) and (e).
However, for median, wiener and Gaussian filters, the
edges are blended together with the brain tissue, making

347

brain segmentation difficult and even impossible after
that.

6. Discussions & Conclusions
This work describes the implementation, testing and
evaluation of popular denoising algorithms for the
denoising of low-field MR images. It is worth pointing
out that the implementation work carried out shares the
insight of pre-processing techniques that are best suited
low-field MR images. In order to evaluate the
performance of each algorithm, several experiments on
slices of low-field MR brain images with different
typical characteristics were conducted. The experimental
results of the algorithms were assessed by a number of
experiments showing overall quality of the restored
images. All of the algorithms managed to remove more
than half of the noise in the images. But at a certain
point, the smoothing process tends to merge the
unrelated regions together. In order to cope with such
problems, suitable parameters that produce the intended
output need to be selected.
We have discussed the different approaches which
resorts to suitable image denoising algorithms and the
best techniques found were anisotropic diffusion filters
and bilateral filters. Both techniques could be considered
as the pre-processing step to provide the input to the next
processing steps to be taken, such as segmenting and
skull removal
In future, we intend to implement trilateral filters
where the smoothing process is achieved by considering
the geometric, photometric and local structural
orientation similarities between neighboring pixels in the
inhomogeneous regions. Better results are expected
through such treatment of the low-field MRI images

Figure 3 Results for brain tumor, corresponds
to the algorithms (a) Median, (b) Wiener, (c)
Gaussian, (d) Perona-Malik, (e) Bilateral
However, the bilateral filter did not perform well as
it blurred the edges between the bleeding region and the
brain tissue. Although it performed well in the previous
slices, it failed to segregate the regions correctly on this
slice. We believe that the reason for this poor
performance is due to the combining of gray levels based
on their geometric closeness. Anisotropic diffusion is the
only algorithm that managed to differentiate between two
important areas in this slice.

Acknowledgements
We would like to thank the Department of
Neurosurgery, Maastricht University Hospital and
Department of Biomedical Engineering, Eindhoven
University of Technology (TU/e) for providing the MR
images. This project is supported by the Ministry of
Science, Technology and Innovation (MOSTI), Malaysia
under the science fund grant.
References
[1]

[2]

[3]

[4]
[5]

Figure 4 Results for brain tumor, corresponds
to the algorithms (a) Median, (b) Wiener, (c)
Gaussian, (d) Perona-Malik, (e) Bilateral

348

P Perona, J Malik, “Scale-space and edge detection using
anisotropic diffusion”, IEEE Trans. PAMI, vol. 12, pp.
629-639, 1990.
L Jiang, W Yang, “Adaptive MRI denoising using
mixture model and wavelet shrinkage”, DICTA, pp. 831838, 2003.
K Krajsek, R Mester, “The edge preserving wiener filter
for scalar and tensor valued image”, DAGM, pp. 91-100,
2006.
C Tomasi, R Manduchi, “Bilateral filtering for gray and
color images”, ICCV, pp. 839-846, 1998.
D Barash, “A fundamental relationship between bilateral
filtering, adaptive smoothing, and the nonlinear diffusion
equation”, IEEE Trans. PAMI 2002, vol. 24, pp. 844847, 2002.

[6]

S Li, H Deshuang, “Image denoising using non-negative
sparse coding shrinkage algorithm”, CVPR, pp. 10171022, 2005.
[7] NF Ishak, MJ Gangeh, R Logeswaran, “A preliminary
study of high-field MRI image enhancement techniques
applied to low-field MR brain images”, 4th Kuala
Lumpur Int. Conf. on Biomedical Engineering (Biomed),
2008.
[8] A Buades, B Coll, JM Morel, “A non-local algorithm for
image denoising”, CVPR, vol. 2, pp. 60-65, 2005.
[9] WCK Wong, ACS Chung, “A non-linear and noniterative noise reduction technique for medical images:
concept and methods comparison”, Int. Congress Series,
vol. 1268, pp. 171-176, 2004.
[10] J Castellanos, K Rohr, T Tolxdorff, G Wagenknecht,
“Automatic parameter optimization for denoising MR
data”, MICCAI, pp. 320-327, 2005.

349


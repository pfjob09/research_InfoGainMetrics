Active Contour Model with Shape Constraints for Bone Fracture Detection
Y Jia, Y Jiang Ph.D
Department of Computer Science
Ryerson University
Toronto, Ontario, Canada M5B 2K3

Abstract
This paper presents a segmentation method that
outlines fractured bones in an X-ray image of a patient’s
arm within casting materials, and displays the alignment
between the fractured bones. This segmentation task is
often difficult because the casting materials cause a low
contrast and high noise ratio in the X-ray images. A
geodesic active contour model with global constraints is
applied to this task. A prior shape is collected and used as
a global constraint of our model. A maximum-likelihood
function is derived to provide feedback for each evolving
process. Experimental results show that the method
produces the outlines of the fractured bones on the low
contrast X-ray images robustly and accurately.

1

Introduction

Image segmentation is the process of dividing an
image into meaningful regions, allowing a computer to
‘see’. Image segmentation plays a key role in computer
vision applications such as robotics, pattern recognition,
and medical image analysis and has long been an area of
active research.
Although many successes have been seen, image
segmentation remains as a most challenging and difficult
task and a fundamental goal in computer vision research.
Segmentation is especially difficult when images
have a low signal-to-noise ratio or contain very
complicated scenes where the objects in the image overlap
(occluding and occluded objects produce poor contrast), or
the object is embedded in a very noisy environment.
Image segmentation techniques can be divided into
region based, edge based and active contouring based.
Many existing methods such as thresholding, edge

detection, region growing, watershed, active contouring
are available in the literature. Each of the techniques has
its own advantages and its own application areas. For
example, thresholding can be applied to detect objects in
an image where the foreground and background are well
contrasted. Edge detection techniques search for gradient
information in an image that defines the object whereas
region growing techniques looking for the homogeneous
regions to define the objects in an image. Watershed
algorithms use markers to detect the number of objects in
an image and try to find the boundaries between objects
even where the gradient information is weakly defined by
the image. Image segmentation techniques are application
dependent. Each application has its own specific
requirement. It is difficult to derive a generic solution to
all image segmentation tasks.
Image segmentation is an essential task in medical
imaging for diagnosis, treatment planning, and monitoring
the progress of disease or the results of treatment.
Extracting clinically useful information about anatomic
structures imaged through CT, MR, PET, and other
modalities is typically challenging. Image segmentation is
a tool for surgical planning, radiotherapy planning,
intraoperative navigation and tracking the progress of
disease. More recently, medical images have been used to
guide minimally invasive procedures. Although modern
imaging devices provide an exceptional view of the human
anatomy, the use of computers to quantify and analyze the
embedded structures in the image with accuracy and
efficiency is limited.
In this research, we address a unique and robust
segmentation method and apply the method to detect the
fractured bone and calculate the alignment of the fractured
bone from an X-ray image of a human arm.
Segmenting fractured bones and determining bone
fracture alignment on X-ray images are important aspects
in assessing the success of fracture treatment. A computer
aided diagnostic tool for detecting bone fractures and
determining their alignment could save clinicians time by

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006

simplifying time-consuming and tedious tasks. The key
part of designing this tool is to design a method to
effectively segment the broken bones from the x-ray image;
this would enable the alignment calculation. The
overlaying cast produces additional noise, especially in the
areas around metaphysis where the intensities appear as
extremely blurry with very low contrast. Metaphysis and
its background can barely be separated by traditional
segmentation techniques. The inconsistent intensity pattern
that changes from one X-ray to the next also causes
difficulties in the segmentation process.
We apply our segmentation method to detect the
fractured bone and able to calculate the alignment of the
fractured bone from an X-ray images of a human arm. The
human arm in the X-ray image is covered by casting
material that interferes with the segmentation due to the
low signal to noise ratio in the X-ray image created by
overlapping casting materials. We combined techniques of
segmentation and registration together in the segmentation
process and we achieved good results.
We combined techniques of segmentation and
registration together in the segmentation process and
achieved good results. Traditionally, image analysis
methods have viewed segmentation and classification or
registration as separated processes. In fact, the two
processes are closely related. Each can be improved with
information that the other provides, as suggested by
Schwartzkopt [1]: classification or registration would
benefit from correct segmentation and segmentation often
needs data from classification or registration. Our active
contour model employs a prior shape as a global constraint
allowing the model to evolve towards the desired shape
and to register with the prior shape. We also apply
mathematical morphology operations to abstract gradient
information and geodesic distance transform to generate
the narrow band for every evolving process. The
advantages of using mathematical morphology operations
to detect image gradient is that the shape and size of the
noise feature of casting material can be reduced by
specifying the structuring elements that are larger than the
noise shape. Therefore, we use dilation and erosion with a
structuring element that represents the characteristics of
the casting material to generate a gradient image. We also
use signed distance transform to generate a narrow band
for the curve evolving process. Moreover, we provide
estimates of confidence in the matching process to provide
feedback to the evolving process. The contributions of this
research are as follows:
Embeds global constraints in the evolving process to
guide the growth of the curve;Employs mathematical
morphology operations to perform noise reduction, edge
detection and narrow band generation;Uses signed distance

transform to create a narrow band for the curve evolving
process; Provides estimates in the matching process that
ensure the matching process converges; and detects the
bone fracture and alignment accurately.

2

Background

Image segmentation techniques can be classified into
several different approaches such as edge detection, region
growing, morphological operations, watershed, and active
contour models. Edge detection and region growing
techniques are suitable to the segmentation tasks where the
gradient information of object boundaries is clearly
defined. Weak gradients around the object boundaries
could cause segmentation failures. Watershed algorithms
provide a tool to segment objects in the images that
overlap. Separating the overlapping objects using a
watershed algorithm is faster and more robust than using
edge detection or region growing techniques.
Deformable models provide a robust foundation for
the representation, simulation, and manipulation of the
complex non-rigid anatomical structures [2]. The potency
of deformable models stems from the segmentation of
anatomic structures by exploiting constraints derived from
the image data together with a priori knowledge about the
location, size, and shape of these structures. Deformable
models have been used to segment, visualize, track and
quantify a variety of anatomy structures including the
brain, heart, face, kidney, lung, stomach, liver, skull,
vertebra, brain tumors, a fetus and even cellular structures
such as neurons and chromosomes [2][3][4].

2.1

Snakes versus Level sets

In recent years, deformable model-based image
segmentation has seen the emergence of two competing
approaches: snakes and level-sets.
Snakes can be viewed as Lagrangian geometric
formulations wherein the boundary of the model is
represented in a parametric form. The deformation energy
function is minimized with ‘internal’ and ‘external’
energies along its boundary. The geometric information
is considered to be internal energy and image gradients are
external energy. The models act like elastic bodies that
stabilize when the deformation energy function is
minimized.
The level-set method [5, 6] for image segmentation
has been extensively evaluated over the last few years.
The level-set method provides a mathematical formulation
for tracking the motion of a curve including optimal path
planning which can be recast as front propagation

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006

problems. The evolving constraints for propagation of an
interface can be defined in the problem domain by
exploiting constraints derived from the image data.
A geodesic active contour model has the advantages
of both the snake and level-set methods and presents some
positive properties. The model mathematically inherits the
way it handles the topological changes from the level-set
method and the minimizing deformation energy function
with ‘internal’ and ‘external’ energies along the boundary
from the traditional snake method by transforming a
mathematical formulation of snake with partial differential
equations (PDEs). It deforms a given curve with a PDE
and obtains the desired result as the solution of the PDE.
A level-set model uses a function that depends on the
image gradient as an edge detector to stop the curve
evolution [5]. The model can only detect objects defined
by the gradient. This type of segmentation using only local
information has often been frustrating when used in
poorly-contrasted regions due to occluding and occluded
objects or high noise and is often enhanced by the use of
prior shape information. Shape is a powerful property to
distinguish an object from its surroundings in an image.
Shape is commonly used to complete the information
provided by local properties of the image. A computerized
method should utilize shape information like a human
would identify an object’s appearance in an image by both
its shape and by the view of the object. In medical imaging,
geometric shape models provide extrinsic information
about objects and are often incorporated explicitly,
especially for the segmentations where prior shape
information can be collected.
Several methods of
incorporating prior shape information into the boundary
determination of level-set have been developed. Staib and
Duncan [7] introduced a parametric point model based on
an elliptic Fourier decomposition of the landmark points.
The parameters of their curve are calculated to optimize
the match between the segmenting curve and the gradient
of the image. Wang and Staib [8] applied a statistical point
model for the segmenting curve by using principal
component analysis to the covariance matrices that capture
the statistical variations of the landmark points. Leventon
et al [9] incorporated shape information as a prior model to
restrict the flow of the geodesic active contour. Their
shape model is derived by performing principle component
analysis on a collection of signed distance maps of the
training shape. The curve evolves according to two
competing forces: the gradient force and the force exerted
by the estimated shape where the parameters of the shape
are calculated based on the image gradient and the current
position of the curve. Chen [10] proposed a model that
uses the geodesic contour model and an “average shape”
as the prior shape which defines a term in the evolving
function of the model. This approach showed potential for

image segmentation incorporating a shape that can be
collected before hand. The active contour model proposed
in this paper is motivated by the method described by
Chen [10]. In our approach, the global constraints such
as shape, rotation, scale, and translations are incorporated
into the level-set evolving process. The curve propagates
with a velocity depending on the image gradients and the
prior shape information. The propagation stops when the
active contour arrives at high gradients or closely matches
the prior shape.

2.2

Mathematical morphology

Mathematical morphology theory [11] defines
computing operations by primitive shapes. Mathematical
morphology provides tools for measuring topological
shape, size, and location. ‘Set Theory’ is used as the
foundation for many functions. The basic functions are
‘Dilation’ and ‘Erosion’. Isolating certain features of the
image can be accomplished by the top-hat transform [11].
Top-hat transform can be used to select the defined
features by defining the larger structuring element of that
shape.

2.3

Mutual Information

We also employed mutual information (MI) in our
model to measure the difference between curves. Mutual
information provides a function of transformation between
images. MI is commonly used in medical imaging for
image registration [12]. MI is a quantity that measures the
mutual dependence of two objects. It measures the
information about object X that is shared by object Y. In
image registration applications, given a reference image
(e.g. a brain scan), and a second image which needs to be
put into the same coordinate system as the reference image.
The second image is deformed until the mutual
information between itself and the reference image is
maximized. In our method, the evolving curve deforms
until the mutual information between the curve and the
prior shape is maximized. Different transformations are
evaluated to find the maximum of MI.

3. Method
3.1

Active contour model - Level-Set Method

Consider that a curve moves in a direction normal to
itself with a speed function F. Assuming F > 0, the front
always moves “outward” [5]. The front always moves
“inwards” when F < 0.

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006

where the structuring element B is bigger than the objects
to be detected and similar to the shape of the objects.
Figure 2 gives an example of TopHat transform.

Evolution equation for ĭ:

φ t + F || ∇ x φ || = 0

φ ( 0 , • ) = 0 on

on

(1)

∂Ω

Boundary value equation:
F || ∇ x T || = 1 on Ω T =

3.2

Ω

0

on

∂Ω

Signed distance transform

The distance transform [12] is also used in our
method to formulize narrow bands in our evolving process.
Figure 1 give an example of distance transform on a
rectangular shape.

Figure 2: a,e) structuring element; b,f) original image; c,g)
opening (resp. closing); d,h) result from subtraction

3.4

Mutual Information

The information that X tells about Y is the uncertainty
in X plus the uncertainty in Y minus the uncertainty in
both X and Y [13]. A series of statements regarding
entropy are:
I( X; Y ) = H( X ) – H( X | Y ) ;
I( X; Y ) = H( Y ) – H( Y | X );
I(X; Y) = H(X) + H(Y)- H(X, Y);
I(X; Y) = I( Y; X ); I( X; X ) = H( X );
Figure 1: A distance transform for a simple rectangular
shape.

3.5

In our approach, the ĭ is achieved by using a signed
distance function for each numerical iteration. The
distance from zero level set is computed towards outside
of the zero level set. A contour tracing algorithm is used to
achieve this distance function. One nice property of a
distance map is its unit gradient magnitude is the same in
all directions. A regenerating ĭ function uses a distance
map by recalculating the distance map after each evolving
process. The narrow band for the curvature flow |∇ĭ | is
then increased by 1 in each iteration. The driving force is
taken as F > 0, and the curve evolves outward. The
gradient image is generated by using morphology gradient
operations (erosion subtracted from dilation). The
structuring element used is a 5x5 square which represents
the shape and the size of the casting materials in the X-ray
image. The narrow band for the curvature flow |∇ĭ | is
then increased to 3 which will cover half of the 5x5 square,
the same size as the structuring element of the
morphological gradient operation.

3.3

TopHat transform

TopHat(A, B) = A – (A ο B) = A – max( min( A ))
B

(2)

Shape Model

The standard shape model used to define the shape
information described in this paper is collected from the
initial X-rays obtained prior to cast application. The
segmentation on this X-ray image using the level-set
method introduced by Jiang [14] produces accurate results.
Following cast placement, segmentation can be quite
problematic.

3.6

Curve Evolving with global constraints

Suppose two contours, C1 and C2, have the same
shape. Then there exists a scale S, a rotation matrix R with
respect to an angle ș, and a translation vector T such that
C1 coincides with:
C2 new = SRC2 + T

(3)

Following the principle in (4), our active model is
designed to employ a new term: a prior shape. Therefore
the new active model is described as:
Let C(p) = (x(p),y(p)) (p İ [0,1]) denote a
differentiable parameterized curve in an image I. Let C* be
a curve representing the shape prior, and g|∇I(x,y)|) be the
function defined as:

B

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006

g|∇I(x,y)|) = 1 / (1 + |∇I(x,y)|2)

(4)

To get a smooth curve C that captures higher
gradients, the arc-length of C in the conformal metric ds =
g|∇I(x,y)|)C(p)|C(p)|dp is minimized. To capture the shape
prior C*, the curve C and the transformation S, R, T is
calculated such that the curve Cnew = SRC + T and C* are
perfectly aligned. The energy function to be minimized is:
λ

1

³ {g (| ∇I | (C ( p ))) + 2 d

min

C , μ , R ,T 0

2

( μ RC ( p ) + T )} | C ' ( p ) | dp

(5)

Where Ȝ > 0 is a parameter, and d(x,y) = d(C* ,(x,y))
is the distance of the point (x,y) from C* . The
minimization problem now can be solved by finding
steady state solutions to the following system:
∂ C
∂ t

=

− vn , C ( 0 , p ) = C

0

∂μ
= −λ
∂t

³ d∇ d

⋅ RC | C ' ( p ) | dp , μ ( 0 ) = μ

∂θ
= − λμ
∂t

³ d∇ d

⋅(

∂T
− λ
∂t

³ d∇ d ⋅ | C

dR
C ) | C ' ( p ) | dp , θ ( 0 ) = θ
dθ
'

Fig. 3. Experiment results: Blue color shows the
initial curve, yellow color shows the final result.

(6)

( p )

0

0

( p ) | dp , T ( 0 ) = T 0

The curve evolves as:

v = ∇ g ⋅ n + gk + λ s ( d ∇ d ) ⋅ ( Rn ) + λ d 2 k

(7)

where n is the outward unit normal to C, and k is the
curvature of the curve C. The function d is evaluated at
SRC(p) + T. The mutual transformation function is defined
as:
max(AreaOverlap(CruveA,
CurveB)
and
min(CurveDifference(CurveA,CurveB).

Fig. 4. Bone Alignment calculation result

5
4

Result

We have tested our algorithm on more than 10 cases.
The results showed that our algorithm is robust and
accurate. Figure 3 shows some of the result. The final
evolving process is in yellow colour, and the blue colour
shows the initial position of the evolving curve. The initial
curve evolved till the energy of the evolving function is
minimized.
One case failed to segment successfully by our
algorithm in which the fracture can barely recognized by
our expert radiologist due to poor contrast of the image.
Some results are presented in Figure 3 and Figure 4.

Discussion

We have provided a model-based segmentation
method that can be used to segment fractured bones on the
X-ray image of a human arm. Our method can also be
applied to other segmentation tasks. Our approach is
computational
efficient
and
produces
accurate
segmentation result. Future work to this research project is
to investigate an automatic curve initialization procedure.

Acknowledgement This research is supported by the
discovery grant of the Natural Science and Engineering
Research Council (NSERC) of Canada.

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006

Max-Relevance, and Min-Redundancy, IEEE transactions on

References
[1]Schwartzkopt, W. C.,

Bovik,

Maximum-Likelihood

Techniques

Segmentation-Classification

of

A. C.,

Evans, B. L.:
for

Multispectral

Joint

Chromosome

pattern analysis ands machine intelligence, 27 (2005) 1226-1238
[14]. Y jiang, X-ray bone fracture subtraction using geodesic
active contour and mathematical morphology operations,
Computer Assisted Radiology and Surgery, London, UK, (2003)

Images. IEEE transactions on medical imaging. 24 (2005)
1593–1610
[2]McInerney, T., and Terzopoulos, D.: Deformable models in
IEEE Computer Society,

medical image analysis: A survey.
(1998) 127-146

[3] Kass, M., Witkin, A., and Terzopoulos. D., Snakes: Active
Contour model, International Journal of Computer Vision, (1988)
321-333
[4]McInerney, T., and Terzopoulos, D., Topologically adaptable
snakes, in proceedings of the International Conference on
Computer Vision, IEEE Publications, Los Alamitos, CA, (1995)
[5] Sethian, J. A.: Level Set methods and fast marching methods,
Cambridge Press, 1999
[6] Sapiro G.: Geometric Partial differential equations and image
analysis, Cambridge University Press, New York (2001)
[7] Staib, L., and Duncan, L.: Boundary finding with
parametrically deformable models, IEEE transactions on pattern
analysis and machine intelligence, 14 (1992) 1061-1075
[8]Wang,

Y.,

and

Staib,

L.:

Boundary

finding

with

correspondence using statistical shape models, Proceedings from
IEEE Conference on Computer Vision and Pattern Recognition,
(1998) 338 – 345
[9]Lenventon, M. E., Grimson, W-E. L., and Faugeras, O.:
Statistical shape influence

in geodesic active

contours,

Proceedings from IEEE Conference on Computer Vision and
Pattern Recognition, (2000) 316 – 323
[10]Chen, Y., Thiruvenkadam, S., Tagare, D. H., et al :On the
incorporation of shape priors into geometric active contours,
Proceedings from IEEE Workshop on Variational and Level set
method, (2001) 145-152
[11]Serra, J.: Mathematical morphology, Academic Press, (1982)
[12] Rosenfeld, A. and Pfaltz, J.: Distance Functions on Digital
Pictures, Pattern Recognition, Vol. 1, (1968) 33 – 61
[13]Peng, H., Long, F., Ding, C.: Feature selection based on
mutual

information:

Criteria

of

Max-Dependency,

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006


Estimating Reﬂectance Parameters of an Object from Saturated Spectral
Images
Shiying Li, Yoshitsugu Manabe, Kunihiro Chihara
Image Processing Laboratory
Graduate School of Information Science
Nara Institute of Science and Technology (NAIST)
{jitsu-ri, manabe, chihara}@is.naist.jp
Abstract
A method is described to reproduce reﬂection properties
at the surface of real objects using spectral images, which
are often saturated because of the limited dynamic range of
image detectors. Reﬂection components are separated into
diffuse and specular reﬂection components based on the
dichromatic model at 5-nm wavelength intervals between
380nm and 780nm for each pixel of the spectral images,
and diffuse reﬂectance parameters are estimated during
the separation. To estimate specular reﬂectance parameters, the Gaussian distribution function of the TorranceSparrow reﬂection model is transformed logarithmically to
a linear form, and the unsaturated values of the specular
reﬂection components are subjected to the least squares
method. Experimental results with a real object demonstrate the efﬁciency of the proposed method.
Keywords—Reﬂectance parameters, spectral images, color
reproduction, specular reﬂection

1 Introduction
In computer graphics (CG) and computer vision (CV),
it is important to be able to measure and model reﬂection
properties at the surface of real objects, especially for the
emerging applications of digitally preserving cultural heritage, virtual shopping, and of creating augmented environments with imaginary and real objects for entertainment,
etc.
Estimating reﬂectance parameters from reﬂection models can reproduce the reﬂection properties without storing
huge numbers of pictures, as with the methods with bidirectional reﬂectance distribution function (BRDF) images.
There are two approaches to estimate the reﬂectance parameters: one is to apply a curve-ﬁtting technique using a
non-linear least squares method, without separating reﬂection components; the other is to separate reﬂection components into diffuse and specular reﬂection components
based on the dichromatic reﬂection model [1], and then

to estimate diffuse and specular reﬂectance parameters, respectively. A number of methods for the latter approach
have been developed, based on differences either in polarization [2] or in color [1, 3, 4, 5, 6, 7, 8] between diffuse
and specular reﬂection, or in a combination of polarization
and color [9].
These methods are effective to separate reﬂection components; however, they use color images captured by a red,
green and blue (RGB), i.e. three-channel camera for estimation of diffuse reﬂectance parameters. Since the images are acquired by intergrating spectra with only three
selected RGB color ﬁlters, they may be inadequate representations of the intrinsic spectral distribution of the reﬂected light on the target object because of factors such
as metametric match. As a result of signiﬁcant advances
in graphics hardware and increasingly stringent demands
for quality of realistic images in recent years, more and
more studies using multispectral images are being reported
in CG and CV [10, 11, 12, 13].
Another problem in estimating reﬂectance parameters
accurately is that commercial image detectors have a limited dynamic range. An obtained image is often too dark in
some areas and perhaps saturated in others; in both such
cases, textured information may be unmeasurable. Up
to now, most studies have assumed the obtained images
are not saturated by controlling the intensity of incident
light; however, it is difﬁcult to ensure that images have accurate texture information in dark areas. Several studies
have focused on obtaining a desired response function by
capturing images under different exposure times or shutter speeds, and reconstructing high dynamic range images
as input images [14, 15, 16]. To solve this problem, we
have introduced a method to estimate specular reﬂectance
parameters from saturated specular reﬂection components
with simulation data, which were generated based on the
Torrance-Sparrow reﬂection model [17], and with data separated from the reﬂection components of the spectral im-

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006

ages, which were measured at one line of area on the target
object. Those studies yielded accurate results [18, 19].
In this paper, the method proposed in the previous work
is applied to estimate reﬂectance parameters at the surfaces of an object, using spectral images. The spectral
images are obtained by an imaging spectrograph equipped
with a monochrome CCD camera, and a light source rotating around an object placed on a turntable. We describe
experiments and demonstrate the reﬂection properties reconstructed using the experimental results.

2 Reﬂection models
For dielectric objects, such as plastic and ceramic objects, reﬂection properties at the surface are measured as a
linear summation of diffuse and specular reﬂection, which
is known as the dichromatic reﬂection model [1]. For diffuse reﬂection, the Lambertian model [20] is generally applied, and for specular reﬂection, the Torrance-Sparrow reﬂection model [17] is considered as a physically based reﬂection model in CG and CV. In our method, these two
reﬂection models are applied to the diffuse and specular
reﬂection components, respectively. The equations of the
Lambertian reﬂection model and the Torrance-Sparrow reﬂection model are shown in Equation (1) and Equation (2):
Id = Kd cos ϕ

(1)

Is = F GKs exp(−(σθ)2 )/ cos ϕ

(2)

where Id and Is are diffuse and specular reﬂection components, respectively. Kd represents diffuse reﬂectance
parameters, which are estimated at each wavelength in the
visual region between 380nm and 780nm. F represents a
function of the Fresnel reﬂectance, and G represents the
geometrical attenuation factor. ϕ is the incident angle, and
θ is the angle between the normal vector at the surface of an
object and the half-vector of the incident light vector and
viewer vector. Ks and σ are specular reﬂectance parameters, for intensity of specular reﬂection and the standard
deviation of the Gaussian distribution, respectively. Kd ,
Ks and σ are the reﬂectance parameters to be estimated in
this work.

3 Methods
Based on these reﬂection models, reﬂection components are separated into diffuse and specular reﬂection
components; reﬂectance parameters are then estimated
from the two reﬂection components.

3.1 Separating reﬂection components
Given that the intensity of the reﬂected light at the surface of objects changes with the incident angle, a measurement system is constructed with a light source rotating around the target object, and an imaging spectrograph
equipped with a monochrome CCD camera, which is ﬁxed
in front of the target object, as shown in Figure 1(a). The
target object is rotated on a turntable to capture spectral
images of the whole target object.
Reﬂection components are obtained at different incident
angles, as shown in Figure 1(b). The reﬂecion components
are separated using a separation algorithm [18], which is
summarized as follows: ﬁrst, hypothesize the reﬂection
components at each wavelength as being diffuse reﬂection
components only, and then estimate the temporary diffuse
reﬂectance parameter by the least squares method, and
compute temporary diffuse reﬂection components by applying the Lambertian reﬂection model. Second, subtract
the temporary diffuse reﬂection components from the original reﬂection components, and consider values greater
than zero as temporary specular reﬂection components.
Finally, subtract the temporary specular reﬂection components from the original reﬂection components, and replace
the reﬂection components with the result, and then repeat
the procedure from the ﬁrst step until the difference between the current temporary diffuse reﬂectance parameters
and the previous one is no greater than a threshold. In this
way, the reﬂection components are separated into diffuse
and specular reﬂection components, and the current temporary diffuse reﬂectance parameter is considered as the
diffuse reﬂectance parameter at that wavelength.

3.2 Estimating specular reﬂectance parameters
Specular reﬂection components are obtained by subtracting diffuse reﬂection components from the original reﬂection components, as shown in Figure 2(a).
Figure 2(a) also shows that the specular reﬂection components are saturated at small incident angles with different
levels at different wavelengths. If, as with existing methods, the specular reﬂection components are considered to
be unsaturated, the specular reﬂectance parameters for the
intensity of the specular reﬂection and the standard deviation of the Gaussian distribution are estimated inaccurately. To solve this problem, an algorithm was proposed
in [18]. The Fresnel reﬂectance function and the geometric
attenuation factor are assumed as constants, Equation (2)
is transformed logarithmically into a linear form as shown
in Equation (3), and the unsaturated values of the specular reﬂection components are subjected to the least squares
method, as shown in Equation (4).
log(Is ) = log(Ks ) − (σθ)2 − log(cos ϕ)

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006

(3)

Incident light

300

Target object

Half-vector
H

θ

Normal N

Intensity

250
90o

φ

-90o

200
150
100
50

0o

0
1
-90

121
0

241
90

Camera

Incident angle (degrees)

(a)

(b)

Figure 1: (a) Measurement system and the relation between incident and reﬂected direction. (b) Reﬂection components
measured at 580nm.
300
250
200

generated data

400

550nm
650nm
720nm

Intensity

Intensity

Measured data

500

150
100

300
200
100

50

0
0

1
-90

-90

0

121
0

241
90

90

Incident angle (degrees)

Incident angle (degrees)

(a)

(b)

Figure 2: (a) Experimentally separated specular components at different wavelengths. (b) Generated reﬂection components
using the reﬂectance parameters estimated at 580nm.

s

=

(log(Isj )
j=0

−

(log Ks − (σ 2 ϕ2j /4) − log(cos ϕj )))2

(4)

In Equation (4), Isj represents measured reﬂection components, and j represents light source position. Note that
θ=ϕ/2, since the two angles have the relation between the
incident and reﬂected direction in the measurement system
(Figure 1(a)). When the sum s of the square of the difference between the measured reﬂection components Isj
and the theoretical reﬂection components calculated based
on the Torrance-Sparrow reﬂection model is minimized,
the specular reﬂectance parameters for the intensity of the
specular reﬂection Ks and the standard deviation σ of the
Gaussian distribution are determined.
The algorithm to estimate specular reﬂectance param-

eters is described in detail in previous work [19]. The
standard deviation of noise from the measurement system
is obtained to eliminate the saturated values, and values
lower than (maximum − standard deviation of noise) of
the specular reﬂection components are subjected to the
least squares method, and then specular reﬂectance parameters Ks and σ are estimated from Equation (4).

4 Experiments
We conducted experiments using spectral images captured with the measurement system in a dark space. The
light source rotates between −90o and 90o at 0.75o intervals around the target object, and the turntable for the object moves 360o at 2.5o intervals. We used a cylindrical
object as the target object, each half of which was covered

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006

with gloss or matte photo paper, each printed with a 6-color
check pattern (magenta, blue, cyan, green, yellow and red),
so that we could verify our methods with strong and weak
specular reﬂection on an object. We arranged areas of the
gloss and matte photo paper with the same color at either
the top or middle, and some other color at the bottom, and
painted glue on parts of the matte and gloss photo paper to
vary reﬂection properties on the surface.
After eliminating the inﬂuence of the light source and
the CCD camera, we separated the reﬂection components
at 5-nm intervals between 380nm and 780nm for each pixel
of the spectral images, and estimated the diffuse and specular reﬂectance parameters at each wavelength.
From the measured reﬂection componennts shown in
Figure 1(b), the diffuse reﬂectance parameter Kd at that
wavelength was estimated as 0.210, the intensity parameter
Ks for specular reﬂection was 388.978, and the standard
deviation of the Gaussian curve σ was 4.020. Figure 2(b)
showes the generated reﬂection components using these
estimated reﬂectance parameters, compared with the measured reﬂection components at 580nm for magenta. The
diffuse reﬂectance parameters estimated at 5-nm wavelength intervals between 380nm and 780nm are shown in
Figure 3, compared with the spectral reﬂectance of the
same colors measured by a spectroradiometer.
The dichromatic reﬂection model assumes that specular
reﬂection changes little with the wavelength of the incident light for dielectric objects. Therefore, we consider the
average of the specular reﬂectance parameters Ks and σ
of the same pixel, which are estimated at 5-nm wavelength
intervals between 380nm and 780nm, as the Ks and σ at
that pixel. We generated gray scale images of i) the intensity of specular reﬂection, by transforming logarithmically
the estimated specular reﬂectance parameters Ks ; and ii)
the values 1/σ of the standard deviation σ of Gaussian
distrubution, which represent the roughness of the object
surface, as shown in Figure 4 and Figure 5, respectively.

5 Discussion
Using the methods described in this paper, reﬂection
components are separated into diffuse and specular reﬂection components at each wavelength, and diffuse reﬂectance parameters are estimated during the separation.
From the specular reﬂection components, specular reﬂectance parameters are estimated by applying the least
squares method to the unsaturated values. Figure 2(b)
shows that the generated reﬂection components are in good
agreement with the measured reﬂection components, and
that, at angles close to 0o , the intensity of the generated
reﬂection components replaced values that were saturated
in measured reﬂection components because of the limited
dynamic range of the CCD camera.

Figure 3 shows that the spectral reﬂectance of colors
is estimated accurately on either the matte photo paper or
the gloss photo paper, except that at wavelengths shorter
than about 430nm, the diffuse reﬂectance parameters are
estimated insufﬁciently. Since, at short wavelengths, the
spectral sensitivity of a camera is low, and the emittance
of a light source (such as a halogen light) is inefﬁcient,
estimation of reﬂectance parameters from measured reﬂection components with low S/N ratio is a remaining research
problem.
In Figure 4, the bright and dark areas show the gloss and
matte photo paper, respectively; and the gray stains on the
bright areas as well as the stain on the lower dark area show
the glue which we painted on the gloss and matte photo
paper. The results in Figure 4 demonstrate that stronger
specular reﬂection is observed on the gloss than on the
matte photo paper, in agreement with the physical properties of the two kinds of paper. In Figure 5, the brighter
areas (i.e., the greater values) show the rougher, and the
darker areas show the smoother surfaces of the object. Figure 5 shows that the gloss photo paper is smoother than the
matte photo paper, and that the area of the gloss (matte)
photo paper covered with glue is rougher (smoother) than
the unglued area of the gloss (matte) photo paper, and that
the boundaries between the two different paper are the
roughest, as indeed they are on the real object.

6 Conclusions
A method is described to estimate reﬂectance parameters from spectral images without requiring color segmentation. As evidenced by the experimental results on
a cylindrical object, spectral distribution of colors is estimated accurately, and specular reﬂectance parameters are
estimated efﬁciently, despite the limited dynamic range of
a camera. More experiments with different kinds of objects
will be carried out for our future work.

Acknowledgement
We thank Dr. Ian Smith for his checking of the paper
and his valuable comments.

References
References
[1] S. A. Shafer. Using color to separate reﬂection components. Color Research and Application. Vol.10.
pp.210-218. 1985.
[2] L. B. Wolff and T. Boult. Constraining object features
using polarization reﬂectance model. In IEEE Transations on Pattern Analysis and Machine Intelligence.
No.7. Vol.13. pp.635-657. 1991.

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006

Standard spectral distribution
Estimated diffuse parameters

0.8

1.0

Reflectance

Reflectance

1.0

0.6
0.4
0.2

Standard spectral distribution
Estimated diffuse parameters

0.8
0.6
0.4
0.2

0.0

0.0
1
380

11

21
480

31

41
580

51

61
680

71

81
780

Wavelength (nm)

1
380

11

21
480

31

41
580

51

61
680

71

78081

Wavelength (nm)

(a)

(b)

Figure 3: Spectral distribution of magenta: (a) Matte photo paper. (b) Gloss photo paper.

Above
410.90
328.72
246.54
164.36
82.18
0.00

Figure 4: Generated gray scale image for specular reﬂectance parameters Ks .
[3] G. J. Klinker, S. A. Shafer and T. Kanade. The measurement of highlights in color images. International
Journal of Computer Vision. Vol.2. pp.7-32. 1988.
[4] R. Bajscy, S. W. Lee and A. Leonardis. Detection
of diffuse and specular interface reﬂectance by color
image segmentation. International Journal of Computer Vision. No.3. Vol.17. pp.249-272. 1996.
[5] Y. Sato and K. Ikeuchi. Temporal-color space analysis of reﬂection. Journal of the Optical Society of
America A. No.11. Vol.11. pp.2990-3002. 1994.
[6] Y. Sato, M.D. Wheeler and K. Ikeuchi. Object shape
and reﬂectance modeling from observation. Computer Graphics. Vol.31. pp.379-388. 1997.

[7] T. Machida, N. Yokoya and H. Takemura. Surface
reﬂectance modeling of real objects with interreﬂection. In Proceedings of International Conference on
Computer Vision. Vol.1. pp.170-177. 2003.
[8] R. T. Tan and K. Ikeuchi. Separating reﬂection components of textured surfaces using a single image.
IEEE Transactions on Pattern Analysis and Machine
Intelligence. No.2. Vol.27. pp.178-193. 2005.
[9] S. Nayar, X-F. Fang and T. Boult. Separation of reﬂection components using color and polarization. International Journal of Computer Vision. No.3. Vol.21.
pp.163-186. 1996.

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006

62.65
50.12
37.59
25.06
12.53
0.00

Figure 5: Generated gray scale image for specular reﬂectance parameters σ.
[10] J. S. Gondek, G. W. Meyer and J. G. Newman.
Wavelength dependent reﬂectance functions. Computer Graphics. Vol.28. pp.213-220. 1994.
[11] Y. Manabe and S. Inokuchi. Recognition of material
types using spectral images. In Proceedings of International Conference on Pattern Recognition. pp.840843. 1996.
[12] R. Lenz, P. Meer and M. Hauta-Kasari. Spectralbased illumination estimation and color correction.
Color Research and Application. No.2. Vol.24. pp.98111. 1998.
[13] Y. Sun, F. D. Fracchia, M. S. Drew and T. W. Calvert.
A spectrally based framework for realistic image synthesis. Visual Computer. No.7. Vol.17. pp.429-444.
2001.
[14] P. E. Debevec and J. Malik. Recovering high dynamic
range radiance maps from photographs. In Proceedings of SIGGRAPH. pp.369-378. 1997.
[15] S. K. Nayar and T. Mitsunaga. High dynamic range
imaging: spatially varying pixel exposures. In Pro-

ceedings of IEEE Conference on Computer Vision
and Pattern Recognition. Vol.1. pp.472-479. 2000.
[16] M. D. Grossberg and S. K. Nayar. High dynamic
range from multiple images: which exposures to combine? In Proceedings of ICCV Workshop on Color
and Photometric Methods in Computer Vision. 2003.
[17] K. E. Torrance and E. M. Sparrow. Theory of offspecular reﬂection from roughened surfaces. Journal of the Optical Society of America A. Vol.57.
pp.1105-1114. 1967.
[18] S. Y. Li, Y. Manabe and K. Chihara. Color and gloss
reproduction from multispectral images. In Proceedings of IS&TSPIE conference on Electronic Imaging.
Vol.5667. pp.170-177. 2005.
[19] S. Y. Li, Y. Manabe and K. Chihara. Estimating specular parameters from saturated spectral images. In
Proceedings of IS&TSPIE conference on Electronic
Imaging. Vol.6062. pp.606208-1-10. 2006.
[20] J. H. Lambert. Photometrica sive de mesura de fratibus liminis. Colorum et Umbrae. Eberhar Klett.
Augsberg. Germany. 1760.

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006


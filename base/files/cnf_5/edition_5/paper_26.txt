Improved Three-step Phase Shifting Proﬁlometry Using Digital Fringe Pattern
Projection
Yingsong Hu1,2 , Jiangtao Xi1,2 , Joe Chicharo1 and Zongkai Yang2
School of Electrical Computer and Telecommunications Engineering,
University of Wollongong, NSW 2522, Australia.
2
Department of Electronic and Information Engineering,
Huazhong University of Science and Technology, Wuhan City, 430074, China.
1

Abstract
In this paper, an improved method for three-step phase
shifting proﬁlometry (PSP) is presented to eliminate the errors introduced by the second order harmonic when digital
projection are used to generate fringe patterns. Firstly, the
error caused by the second order harmonic is theoretically
analyzed. Then based on the error analysis and principle of
PSP, we propose a novel approach, called improved threestep phase shifting proﬁlometry (I3PSP), to eliminate the inﬂuence of the second order harmonic. Finally, simulations
are performed to verify the effectiveness of the proposed
I3PSP, which demonstrate that the reconstruction accuracy
of using three-step PSP has been signiﬁcantly improved by
the proposed I3PSP.

1

Introduction

Fringe pattern proﬁlometry (FPP) is one of the most
popular non-contact approaches to reconstructing threedimensional object surfaces. With FPP, a Ronchi grating
or sinusoidal grating is projected onto a three-dimensional
diffuse surface, the height distribution of which deforms the
projected fringe patterns and modulates them in phase domain. Hence by retrieving the phase difference between the
original and deformed fringe patterns, three-dimensional
proﬁlometry can be achieved. In order to obtain phase maps
from original and deformed fringes patterns, researchers
contributed various analysis methods, including Fourier
transform proﬁlometry(FTP) [2, 13, 14, 16, 17, 20], phase
shifting proﬁlometry (PSP) [11, 12, 15], spatial phase detection (SPD) [18], phase locked loop (PLL) [10] and other
analysis methods [9, 19].
Among these methods, phase shifting proﬁlometry (PSP)
is one of the most popular approach to carrying out threedimentional reconstruction, because it is not sensitive to the

background and the reﬂection factor of surfaces. With PSP,
N (N ≥ 3) frames of fringe patterns with 2π/N phase shift
between each other are sequentially projected onto the reference plane and the surface of the object, and captured by
a CCD camera. Then the N images are processed by using
PSP algorithm and the height distribution of the surface can
be calculated.
As mentioned above, PSP needs at least three steps of
phase shifting. Therefore, three-step PSP is very important
for PSP technique because it provides the smallest number
of phase shifting steps, the least amounts of acquired images and the shortest measurement time when using PSP
technique. Additionally, three-step PSP is the only method
to implement colour channel based PSP [6].
Meanwhile, in recent years, because of the simplicity
and controllability, digital projection is widely used to generate sinusoidal fringe patterns [3, 5, 6, 8]. However, when
employing digital projectors, nonlinear distortions are unavoidably introduced and result in visible measurement errors [3, 5], which has been theoretically analyzed in [5, 7].
As nonlinear distortions result in the harmonics components, digital ﬁlters are commonly utilized to eliminate the
harmonics and pick fundamental components. However, as
pointed out by Hu et al., because ideal digital lowpass (or
bandpass) ﬁlters are physically unrealizable, the signals ﬁltered by lowpass ﬁlters are still not be pure sinusoidal [5].
Due to the non-ideal lowpass ﬁltering, compared with the
fundamental component, the harmonics higher than third
order can be ignored, but the second and the third order harmonics might still exist in the ﬁltered fringe patterns. Meanwhile, as three-step PSP is very sensitive to the second order
harmonic but not sensitive to the third order harmonic [4,5],
in order to further improve the reconstruction accuracy for
three-step PSP, the inﬂuence of the second order harmonics
has to be eliminated. Huang et al. have proposed a ‘double three-step PSP’ method to reduce the inﬂuence of the
second order harmonics. However, with this approach three

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006

extra images are needed, which is as many as six-step PSP
method does, so that extra images and measurement time
are required. In this paper, we present a new method to
achieve accurate three-dimentional surface reconstruction
based on three-step PSP without introducing extra images.
This paper is organized as follows. In section 2, we
brieﬂy review the principle of PSP and analyze the errors
introduced by the second order harmonics. In section 3 the
improved three-step PSP (I3PSP) is proposed. Based on the
proposed approach, simulations are performed to demonstrate the improvement of the proposed I3PSP in Section 4.
Section 5 concludes this paper.

2

Principle of PSP and Error Analysis

A schematic diagram of a typical FPP system is shown
in Fig.1. For simplicity, we consider a cross section of the

for n = 1, 2, 3.
+∞

dn (x)

=

ak cos(k · (2πf0 x +
k=0

(1)
2π(n − 1)
) + kφ(x))
3

for n = 1, 2, 3.

(2)

where f0 is the spatial frequency of the fringe patterns and
φ(x) is the phase shift caused by the proﬁle of the object,
which contains the information about the height distribution
of objects. ak is the amplitude of the k-th order harmonics
of the fringe patterns. Obviously, k = 0 represents the direct component. n denotes the n-th step of the PSP.
In order to eliminate harmonics and obtain fundamental
components of sm (x) and dm (x), lowpass ﬁlters are commonly utilized. If the lowpass ﬁlter is ideal, the dc and fundamental components of sn (x) and dn (x) will be picked
up [1], which can be expressed as:
s¯n (x)

= a0 + a1 cos(2πf0 x +
for n = 1, 2, 3.

d¯n (x)

=

2π(n − 1)
)
3

(3)
2π(n − 1)
+ φ(x))
a0 + a1 cos(2πf0 x +
3
for n = 1, 2, 3.
(4)

Then phase map φ(x) and the height distribution of the object can be calculated by following equations:
S¯

S¯A
= tan(2πf0 x) = ¯
SB
=

Figure 1. Schematic diagram of FPP system
object surface for a given y coordinate. Hence, the intensity
of fringe patterns captured by CCD camera and the height
distribution function can be expressed as a function with
single variable x. Thus we use s(x) and d(x) to denote the
intensity of the projected and deformed fringe pattern respectively and use h(x) to represent the height distribution
of the object surface.
In three-step PSP approach, three fringe patterns are sequentially projected onto the reference plane and the surface
of the object and captured by a CCD camera. Each one of
2π
from
the three fringe patterns has phase difference of
3
the others. Meanwhile, because of the existence of nonlinear distortions in the system, high order harmonics are introduced into the captured fringe patterns sn (x) and dn (x),
which can be expressed as:
+∞

sn (x)

=

ak cos(k · (2πf0 x +
k=0

2π(n − 1)
))
3

¯
D

=
=

φ(x)

h(x)

=
=

2π(n − 1)
3
2π(n − 1)
3
¯n (x) cos
n=1 s
3
¯A
D
tan(2πf0 x + φ(x)) = ¯
DB
2π(n
− 1)
3
− n=1 d¯n (x) sin
3
2π(n − 1)
3
¯
n=1 dn (x) cos
3
¯
unwrap(arctan(D))
¯
−unwrap(arctan(S))
−

3
¯n (x) sin
n=1 s

l0 φ(x)
φ(x) − 2πf0 d0

(5)

(6)

(7)
(8)

¯ are intermediate variables. d0 and l0 are the
where S¯ and D
distance from the camera to the projector and the reference
plane, respectively. unwrap denotes the operation of phase
unwrapping.
However, as mentioned in Section 1, because of the nonideal lowpass ﬁlters, s¯n and d¯n can not be exactly obtained.
The second order harmonic components will exist in the ﬁltered signals and have the strongest power in harmonics.

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006

Meanwhile, as three-step PSP is not sensitive to the third order harmonics and the power of the harmonics higher than
the third order will be weak enough to be ignored, for our
analysis, the actually obtained signals sˆn and dˆn can be expressed as:
sˆn (x)

dˆn (x)

2π(n − 1)
)
3
2π(n − 1)
+b cos(2θ(x) + 2 ·
)
3
for n = 1, 2, 3.
(9)
2π(n − 1)
+ φ(x))
= a0 + a1 cos(θ(x) +
3
2π(n − 1)
+b cos(2θ(x) + 2 ·
+ 2 · φ(x))
3
for n = 1, 2, 3.
(10)
=

Improved Three-step PSP

As analyzed in Section 2, we have to design an algorithm
to reconstruct phase map from sˆn (x) and dˆn (x) and at the
same time eliminate the errors introduced by the second order harmonics.
If we use sˆn instead of s¯n to calculate the numerator of
Eq.(5), we will have:
SˆA

=

2π(n − 1)
−
sˆn (x) sin
3
n=1

=

−[a0 + a1 cos(θ +

2π
) + b cos(2θ +
3
4π
) + b cos(2θ +
−[a0 + a1 cos(θ +
3
3
· [a1 sin(θ) − b sin(2θ)]
2

SˆB

=
=

sˆn (x) cos

4π
2π
)] · sin
3
3
8π
4π
)] · sin
3
3
(11)

n=1

2π(n − 1)
3

a0 + cos θ

2π
) + b cos(2θ +
3
4π
) + b cos(2θ +
+[a0 + a1 cos(θ +
3
3
· [a1 cos(θ) + b cos(2θ)]
=
2
+[a0 + a1 cos(θ +

By simply removing the direct component of Pˆ , we can
have a signal P whose frequency is the three times of fundamental frequency of the fringe pattern:
P =

9
a1 b cos(3θ)
2

(14)

Obviously, by obtaining P the second order harmonic has
been completely removed and only the signal with three
times of fundamental frequency is remained.
Similarly, using dˆn (x) instead of d¯n (x) we can calculate
ˆ B respectively:
ˆ A and D
D
ˆ A = 3 · [a1 sin(θ + φ) − b sin(2θ + 2φ)]
D
2
3
ˆ
DB = · [a1 cos(θ + φ) + b cos(2θ + 2φ)]
2

(15)
(16)

ˆ =
Q

and for calculating the denominator of Eq.(5), we can have:
3

(SˆA )2 + (SˆB )2
9
[a1 sin(θ) − b sin(2θ)]2
=
4
9
+ [a1 cos(θ) + b cos(2θ)]2
4
9 2
[a + b2 + 2a1 b(cos θ cos 2θ − sin θ sin 2θ)]
=
4 1
9 2
[a + b2 + 2a1 b cos(3θ)]
(13)
=
4 1

=

and

3

=

Pˆ

a0 + a1 cos(θ(x) +

where θ(x) = 2πf0 x and b is the amplitude of the second
order harmonic after the lowpass ﬁltering. If we use sˆn and
dˆn instead of s¯n and d¯n to calculate phase map φ(x) and
height distribution h(x), errors will be introduced [5, 7].

3

use of the relationship between SˆA and SˆB , the terms of
the second order harmonic can be removed. Let us try to
calculate Pˆ :

4π
2π
)] · cos
3
3
8π
4π
)] · cos
3
3

ˆ A )2 + (D
ˆ B )2
(D
9 2
[a + b2 + 2a1 b cos(3θ + 3φ(x))]
=
4 1

(17)

ˆ we can have:
By removing the direct component of Q,
Q=

9
a1 b cos(3θ + 3φ(x))
2

(18)

Hence, the phase map φ(x) can be easily obtained from
P and Q. Let us denote the analytic signals of P and Q by
˜ respectively and use P˜ ∗ to represent the conjugate
P˜ and Q,
˜
of P . The phase map φ(x) can be calculated by:
φ(x) =

˜ · P˜ ∗ )]
Im[ln(Q
3

(19)

where ln denotes the natural logarithm, and Im represents
the imaginary part of a complex number. It can be seen that
(12) the phase map can be exactly retrieved and no extra errors
are introduced.
It can be seen that both of SˆA and SˆB are inﬂuenced by
In summary, the proposed I3PSP is implemented by following steps:
the second order harmonics. Fortunately, making a good

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006

1. Apply lowpass ﬁltering to the captured signals sn and
dn to obtain sˆn and dˆn ,
ˆ A and D
ˆB
2. Based on sˆn and dˆn to calculate SˆA , SˆB , D
by using Eqs.(11),(12),(15) and (16), respectively,
ˆ A and D
ˆB,
3. Calculate P and Q from SˆA , SˆB , D
4. Retrieve phase map by using Eq(19),
5. Reconstruct the hight distribution of the surface by
Eq.(8).

4

Simulations

In this section, simulations are performed to demonstrate
the signiﬁcantly improved reconstruction accuracy of using
I3PSP algorithm compared with traditional three-step PSP.
In our simulation, we use a paraboloid object surface whose
maximum height is 160mm, which is shown in Fig.2(d).

where f0 is the spatial frequency of the fringe pattern, which
is assumed to be 10/meter in our simulation. i.e. the spatial
period of the fringe pattern is assumed to be 100mm. Meanwhile, we assume l0 and d0 in Fig.1 equal to 5 meters and
2 meters respectively. The spatial resolution of the captured
image is assumed to be 1 pixel/mm.
Corresponding to Eq.(20), the fringe pattern deformed
by the proﬁle of the object can be expressed as: [13, 14]
2π(n − 1)
+ φ(x))
dˆn (x) = 128 + 100 cos(2πf0 x +
3
2π(n − 1)
+10 cos(2π · (2f0 )x + 2 ·
+ 2φ(x))
3
for n = 1, 2, 3. (21)
where φ(x) is the phase shift caused by the object surface.
The fringe patterns sˆn (x) and dˆn (x) are shown in Fig.2(a)
and (b) respectively. Fig.2(c) plots a cross section of the
fringe pattern demonstrated in Fig.2(a). In fact, we can
hardly distinguish this fringe pattern from a pure sinusoidal
one, although it has been distorted by the second order harmonic. However, this slight distortion will result in notable
reconstruction errors when using traditional three-step PSP.
the reconstruction result by using three-step PSP is shown
in Fig.3. It can be seen that the reconstructed surface by

Figure 2. Simulated fringe patterns and surface

Meanwhile, we assume that the amplitude of fundamental component is 100, and after lowpass ﬁltering, the second
order harmonic has only -20db of power compared with the
fundamental component, which is expressed as:
2π(n − 1)
)
3
2π(n − 1)
+10 · cos(2π · (2f0 )x + 2 ·
)
3
for n = 1, 2, 3.

Figure 3. Reconstruction result by using traditional three-step PSP

sˆn (x) = 128 + 100 · cos(2πf0 x +

(20)

using PSP method is jagged and not smooth.
In contrast, by our proposed I3PSP method, we can obtain a much smoother reconstruction result as shown in

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006

Fig.4. In order to show the improvement of the proposed

Figure 5. A cross section of the surface reconstructed by three-step PSP and I3PSP

References
Figure 4. Reconstruction result by using
I3PSP

I3PSP more clearly, we select a cross section of the surface to compare the reconstruction results as shown in Fig.5.
Solid lines in Fig.5(a) and (b) are the surface reconstructed
by using the traditional three-step PSP and using the proposed I3PSP, respectively. The dashed lines denote the true
values of the object surface. We can see that reconstruction
result by using traditional three-step PSP has undesired ripples, which implies visible errors are introduced although
the second order harmonic has only -20db of power compared with the fundamental component, whereas as shown
in Fig.5(b), the reconstruction result by using the proposed
I3PSP is almost identical to the true value of the height distribution.

5

Conclusions

In this paper, we proposed a new algorithm, called
I3PSP, to reconstruct three-dimentional surface based on
three-step phase shifting proﬁlometry technique. Compared
with traditional three-step PSP method, the proposed I3PSP
can signiﬁcantly reduce the inﬂuence of the second order
harmonics, which is the main error source of the traditional
three-step PSP. The measurement accuracy using three-step
PSP technique can be much improved by the proposed
I3PSP. The effectiveness and the improvement of I3PSP has
been completely conﬁrmed by our simulation results.

[1] F. Berryman, P. Pynsent, and J. Cubillo. A theoretical comparison of three fringe analysis method for determining the
three dimensional shape of an object in the present of noise.
Optics and Lasers in Engineering, 39:35–50, 2003.
[2] R. Green, J. Walker, and D. Robinson. Investigation of the
fourier-transform method of fringe pattern analysis. Optics
and Lasers in Engineering, 8:29–44, 1988.
[3] H. Guo, H. He, and M. Chen. Gamma correction for digital fringe projection proﬁlometry. Applied Optics, 43:2906–
2914, May 2004.
[4] K. Hibino, B. F. Oreb, D. I. Farrant, and K. G. Larkin. Phase
shifting for nonsinusoidal waveforms with phase-shift errors. Journal of the Optical Society of America A, 12:761–
768, April 1995.
[5] Y. Hu, J. Xi, E. Li, J. Chicharo, and Z. Yang. Threedimensional proﬁlometry based on shift estimation of projected fringe patterns. Applied Optics, 45:678–687, February 2006.
[6] P. Huang, Q. Ho, F. Jin, and F. Chiang. Colour-enhanced
digitial fringe projection technique for high-speed 3-D surface contouring. Opt Eng, 38:1065–1071, 1999.
[7] P. S. Huang, Q. J. Hu, and F.-P. Chiang. Double three-step
phase-shifting algorithm. Applied Optics, 41:4503–4509,
August 2002.
[8] L. Kinell. Multichannel method for absolute shape measurement using projected fringes. Optics and Lasers in Engineering, 41:57–71, 2004.
[9] A. Moore and F. Mendoza-Santoyo. Phase demodulation in
the space domain without a fringe carrier. Optics and Lasers
in Engineering, 23:319–330, 1995.
[10] R. Rodriguez-Vera and M. Servin. Phase locked loop proﬁlometry. Optics and Lasers Technology, 26:393–398, 1994.
[11] V. Srinivasan, H. Liu, and M. Halioua. Automated phasemeasuring proﬁlometry of 3-D diffuse objects. Applied Optics, 23:3105–3108, 1984.

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006

[12] H. Su, J. Li, and X. Su. Phase algorithm without the inﬂuence of carrier frequency. Optics Engineering, 36:1799–
1805, 1997.
[13] X. Su and W. Chen. Fourier transform proﬁlometry: a review. Optics and Lasers in Engineering, 35:263–284, 2001.
[14] X. Su, W. Chen, Q. Zhang, and Y. Chao. Dynamic 3-D shape
measurement method based on ftp. Optics and Lasers in
Engineering, 36:49–64, 2001.
[15] X. Su, W. Zhou, von Bally G, and D. Vukicevic. Automated
phase-measuring proﬁlometry using defocused projection of
ronchi grating. Optics Communication, 94:561–573, 1992.
[16] M. Takeda, H. Ina, and S. Kobayashi. Fourier-transform
method of fringe-pattern analysis for computer-based topography and interferometry. Journal of the Optical Society of
America A, 72:156–160, 1982.
[17] M. Takeda and K. Mutoh. Fourier transform proﬁlometry for
the automatic measurement of 3-D object shapes. Applied
Optics, 22:3977–3982, 1983.
[18] S. Toyooka and Y. Iwaasa. Automatic proﬁlometry of 3-D
diffuse objects by spatial phase detection. Applied Optics,
25:1630–1633, 1986.
[19] J. Villa, M. Servin, and L. Castillo. Proﬁlometry for the measurement of 3-D object shapes based on regularized ﬁlters.
Optics Communication, 161:13–18, 1999.
[20] J. Yi and S. Huang. Modiﬁed fourier transform proﬁlometry
for the measurement of 3-D steep shapes. Optics and Lasers
in Engineering, 27:493–505, 1997.

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 © 2006


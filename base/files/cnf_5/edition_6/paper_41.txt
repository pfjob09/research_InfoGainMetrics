Surface Hatching for Medical Volume Data
Yuan yuan Cai1Feng Dong2
1
AMAC, School of Engineering, Cranfield University, Bedfordshire, MK 43 0AL, UK
2
Department of Communication Systems, Lancaster University, Lancaster, LA1 4WA
2
y.y.cai.2004@cranfield.ac.uk
1
f.dong@lancaster.ac.uk

Abstract
This paper proposes a surface hatching technique
for the portrayal of medical subject from volume data.
By generating an intermediate iso-surface from volume
data and subsequently performing surface hatching on
the surface, the proposed technique provides an
effective Non-photorealistic approach for medical
visualization. The paper covers important technical
issues for the hatching including the generation of
silhouettes and strokes, the computation of stroke
visibility and illuminations. Experimental results are
provided.
Keywords: Non-photorealistic Rendering, Penand-Ink Illustration, Medical Visualization, Iso-surface

1. Introduction
Non-Photorealistic rendering (NPR) has attracted
great attentions from graphics community. Instead of
generating photorealistic images, NPR seeks to
produce images in artistic styles, such as painting, penand-ink illustration, etc. Recent research progress has
indicated that NPR is becoming an effective alternative
to conventional photorealistic images.
Pen-and-Ink illustration, which can also be named
as Pen-and-Ink Hatching, has been widely used in
medical community for many years. Apart from being
cheaper to print, pen-and-ink pictures are frequently
able to convey a higher level of information and
provide a greater focus than glossy, colored images.
Most of the existing work produces hatchings on
general surface models for artistic style illustration,
without taking into account distinctive features of
medical volume data. Aiming at a surface hatching
algorithm particularly designed for medical volume

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

data, the main contribution of this paper includes the
following methods:
•

Silhouette generation in volumes.

•

Stroke generation for various medical
subjects.

•

Stroke visibility determination using the
visibility information of volume data.

•

Stroke illumination based on volumes.

The reminder of the paper is organized as follows.
Section 2 introduces previous work; the main work is
described in Section 3. Section 4 contains results, and
Section 5 gives a summary and indications of future
work.

2. Previous work
As an important artistic style for NPR, Pen-andInk Hatching takes place either in image space or in
object space. Image-space hatching is capable of
producing strokes from images without 3D models
[9,10,13], while object-space hatching requires the
knowledge of 3D models. For example, Winkenbach
& Salesin [1] described the pen-and-ink hatching on
planar surfaces, which was followed by the extension
towards parametric surfaces in Winkenbach & Salesin
[2]; Elber [3,4] presented an interactive line-art
rendering method which used a preprocessing stage to
construct and classify strokes in order to apply the
techniques to freeform surfaces.

Obtaining appropriate directions for drawing
strokes is of great importance in NPR. Winkenbach &
Salesin [2] suggested the use of iso-parameter lines;
however in [3-6], the two directions of principal
curvature attracted lots of attention from researchers.
Silhouette detection and visibility computation are
the main obstacles to fast pen-and-ink hatching. To
speed up, Winkenbach & Salesin [1,2] constructed
BSP trees and used planar maps. Markosian et al. [7]
employed a modification of Appel’s hidden-line
method to determine the visibility of the detected
outlines of subjects and used randomized silhouette
detection. Benichou & Elber [8] used a Gaussian
Sphere to locate all of the object silhouettes under
orthographic projection. Hertzmann & Zorin [6]
proposed a method in which silhouette detection was
reduced to finding the intersection of a plane and a
surface.
It is not until recently that NPR began to bring
attentions in Medical Visualization. A number of
papers have been published in the area, for example,
Volume Illustration proposed by Ebert & Rheingans
[11] highlighted medical features such as boundary,
silhouettes, depth and orientation cues using NPR
illustrations; Treavett & Chen [12] generated pictures
in pen-and-ink style via direct NPR-based volume
rendering of 3D medical datasets; Dong et al
[15]developed Volumetric Hatching for pen-and-ink
styled volume rendering; Csebfalvi et al. [14] proposed
a method of visualizing object contours during volume
rendering; Interrante [5] illustrated surface shape in
volume data using strokes along principal curvature
directions. Then these strokes were used as textures to
increase the data opacity.

3. Surface Hatching for Medical Data
3.1. Overview
Figure 1 shows the pipeline of the algorithm.
The pipeline has several components: The input is a
volume data. Silhouette computation (Section 3.2) is to
compute silhouettes for the depicted subject in the volume;
Iso-surface is obtained using Marching Cubes, Lorensen &
Cline [16], on which the strokes will be generated (Section
3.3). The strokes will be subject to illumination calculation
(Section 3.4) and visibility checking (Section 3.5) before
drawing them in a 2D space.

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

Volume Data

Volume
Silhouette

IsoSurface

Strokes

Illumination

Visibility

Draw

Figure 1. Algorithm Overview

3.2. Silhouettes
The silhouette conveys the most important
information about the subjects. In practice, we have
found that the silhouette can be identified by single
threshold without identifying iso-surfaces.
The algorithm starts by finding the first segment of
the silhouette. It checks each cube in the volume,
considering its eight data points for their intensity
values and their normal. If the values do not span the
threshold, or if all of the normal face in the same
direction with respect to the viewpoint, the cube is
eliminated. Otherwise, the cube is split into five
tetrahedral – this can be done in either of two ways,
and adjacent cubes must take different ways to
maintain coherence, as illustrated in Figure.

Figure 2. Two Ways of Splitting Cubes into

stroke orientation at each vertex of the iso-surface. The
strokes can then be built by integrating along the
orientations.

Tetrahedral

From the intensity values and normal at the
vertices, the tetrahedron that contains the silhouette can
be identified. The iso-face inside this tetrahedron is
constructed, and the first segment of the silhouette
across the face is generated by linear or bilinear
interpolation (Figure 3).

Various approaches have been taken to define the
strokes for soft organs. These include using the
principal curvature directions for stroke directions,
placing textures, and drawing scattered points. The
stroke lines are long and are generated by integrating
from initial points, which are vertices on the mesh. The
distances between these points are relatively large in
order to produce a light tone. If texture is to be used,
we place the textures along the lines.
If scattered points are used, the number of black
points placed in each triangle is proportional to its
lighting intensity.

3.4. Illumination
Figure 3. An iso-surface (the dashed rectangle) with a
line (the bold line) for the silhouette.
Once the first segment of the silhouette is found, it
is traced into the neighboring tetrahedral or cubes to
find the remainder of the silhouette. Each time the
algorithm marches into a new cube, this cube is split
into five, and the same operation is applied to find the
line segments inside the cube. This continues until all
of the volume cubes have been visited.

3.3. Strokes
Observing pictures in medical books, one can see
that the artist lays down different strokes for different
types of medical subject. Shorter and more or less
straight lines are placed to depict hard materials such
as bones, and longer lines are used to portray relatively
soft organs such as the intestines. The tone in the
pictures of a bone normally appears to be darker than
in images of soft organs.
On bone surfaces, stroke directions at some
locations vary greatly, reflecting the bumpy surface of
bone. In contrast, the lines on soft organs are quite
smooth. Another observation is that sometimes people
use scattered points to draw organs such as the brain,
liver and lungs. All of these tactics have been
employed in our work.
To define the directions of the strokes on bones,
we choose the directions of minimal curvature. These
are good indications of the local geometry of the
surface and can be obtained without parameterizing the
surface. A direction field is generated to give the

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

Lighting is used to generate 3D effects in graphics.
The nature of pen-and-ink illustration means that basic
lighting models, such as the Phong, are suitable for the
hatching.
For a fixed area in a pen-and-ink illustration,
including more strokes produces a darker effect, while
using fewer strokes gives a lighter appearance. Thus,
illumination relates to the number of strokes in a
particular area. Hence, the illumination is performed
here by counting the number of strokes in the volume
cubes. The following discussion will focus on line
strokes as the illumination for point strokes is
straightforward.
Assuming that the number of 3D strokes produced
in Section 3.3 is sufficient to cover all of the volume
cubes heavily (otherwise, insert more data points to
produce more strokes), the illumination model counts
the number of strokes passing through a volume cube
and removes some, if there are too many. In detail, the
following steps are taken:
•

For a volume cube, calculate AveIntensity, the average
lighting intensity at the eight data points of the cube.
The number of strokes N in the cube is calculated using:

N = AveIntensity × Ratio + Base
where Ratio and Base are parameters that can be
set by user to control the tone. Increasing Ratio
gives greater contrast, while Base controls the
“ambient tone”.

•

Count the number of strokes in the volume cube. If
this is larger than N (over toned), cut one stroke,
that is, select a stroke and remove the segment of
that stroke that lies within the cube. Repeat this
until the number of strokes in the cube is equal to
N. In practice, we have found that the choice of
which stroke to cut is not significant, so the
strokes to be cut are selected randomly.

visible in the squares. The stroke could be totally
visible, invisible, or partially visible, depending upon
the marks on the projection.
Note that the visibility computing is an
independent component and its implementation does
not relate to any other aspect of the algorithm. There
are many existing works dealing with visibilities, and any
of these can be used here without altering the rest of the
algorithm.

4. Result
A

B
C

Figure 4. A 2D Illustration of the Lighting Mechanism.
Thebold stroke is cut from cube A and also from the
overtoned cubes B & C through which it passes.

•

If a stroke is selected for removal, check the other
cubes through which it passes. If any of these
cubes are over toned, cut the stroke from them,
too. Thus, if a stroke is cut from a volume cube, it
becomes the first candidate to be cut from the
other volume cubes (see Figure 4 for a 2D
explanation). This decreases the number of strokes
to be cut and reduces the creation of small,
scattered line segments.

The above computation takes place in object
space. This brings many benefits as the generated
scene is view independent, that is, we can change the
viewpoint without re-computing the illumination.

3.5. Visibility
The visibility of the strokes depends upon the
volume cubes they reside in. We use an intermediate
plane that is parallel to the image plane to determine
the visibility of the volume cubes. We place grids on
the plane whose square records the closest visible
volume cubes.
To compute the visibility of a stroke, we check its
projection on the intermediate plane. The projection is
recorded in terms of the collection of squares in the
grid through which it passes. Then we make visibility
marks on the projection, according to whether the
volume cubes within which the stroke resides are

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

We applied surface hatching on the medical data
including bones and soft organs. Figures 5, 6, 7 give
pictures for the iliac, femur, and scapula. Figure 8 is
an illustration of the brain using scattered points, and a
part of the human digestive system, including the
ileum, duodenum, and colon using strokes.

5. Conclusion of future work
We have presented a technique to generate penand-ink illustrations from medical volume data. By
generating an intermediate iso-surface from volume
data and subsequently performing surface hatching on
the surface, the proposed technique provides an
effective alternative to visualize and understand
medical dataset.
Our future work will concentrate on the
improvement of speed performance, and will also look
into the possible of extending the current work to
dynamic volume data, which captures subjects during
motion

6. Acknowledgements
This work was supported by EPSRC grant
EP/C006623/1

References
[1] G. Winkenbach, D.H. Salesin, “Computer-Generated
Pen-and-Ink Illustration”, Proc. SIGGRAPH’94, pp. 91100, 1994,
[2] G. Winkenbach, D.H. Salesin, “Rendering Parametric
Surfaces in Pen and Ink”, Proc. SIGGRAPH’96, pp. 469476, 1996
[3] G. Elber, “Line Art Illustrations of Parametric and
Implicit Forms”, IEEE Transactions on Visualization and
Computer Graphics, Vol.4, No.1, pp.71-81, 1998
[4] G. Elber, “Interactive Line Art Rendering of Freeform
Surfaces”, Computer Graphics Forum, Vol.19, No.3, pp.
1-12, 1999
[5] V. Interrante, “Illustrating Surface Shape in Volume Data
via Principal Direction-Driven 3D Line Integral
Convolution”, Proc. SIGGRAPH’97, pp. 109-116, 1997
[6] A. Hertzmann, D. Zorin, “Illustrating Smooth Surfaces”
Proc. SIGGRAPH’00, pp.517-526, 2000.
[7] L. Markosian, M.A. Kowalski, S.J. Trychin, L.D.
Bourdev, D. Goldstein, J.F. Hughes, “Real-Time
Nonphotorealistic Rendering”, Proc. SIGGRAPH’97, pp.
415-420, 1997.
[8] F. Benichou, G. Elber, “Output Sensitive Extraction of
Silhouettes from Polygonal Geometry”, Proc. Pacific
Graphics’99, Seoul, Korea, Oct. 1999.
[9] M.P. Salisbury, S.E. Anderson, R. Barzel, D.H. Salesin,
“Interactive
Pen-and-Ink
Illustration”,
Proc.
SIGGRAPH’94, pp.101-108, 1994.
[10] M.P. Salisbury, M.T. Wong, J.F. Hughes, D.H. Salesin,
“Orientable Textures for Image-Based Pen-and-Ink
Illustration”, Proc. SIGGRAPH’97, pp. 401-406, 1997.
[11] D. Ebert, P. Rheingans, “Volume Illustration: NonPhotorealistic Rendering of Volume Models”, IEEE
Visualization 2000, pp. 195-202, 2000.
[12] S.M.F. Treavett, M. Chen, “Pen-and-Ink Rendering in
Volume Visualisation”, IEEE Visualization 2000, pp.
203-210, 2000
[13] M. Salisbury, C. Anderson, D. Lischinski, D.H. Salesin,
“Scale-Dependent
Reproduction
of
Pen-and-Ink
Illustration” Proc. SIGGRAPH’96, pp. 461-468, 1996
[14] B. Csebfalvi, L. Mroz, H. Hauser, A. Konig, M.E.
Groller, “Fast Visualization of Object Contours by Non-

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

Photorealistic Volume Rendering”, Computer Graphics
Forum, Vol. 20, No.3, pp. 452-460, 2001
[15] F. Dong, G. J. Clapworthy, H. Lin, M. Krokos,
“Volumetric Hatching: Illustration of Medical Volume
Data Using Line Strokes”, IEEE Computer Graphics and
Applications, 23(4), 2003, 44-52
[16] W. E. Lorensen, H. E. Cline, “Marching Cubes: A High
Resolution 3D Surface Construction Algorithm”,
Computer Graphics, Vol.21, No.4, pp. 163-169, 1987

Figure 7. Surface Hatching for Femur

Figure 5 . Surface Hatching for Iliac

Figure 6 . Surface Hatching for Scapula

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

Figure 8. Surface Hatching for Brain and digestive system

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE


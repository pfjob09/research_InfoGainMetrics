A Novel Medical Image Registration Method Based on Mutual Information
and Genetic Algorithm
Hongying Zhang, Xiaozhou Zhou, Jizhou Sun, Jiawan Zhang
Visualization and Image Processing Group, SRDC, School of Electronic and Information
Engineering, Tianjin University, 300072, China
carole_zhang0716@hotmail.com, xz_zhou2004@hotmail.com, jzsun@tju.edu.cn,
jwzhang@tju.edu.cn

Abstract
Originating from information theory, mutual
information, as a measure for image registration, has
drawn much attention and has been shown to be
successful. Mutual information should be maximal
when the two different images are perfectly aligned.
There exist many optimization schemes applied to
mutual information matching problems, most of which
are local and require a starting point. In this paper, we
propose an improved genetic algorithm as a search
engine to overcome this problem. To reduce the search
data size, multi-resolution optimization strategy is
adopted; meanwhile, adaptive sizes of the crossover
and the mutation pools along with the changes of
resolution are proposed to prevent the process from
stalling at a local maximum, accordingly improve the
capability with the local search of genetic algorithm.
Experiments show our algorithm is a robust and
efficient method which can yield accurate registration
results.


1. Introduction
Given two image sets acquired from the same
patient but at different times or with different devices,
medical image registration problem can be stated in
general as an optimization problem of finding the
transformation function and the transformation
parameters that optimize some similarity metric
between the two images. It can be expressed as

a * = arg opt ( S ( F ( x), R (Ta ( x))))

(1)

where R and F are the images to be registered;

Ta is

the transformation, characterized by the transformation
parameters a , that will be applied to the coordinate of
each grid point x in F; S is an intensity-based similarity

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

measure calculated over the region of overlap of the
two images. Through the transformation, the
corresponding points in the two image sets have the
same anatomic locations. Image registration has been
an important research topic because of its great value in
a variety of applications. For medical image analysis,
an image showing functional and metabolic activity—
such as single photon emission computed tomography
(SPECT), positron emission tomography (PET), and
magnetic resonance spectroscopy (MRS)—is often
registered to an image which shows anatomical
structures, such as magnetic resonance image (MRI),
computed tomography (CT), and ultrasound. These
registered multimodality images lead to improved
diagnosis, better surgical planning, more accurate
radiation therapy and other countless benefits [1].
Since mutual information (MI) made its entrance
into the field of medical image registration, it has been
adopted by a large number of researchers for numerous
applications [2]. Research into the measure currently
takes up a substantial part of medical image registration
research because MI-based registration is successful for
a variety of image modalities. But a major difficulty in
the registration problem using MI as the criterion is the
existence of local maxima. It is possible that the
obtained maximum may not be the global maximum of
the search space and only part of the search space leads
to the expecting maximum. This problem becomes
even severe if the images are of low resolutions.
In this paper, a novel MI-based registration method
is proposed. This method combines a simple yet
powerful search strategy based on improved Genetic
Algorithm (GA) with a wavelet-based multi-resolution
manner. Adaptive sizes of the crossover pool and the
mutation pool are adopted to prevent the process from
stalling at a local maximum. Combination of the multiresolution strategy and adaptive parameters of GA
accelerates convergence of the iterative process.

2. MI-based image registration
2.1. Mutual information
The mutual information of two random variables A
and B is defined by

I ( A, B) = ¦ PA, B (a, b) log
a ,b

PA, B (a, b)
PA (a) ⋅ PB (b)

(2)

PA (a) and PB (b) are the marginal probability
mass functions and PA, B ( a, b) is the joint probability

where

mass function. MI measures the degree of dependence
of A and B by measuring the distance between the joint
distribution PA, B ( a, b) and the distribution associated
with
the
case
of
completely
independence PA ( a ) ⋅ PB (b) , by means of the relative
entropy. MI is related to entropies by
I ( A, B ) = H ( A) + H ( B ) − H ( A, B )
(3)
The size of the overlapping part of the images
influences the mutual information measure. Studholme
et al proposed a normalized measure of mutual
information [3], which is less sensitive to changes in
overlap:

NMI ( A, B) =

H ( A) + H ( B)
(4)
H ( A, B)

The strength of the MI similarity measure lies in the
fact that it is a general method without the need of
image preprocessing; it depends merely on the
existence of a statistical relation, hence posing less
stringent demands on the relation between the images’
gray values. To employ MI as a similarity measure, we
need to utilize the concept of the two-dimensional (2D) histogram of an image pair, namely, the joint
histogram. A joint histogram is created by plotting (a,
b) point for every pair of corresponding voxels. The
joint probability mass function in the calculation of MI
of an image pair can then be obtained by normalizing
the joint histogram of the image pair as

PA, B (a, b) =

h( a , b)
¦ h ( a, b)

(5)

a ,b

When transforming points from one image to
another, interpolation is usually required to estimate the
gray values of the resulting points. A serious problem
with interpolation is that it can cause artifacts in the
registration function, which resulting in a pattern of
local extreme and hampering the optimization process.
Pluim et.al [4][5] examined the mechanisms resulting
in the interpolation artifacts in detail. Because of the
existence of local maxima, the choice of optimization

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

routine has a large influence on the results of the
registration method, particularly on the robustness of
the method with respect to the initial transformation.
GAs have been known to be robust for search and
optimization problems. Image registration can take
advantage of the robustness of GAs to improve the
chances of finding the global optimum of the
registration function. At the same time, optimization
strategy proposed in this paper is performed in a multiresolution manner to accelerate the convergence of the
iterative process. Here we employ the wavelet
decomposition approach to construct an image
pyramid. To decrease the sensitivity of the method to
local maxima in the registration function and improve
the local search ability of GA, adaptive sizes of the
crossover pool and the mutation pool along with the
resolution changes are presented.

2.2. Multi-resolution image registration
Multi-resolution is often used in search space and
search data reduction techniques. The coarse-to-fine
strategy has been used to improve the efficiency of
many image-processing tasks [6], including image
registration [7][8][9]. Employing this coarse-to-fine
scheme has at least two advantages. The first one is the
acceleration of the optimization process [9] and the
second one is the increase in the range of
transformations within which a specified similarity
measure is a monotonic function of misregistration [7].
Using coarse-to-fine representation, the registration
begins the search for a good input reference
transformation at the coarse resolution image, which is
usually compressed or reduced to smaller size than the
original image. The search is then refined further and
further using each of the finer images and moving
towards the full resolution images. The same procedure
is repeated until the finest level is reached.
The construction of the image pyramid is the core of
multi-resolution optimization approach. Many image
pyramid construction algorithms are proposed,
including Burt’s Laplacian pyramid [6], wavelet-based
pyramid [9], cubic spline pyramid [10] and the pyramid
obtained by down sampling the image [11].
In this paper, we employ the wavelet decomposition
approach to construct an image pyramid because
wavelet-based multi-resolution preserves most of the
important features of the original data even at a low
resolution. It also eliminates weak higher resolution
features while highlighting strong image features.

3. Improved genetic algorithm for medical
image registration
3.1. Genetic
definitions

algorithms:

concept

and

GA was formally introduced by John Holland and
his colleagues [12]. GAs are computational models of
natural evolution in which stronger individuals are
more likely to be the winners in a competitive
environment. Iterations of GA correspond to
generations of evolution. A set of potential solutions,
called a chromosome. The initial population is
evaluated. In this process, each individual receives a
fitness value determined by a user-defined fitness
function which is generally a function of the decoded
bits contained in each candidate’s chromosome. These
candidates will be selected for the reproduction in the
next generation based on their fitness values. The
selected candidates are combined using the genetic
recombination operation “crossover”. The crossover
operator exchanges portions of bit strings for the next
generation. The “mutation” is then applied to perturb
the bits of the chromosome as to guarantee that the
problem space is never zero. The whole population is
evaluated again in the next generation and the process
continues until it reaches the termination criteria. In
recent years, GAs have been intensively investigated
and applied to many optimization problems [13].
GA can be used to avoid process getting trapped in
local optima and to achieve computation efficiency.
They have been applied to image registration problems
recently [14][15]. Dasgupta and MeCregor proposed a
structured GA (sGA) for automatic registration of
digital images [16]. The sGA lies primarily in its
redundant genetic material and a gene activation
mechanism. But none of the above mentioned GAbased image registration works can’t completely solve
the premature convergence problem resulted by the
presence of multiple local optima. Moreover, they are
all time-consuming because the data sets are very large.
In our work, taking advantages of the influence
of the GA’s parameters on optimization performance
and the ability of multi-resolution strategy to reduce the
search space, we make the sizes of crossover and
mutation pool be tuned with the resolution changes in
order to prevent the algorithm from becoming trapped
on local optima and to reduce computation. The
following subsection describes our algorithm.

In GAs, mutation is used to maintain genetic
diversity from one generation of a population of
chromosomes to the next. Accordingly, it can avoid
local extrema of the process by preventing the
population of chromosomes from becoming too similar
to each other and slow or even stop evolution.
Using MI as the criterion of the registration
problem, the existence of local maxima is the major
difficulty which becomes even severe when the image
sizes at the coarsest level are very small. The reason
that the process stalling at a local maximum is that a
locally optimal parameter vector enters into the
replication pool and the population diversity is low
thereby. GA can avoid process getting trapped in local
optima. To increase the mutation pool is a reasonable
remedy to maintain the variability of the chromosome.
So, we adjust the mutation pool with the resolution
changes to solve the problem. Meanwhile, the size of
crossover pool is decreased correspondingly in order to
maintain the elite population. The wavelet-based
decomposition method is applied to create multiresolution image representation in order to accelerate
the process and reduce the search space.
We describe our algorithm of multi-resolution
image registration based on GA and MI as Table 1:
Given two images to be registered, choose one as
the floating image F and the other one as the reference
image R. Max-level is denoted as the number of levels
F and R will be decomposed. Furthermore, we define
cur_level to indicate the current level at which the two
image pyramids are F_decomposed and R_decomposed
are the images of R and F after wavelet decomposition,
respectively. transT is defined the transformation
obtained at current level. β is a adjuster.
The two original images are decomposed using
wavelet decomposition to produce multi-resolution
images. General 3-D wavelet based multi-resolution
pyramid decomposition procedure to obtain the image
at a coarser level is summarized in Figure 1[17].

3.2. GA-Based image registration in multiresolution manner
Figure 1. One level wavelet decomposition
from resolution m to m+1

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

Table 1. The algorithm proposed in this paper
PROCEDURE: Image registration based on our
method
Input: F and R
Output: transT[0]
BEGIN
/*Wavelet-based decomposition for F and R*/

F_decomposed←wavelet_decomposed(F)
R_decomposed←wavelet_decomposed(R)
for cur_level←Max_level-1 to 0 do
/*Read the R and F at current level as input images*/

ReadImage ( F_decomposed [cur_level]);
ReadImage(R_decomposed [cur_level]);
/*Compute the MI of the two input images at current level*/

mi←MICompute(F_decomposed[cur_level]),
R_decomposed[cur_level]);
/*Adjust the mutation pool and crossover pool according to
cur_level */

mutation_operation← β /cur_level;

crossover_operation← β *cur_level;
/*Use adaptive parameters of GA and the obtained
transformation at previous level as the input parameters
of the optimization procedure*/

transT[cur_level]←GA_Optimization(
mutation_operation,crossover_operation,
transT[cur_level+1]);
end
output transT[0];
END
As shown in Figure 1, the filtering is performed
first by convolving the input image with H (low pass)
and G (high pass) in the x direction. This is followed by
down sampling each output along x direction. Then the
two resulting images are further processed along the y
direction followed by down sampling along the y
direction. The same procedure is performed in the z
direction. At the output, the source image at resolution
level m is decomposed into eight subimages: an image
at coarser resolution level m+1, the rest seven images
contain detailed signal at resolution level m+1 in
different direction. The filtering can be repeated by
using the coarser resolution image as the input source
image at the next level until the desired level is
reached. We apply low pass filter H in x, y and z
directions to obtain the whole pyramid.
The GA-based optimization initially searches from
the level that contains smallest wavelet-compressed
images toward the highest resolution waveletcompressed images. For each level of multi-resolution,
the best result found in the previous level is used as a
center of the search.
In order to find a relationship between the resolution
level m and the size of mutation and crossover pools, a

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

factor

β

is introduced. The size of mutation pool is

increased by β . A larger number of new genes are
introduced into the gene population. This process helps
the algorithm to climb out from local maximum points
and continue its search for the global optimum
solution. At the same time, the size of the crossover
pool is decreased by β along with the resolution level
decreasing. The existence of local maxima is severe
when images at coarser level, so the size of the
mutation pool should be increased in order to maintain
the population diversity and improve the capability
with local search of GA. Determining the global search
ability primarily, the size of the crossover pool should
be decreased in order not to destroy the elite population
pattern.

4ˊExperiment results
We consider the 3D brain image registration
problem and apply our algorithms to this important
application. Image volumes of CT, MR and PET
modalities obtained from patients undergoing
neurosurgery at Vanderbilt University as part of the
project “Evaluation of Retrospective Image
Registration”[18][19]. Five types of images, including
CT, PET images and three types of MR images were
used. MR images are MR_PD, MR_T1 and MR_T2
images. For the MR image volumes, two volume sets
were available. They were volumes before and after
image rectification, a technique used to correct MR
images for static field inhomogeneity [20][21].
A practice data set provided by Vanderbilt
University for which the gold standard was available to
us, was used to perform our experiments. Figure 2
shows selected image slice of these three modalities.
The size of each slice is [512×512] for CT images,
[256×256] for MR images and [128×128] for PET
images. The slice thickness for this data set is either
4mm (CT and non-rectified MR) or 8mm (PET).
Normalized mutual information defined in Eq (5)
was employed as the similarity measure. In our
experiments, number of generations, selection rules and
mutation rules, we tested various setting of the GA
parameters, such as population size, mutation and
crossover probabilities, and others. Based on the
convergence time and quality of the solutions, we then
fixed the parameters. The value of β is select based
on other parameters. We use nearest neighbor
algorithm as the interpolation method.
For CT to MR registration task, both CT and MR
image intensities are linearly binned into 256 gray
levels. While for PET to MR registration task, we use
64 gray levels to represent each image volume because

of the relatively few samples available in PET images
compared to CT images.

It is easily seen from the table 2 and table 3 that the
registration errors are all less than the size of a voxel,
so we conclude that applying our improved GA-based
image registration in multi-resolution manner for two
set of above images can obtain subvoxel registration
accuracy. Figure 3 is the registration results of the CT
to MR-PD.

Figure 2. Images of different modalities used
in the experiments. (a) The first slice of MR-PD
image (b) The first slice of CT image (c) The first
slice of PET image

Experiment results for CT to MR and PET to MR
registrations are shown in Table 2 and Table 3,
respectively. In each table, the first columns denote the
maximal, minimal and mean errors compared with the
gold standard.
We define the diagonal distance in a voxel to
indicate the size of a voxel. For CT to MR registration,
the size of a voxel is the diagonal distance in a MR
image’s voxel, shown at below:

1.252 + 1.252 + 4.02 ≈ 4.373 (mm)
And for PET to MR, the size of a voxel is the
diagonal distance in a PET image’s voxel, depicted as
follows:

2.5907232 + 2.5907232 + 8.02 ≈ 8.799 (mm)

Figure 3. Results of matching CT and MR-PD
images. (a) The first slice of CT image before
Registration (b) The first slice of MR-PD image
before Registration (c) The first slice of CT image
after registration (d) The image which combines
MR-PD with the boundary of the transformed CT
image

As shown in Figure 3, the original distance between
CT and MR-PD image is quite large in common world
coordinate. After registration using the method
proposed in this paper, they are aligned perfectly. For
eyeballing test, we add the boundary of the transformed
CT image to the MR-PD image, as shown in Figure
3(d). Perfect registration result is shown in the
boundary.

Table 2. Registration errors for CT to MR
Error(mm)

CT_PD

CT_T1

CT_T2

CT_PDrf

CT_T1rf

CT_T2rf

maximum

2.8308

2.6826

2.8314

1.7890

1.7980

1.0320

minimum

0.0832

0.0523

0.9564

0.0756

0.0685

0.0876

mean

0.7652

0.6483

1.1087

0.5304

0.4632

0.7541

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

Table 3. Registration errors for PET to MR
Error(mm)

PET_PD

PET_T1

PET_T2

PET_PDrf

PET_T1rf

PET_T2rf

maximum

8.6869

7.1482

7.1680

6.2103

6.4620

6.0120

minimum

0.4068

0.2973

0.1985

0.1887

0.1864

0.2783

Mean

4.8652

3.1350

3.5327

3.2876

2.1039

3.0919

5. Conclusions and future works
In this paper, we have presented an efficient
subvoxel MI-based image registration method combing
an improved GA-based search technique with the
multi-resolution wavelet image representation. To
overcome the influence of the existence of local
maxima using MI on the registration results, we
adopted adaptive sizes of the crossover and mutation
pool to improve the local search ability of GA.
Experiments has showed our algorithm can yield good
results.
The process using GA-based optimization is timeconsuming, which has been alleviated in some sort by
combing multi-resolution strategy. The challenges
ahead lie in the field of how to accelerate the process
substantially without accuracy loss.
Moreover, our experiment results have shown
accuracy for the rigid transformation. Future research
will consider using non-rigid transformation that takes
into consideration distortion.

Acknowledgements
We give much thanks to Vanderbilt University, for
the data sets we used in our experiments. The research
is supported by the National Science Foundation under
Grants 60373061.

References
[1] Collignon, F. Maes, D. Delaere, D. Vandermeulen, P.
Suetens, and G. Marchal,
“Automated multimodality
medical image registration using information theory”, In
Proc. 14th Int. Conf. Information Processing in Medical
Imaging (IPMI'95), June 1995, pp.263-274.
[2] J.West et al., “Comparison and evaluation of retrospective
intermodality brain image registration techniques”
J.Comput.Assist.Tomogr, vol.21, 1997, pp.554-566.
[3] C.Studholme, D.L.G.Hill and D.J.Hawkes, “An overlap
invariant entropy measure of 3D medicalimage alignment”,
Pattern Recognition, vol32, 1999, pp.71-86.
[4] J.P.W.Pluim,J.B.A.Maintz, and M.A.Viergever, “Mutual
information matching and interpolation artifacts”, In
Proceedings of SPIE, vol.3661, 1-2, Feb.1999, pp.56-65.
[5] J.P.W.Pluim, J.B.Antoine Maintz, and M.A.Viergever,
“Interpolation artifacts in mutual information-based image

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

registration”, Computer vision and image understanding, vol
77, 2000, pp.211-232.
[6] M.Unser, A.Aldroubi, and M.Eden, “The L2 polynomial
spline pyramid”, IEEE Trans on Pattern Analysis and
Machine Intelligence, vol.15, no.4, April 1993.
[7] P.Thévenaz and M.Unser, “A pyramid approach to subpixel image fusion based on mutual information”, In
Proceedings of IEEE International Conference on Image
Processing, vol.I, 1996, pp. 265-268.
[8] P.Thévenaz and M.Unser, “An efficient mutual
information
optimizer
for
multi-resolution
image
registration”, In Proceedings of IEEE International
Conference on Image Processing, vol.I, 1998, pp.833-837.
[9] J.P.W.Pluim,J.B.A.Maintz and M.A.Viergever, “A
multiscale approach to mutual information matching”, In
Proceedings of SPIE conference on image processing, San
Diego, California, vol. 3338, 1998, pp.1334-344.
[10] P.J.Burt and E.H.Adelson. “ The Laplacian Pyramid as a
Compact Image Code”, IEEE Trans on Communication,
Vol.31, April 1983, pp.337-345.
[11] S.G. Mallat, “A theory of multiresolution signal
decomposition: the wavelet representation”, IEEE Trans on
Patt. Anal. Machine Intell, vol 11, 1989, pp.674-693.
[12] J.H.Holland, Adaptation in Natural and Artificial System,
University of Michigan Press, 1975.
[13] D.E.Goldberg, Genetic Algorithms in Search,
Optimization and Machine Learning, Addison-Wesley, 1989.
[14] C.Robertson and R.B.Fisher, “Parallel evolutionary
registration of range data”, CVIU, vol.87, no.1, 2002, pp.3950.
[15] J.M.Fitzpatrick, J.J.Gerfenstette, and D.VanGucht,
“Image registration by genetic search”. In Proceedings of
Southeaston 84, 1984, pp.460-464.
[16] D.Dasgupta and D.R.McGregor, “Digital Image
Registration Using Structured Genetic Algorithms”, In
Proceeding of the SPIE, vol.1766, 1992, pp.226-34.
[17] H. Chen, Mutual information-based image registration
with applications. Dissertation, 2002, pp.22-25.
[18] J.West, J.M.Fitzpatrick et al, “Comparison and
evaluation of retrospective intermodality brain image
registration techniques”, Journal.Comput.Assist Tomography,
vol.21, no.4, 1997, pp.554-566.
[19] RREP url:http://www.vuse.vanderbilt.edu/~image/reg
[20] H.Chang, J.M.Fitzpatrick, “A technique for accurate
magnetic resonance imaging in the presence of field
inhomogeneities”, IEEE Trans on Medical Imaging, vol 11,
1992, pp.319-329.
[21] C.R.Maurer Jr,G.B.Aboutanos, “Effect of geometrical
distortion correction in MR on image registration accuracy”,
Journal of Computer Assisted Tomography, vol20, no 4
July/August 1996,pp.666-679.


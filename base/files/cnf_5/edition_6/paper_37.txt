A practical rebinning-based method for patient motion compensation in SPECT
imaging
Linna Ma1, Songxiang Gu1, Suman Nadella1,
Philippe P. Bruyant2, Michael A. King2, Michael A. Gennert1
1. Worcester Polytechnic Institute 2. University of Massachusettes Medical School
{Linna.Ma, Songxiang.Gu, Suman.Nadella, Philippe.Bruyant, Michael.King}@umassmed.edu,
{michaelg}@sequoia.wpi.edu
Abstract
Single photon emission computed tomography
(SPECT) studies require the patient to remain motionless
for protracted period of time. But considerable patient
discomfort can lead to patient motion, which will
introduce the image artifacts and degrade resolution. If
the patient motion can be detected, it is possible to
compensate for the motion to reduce or eliminate the
artifacts. In this paper a method based on visualtracking-system (VTS) is presented to compensate for the
patient motion during data acquisition. VTS will get the
exact position and orientation that are independent of
the SPECT system. During data acquisition each
detected photon produces an event that is written to a
file. Each event includes the photon location, energy and
time. The list of events is adjusted by compensation
algorithm to produce a corrected set of motion-free
observations. In the compensation process, the
projections can be repositioned and reconstructed with
ordered subsets expectation maximization (OSEM)
algorithm. By comparing the corrected result and
uncorrected result our compensation method can be
assessed.

1. Introduction
There are plenty of patients that need cardiac single
photon emission computed tomography (SPECT)
diagnosis every year. The data acquisition in SPECT
requires the patient to remain still for a long time (around
thirty minutes) to guarantee the image quality. However,
in clinical reports the patients often move to introduce
the imaging artifacts. In the academic centers we know
that body motion has been determined to occur in ~25%
of studies and ~5% of the time motion is significant
enough to cause artifacts which can mislead diagnosis [1,
2]. One study in T1-201 polar maps has shown that
motion of 1 pixel (6.4mm) can induce significant artifact
[3]. The motion compensation is a significant problem
for emission imaging. Compensation strategies for

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

motion in SPECT imaging, although commercially
available, are inadequate for robust clinical usage. For
example, currently there are some corrections for the
attenuation and scatter physics effects. Also small, period
patient motion such as respiration can lead to blurring
and loss of resolution. But these corrections all need the
patient motion compensation to remove the major patient
shift factor for clinical usage. Larger motions such as
patient shift lead to more serious artifacts that may mask
or mimic perfusion defects.
A number of approaches have been developed to
detect and correct for body motion using only emission
data. Motion artifacts can be reduced by manual shifting
of individual projection images before reconstruction.
For example, Fitzgerald et_al. [7] suggested having the
technologist or physician view the cine, sonogram, or
linogram of the acquisitions and interactively move the
projection data to compensate for motion. But the
effectiveness of procedure is dependent on the operator
and it is time-consuming. There are also many automatic
or semiautomatic methods for motion compensation in
SPECT studies. One way is to place external radioactive
markers on the patient’s body within the camera heads,
and detect the motion of these markers. William J.
Geckle et_al. [4] described an algorithm to track the
center of the heart in successive projections and correct
its motion based on realignment of the center to a fixed
point in space. Barakat et_al. [5] proposed an algorithm
to detect motion in projection data from triple scan
SPECT imaging. This algorithm permits the acquisition
of three full sets of SPECT data which can be adequately
combined in order to reconstitute a motion-free set of
projection data. Fulton et_al. [6] uses full 3D
reconstruction, which places some limitations on the
nature or timing of the motion which can be corrected. In
the motion correction with full 3D reconstruction,
sometimes researchers have to assume the patient
remains stationary during the acquisition of individual
projection and only moves between projections.
The above methods use frame data. That is, when
the six cameras are at a fixed angle and a “frame” or
image is acquired. Individual photons, i.e. detected

events, are not recorded separately, only in aggregate. In
our approach, we use list mode data. In list mode data
each event is recorded. The list of events is adjusted to
produce a corrected set of motion-free observations
instead of the integrate projection image frame. After the
compensation and reformatting, we do 3D reconstruction
based on the ordered subsets expectation maximization
(OSEM) algorithm for comparison.
The outline of the rest of this paper is as follows.
Section 2 gives an overview of the rebinning based
approach for the patient motion and gives the algorithm
flow diagram. In section 3 the visual tracking system is
described and its architecture is presented. In section 4
the motion compensation algorithm is analyzed and
explained. Section 5 presents the OSEM reconstruction
method. Finally, in section 6, the results are presented
and the analysis is given. Later future work is discussed
and the paper is concluded.

2. Method
Our data is based on the clinical images. The system
consists of a Picker International three-headed IRIX
SPECT system as Figure 1 and real time multi-thread
cameras. The image data is acquired by UMass Medical
Center (Hospital) so that our research is very close to
practice. In the other academic centers, researchers
usually make the patients comfortable and control the
imaging environment. These “low-likelihood” patients
are less likely to move than those who are more likely to
have disease. In the clinical cases, actual patient motion
would be one of the most important factors. Significant
motion can result in the image artifacts that may be
erroneously interpreted as perfusion defects. The falsepositive interpretations with motion may be as high as
27% [13]. Although there are some real cardiac motions,
but the significant cardiac motion is seldom. The image
artifacts are mainly caused by the patient motion.

(b) Cardiac Model Simulation for SPECT System
Figure 1 IRIX SPECT System
In this paper the list-mode-based compensation
algorithm was proposed for the patient motion. This
approach will be more accurate than the former framemode-based approach because every event will be
computed spatial transformation. Figure 2 is the flow of
our data processing:

Figure 2 Data Processing Flow

3. Visual tracking system

(a) SPECT System with Six Cameras

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

Most previous approaches of detecting patient
motion have relied on acquired projection data and they
detect motion with consistency checks or motion
tracking. Our approach is based on optical tracking of the
patient using a pair of web cameras to acquire stereo
images. The stereo images are analyzed by a Visual
Tracking System (VTS) that detects changes in the stereo
images over time to track locations on the patient
surface. Patient surface motion can infer motion within
the patient body, which will be used to correct for actual
patient motion.[10] The Visual Tracking System is based
on six threads real time control (Each camera is
associated with a thread). The cameras are directed at

reflective markers placed on the surface of a tight fitting
garment worn by the patient. [9] These AXIS 2130
Network Cameras have the capability of transmitting
sequential JPEG images (also known as Motion JPEG)
over an Ethernet network. Each camera transmits about
30 frames of video per second with a resolution of
352x240 pixels.[8] The web cameras acquire a set of 2D
optical images simultaneously with the SPECT system
acquiring emission images. And the set of 2D images, in
turn, are used to locate the 3D coordinates of the
markers. By comparing the positions of the markers
between time slots, VTS can track patient movement and
compute the motion in 3D space. The detected sets of
blobs are shown in Figure 3, and VTS architecture is
shown in Figure 4.

4. Motion compensation
The IRIX SPECT system operates in list mode. In
this mode, all detected events are stored in a long list (in
fact, they are written to the disk) together with an event
timestamp. Thus, it is possible to temporally register the
stereo images with the detected activity. Each event
includes the photon location, energy and time. When
each SPECT event is spatially transformed, the fully
corrected data set and accurate compensation result can
be achieved.
Before discussing the effect of motion, we describe
the motion-free case. The quantity of interest is the level
of activity a at every point in the patient, a = a(x, y, z).
By sampling a at discrete points, we may treat a(x, y, z)
as a vector a. The observed projection data p depend on
the row, column and angle of the detector, p = p(r, c, α ).
Because p is discrete, we may treat it as a vector p. The
observed projections depend on the activity through
system matrix C, p = Ca.
When there is motion, C = C(t) and p = p(t); a
remains time-invariant. Let us assume that C(t) is
piecewise constant, changing only at time ti. Then Ci =
C(t), ti < t < ti+1. Therefore p(t) = C(t) a(t) because pi =
Cia(t). Let wi represent the warp from Ci to Ci+1, that is,

π wC
n −1

Cn+1 = wnCn =
Figure 3 Seven Blobs to be detected

Network
Network
Camera 11
Camera

Network
Network
Camera 22
Camera

Network
Network
Camera 33
Camera

JPEG Stream

JPEG Stream

JPEG Stream

VISUAL TRACKING SYSTEM
Image
Image
Acquisition
Acquisition
Thread
Thread

Image
Image
Acquisition
Acquisition
Thread
Thread

Image
Image
Acquisition
Acquisition
Thread
Thread

Image Buffer
Buffer
Image

Image Buffer
Buffer
Image

Buffer Image
Image
Buffer

i =0

i

i

(1)

The SPECT list mode data is specified as p(rĮ(t),
cĮ(t), α ). In a set of projections (Figure 6 shows the
projections.), r is the event row number; c is the event
column number; α is the project angle. Figure 5 can
specify the coordinate of one event in space. The event
position after compensation p'(r'Į(t'), c'Į(t'), α ) can be
achieved from the event original position p(rĮ(t),
cĮ(t), α ). Note that p' has the same angle α as p because
we assume here that the patient does not rotate. There are
three Degrees of Freedom (DOF).

Image and Stereo
Processing Thread
Group Frames
Frames
Group

Image Processing
Processing
Image

z

g(x, y, z)

Row

α

Uncompress JPEG
JPEG
Uncompress

y

Marker Detection
Detection
Marker

Column
Image Cropping
Cropping
Image

x

Blob Matching
Matching
Blob

Figure 5 Coordinate of Event in Space
Stereo Processing
Processing
Stereo

Reconstruction Correction
Correction
Reconstruction

Figure 4
VTS with Four Components:
Image Acquisition, Image Processing, Blob
Marker Matching and Stereo Processing

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

Via visual tracking system the event shift distance
(XĮ, YĮ, ZĮ) can be reached for the patient motion.
The event is observed firstly at p(rĮ(t),cĮ(t), α ). Figure 5
can specify the coordinate of one event in space. From
Formula 2 we can compute the value of r'Į(t') and c'Į(t').
Here f is the scale factor for the row event with
transformation.

r'Į(t') = rĮ(t) - ZĮfr
c'Į(t') = cĮ(t) - XĮfc cos α - YĮfc sin α

(2)

After compensation the event position p'(r'Į(t'),
c'Į(t'), α ) can be obtained from the following
transformation matrix. We assume the original image
projection matrix is C. Each element of this matrix C is
denoted by C[c][r] (0 ≤ c<256, 0 ≤ r<256). I is the unit
matrix. We define a transformation matrix M.

ª
«
«
«
«
M= «
«
«
«
«
¬

0 1 0 0 ...

0 0

0 0 1 0 ...

0 0

0 0 0 1 ...

0 0

.....
0 0

...
... 1 0

0 0 .....

0 1

0 0

0 0

º
»
»
»
»
»
»
»
»
»
¼

the slices in frame mode will be reconstructed to 3D
volume.
After compensation procedure, the sample list mode
data can be reformatted to the frame mode data, which is
used for the reconstruction computation in the next step.
In frame mode data the coordinates are used to index a
2D matrix and the indexed element of the frame is
incremented to record the acquisition of the event. The
projection image is stored in a matrix where the pixel
size matches the desired image resolution.

(3)

Based on the unit matrix I and matrix M in Formula
3, the following seven matrixes in Formula 4 can specify
the detailed compensation.
M1 = (1-d rĮ(t))(1- d cĮ(t))I
M2 = (1-d rĮ(t))d cĮ(t)M
M3 = d rĮ(t)(1-d cĮ(t))M
M4 = d rĮ(t)d cĮ(t) M
M5 = M
M6 = i rĮ(t)M
M7 = i cĮ(t)M

α = 180o
(4)

In Formula 4 M1 … M7 are transformation matrixes
for the compensation. d rĮ(t) and d cĮ(t) are decimal
part of the position translation (0<d rĮ<1, 0<d cĮ<1).
 i rĮ(t) and  i cĮ(t) are integer part of the position
translation. In Formula 5,  rĮ(t) and  cĮ(t) can be
achieved by Formula 2.

rĮ(t) = i rĮ(t) +d rĮ(t) = ZĮfr
cĮ(t) = i cĮ(t) +d cĮ(t)
= XĮfc cos α + YĮ fc sin α

α =90o

Projections

List Mode

(5)

Then the final result of the event position matrix C’
can be achieved in Formula 6.
C1 = M1C + M2C + CM3 + M4CM5
C’ = M6C1M7

α = 270o

(6)

This compensation procedure is repeated for each
event and finally a corrected list mode file can be
created. The list mode files not only contain the detected
events, but also contain the timestamps, which are used
to synchronize the SPECT system and track data streams.
From Figure 6 we can see that the patient motion is
detected with three detectors of SPECT system to obtain
the list mode data. After compensation and projection,

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

α
Figure 6
Transformation between
list mode data and frame mode data

5. OSEM reconstruction
To compare the 3D volume effect before
compensation and after compensation for the patient
motion, we need do reconstruction for patient cardiac
image. There are several different approaches based on
list mode data to do reconstruction, and most of these
methods have limitations in computation speed. However
OSEM (Ordered Subsets Expectation Maximization)
algorithm [14] has good computation speed. OSEM has

already become very attractive for image reconstruction
in tomography due to its fast convergence rate compared
with the basic EM algorithms. The fast OSEM
reconstruction method operating speeds are now
clinically acceptable. In OSEM algorithm the current
image reconstruction estimation is the initial estimate for
the next reconstruction step.
From the former compensation steps, we can see
that the patient spatial motion influence during the
acquisition of individual projections in the frame mode
images has almost been eliminated. Between the
projections and the reconstruction estimate, the spatial
transformations maintain consistency.

(C)
Figure 7.A Seven Blobs in VTS without
Compensation

6. Results
Figure 7 shows the final results of list-mode-based
compensation. There are three groups of data, which can
express three different shifted positions of seven
simulation blobs image. The reconstruction without
compensation (Figure 7A, 7B, and 7C) and
reconstruction with compensation (Figure 7A’, 7B’, and
7C’) can be compared. It can be seen that the distortion
is removed by our compensation computation from the
pairs Figure 7A and 7A’, Figure 7B and Figure 7B’,
Figure 7C and Figure 7C’. Seven blobs with their
lighting lines in the VTS have more distinct appearance
in Figure 7A’, Figure 7B’, and Figure 7C’ than those in
Figure 7 A, Figure 7B, and Figure 7C.

(A’)

(B’)

(A)

(C’)
Figure 7.B Seven Blobs in VTS with ListMode-based Compensation

(B)

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

In Figure 8 there are two simulation cardiac images
to evaluate our compensation algorithm. From different
reconstruction angles we can obtain various cardiac
image results. In Figure 8.A, it shows the cardiac image
with some artifacts that may mask perfusion defects.
With compensation and reconstruction in different
angles, Figure 8.B shows the cardinal image with better
visual effect.

[3]

[4]

(A)

(B)

Figure 8 (A) Cardiac Image without
Compensation Computation (B) Cardiac
Image with List-Mode-based Compensation
Computation

We thus get the conclusion that the compensation in
SPECT image processing is necessary, especially for the
clinical results. In addition, we show the compensation
effect on both blobs simulation in VTS and the
simulation cardiac image processing in clinic.

[5]

[6]

[7]

[8]

Conclusions
The presented list-mode-based approach for the
patient motion compensation during SPECT data
acquisition will make the myocardial images free of
patient movement artifacts. Although patient motion
compensation greatly improved reconstruction accuracy,
there are still several factors that can influence the
compensation quality. The interpolation performed in our
spatial transformation will provide estimates for the next
reconstruction step. This is the cumulative smoothing
effect on the reconstruction. Currently the visual tracking
system is accurate to within less than a pixel (0.42cm)
[10]. More work is needed to improve the accuracy for a
better result. In the list-mode spatial compensation
computation, we will do the accuracy of more general
types of motion, including rotation, and also determining
the repeatability of stereo processing and motion
calculation under varying imaging conditions.

Acknowledgements

[9]

[10]

[11]

[12]

[13]

The support of the U.S. National Institutes of Health
through NIH Grant R01-HL50349) is gratefully
acknowledged.
[14]

References
[1]

[2]

E.H.Botvinick, Y.Y. Zhu, W.J. O'Connell and M.W.
Dae, “A quantitative assessment of patient motion and its
effect on myocardial perfusion SPECT images,” Journal
of Nuclear Medicine, Vol. 34, Issue 2, 303-310, Feb.
1993.
F.M. Prigent, M. Hyun, D.S. Berman and A. Rozanski,
“Effect of motion on thallium-201 SPECT studies: a
simulation and clinical study,” Journal of Nuclear
Medicine, Vol. 34, Issue 11 1845-1850, Nov. 1993.

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

R. Eisner, A. Churchwell, T. Noever, D. Nowak, K.
Cloninger, D. Dunn, W. Carlson, J. Oates, J. Jones and
D. Morris, “Quantitative analysis of the tomographic
thallium-201 myocardial bullseye display: critical role of
correcting for patient motion,” Journal of Nuclear
Medicine, Vol. 29, Issue 1 91-97, Jan. 1988
William J. Geckle, Terry L. Frank, Jonathan M. links and
Lewis C. becker, “Correction for Patient and Organ
Movement in SPECT: Application to Exercise
Thallium-201 Cardiac Imaging”, J. Nucl. Med. Vol. 29,
PP:441- 450, 1995
Pellot-Barakat, M. Ivanovich, D. A. Weber, A. Herment,
D. K. Shelton; “Motion Detection of Motion in Triple
Scan SPECT Imaging”; 0018-9499, 1998, IEEE Trans.
Nucl. Sci., vol. 45(4): pp. 2238-2244, August 1998.
R R Fulton, B F Hutton, M Braun, B Ardekani and R
Larkin, “Use of 3D reconstruction to correct for patient
motion in SPECT”, Phys. Med. Biol. 39 563-574 1994.
J. Fitzgerald and P. G. Danias, “Effect of motion on
cardiac SPECT imaging: recognition and motion
correction.” J. Nucl. Cardiol, vol.8, no. 6, pp.701-706,
Nov.2001
J.D. Morgenstern, M.A. Gennert, S. Nadella, N. Kumar,
G.C. Speckert, P.P. Bruyant, M.A. King. “A real time
multi-threaded system to detect patient motion in SPECT
imaging using multiple optical cameras.” Medical
Imaging Conference IEEE 2004 Rome, Italy - M5-74.
P.P. Bruyant, M.A. Gennert, G.C. Speckert, R.D. Beach,
J.D. Morgenstern, N. Kumar, S. Nadella and M.A. King.
“A robust visual tracking system for motion detection in
SPECT: Hardware solutions.” Medical Imaging
Conference IEEE 2004 Rome, Italy - M5-266.
M.A. Gennert, P.P. Bruyant, M.V. Narayanan, and M.A.
King. “Assessing a system to detect patient motion in
SPECT imaging using stereo optical cameras.” Nuclear
Science Symposium Conference Record, 2002 IEEE ,
Volume: 3 , 10-16 Nov 2002 Page(s): 1567 -1570. IEEE
R.R.Fulton, S.Eberl, S.R.Meikle, B.F.Hutton, and M.
Braun, “A practical 3D tomographic method for
correcting patient head motion in clinical SPECT.” IEEE
Trans. Nucl. Sci., vol. 46: pp. 667-672, June 1999.
ME Casey, H Gadagkar and D Newport 1995 "A
component based method for normalisation in volume
PET" Proceedings of the 3rd International Meeting on
Fully Three-Dimensional Image Reconstruction in
Radiology and Nuclear Medicine, Aix-les-Bains, France.
Matsumoto N, Berman DS, Kavanagh PB, Gerlach J,
Hayes SW, Lewin HC, Friedman JD, Germano G.
“Quantitative assessment of motion artifacts and
validation of a new motion-correction program for
myocardial perfusion SPECT.” J Nucl Med. 2001
May;42(5):687-94.
MH Hudson, RS Larkin, "Accelerated image
reconstruction using ordered subsets of projection data."
IEEE Trans Med Imaging vol 13, pp. 601-609, 1994.


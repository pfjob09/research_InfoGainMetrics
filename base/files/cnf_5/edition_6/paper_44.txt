PDE-Driven Implicit Reconstruction of 3D Object

H.F. Zeng Z.G. Liu* Z.H. Lin
State Key Lab for Manufacturing System Engineering, CIMS center
Xi’an Jiaotong University, 710049, P.R. China
haifei@stu.xjtu.edu.cnˈmezgliu@mail.xjtu.edu.cn
method can resolve the topology automatically, but is

Abstract

not robust to noise.
Partial

differential

equation

(PDE)

based

This paper presents a PDE driven method for

approaches to solve level-set problems were presented

implicit reconstruction of 3D object from point cloud.

by Osher and Sethian[2] as a robust method to track

We represent a shape by its signed distance function

dynamic interfaces. Surface fitting methods using this

and formulate shape reconstruction as a constrained

technique start from an initial surface and deform the

energy minimization problem directly based on the

surface interface toward the data set by evolving a PDE

point cloud. First, we calculate the signed of distance

until some criterion is met. Whitaker[3] proposed a

of point cloud by fast sweeping. Then, we get evolution

PDE-based

equation of deformable surface by minimizing the

reconstruction from range data, but the method is

energy function of surface. Finally, we give numerical

designed only for dense range data. H.Zhao[4] et al.

solution of this evolution equation. The deformable

reconstructs

surface can automatically adapt the topology of object.

corresponding to a distance transform derived from the

The experimental results show that the deformable

data set. But this approach is designed for use with

surface can continually shrink to the surface of object.

clean data, thus data uncertainty is not taken into

level

a

set

shape

approach

as

the

for

3D

minimal

shape

surface

account.

1. Introduction

We represent a shape by its signed distance function
by using fast sweeping method and formulate shape

Reconstructing 3D object surfaces from 3D data

reconstruction as a constrained energy minimization

points is important to many applications such as

problem based on the point cloud. Then, we derive the

reverse engineering, object recognition, inspection,

evolution

computer graphics and medical imaging. Several

minimizing the energy function of surface and we give

methods based on implicit shape representations and

numerical solution of this evolution equation.

equation

of

deformable

surface

by

level set methods have been proposed in the recent
years, because of their ability to handle topological
uncertainties in the scene. For example, Hoppe[1] et al.
proposed an algorithm for constructing a signed
distance function from unorganized points. Their
* Corresponding Author

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

2. Problem Statement
The basic idea of our method is that we define a
closed deformed surface

Γ(t ) in R 3 , in the effect of

itself conditions and the object, shrink to the object S.

object, we constrain energy minimization to control vn.

We formulate the process of the deformed surface

The direction of shrinking should along the degression

shrink to object as the following constrained energy

of surface energy. First we find the gradient descent

minimization problem:

direction of the function φ ( x, t ) due to Ed and Es, and

Γ(t ) = arg min E (Γ(t ))

(1)

then construct velocity vn. So vn has two parts, one
component due to Ed, another component due to Es.

E (Γ(t )) is the surface energy, include two

where
parts:

The first variation of Ed with respect to φ is obtained
as:

E (Γ) = ¦ d ( x 0 ) + ³ ∇Γ dΓ

	


x0

	


Es
2

(2)

∂E d
=
∂φ

Ed

∂ ¦ d 2 ( x0 )
x0

∂φ

= 2 ⋅ ¦ d ( x0 )

(6)

x0

where Ed is the external energy of deformable surface
that make deformable surface move to expected object,

d ( x0 ) is the shortest distance from point x0 to the
surface
is, d ( x 0 )

of

object,

denoted

as

S,

that

= min dis ( x0 , S ) , x0 ∈ Γ , and Es is the

internal energy of deformable surface, which make the
deformable surface smoothly.
To solve the deform process, we discretize

Γ(t )

in 3D, use the Signed Distance Field to describe the
surface. We use

φ ( x, t )

to denote the Signed

Distance Function, its value is the distance from the
point x to Γ .

We approximate the velocity vn at point x0 is
negative to the gradient value of Ed:

º
ª dφ
» = − k ¦ d ( x0 ) = Fd
« dt
x0
¬ x = x0 ¼ d

(7)

Using the result of H.Zhao[5], the component due to
Es is given by:

§
·
ª dφ º
¨ ∇ ⋅ ∇φ ¸ ∇φ = H ⋅ ∇φ
=
« dt »
∇φ ¸¹
¬ ¼ s ¨©

(8)

where H is mean curvature.

φ ( x, t ) > 0
φ ( x, t ) = 0
φ ( x, t ) < 0

in Γ
on Γ
others

Finally, the function (5) is given by:
(3)

(9)

where Fd is shrink force which make deformable

So, the surface Γ(t ) can be identified as the zero

level set of φ ( x, t ) , i.e.

φ (Γ(t ), t ) ≡ 0

φt + Fd ∇φ + H ∇φ = 0

surface move to expected object, and H is surface
tension which smooth the surface. Through the effect
of shrink force and surface tension, the initial surface

(4)

can successful shrink to the object, and ensure the
smooth of surface and the right of topology.

Differentiating the equation (4) with respect to time,
we can get a PDE describe the surface deforming with

3. Method Implementation

time

φt +

dΓ(t )
⋅ ∇φ = 0 ⇔ φ t + v n ⋅ ∇φ = 0
dt

To realize the Level Set method, first we find an
(5)

initial surface

φ ( x , t = 0)

described as the Signed

where vn is the shrinking velocity with the normal

Distance Field (SDF) in a rectangular bounding box.

direction. To ensure the surface can shrink to the

Then, discretize the equation (9) at the grid points,

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

changing the time and space derivative to finite
where ( x )

difference.

+

x>0
x≤0

­x
=®
¯0

u xh min = min(u ih−1, j ,k , u ih+1, j ,k ),

3.1 Computing Signed Distance Field

u yh min = min(u ih, j −1,k , u ih, j +1, k ),
There are a few methods for computing the Signed
Distance Field (SDF). Hoppe

[1]

u zhmin = min(u ih, j ,k −1 , u ih, j ,k +1 )

found a simple way to

compute the Signed Distance Field (SDF), but the

b) Initialization

computation cost is quite expensive and it be restricted

We firstly calculate the values at grid points near ī,

within certain conditions. Another methods include

using the method described in Hoppe[1]. These values

[6] [7]

Fast Marching Method proposed by J.A.Sethian

,

are fixed in later calculations. Then, we set large values

and Fast Sweep Method proposed by H.Zhao . In this

at other grid points in the computational domain, these

paper, we use the Fast Sweeping Method, and expand

values will be updated later.

[8]

it to 3D to compute the Signed Distance Field.

c) Gauss-Seidel iteration
We firstly use equation (11) to update the value of
each grid from its adjacent points

3.1.1The 3D Fast Sweeping Method
1) Basic Equation
The

φ ( x) is the distance from points to the points

set ī, as described above, it satisfy the Eikonal
equation:

u ih±1, j ,k ˈ u ih, j ±1,k ˈ

u ih, j ,k ±1 and denote it as u . Secondly, compare u
h
new
with u i , j ,k , and select the smaller one to be u i , j ,k ,
new
old
that is, u i , j ,k = min(u i , j , k , u ) . In the whole computational domain, we compute the values with six
alternating orderings as X+, X-, Y+, Y-, Z+, Z-

∇φ ( x ) = 1
Its boundary value is

(10)

repeatedly. After several iterations, we can get the
exact value of all the grid points in computational

φ ( x ∈ Γ) = 0 ,

ī can be

domain.

points, curve and surface.
3.1.2 Estimating the Sign

2) Basic Algorithm

As discussing above,

we already have the Unsigned Distance Field of the

a) Discretization
We use the Godunov upwind difference scheme[9] to

surface, and now, we should estimate the sign of the

xi , j ,k as a

distance field. First, we find a grid point (i,j,k) outside

discretize the equation (10). We denote

grid point in the computational domain ȍ, denote h as
the grid size and

u ih, j ,k as the numerical solution

at xi , j ,k . So the equation (10) can been written as

[(u
+ [(u

h
i , j ,k

−u

h
i , j ,k

i = 2,..., I − 1

] + [(u
) ] =h

h
+ 2
x min

)

− u zhmin

+ 2

, j = 2,..., J − 1

h
i , j ,k

−u

]

h
+ 2
y min

)

2

the surface and

d i , j ,k ≥ ε , and mark this point as

outer point and being tagged, and then put it into the
tagging queue. Second, we find its adjacent points (i±1,
j±1,

k±1).

If

points

(i±1,

j±1,

k±1)

satisfy

d i ±1, j ±1,k ±1 ≥ ε and not been tagged yet, we put them
into the tagging queue and mark those point as outer
point and being tagged. And the same time, we pick

, k = 2,..., K − 1, (11)

point (i,j,k) out of the queue. Next, we repeat the
second step to all points in the queue, find its adjacent

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

points whose value bigger then İ, and pick it out of the

So evolution equation of deformable surface could

queue. Therefore, we can have all outer grid points

be calculated as below

which value bigger then İ.

φt = φ t +1 − φ t =

To all grid points, we use d 0 ( x ) to denote its signed
distance, its values as:

­ d ( x) − ε
d o ( x) = ®
¯− d ( x ) − ε
If

− (d ( x) + H ( x)) | ∇φ ( x) | ⋅∇t
=
− k ¦ d ( x0 ) ∇φ ⋅ ∇t −

tagged
others .

(14)

x0

φ x2 (φ yy + φ zz ) + φ y2 (φ xx + φ zz ) + φ z2 (φ xx + φ yy )

d 0 ( x) is the distance function to a smooth

surface, the zero level set is the true surface when İ is
zero. So we should choose the İ as small as possible.

2(φ x2 + φ y2 + φ z2 )

3

⋅

2

∇φ ( x) ⋅ ∇t

But in the fact, if we choose İ less then certain value,

Now, the algorithm of PDE-Driven implicit

the initial surface will be split into two surfaces. As

reconstruction of 3D object can be summarized as the

Amenta

[10]

discussion, İ should be choose bigger then

α /2 , α

is the maximum distance between two

connected

data

points

in

ī.

Commonly,

we

choose ε ≥ h , h is the grid size.

following
1) Set iteration times n=0, initialize surface, use the
h

equation (11) to compute each grid points value u i , j ,k .
2) Use the equation (12), (13) to compute each grid
point’s outside force Fd, and surface smooth coefficient

3.2 Numerical Solution of PDE

H;
3) Based on its shrink velocity and its value

In this section, we use upwind scheme to compute
the first and second derivative of each grid point. We
denote the value of grid point xi , j ,k as

u ih, j ,k , its

derivative can be calculated as below:

φ

(n + 1)∇t time.
4) If surface has shrunk to the true surface of the
step (2) and (3).

≅ (u i , j ,k − u i −1, j , k ) / h
4. Results

φ x ≅ (u i +1, j ,k − u i −1, j , k ) /(2h)
φ xx ≅ (u i +1, j ,k + u i −1, j ,k − 2u i , j ,k ) / h 2

In this section, we will show some results obtained

φ zz ≅ (u i , j , k +1 + u i , j ,k −1 − 2u i , j ,k ) / h 2

by our PDE-driven implicit reconstruction method. The
program is written in VC++ and OpenGL. The 3D data

φ xy ≅ δ xδ y u i , j ,k

clouds are downloaded from Hoppe’s website:
http://ftp.research.microsoft.com/users/hoppe/data/thes

(12)

is. Some experiment results are shown in Figs.1~3,

The mean curvature is

H=

at n∇t time, use equation (14) to compute its value at

object, then stop iteration, or else set n= n+ 1, repeat

φ x( + ) ≅ (u i +1, j ,k − u i , j ,k ) / h
(−)
x

u ih, j ,k

φ x2 (φ yy + φ zz ) + φ y2 (φ xx + φ zz ) + φ z2 (φ xx + φ yy )
2(φ + φ + φ )
2
x

2
y

2
z

3

where Fig.1(a)~Fig.3(a) are original 3D data cloud,
(13)

2

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

Fig.1(b)~Fig.3(b) show initial model to be deformed,
and Fig.1(c)~Fig.3(c) show final reconstructed model.

Fig.1(a) Initial data sets

Fig1.(b) Initial shape

Fig.1(c) reconstructed shape

Grid: 91×62×52

Fig.2(a) Initial data sets

Fig.2(b) Initial shape

Fig2(c) reconstructed shape.

Grid: 81×67×91

Fig.3(a) Initial data sets

Fig.3(b) Initial shape

Fig.3(c) reconstructed shape.

Grid: 91×62×52

5. Conclusions

further improve the precision of reconstructed model
and its computable efficient.

We present a PDE driven implicit reconstruction for
3D object with arbitrary topology. The evolution of
surface is formulated as minimal energy of deformable

Acknowledgements

surface and represented a deformation model by its
signed distance function. Numerical experiments are

The work described in this paper was supported by

given. In our numerical experiments, the models are

a grant from the National Natural Science Foundation

automatically and successfully reconstructed without

of China (Project No. 50305027) and a grant from 973

other geometrical information of the shape. This

High Technology Plan (Project No. 2003˄B716207˅)

method has potential to the reconstruction of 3D object
with the complex topology. In the future work, we will

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

References

laws”, Jouranl of Differential Geometry, 1990, vol 31,
no 1, pp.131-161.

[1]. H.Hoppe, “Surface reconstruction from unorganized
points”, Unviersity of Washington, USA, 1994.
[2]. S.Osher,

J.A.Sethian,

“Fronts

propagating

Method for Propagating Interfaces”, Journal of
with

curvature dependent speed: algorithms based on
Hamilton-Jacobi formulation”, Journal of Computer
Physics,1988, vol 79, no 1,pp. 12–49.

Computational Physics,1995,vol 118,no 2,pp:269.
[8]. H.Zhao,

“Fast

sweeping

method

for

Eikonal

equations”,
http://www.math.uci.edu/~zhao/publication, 2003.

[3]. Ross T. Whitaker, “A Level.set Approach to 3D
Reconstruction from Range Data”, The International
Journal of Computer Vision, 1998, vol 29, no 3, pp.
203–231.

[9]. Elisabeth Rouy, Agnès Tourin, “A viscosity solutions
approach to shape.from.shading”. SIAM Journal on
Numerical Analysis, 1992, vol 29, no 3,pp:867–884
[10]. Nina Amenta, Marshall Bern, David Eppstein, “The

[4]. H.Zhao et al,
reconstruction

“Implicit and nonparametric shape
from

unorganized

data

using

a

variational level set method”, Computer Vision and
Image Understanding, 2001, vol 80, no 3, pp.295–314.
[5]. H.Zhao et al, “A Variational Level Set Approach to
Multiphase

[7]. D.Adalsteinsson, J.A.Sethian, “A Fast Level Set

Motion”,

Journal

of

Computational

Physics, 1996, vol 127, pp.:179–195.
[6]. J.A.Sethian, “Numerical algorithms for propaggating
interfaces: Hamilton-Jacobi equations and conservation

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

Crust and the ȕ-Skeleton: Combinatorial”, Curve
Reconstruction. 1998, vol 60, no 2, pp:125–135


Embedded Progressive Joint Source-Channel Coding Based on Zerotree
CHEN Shu-zhen, YANG Shen, SHE Kun
School of Electronic Information, Wuhan University, Wuhan 430079, Hubei, China
{szchen@whu.edu.cn, ysss@tom.com, intel_ghost@sina.com.cn}

Abstract
This paper proposes a joint source-channel coding
scheme based on integer wavelet high frequency
zerotree, which can produce embedded progressive
code stream with low bit-rate. In this scheme, by
scanning the source with a set of pre-set thresholds,
value and location information of significant wavelet
coefficients are got, encoded and transmitted,
respectively. The code stream resulted from this
procedure can be transmitted losslessly and
progressively over noiseless channels, or embedded
progressively and reliably with a low bit-rate over
noisy channels (random or burst noise). Experiments
show that this scheme can get high PSNR and
compression rate over noisy channels, and can
transmit the source more reliably and robustly with
low bit-rate over varying channels. Therefore it is
competent for application in wireless communication.
Keywords---Integer wavelet; High frequency
zerotree; Joint source/channel coding; LIS; VIS

1. Introduction
In recent years, especially in the wireless
communication, source-channel joint coding [1] [2] is
paid more and more attention to and it will be adopted
in the fourth generation mobile communication [3].
Many methods [1] such as technologies of joint coding
based on the residual redundancy, adaptive error
correction, and source-channel joint optimization have
been proposed.
The embedded fashion has also been introduced to
the coder designing [4]. The embedded coder can cease
at any time and provide the “best” representation of an
image achievable within its framework. In this paper,
we propose a scheme of Embedded Progressive Joint
Source-Channel Coding (EPJSCC) for transmitting
images. This scheme integrates joint source-channel
coding with integer wavelet zerotree to enable

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

embedded progressively image transmission. In this
scheme, by scanning the source with a set of pre-set
thresholds, value and location information of
significant wavelet coefficients are got, encoded and
transmitted, respectively. The code stream resulted
from this procedure can be transmitted losslessly and
progressively over noiseless channels, or embedded
progressively and reliably with a low bit-rate over
noisy channels (random or burst noise).
This paper is organized as follows. Section 2
introduces the concept and the distribution of integer
wavelet zerotrees. Section 3 describes the process of
encoding in detailed and proposes a new thresholdscanning scheme. In section 4, the process of decoding
is described. Section 5 presents how to implement
embedded progressive transmission and reconstruction.
In section 6 some experimental results are presented.

2. Zerotrees of integer wavelet coefficients
Compared with the first generation wavelet
transform, the second one, namely the integer wavelet
transform, has such characteristics as integercoefficients, fast-computation and ability of entire
reconstruction. For a gray image, if its original data
consist of integers, they can be lossless-compressed
from integers to integers.
When an n-scale integer wavelet transform has been
performed to a static image, with the exception of the
highest frequency subbands, every coefficient at a
given scale can be related to a set of coefficients at the
next finer scale of similar orientation. The coefficient
at a coarse scale is called the parent, and the set of all
coefficients corresponding to the same location at all
finer scales of similar orientation are called its
descendants. The conceptions of parent and descendant
are not introduced to the coefficients of the low
frequency subband at the highest scale. Then highfrequency zerotree is defined as follows. In high
frequency subbands, if a coefficient and its
descendants are all less than a given threshold, the tree
consists of them is called a high-frequency zerotree,
and the coefficient at the highest scale is called a

zerotree root. If one or a few descendants in a tree are
larger than the threshold, this tree is called a halfzerotree. If a coefficient that does not belong to any
zerotree and is above the threshold is called an isolated
point. In this way, all integer wavelet coefficients can
be represented as the sets of high-frequency zerotrees,
half-zerotrees and isolated points. With the reduction
of scale, the descendants of a high-frequency zerotree
become less and less, yet the number of high-frequency
zerotrees becomes more and more. This, to a certain
extent, offsets the redundance brought by less
descendants of high frequency zerotree. Thus we hope
that the number of high-frequency zerotrees at every
scale is as large as impossible so that we can easily
denote all elements of a zerotree with one bit.
Experiments show that there are plenty of highfrequency zerotrees in the integer wavelet coefficients
of an image signal.

Figure 1. Schematic diagram of high
frequency zerotrees (three scales)

3. Joint encoding
The EPJSCC scans the coefficients of an image
according to the pre-designed scanning rule, picks up
their location and value information, then encodes and
transmits them respectively. It consists of the following
six parts.
1)
Select the type of integer wavelet according to
the characteristics of the transmitted image.
2)
Design a scanning scheme on integer wavelet
coefficients, which is simple, speedy and easy to carry
out the embedded progressive coding.
3)
Encode the coefficients of the low frequency
subband at the highest scale with DCT coding and then
quantify them.
4)
Design a threshold scheme in which the threshold
sequence is descending.

5)
For a given threshold, scan the coefficients of
three high frequency subbands at each scale according
to the pre-designed scanning scheme, and get the
corresponding Location Information Stream ˄ LIS ˅
and then encode it.
6)
Put the coefficients that are less than the
threshold into a linked list called Value Information
Stream (VIS). Then encode the VIS. When the scan is
over, the LIS and the VIS are outputted. And then
replace the threshold and return step 5 until all
coefficients have been transmitted.
The structure of EPJSCC is shown in figure 2 where

T , T ,", T ,"

1
2
i
the parameters
are different
thresholds. The above steps will be discussed in detail
hereinafter.



Figure 2. Schematic diagram of the EPJSCC

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

3.1. Selection of integer wavelet type
According to “the relationship of analyzing
vanishing moment and integer wavelet transform”
introduced by A.R.Calderbank [5], wavelet filters with
more analyzing vanishing moments generally perform
well with nature images. But the decomposing effect of
the complicated (9-7) is not much better than that of
the simple (4-2). Through the weighing of the
complexity and the effectiveness, we have chosen the
(4-2) which has 4 analyzing vanishing moments.

3.2. Scanning scheme
The EPJSCC adopts a modified Raster Scan method
[6] to scan wavelet coefficients. At each scale, this
method scans subband HL first, then LH and HH.
Within a subband, coefficients are line by line scanned
from left to right and from up to bottom. The scanning
pattern for a 3-scale wavelet transform is shown in
figure 3. If a zerotree at a certain scale is discovered,
the children at the next scale can be ignored and
scanning route need not be changed, too.

Figure 3. Scanning pattern of the modified
Raster Scan method

3.3. Compression of low frequency subband
coefficients at the highest scale
When integer wavelet transform of J -scale has
been performed to a gray image, the amplitudes of the
low frequency subband coefficients at the highest scale
change slowly, so the EPJSCC applies quasidistortionless compression with a DCT-based error
correcting arithmetic [7] which was proposed by
O.R.Mitchell and need no error code. Plenty of
experiments show that this arithmetic can detect and
correct most of errors when we set θ = 1.6 and
λ = 2 .2 .
Although quasi-distortionless compression can
reconstruct almost all information of low frequency

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

subband, its compression rate is generally very low.
Therefor, in the case of low bit-rate compression, we
will have to compress the coefficients of high
frequency subbands a great deal. So quantization to
low frequency coefficients is performed. Although
quantization produces some losses of low frequency
information, its code rate is lower than that of quasidistortionless compression so that more high frequency
information can be kept. If a well-designed quantizer is
used, its whole compression performance will be
higher than that of quasi-distortionless compression
coding. However, it should be ensured that the
reconstruction distortion of quantization is less than
that of channel noise.

3.4. Threshold scheme
Our aim of designing the threshold scheme is to
perform the embedded coding as the same as EZW [4].
In EZW, thresholds are chosen according to the
rule Ti = Ti −1 / 2, i = 1,2 ! , and the threshold
interval is descending. When the threshold is larger,
the coefficients that are scanned out are larger and
correspondingly their dynamic range is larger,
therefore it is unfavorable to quantize the VIS. When
the threshold is smaller, it is quite the contrary.
However, smaller coefficients have less influence upon
image reconstruction. As a result, this threshold
scheme will lead to a high bit rate. The EPJSCC adopts
a new threshold scheme where the interval becomes
larger and larger with the reducing of threshold. This
scheme can improve not only the compression rate but
also the anti-noise performance. For a large coefficient,
because its dynamic range is small, the step and
codebook size are also little in vector quantization
coding. When errors occur in the course of
transmission, error codebooks can be corrected into a
small range of codebook and therefore the error
brought is less than that of large threshold range and
long codebook size.
The threshold sequence is generated from the rule

Ti = Ti −1 − 3 i , i = 1,2 !

,

where

T0 = MAX( γ ( x, y ) ) . Because integer wavelet
transfer is used and all wavelet coefficients are integer,
T
the minimum of i is 1 and coefficients need not be
transmitted when they are equal to 0.

3.5. LIS encoding
Coefficients that are above or equal to the threshold

Ti are called significant coefficients, and their
positions compose the LIS. A scan of the coefficients

is performed according to the scanning scheme
presented above. The scan begins at the subband HL at
the highest scale. If a coefficient is not only a zerotree
root but also a significant coefficient, its descendants
will not be scanned; if a coefficient has been scanned
as a significant coefficient, it need not be scanned
again. The detailed scanning steps are as follows.
1)
If coefficients have been scanned for
thresholds Ti − j , j = 1, 2 " and significant ones have

been transmitted, the scan for the threshold Ti is
performed according to the pre-set scanning order until
no significant coefficient is discovered.
2)
If a coefficient is above or equal to threshold
Ti , the code “1” is outputted to the LIS, and at the
same time its value is moved to the VIS; if the tree
including this coefficient is a half zerotree, the code
“1” is outputted to the LIS, and at the same time its
value is moved to the VIS, and then go to step 3; if the
tree is a high-frequency zerotree, the code “0” is
outputted to the LIS.
3)
Change scanning route and scan each
descendant block from left to right and from top to
bottom; If a descendant is above or equal to the
threshold Ti , the code “1” is outputted to the LIS, and
at the same time its value is moved to the VIS; Then it
is regarded as a subtree root and its descendants are
scanned according to the same rule until the lowest
scale; Return to the half subzerotree root and continue
scanning.
4)
The LIS is encoded and transmitted.
5)
If Ti +1 exists, go to step 1. Otherwise, the
scan is over.
When all coefficients have been scanned, codes “0”
are all abandoned. For a high-frequency zerotree that
exists in a large amount, we need output only a bit “0”
and need not scan all of its coefficients. For a half
zerotree, it is troublesome in encoding. However,
experiments show that there are plenty of successive
codes “0” in the LIS, thus we will get a few LIS codes
if the LIS is encoded with arithmetic coding of high
compression rate. The LIS adopts adaptive arithmetic
coding [8] and RCPC coding [9] for error protection
because LIS codes have relation to synchronization
while reconstructing at the decoding end and need to
be protected with strong error correcting code.
Additionally, the speed of obtaining the LIS is very
fast, and the EPJSCC, for a threshold, need only scan
the image once and make comparison operations.

3.6. VIS encoding
The VIS is generated at the same time as the LIS is
generated. Its length, under a given threshold, is equal

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

to the number of the “1” code in the LIS, and its total
length is equal to the length of the one-dimensional
signal into which the original image is transformed.
T
T
For a threshold i , when subtracting i from the
corresponding values in VIS, we will get the difference
sequence. The sequence can be transferred with fewer
bits because its variance is smaller than the variance of
the original sequence. Additionally, integer wavelet
transform is used in this paper, and therefore,
1㧕
Over noiseless channels, when every
difference sequence is encoded with the method of
adaptive arithmetic coding, progressive losslesstransmission is ready.
Over noisy channels, in order to more reliably
2㧕
transmit codes with lower code rate, the EPJSCC
adopts a vector quantizing coding method of
progressive error correcting. This method consists of
convolution code whose code rate is k /(k + 1) ( k is the
size of coding sequence) and Viterbi decoding. In this
way, instead of the difference sequence, the index
numbers of codebook that is much shorter than the
former are transmitted.
The other prominent characteristic of the EPJSCC is
its strong burst noise immunity. To wireless channels,
burst noise is easily produced because of such factors
as environmental noise, Rayleigh fading and Multipath
interference. The EPJSCC transmits signals while it
scans. As the size of the LIS is less than that of the
VIS, and the LIS is added error-correcting code so that
its anti-noise ability is relatively strong, the burst noise
has a great probability being in the VIS. For example,
to a threshold Ti , if a few successive bits errors are
produced in the VIS codes, the grid-based vector
quantization can not correct them. Error codebooks
will be replaced with the median of the corresponding
threshold range at the receiving end and thus the
skewness that bring from this can be reduced to the
minimum extent. Additionally, even if error bits don’t
be found out, the skewness to which Ti is added is
very little because decoded error signals are only the
difference signals.

4. Decoding
The DCT quantizing code stream of coefficients in
low frequency subband at the highest scale is firstly
received at the decoding end and is corrected with the
DCT-based error correcting arithmetic mentioned
above. Then the LIS and the VIS are received in turn
according to the order of threshold decrease. When the
LIS is corrected and decompressed, the data are filled
in a pre-constructed idle matrix, all values of which are
zero, based on the same scanning order as the sending

end does. Its decoding principle is the same as the
encoding one. If a code is “1” in the LIS, its
corresponding value in the VIS adds the threshold
value is put into the matrix. Furthermore, the decoding
speed of the VIS is very fast due to only the table lookup operator being needed. Finally the reconstructed
image will be got after an integer wavelet inverse
transform is performed to the matrix in which has been
filled.

5. Embedded progressive transmission and
reconstruction
Because of the scanning scheme above and the
separation of LIS and VIS, images can be embedded
progressively transmitted by the EPJSCC. It orderly
scans and transmits the code stream for different
threshold to meet the need of progressive coding; to a
given threshold, the EPJSCC transmits the LIS first,
then the VIS, thus the VIS may be truncated anytime,
and its code rate may be changed arbitrarily but
reconstruction will not be destroyed at the decoding
end. Several cases are discussed below:
1) If the LIS for the threshold Ti is truncated, the LIS
will be decoded into incomplete location information
code according to which the locations of many
significant coefficients will be fixed. Because the
corresponding VIS is not transmitted, in order to
reduce losses to the minimum extent, values in the VIS
will be replaced with the average of difference
sequence.
2) If the VIS for Ti is truncated, the complete LIS will
be decoded into complete location information code
and the missing values in the VIS may be replaced
with the average of the difference sequence.
3) The code rate of joint coding can be adjusted.
Increasing the codebook dimension in vector
quantizing for the VIS or abandoning some relatively
insignificant coefficients can produce the code stream
of lower code rate. On the contrary, the code stream of
higher code rate can be produced. If the EPJSCC is
required to transmit code stream, which has been
encoded, at a lower code rate, the VIS may be
arbitrarily truncated and then the image will be
reconstructed according to (2).

Figure 4. (a) the case of LIS being truncated,
(b) the case of VIS being truncated

6. Experiment results
The standard 8bpp gray image, 512h512 “Lena” is
used as the experiment image and a binary symmetric
channel is used as the simulated channel. In order to
get more objective data, every kind of experiments is
performed repeatedly 50 times, and then the average is
calculated.
ķ
When different threshold schemes are used,
coding results of the EPJSCC are shown in table 1. We
can see, whatever BER is, PSNR of the EWZ threshold
scheme is the lowest, that of EPJSCC’s is the highest,
and the difference of them is about 5 dB.
Table 1 Comparison of PSNR of different
threshold schemes in the case of different
BER (0.5bpp)

Threshold scheme
Descending interval
(Ti +1 = Ti / 2)
Equal interval
( Ti +1 = Ti )
Increasing interval
( Ti = Ti −1 − 2 i )

0

BER
0.001

0.01

30.98

29.25

28.11

34.28

33.10

32.59

36.71

34.62

33.96

ĸ
In the case of random noise, performances of
different coding schemes are shown in table 2.
Obviously, the performance of EPJSCC is superior to
A-RQ [10] and S/C-SUB(D) [11]. As to
SPIHT/RCPC/CRC [12], its PSNR will be very low if
BER is unknown and changing. Moreover, with the
increase of BER, PSNR of EPJSCC drops much slower

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

than that of other schemes, thus EPJSCC performs
better in the abominable channel.
Table 2 Comparison of PSNR of several coding schemes

Code Rate

0.25bpp

0.5bpp

BER

0.001

0.01

0.05

0.1

0.001

0.01

0.05

0.1

SPIHT/RCPC/CRC
EPJSCC
S/C-SUB(D)
A-RQ

33.16
31.43
30.94
30.34

31.91
30.96
29.96
29.24

28.23
29.38
22.19
27.61

28.50
28.92
N/A
24.12

36.25
34.62
33.90
33.00

34.96
33.96
32.38
31.42

32.88
32.67
23.56
28.35

31.23
31.49
N/A
24.82

Ĺ As shown in table 3, the EPJSCC can either
suppress burst noise well.
Table 3 Comparison of PSNR of several
coding schemes

Code Rate
Successive
Error Length
SPIHT/RCPC/
CRC
EPJSCC

0.25bpp

0.5bpp

3

5

3

5

29.39

N/A

30.61

27.33

30.89

28.32

32.56

30.79

Conclusions
This paper presents a new scheme of joint
source/channel coding-EPJSCC, which not only can
lossless-transmit signals progressively in the noiseless
channels, but also can transmit them reliably at a low
bit-rate in the noisy channels. Experiment data
provided in this paper show that the EPJSCC performs
better than other coding schemes no matter in the
random noise or in the burst noise cases, and therefore
it can transmit code stream more reliably and more
robustly. Moreover, the use of integer wavelet
transform, not the first generation one, makes
operation time and location reduced much, and the
scan of high frequency zerotrees and the coding of LIS
and VIS can also be performed by such simple
operations as addition, subtraction, shift and compare.
As a result, the EPJSCC not only has fast coding speed
but also can be easily implemented by hardware.

Acknowledgements
This paper is supported by the National Natural
Science Foundation of China (50099620).

References

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

[1]

Xiao Dongliang, Sun Hong, Jiang Sen, “Joint SourceChannel Coding Method for Image Transmission over
Wireless Channels”, Journal of Wuhan University
(Natural Science Edition), 2002, 48(1), pp. 089-093.
[2] A.D. Murugan, P.K. Gopala, H.E. Gamal, “Correlated
sources over wireless channels: cooperative sourcechannel coding”, IEEE on Selected Areas in
Communications, 2004, 22(6), pp. 988-998.
[3] Leonardo Camiciotti, “Joint source-channel coding for
4G multimedia streaming”, Wireless World Research
Forum (WWRF).
[4] W.Sweldens, “Embedded image coding using zerotree
of wavelet coefficients”, Proceeding of IEEE on Signal
Processing, 1993, 41(12), pp. 3445-3462.
[5]
A.R.Calderbank, “Wavelet Transforms that Map
Integers to Integers”, Applied and Computational
Harmonic Analysis, 1998, 5(3), pp. 332-369.
[6] V.R. Algazi, R.R. Estes, “Analysis Based Coding of
Image Transform and Subband Coefficients”,
Proceedings of the SPIE, 1995, 25(64), pp. 11-21.
[7] O.R.Mitchell, A.J.Tabatabai, “Channel Error Recovery
for Transform Image Coding”, IEEE Transaction on
Communication, 1981, COM-29(12), pp. 1754-1762.
[8] Klaus Stuhlmüller, Niko Förber, “Analysis of video
transmission over lossy channels”, IEEE on Selected
Areas in Communications, 2000, 18(6), pp. 1012-1032.
[9] Jianfei Cai, “Robust Joint Source-Channel Coding for
Image Transmission Over Wireless Channels”,
Proceeding of IEEE on Circuits and System, 2000,
10(6), pp. 962-966.
[10] Q.Chen, T.R.Fischer, “Image coding using robust
quantization for noisy digital transmission”, IEEE
Trans. Image Processing, 1998, 7(4), pp. 496–505.
[11] N.Tanabe, N.Farvardin, “Subband image coding using
entropy-coded quantization over noisy channels”,
IEEE Journal of Selected Areas Communications,
1992, 10(6), pp. 924–943.
[12] Jianfei Cai, “Robust Joint Source-Channel Coding for
Image Transmission Over Wireless Channels”,
Proceeding of IEEE on Circuits and System, 2000,
10(6), pp. 962~966.


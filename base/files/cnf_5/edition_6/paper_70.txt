A geometric interpretation of weighted normal vectors and its improvements
Sheng-Gwo Chen* and Jyh-Yang Wu
Department of Applied Mathematics, National Chiayi University, Chia-Yi 600, Taiwan.
Depatment of Mathematics, National Chung Cheng University, Chia-Yi 621, Taiwan.
{*csg@mail.ncyu.edu.tw}
Abstract
The weighted normal vector method is applied to
estimate the curvatures on surface in 1990s[1,2,4,5].
However, this estimation method still causes some
serious problems, such as when two adjacent triangles
are of coplanarity. In this paper, our main goals are to
provide a geometric interpretation of weighted normal
vectors and then give an improvement to handle this
problem. In 2004, we pointed out that the normal vector
estimation with area weights can not distinguish the
difference of contributions when two different triangles
have the same area. To deal with this drawback, we
presented the centroid weight to improve the estimation
of normal vectors. Here, we give a particular
interpretation of centroid weight and extend this idea to
introduce a new weight, the gravitational weight.
Keywords--- Centroid weight,
weight, geometric interpretation..

gravitational

1. Introduction
The tensor of curvatures of a regular surface plays
an important role in the theory of 2-surfaces[3].
Basically, the tensors of curvature are the derivatives of
normal vectors. Thus, to give a good estimation of
normal vectors for a triangular mesh is a crucial step to
the estimation of curvatures.
Since early 1990's, the well-known estimation of
normal vectors is the are-weight estimation. The
algorithm of area-weight normal vector estimation is
simple[1,5] and only uses the information of the adjacent
triangles of a vertex on the triangular mesh. This means
that the estimation of the area-weight normal vectors has
the local property, and this property is a character of the
normal vectors and curvatures in the theory of regular
surfaces. Moreover, this method transfers the problem of
approximation into a good choice of weights. In 1999,
Max[4] presented a new kind of weight to improve this
estimation method. In 2004, Chen and Wu[2] also
improved this estimation method from the viewpoint of
duality. However, they don't provide a theoretic
interpretation of the weighted normal vector. In this
paper, we first give a general, natural and geometric
interpretation of weighted normal vectors. From this
interpretation, the weighted normal vectors can be used
on any polyhedron model, not just triangular mesh.
Furthermore, in order to give a better estimation of the

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

normal vectors, we try to improve the drawback about
triangles with equal area from our interpretation. Finally,
we extend the centroid weight[2] and introduce a new set
of weights, called gravitational weights, from the
viewpoint of gravitation.

2. A geometric interpretation of weight
normal vectors
In 2000, Max gave a simple and natural
interpretation of the weighted normal vector. In this
section, we will give another interpretation of the
weighted normal vector from numerical analysis,
optimization and Gauss map in differential geometry.
First, let S be a regular surface in R 3 and N p be the unit

normal vector at p on S . If there exist two curves

α 1 ( s ) and α 2 ( s ) on the surface S such that
α 1 (0) = α 2 (0) = p and α 1 ' (0) ∧ α 2 ' (0) ≠ 0 where 0 the
zero vector in R 3 . The Taylor’s expansion of these
curves give:
α 1 ( t ) = α 1 ( 0) + α 1 ' ( 0) t + o ( t )
(1)
α 2 ( t ) = α 2 ( 0 ) + α 2 ' ( 0 )t + o ( t )
(2)
From above, we have (α 1 (t ) − α 1 (0)) ∧ (α 2 ( s ) − α 2 (0))
= (α 1 ' (0) ∧ α 2 ' (0) st + o( st )
This implies that the normal vector n p at p on S is
(α 1 (t ) − α 1 (0)) ∧ (α 2 ( s ) − α 2 (0))
(3)
st
when the value s and t are close to 0. Further, we
denote α 1 (t ) = q1 and α 2 ( s ) = q2 when p − q1 and
np ≈

p − q 2 are small. The normal vector becomes
( p − q1 ) ∧ ( p − q 2 )
as s, t → 0
(4)
st
On the polygon model S , consider a vertex v ∈ S . Let
V = {v j ∈ S | j ∈ {0,1," , m}} be the set of the neighbors

np ≈

of v which are permuted counterclockwise and v 0 = v m .
For each v j ∈ V , there exists a curve α j (t ) on S such
that α j (0) = v and α j (t j ) = v j for some t j ∈ R + . Let
f j be the triangle constructed by the vertices v , v j and
v j +1 . Then for each triangle f j , we can approximate the

normal vector n j at p on S by Equation (1). Namely,

nj =

( v j +1 − v ) ∧ ( v j − v )

(5)

t j +1 t j

Assume the number of those triangles with vertex v is
m . Equation (5) gives us the normal vector for each
triangle. The problem now become a classical optimal
problem: is there a vector n such that the sum of the
square of distance between n and n j for each
j ∈ {0,1," , m − 1} achieves its minimum. That is,
m −1

(LSP)

¦ n−n

Min

3. The problem of coplanarity

2

(6)

j

j =0

Obviously, the minimum of this least square problem
happens at the average of these vectors
{n j | j = 0,1," , m − 1} . Hence, the best solution n of
the problem (LSP) is given by the average of these m
vectors n j , j = 0,1," m − 1 . That is,
m −1

n=

¦n

j

j =0

(7)
m
The unit normal vector at v on the polyhedron model S
m −1 (v
− v ) ∧ (v j − v )
j +1
is given by N v =

¦
j =0

t j +1 t j

m −1

( v j +1 − v ) ∧ ( v j − v )

j =0

t j +1 t j

¦

j

normal

vector

fj .

of

Since

one

has

(v j +1 − v ) ∧ ( v j −v ) = f j N f . The unit normal vector N v
j

m −1

¦

Nv =

has the form:

fj Nf

j =0

t j +1t j

m −1

fj Nf

j =0

t j +1t j

¦

Let us denote the coefficient

j

t j +1 t j

vector. That is, i.e., they are of coplanarity. See figure 1.
When we use weighted methods to estimate the normal
vector, it seems that these two triangles can be treated as
one single triangle by Equation 9.

the same unit normal vector. We may assume the
vertices of f j are v , v j , v j +1 and the vertices of f j +1
are v, v j +1 , v j + 2 . The unit normal vector of those triangles

is denoted by N f . Of course, there exist two positive
values s, t ∈ R + such that
(10)
( v j +1 − v ) = s ( v j + 2 − v ) + t ( v j − v )
By Equation 5, we have
( v j +1 − v ) ∧ (v j − v ) (v j + 2 − v ) ∧ (v j − v )
n j + n j +1 =
+
t j +1 t j
t j +2 t j

j

fj

Although the weighted normal vector gives a family
of good methods to estimate the unit normal vector on
the polyhedron mesh. From our interpretation in section
2, there are some subtle problems need to be considered
further:
Problem 1: In Definition 1, suppose there exist two
adjacent triangles f j and f j +1 with the same unit normal

Figure 1: The problem of coplanarity.
Suppose there exist two triangles f j and f j +1 with

Let f j denote the area of the triangle f j and N f is the
unit

the normal vector works not only on triangular meshes
but also on any polyhedron models.
Property 1: The weighted normal vector v i on
polyhedron models only depends on the set of neighbor
of v i . Further, if the distance between v i and its
neighbors approach to 0, the weighted normal vector
will approach to the normal vector.

by ω j , the formula

of unit normal vector is
Definition 1: Let S be a polyhedron model and v a
vertex on S . If the set V = {v j | j ∈ {0,1," , m − 1}} is the

From Equation 10,
st j + 2 tt j (v j + 2 − v ) ∧ ( v j − v )
)(
)
n j + n j +1 = (
+
t j +1
t j +1
t j+2t j

We may choose the parameter of α j +1 (t ) so that

α j +1 (t j +1 ) = v j +1 when t j +1 =

set of neighbors of v , the formula
m −1

¦ω N
j

Nv =

fj

j =0

m −1

¦ω N
j

(11)

1
. Equation 11
st j + 2 + tt j +1

now becomes
as ω j ∈ R +

(9)

fj

j =0

is called the ω -weight normal vector at v on S where
f j is the triangle constructed by vertices v , v j , v j +1 and
N f is the unit normal vector of the triangle of f j .
j

Note that, the normal vector on regular surface only
depends on a small open neighborhood. In the weighted
normal vector, we only use the information of the
neighbors of v . Moreover, this method of estimating

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

n j + n j +1 = (

(v j + 2 − v ) ∧ ( v j − v )
t j+2t j

)

(12)

From this equation, we find that the vertex v j +1
should not be counted when we estimate the normal
vector by the weighted method. When we use the
weighted method to estimate the unit normal vector, the
adjacent vertices of v can be replaced by the following
rule :

Improvement 1: If two adjacent triangle f j and f j +1

Assume this representation is g . Let k be the curvature

have the same unit normal vector, the vertex v j must be

4. Some specific weights

and d the distance between two vertices. Since kd 2 is
scaling-invariant, the weight can be chosen as
1
ω=
. Moreover, from the theory of probability,
2
vi − g

The choice of weights is an important task in the
weighted normal methods. Here, our main task is to reinterpret the area-weight and the centroid-weight from
the theory of regular surfaces.
For the area-weight, we consider the curves
α 0 (t )," , α m (t ) as in section 2 and choose the
parameters of the curves with α j (t 0 ) = v j for each

the mean value is the best representation in a set of data,
generally. Since the mean value in a triangle is the
1
centroid point of triangle ¦ v where f is the triangle
3 v∈ f
on the triangular mesh. For these reasons, we can
improve the weighted normal vector by the centroid
weight. That is, the weight ω j of the triangle f j is

deleted from the set V in Definition 1.

j ∈ {0,1,", m} and a fixed value t 0 ∈ R + . The weight

ω j in definition 1 now gives: ω j =

fj

N v becomes: N v =

2
0

fj

¦t

2
0

Nf

j

=
Nf

ωj =

fj
t 02

fo each j ∈ {0,1,", m} . And the unit normal vector

¦t

chosen to be

¦
¦

fj Nf

j

fj Nf

j

j

Therefore, if we choose the parameter of those
curves α j such that they pass through the neighbors v j

1
g j − vi

2

,

where g j is the centroid point of f j .
The theory of gravity suggests that we can take this
mass c j = f j into consideration. Thus we can also
choose ω j =

fj
gj −v

2

.

These new weights ω j are called the gravitationalweights. Indeed, the gravitational weights also work for
any polyhedron models, not just for triangular meshes.

of v at the same times t 0 . Then the weight becomes

ωj = f j .
Definition 2: If we choose the weights of the weighted
normal vector in definition 1 to be the areas of triangles,
i.e. ω j = f j . the weighted normal vector becomes

¦f
¦f

Nv =

j

Nf

j

j

Nf

j

and it is called the area-weight normal vector.
From this, the area-weight gives a good estimation
of normal vectors when the polyhedron model comes
from the digitization (or subdivision) by a fixed time. On
the other hand, if time is not fixed, the area-weight will
cause some serious drawback due to the following
observation in (2):
Observation : In the formula of the area-weight normal
vector, if two triangles f i and f j have the same normal
vectors and equal areas, then they will have equal
contributions to the resulting normal vector N v . See
figure 2.
v

v

Figure 3: the problem of duality.

5. Conclusion
In this paper, we introduce some new methods to
improve the weighted normal vector. Now, let us give
some test about our methods and compare our methods
with old methods.
We compare the methods of area-weights, centroidweights and gravitational-weights and results of some
other weights from Max [4] and Chen-Wu [2] papers. In
figure 4, we compute the normal vector at each vertices n
different meshes which are derived from the unit sphere.
The x-axis is the number of triangles on each mesh and
the y-axis is the average of the error between the real
normal vectors and the normal vectors which are
estimated by weight methods. The error is computed by
~

the formula:

er ( N v ) = < N v , N v >
i

i

i

~

where N is the real normal vector at v i , N v is the
normal vector comes from the weight methods and
i

fi

fj

~

Figure 2: if

f i = f j , they have the same effects under area-weight.

For this, we try to improve the weighted normal
vector from the viewpoint of duality. Our problem is to
find a vertex to represent the triangle for each triangle.

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

er ( N v ) is the error of the weight normal vector N v .
Since every regular surface can be approximated by
the polynomial surfaces locally, we may try to estimate
the normal vectors at the random polynomial surfaces by
i

i

area-weight and gravitational-weight methods. We
consider polynomial surfaces as follows:
f ( u, v ) =

of the Fifth International Conference on Computer
vision, 1995, 902-907.

n

¦ ¦a

i, j

uiv j

k =2 i + j =k

where a i , j ∈ R is the random value. We also construct a
random neighbors { p j }mj=0

of some fixed vertex

f (u 0 , v 0 ) by
p j = f ( r j cos θ j + u 0 , r j sin θ j + v 0 ) ,

where r j ∈ [0,1] is random value and {θ 0 , θ 1 ," , θ m } is a
random partition of [0,2π ] .
In Figure5, we estimate the normal vector at a fixed
point f (u0 , v 0 ) on 10000 random surfaces for each total
degree n from 4 to 60. The x-axis is the degree of
polynomial surfaces and y-axis represents the total error
of the normal vectors of 10000 surfaces for each degree
n from 4 to 60. Obviously, the gravitational-weight
method is better and more stable than the area-weight
method when the degree n becomes more than 4.
If we want to delete the coplanarity points, we must
solve the key problem:
The coplanarity criterion:
Let v 0 , v1 , v 2 , v 3 be four points, T0 is the triangle
with vertices v 0 , v1 , v 2 and T1 is the triangle with vertices
v 0 , v 2 , v 3 . The unit normal vectors of T0 and T1 are n 0
and n1 , respectively. If those points are coplanarity, then
they satisfy
1 .0 − < n 0 , n 1 > < ε
where ε is the tolerance error.
In figure 7, we show some results with the areaweight and gravitational-weight after deleting the
coplanarity points (the revised area and revised
gravitational in figures). Obviously, if we delete the
coplanarity points, we will obtain a better result for
estimating the normal vectors.

Figure 4: The error of sphere.

Figure 5: Total error of polynomial surfaces

Acknowledgement
The authors are partially supported by Taiwan NSC
grants.

References
[1]

[2]

[3]
[4]

[5]

X. Chen and F. Schmitt, Intrinsic surface properties from
surface triangluation, In proceeding, European
Conference on Computer Version, 1992, 739-743.
S-G Chen and J-Y Wu, Estimating normal vectors and
curvatures by centroid weights, CAGD, vol 26, p447
458,2004.
M. Do Carmo, Differential Geometry of Curves and
Surfaces. Prontice Hall, 1996.
N. Max, Weights for computing vertex normals from
facet normals, the Journal of Graphics Tools, vol. 4, No.
2, 1999, 1-6.
G. Taubin, Estimating the tensor of curvature of a
surface from a polyedral approximation. In Proceedings

Figure 7: The error table of tori

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE


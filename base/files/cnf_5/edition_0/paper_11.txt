2012 Ninth International Conference on Computer Graphics, Imaging and Visualization

A Geometric Invariant Digital Image Watermarking Scheme Based on Robust
Feature Detector and Local Zernike Moments

Xiao-Chen Yuan, Chi-Man Pun
Department of Computer and Information Science
University of Macau, Macau SAR, China
{yb07417, cmpun}@umac.mo
of watermark embedding and extraction. Section 3 presents
the experimental results to demonstrate the robustness
performance of our proposed scheme. And finally the
conclusions are drawn.

Abstract—A robust and geometric invariant digital image
watermarking scheme based on robust feature points detector
and local Zernike transform is proposed in this paper. The
robust feature points detector is proposed based on SIFT
algorithm to extract circular patches. A local Zernike
moments-based watermarking scheme is raised. Each
extracted circular patch is decomposed into a collection of
binary patches and Zernike transform is applied to the
appointed binary patches. Experimental results show that the
proposed scheme is very robust against geometric distortions
and common signal processing.

II.

Keywords-Geometric Invariant; Robust Feature Points
Detector; Local Zernike Transform; SIFT

I.

INTRODUCTION

Nowadays, digital watermarking has emerged as a
potentially effective tool for multimedia copyright protection
and authentication. Quite a number of geometric invariant
algorithms have been proposed in the past years [1]. The
existing watermarking schemes robust against geometric
distortions can be divided into three categories: to embed the
watermark in the geometric invariant domain [2-4]; to embed
a template along with the watermark [5, 6]; and to embed the
watermark base on feature extraction [7-14].
Zernike moments have been shown to be superior to
other moments and they are employed for watermarking in
many literatures for its special invariance properties against
distortions [15]. In order to overcome the major problems of
computationally expensive and severe fidelity loss in the
existing approaches, the novel geometric invariant digital
image watermarking scheme based on feature extraction and
local Zernike moments is proposed. The Robust Feature
Points Detector (RFPD), is proposed based on Scale
Invariant Feature Transform (SIFT), to extract geometric
invariant feature points. The circular regions centered at the
extracted feature points are generated. Due to the cumulative
computational errors of Zernike transform, it is difficult to
reconstruct watermarked image/patch without visible quality
degradation directly using its inverse transform. Therefore,
the bit-plane decomposition based scheme is proposed where
each extracted circular patch is decomposed into a collection
of binary images; Zernike transform is applied to the selected
binary patches and the magnitudes of the local Zernike
moments are modified to embed the watermarks.
The details of the scheme will be addressed in the
following sections. Section 2 illustrates the detail procedure
978-0-7695-4778-7/12 $26.00 © 2012 IEEE
DOI 10.1109/CGIV.2012.17

WATERMARK EMBEDDING AND EXTRACTION

In our proposed watermarking scheme, firstly, the RFPD
is proposed for feature extraction. For RFPD, the host image
is trained with some common signal processing and
geometric attacks; SIFT algorithm is applied into the original
host images and the trained images, respectively, to extract
the original feature points and the trained feature points. The
feature points matching algorithm is then applied to these
two set of feature points to extract target feature points
according to their robustness, that is the distance ratio of the
nearest neighbor to the second-nearest neighbor in the SIFT
algorithm. Hence, the parameter distance ratio can be
adjusted to generate different number of required feature
points for image watermarking. The final value of the
distance ratio is obtained through experiments. The proposed
RFPD is proved to be robust against image attacks such as
rotation, scaling, affine transformation, cropping, JPEG
compression, median filtering and so on.
The flow chart of watermark embedding procedure is
shown in Fig. 1. Firstly, by applying the RFPD to the host
image, the feature points can be extracted, thus the circular
patches centering at the extracted feature points can be
generated for watermark embedding and extraction. Then
each extracted patch is decomposed into m binary circular
patches, respectively, with the bit-plane based method that
separate the m coefficients of the polynomial into m 1-bit
planes, I 0 , I1 , I 2 ,..., I m−1 , where the highest order bit plane
corresponds to the most significant bit. Some of the binary
patches are appointed for watermark data bits embedding.
For each appointed patch, the appointed binary circular
patch is translated to its centroid, and is scaled to a standard
size; afterwards, Zernike transform is applied into the scale
and translation normalized binary patch to calculate its
Zernike moments with the given order O. The magnitudes of
Zernike moments are proved to be so robust against RST
attacks that they are used as watermark embedder.
The watermark data sequence W of Gaussian distribution
can be generated with a predefined seed. This paper uses
spread spectrum communication techniques to embed the
watermark [16], the watermarking formula is defined in (1).
53

For watermark extraction, the SIFT algorithm is applied
to the watermarked image to generate a feature points
database. The descriptor D and the seed are decoded from
KEY, and the matching for D is found from the generated
feature points database; the matched features can be
extracted for watermark extraction. With the extracted
feature points, the circular patches are generated for
watermark extraction. Then each patch is decomposed into m
binary circular patches. The same specified binary patches as
the ones used as watermark embedder are appointed for
watermark extraction.
After that, each appointed binary circular patch is
translated to its centroid, and is scaled to a standard size;
Zernike transform is applied into it to calculate its Zernike
moments with the given order O, which is the same value as
the one used in watermark embedding procedure. The same
watermark data sequence W as the one used for watermark
embedding is generated with the given seed. For watermark
detection, the linear correlation [13] is used to detect the
existence of the watermark in the Zernike moments
magnitudes.

The generated watermark is repeatedly embedded into the
Zernike moments’ magnitudes using watermarking formula
(1).

Y = X + α ×W

(1)

Where X denotes the Zernike moments magnitudes
calculated from each selected binary patch; α is the
predefined parameter to control the watermark embedding
strength; and W presents the random watermark sequence of
Gaussian distribution. Y is the watermarked data.
After watermark being embedded, inverse Zernike
transform is applied to reconstruct the corresponding binary
patch from the watermarked Zernike moments. Then each
watermarked patches can be obtained by recomposing
process with (2). And finally, we can obtain the watermarked
image by replacing the original patches with the
watermarked patches.

I = I m −1 ⋅ 2m −1 + I m − 2 ⋅ 2 m− 2 + ... + I1 ⋅ 21 + I 0 ⋅ 20

(2)

C Linear =

Where I i denotes the corresponding decomposed bit
plane patch.

1
¦ w⋅ y
S

(3)

Where CLinear is the linear correlation, S is size of the
Zernike moments magnitudes, y is the watermarked data, and
w is the watermark data sequence generated by using the
same seed used in watermark embedding process.
The watermark is detected when the linear correlation
result is larger than a predefined threshold value.
III.

EXPERIMENTAL RESULTS

Many experiments are implemented to evaluate the
proposed watermarking scheme on the popular test images.
In the following experiments, the minimum number of
feature points N is set to be 8. The radius r of the circular
patches is set to be 40. For watermarking, each circular patch
is decomposed into 8 binary patches. Then Zernike transform
with its order O defined as 40 is applied to the appointed
scale and translation normalized binary patches to calculate
their Zernike moments, respectively. The watermark data
sequence is generated randomly under Gaussian distribution
and the watermark embedding strength α is set to be 100.
PSNR (Peal Signal-to-Noise Ratio) is used to evaluate the
distortion of the watermarked image; the larger PSNR value
means less distortion. By experiments, the fifth bit plane of
each selected patch is adaptable for watermarking, to ensure
the success of watermark extraction and to decrease
distortion of the image.
Fig. 2 shows the circular patches extracted with RFPD
from the test images and the corresponding watermarked
images; also the PSNR between the original test images and
their watermarked images are given: 39.10, 39.96, and
38.93dB for ‘Baboon’, ‘Lena’, and ‘Pepper’, respectively.

Y = X + α ×W

Figure 1. Flow Chart of Watermark Embedding Procedure

54

[3]

[4]

[5]

[6]

[7]
Figure 2. Features and Watermarked Images. (a1) ‘Baboon’ and its
extracted patches; (b1) Watermarked ‘Baboon’, PSNR = 39.10dB; (a2)’
Lena’ and its extracted patches; (b2) Watermarked ‘Lena’, PSNR =
39.96dB; (a3) ‘Pepper’ and its extracted patches; (b3) Watermarked
‘Pepper’, PSNR = 38.93dB.

[8]

Stirmark 4.0 [17] is used to evaluate the robustness of the
proposed scheme. Table 1 and 2 present the watermark
detection results of the proposed scheme in comparison with
four representative feature-based schemes proposed by Tang
and Hang [11], Seo and Yoo [12, 18], and Gao et al. [14],
under common signal processing and geometric distortions,
respectively; using the similar experimental settings
mentioned in [14]. For values in main table unites, the
numerator means the number of patches where watermarks
are successfully detected from attacked images, and the
denominator means the number of original watermarked
patches. The results show that the proposed scheme
outperforms the existing schemes under both common signal
processing and geometric diatortions.

[9]

[10]

[11]

[12]

[13]

IV.

CONCLUSIONS

In this paper, the digital image watermarking scheme
based on robust feature detector and using local Zernike
transform is proposed. The RFPD is proposed for local
region extraction; Zernike transform is applied to each
appointed binary patches to calculate their Zernike moments
for watermarking use. The proposed scheme can survive
both geometric distortions and common signal processing.
The comparison results show the proposed scheme
outperforms the several representative feature extraction
based schemes in terms of robustness to various attacks.

[14]

[15]

[16]
[17]

REFERENCES
[1]

[2]

[18]

D. Zheng, et al., "A survey of RST invariant image
watermarking algorithms," ACM Comput. Surv., vol. 39,
p. 5, 2007.
J. O'Ruanaidh and T. Pun, "Rotation, scale, and
translation invariant digital image watermarking," Signal
Process, vol. 66, pp. 303-317, 1998.

55

C. Y. Lin, et al., "Rotation, scale, and translation
resilient watermarking for images," Image Processing,
IEEE Transactions on, vol. 10, pp. 767-782, 2001.
D. Zheng, et al., "RST-invariant digital image
watermarking based on log-polar mapping and phase
correlation," Circuits and Systems for Video Technology,
IEEE Transactions on, vol. 13, pp. 753-765, 2003.
P.Bas, et al., "Robust watermarking based on the
warping of pre-defined triangular patterns," Proc. SPIE
Security and Watermarking of Multimedia Contents vol.
3971, pp. 99-109, 2000.
X. Kang, et al., "A DWT-DFT composite watermarking
scheme robust to both affine transform and JPEG
compression," Circuits and Systems for Video
Technology, IEEE Transactions on, vol. 13, pp. 776-786,
2003.
X. Wang, et al., "Geometrically invariant color image
watermarking scheme using feature points," Science in
China Series F: Information Sciences, vol. 52, pp. 16051616, 2009.
J. Filipe, et al., "Geometric Distortion Resilient
Watermarking Based on a Single Robust Feature for Still
Images," in e-Business and Telecommunications. vol. 48,
ed: Springer Berlin Heidelberg, 2009, pp. 345-357.
H. Y. Lee, et al., "Evaluation of feature extraction
techniques for robust watermarking.," in The 4th
International Workshop on Digital Watermarking, Siena,
Italy, 2005, pp. Springer 2005: 418–431.
P. Bas, et al., "Geometrically invariant watermarking
using feature points," Image Processing, IEEE
Transactions on, vol. 11, pp. 1014-1028, 2002.
C.-W. Tang and H.-M. Hang, "A feature-based robust
digital image watermarking scheme," Signal Processing,
IEEE Transactions on, vol. 51, pp. 950-959, 2003.
J. S. Seo and C. D. Yoo, "Image watermarking based on
invariant regions of scale-space representation," Signal
Processing, IEEE Transactions on, vol. 54, pp. 15371549, 2006.
D. Zheng, et al., "RST Invariant Image Watermarking
Algorithm With Mathematical Modeling and Analysis of
the Watermarking Processes," Image Processing, IEEE
Transactions on, vol. 18, pp. 1055-1068, 2009.
X. B. Gao, et al., "Geometric Distortion Insensitive
Image Watermarking in Affine Covariant Regions,"
Systems, Man, and Cybernetics, Part C: Applications
and Reviews, IEEE Transactions on, vol. 40, pp. 278286, 2010.
Y. Xin, et al., "A multibit geometrically robust image
watermark based on Zernike moments," in Pattern
Recognition, 2004. ICPR 2004. Proceedings of the 17th
International Conference on, 2004, pp. 861-864 Vol.4.
I. Cox, et al., Digital watermarking. Morgan-Kaufmann,
San Francisco, CA, 2002.
F. A. P. Petitcolas, "Watermarking schemes evaluation,"
IEEE Signal Process. Mag., vol. 17, pp. 58-64, 2000.
J.S.Seo and C. D. Yoo, "Localized image watermarking
based on feature points of scale-space representation,"
Pattern Recogn., vol. 37, pp. 1365-1375, 2004.

TABLE. 1 WATERMARK DETECTION RESULTS UNDER COMMON SIGNAL PROCESSING
Attacks
MedFilte_3x3
GauFilte_3x3
JPEG 90
JPEG 70
Median 3 x 3 +
JPEG 90
Gaussian 3 x 3 +
JPEG 90

9/10
9/10
9/10
8/10

2010
[14]
6/15
4/15
8/15
8/15

Baboon
2006
[12]
0/13
1/13
3/13
2/13

2003
[11]
2/11
7/11
9/11
8/11

9/10

5/15

0/13

9/10

4/15

1/13

Ours

8/9
8/9
8/9
8/9

2010
[14]
6/10
5/10
6/10
4/10

Lena
2006
[12]
2/11
1/11
3/11
3/11

1/11

8/9

3/10

7/11

8/9

4/10

Ours

9/10
9/10
10/10
10/10

2010
[14]
17/23
9/23
16/23
14/23

Pepper
2006
[12]
2/13
2/13
4/13
2/13

1/8

9/10

16/23

2/13

1/4

3/8

9/10

5/23

2/13

1/4

2003
[11]
1/8
3/8
6/8
5/8

2/11
1/11

Ours

2003
[11]
1/4
1/4
3/4
3/4

TABLE. 2 WATERMARK DETECTION RESULTS UNDER GEOMETRIC DISTORTION
Attacks
Crop_10%off
Scaling (1.5)
Rotation 5
Shearing (1%)
Rem 5_rows_
17cols
Crop(10%
off)+JPEG 70
Rot_5+Crop+JPE
G_70
Remove
5_rows_17cols +
JPEG 70

8/10
8/10
9/10
7/10

2010
[14]
6/15
7/15
5/15
6/15

Baboon
2006
[12]
1/13
3/13
0/13
0/13

2003
[11]
1/11
0/11
2/11
4/11

6/10

6/15

2/13

8/10

6/15

7/10
6/10

Ours

8/9
8/9
8/9
9/9

2010
[14]
5/ 10
6/10
4/10
4/10

Lena
2006
[12]
4/11
3/11
3/11
2/11

2/11

5/9

5/10

3/11

0/13

1/11

8/9

5/10

5/15

0/13

0/11

7/9

6/15

1/13

2/11

5/9

Ours

56

9/10
9/10
9/10
8/10

2010
[14]
6/23
13/23
9/23
7/23

Pepper
2006
[12]
1/13
4/13
2/13
0/13

1/8

6/10

11/23

0/13

0/4

2/11

1/8

9/10

6/23

0/13

2/4

5/10

2/11

0/8

9/10

7/23

0/13

0/4

4/10

1/11

0/8

6/10

7/23

0/13

0/4

2003
[11]
2/8
0/8
2/8
2/8

Ours

2003
[11]
2/4
0/4
0/4
1/4


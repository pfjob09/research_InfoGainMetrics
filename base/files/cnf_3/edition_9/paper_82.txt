Visualising Pathophysiological Simulation with a Virtual Patient
Marc Cavazza
School of
Computing and Mathematics, University of
Teesside, UK, m.o.cavazza@tees.ac.uk

Altion Simo
Virtual Systems Laboratory, University of Gifu,
JAPAN, al@vsl.gifu- u.ac.jp

Abstract
In this paper, we present a new approach to computeraided training in Medicine based on the visualisation of
simulated clinical conditions using a virtual patient. Our
system uses a knowledge-based model of cardiac
physiology to generate realistic emergency situations
(shock states). The overall results of the simulations are
presented through a realistic 3D virtual patient whose
behaviour and appearance are consistent with the clinical
data generated. After introducing the principles behind the
simulation and the system’s architecture, we describe the
process through which physiological parameters are
mapped to the visual appearance of the 3D patient and
discuss representative results from the system.

1. Introduction
An important application of visualisation techniques in
Medicine has been the development of virtual patients or
3D human models. Apart from the reconstruction of
medical imaging data, computer graphics models of virtual
patients have been developed for surgery simulation and
training in virtual reality. These systems are based mainly
on anatomical representations and physical simulations of
the organs as they undergo surgery. However, virtual
patients could also be used to simulate clinical medicine:
in this case, the external appearance of the patient would
be used to simulate the symptoms of various diseases for
tutoring applications. These systems, rather than relying
on anatomical models would be based on physiological
models, which describe the behaviour of organ systems.
The main objective of the visualisation of clinical
situations through a virtual patient is thus to elicit an
appropriate diagnostic and therapeutic process in the
trainee.
There has been little work on 3D virtual patients
outside virtual surgery, apart from that of Badler et al. [2]
(see also Webber et al., [5]), who have developed

autonomous virtual human to simulate battlefield
casualties in military simulations. Their virtual human
displays symptoms corresponding to the injuries suffered
on the battlefield, while the trainee medic controlled by
the user would attempt emergency treatment. However,
this application still belongs to surgical emergencies
(trauma) rather than clinical medicine.
In this paper, we describe the development of a virtual
patient in a specific area of emergency medicine (shock
states). The generation of clinical syndromes is based on a
pathophysiological simulation of the cardio-vascular
system using an Artificial Intelligence technique derived
from qualitative process theory [6] (which will be
described in section 4) From this model, it is possible to
visualise clinical signs as well as the overall behaviour of
the patient.
In the next sections, after introducing the medical
application for our system, we discuss the requirements of
visualisation in the clinical context; we describe the
qualitative simulation engine embedding the medical
knowledge. We show how its output can be mapped to
visual cues to produce the patient’s appearance in real time.
Finally, we describe example results obtained from the
system.

1.1 The medical application
Our system is applied to the simulation of cardiac
emergencies, more specifically shock states. It presents
itself as a 3D environment featuring a virtual patient
whose appearance reflects the nature of the clinical
condition being simulated. In addition, clinical parameters
such as heart rate and arterial pressure can be monitored.
This form of simulation is made possible by the
availability of knowledge on the behaviour of the cardiac
system in various pathological states. It is possible to
reason on the cardio-vascular system from a “mechanistic”
point of view; for instance, seeing the heart as a pump, if
its performance decreases, pressure after the pump (the
arterial pressure) will decrease, while pressure before the

Proceedings of the Seventh International Conference on Information Visualization (IV’03)
1093-9547/03 $17.00 © 2003 IEEE

pump will accumulate (in the case, the heart’s filling
pressure). An accurate modelling is obviously more
complex and involves many physiological parameters, yet
the underlying principles remain the same. The relevant
physiological parameters will be progressively introduced
in the course of the paper as we describe the system’s
mechanisms into more details. As a tutoring system, it
generates various clinical syndromes using a qualitative
simulation of the cardio-vascular system.
The system is able to simulate complex medical
conditions by propagating the consequences of a primitive
alteration using a model of the cardio-vascular system. For
instance, the consequences of a primary dysfunction of the
heart (i.e., decreasing its ability to pump out blood in the
arterial system) over the whole circulation can be
simulated, leading to a low arterial pressure, perturnation
of peripheral circulation, etc. The trainee has to establish a
diagnosis by observing the patient and monitoring vital
signs and clinical parameters, after which s/he can decide
on a treatment to be administered. The same cardiac
simulation engine then calculates the consequences of
treatment, which are reflected in changes in the patient’s
appearance and vital signs.

i)

ii)

iii)

Those accessible to clinical measurement (i.e.,
standard examination, like heart rate and arterial
pressure). The simulation will give direct access to
these parameters by mapping the simulation’s
variables to pre-set range values for HR and MAP.
Other elements of visualisation include EKG
curves and pressure curves.
Those accessible to specific exploration taking
place in the intensive care unit, such as Cardiac
Output (CO) or Systemic Vascular Resistance
(SVR), which require cardiac catheterisation.
Internal parameters obtained from research in
physiology (in laboratory conditions on animal
models) but not accessible in routine clinical
practice (e.g., ventricular relaxation). The latter
cannot be visualised during simulations but can
take part in an explanatory process of the integrated
events in the cardiac cycle (which rather constitutes
a virtual “post-mortem”).

2. Visualisation requirements for the virtual
patient
Producing a believable virtual patient (Figure 1)
requires that relevant symptomatology be reproduced by
the system. Various levels of symptoms are commonly
distinguished in clinical practice: functional signs,
inspection signs, and clinical signs.
Functional signs are related to the patients’ behaviour
and can be simulated using appropriate animations (e.g.,
for shortness of breath).
Inspection signs are symptoms directly visible on the
patients, such as sweat, oedema, cyanosis, pallor, rashes,
etc. These can be simulated using various forms of
dynamic textures on the basis of the patient’s state as
obtained by the pathophysiological simulation. The trainee
will have to actively observe the patient to see such signs,
which can be used for diagnosis as well as assessing the
gravity of the situation. Clinical signs are accessible
through physical examination only, such as auscultation,
palpation of the liver, etc. They would have to be
implemented as animations producing an audible or visible
result: these have not been implemented in the current
prototype, which instead focussed on information provided
by monitoring devices.
In the case of Emergency Medicine and critical care,
monitoring devices visualise in real-time vital
physiological parameters, such as Heart Rate (HR) and
Mean Arterial Pressure (MAP). Physiological parameters
that can be classified in three categories:

Figure 1. Overview of the virtual patient.

3. System overview and architecture
The system’s main objective is to integrate real-time
animations of the patient’s character with a cardiac
simulation system. When using the term virtual patient in
this paper, we will refer to the integrated model.
The system (Figure 2) is developed using a state-of-theart 3D game engine, Unreal Tournament™, as a
visualisation engine. Game engines are increasingly used
in visualisation research not only for their graphic
performances but also because they integrate advanced
features for interaction and animation, in particular for the
animation of human characters [8]. In particular the UT
engine supports high quality graphics, as well as the
animation of virtual characters, and specific features such
as dynamic textures, all used for the virtual patient’s
appearance. Besides, it includes an excellent development

Proceedings of the Seventh International Conference on Information Visualization (IV’03)
1093-9547/03 $17.00 © 2003 IEEE

environment that supports the authoring of animations for
virtual humans behaviour, as well as various mechanisms
(dynamic link libraries and socket-based inter-process
communication) for integrating external software, such as
the cardiac simulation module we developed. Our software
architecture is based on UDP socket communication
between the 3D graphics engine and the cardiac simulation
module, which has been developed in Allegro Common
Lisp™. UDP messages transmit the resulting value of
cardiac parameters from the simulation to the visualisation
engine so that the patient’s appearance will reflect its
clinical condition. More details on the mapping process
are given in section 5.
In the next section, we describe the qualitative
simulation module used to implement the patient’s
physiological model. In particular, we show its potential
for providing an integrated solution, which plays a major
role when integrating the behavioural engine within a
graphical and interactive simulation.

encoded explicitly as rules 10]. These models can also be
used to simulate the behaviour of a physiological system
[9] [11] [3] [7]. To simulate a pathological process, a
primitive variable is altered (e.g. cardiac contractility),
these changes propagating through the whole system to
provide an accurate and realistic description of its state
under pathological conditions. The variables used in this
context are “orders of magnitude” variables also referred
to as qualitative variables (e.g., very low, low, normal,
high, and very high). This is also in agreement with the
presentation of pathophysiology in most textbooks, which
is based on such variables, represented as “+” or “•”.
Our first application is cardiac emergencies, namely
shock states, for which pathophysiological descriptions are
readily available [1].

Figure 3. Pseudo code for Qualitative Process,
showing the Qualitative Process relations.

4.2 Qualitative Simulation of the Cardio-vascular
System

Figure 2. System architecture.
4. Physiological simulation techniques

4.1 Pathophysiological knowledge in cardiology
A pathophysiological model is a model explaining the
dynamics of a disease on the basis of the normal behaviour
of an organ (e.g., heart, liver, etc.) or a physiological
system (e.g. endocrine system, hematopoeitic system, etc.)
affected by that disease. It explicitly represents the
dysfunction of the normal system behaviour and is a
common way to explain the causes and consequences of
diseases in medical textbooks and literature [1].
Pathophysiological models have been extensively used in
medical knowledge-based systems as “deep knowledge”,
i.e. representations from which clinical situations could be
generated from first principles rather than having to be

The medical knowledge we just described can be
embedded into an Artificial Intelligence (AI) software,
which would simulate the behaviour of the cardio-vascular
system by reasoning on the variations of physiological
variables. The AI technique used is based on qualitative
process theory [6] adapted to the specificity of
physiological processes. It is centred on the notion of
process, which corresponds to an elementary physiological
mechanism (e.g., ventricular filling). Processes are
associated qualitative variables (e.g., End Diastolic
Volume, which reflects how the heart fills prior to
contraction) related to each other via influence equations
which determine causal links between variables and are
used to propagate the consequences of a change in
variables’ values on other variables in the same process.
An influence equation such as I+(Inotropism, SV),
expresses that inotropism (i.e., the intensity of cardiac
contraction) causes Stroke Volume (SV, the volume of
blood pumped by the heart at each contraction) to increase.

Proceedings of the Seventh International Conference on Information Visualization (IV’03)
1093-9547/03 $17.00 © 2003 IEEE

A Process representation based on influence equations
is represented on Figure 3. In this way, the primitive
alteration of some qualitative variables (that defines the
underlying pathology) is propagated through the whole
system. The simulation is organised around four macroprocesses corresponding to ventricular filling, ventricular
ejection, arterial system behaviour and venous system
behaviour (Figure 4). These processes naturally model the
circulatory system, thus introducing an element of
structure/function relationship. During a simulation, the
four processes are activated in turn, thus reproducing the
cardiac cycle. Various cycles of simulation are performed
until all qualitative variables reach a steady value. Each
macro-process encapsulates lower-level processes
corresponding to elementary physiological phenomena,
described by physiological laws (there are 25 such
processes) [4]. For instance, Frank-Starling’s law
describes the relation between ventricular ejection and
“pre-load” (the level of ventricular filling prior to
contraction), this relation depending on cardiac
contractility (inotropism) as well.
When a process is activated in the simulation, its
variables are checked for any instant variation as a result
of previous processes. Only influence equations involving
modified variables will be triggered. For instance,
processes related to ejection are only invoked if their input
variables, such as, e.g., End-Diastolic Volume or
inotropism are altered. This simple data-driven mechanism
governs the updating of variables in the simulation.

Ejection

Filling
Stroke Volume

P
ESP

EDP
ESV

EDV

V

End-diastolic volume

P

variable, which represents the amount of blood expelled
by the ventricle during a cardiac cycle, from which cardiac
output and mean arterial pressure can be computed in the
arterial system.
The patient’s state at each simulation cycle is
represented by the set of all qualitative variables (Figure 4).
The visualisation process consists in using the state
variables in the pathophysiological model: we describe the
mapping process in the next section.
5. Mapping and visualisation
The simplest form of visualisation consists in
outputting the value of physiological parameters to
monitoring devices. The main variables used are MAP and
HR, which are computed as part of the Arterial System
macro-process.
Patient behaviour comprises functional signs such as
the level of consciousness and spontaneous movements,
pain and breathing patterns, etc. Mapping the results of the
cardiac simulation to these signs involves simple inference
from parameter values to the patient reaction. For instance,
as cardiac output decreases so does cerebral perfusion: low
CO values can thus be mapped to patient consciousness in
the form of changing animations. Very high ventricular
filling pressures result in elevated pulmonary capillary
pressure, which can trigger cardiac oedema, manifesting
itself in the patient through altered breathing patterns.
Functional signs are thus essentially related to patient
animations, such as:
• Head nodding in expression of pain or discomfort.
• Hands moving in expression of discomfort
• Antalgic positions (e.g. abdominal pain)
Spontaneous movements and changes in position
• Breathing rhythm and amplitude

ESP

EDP
ESV

EDV

V

MAP=COuSVR

Venous

Arterial

Figure 4. Mapping the physiological parameters
for the simulation to the patient’s appearance.

The effect of a process invocation is to update its
variables, which still serve as an input to the next (set of)
processes. For instance, the processes encapsulated in the
ejection macro-process all update the Stroke Volume (SV)

Perhaps the most significant aspect of visualisation, as
far as diagnosis is concerned, is that of physical signs. The
physical signs of shock are well described, and even
though many of them are not specific they are important in
this context to assess the overall gravity. Several examples
of clinical signs (virtual patient’s skin tones mapped as
dynamic texture) are represented on Figure 5. During
cardiac failure, ventricular filling pressure increases and
under certain circumstances (right ventricle failure, fluid
infusion on a failing heart), central venous pressure
increases. Central Venous Pressure can be mapped to a
visual sign in the form of an enlargement of jugular veins,
displayed via a dynamic texture pattern supported by the
Unreal™ visualisation engine.

Proceedings of the Seventh International Conference on Information Visualization (IV’03)
1093-9547/03 $17.00 © 2003 IEEE

(a)

(b)

(c)

(d)

Figure 5. Clinical signs: (a) pallor, (b) rashes on
the skin, (c) warm shock (d) normal.
Skin tones depend on peripheral perfusion. Hence,
vasodilation (decreased SVR) is accompanied by redness,
while vasoconstriction results in intense pallor. The value
of the SVR parameter is thus mapped to dynamic textures
shifting between various skin appearances. Additional skin
tones are implemented using commercial image
processing packages in order they help the diagnosis of
certain shock syndromes when they occur. For instance, in
the case anaphylactic shock, the patient could have rashes
while in the case of a toxic shock he could have various
rashes or purpura in the form of few red patches formed by
enlarged vessels, on the legs.

The primitive decrease in Inotropism causes a decrease
in SV of the same order of magnitude: a “--“ value for
Inotropism would lead to a similar value for SV.
The next process consists in the arterial system: this is
where parameters such as CO and MAP are computed, by
using the corresponding physiological equations. This
leads to qualitative values of “---“ for CO and MAP. In the
first simulation cycle, the baseline HR and SVR values are
used.
Mechanisms for the short-term regulation of arterial
pressure (such as baroreceptors and chemoreceptors) are
represented as sub-processes of the Arterial System. Here
the baroreceptor process reacts to a fall of MAP to trigger
an increase in HR, SVR and Venous Tone (VT). The next
process is the Venous System, which includes several
processes including venous return. The most important
influence here is that increased VT increases ventricular
venous return. The last process of the cycle is cardiac
filling. This is simplified in our model, which is mostly a
Left Ventricle model, where the role of the right ventricle
is a coarser model (not modelling specifically right
ventricle contraction and pulmonary circulation). In this
process, ventricular filling is increased by increased
venous return: I+(VT, preload).

6. An integrated example
The following integrated example will illustrate several
aspects of the dynamic visualisation of a patient’s
condition. This example is a simulation of cardiogenic
shock. Cardiogenic shock can be simulated by primitively
decreasing the value of the inotropism parameter, which
corresponds to the quality of cardiac contraction. The
system works by simulating events through the cardiac
cycle, the various physiological processes being ordered
according to this cycle. Several simulation cycles are
taking place until the qualitative values reach a steadystate. The first event simulated is cardiac contraction. The
main output variable for this process is the Stroke Volume
(SV; the amount of blood ejected by the heart at each
contraction), from which it is possible to compute cardiac
output and mean arterial pressure. Three sub-processes are
active for the three main determinants of cardiac
contraction. These incorporate influence equations that can
be expressed in the classical framework of Qualitative
Process Theory: I+(Pre-load, SV), I+(Inotropism, SV), I(Afterload, SV).

Figure 6. Patient appearance in the 3D interface.
The second cycle of simulation activates again the
cardiac contraction process under the new conditions that
result from short-term adaptive mechanisms. The increase
in preload fails in improving the stroke volume I+(preload,
SV), as this process depends on the levels of inotropism,
which is primitively decreased. Hence the qualitative
value of SV remains low “---“. Then the Arterial System
process is triggered again, and the calculations take into
account the updated HR and SVR values (as modified by
the compensatory mechanisms).

Proceedings of the Seventh International Conference on Information Visualization (IV’03)
1093-9547/03 $17.00 © 2003 IEEE

The increase in SVR fails to restore MAP for severe
alterations of inotropism, just like the increase in HR fails
to restore CO. The system reaches a new equilibrium at
the end of the simulation, with a significant drop in mean
arterial pressure and high cardiac frequency. Figure 6
shows several specific patient appearances for the shock
state before and after the treatment in the current 3D
interface.
The trainee is prompted for a treatment and on the basis
of decreased arterial pressure, starts with fluid expansion
(inappropriate and harmful in this context). The system
starts a new cycle of simulation following the increase of
filling pressure will be translated as an enlargement of
jugular veins (Figure 7). Also, because this is likely to
trigger pulmonary oedema, the breathing animations will
be modified to follow a pattern of faster, superficial
breathing, reflecting the dyspnoea accompanying
pulmonary oedema.

usability, as it is currently being extended to handle
multiple organ systems.

8. References
[1] Baan, J. Arntzenius, A.C., Yellin E.L. (Eds.) Cardiac
Dynamics. Martinus Nijhoff, The Hague, 1980.
[2] Badler, N.Webber, B.Clarke, J., Chi, D., Hollick, M., Foster,
N., Kokkevis, E., Ogunyemi, O., Metaxas, D., Kaye, J. and
Bindiganavale, R. MediSim: Simulated medical corpsmen and
casualties for medical forces planning and training, National
Forum on Military Telemedicine, IEEE, 1996, pp. 21-28
[3] Bylander T., Smith J.W. and Svirbley J.R., Qualitative
Representation of Behaviour in the Medical Domain. Computers
and Biomedical Research, 21, pp. 367-380, 1988.
[4] Cavazza, M.,Simo, A. A Virtual Patient Based on Qualitative
Simulation. ACM Intelligent User Interfaces 2002, Miami, USA.
[5] Chi, D., Kokkevis, E., Ogunyemi, O., Bindiganavale, R.,
Hollick, M. Clarke, J., Webber, B., and Badler, N.. Simulated
casualties and medics for emergency training, In K.S. Morgan,
H.M. Hoffman, D. Stredney, and S.J. Weghorst (eds.), Medicine
Meets Virtual Reality, IOS Press, Amsterdam, 1997, pp. 486-494.
[6] Forbus, K.D. Qualitative Process Theory. Artificial
Intelligence, 24, 1-3, pp. 85-168, 1984.
[7] Kuipers, B. Qualitative Simulation in Medical Physiology: A
Progress Report. Technical Report, MIT/LCS/TM-280, 1985.
[8] Lewis, M., Jacobson, J., Communications of the ACM, 45, 1,
January 2002. Special issue on Games Engines in Scientific
Research.
[9] Long W.J., Naimi, S., Criscitiello, M.G., Pauker, S.G.,
Kurzrok, S. and Szolovits, P. Reasoning about therapy from a
physiological model, in Proceedings of MEDINFO'86
(Washington DC).
[10] Sticklen J. and Chandrasekaran B., Integrating
Classification-based Compiled Level Reasoning with Functionbased Deep Level Reasoning, Applied artificial Intelligence, 3,
2-3, pp. 275-304, 1989.
[11] Widman, L.E. Expert System Reasoning About Dynamic
Systems by Semi-quantitative Simulation. Computer Methods
and programs in Biomedicine, 29, pp. 95-113.

Figure 7. Enlarged jugular veins.
7. Conclusions
We have described the implementation of a virtual
patient that is used to visualise the results of
pathophysiological simulations in terms of realistic
clinical signs. This form of visualisation is meant to be
synthetic and to give the trainee a more active role in the
diagnosis process, which is one important direction for
computer-aided training in Medicine. In addition, using a
realistic ER setting and an embodied agent as an interface
recreates part of the emotional tension that is part of the
real-world ER activity. At this stage the system has been
validated (by checking results produced in different
contexts for plausibility) but not formally evaluated for

Proceedings of the Seventh International Conference on Information Visualization (IV’03)
1093-9547/03 $17.00 © 2003 IEEE


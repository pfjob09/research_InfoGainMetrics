Fast Smoothing of Superficial Respiratory Artifacts on Medical Surfaces
Grigorios Karangelis1, Evelyn Firle1, Nikolaos Zamboglou2, Georgios Sakas1, Ulrich Borman3
1

Fraunhofer Institute for Computer Graphics, Fraunhoferstrasse 5, 64283 Darmstadt, Germany
2
Strahlenklinik Offenbach, Starkenburgring 66, 63069 Offebach am Main, Germany
3
Medintec GmbH, Feldstrasse 26a, 44867 Bochum, Germany
e-mail: gka@medintec.com
Keywords: Respiratory Artifacts, Medical Imaging and Radiation Therapy

Abstract
Respiratory artifacts appear very often in medical
volumes when the subject under examination is in
free respiration conditions. Such artifacts cause a
severe deformation to the external body anatomy
and are visible and enhanced during the 3D reconstruction of the patient surface. In this paper a
dedicated approach is presented for suppressing the respiratory artifacts on planar body contours. The proposed technique leads to an efficient
mechanism, which enables the qualitative and
quantitative improvement of the respiratory
waves on the final reconstructed mesh while preventing the original anatomical features of the
body. We show examples and statistical measurements, which demonstrate the effectiveness and robustness of our approach for different CT cases.

1. Introduction
During CT data acquisition the normal breathing
process, internal organ movements, and patient
global movements might introduce motion artifacts
in the acquired raw data. This motion may be in
three dimensions and generally result in artifacts
that appear in the image as streaks or distorted
semi-transparent structures in the general vicinity of
the motion. Using conventional techniques for data
acquisition the diagnostic information are significantly reduced due to the motion blurring. Therefore in diagnostic imaging examinations that include the chest or the upper abdomen, the patient
must also hold their breath, and it may be necessary
for multi-slice studies to be acquired in several single-breath-hold sections. In contrast to diagnostic

imaging motion artifacts in CT images have a completely different impact and appreciation for the external radiation therapy process (RTP) [9]. During
tumour irradiation the patient might be immobilized
but the breathing process continues normally and
freely. An irradiation fraction lasts more than one
minute and therefore is it not possible for the patient to contol respiration. Hence the patient data
acquisition for RTP must be also done under normal patient respiration conditions.
The focus of this work reflects on the surface
movements of the patient. Principally the surface of
the patient can be visualized in 3D using volumetric
[4] or polygon based techniques [3]. Usually the
polygon-based techniques are prefared since calculations and data communication of the body geometry can be achieved only means of 3D coordinates
of the object primitives. An important aspect during
RTP is the calculation of the source-to-skindistance (SSD). This parameter serves several purposes and the most important among them are:
a.

Beam iso-center placement during geometric
planning of the treatment and patient set-up
verification prior to treatment.

b.

During dose calculation most commercial dose
algorithms consider the body surface as the
borders for starting the attenuation of the dose
distribution on the target volume as well as on
the organs at risk. Different anatomy of the
body surface will result in variation of the dose
distribution.
Hence it is common understanding in radiotherapy, that inaccuracies on patient‚Äôs body planar contours will lead to inaccurate calculations and analysis related to the patient‚Äôs body surface. In Fig. 1

Proceedings of the Seventh International Conference on Information Visualization (IV‚Äô03)
1093-9547/03 $17.00 ¬© 2003 IEEE

Figure 1. A 2D sagittal view of CT data illustrating the iso-center placement of the beam on the
crest of the surface wave.
the sagittal view with the 2D beam overlay shows
that considering the current volume information the
iso-center of the treatment beam would be placed
on the pick of the wave, which is of course inaccurate. In addition one can observe that the number of
peaks represent the frequency of the respiration
process. At this point we have to clarify that the
collected digital images do not necessary describe
the complete respiration process at every time moment. Some information might be neglected and
some will appear as blurring artifacts due to low
rate data acquisition.

2. Motivation
To our knowledge this is the only report trying
to deal with the reduction of breathing artifacts on
the patient‚Äôs surface in RTP. Our method is motivated from previous reports appeared in computer
graphics community where polygonal meshes are
widely used into industrial applications like digitisation. Digitisation is a very common approach
used to acquire the surface shape of complex geometric models. The 3D scanner technology enables
us to capture detailed and dense clouds of points of
objects surfaces. These samples are then organised
into a triangular mesh for further development.
However the original reconstructed models are usually contaminated with noise, and therefore mesh
processing algorithms, such as mesh filtering, editing and mesh simplification are usually necessary
for further refining of the reconstructed model. Related work to this issue can be found in [5], [6], [7],
[8].

In this work an approach is presented, which is
able to minimise or in some cases to eliminate the
motion artifacts caused on the patient‚Äôs body surface. In the current method we consider as key step
the extraction of the planar contours from the original CT data in a specific manner, following the motion of the breathing process as this is captured on
the axial CT images. Section 3 presents aspects related to the definition of the adequate number of
sampling points that will compose the planar contour and will remain constant during the sampling
process for every slice, as well as the location of the
sampling points in terms of angular distance. The
sampled points that compose the acquired contours
will be filtered based on their angular value. This
converts actually the mesh-fairing problem into one
dimensional signal smoothing as presented in section 4. Finally section 5 presents statistical and visual results of our approach.

3. Generation of Body Surface
The human breathing process is a complicate
one and involves the combinatory work of several
internal organs. Crawfort et al. [2] proposed a parametric model of the breathing process based on
cross sectional images. Assuming that the acquired
cross section image was with supine patient orientation, with the patient‚Äôs back resting on the scanner‚Äôs
table, one can notice that breathing causes a timevarying magnification of factors Mg(x) and Mg(y)
of the image in both image directions x, y respectively.
Richies et al [1] in order to create simulated
respiratory motion data used a radial based warping
function. The warping function consisted of angularity spatially and temporally varying magnification about a point at the posterior edge of the test
object. Of course the above models are simplified
since the physical breathing process involves also
translation in the longitudinal direction, which is
difficult to predict and correct based only on cross
section images.
We also consider that the angular based magnification model represents effectively the respiratory
process in cross section images. In order to support
this statement we consider an experiential comparison 15 CT volumes that belong to different subjects. Among the 15 CT volumes of the abdominal
and chest region all of them showed that the outer
body contours deforms similar to those illustrated in
Fig. 2. Both illustrated contours are extract from the
original CT image on the same slice level and indi-

Proceedings of the Seventh International Conference on Information Visualization (IV‚Äô03)
1093-9547/03 $17.00 ¬© 2003 IEEE

cate the outer body contour in two different time
moments. Although the presented approach involves the correction of the motion artifacts between different slice levels the principle that will be
used is similar. The magnification vector between
the point P(x, y, z) and P¬¥(x¬¥,y¬¥, z) could be easily
calculated from the difference between the two
points. As shown in Eq. 1 the new coordinates of
the point P¬¥ can be easily extracted by:

xc
yc

x  dx
y  dy

Eq. 1

Figure 2. Axial body contour deformation during
respiration.

where dx, dy are the translation values that might be
positive or negative. The point Po(xo, yo, zi) represents the geometric center of the CT volume bounding box.
Aim of this work is to estimate and recover each
contour deformation caused from the respiration
process, in relation to the neighbour cross section
images. By applying our method the magnification
and shrinking vectors of the above model can be
calculated automatically on each contour considering the neighbour contour deformation.

3.1. Generation of Body Planar Contours
At this point we need a few definitions. With X
we will represent the polyhedral surface, piD a vertex of the surface at i slice level and D angle. In our
polygonal surface we could have two types of
neighbours of a vertex piD. When the vertex is located at the same slice level and has different angular location then is indicated as piD. When the vertex
belongs to the same angular location but in different
slice level then is indicated as pjD. The edge connecting piD to pjD is represented as gijD. A discrete
array (signal) of the polygonal surface at the angular location D is a function of SDi={piD , i ¬è L and
a ¬è A}, where L the total number of cross sections
and A the total number of angular positions. The
proposed methods can automatically extract from
the original CT data volume the body planar contours. However the generation of the contours require two special conditions:
a)

Every detected contour at each slice level must
be composed from the same number of points
(this parameter corresponds to the number of
angular values A).

b) Every contour point at slice level i must be collected with the same angular value from the
point Po, in relation to its neighbour points in

Figure 3. Example of radial sampling on a 2D CT
cross-section.
slices levels phD, pjD, where {h=i-1} and,
{j=i+1}.
The main reason for adapting this approach is
the 2D inspiration model described in the previous
section. The sampling points that will compose the
final contour must be collected at specific angularity in relation to the central axis of the CT volumebounding box. This is necessary in order to filter
the composed one-dimensional arrays from the sequence of points based on their angular position.
The amount of angular positions that will be used
for detecting the body boundaries, are equal with
the number of points that will compose each planar
contour. This sampling rate has no specific value
and depends upon the user selection. High geometric complexity of the surface geometry will require
more angular values to be used.
The angular point-tracing algorithm (APTA) is
based on a two-dimensional ray casting. The ray
pairs that will be used as input in the APTA, have
the starting point located outside the patient‚Äôs body
volume at distance D and angular location D. The
target point will be always the central axis of the
volume-bounding box (see Fig. 3).
To label the sampling voxel as one belonging to

Proceedings of the Seventh International Conference on Information Visualization (IV‚Äô03)
1093-9547/03 $17.00 ¬© 2003 IEEE

the skin boundary we use a pre-calculated opacity
volume of the CT data. The opacity volume was
calculated based on gradient operators, an approach
established from Levoy [4] and used very often in
volume rendering applications. The intersection
point between the ray and the body boundary is selected based the opacity value of the voxel under
sampling. Often the CT table-top where the patient
is placed during scanning is included in the reconstructed slices. Clipping of CT table-top information is currently done manually.

3.2. Selection of Angular Samples
For selecting the appropriate value of angular
sampling points A that will adequately describe the
body shape we select as criterion the comparison
between the APTA contours and the original body
contours as they are segmented using a boundary
tracing method. At this point an evaluation is required in order to assess whether the calculated
contour describes effectively the original body
shape at the current cross section image. We consider the overlapping area between two different
contours, those segmented with normal boundary
segmentation algorithm and those produced with
APTA, as an adequate comparison criterion. The
overlapping area is calculated for every contour belonging to a different slice levels. Then the mean
value of the difference of the overlapping area is
calculated. If this difference is above 10% then
more angular points must be introduced in order to
describe with higher detail the body shape. In our
experiments we found that not more than 80 angle
positions are required to describe adequately the
body shapes of the volume samples. An example of
the APTA and the conventional polygon
reconstruction are given later on.

struction are given later on.

4. Surface Smoothing
As primary smoothing filter for our application
we consider the moving average since it can be implemented by convolution and aims to average the
fluctuating values appeared in the signal. The MA
filter averages a number of points from the input
signal to produce each point in the output signal.
The smoothing result of the MA can be amplified or
reduced by controlling either the size N order of the
neighbor samples or by maintaining a constant values N and performing multiple-passing of the MA.
By applying the filter with multiple passes we obtain an improved frequency response in comparison
to the increased the kernel size.

4.1. Surface Signal Constrains
Per default the surface smoothing will be applied to the complete data. However this will cause
deformation of non-problematic regions. The developing of an algorithm that automatically could
detect the regions that include breathing artifacts is
a difficult issue. Therefore constrains should be applied to limit the smoothing effect in specific regions. There are two types of constrain that must be
defined: the angular and the longitudinal constrains.
The angular constrains refer to the numbers of
contour points, which represent angles between the
central axis of the body volume and the external
surface position. These constrains could be applied
as constant values since the breathing deformation
effects specific regions of the patient‚Äôs sides. The
second type of constrain, the longitudinal, are the
most significant for producing accurate results.
These constrains must be placed manually. The user

(a)

(b)

Figure 4. The effect of signal constrains and the use of linear interpolation over an angular signal. In (a) constrains are directly applied on the smoothed signal. In (b) the smoothed curve is linear interpolated with the
original values at the constrain levels.

Proceedings of the Seventh International Conference on Information Visualization (IV‚Äô03)
1093-9547/03 $17.00 ¬© 2003 IEEE

can select the appropriate slice level in both directions cranial or caudal. In order to maintain continuity at the region of constrains among the original
and filtered data the smoothing process is applied
to the complete patient volume and the filtered results are merged with the original data at the constrain boundaries using linear interpolation. This
concept is illustrated in Fig. 4. The marks on both
curves illustrate constrains in the longitudinal zdirection. The smoothed curve in Fig. 4(a) has a
rapid value reduction at the constrain points. This
is eliminated after applying the linear interpolation
between original and filtered values (see Fig. 4(b)).

5. Results & Discussion
The proposed method was evaluated using 15
CT datasets from arbitrary selected subjects that
were scanned in the abdominal and pelvic region.
All subjects were scanned at free respiration conditions using spiral CT (Siemens Somatom Plus 4).
The average number of slices collected from each
scan was 85 per patient, 3mm or 5mm thin with
equal slice distance. Surface signal constrains have
been applied manually on different slice levels. Fig.
6 illustrates the smoothing result of our method on
two torso surfaces.
For each contour point we estimate the Euclidean distance between the original and the reformatted contours. Border positioning accuracy was assessed by computing the Mean value, the SD value
and the Maximum distance (Max). The second criterion used was the total volume of the original and
the filtered surface objects. The preserved interior
surface volume of the smoothed surface can indicate that the filtering process did not cause severe
shrinkage to the polygonal surface. However the
interior surface volume does not provide any information level of smoothing on the original surface.
For assessing the absolute variation of volume
between original and reformatted mesh the partial
volume variations was used. This parameter was
calculated on each slice level as the absolute difference between original and smoothed contour volume. The total value of the absolute volume differences between original and smoothed mesh, was
estimated after addition of the partial volumes.
These measurements provide a good factor for understanding the results of the smoothing process
presented in Fig. 6.
The top chart presents the maximum, the mean
and the SD of the distances between original and

Figure 5. Results of quantitative comparison between original and reformatted body-contours.
reformatted contours of the complete contour set,
for every volume sample. Among 15 volumetric CT
data, which result to 1450 body contours, the
maximum contour difference was 8mm and the
minimum 2mm.The maximum mean value was
1.2mm with SD r 0.2mm. The absolute and the actual differences between original and smoothed surfaces are illustrated in the lower graph of Fig. 5.
The mean value of the actual volume difference
was 8ml, a very small value compared to the average volume of the all sample data. This certifies that
the proposed method caused no shrinkage to the
mesh volume. The maximum value of the absolute
difference in mesh volume was 137ml and the mean
value 75.6ml with SD r33.08ml. This volume
variation represents only the 1% of the original
mesh volume. However if one considers these
variations locally then the influence in measurements can be valuable.
The number of filter iterations used during surface smoothing varied between 6 and 18, upon the
frequency of the deformed surface. The processing
time required for the smoothing of the surfaces is
highly related on the number of vertices that compose the mesh. On the experiments performed in
this work the mean value of vertices were 12200. In

Proceedings of the Seventh International Conference on Information Visualization (IV‚Äô03)
1093-9547/03 $17.00 ¬© 2003 IEEE

any sample case the processing time required for
smoothing was near to 1 sec for the total number of
iterations on a Pentium III 933 MHz.

6. Summary
In this work a dedicated approach is presented
for the compensation of the respiratory artifacts of
human torso surfaces reconstructed from planar
contours in the frame of radiation therapy. The
method can handle fast and efficiently several types
of surfaces with respiratory artifacts that might include constant or arbitrary respiration frequencies.
The user can define manually constrains on the angular or on the slice level to avoid deformation of
the original surface characteristics. Part of our future work is to investigate how the proposed
method will influence the clinical outcome of the

RTP process.

7. References
[1] C. Ritchie, C. Crawford, D. Godwin, K. King,
and Y. Kim, ‚ÄúCorrection of Computer Tomography
Motion Artifacts Using Pixel-Specific BackProjection‚Äù, IEEE Trans. On Med. Imaging, 1996,
Vol. 15, No. 3, pp. 333-342
[2] C. Crawford, K. King, C. Ritchie, and D.
Godwin, ‚ÄúRespiratory Compensation in Projection
Imaging Using a Magnification and Displacement
Model‚Äù, IEEE Trans. On Med. Imaging, 1996, Vol.
15, No. 3, pp. 327-332
[3] J. Boissonat, ‚ÄúShape Reconstruction from Planar Cross Sections‚Äù, Computer Vision, Graphics
and Image Processing, 1988, Vol. 44, pp. 1-29
[4] M. Levoy, ‚ÄúDisplay of surface from volume
data‚Äù, IEEE Computer Graphics & Applications,
1988, Vol. 8, No. 5, pp. 29-37
[5] J. Vollmer, R. Mencl, H. M√ºller. ‚ÄúImproved
Laplacian Smoothing Of Noisy Surface Meshes‚Äù,
Eurographics‚Äô99 ,1999, Vol. 18, No. 3, pp. 131138
[6] G. Taubin, ‚ÄúA Signal Processing Approach to
Fair Surface Design‚Äù, Computer Graphics Proceedings (SIGGRAPH‚Äô 95), Los Angeles, California,
1995, pp. 351-358
[7] M. Desbrun, M. Meyer, P. Schr√∂der, and H.
Barr, ‚ÄúImplicit Fairing Of Irregular Meshes Using
Diffusion And Curvature Flow‚Äù, Computer Graphics Proceedings (SIGGRAPH‚Äô 99), Los Angeles,
California, 1999, pp. 317-324
[8] L. Kobbelt, S. Campagna, J. Vorsaiz, and H.P.
Seidel, ‚ÄúInteractive Multi-Resolution Modeling on
Arbitrary Meshes‚Äù, Computer Graphics Proceedings (SIGGRAPH‚Äô 98), Orlando, 1998, pp. 105-114
[9] K. Langen, and D. Jones, ‚ÄúOrgan Motion and
its Management‚Äù, Int. J. Radiation Oncology Biol.
Phys., 2001, Vol. 50, pp. 265-278

Figure 6. Two different body surfaces examples are
illustrated. Notice that the respiration artifacts are
not developed uniformly but vary with high and low
rates. The first row represents the original meshes.
The middle the smoothed-reformatted. The color
mapped meshes indicate areas with modified vertices.

Proceedings of the Seventh International Conference on Information Visualization (IV‚Äô03)
1093-9547/03 $17.00 ¬© 2003 IEEE


Conic Representation of a Rational Cubic Spline
Muhammad Sarfraz
Department of Information & Computer Science
King Fahd University of Petroleum and Minerals
KFUPM # 1510, Dhahran 31261
Saudi Arabia.
E-mail: sarfraz@ccse.kfupm.edu.sa

Zulfiqar Habib
National College of Textile Engineering
Faisalabad
Pakistan.
E-mail: zulfiqar_habib@hotmail.com

Abstract

and cubics. The presented curve scheme encompasses and
extends the results in [1]. The features of maintaing some
reasonable amount of continuity between conic and cubic
arcs, estimated end derivatives, conic (circular, elliptical,
parabolic, and hyperbolic) splines, and circular arcs for
given radius or center, are further achievements in this
research.

A rational cubic spline, with on family of shape
parameters, has been discussed with the view to its
application in Computer Graphics. It incorporates both
conic sections and parametric cubic curves as special
cases. The parameters (weights), in the description of the
spline curve can be used to modify the shape of the curve,
locally and globally, at the knot intervals. The rational
cubic spline attains parametric C2 smoothness whereas
the stitching of the conic segments preserves visually
reasonable smoothness at the neighboring knots. The
curve scheme is interpolatory and can plot parabolic,
hyperbolic, elliptic, and circular splines independently as
well as bits and pieces of a rational cubic spline.

1. Introduction
Piecewise rational cubic spline functions provide a
powerful tool for designing of curves, surfaces and some
analytic primitives such as conic sections that are widely
used in engineering design and various Computer
Graphics applications. These applications may be
representing some font outline, round corner in an object,
or it may be a smooth fit to a given data. Several
segments of curves, to compose a desired curve outline,
can have different mathematical descriptions. For
example, a font “S” when designed, appears to have
straight lines, conics, and cubics as essential parts of its
outline. Single mathematical formulation for the precise
definition of various types of geometry shapes is one of
the major advantages of the rational cubic spline
functions.
This research describes the parametric C2 rational
cubic spline representation possessing a family of shape
control parameters. This family of shape parameters has
been utilized to produce straight line segments, conics,

There are many schemes in the literature for shape
control using cubic interpolants. For brevity, the reader is
referred to [1-18]. In [1], a C1 rational cubic spline with
approximated derivatives at control points was used and
continuity between conic and cubic arcs was not
discussed. Intermediate point interpolation scheme and
circular arcs presented in [3] are not practical as the space
curves and exact circular arcs are not possible. In [6], end
derivatives are based on the assumption of the user, which
is not convenient. Moreover, the conics were not
discussed at all. We have estimated most suitable end
derivatives for more pleasing results. In [4], rational
quadratic spline is used for circular spline. We are using
very simple technique using rational cubic spline for the
same circular spline. In addition, the scheme has the
following properties which may lead to a more useful
approach to curve and surface design in CAGD:
•
•
•
•
•

The curve has C2 continuity between the rational
cubic arcs and G1 continuity between cubic and
conic arcs.
Most suitable end derivatives are estimated.
The scheme is local, i.e. shape control
parameters will not significantly effect the
adjacent parts of the design curve.
Any part of the rational cubic spline can be made
conic (with exact circle and ellipse) or straight
line using the same interpolant.
The method is most suitable for space curves and
hence can be generalized to surfaces.

The distribution of the paper is as follows. A C2
parametric rational cubic spline scheme, together with
determination of tangents at the knot points, is considered
in Section 2. Analysis of the designing curve has been
made in Section 3. Conditions for conics and straight line
segments are given in Section 4. This section also covers
all types of circular arcs in space. In Section 5, we have
presented a scheme to calculate end derivatives
(tangents). The Section 6 concludes the paper.

control points {Fi, Vi, Wi, Fi+1 } and is variation
diminishing.

2.1.

Estimation of Tangent Vectors

There are different choices of the tangent vectors Di
at Fi, which can be opted for practical implementation for
the computation of a curve with specific amount of
smoothness. For C 1 curve methods, some reasonable
tangent approximation method can be used. The distancebased approximations are found reasonably good as far as
pleasing smoothness is concerned. These tangent vectors
Di at Fi are defined as follows:

(a)

(a)

(b)

(c)

Figure 1. Spline curves with various end
conditions: (a) with distance based derivatives,
(b)-(c) with exact derivatives.

(b)

2. The Rational Cubic Spline
Let Fi ∈ Rm, i = 0,1,….n, be a given set of data points
at the distinct knots ti ∈ R. Also let Di ∈ Rm, denote
derivative values defined at the knots. Then a parametric
C 1 -piecewise rational cubic Hermite spline P : R → Rm is
defined by:
N (t )
i
P(t ) ≡ P (t ) =
(2.1)
, i = 0, 1, ...., n − 1,
i
M (t )
i
where
3
2
N i (t ) = (1 − θ ) Fi + θ (1 − θ ) (γ i + 1)Vi
+ θ 2 (1 − θ ) (γ i + 1)Wi + θ 3 F i +1

M i (t ) = (1 − θ ) + θ (1 − θ )γ i + θ 2
2

θ = (t − t i ) / hi , hi = t i +1 − t i ,
and



(2.2)

1

Wi = Fi +1 +
Di +1 .

1+ γ i
The choice of parameters γi > -1 ensures a strictly positive
denominator in the rational cubic. Thus from Bernstein
Bezier theory, the curve lies in the convex hull of the
Vi = Fi +

1
Di ,
1+ γ i

Figure 2. Curvature plots of Spline curves with
exact derivatives: (a) with distance based end
derivatives, (b) with conic compatible end
derivatives.
For open curves, the end conditions are defined as:
D0 = 2 (F1 − F0 ) − (F2 − F ) / 2 ,

(2.3)

D n = 2 (Fn − Fn −1 ) − (Fn − Fn − 2 ) / 2, 
and the tangents at the interior knots, for I = 1, 2, …, n-1,
are given by:
Di = a i (Fi − Fi −1 ) + (1 − a i )(Fi +1 − Fi )
(2.4)
where
Fi +1 − Fi
ai =
, i = 0, .... , n.
Fi +1 − Fi + Fi − Fi −1
For close curves, the end conditions are defined as:
F−1 = Fn −1 , Fn +1 = F1 ,
and the tangents at the interior knots are same as in (2.4)
but i = 0, 1, …, n.
The experiments have shown that the use of the
distance-based approximated derivatives, corresponding

to any control polygon (open or closed), provides visually
pleasing output. Figure 1(a) is the display of this
derivative scheme for an "S" shaped data. For further
details, the reader is referred to [1].
For a higher continuity than C 1 , more complicated
constraints are required to be fit. For example, for
C 2 rational cubic spline, the constraints lead to a
tridiagonal linear system of equations. This system is
diagonally dominant and hence provides a unique
solution. This system can be solved using some
tridiagonal linear system solver like LU decomposition
method. Their details are as follows:
C1 constraints
P (1) (t i+ ) = P (1) (t i− ), i = 1, ..., n.
give
Di = γ i −1 ( Fi − Fi −1 ) − Di −1 ,
and C2 constraints
P ( 2 ) (t i+ ) = P ( 2 ) (t i− ), i = 1,.., n − 1.
lead to the following system of equations:
hi Di + (hi (γ i −1 − 1) + hi −1 (γ i − 1)) + hi −1 Di +1



= γ i −1 ∆ i + γ i ∆ i _ 1 , i = 1,.., n − 1.

•

The parameters γi may be used to control the shape of
the curve. For the practical implementation, we choose γi
≥ -1. The interval tension properties are apparent for the
rational Hermite form and are explained in the following
subsections.

3.1. Interval Tension
The interval shape property is obvious from the
following limit behaviour. That is, the increase in the
shape parameter in any interval tightens the curve towards
the line segment joined by the control points.

3.2. Global Tension
(2.5)

The parameters γi are mainly meant to be used freely
to control the shape of the curve. At the same time, for the
convenient of the designer, it is also required that the
ideal geometric properties of the curve are not lost. The
geometric properties like variation diminishing, convex
hull, and positivity are the ones which needed to be
present in the description of the design curve.
• For the constraints, γ i ≥ 0, ∀i , it is very obvious
that the rational cubic is characterized as of
Bernstein Bezier form.
• Thus following the Bernstein Bezier theory, the
piece of curve Pi (t ) lies in the convex hull of
i

}

lim P(t ) = (1 − θ ) Fi + θ Fi +1

3. Design Curve Analysis

i

{

γ i →0

For the need of practical results, exact derivatives may be
computed from (2.5) together with the end conditions in
(2.3). Figure 1(b) is the demonstration for this derivative
scheme. The end conditions used here may not be
appropriate for the objectives of this article. Therefore, a
reasonable choice has been made in Section 5 which
demonstrates the "S" shaped data in Figure 1(c). The
difference can be seen in Figure 2 demonstrating
curvature plots of Figures 1(b) and 1(c) in Figure 2(a) and
2(b) respectively.

{F , V

crossing
the
control
polygon
of
Fi , Vi , Wi , Fi +1 does not cross the curve more
than its control polygon.

}

, Wi , Fi +1 .

It also follows the variation diminishing property
within the convex hull. That is any straight line

Applying the interval property above successively, the
design curves converges to the control polygon as the
derivatives, either being distance-based or computed from
the system of equations, are bounded.

4. Conic and Linear Segments
Conic and straight line are the most important part in
designing which can be achieved through rational cubic
interpolant, so that we can use the same interpolant for all
types of curves and surfaces. The procedure is as follows:
Let Ui be taken as the point of intersection of
tangents at Fi and Fi+1 (in case the tangents are parallel, Ui
can be taken as the point where the arc is desired to be
splitted, for example, it may be the inflection or the
middle point, etc.)
Fi + γ iU i 
, 
1+ γ i

(4.3)

Fi +1 + γ iU i 
Wi =

1+ γ i
For conic section properties and choice of shape
parameters, the conic shape factor (sharpness parameter),
for each piece of curve, is determined as follows:
1
ki = 2
(4.4)
γi
Various conics are recovered depending upon the nature
of weights in (4.4). That is, the ith arc will be:
• parabolic if γi = 2
Vi =

•
•
•
•

hyperbolic if γi > 2
elliptic if γi < 2
straight line: γi = 0 (can be considered as a
second method for straight line segment)
circular if
(4.5)
γ i = 2 cos φ
where φ is the angle between Fi+1 - Fi and Ui - Fi
and
U i = Fi + µ i Ti
(4.6)
where Ti is the unit vector along Di and
( Fi +1 − Fi ) 2
µi =
(4.7)
2( Fi +1 − Fi ).Ti
is determined by the condition
U i − Fi = U i − Fi +1

direction of exact derivatives with same magnitude. Thus,
to preserve continuity at Fi, we take
Di
β i −1
Di =
Di (4.8)
(U i − Fi ), Wi −1 = Fi −
β i −1 + γ i −1
U i − Fi
To achieve a straight line, one needs to replace Ui with
Fi+1. Similarly, for continuity at Fi+1, we take

Di +1
Di +1 =
( Fi +1 − U i ), 
Fi +1 − U i

(4.9)

α i +1

Vi +1 = Fi +1 +
Di +1 
α i +1 + γ i +1

and replacement of Ui with Fi leads to a straight line.

4.1. Circular Arc for Given Radius
Let r be the given radius of the circular arc such that
Fi +1 − Fi
r>
2

(a)

(b)

(a)

(b)

(c)

(c)

(d)

Figure 3. Spline curves: (a) Circular spline, (b)
Elliptic spline, (c) Parabolic spline, (d)
Hyperbolic spline.
Now we are imposing continuity conditions so that
both segments can share same tangent direction at knot to
ensure G1 continuity. For this we are changing the

(d)

Figure 4. Curvature plots of Figure 3: (a) Circular
spline, (b) Elliptic spline, (c) Parabolic spline, (d)
Hyperbolic spline.
then center M can lie anywhere on the circle centred at
Fi + Fi +1
N=
(4.9)
2

and radius
2

 Fi 1 − Fi 
+

(4.10)
b = r2 −


2


but we will prefer that it should lie on the plane passing
through Fi, Fi+1 and U i' , where U i' is the intersection of Di
and Di+1. Therefore circular arc should lie on the side of
U i' .
Let e1 be the rotation of Fi+1 about N through angle θ
on the plane passing through Fi, Fi+1 and U i' . Where θ =
900 for anti-clockwise rotation and θ = -900 for clockwise
rotation of circular arc. Now
e −N
e= 1
e1 − N
is a unit vector passing through N and perpendicular to
Fi+1 - Fi. Then M = N+be will be the center of the circular
arc. Let φ be the angle between N - M and Fi - M,
therefore
γ i = 2 cos φ
Take φ = -φ for anti clockwise rotation of circular arc. Let
T’ is the rotation of Fi+1 by Fi through angle φ on the
plane passing through Fi, Fi+1 and U i' . Then
Ti =

Now use equation (4.6) to find Ui, equation (4.3) to find
control points Vi and Wi, equation (4.8) for continuity at
Fi, equation (4.9) for continuity at Fi+1 and finally use
rational cubic interpolant in equation (2.1) for required
circular arc.

5. End Conditions
A compatible choice, which is more appropriate for
the curve scheme of this paper, is presented here. For
tangent at first point, let θ0 be the angle between F1 -F0
and F2 -F0. Take θ0 = -θ0 for anti-clockwise rotation of
points F0, F1 and F2. Let T0 be the rotation of F1 about F0
through angle θ0 on the plane passing through F0 ,F1 and
F2 . Then

( F1 − F0 ) 2
µ0 =
, U 0 = F0 + µ 0 T0 ,

2( F1 − F0 ).T0
(5.1)

F0 + 2U 0

, D0 = 3(V 0 − F0 ), 
V0 =
3

where µ0 is determined by the condition
U 0 − F0 = U 0 − F1
and V0 & D0 are taken from (4.1) & (2.2) respectively.

T ' − Fi
T ' − Fi

is a unit tangent vector at Fi.
Now use equation (4.6) to find Ui, equation (4.3) to
find control points Vi and Wi, equation (4.8) for continuity
at Fi, equation (4.9) for continuity at Fi+1 and finally use
rational cubic interpolant in equation (2.1) for required
circular arc. In this scheme, the radius r can be used as a
shape control parameter.

4.2. Circular Arc for Given Centre
Let M be the given center of the circular arc such that
M − Fi = Fi +1 − M
Let M be the rotation of M by Fi through angle θ on the
plane passing through Fi, Fi+1 and M. Where θ = 900 for
clockwise rotation of circular arc and θ = -900 for anticlockwise rotation. Then
M ' − Fi
Ti =
M ' − Fi
’

is a unit tangent vector at Fi. Let φ be the angle between
Fi+1 - Fi and Ti, therefore

γ i = 2 cos φ

(a)

(b)

Figure 5. (a) Rational Cubic Spline with second
last interval as circular arc piece, (b) the
corresponding curvature plot.
Similarly for tangent at last point, let θn be the angle
between Fn-1 -Fn and Fn-2 -Fn . Take θn = -θn for anticlockwise rotation of points Fn ,Fn-1 and Fn-2. Let Tn be the
rotation of Fn-1 about Fn through angle θn on the plane
passing through Fn ,Fn-1 and Fn-2. Then

( Fn −1 − Fn ) 2
µ n −1 =
, U n −1 = Fn + µ n −1Tn ,

2( Fn −1 − Fn ).Tn
 (5.2)
Fn + 2U n −1

, D n = 3( Fn − W n −1 ),
W n −1 =

3
where µn-1 is determined by the condition
U n −1 − Fn = U n −1 − Fn −1
and Wn-1 & Dn are taken from (4.1) & (2.2) respectively.

6. Demonstration
The demonstration in this section has used derivative
end conditions of Section 5. Figure 3 contains a block of
conic splines where Figure 3(a) is Circular spline, Figure
3(b) is Elliptic spline, Figure 3(c) is Parabolic spline, and
Figure 3(d) is Hyperbolic spline. Figure 4 represents the
corresponding curvature plots of the curves in Figure 3.
The demonstration of a rational cubic spline when it
contains conic segments is made in Figure 5. Figure 5(a)
is a rational cubic spline with second last curve as circular
spline, the corresponding curvature plot in Figure 5(b)
verifies the result.

7. Conclusion and Future Work
We have described an interval controlled rational
cubic interpolation scheme. The scheme offers a number
of possible ways in which the shape of the corresponding
curves may be altered by the users. It is therefore felt that
such a scheme could be a useful addition to an interactive
design package, with the user having enough control over
the curve segments. The provision of the shape
parameters, in the description of the piecewise rational
functions, provides freedom to modify the shape in
desirous regions in a stable manner.

[2] M. Sarfraz, M. Hussain, and Z. Habib, Local Convexity
Preserving Rational Cubic Spline Curves, Proceedings
IEEE Conference on Information Visualization, IV'97,
London, 1997, pp. 211-218.
[3] M.A. Jamaludin, H.B. Said, and A.A. Majid, Shape Control
of Parametric cubic curves, CAD/Graphics, China, 1995.
[4] J. Hoschek, Circular Splines, Computer-Aided Design, Vol
24, 1992, pp. 611-618.
[5] Gregory, J. A. and Sarfraz, M. (1990), A Rational Spline
with Tension, Computer Aided Geometric Design, Vol. 7,
1-13.
[6] Gregory, J. A., Sarfraz, M., and Yuen, P.K. (1994),
Interactive Curve Design using C2 Rational Splines,
Computers and Graphics, Vol. 18(2), 153-159.
[7] Sarfraz, M. (1993), Designing of Curves and Surfaces
using Rational Cubics, Computers and Graphics, Vol.
17(5), 529-538.
[8] Sarfraz, M. (1995), Curves and Surfaces for CAD using C2
Rational Cubic Splines, Engineering with Computers, Vol.
11(2), 94-102.
[9] Foley, T.A. (1989), Surface Interpolation with Tension
Controls using Cardinal Bases, Computer Aided Geometric
Design, Vol. (6), 97-109.

The rational spline scheme is meant for parametric
curves and is capable of designing plane as well as space
curves. It is an interpolatory rational spline scheme
enjoying all the ideal geometric properties. It has features
to produce all types of conic curves in such a way that
whole of the design curve may be produced as a circular,
elliptic, parabolic, or a hyperbolic spline curve. In
addition, the desired conic pieces may also be fitted
within the rational cubic spline.

[11] L. Piegl, and W. Tiller, The NURBS book, Springer, 1995.

Overall smoothness of the rational cubic spline is C2
whereas the conics are stitched with G1 continuity. The
curve scheme is extendable to surfaces and authors are
lookng to publish it in a subsequent paper.

[14] M. Sarfraz, Curves and Surfaces for CAD using
C 2 Rational Cubic Splines, Engineering with Computers,
Vol.11(2), pp. 94-102, 1995.

Some extra shape control parameters are also
expected to be included to have some more degrees of
freedom for designers. These shape parameters may be
like point, interval, or biased shape control parameters
used by various authors including Nielson, Foley, Barsky,
Sarfraz, Gregory [13-18].

[10] Nielson, G.M. (1986), Rectangular ν-splines, IEEE
Computer Graphics and Applics. 6, 35-40.

[12] G. Farin, Curves and Surfaces for Computer Aided
Geometric Design, Academic Press, 1988.
[13] G. Nielson, Rectangular Nu-splines, IEEE Computer
Graphics and Applications, pp. 35-40, 1986.

[15] T. A. Foley, Surface Interpolation with Tension Controls
using Cardinal Bases, Computer Aided Geometric Design,
Vol. 6, pp. 97-109, 1989.
[16] B. A. Barsky, Computer Graphics and Geometric
Modeling using Beta-Splines, Springer-verlag, 1986.

References

[17] M. Sarfraz, Designing of Curves and Surfaces using
Rational Cubics, Computers and Graphics, Vol. 17(5), pp.
529-538, 1993.

[1] M. Sarfraz, Z. Habib and M. Hussain, Piecewise
Interpolation for Designing of Parametric Curves,
Proceedings
IEEE
Conference
on
Information
Visualization, IV'98, London, 1998, pp. 307-313.

[18] M. Sarfraz, A Rational Cubic Spline with Biased, Point and
Interval Tension, Computers and Graphics, Vol. 16, pp.
427-430, 1992.


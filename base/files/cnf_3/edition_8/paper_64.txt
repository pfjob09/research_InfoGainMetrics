Robust Detail Recognition and Location Technique for Image Retrieval in
Digital Repositories
L. Capodiferro(*), A. Neri(**), M. Nibaldi(**), G. Jacovitti(***)
(*)
Fondazione “Ugo Bordoni”, Roma, Italy
(**)
Applied Electronics Dept. University of "Roma TRE", Roma, Italy
(***)
INFOCOM Dpt., University of Rome “La Sapienza”, Roma, Italy
lcapodiferro@fub.it, a.neri@ele.uniroma3.it, gjacov@infocom.uniroma1.it
Abstract
Large collections of image documents are today
accessible via communication networks. Cost
effective retrieval of the wanted images needs
convenient browsing tools. In this contribution a
technique for image selection on the basis of key
details is illustrated. The technique is useful for
instance for assisted queries to digital artwork
collections,
tele-sensing
images,
aerial
photographs, astronomic databases, etc. The basic
feature of the method is the capability of detecting
and locating anyway rotated details with
reasonable computational costs. In this work a
criterion for proper choice of detail reference
points is illustrated.
Keywords: Content based Image Recognition,
Pattern localization

1. Introduction
Large image databases in different applications
domains (e.g., telesensing,
medical imagery,
genomics, astrophysics, etc.) require selective
recognition and classification tools for assisted
browsing and retrieval. Therefore, content-based
image retrieval (CBIR) techniques constitute today
an important investigation and development topic
in image processing.
One of the basic elements for CBIR is pattern
recognition and location. In particular, it is
important to detect and locate given details in
image repositories as a preliminary step toward
object detection robust with respect to factors such
as geometric distortions and illumination changes.
____________________________________________________
This material is based upon work supported by the IST
programme of the EU in the project IST-2000-32795 SCHEMA

In a recent work [1], a novel technique for
performing complete Maximum Likelihood (ML)
pattern localization, i.e. joint position, orientation
and scale estimation in complex scenes with
reasonable computational complexity has been
presented. Such a technique is based on a special
local expansion of images called Gauss-Laguerre
(GL) expansion. Using the GL expansion it is
possible to perform joint maximization of the ML
functional with respect to scale and orientation for
each possible location over the explored images, by
means of standard iterative procedures.
The collection of such ML maxima for each
point defines the so-called Gauss Laguerre
Likelihood Map, whose absolute maximum yields
the wanted the pattern location. The interest of this
method relies on the fact that most often the
optimum ML solution can be found with few GLT
coefficients.
The scope of this contribution is to present some
modifications of the said method aimed to improve
its robustness with respect to ambiguity factors
inherently coming from the pattern structure. In
particular we make use of a corner points detector
for the selection of the locations containing details
that can be more easily and reliably detected. For
the sake of compacteness, in the following we
assume that the scale is known and unitary.

2. ML pattern localization
With

reference

to

the

coordinates

x = [ x1 x 2 ] , let us assume that the observed
image f(x) contains a noisy, translated, and rotated
copy of a given template pattern g(x) so that
w ª¬ Rϕ ( x − b )º¼ f (x ) = w ª¬ Rϕ ( x − b ) º¼ g ª¬ Rϕ ( x − b ) º¼ + ν ( x )
T

where w(x) is a generic observation window,
b = [ b1

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

b 2]

T

denotes the pattern position,

the

matrix Rϕ performs coordinate

rotation by the

angle ϕ, and v(x) is the observation noise.
Let now the windowed pattern
g w (x ) = w( x ) g (x )
(1)
be decomposed in terms of its “circular harmonics”

g nw (x) (see [2]) with respect to the origin of its

w ( x ) f (x + b), gnw ( x ) = f (b) ∗ ª w ( −b ) gnw ( − b)º
¬«
¼»
(9)
where overbar denotes complex conjugate. Thus,
denoting with Mn(b) and ηn(b) respectively the
magnitude and the phase of the inner products

coordinates, referred to as pivot.
g w (x ) = w( x ) g ( x ) =

∞

¦

g nw (x )

M n (b)e jηn ( b ) = w ( x ) f ( x + b), g nw ( x )

(2)

(10)

n =−∞

where the n-th angular harmonic is given by
g nw (x) = d n ( x ) e j n γ ( x )

(3)

the Log-Likelihood functional can be written as
follows:

with

§ x2 ·
¸
© x1 ¹

γ (x) = tg −1 ¨

x = x12 + x22 ,

( )

(4)

ln Λ [ f ( x );ϕ , b ] =

and d n x are the radial profiles, given by the
Fourier integrals
1
dn ( r ) =
2π

³

2π

g
0

w

([r cos γ

r sin γ ]

T

)e

∞

¦e

−j n ϕ

g nw ( x )

³³

¦

M n (b) cos( ηn (b) + nϕ )

n

w ( x − b)

2

2

f (x) dx − 2

Eg w
N0
(11)

−j nγ

dγ

(5)
Rotating the pattern gw(x) by any angle ϕ
produces only a linear change in the phase of the
angular harmonics, i.e.,
g w ( Rϕ x) =

2
N0

−

4
N0

(6)

Thus, for a given location, the orientation

ϕˆ ML ( b) that maximizes the functional (7) can be
computed with the Newton-Raphson iterative
procedure as follows :
( m)
( m−1)
ϕˆML
( b) = ϕˆML
( b)

∞

n =−∞

If the window w(x) is circularly symmetric, then
it is shown [1] that the Log-Likelihood functional
writes in the following form:
ª
º
4
w( x) f (x + b), gnw ( x) e jnϕ »
ln Λ[ f (x);ϕ, b] = Re «
»
N0 «
¬« n
¼»
E
2
2
2
gw
−
w ( x − b) f (x) dx − 2
N0
N0

¦

³³

(7)
where <.,.> denotes inner product, N 0 is the noise
spectral density and Eg w is the windowed pattern
energy,
Eg w = ³ ³ | g w ( x ) |2 dx = ³ ³ | g ( x ) |2 | w(x ) |2 dx

(8)
This expression involves only inner products
between the observed image f and the angular
harmonics of the unrotated template for each site b.
For the n-th harmonic, the inner products as
function of location b, can be calculated by means
of convolution as follows:

¦
¦

( m−1)
n M n ( b ) sin ª¬nϕˆML
( b) +ηn ( b)º¼

−

n =−∞
∞

, m = 1,2,K

( m−1)
n2 M n ( b ) cos ª¬nϕˆML
( b) +ηn ( b)º¼

n =−∞

(12)
Eq (11) assumes that the two pictures have been
acquired with imaging systems with identical
characteristics, under the same illumination
conditions.
However, to compensate for differences of the
luminance level between the template and the
examined pattern we may referr to the normalized
inner product. In other words, we may maximize
the functional
% [ f ( x );ϕ , b ] =
ln Λ

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

−

2
N0

³³

4
N0

¦

M% n (b) cos( η%n (b) + nϕ )

n

w ( x − b)

2

2

f (x) dx − 2

Eg w
N0
(13)

where

4
R ϕE∇gx RTϕ
(17)
N0
On the other hand, the Fischer information with
respect to pattern rotation is:
J (b ) =

%
M% n (b )e jηn ( b ) =

w ( x ) f ( x + b ), g nw ( x )
w ( x ) f (x + b), w ( x ) f (x + b)

1
2

g nw ( x ) g nw ( x )

1
2

(14)
If the reference pattern is sufficiently well
described by a limited number of angular
harmonics, then such a modified maximum
likelihood detection and localization procedure is
feasible with reasonable computational cost.
Actually, in our implementation we have
adopted a gaussian observation window of the kind:

Jϕ =

3. Choice of the pivot points
For reliable localization of a pattern in a image
database, the choice of the pivot position within the
pattern to be located is critical, because the
accuracy of the ML estimate strongly depends upon
the pattern shape around the pivot.
To understand how the pivot position should be
selected, it is interesting to measure the Fischer
information of a generic pattern. In [1] an
articulated calculus of the Fischer information
matrix has been carried out.
In essence,
considering the matrix

ª Eg x
E∇gx = « 1
«¬Eg x1 g x2

Eg x g x º
1 2
»
Eg »
x2
¼

(18)

where Egγ is the total energy of the pattern angular
derivative
Egγ =

³

∞

rEgγ ( r ) dr

(19)

0

where
E gγ ( r ) = w( r )

§ x ·

1 1 −¨¨© s2 ¸¸¹
g s (x ) =
e
(15)
π s2
where s is a user defined scale factor which
determines the window size.
Use of a gaussian window allows to further
expand the angular harmonics in a orthonormal
basis constituted by the Gauss-Laguerre (GL)
angular harmonic functions [2]. This means that
both the windowed pattern and the explored images
can be represented with the GL basis. This point is
omitted here for the sake of brevity.

4
Eg
N0 γ

2

³

2π

0

2

ª ∂g ( r , γ ) º
« ∂γ » d γ . (20)
¬
¼

Thus, the problem of determining reliable pivot
points amounts to find points having high values of
the Fischer information, with respect to both
displacement and rotation.
Among many possible indicators of high Fischer
information, we have found that detectors of corner
points do constitute suitable and relatively simple
indicators, as the intuition suggests. In fact, corner
points present high values of both J ( b) and Jϕ . As
a matter of fact, corner points are often employed as
“salient point” in some image processing
applications where localization must be accurate,
such as image registration or image based
telemetry.
In the present work, we have adopted a simple
method for detecting corner points, strictly related
to our implementation of the ML pattern
localization. In fact, one of the functions pertaining
to the GL basis employed in our ML procedure
consists of a smoothed “complex gradient” operator
of the observed image, i.e:
­ ∂
½
∂
g s (x ) + j
g s (x ) ¾
∇GS ( x ) = ®
x
x
∂
∂
¯ 1
¿
2

(21)
(16)

where the entries are the energies and the crossenergies of the vertical and horizontal derivatives of
the pattern into the window w ( x ) , the Fischer
information with respect to the displacement b is:

where g s ( x ) is the gaussian window.
For each point of the image f(x), ∇GS ( x ) is a
complex number whose phase indicates the
direction of the gradient, i.e. the direction along
which the directional smoothed derivative has its
largest absolute value, equal to the magnitude of the
complex gradient itself.

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

Figure 1. Image where searched detail
exist.

Following now the classical Marr-Hildret
scheme for edge detection, we sample the
(complex) gradient of the image with the zero
crossing of the Laplacian of f(x). As a result we
obtain a set of one-pixel wide (complex) lines in
correspondence of the local gradient maxima, that
we call “complex edges”. Complex edges are
characterized point by point by their “strength”,
measured by the magnitude, and their “local
direction” orthogonal to the gradient direction,
indicated by the phase.
Using complex edges, corner points candidate as
good pivots for robust pattern localization are
simply found considering the sequence of phase
values along each complex edge segment. In fact,
in correspondence of any corner point the phase of
the complex edge abruptly changes.
Phase abrupt changes along complex edges are
very good corner point indicators, as shown in
fig.2. More interesting from our viewpoint, they
yield reliable pivots.

4. Example and conclusion
In fig.3 good candidate pivots selected using the
method described so far are evidenced on a sample
image. They serve as windows centers for isolating
details to be found on a image database. Let us
select one pivot (the circled one) and let us apply
the ML search algorithm on a given image
database. Moreover, let us restrict our attention to a
large image where the pattern actually exist (fig. 1).

Figure 2. Magnitude of complex edges and
superimposed corner points for the image
of fig.2.

Figure 3. Selection of a candidate pivot

The Newton-Raphson algorithm calculates point
by point the likelihood functional maximized with
respect to the orientation angle, which is a priori
unknown, forming a likelihood map. The searched
detail is consequently localized in correspondence
of the maximum of the likelihood map. The
effectiveness of this process is shown in fig. 4
where such a likelihood map is displayed and in fig.
5 where the interested zone is zoomed.
In conclusion, the procedure described here
provides interesting means for selecting significant
details in a sample image and for finding such
details anyway oriented in a image database. Let us
remark that this procedure is not a rotation invariant
pattern finder, because it provides orientation
estimate too.

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

Figure 4. Likelihood map of the image of
fig. 3

References
[1] A.Neri, G.Jacovitti, “Maximum Likelihood
Localization of 2-D Pattern in the Gauss-Laguerre
Transform Domain: Theoretic Framework and
Preliminary Results” IEEE Trans. on Image Processing,
January 2004 Vol.13, N.1, pp.72-86.
[2] G. Jacovitti, A. Neri, "Multiresolution circular
harmonic decomposition", IEEE Trans. on Signal
Processing, Vol. 48. No. 11, pp.3242-3247, November
2000.
[3] T. Lindeberg “ Scale-Space theory: A basic tool for
analyzing structures at different scales” J. Appl. Stat. Vol
21, no.2, pp.225-270, 1994.
[4] D.C. Marr, E.Hildret, “Theory of edge detection”,
Proc. Roy. Soc. London, vol.B, pp.187-217, 1980.

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

Figure 5. Zoomed likelihood map


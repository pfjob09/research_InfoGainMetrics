Imaging Panel Skew Correction and Auto-focusing
in Radiotherapy Cone Beam Imaging
Amer Ali, Sykes Jonathan and Moore Christopher
Developing Technologies-Radiotherapy, North Western Medical Physics,
Christie Hospital, Manchester, United Kingdom
{Ali.Amer@physics.cr.man.ac.uk, Jonathan.Sykes@physics.cr.man.ac.uk,
Chris.Moore@physics.cr.man.ac.uk}
Abstract
Digital transducers, notably amorphous Silicon
panels, are being used in image guided radiotherapy.
Using kilo-voltage X-ray sources panel transducers are
providing cone beam volume reconstruction. Theoretical
considerations show that even sub-degree skew can result
in the wandering of projection points across many
detector elements to produce serious blurring of the cone
beam reconstruction away from the imaging isocentre.
The importance of identifying and correcting transducer
skew is highlighted and shown to be of potentially greater
importance than mechanical flex. Radiographic imaging
of a suspended radio-opaque test object is described for
direct characterisation of skew. The results of skew
correction by image processing are presented. The use of
‘auto-focusing’ grey level change detection algorithms in
cone beam reconstruction images, following programmed
incremental angular transformation of the projection
profiles of a ‘Rando’ anthropomorphic phantom, is
shown to have the potential for automating skew
correction.

projections at different angles at kilovoltage energies,
which have then been used as the primary data input to
established filtered back projection techniques for volume
imaging. Circular trajectory approximations to cone beam
volume reconstruction, such as the Feldkamp algorithm
[2] now well established in non-destructive testing, and
their potential in radiotherapy have been investigated by
Jaffray et al [3].

1. Introduction
X-ray imaging is being revolutionised by the
development of wide field image transducers. Initially
these have been digital extensions of image intensifier
technology but this modality is giving way to large, high
resolution, flat panel imagers based on amorphous silicon
technology. The most recent application of these
technologies is in image guided radiotherapy where
compound panel transducers have been investigated for
portal imaging at mega-voltage X-ray energies, as
typified by the work of Antonuk et al [1]. More recently,
such transducers have been used to gather image

Figure-1
The Elekta Synergy treatment accelerator
showing the gantry mounted kilovoltage Xray tube and amorphous Silicon imaging
panel firing horizontally. Gantry rotation
can be synchronised with X-ray imaging to
produce image profile sequences suitable
for cone beam volume reconstruction.
Most recently cone beam volume imaging of patient
bony and soft tissue anatomies has been reported in the
treatment room itself using an Elekta Synergy linear

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

accelerator at the Christie Hospital [4]. Synergy has an
integral kilo-voltage X-ray tube and opposed panel
imager mounted on the treatment machine gantry,
orthogonal to the treatment head and iViewGT portal
imager. The system can execute synchronised rotations
and incremental fluoroscopic imaging that is suitable for
cone beam imaging. Given the free standing mass of a
radiotherapy treatment machine with the additional
weight of the kilo-voltage X-ray tube and panel
transducer supports, an important component of
radiotherapy cone beam imaging is the quantification and
correction of mechanical perturbations to the circular
scanning trajectory described by the X-ray source and the
flat panel image transducer. This so called ‘flex mapping’
is an extension of conventional CT calibration using the
projections of a high contrast test pin. A common method
is to take multiple image projections from different angles
of a ball-bearing carefully positioned at the isocentre. The
projections are used to measure and subsequently correct
for minute shifts in the positions of the source and
transducer relative to the isocentre that defines the
nominally constant radial trajectory. Without flex-map
calibration reconstructed image quality is sub-optimal,
often because of a one or two detector element
perturbation in the plane of the image transducer.
In this paper we identify an additional calibration
component, which can have much larger effects on image
quality than those corrected by flex mapping. This is subdegree skew or rotational misalignment of the image
transducer panel and its discrete, detector element array
relative to the vector defined by the scanning rotation
axis. In the presence of even small scale skew multidetector element shifts of point projections become the
norm. If this effect is not corrected prior to cone beam
image profile acquisition there is rapid image degradation
in the reconstructed volume as one moves away from the
isocentre.
Here it is shown that correcting even sub-degree
skew produces significant improvements to reconstructed
cone beam image quality. A phantom based approach for
panel skew correction is described along with an
automatic cone beam image processing alternative.

2. Theory
In circular trajectory cone beam imaging the ideal
scanning geometry can be characterised as the
maintenance of diametrically opposed source and
transducer positions at fixed primary radial distances
from an unchanging, common isocentre. Mechanical
perturbations cause minor deviations from this ideal
geometry but they are practically significant given the
small physical size of the discrete detector elements in

modern high resolution panel imagers. Slight flexing can
shift the fluoroscopic X-ray images of a rigid object
during imaging to produce a set of inconsistent image
profiles for filtered back projection. The projections of a
ball-bearing placed at isocentre will reveal the degree of
flexing, at least in the plane of the central axis of the
imaging system. Usually measured flexing causes
projection shifts of one or two detector elements, is at
least superficially periodic and has been found to be
reproducible enough to be useful for image projection
correction prior to cone beam reconstruction [3].

Figure-2
Radiographic image of suspended steel
ruler showing panel skew. The image is
cropped, the aspect ratio changed and a
dashed-line graphical box overlaid to
help the reader appreciate the level of
panel rotation, which is 0.57 degrees.
Conventional isocentric flex-mapping is not able to
reveal rotations in the image transducer plane, which has
its surface-normal lying along the scanning radius. The
introduction of additional ball bearings at extended
positions could be used to identify panel shifts and
rotation from the sequential projection images of an XVI
scan. However, such an approach has the potential to
compound experimental errors in the sub-millimetre
positioning of small test objects in the treatment room
frame of reference. In principle transducer panel skew
may itself be perturbed by mechanical flex as the support
gantry rotates. However, this is likely to be no more than
a small second order effect.
It is easy to create, position and assess a radioopaque, straight edge, hanging freely under gravity for

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

image panel rotation investigations. A small angle
imaging panel rotation, dTѽҏ about the panel centre, will
shift a point on the projected edge at radial distance r
from the centre of panel, by r.dT.p detector elements,
where p is the nominal linear size of the detector element.
For most panel detection elements r>>p, typically by two
to three orders or magnitude. Consider a 1000x1000
detector element imaging panel where the detector
elements have unit aspect ratio. Moving 100 elements
from the centre of the panel, the angle subtended by a
detector element is approximately 36 minutes of arc. For
element 500 it is just 6.9 minutes of arc. Hence, dT need
only be a fraction of a degree to produce significant
perturbations across the majority of imaging points, even
at short distances from the centre of the panel.
Cone beam reconstruction optimisation using image
processing is an alternative to radio-opaque edge analysis.
Consider a reconstruction that is not corrected for skew.
It will be blurred at image points removed from the
isocentre. Where unknown skew is the cause of this
blurring a simple auto-focusing algorithm can be used to
establish the necessary skew correction. One of the
simplest auto-focusing approaches is to subtract the mean
grey level value from the image field of view and then
evaluates the mean modulus [5]. Deblurring increases the
mean modulus and the variance of the image. Starting
with an uncorrected image profile sequence and
performing cone beam reconstructions at equi-angular
increments, moving towards and beyond the estimated
correction angle, it should be possible to identify the
optimum correction based on the maximisation of the
mean modulus and variance. Such an approach has the
potential to become an automated correction for skew
whose ‘off-line’ implementation minimises disruption to
the clinical use of a clinical system. It offers the basis for
regular quality assurance testing.

3. Methods
Verification testing of the Synergy system is a
meticulous process that includes examination of the
kilovoltage X-ray imaging panel. When being prepared
for use an electric motor unfolds the panel from its
stowed position against the treatment machine gantry
cover. The panel is then progressively extended and
finally offset to a predefined position. Prior to the final
offset grooves on the perimeter of the imaging panel can
be used to check the panel position using the treatment
room laser setup lines. Offsetting the panel results in a
displacement between the laser line and grooves, which
must be calibrated according to the manufacturer’s
specifications. In this process it was noticed that the laser
line spanning the panel was skewed with respect to the

grooves. Since the laser was known to be horizontal the
imaging panel was fractionally rotated.
A heavy engineering quality steel ruler was
suspended on a thin rod through a hole drilled at one end.
It was then placed between the Synergy kilo-voltage Xray source and imaging panel to produce an accurate,
vertical, high contrast parallel edge phantom. The
suspended ruler was imaged using a left-right lateral and
then a right-left lateral radiographic image exposure of
120kVp, 25mA and pulse duration 25ms. The field of
view was 41cm x 41cm and the image 512 x 512 pixels.
The continuous vertical edge projections in the
radiographic image were analysed for skew. Visible
aliasing along the edge projections of the ruler directly
indicated the panel rotation in terms of detector element
shift at any point across the field of view. Given that the
ruler extended across the field of view it was a simple
matter to determine both the centre of rotation and the
magnitude of the skew. Applying a corrective rotation
transform in software based on these measurements
produced a ruler image with edges that were free from
aliasing effects. To avoid processing artefacts the image
profiles were re-binned to a 2560 x 2560 using cubic
interpolation prior to rotation, then restored to a 512 x
512 matrix ready for cone beam reconstruction.
Fluoroscopic profiles of a Rando phantom were then
taken using 120kVp, 25mA and 25ms pulses, in a 360
degree cone beam scanning protocol. This produced one
image profile per degree of rotation. Imaging was centred
on the abdominal section of a Rando phantom array of
internal dosimetry holes at this site. From the primary set
of fluoroscopic profiles a secondary set of skew corrected
profiles was created by software rotation transformation.
Both uncorrected and skew corrected profile data were
then submitted to the cone-beam reconstruction facility to
produce two volume image sets for comparison.
Reconstruction was performed to a 256-cubed matrix.
Skew correction was also applied in small equiangular
increments of 0.2 degrees. At each increment the mean
modulus and variance of reconstruction image data was
calculated and the change plotted in order to identify a
maximum, optimised skew correction.
All experiments were performed on an Elekta
Synergy megavoltage treatment machine equipped with
an integral iViewGT high energy imaging system and Xray Volume Imaging (XVI) system (Figure-1). The
imaging systems incorporates a Perkin Elmer RID16401,048,576 amorphous Silicon panel, which can provide
1024 x 1024 pixel images from a maximum rectangular
transducer area of 41cm x 41cm array at 3 Hz. The panel
is 53.6cms from the Synergy isocentre, which in turn is
1metre from the X-ray source.

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

Figure-3
Axial reconstruction some distance from the isocentric plane, without (upper left) and
with (upper middle) skew correction, then subtracted (upper right) with exaggerated grey
scale. Zoomed contrast detail before (lower left) and after (lower right).

Figure-4
Axial reconstruction in the isocentric plane, without (upper left) and with (upper middle)
skew correction, then subtracted (upper right) with exaggerated grey scale. Zoomed
contrast detail before (lower left) and after (lower right), showing only subtle changes.

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

3. Results

240
235
M e a n M o d u lu s

The XVI system allows users to acquire a set of
fluoroscopic profiles, correct them for bad pixels, offset
(dark field), gain (flood field) and flex. The corrected
profiles are then used as input profiles for cone-beam
reconstruction using the Feldkamp algorithm. All external
image handling and correction software was written using
the Interactive Data Language from Research Systems UK
and executed on a standard PC.

230
225
220
215
210
0

0.2

0.4

0.6

0.8

1

0.8

1

Skew Increment (Degrees)

100
98
S ta n d ard D e v ia tio n

Figure-2 shows a radiographic image of the steel
engineering ruler suspended vertically between the
laterally opposed X-ray source and amorphous Silicon
panel imager. The air gaps either side of the ruler have
been cropped, the aspect ratio changed and a dashed line
graphical box added to make the small angle tilt of the
ruler visible to the reader. Repeated measurements showed
an image panel rotation of 0.57 degrees (34 seconds of
arc). This equates to a shift of approximately 5 panel
detector elements moving from the centre of the panel to
the outer edges. For a scanning sequence, a point profile
displacement will range across approximately 10 panel
detector elements. The same skew was measured for both
left-right and right-left imaging positions indicating no
gantry angle dependence due to mechanical flex in the
treatment machine gantry.
Figure-3 shows the effect on image quality for a
transaxial section of the Rando anthropomorphic test
phantom located on the edge of the volume acquisition,
some distance from the isocentric plane. An image is
shown before (upper left) and after (upper middle) skew
correction. Subtracting the two images and exaggerating
the grey scale shows that skew affects the entire field of
view (upper right). Zoomed inspection of bony and soft
tissue detail around the spine before (lower left) and after
(lower right) correction amplifies the change of detail.
Figure-4 shows the effect on image quality for a
transaxial section of Rando located on the scanning
isocentre before (upper left) and after (upper middle) skew
correction. Once again, subtracting the two images (upper
right) shows that skew correction primarily affects the
periphery of the image, though in this imaging plane the
changes are primarily subtle improvements to contrast..
Figure-5 shows a point plot of the change in cone
beam, whole image data mean-modulus (top), and
square root of variance or standard deviation (bottom), for
incremental skew correction via ‘auto-focusing’. The
corresponding second order polynomial trend lines are
included. The trend line maxima indicate the optimum
skew correction, which, at an estimated 0.6 degrees,
agrees well with the 0.57 degrees determined from
radiographic imaging of the radio-opaque ruler.

96
94
92
90
88
0

0.2

0.4

0.6

Skew Increment (Degrees)

Figure-5
Plot of the cone beam, whole image data
mean modulus (top) and standard deviation
(bottom) for incremental angular correction
of panel skew using reconstructions from a
Rando phantom. Note the maxima indicate a
skew correction of 0.60 degrees is required
(cf. 0.57 degrees from radiographic edge
image analysis.

4. Conclusions
Until now, small angle imaging transducer skew has
escaped early identification for good reasons. The TuySmith condition [6,7] states that for cone beam
reconstruction all planes should intersect the scanned
object and source trajectory at least once. Most
approximations to true cone beam imaging are based on
circular scanning trajectories and as such exclude
complete sampling of the Radon integrals for a number of
planar intersections within the object of interest. In this
case it is most obviously for missing planes orientated

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

head to foot. These integrals form missing points over the
poles of what should be a complete ‘Radon sphere’.
Consequently, reconstruction using a Feldkamp cone
beam algorithm and circular rather than spherical scanning
trajectory is theoretically exact only for the iso-centric
trans-axial plane [8]. Therefore, for real objects with
inhomogeneities one expects increased blurring of image
detail as one moves away from the isocentre along the
scanning axis.
The expectation of degraded resolution away from the
isocentre, coupled with a conventional focus on the effects
of mechanical flex, delayed identification of the important
consequences of transducer panel skew. Even if it is of
minute proportions such skew has the potential to severely
compromise cone beam image quality. Left uncorrected it
can invalidate contrast detail and resolution measurements
throughout much of the reconstructed image volume. This
will be true for any digital image transducer used for cone
beam imaging, since it is the regular discretisation of the
of detection process itself that imparts sensitivity to skew.
Testing for transducer skew should become an
integral part of cone beam quality assurance. This can be
based on radiographic imaging of a suitable radio-opaque
edge. It has also been shown that it is possible to automate
the skew correction process using simple ‘auto-focusing’
algorithms that maximise the mean modulus and variance
of grey level values in cone beam images themselves.
This algorithms are implemented ‘off-line’ and have the
potential to form the basis of minimally disruptive cone
beam image quality analysis in the clinic.
Once detected, the solutions to wide field digital
image transducer skew are simple. Either a software
manipulation of the fluoroscopic profiles, as reported in
this paper or incorporated into the cone beam
reconstruction algorithm, or a mechanical adjustment to
panel orientation will suffice.
Radiotherapy applications of X-ray volume imaging
are focused on quantitative analysis, measurement of
feature sizes, shapes and locations etc, which largely
depend on reducing image data to edge or boundary
information. In the near future this is likely to extend to
grey level integrity. Hence the importance or correcting
for skew across the image volume by cannot be over
stated.

Acknowledgements
This work was supported in part by Elekta Oncology
Systems, Crawley, United Kingdom.

References
[1]

[2]
[3]

[4]

[5]

[6]

[7]

[8]

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

Antonuk L E, El-Mohri Y, Huang W, Jee K W,
Siewerdsen J H, Maolinbay M, Scarpine V E, Sandler H,
Yorkston J, ‘Initial performance evaluation of an indirectdetection, active matrix flat-panel imager (AMFPI)
prototype for megavoltage imaging’,
International
Journal of Radiation Oncology Biology Physics. 42(2)
437-54. 1998
Feldkamp L A, Davis L C and Kreiss J W, ‘Practical Cone
Beam Algorithm’, Jnl Opt Soc Am, 612-619. 1984.
Jaffray D A, Siewerdsen J H, Wong J W and Martinez A
A, ‘Flat-panel cone-beam computed tomography for
image-guided radiation therapy’, International Journal of
Radiation Oncology Biology Physics, 53(5) 1337-49.
2002.
Williams P C, ‘Image Guided Radiotherapy – The Next
Logical Step in Conformal Radiotherapy’, Radiotherapy
and Oncology, 64 Supplement-1, S27. 2002.
Chem N N K, Neow P A and Ang M H, ‘Practical Issues
in Pixel Based Autofocussing for Machine Vision’,
Proceedings IEEE Conference on
Robotics and
Automation, Seoul Korea, 2791-2796, May 21-26. 2001.
Smith B D, ‘Image reconstruction from cone-beam
projections: necessary and sufficient conditions and
reconstruction methods’, IEEE Transactions Medical
Imaging, 4, 14-25. 1985.
Tuy H K, ‘An inversion formula for cone-beam
reconstruction’. SIAM Jnl Applied Mathematics, 43, 546552. 1983
Turbell H, ‘Cone Beam Reconstruction using Filtered
Back Projection’, Linköping Studies in Science and
Technology. Dissertation No 672. 2001.


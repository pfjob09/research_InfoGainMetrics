Automatic 2-D Gel Registration Using Distance
Minimisation of Image Morphing
Bruno Josso*t, Egor Zindy*t and Hatice Aldemir**
* Coherent and Electro-optics Research Group, John Moores University, Liverpool UK
** Department of Biochemistry,Faculty of Medicine, Gazi University, Ankara, Turkey
tThe authors have taken an equal part in this project
E-mail: Zindy@iname.comor B.J.JossoQlivjm.ac.uk

Abstract

Comparison of a set of 2-D PAGE gels relies on detecting differences in protein spots both qualitatively
and quantitatively. Given that one cannot obtain conipletely overlapping gel patterns, need for image processing techniques starts to emerge. These differences
come from the experimental conditions which vary randomly by a small amount when gels are run under the
same conditions but can be quite large when gels are
run under different conditions or come from different
laboratories. By using an appropriate warping, these
differences may be minimised to facilitate a side by side
gel comparison.

The necessity of applying image processing techniques to
gel electrophoresis images is starting to appear. In particular, registering two gels for comparison purposes has
emerged from the increasing popularity of gel databases
distributed across the Internet. Current registration
techniques are however cumbersome in the sense that
they require user intervention for placing landmarks on
both gels in order t o define a mapping function. Current
techniques also cannot account for distortions which are
common to 2-D gels and non-reproducible by nature.
Thus, the only method of choice is t o make a side-byside comparison of the gels. In this paper we propose an
automatic registration method especially designed with
electrophoresis gels in mind to give an optimal registration while still allowing human input. We think that
an automated registration of 2-D gels, because of its
non-intrusive nature, will lead to a wider acceptance of
image vision technology in electrophoresis gel software.
Potentially, other types of biomedical images could benefit from the technique.

1.

As well as commercial software many gel analysis
systems have been developed in research environments
[6],[7], [8], [9]. The main problem with existing software is that they rely on heavy operator intervention to
transform different gels into overlapping ones. Therefore analysis of the same data by two operators or by
the same operator at different times may give different results. In this paper we describe a simple image
processing algorithm that achieves automatic 2-D gcl
image registration.

As an example, gels from the 2-D PAGE database
[12] were used. In particular gels 6A and 6C have been
selected (see figure 1).

Introduction

“Proteomics” is the large-scale screening of the pro.teins of a cell, organism or biological fluid. This process
requires stringently controlled steps of sample preparation] two-dimensional (2-D) electrophoresis, image detection and analysis, spot identification, and database
searches [l].Since protein analysis is crucial for any life
scientist, the number of reports on each step have increased during the last two decades [2], [3], [4]. The 2-D
gel electrophoresis (2-D PAGE) technique, core technology for proteomics, has been widely applied due t o its
high resolution and sensitivity [5]. At the image detection and analysis step, evaluation of two gels by simple
comparison is not always possible. On gels containing
thousands of spots, it may be impossible to detect the
appearance or disappearance of some spots.

2. The algorithm
It minimises the Euclidean distance between the two
images weighted by their common support. When one
of the images is warped, the distance between the two
changes. This distance] fed back into a down-hill simplex minimisation process, controls the morph. The
downhill simplex tends to maximise the overlap between both images. This process is stopped when a
predefined minimum distance is reached.
Here, “warping”refers t o a spatial transformation defined by a displacement field. “Morphing”on the other
hand represents a continuous series of warps. That is,

357
0-7695-0743-3100$10.00 0 2000 IEEE

The main differences between the two steps are first
the choice of the displacement field and then the degree
of freedom of each point in the field.
2.1

Phase 1

The retained solution for the first phase was to take

a grid of landmarks distributed vertically and horizontally along the edges of the image. Hence, a set of N
landmarks Pi,iE [l,NI is available to define the warp.
Because the image is assumed to be centered, the N
landmarks of the frame are both real and distributed
around the centre of the image (i.e. Pi E Et2). Different
operators are then applied to the frame.
They are namely a translation operator TI.] and its
parameters (Az,Ay), a rotation operator R[.]with its
[ a scaling parameter S[.] with
parameter 0 E [ 0 , 2 ~and
its parameter a E .+@I
Hence, if Pi(z,y)is a point in
this field, the transforms applied t o Pi are the following:

Each point Pi(z,y) of the frame is transformed by
,
and S[.]:
applying successively T [ . ] R[.]

ToRoS

Fig. 1.

The gels used for comparison: Gel 6A and gel

6C

This defines a displacement field between old and new
frame which is then used as the warp support.

the displacement of any pixels between two consecutive
frames in a morphing sequence should not be greater
than a distance E .

2.2

The algorithm itself may be split into two different
phases.

Phase 2

The second phase relies on a detection of the main
peaks of the 2-D gel image to be warped. Each point
of this new set can move independently but only by a
limited amount in order t o keep meaningful gel images.
The second phase fine-tunes the overlap achieved in the
first phase of the algorithm.

During the first phase, experimental setting errors
are corrected at a global scale. In the second phase, a
peak adjustment is applied t o the first solution. This
accounts for image differences at a more local scale.

358

2.3

Warping

Warping is a well-known technique for introducing
distortions in images [lo]. It is derived both from computer graphics where it is used for designing special
effects and from digital imaging for which distortions
introduced by sensors are compensated for. Usually,
warping depends on a mapping function often defined
from corresponding landmarks between input and output images. For 2-D gels, these landmarks are centered
on spots that can be identified on both gel images.
With conventional methods, these landmarks have
to be placed by hand. This is a difficult process as
landmarks only represent the mapping function, but
the operator has to picture the resulting warped image
in their mind. In our case, landmarks are just a set of
points defining the field previously described. Hence,
the principle of the registration process is to keep one
2-D gel image as a reference and to warp the second
one using the transforms mentioned before.
2.4

Examples

Fig. 2.
Straightforward subtraction image BA minus
image 6C (black spots belong to 6 A , white spots 1 0
6C)

Two gels which were obtained from an online
database [12] were compared. By looking a t figure 1, it
is not c a y to spot differences between the two. These
differences may appear either as displaced dots or as
dots which intensity and shape has changed.
Figure 2 shows the result of a straightforward subtraction. It clearly indicatcs that a simple difference of
the two images is not exploitable.
Figure 3 on the other hand, shows the subtraction of
the gels images after a rcgistration by the first stage of
our algorithm. At this stage, only global deformations
arc introduced.
When both global arid local deformations are applied to the image (see figure 4), the subtraction clearly
indicates gcl deviations either as black or white dots
nhereas similar features completely disappear in the
grey background.

3.

The graphical interface

It was written for a standard desktop coniputer using
the prototyping language IDL and designed to show the
two gels to compare, side by side. Comparison is facilitated by the fact that the gels are correctly registered
(see figure 7).

Fig. 3. Difference between image 6A and warped image
6C after stage 1 (registration is optimised on a global
scale)

A magnifying glass shows the region of interest, either
as a zoomed image or as a 3-D depth map that can be

359

Fig. 4. Difference between image 6A and warped image
6C after stage 2 (registration is optimised on a more
local scale)

used to estimate proteins quantitatively. The easiest
way to choose an interesting region is to start the search
on the “dierence” image (see figure 5 ) , and then to
“lock” the view on it. The view mode may then be
swapped to show any of the ‘%oomed”, “depth map’’
(see figure 6) or “warped” image.

-.-.I

4.

Conclusion

The aim of this study was to design an autoniated
registration algorithm suitable for 2-D electrophoresis
gel analysis. The algorithm itself implements an image
rnorphing process, controlled by distance minimisation.
A first step transforms the image to compare on a global
scale, whereas the second step refines the transformation on a more local scale.
Automatic registration effectively hides the complexity of having to match similar features by hand by

carefully placing landmarks on the different gel images.
Nonetheless, in the second stage of the algorithms, such
landmarks are used internally and if need be, new landmarks can be added manually.
Once the 2-D gel images have been correctly registered, they may be post processed symmetrically by
measuring for instance the comparative quantity of proteins, their locations, the common proteins, the protein
displacements and so on. This method offers a new

Fig. 6. The two gels are shown side by side, and a depth
map of the previous region of interest is shown t o
illustrate the comparative size of the central spots.

3 60

[3] P. Halloway, P. Arundel
High-resolution twodimensional electrophoresis of plant proteins, Anal.
Biochem. 172, 8-15, 1998.
[4] M. J. Dunn, J. M. Corbett 2-dimensional polyacrylamide gel electrophoresis, Methods Enzymol. (ed
BL Karger and WS Hancock), Academic press, Orlando, 177-203
[5] A. Gorg, W. Postel, S. Gunther The current state
of two-dimensional electrophoresis with immobilised
pH gradients, Electrophoresis 9, 531-546, 1988.
[6] L. E. Lipkin, P. F. Lemkin Data base techniques
for multiple PAGE (2-D gel) analysis, Clin. Chem.
26, 1403-1413, 1980.
[7] P. F. Lemkin, E. P. Lester Database and Search
Techniques for 2-D Gel Protein Data: A Comparison of Paradigms For Exploratory Data Analysis and Prospects for Biological Modeling, Electrophoresis 10, 122-140, 1989.
[8] R. D. Appel, D. F. Hoscstrasser, M. Funk, J. R.
Vargas, C. Pellegrini, A. F. Muller, J.-R. Scherrer
The MELANIE project - From a Biopsy to Automatic Protein Map Interpretation by Computer,
Electrophoresis 12, 722-735, 1991.
[9] P. F. Lemkin Comparing two-dimensional electrophoretic gel images across the Internet, Electrophoresis 18, 461-470, 1997.
[lo] G. Wolberg Digital Image Warping, IEEE Computer Society Press Monograph, 1990.
[ll] J. A. Nelder, R. Mead. A simplex method for function minimization, Computer Journal, Vol 7 , pp
308-313, 1965.
[12] N. Hole
2-D PAGE (embryonal stem cells
http://www.dur.ac.uk/-dblOnhl/
database),

field of investigation for the specialist by giving stable,
reliable and quantitative results.

Fig. 7. The graphical interface

Acknowledgments
The authors would like to acknowledge their use of Dr
Nicholas Hole’s 2-D gel database located at University
of Durham. The web address of the database is given
in [12]

References
T. Berkelman and T. Stenstedt, 2-D Electrophoresis, Amersham Pharmacia Biotech Inc., 1998.
D. L. Wilson, M. E. Hall, G. C. Stone, R. W. Rubin Some improvements in two-dimensional gel electrophoresis of proteins, Anal. Biochem. 83, 33-44,
1997.

2-DPAGE/

36 1


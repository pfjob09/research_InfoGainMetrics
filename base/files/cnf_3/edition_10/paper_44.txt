Design and Reconstruction of Fractal Surfaces
E. Tosan, E. Gu´erin and A. Baskurt
LIGIM - EA 1899 - Computer Graphics, Image and Modeling Laboratory
Claude Bernard University, Lyon, France
Bˆat. 710 - 43, bd du 11 novembre 1918 - 69622 Villeurbanne Cedex
Tel.: (33) 4.72.44.58.85 - Fax : (33) 4.72.43.13.12
E-mail: [etjeguerinjabaskurt]@ligim.univ-lyon1.fr

Abstract

2

Model

2.1
A method for the design and reconstruction of rough surfaces is introduced. A fractal model based on projected IFS
attractors allows the definition of free form fractal shapes
controled with a set of points. This flexible model has good
fitting properties for recovering surfaces. The approximation
is formulated as a non-linear fitting problem and resolved
using a modified L EVENBERG -M ARQUARDT minimisation
method. The main applications are shape design, shape reconstruction and geometric data compression.

1

IFS

Introduced by BARNSLEY[1] in 1988, the IFS (Iterated
Function Systems) model generates a geometrical shape with
an iterative process. An IFS-based modeling system is defined by a triple (X d S ) where:

(X d) is a complete metric space,

S

is a semigroup acting on points of X such that:
2 X 7! T 2 X where T is a contractive operator.
An IFS T is a finite subset of S : T = fT0 ::: TN ;1g with
operators Ti 2 S . We note H(X ) the set of non-empty compacts of X . The associated H UTCHINSON operator is:
K 2 H(X ) 7! TK = T0 K ::: TN ;1 K :

Introduction

This operator is contractive in the complete metric space
(H(X ) dH ), where dH is the H AUSDORFF distance assoModels that are capable of producing rough surfaces are ciated to d. Then it admits a fixed point, called attractor:
mostly based on random processes. This is the reason why
nK with K 2 H(X ) :
they are not suitable for geometric design or approximation.
A( ) = nlim
!1
In order to propose an efficient solution to this problem, the
current study presents a parametric model based on a deter2.2 Parameterisation of attractors
ministic fractal approach.
In [16] and [17], we have suggested a model for frac- By introducing a finite set , the IFS can be indexed T =
tal curves and surfaces. This model combines two classical (Ti )i2 and !the attractor A( ) has an address function [1]
, the set of infinite words of :
models: a fractal model (IFS attractors) and a CAGD model defined on

T

T

T

2

(free form shapes). This model is called projected IFS attractors. A set of control points allows an easy and flexible
control of the fractal shape generated by the IFS model and
provides a high quality fitting, even for surfaces with sharp
transitions. In [3] and [4], we have proposed an approximation method for curves based on this model. In [5, 6], we
extend this method to surfaces.

! 7!

( ) = nlim
!1 T 1 :::T

n

2X

(1)

When operators match a joining condition [16, 17, 12],
this function defines parameterised curves or surfaces. For
curves, a single index system ~ = f0 ::: N ; 1g is sufficient [10]:

1 1
X
(s) = ( ) with s = N i
i=1

In this paper, we present a formulation of surface design
and some reconstruction results.
1

Proceedings of the Sixth International Conference on Information Visualisation (IV’02)
1093-9547/02 $17.00 © 2002 IEEE

i

to use a barycentric metric space : X

BJ = f( j )j 2J j

X

= BJ :

j 2J

j

= 1g :

For curves, this barycentric space is used with J~ =
f0 : : : mg, for surfaces with J = f0 : : : mg
f0 : : : mg. Then, the iteration semigroup is constituted of
matrices with barycentric columns:

SJ = fT j

X
j 2J

Tij = 1 8i 2 J g :

This choice leads to the generalization of IFS attractors named projected IFS attractors:

P A(T) = fP j 2 A(T)g
P
where P = (pj )j 2J and P = j 2J j pj . In this way, we

can construct a fractal function [16, 17] using the projection:

F(s t) = P (s t) =
where
(s t) is a vector
( j (s t))j 2J and J is the
f0 : : : mg f0 : : : mg.

3
Figure 1: Patch with corresponding boundary curves.
where
= 1 : : : n : : : corresponds to the development
of the scalar s in base N . For surfaces, it is more convenient to use a double index system = f0 : : : N ; 1g
f0 : : : N ; 1g [9]:

(s t) = ( ) with = ( 1 1) : : :( n n) : : : 2

!

where = 1 : : : n : : : and = 1 : : : n : : : are, respectively, the development of s and t in base N .

X
j 2J

j (s

t)pj

of functions
(s
double index set

t) =
J =

Curves design

A binary IFS T = (T0 T1) describes a parametric curve if
the joining condition is verified [10] [14] [17] :

T0 c1 = T1 c0 with T0 c0 = c0 T1c1 = c1 :
(2)
The matrices T0 T1 which compose IFS generalise the

subdivision matrices of D E C ASTELJAU algorithm [14].
Classic free form curves (B E´ ZIER, B-spline, ...) are particular cases of subdivision curves.

3.1

Interpolation

Curve endpoints are fixed points of T0 and T1 : (0) =
(0! ) = c0 (1) = (1! ) = c1 ; joining point
T0 c1 = T1 c0 correspond to double binary developpement
The main idea of our model is drawn from the formula of of 1 : ( 1 ) = (01! ) = T c
0 1 ( 21 ) = (10! ) = T1c0 .
2
2
free form surfaces used in CAGD [16, 17] :
Given a triple of points (c0 qr c1), the joining condition
X
(2) on T is equivalent to an interpolation constraint on :

2.3

Projected attractors

F(s t) =

j 2J

j (s

t)pj

T0 c0 = c0

8
= c0
T0 c1 = qr , < (0)
1 ) = qr
(
2
T1 c1 = c1:
: (1)
= c1 :

T1 c0 = qr
where pj constitutes a grid of control points and
are
blending
functions
such
that:
8
(s
t)
2
j
P
0 1]2 j 2J j (s t) = 1.
This property is the base of the classical construction of fracThe way to obtain the same property for IFS attractors is tal curves in the plane. Operators Ti are taken in particular

Proceedings of the Sixth International Conference on Information Visualisation (IV’02)
1093-9547/02 $17.00 © 2002 IEEE

affine semigroups : similitudes [11] [13], shearings [1] [7] or
dilatations [2].

4

Surfaces representation

A joining condition must apply to the IFS to be sure the genIn the general affine case, interpolation points are not suferated attractor is a surface.
ficients for describe a fractal curve. Extra parameters allow
Classically, this joining condition is obtained by tensor
to modulate curve aspects (rugosity, sharp transitions,...).
products of curves. This method, often used in CAGD, can
be extended to IFS-defined surfaces. Therefore, it can be
applied to the modeling of fractal surfaces [9, 8, 16, 17].
~ v (t) is defined by IFS
The function (s t) = ~ u (s)
u
v
~
~
Ti j = Ti Tj .
However, the fractal family of IFS-defined surfaces is
much wider.

(a)

u

(b)
0 1

1 1

v

(c)

v

0 0

(d)

1 0
u
u

u

(e)

(f)

v

v

Figure 2: Fractal curves types.

v

0 1

u
v

v

u

u

u

u

0 0

v

v

u

3.2

1 1

1 0

v

v

v

u
u

Aspect control

Figure 3: Subdivision scheme: boundaries and joinings.
The aspect of fractal curve depends of endpoints and joining point aspect. Corresponding patterns are duplicates with
different scales along the curve. Endpoint aspect depends
on the eigenvalues type of linear operators L0 L1 associated
with affine operators T0 T1.
Operators with real eigenvalues are conjugated dilatations.
Corresponding endpoints tend to be aligned along a given
direction (a “half-tangent”). An angle composed of two
transformed half-tangents (L0 ~
u1 L1~u0) appears at the joining point (figures 2b, 2c, 2d ). In particular cases, like the
parabola, the two half-tangents are aligned (figure 2a).
Operators with complex eigenvalues are conjugated similitudes. Corresponding endpoints have a spiral movement
(right of figure 2e, left and right of figure 2f).

4.1

Joining condition

The joining condition of the quadrangular patch is drawn
from the structure of 0 1]2 (see fig. 3).
Boundary curves
(s 0) u(s) =
u(s) =
(s 1) v (s) = (0 s) v (s) = (1 s) are defined
by IFS T extracted from patch IFS Ti = T i with iu =
(i 0) iu = (i N ; 1) iv = (0 i) iv = (N ; 1 i) for
i = 0 ::: N ; 1. These boundary curves are drawn from the
corresponding address functions:

Proceedings of the Sixth International Conference on Information Visualisation (IV’02)
1093-9547/02 $17.00 © 2002 IEEE

(s) = ( ) = ( ( )) = ( 1 ::: n :::):

A necessary and sufficient condition for the function
:
(s t) 7! ( ) to be defined and to be continuous is that the
components Ti j of the address function join along their
borders Ti j [12] :

Ti j
Ti j

u(
v(

) = Ti j +1
) = Ti+1 j

u(
v(

However, embedding equations are expressed as restrictions
on grid boundaries:

T jv qv = qv T~jv , T jv qv e~l = qv T~jv e~l
, T0 j e0l = qv T~jv e~l
, 0 mj +l = qv ~vmj +l

)
)

This equation system may be expressed as linear constraints where ( ~v )k=0 :: mb is a set of points of BJ~ that characterise
k
on Ti j matrices.
curve ~ v .
The points mi mj are transformed patch corners

Ti j e00 = mi mj Ti j em0 = mi+m mj Ti j emm =
mi+m mj +m Ti j e0m = mi mj +m . If one takes N = m,
a pretty good choice would be mi mj = eij . Changing of
system coordinates R with Rekl = rkl allows to consider the

4.2 Constraints

Now, suppose that each patch boundary is the embedding of
a curve defined on a grid J~ = f0 ::: mg in the corresponding boundary of the patch control grid (see Fig. 1):
general case.
In the case N = m = 2 (3 3 control grid and 2 2
m
X
( ) = q ~ ( ) = ~k ( ) q e~k
(3) subdivision matrices) an IFS standard grid 5 5 can be defined. A patch is determined by wireframe skeleton comk=0
posed by bounding curves, joining lines and diagonal curves.
The embeddings associated with the grid boundaries are The standard grid is defined by three families of points :
defined by: qu e~k = ek 0 qu e~k = ek m qv e~k =
boundary points (dimension 2) : ~ u0 ~ u1 ~ v0 ~v1 which
e0 k qv e~k = em k for k = 0 :: m:
~ = (T~i )i=0 ::: N ;1 the IFS that defines
define boundary curves : u u v v ;
Let us denote T
~ ; then Ti j matrices must satisfy the following embedding
joining
points
(dimension
8)
:
constraints [12]:
f f g g which define joining curves :
0 1 0 1

=q ~

8
>
>
<
>
:

, T i q = q T~i for i = 0 :: N ; 1

The joining equations may be expressed as constraints on
Ti j and on boundary IFS T~ [12]:

Ti j v = Ti+1 j v , Ti j qv ~v = Ti+1 j qv ~v
, Ti j qv = Ti+1 j qv T~ v = T~ v :
~ u = T~ u (see Fig. 1).
The argument is also valid with T

f (s) =
0
f (s) =
1g
0g (s) =
1 (s) =

( 12 s 21 ) = T0 0 u (s) = T0 1 u(s)
( 12 + 12 s 21 ) = T1 0 u(s) = T1 1 u(s)
( 12 12 s) = T0 0 v (s) = T1 0 v (s)
( 12 12 + 21 s) = T0 1 v (s) = T1 1 v (s)

d d e e
diagonal points (dimension 8) :
0 1 0 1
which define, with other points, diagonal curves :
d (s) =
e (s) =

(s s)
(s ;s):

The general description admits 2 4 + 4 8 + 4 8 = 72
real parameters.
5 Surfaces design
Practically, the points are taken in subspaces corresponding to parts of the control grid [5] : k = q ~ k . Then a local
An IFS defined by N N matrices Ti j that satisfy the previpatch control is possible. If the points are defined in planes,
ous constraints is equivalent to a subdivision scheme characcorresponding curves are equally in planes (figure 4). If the
terised by a grid of points (see Fig. 3). In this way, the claspoints are defined in straightlines, corresponding curves are
sical process of point interpolation to build a fractal curve in
2 [1] has been extended to fractal surfaces in 3 [8, 7, 15]. segments or polylines. Surfaces possess sharp angles and
rock aspect (figure 1).
The proposed grid is composed of (mN +1) (mN +1)
points of BJ corresponding to matrices columns : Ti j ekl =
mi+k mj +l .
6 Surfaces reconstruction
The joining equations are satisfied:

R

R

Ti j qv = Ti+1 j qv , Ti j qu e~l = Ti+1 j qu e~l
, Ti j em l = Ti+1 j e0 l
, mi+m mj +l = m(i+1) mj +l

Q

R

Given a sampled surface (si tj ij ) 2 3, the challenge is
to determine the projected IFS model which provides a good
quality approximation of this surface. The approach is based
on a non-linear fitting formalism.

Proceedings of the Sixth International Conference on Information Visualisation (IV’02)
1093-9547/02 $17.00 © 2002 IEEE

The developments of Nip and Njp end with infinite sequences of 0: = 1 : : : p 0!
= 1 : : : p 0! : and:

( Nip Njp ) = (( 1 1 ) : : :( p p )(0 0)! )
= T 1 1 : : :T p p ((0 0)! )
= T 1 1 : : :T p p (0 0)
By choosing (0 0) = e00, the surface tabulation may be
generated computing only p iterations without any loss of
a

information:

Fa Ni p Nj p ) = Pa T 1 1 : : :T p p e00
So, for a fixed number p, the function a 7! Fa ( Nip Njp ) is
polynomial. Hence, so is the error function a 7! d(Q Fa).

Figure 4: Patch with diagonal arc; boundary arcs are
parabole and Takagi curve.

6.1

Non linear fitting

Q

Let ij (i=0 ::: N p j =0 ::: N p ) be a given surface to approximate. Considering the coefficients of the operators Ti and
the coordinates of the control grid P as elements of a parameter vector allows us to construct a family of functions Fa
defined by couples (Pa a).
The approximation problem consists in determining the
parameter vector that minimizes the distance between the
sampled surface = f( Nip Njp
ij )g and the function Fa :

a

T

a
Q
Q
aopt = argmin
d(Q Fa)
a

where:

d(Q Fa ) =

X
ij

jjQij ; Fa ( Ni p Nj p )jj2

Figure 5: Top: natural surface (mountain near Dijon,
France). Bottom: reconstruction.

The surface tabulation is a grid defined by [4, 5, 6] :

Fa ( Ni p Nj p ) = P ( Ni p Nj p )
with (i j) 2 f0 : : : N p ; 1g f0 : : : N p ; 1.

6.2

Solving the non-linear problem

Our resolution method is based on the L EVENBERG -M AR QUARDT algorithm. This algorithm is a numerical resolution

Proceedings of the Sixth International Conference on Information Visualisation (IV’02)
1093-9547/02 $17.00 © 2002 IEEE

of the following fitting problem:

M
X

aopt = argmin
(yk ; f(a xk ))2
a
k=0

where vectors

(N p + 1)2

y and x are the fitting data, in our case : M =

yk = 0 xk = k: The fitting model is:
f(a k) = jjQikjk ; Fa ( Nikp Njkp )jj
where ik = k mod N p and jk = k=N p .

The L EVENBERG -M ARQUARDT method combines two
types of approximation for minimizing the square distance.
The first consists in a quadratic approximation. When
this fails, the method tries a simple linear approximation.
These approximations are computed with the provided partial derivatives of the fitting model.
In our case, they are numerically computed by a perturbation
vector [3, 4]:

with:

f(a + ai u) ; f(a u)
@f
@ai (a u) '
"
ai = (0| : :{z: 0 "} 0 : : : 0).
i

7

Conclusion

[5] E. GUERIN, E. TOSAN, and A. BASKURT. ,Fractal Approximation of Surfaces based on projected IFS
attractors. ,In Proceedings of EUROGRAPHICS’2001,
September 2001. ,Short presentation.
[6] E. GUERIN, E. TOSAN, and A. BASKURT. ,Modeling and Approximation of Fractal Surfaces with projected IFS attractors. ,In M. M. Novak, editor, Emergent Nature, pages 203–304. World Scientific, 2002.
[7] P. MASSOPUST. ,Fractal surfaces. ,Journal of Mathematical Analysis and Applications, (151):275–290,
April 1990.
[8] P. MASSOPUST. ,Fractal Functions, Fractal Surfaces
and Wavelets. ,Academic Press, 1994.
[9] Charles A. MICCHELLI and Hartmut PRAUTZSCH.
,Computing surfaces invariant under subdivision.
,Computer Aided Geometric Design, (4):321–328,
1987.
[10] Hartmut PRAUTZSCH and Charles A. MICCHELLI.
,Computing curves invariant under halving. ,Computer
Aided Geometric Design, (4):133–140, 1987.
[11] P. PRUSINKIEWICZ and G. SANDNESS. ,Koch
curves as attractors and repellers. ,IEEE Computer
Graphics & Applications, pages 27–40, novembre
1988.

We have presented a new approach for modeling and approximating rough objects. This method is based on a fractal [12] Eric TOSAN. ,Surfaces fractales d´efinies par leurs
bords. ,In L. Briard, N. Szafran, and B.Lacolle, editors,
model named “projected IFS attractors”. This model is a
Journ´ees “Courbes, surfaces et algorithmes”, Grenoparametric description which has the advantage of compactly
ble, 15-17 Septembre 1999.
describing the surface shape, making it useful for Geometric
Modeling and Computer Graphics. The first results show
[13] Claude TRICOT. ,Courbes et dimension fractale.
that our description is an interesting approach to design or
,Springer Verlag, 1993.
reconstruct rough objects.
[14] C W A M van OVERVELD. ,Family of recursively
defined curves ,related to the cubic B´ezier curve.
References
,Computer-Aided Design, 22(9):591–597, 1990.
[15] Heping XIE and Hongquan SUN. ,The study of Bivariate Fractal Interpolation Functions and Creation of
Fractal Interpolated Surfaces. ,Fractals, 5(4):625–634,
[2] Serge DUBUC. ,Mod`eles de courbes irr´eguli`eres. ,In
1997.
Dimensions Non Enti`eres et Applications. Masson,
[16] Chems Eddine ZAIR and Eric TOSAN. ,Fractal mod1987.
eling using free form techniques. ,Computer Graphics
[3] E. GUERIN, E. TOSAN, and A. BASKURT. ,Fractal
Forum, 15(3):269–278, August 1996. ,EUROGRAPHcoding of shapes based on a Projected IFS Model. ,In
ICS’96 Conference issue.
IEEE Signal Processing Society, editor, Proceedings
ICIP’2000, volume 2, pages 203–206, 10-13 Septem- [17] Chems Eddine ZAIR and Eric TOSAN. ,Computer
Aided Geometric Design with IFS techniques. ,In M M
ber 2000.
Novak and T G Dewey, editors, Fractals Frontiers,
[4] E. GUERIN, E. TOSAN, and A. BASKURT. ,Fracpages 443–452. World Scientific Publishing, April
tal Approximation of Curves. ,Fractals, 9(1):95–103,
1997.
March 2001.

[1] M.F. BARNSLEY. ,Fractal Everywhere. ,Academic
press, INC, 1988.

Proceedings of the Sixth International Conference on Information Visualisation (IV’02)
1093-9547/02 $17.00 © 2002 IEEE


Visualizing metabolic networks in VRML
Igor Rojdestvenski*, Dept. of Plant
Physiology, Umeå University, Umeå 90187,
Sweden

Abstract
A successful data collection visualization should
satisfy conflicting requirements: unification of diverse data
formats, support for serendipity research, support of
hierarchical
structures,
algorithmizability,
vast
information density, Internet-readiness, etc. The traditional
2D representations of metabolic pathways lack
compactness and information density. Virtual Reality (VR)
has made significant progress in engineering, architectural
design, entertainment and communication. Evident
advantages of using VR for scientific visualization are
subconscious orientation, compromise between overview
and detail, memorizing search results, and customization.
We experiment with the possibility of using immersive
abstract 3D visualizations of metabolic networks. We
present the trial Metabolic Network Visualizer (MNV)
software, which produces graphical representation of a
metabolic network as a VRML (Virtual Reality Modeling
Language) world. The entities in the metabolic network are
identified as “compartment”, “species”, “reaction” and
“transporter”. The properties of the above objects are
described using a simple scripting language. The
demonstration of the MNV software is available at
http://130.239.139.41/sciencevr/mnv/indexview.html.

Introduction.
One of the aims of modern molecular biology is
directed towards the creation and use of molecular
biological databases and data banks (MBDB) (see, e.g.
Bogutski 1995). These huge collections of data contain
information about DNA sequences, the proteins encoded
by them, and the homologies between different genes. The
various MBDBs available for public access constitute an
emerging information medium, which is shared by
medicine, biology, biotechnology, physiology, etc.
A successful data collection representation and
visualization should satisfy a set of many, often
conflicting, requirements: unification of diverse data

Michael Cottam, Dept. of Physics and
Astronomy, University of Western Ontario,
London, Ontario N6A 3K7, Canada
formats, support for serendipity research, support of
hierarchical structures, compromise between overview and
detail, agorithmizability, vast information density, Internetreadiness, and others. Traditional text-based and simple
graphics-based systems only partly solve the problem. In
addition, good data collection visualization should possess
the potential for expansion and self-organization as a result
of joint efforts of separate research groups within the
research community. Today virtual reality (VR) technology
has made significant progress in engineering and
architectural design, entertainment and communication.
VR in scientific visualization can take advantage of
existing developments in engineering and entertainment
VR, while applying these features to new domains (Chen
1999). Evident advantages of using VR are subconscious
orientation, compromise between overview and detail,
cross-reference visualization, memorizing search results,
customization (Modjeska 1998; Rojdestvenski et al 2000).
Moreover, the information perception when immersed in a
VR world is qualitatively different from the traditional
“read-and-reason” paradigm and may contribute
significantly to the serendipity aspect of scientific research.

Graphical representations of metabolic
networks.
A vast amount of publicly available molecular
biological information is related to graphical
representations of metabolic pathways. The traditional
approach to the visualization of metabolic pathway
networks comprises graphical diagrams – pathway maps
(see, e.g., KEGG: Kanehisa 1999; CSNDB: Takai-Igarashi
& Kaminuma 1999; SPAD: Tsukamoto et al 1997).
Several approaches to automatic visualization of metabolic
networks are currently under development. Becker & Rojas
(2001) addressed the issue of algorithmizability and
suggested a graph layout algorithm for drawing metabolic
pathways. Metabolic pathways are taken in a traditional
metaphor of two-dimensional (2D) graphs in which nodes

*e-mail: igor.rojdestvenski@plantphys.umu.se; homepage: http://130.239.139.41

Proceedings of the Sixth International Conference on Information Visualisation (IV’02)
1093-9547/02 $17.00 © 2002 IEEE

represent chemical compounds, and edges represent
chemical reactions between compounds. The automatic
graph layout problem (i.e. the problem of adequate
positioning of the elements of the graph on a plane) is
addressed by a combination of algorithms from graph
theory, particularly designed to tackle cyclic or partially
cyclic pathways (see an extensive bibliography on the
graph layout algorithms in Di Battista et al 1994).
Robinson & Flores (1997) suggested several ways to
improve information perception in standard 2D schemes.
The software “fish-eye” hyperbolic projection display
(“focus+context” paradigm) ensures the compromise
between the overview of the data structure and the details
of its particular element. Filtering of information is
addressed using the software “filtering” lenses. We note
that in this paper Robinson appears to be critical of 3D
visualization, stating that the users “get lost” in 3D very
easily.
This contribution is devoted to discussing possible 3D
representations of metabolic networks, using the ideology
of Virtual Reality. We discuss the Metabolic Network
Visualizer (MNV) software, which uses a simple scripting
language to describe a metabolic network and produces
graphical representation as a VRML (Virtual Reality
Modeling Language) world.

MNV concept, scripting language and
implementation.
We base our MNV design on the postulate that for the
visualization to be consistent the algebra of objects and
rules in constructing metabolic networks must be matched
by the “algebra of visualization rules”. We identify the
entities in the metabolic network as “compartment”,
“species”,
“reaction”
and
“transporter”.
The
“compartment” object describes the place where the
reactions take place. “Species” objects represent metabolic
species taking part in the reactions that are, in turn,
described by “reaction” objects. “Transporter” objects are
reserved for the description of fluxes of metabolites into
and from the compartment. This is the minimal algebra of
objects that is capable of a complete description of the
static properties of a coordinate-independent metabolic
network, i.e. a network in which the concentrations of the
species characterize the whole compartment rather than
being scalar fields depending on the coordinates within the
compartment.
We describe the properties of the above objects using
a simple scripting language which is similar to a subset of
the SBML standard currently under development (Hucka et

al 2001). Similar approach can be found in (Kolpakov et
al 1997), where a much more involved scripting language
is devised for the purpose of 2D visualization of gene
networks. We associate each of the four object types with a
corresponding HTML-like tag. The rules of the scripting
language are discussed in detail elsewhere (see the
“About” section at 130.239.139.41/sciencevr/mnv/). After
trying several visualization metaphors we have chosen two
of them – a deterministic one and a self-organizing one.
The former of these, a “design” metaphor is most
appropriate in a network construction phase when the
determined visual structure is paramount. The rules of
visualization are as follows.
1. Each of metabolite species in the compartment is
visualized as a white ball, positioned at a circumference of
the compartment disc. The size of the white ball is
proportional to the metabolite concentration.
2. The reactions are displayed as colored objects
stacked along the axis perpendicular to the compartment
disc. Shapes of reaction objects depend on whether the
reaction is catalyzed by an enzyme, has coenzymes,
cosubstrates and/or coproducts.
3. The transporters are displayed as colored cone
structures at the metabolite's base looking "outwards", if
the metabolite is transported out of the compartment, and
inwards otherwise. The "out-transporters" and "intransporters" have different colors.
4. All the metabolites are connected to the reactions in
which they participate by colored block arrows, the color
matching that of the reaction. The arrow from the
metabolite to the reaction means that this metabolite is a
substrate. The reverse direction means that this metabolite
is a product.
These rules were implemented in the Perl program,
which takes the input MNV script file, containing the
metabolic network description. The program then converts
it into a VRML world, later viewed using a VRML
browser plug-in, available free of charge for most
hardware and software platforms. In Fig.1 we show the
“design” view of a double cycle, based on the following
script.
<compartment name="Double_cycle">
<species comp="Double_cycle" name="A" conc="1.0">
<species comp="Double_cycle" name="B" conc="2.0">
<species comp="Double_cycle" name="C" conc="2.0">
<species comp="Double_cycle" name="D" conc="2.0">
<species comp="Double_cycle" name="E" conc="2.0">
<species comp="Double_cycle" name="F" conc="2.0">
<species comp="Double_cycle" name="G" conc="2.0">

Proceedings of the Sixth International Conference on Information Visualisation (IV’02)
1093-9547/02 $17.00 © 2002 IEEE

<species comp="Double_cycle" name="H" conc="2.0">
<reaction comp="Double_cycle" name="AB" substrates="1*A"
products="1*B">
<reaction comp="Double_cycle" name="BCF" substrates="1*B"
products="1*C+1*F">
<reaction comp="Double_cycle" name="CAD" substrates="1*C"
products="1*A+1*D">
<reaction comp="Double_cycle" name="DE" substrates="1*D"
products="1*E">
<reaction comp="Double_cycle" name="FG" substrates="1*F"
products="1*G">
<reaction comp="Double_cycle" name="GH" substrates="1*G"
products="1*H">
<reaction comp="Double_cycle" name="EH" substrates="1*E"
products="1*H">

The program allows a user, when clicking on a
reaction object, to enlarge it together with all the
metabolites associated with it. Similarly, when clicking on
a metabolite object, this object is enlarged alongside with
all the associated reactions. All the figures here were
created specifically in black and white for the journal print,
and hence do not give a full impression of the colorful and
dynamic system.
The above visualization metaphor is quite useful when
constructing the network, as it is ordered and regular, and
thus each element of it is easy to find. However, it is poor
in reflecting the actual topology of the network, namely its
structural elements, like loops, branches, etc. Besides, all
networks look similar in this representation, taking away
any would-be “perception enhancements”.

Figure 1. The “design” view of a simple network
comprising two cycles.
We then progressed to a different network layout
algorithm which, while retaining the simplicity of the
previous one, produces better-structured, unique graphs

that fully reflect the network’s topology. The algorithm we
suggest belongs to the family of self-organizing
algorithms, in which the layout appears as a result of many
iterations with certain rules. It is similar to the 3D “spring
embedding” algorithm presented in (Bruss and Fick 1995),
and will be described in detail elsewhere (Rojdestvenski, in
preparation). The algorithm is found to work quite well on
all the networks studied. It also proved to reflect well the
symmetry properties of the network graphs, being at the
same time fast enough for interactive graph drawing. In
Fig. 2 an example is presented of the same double-cycle
reaction network. Comparing Figs. 1 and 2 it is clear that
the second representation is much better in reflecting the
double-cycle topology of the network.

Figure 2. The 3D view of the network in Fig.1.
Another interesting feature of the algorithm is that it
produces an effectively 2D picture, when the topology of
the network permits it. As an example we show the
mitochondrial citric acid (Krebs) cycle in Fig. 3 (see, e.g.
Heldt 1997).

Figure 3. Krebs cycle – a realistic network in 3D
(see text for explanations).

Proceedings of the Sixth International Conference on Information Visualisation (IV’02)
1093-9547/02 $17.00 © 2002 IEEE

Again the topology of the network is clearly visible,
which proves that in this case a simple self-organizing
algorithm is as efficient as the much more involved ones

Figure 4. Calvin cycle (see text for explanations).
(see, e.g., Becker and Rojas 2001) comprising precise
analysis of the branching and cyclic structures prior to
laying out the graph. If the network topology becomes
more complex, the algorithm opens the graph layout in full
3D.
In Fig. 4 we present the layout for the photosynthetic
Calvin cycle, which converts inorganic carbon into sugars

(see e.g. Heldt 1997). For comparison, in Fig. 5 we show
the same Calvin cycle in a “traditional” 2D layout, as given
in the Kegg database (Kanehisa, 1999).
The static pictures cannot fully represent all the visual

perception properties of the VRML world, where the user
can rotate the picture in 3D, move around it or even get
inside it. The use of the third dimensions helps to avoid
edge crossings. Extra functionality may be added by using
hyperlinks embedded in the VRML world, as well as some
dynamic features of the VRML language itself. As in the
“design” metaphor, clicking on a metabolite object
highlights all the reactions this metabolite is involved in,
and clicking at the reaction object highlights all its
products and substrates.

Proceedings of the Sixth International Conference on Information Visualisation (IV’02)
1093-9547/02 $17.00 © 2002 IEEE

We should note here that a full immersive 3D
navigation might indeed be misleading, if the structures are
complex enough. However, in the case of metabolic
networks we usually deal with relatively simple graphs,
whose topological structure can be perceived by an outside
viewer. In this case there is no need for the viewer to go
deep into the structure. Simply rotating the structure is
enough in most cases.

Fig. 5. Calvin cycle as represented in KEGG
database.
There is also an option for combining several
metabolic networks into a hierarchical collection,
representing a separate VRML world similar to the
"Cityscape" concept discussed in Keskin & Vogelman
(1997) and Modjeska (2000). If this feature were
implemented, the resulting system would represent a
hierarchical scalable virtual world with intuitive navigation
in it. Adding such hierarchical organization to a collection
of metabolic networks increases the scalability of the
system, which is quite important when the collection
increases as a result of joint efforts of different research
groups.
Such a hierarchical approach, if implemented, should
be based not on a full 3D representation, but on a “flat” 2D
positioning of individual 3D networks. As we speculated
earlier (Rojdestvenski et al, 2000) this makes the
navigation more like human navigation in space, which is
effectively “2.5D”, i.e. bounded to a 3D layer adjacent to
the ground due to gravity.

Conclusions
When compared to traditional 2D metabolic schemes,
several advantages of our visualization scheme can be
seen. Some of these advantages are realization specific,
while others reflect the common information perception
properties of the virtual worlds, as outlined below.

A compromise between an overview and detailed
view. A user’s mobility in the VR world yields flexibility
in continuous shifting of attention focus. When a user is
focused on a certain neighborhood, the location is
displayed in a detailed view. Via peripheral vision,
however, one can perceive other parts of the data structure,
presented as geographical areas. This approach enables the
user to recognize both the entire structure and his/her
location in it. Continuous shifting of viewpoints gives the
user an option of shifting attention from one part of the
metabolic network to the other, thus ensuring fuller
understanding of its structure. This is a different realization
of the “focus+context” paradigm quoted in Robinson &
Flores (1997).
Parallel perception. Use of such visual attributes as
shape, size, color and transparency yields parallel
information perception once the user has become
accustomed to the specific conventions of a given
visualization.
Algorithmizability. The use of third dimension makes
it easier to ensure automatic building of the visualization.
Indeed, in 2D representations of graphs one encounters
problems of adequate visualization of crossing lines, of
identifying cycles and branches, etc. This results in the
necessity of applying rather cumbersome algorithms for the
in-plane graph layouts (see, e.g., Becker & Rojas 2001). In
3D these problems occur to a much lesser extent. At the
same time the representation in 3D is no less consistent
than the traditional one. Such simple algorithmizability
makes the MNV schemes (or similar schemes) good
candidates for the automatic client-end visualizations of the
dynamic quantitative calculations by coupling MNV to
solvers like Gepasi (Mendes 1997). The Translator
programs may be “taught” to take actual numerical data in
real time (as a result of calculations or even measurements)
and implement these data in a VR-world “on the fly”. Such
dynamic version of MNV is queued for implementation in
the near future.
Internet publishing. Use of VRML makes our
representation Internet-ready, as VRML 2 (along with its
current version, VRML97) has become one of the standard
Internet languages. By adding form-like interfaces and
giving researchers an opportunity to contribute to the
collection of metabolic networks, the system becomes a
self-organizing information media. We invite everyone to
participate by submitting the descriptions of the networks
using the MNV constructor, which is available at
http://130.239.139.41/sciencevr/mnv/indexmake.html.
We should also mention some disadvantages of the
MNV visualization scheme. One disadvantage lies with the

Proceedings of the Sixth International Conference on Information Visualisation (IV’02)
1093-9547/02 $17.00 © 2002 IEEE

fact that our visual representation of metabolic pathways
differs substantially from the traditional one, widely used
in literature and MBDBs. However, we have demonstrated
that when the 2D topology is adequate, our algorithm
reproduces them fairly well. The use of the third dimension
implies some extra user training, but we may argue that it
would result in better understanding and memorizability of
the metabolic networks. In any case ours, or any such like
visualization scheme may be used not as a replacement, but
as a reasonable alternative for the standard 2D schemes.
Another disadvantage stems from the fact that VRML
browsers, readily available for the MS Windows systems,
are somehow poorly represented for Macintosh and Unix
(Linux) platforms. Current development of the X3D
standard, which is an extended XML version of VRML,
gives hope that within the next couple of years the situation
will be corrected. However, approaches similar to ours
may be developed using other software platforms (Java3D,
game SDKs, etc.).
Finally, we remark that the visualization scheme
presented here should in no way be treated as a set
standard. Our goal has been merely to demonstrate the
potential of using VR in visualizing metabolic networks.
As the system is currently in an embryonic state of
development, it still yields maximal adaptability, and the
authors welcome any constructive remarks and suggestions
regarding possible modifications, extensions and
amendments to the suggested scheme. It has to be
understood that it is only when applied to substantial data
collections, that any real advantages of this new
visualization scheme may become significant.
We gratefully acknowledge financial support from the
NFR of Sweden, the Knut and Alice Wallenberg
Foundation, and the Center for Chemical Physics,
University of Western Ontario.

References
Boguski, M. S. (1995) The Turning Point in Genome
Research. Trends in Biochemical Sciences, 20, 295.
Becker, M. Y. and Rojas, I. (2001) A graph layout
algorithm for drawing metabolic pathways. Bioinformatics,
17(5), 461-467.
Bruss, I. and A. Frick (1995). Fast interactive 3-d
graph visualization. In Proceedings of Graph Drawing '95,
pp 99-110. Springer-Verlag.
Chen, C. (1999) Information Visualisation and Virtual
Environments. Springer, London.
Di Battista, G., Eades, P., Tamassia, R. And Tollis,
I.G. (1994) ”Algorithms for Drawing Graphs: an

Annotated Bibliography”, document available by
anonymous FTP at
wilma.cs.brown.edu/pub/papers/compgeo/gdbiblio.ps.Z
Heldt, H.-W.
(1997) Plant Biochemistry and
Molecular Biology. Oxford University Press.
Hucka, M., Finney, A., Sauro, H., Bolouri, H. (2001)
Systems Biology Markup Language (SBML) Level 1:
Structures and Facilities for Basic Model Definitions.
SBML Level 1, Version 1 (Final), 2 March 2001,
http://www.cds.caltech.edu/erato
Kanehisa, M. (1999) KEGG: From genes to
biochemical
pathways.
In Letovsky, S., (ed)
"Bioinfomatics: Databases and Systems", Kluwer
Academic Publishers, pp. 63-76.
Keskin, C.
Vogelmann, V. (1997) Effective
Visualization of Hierarchical Graphs with the Cityscape
Metaphor. In Workshop on New Paradigms in Information
Visualization and Manipulation 1997, pp. 52-57
Kolpakov, F.A., Ananko, E.A., Kolesov, G.B. and
Kolchanov, N.A. (1998) GeneNet: a gene network
database and its automated visualization. Bioinformatics,
14, 529-537
Mendes, P. (1997) “Biochemistry by numbers:
simulation of biochemical pathways with Gepasi 3”.
Trends Biochem. Sci. 22, 361-363.
Modjeska, D. (1998) "Parallel Worlds: Spatial and
Textual Representations of Information Structure", in
Workshop on Personalised and Social Navigation in
Information Space, Swedish Institute of Computer Science,
Stockholm
Modjeska, D. (2000) View vs. Overview: Hierarchical
Data Visualization in Desktop Virtual Reality, Proceedings
of NordiCHI 2000, STIMDI, 2000.
Robinson, A. J. and Flores, T. P. (1997) Novel
Techniques for Visualising Biological Information,
ISMB’97, http://industry.ebi.ac.uk/~alan/Papers/ISMB97/
Rojdestvenski, I., Modjeska, D., Pettersson, F.,
Rojdestvenskaia, M., Gustafsson, P., (2000) Sequence
World: A Genetics Database in Virtual Reality. In Banissi,
E., Bannatyne, M. and Chen, C. (eds.) Proceedings of the
Information Visualization 2000 conference (IV2000),
London, UK, July 2000. pp. 513-517.
Takai-Igarashi, T., and Kaminuma, T., (1999) A
Pathway Finding System for the Cell Signaling Networks
Database. In Silico Biology, 1, 129-146
Tsukamoto, Y., Takiguchi, K., Satou, K., Furuichi, E.,
Takagi, T. and Kuhara, S. (1997) Application of a
deductive database system for topological and similar three
dimensional structures in protein, CABIOS, 13, 183.

Proceedings of the Sixth International Conference on Information Visualisation (IV’02)
1093-9547/02 $17.00 © 2002 IEEE


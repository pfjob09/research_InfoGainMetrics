2010 14th International
Information
Conference
Visualisation
Information Visualisation

CardioAnalyser: A Software Tool for
Segmentation and Analysis of the Left Ventricle
from 4D MDCT Images of the Heart
Samuel Silva, Joaquim Madeira, Beatriz Sousa Santos, Augusto Silva
Institute of Electronics Engineering and Telematics
Department of Electronics, Telecommunications and Informatics
University of Aveiro, Aveiro, Portugal
sss@ua.pt

Abstract

ing a more complete analysis and providing a chance to
explore new parameters and analysis techniques. For this,
it is necessary to segment the relevant structures for all the
cardiac phases while dealing with a large amount of data
(around 1.5 gigabytes per exam).

Cardiac angiography using multiple detector row computerized tomography (MDCT) scanners provides 3D data
concerning the heart and, in particular, the left ventricle
(LV), for different cardiac phases along one cardiac cycle.
Exploring this data for LV function analysis is not an
easy task, given the amount of data and time involved in
segmenting (or revising results provided by automatic segmentation methods) up to 12 cardiac phases.
CardioAnalyser, a tool for 4D LV segmentation from
MDCT data which provides a protocol to help perform LV
segmentation of all cardiac phases available is presented.
It uses an automatic segmentation algorithm along with a
procedure which guides the user through the process. Its
main goal is to reuse as much information as possible from
one cardiac phase to the next in order to reduce segmentation time and the amount of user interaction.

Segmenting a large number of cardiac phases can be a
tiresome task. Even if the segmentation is performed automatically, there is always a need to revise/edit it to ensure
its correctness. Tools such as CardioViz3D [4], which allow analysing cardiac data, are not suited for 4D analysis
since they do not allow carrying it out as an integrated process, using knowledge from previously segmented cardiac
phases to improve current phase segmentation and minimize required user interaction. One must not forget that, as
important as the segmentation methods, are the tools which
allow user interaction to guide the method or allow correcting the results [5].

Keywords— Left ventricle, segmentation, MDCT, 4D, software tool

1

CardioAnalyser, developed using ITK [6], MITK [7]
and Qt, is a tool for LV segmentation and analysis from
cardiac angiography MDCT exams. It allows systematic
segmentation of multiple cardiac phases by using a protocol composed of an automatic segmentation algorithm
and a guided procedure which walks the user throughout
the revision (and editing, if necessary) of the obtained segmentations. It deals with the large data amount (not only
the MDCT data, but also data generated while processing
it) by only keeping in memory the cardiac phase which is
being segmented.

Introduction

Left ventricle (LV) function analysis is of paramount
importance for cardiac assessment. With MDCT scanners,
4D cardiac exams, typically including 12 cardiac volumes
distributed along one cardiac cycle, can be performed. One
of the major applications is cardiac angiography to assess the coronaries (e,g., [1]). Several studies (e.g., [2]
and [3]) have shown that MDCT exams also allow computing several LV functional parameters (e.g., ejection fraction) which compare to those obtained using well established image modalities for cardiac analysis, such as magnetic resonance imaging (MRI) or echocardiography.
Having several cardiac phases available (besides endsystole and end-diastole), it is possible to explore how different parameters vary along the cardiac cycle, thus allow1550-6037/10 $26.00 © 2010 IEEE
DOI 10.1109/IV.2010.91

On the following sections the segmentation protocol implemented in CardioAnalyser is described, followed by an
overview of the main analysis features already provided.
Finally, some conclusions and ideas for future work are
presented.
619
629

Figure 1: General view of CardioAnalyser’s interface

2

around 60% of the cardiac cycle when there is less heart
movement (dyastolic stage) and a higher dose of radiation
is applied thus resulting in better image quality which helps
the segmentation process.
This reference phase is used to perform a preliminary
analysis to locate the LV and estimate its orientation. This
is why it is important to choose a cardiac phase with best
possible quality.
Left ventricle orientation data is then used to propose
different view planes to examine the image volume. These
are set according to the usual planes used for cardiac diagnosis purposes as depicted in figure 2.
The proposed view planes can be modified by the user
which has to approve them. Since there is LV positional
coherence along the cardiac cycle, when analysing the remaining phases these view planes will be used as starting
visualization conditions (although adjustments can be performed, by the user, for each phase).
After approving the view planes the user is presented
with a rough segmentation of the LV and asked to adjust
the mitral valve plane using a slider. This was one of the
aspects in which our automatic segmentation method could
present some problems (not detecting the mitral plane correctly), as shown in a preliminary evaluation [8]. By presenting this simple and intuitive adjustment method, we
aim to reduce the amount of editing that might be necessary.
Next, the user is presented with a LV endocardium segmentation of the reference phase which can be edited using
a 3D editing tool briefly described later.
After approving the endocardium segmentation, the re-

Segmentation Protocol

The segmentation protocol, i.e., the procedure which allows obtaining LV segmentation for the selected cardiac
phases, is composed by an automatic segmentation algorithm and a sequence of steps which guide the user through
the process. All along, the user can approve the proposed
visualization options and segmentations, while being allowed to change/edit them. Given that the segmentation
algorithm is not the main subject of this paper only the relevant features will be explained, to help understand the various steps of the segmentation protocol. For further details
regarding the segmentation method the reader if forwarded
to Silva et al. [8].
The protocol presented below aims to provide the segmentation and analysis of cardiac angiography MDCT exams containing data for 12 (although there is no limit in
their number) cardiac phases along one cardiac cycle. The
main goal is to allow performing this task using a common
desktop computer and in such a manner as to minimize user
interactions while revising the segmentations of the different cardiac phases. The output should be LV segmentation
data for multiple cardiac phases which can confidently be
used for further analysis.
The segmentation protocol comprises two main steps
and an auxiliary editing tool which are described next.

2.1 Step 1: Reference Phase Segmentation
The user selects an exam and a preliminary analysis is
performed in order to obtain the number of cardiac phases
and their position on the cardiac cycle, e.g., 10%, 25%,
85% (figure 3a). The user is then asked to choose one of
the phases to be used as a reference. This is usually a phase
630
620

a)

d)

b)

e)

c)

f)

Figure 2: Common view planes used by the radiographers to analyse LV data: a) LV short-axis, b) 2-chambers (left atrium
and ventricle) and c) 4-chambers (both ventricles and both atria) compared with the the usual orthogonal view planes d)
coronal, e) sagital and f) axial.
sulting data is used to propose an epicardium segmentation
which can also be edited.
Figure 3b shows the user interface which supports this
step. The current task is always highlighted by using a different background color (brown).
The segmentation data gathered in this step will be used
in the following step to improve the segmentation algorithm results.

the current cardiac phase image and loading the new one.
Loading just one cardiac phase at each time allows the
analysis of the entire exam in a system with 2GB of physical memory.
Figure 3d shows the user interface which supports the
tasks described above. Notice that a table including the selected cardiac phases and a report on what has already been
done is also provided.

2.2 Step 2: Full Exam Segmentation

2.3

At the beginning of this step the user is required to
choose which cardiac phases are to be included in the analysis (figure 3c).
For each of the selected phases the corresponding image volume is loaded from disk. The segmentation data
gathered in the first protocol step (for the reference phase)
is used to propose both endocardium and epicardium segmentations for the new phase. This is important to account
for any editing performed by the user on those segmentations (e.g., adding a relevant region which was not initially
included) and thus contributing for a better segmentation
of the current phase.
The image and corresponding segmentation are presented using the relevant view planes previously approved
by the user.
After approving (and editing, if needed) both endocardium and epicardium segmentations, the protocol proceeds with the next selected cardiac phase by unloading

The included editing tool also has an important role in
the segmentation protocol by allowing an intuitive and adequate editing of the segmentations.
Given that each cardiac phase image has a resolution of
512 × 512 × 256+ and the LV spans several slices in all
directions, it would be a tiresome task to perform editing
on a slice-by-slice basis. Furthermore, slice-by-slice editing might also lead to incoherence, for example, if some of
the slices are forgotten.
The editing tool allows 3D editing using two different
approaches: voxel mask editing and surface editing.
Voxel mask editing consists in modifying the segmented
region by adding/subtracting voxels to/from the segmented
region using a spherical tool. Editing can be performed in
any of the view planes and the add/subtract mode is automatically selected by considering the region in which the
operation is initiated: if editing is started inside the segmented region, then it will add voxels; if it is started out631
621

Editing Tool

(a)

(b)

(c)

(d)

Figure 3: User interfaces which support the main tasks concerning LV segmentation of multiple cardiac phases: a) Exam
selection and brief report concerning patient name and included cardiac phases; b) reference cardiac phase segmentation,
view planes definition, mitral valve level adjustment and endocardium/epicardium segmentation; c) selection of cardiac
phases to segment; d) Individual cardiac phase segmentation (re-used until all selected cardiac phases are segmented).
side the segmented region, it will remove voxels from the
mask. This feature also contributes to reducing the amount
of required interaction, as there is no need to explicitly
swap between editing modes. Figure 4 shows these two
editing modes.
Surface editing consists in deforming the surface that
envelops the segmented region. This surface can be obtained from the voxel mask by using the marching cubes
algorithm [9]. The editing tool is a sphere which can be
used to deform the surface when pressed against it. Figure 5 shows the surface editing tool.
Given the 3D nature of the editing tool in both approaches, editing is performed along the slices adjacent to
the one presented on the view plane used while editing thus
providing a faster and easier tool than a 2D tool.
For further details regarding the 3D editing tool the
reader is referred to Silva et al. [10].

3

the end-systole and end-diastole phases.
CardioAnalyzer provides several analysis features regarding global and regional LV function, such as global
and regional ejection fraction, global and regional blood
volumes for all segmented cardiac phases and endocardium
radius and myocardium thickness variations.
Regional data is depicted using bull’s-eye diagrams and
line graphs depicting the mean values observed for each
LV region along time.
Figure 6 shows CardioAnalyser’s analysis board. It is
a multiple document interface (MDI) area where several
windows, each one regarding a specific LV function parameter, can be managed, choosing which ones to view and
allowing side-by-side positioning to help compare behavior among different parameters.
During the analysis, when the user selects a sector of
any bull’s-eye, the corresponding curve on the line graph
is highlighted. All the visualizations shown on the analysis
board are synchronized to the same cardiac phase to allow
proper comparison.

Cardiac Analysis Features

Having the data concerning several cardiac phases, it
is possible to visualize how several parameters vary along
the cardiac cycle, instead of a simple analysis using only
632
622

(a)

(b)
Figure 4: Voxel mask editing tool: a) to add voxels to the segmented region the operation has to start from an already
segmented region; b) to remove voxels, the operation has to start from outside the segmented region.

Figure 5: Segmentation editing by surface deformation. The editing tool is a sphere and can be used in any of the view
planes. It appears in different sizes depending where the view plane intersects the sphere. On the bottom right image a 3D
view of the surface (in red) and sphere (in blue) are shown.

4

Conclusions and Future Work

De Castro et al. [11].
A thorough validation of the protocol must be performed to assess intra-observer and inter-observer variation of the resulting segmentations/analyses. Furthermore,
since it is the authors’ goal to make CardioAnalyser publicly available in the future, its stability and usability must
also be taken into account and improved.
A video, illustrating some of the features of
CardioAnalyser can be downloaded from http://www.
ieeta.pt/˜sss/CardioAnalyser.avi.

CardioAnalyser, a tool for systematic LV segmentation from 4D MDCT cardiac angiography exams was presented. It provides a segmentation protocol composed of
an automatic segmentation algorithm and a sequence of
steps guiding the user along the different tasks of setting
the proper view planes and revising the segmentations.
This revision guarantees that the output segmentation data
can be confidently used for further processing.
Analysis features are already provided concerning
global and regional parameters characterizing LV function.
There are several important ideas which can help improve CardioAnalyser. For instance, it should be possible
to visualize the curves (depicting the mean regional values
for each LV segment) filtered by annular tomographic region (basal, middle and apical). This might be important
for a proper analysis since each annular tomographic region might present slightly different behaviors as shown in

Acknowledgments
The first author is supported by grant
SFRH/BD/38073/2007 awarded by the Portuguese Science Foundation (FCT).

References
[1] O. Wink, H. Hecht, and D. Ruijters, “Coronary
computed tomographic angiography in the cardiac
633
623

Figure 6: CardioAnalyser’s analysis board where multiple parameters can be analysed in a multiple document interface
(MDI) area. The presented bull’s-eyes depict data regarding the end-systolic cardiac phase from a set of 12 cardiac phases.
catheterization laboratory: Current applications and
future developments,” Cardiology Clinics, vol. 27,
no. 3, pp. 513–529, 2009.

[6] ITK, “Insight segmentation and registration toolkit,”
http://www.itk.org/, (online Mar 2010).
[7] MITK, “Medical imaging interaction toolkit,”
http://www.mitk.org, (online Mar 2010).

[2] Y.-W. Wu, E. Tadamura, M. Yamamuro, S. Kanao,
S. Okayama, N. Ozasa, M. Toma, T. Kimura,
M. Komeda, and K. Togashi, “Estimation of global
and regional cardiac function using 64-slice computed tomography: A comparison study with
echocardiography, gated-spect and cardiovascular
magnetic resonance,” International Journal of Cardiology, vol. 128, no. 1, pp. 69–76, 2008.

[8] S. Silva, J. Madeira, A. Silva, and B. Sousa Santos,
“Left ventricle segmentation from heart MDCT,” in
Proc. 4th Ib. Conf. on Pat. Rec. and Image Analysis
(IbPRIA 2009), LNCS 5524, pp. 306–313, 2009.
[9] W. Lorensen and H. Cline, “Marching cubes: A high
resolution 3D surface construction algorithm,” Computer Graphics, vol. 21, no. 4, pp. 163–169, 1987.

[3] A. Mahnken, P. Bruners, S. Stanzel, R. Koos,
G. M¨uhlenbruch, R. G¨unther, and P. Reinartz, “Functional imaging in the assessment of myocardial infarction: MR imaging vs. MDCT vs. SPECT,” Euro.
J. of Radiology, vol. 71, no. 3, pp. 480–485, 2009.

[10] S. Silva, B. Sousa Santos, J. Madeira, and A. Silva,
“A 3D tool for leflt ventricle segmentation editing,” in
Proc. Int. Conf. on Im. Anal. and Rec. (ICIAR 2010)
(to appear), (P´ovoa do Varzim, Portugal), 2010.

[4] N. Toussaint, T. Mansi, H. Delingette, N. Ayache, and
M. Sermesant, “An integrated platform for dynamic
cardiac simulation and image processing: Application to personalised tetralogy of fallot simulation,”
in Proc. Eurographics Workshop on Vis. Comp. for
Biomedicine, (Delft, The Netherlands), 2008.

[11] S. De Castro, F. Faletra, E. Di Angelantonio,
C. Conca, A. Marcantonio, M. Francone, D. Cartoni, F. Mirabelli, C. Gaudio, S. Caselli, I. Carbone,
A. Auricchio, and N. Pandian, “Tomographic left
ventricular volumetric emptying analysis by real-time
3-dimensional echocardiography: Influence of left
ventricular dysfunction with and without electrical
dyssynchrony,” Circ Cardiocascular Imaging, vol. 1,
no. 1, pp. 41–49, 2008.

[5] S. D. Olabarriaga and A. W. M. Smeulders, “Interaction in the segmentation of medical images: A survey,” Medical Image Analysis, vol. 5, no. 2, pp. 127–
142, 2001.
634
624


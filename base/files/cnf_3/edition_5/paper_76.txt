Heat Map Visualizations Allow Comparison of Multiple
Clustering Results and Evaluation of Dataset Quality:
Application to Microarray Data
John Sharko1, Georges G. Grinstein1, Kenneth A. Marx2, Jianping Zhou1, Chia-Ho Cheng2,
Shannon Odelberg3, Hans-Georg Simon4
Departments of Computer Science1 and Chemistry2, University of Massachusetts Lowell,
Lowell, MA 01854, Department of Internal Medicine3, University of Utah School of
Medicine, Salt Lake City, Utah 84132, Children’s Memorial Research Center4, Feinberg
School of Medicine, Northwestern University, Chicago, IL. 60614
{jsharko@cs.uml.edu, grinstein@cs.uml.edu, Kenneth_Marx@uml.edu}

Abstract
Since clustering algorithms are heuristic, multiple
clustering algorithms applied to the same dataset will
typically not generate the same sets of clusters. This is
especially true for complex datasets such as those from
microarray time series experiments.
Two such
microarray datasets describing gene expression
activities from regenerating newt forelimbs at various
times following limb amputation were used in this study.
A cluster stability matrix, which shows the number of
times two genes appear in the same cluster, was
generated as a heat map. This was used to evaluate the
overall variation among the clustering algorithms and to
identify similar clusters. A comparison of the cluster
stability matrices for two related microarray experiments
with different levels of precision was shown to be an
effective basis for comparing the quality of the two sets
of experiments. A pairwise heat map was generated to
show which pairs of clustering algorithms grouped the
data into similar clusters.

1. Introduction
Typically, multiple clustering algorithms are used to
analyze the joint behavior in unclassified datasets. Since
clustering algorithms are heuristic and do not arrive at a
single optimum set of clusters, clustering algorithms tend
to produce different results.
The extent to which the clustering algorithms
produce the same results can be an indicator of the
relationships of the clustered records. For biological

11th International Conference Information Visualization (IV'07)
0-7695-2900-3/07 $20.00 © 2007

microarray data, records that are consistently grouped
together are more likely to have similar functionality
than records that fall into the same clusters in only a
fraction of the clustering instances. The records that stay
together across the clustering instances can be considered
to be stable. Cvek (1) visually compared clustering
results over a number of algorithms. Zhou (2) used an
extension of parallel coordinates to push further this
visualization of multiple clustering results. Ben-Hur (3)
and Giurcaneanu(4) assessed stability by identifying
pairwise similarities based on subsets of the data.
Costa(5) used gene annotation to assess the accuracy of
the clusters. Here our objective is to develop simpler
summary visualizations that can quickly be used to
assess the stability of groups and individual records.
This concept of stability of records across the
clustering instances can also be used to assess the overall
quality of the dataset. Given a set of underlying
relationships in a physical system, an experiment that is
conducted with great precision should reflect the
underlying relationships with less noise than one done
with moderate or poor precision. This should result in a
set of more stable clusters for the high precision
experiment than those for the less precise experiments.
Therefore, a valuable comparison of different datasets
can be carried out that is based upon an examination of
their relative cluster stabilities.
Heat maps (6) were used to visually reflect these
two characteristics of multi-clustered datasets. Heat
maps can be designed to indicate which records tend to
be grouped together as well as reflecting the overall
quality of the dataset.

To illustrate the benefits of visualizing multiple
cluster results using our approach, we employed
microarray data from a time series of the following
specific biological system. The North American newt,
N. viridescens, has the remarkable ability to replace lost
appendages through regeneration, making this organism
an important model system for studying that biological
process. Experiments were carried out to investigate the
individual gene expression changes, up-regulation or
down-regulation, of suspected important genes in the
limb regeneration process. Specifically, at various times
following forelimb amputation, gene expression level
changes were analyzed and presented as log(ratios), that
compared the regenerating blastemal RNA level at the
forelimb amputation site for each gene to that of a nonamputation control RNA. Clustering is particularly
valuable in analyzing such a dataset because: 1) there are
typically many hundreds to thousands of genes,
including a significant fraction (~70 % in this instance)
that are uncharacterized short cDNA sequences about
which nothing else is known in the public databases, and
2) the time series expression ratio characteristics for the
individual genes can vary widely. This wide variation in
the time series data tends to result in complex clustering
relationships that are not easily quantifiable.
Finding the relationships among the genes was
central to the analysis of our microarray datasets. Since
the dataset included time series data (each time point
post amputation is a separate chip), genes that were
expressed in similar patterns could potentially be a part
of the same signaling pathway or part of different
pathways that contribute to similar or complementary
biological functions.

2. Methodology
2.1 Cluster Stability Matrix
The cluster stability matrix reflects the extent to
which one record (or gene in the case of our microarray
dataset) tends to be in the same cluster as any other
record (gene) across the entire set of clustering instances.
Each cell in the matrix is the number of times the record
on the X-axis is in the same cluster as the corresponding
record on the Y-axis. The X-axis and the Y-axis contain
the same records in the same order. Each data point in
the matrix, xij, is defined as follows:
CA

Xij = Σ (clusterik = clusterjk)
k

where clusterik = the cluster in which record i falls into
for cluster algorithm k and CA represents the set of
clustering algorithms.
There are two obvious characteristics of this matrix.
First, the diagonal elements represent the number of
cluster algorithms being utilized. This is a result of the
fact that the diagonal elements represents the number of
times a record falls into the same cluster as the record
itself which must be 100% of the time. The other

11th International Conference Information Visualization (IV'07)
0-7695-2900-3/07 $20.00 © 2007

characteristic is that the matrix is symmetric around the
diagonal. The number of times record x falls in the same
cluster as record y is the same as the number of times
record y falls in the same cluster as record x.
The order of the records will materially affect the
display of the data. If the records are ordered in a
random fashion on both axes there will likely not be any
clear pattern. The records should ideally be in the same
order on both the axes so that at least the diagonal will
represent the total number of sets of clusters.
Placing the records in the same order on both axes
will still not result in clear relationships. Some order
must be imposed on the records so that similar records
will be grouped together. This is achieved by selecting
one of the clustering algorithms and grouping the records
into those clusters. This takes advantage of the fact that
records that are clustered together in one cluster set will
likely be clustered together in the other cluster sets.
In fact, the extent to which ordering the records by a
clustering set results in records around the diagonal is a
reflection of the stability of the clusters. Take for
example the case where there is perfect correspondence
between the clusters, i.e. each record falls into the same
cluster for each cluster set. The resulting plot will be a
series of squares containing the number of different
clusters sets. All of the entries off of these diagonal
squares will be zero.
This characteristic of a perfectly correlated cluster
set suggests a method for evaluating the stability of the
clusters. In the perfect case described in the previous
paragraph, the number of cells in the stability matrix
with non-zero values will equal the sum of the squares of
the number of records in each cluster for the cluster set
that was used to order the records along the axes. This
number divided by the total number of records in the
matrix, which is the square of the total number of
records, will represent a perfectly stable set of clusters.
The extent to which any dataset approaches this
maximum value indicates how stable the dataset is.
We define simple stability to be the total number of
cells with values equal to the total number of clustering
algorithms, i.e. pairs of records that are in the same
cluster for all of the clustering algorithms, divided by the
sum of the squares of the number of records in each
cluster for the cluster set that was used to order the
records along the axes. This ratio is between 0 and 1 and
is equal to 1 when there is a perfect match between the
two clustering algorithms record clustering membership.
A refinement to assessing the stability of a dataset is
to generate the distribution of the values in each cell in
the matrix. A stable matrix will have distributions
skewed toward the higher values for the number of
common clusters whereas a less stable dataset will be
skewed toward the lower values.
The cluster stability matrix can also be used to
identify possible relationships between clusters. If two
clusters have similar characteristics it is likely that for a
significant portion of the records identified as being in
one of the two clusters, there is reasonable likelihood
that that record will fall into the other cluster. Thus you

will tend to see two groups of cells with large numbers in
them: one located around the same cluster on the other
axis, i.e. along the diagonal, and the other located around
the other similar cluster.
The case where there is weak stability without any
clear relationships between clusters will result in cells
with relatively low values in them spread out over the
entire cluster stability matrix.
The cluster stability matrix is especially conducive
to being visualized using heat maps. The values in each
cell are limited to be between zero and the number of
cluster sets. Furthermore, the case where numbers in the
cells are large
reveals stability and a possible
relationship between the records.
To illustrate, consider the following simple example
of five data points with three clustering algorithms:
Record

Algorithm 1

Algorithm 2

Algorithm 3

A
B
C
D
E

1
2
1
3
1

2
3
3
1
2

3
3
2
1
3

The resulting cluster stability matrix ordered using
the results of clustering algorithm 1 is as follows:

A
B
C
D
E

A

B

C

D

E

3
1
1
0
3

1
3
1
0
1

1
1
3
0
1

0
0
0
3
0

3
1
3
0
3

2.2 Pairwise Stability Matrix
The results of two clustering algorithms can be
compared directly by calculating the number of records
that fall into each possible pair of clusters, one from each
of the two cluster sets. The horizontal axis represents the
clusters in one cluster set and the vertical axis represents
the cluster in the other cluster set. Each cell represents
the number of records that are in the corresponding
cluster on the horizontal axis and simultaneously in the
corresponding cluster on the vertical axis.
This pairwise stability matrix reflects many of the
characteristics of the cluster stability matrix described
above. Of particular value is the dispersion of entries.
Consider the extreme case where the two cluster sets are
perfectly correlated, i.e. all of the records within each
cluster for one of the cluster sets comprise an entire
cluster in the other cluster set. (This scenario assumes
that each cluster set has the same number of clusters.)
Thus in this matrix the number of cells with non-zero
values will correspond to the number of clusters in each

11th International Conference Information Visualization (IV'07)
0-7695-2900-3/07 $20.00 © 2007

cluster set. The extent to which two clusters sets reach
this maximum correlation pattern is a measure of the
stability between the two cluster sets.
It should be noted that the pairwise stability matrix
does not exhibit the two important characteristics of the
cluster stability matrix. First, the diagonal does not
necessarily contain any particular values as was the case
for the cluster stability matrix, since the order of similar
clusters in a cluster set are somewhat arbitrary. Even in
the case where there is perfect correlation between the
two cluster sets, the identical clusters do not have to fall
in the same order. You will have the number of cells
with non-zero values equal to the number of clusters in
each cluster set but they will be scattered throughout the
matrix.
Furthermore, the pairwise stability matrix is also not
symmetric around the diagonal. The number of records
in the ith cluster of the first cluster set that are also in the
jth cluster of the second cluster set does not have to be the
same as the number of records in the jth cluster of the
first cluster set that are also in the ith cluster of the second
cluster set.
As was the case for the cluster stability matrix, the
pairwise stability matrix is also easily viewable as a heat
map visualization. The extent to which any cluster is
dispersed in the other clustering set can be assessed by
simply inspecting the corresponding row or column.
The concept of the pairwise stability matrix as
applied to the simple case above is as follows:
Algo 1

Algo 1

Algo 1

Cluster
1

Cluster
2

Cluster
3

Algo
2

Cluster
1

0

0

1

Algo
2

Cluster
2

2

0

0

Algo
2

Cluster
3

0

0

1

2.3 Datasets Used
We studied two newt (N. viridescens) gene
expression datasets. One was created using a lower
precision spotted array (‘homemade’ chip created at the
University of Utah Core Facility) containing only 4
replicates of each cDNA sequence measuring gene
expression levels. The second was a custom designed
commercial Agilent chip that possessed greater precision
in measurement capability. It had 23 replicates for each
DNA oligonucleotide sequence measuring gene
expression levels. These possessed SD values only 2-3%
that of the measured raw expression value.

In order to provide as consistent a basis for
comparison as possible between the two datasets, we
selected for our clustering activity only the common
gene sequences occurring on both chips (500 total) as
well as the common measurement times (one chip/time
point) post-amputation.. The spotted array experiments
were conducted using RNA isolated from the N.
viridescens regenerating blastema structure at seven time
points following forelimb amputation These times
ranged from as early as four hours to five days post
amputation.
The Agilent chip experiments were
performed at time points between one to twenty one days
following forelimb amputation. We further selected for
our analysis only those times post-amputation that were
in common between the two chip dataset types.
Besides the differing time period over which the
experiments were performed, the other major difference
was in the quality of the data. Thus, the aim of this paper
was in part to provide the capability to evaluate the
effectiveness of the heat map visualizations in
distinguishing the relative quality of the data from the
two chip types.

2.4 Clustering Algorithms
Eleven clusters were generated using each algorithm of
the following clustering algorithms once: K-means,
expectation maximization, extended K-means, and
density based clustering built on K-means. The number
of clusters, eleven, is based on a log-likelihood function
based on 10-folder cross-validation.

3. Results
3.1 Stability matrix for a single microarray
experiment
Figure 1 is the stability matrix calculated for the
Agilent dataset. It is based upon the results of all four
clustering methods. The values on the X and Y axes are
the five hundred genes common to both chip types
ordered on each axis by the results of the K-mean cluster.
The lighter colors represent cases where the gene on the
X-axis and the gene on the Y-axis tend to fall into the
same clusters.
White represents the maximum
correlation where all four algorithms yield the same
result. The darker colors represent cases where the two
genes do not fall into the same cluster. The black areas
therefore represent the gene combinations that do not fall
into the same clusters at all.
As expected, the cells along the diagonal are all
white because these cells represent the identity, i.e. the
number of times a gene is in the same cluster as itself
which has to equal the number of algorithms used.
Furthermore, because the genes on each axis were
ordered by the K-means cluster set, there tend to be
blocks of lighter values along the diagonal. In fact, the
extent to which such blocks are not white along the
diagonal is an indication of the lack of stability of the

11th International Conference Information Visualization (IV'07)
0-7695-2900-3/07 $20.00 © 2007

genes, that is. sets of genes are not consistently in the
same clusters.

Figure 1 Stability Matrix for the Agilent Dataset

3.2 Identifying Similar Clusters
The cluster stability matrix provides a rapid and
powerful visual means of identifying clusters that exhibit
either similar or dissimilar characteristics. In the case of
two clusters being similar, it is to be expected that genes
in those two clusters would be in one cluster for some
algorithms and in the other cluster for the other
algorithms. This behavior is exhibited in Figure 1.
Along the same horizontal line as the third large light
box along the diagonal (starting from the upper left of
the figure), there is another relatively light box. This
means that the genes in this cluster have been assigned to
another cluster for some of the algorithms. This
behavior suggests that these two clusters share similarity.
This is in fact the case as illustrated in the parallel
coordinate visualizations for each of these two clusters,
Figure 2 and Figure 3.

Figure 2 Agilent Gene Expressions for K-Means
Cluster #6

Figure 3 Agilent Gene Expressions for K-Means
Cluster #10
A reordering of the clusters by which the genes are
ordered on both the X and Y axes produces a clearer
picture of the cluster stability, as we show in Figure 4.
(It should be noted that two other clusters, cluster #4 and
cluster #7, also exhibited this behavior so they were also
moved closer to each other.) By moving the two similar
clusters discussed above, more of the lighter areas,
representing combinations of genes with the same
clusters, move closer to the diagonal. Therefore, the
extent of the stability becomes clearer.

of dark area vs. light area in the cluster stability matrix.
For example, if the portion of the off diagonal area is
dark, this would indicate that the cluster sets are
relatively stable.
This characteristic was evaluated by comparing the
Agilent chip data, which has a high level of record
precision (23 replicates of each cDNA on the chip
measured average gene expression values with only 23% SD values), compared to the less precise
‘homemade’ spotted array dataset (only 4 replicates of
cDNA’s). By comparing the cluster stability matrix for
the spotted array data in Figure 5, to that of the Agilent
data in Figure 4, it is clear that the Agilent matrix has
much more contiguous off-diagonal dark area and the
light areas tend to be more localized than with the
spotted array dataset. In fact, the light areas in the matrix
for the spotted array data are so scattered that it was not
possible to even reorder the clusters on the axes in an
effective way. There are also significantly more white
areas in the Agilent matrix (5.2% of the total area) than
in the spotted array data matrix (3.2%). This quantitation
validates our contention that the Agilent dataset provides
more precise descriptions of gene expression values than
does the spotted array dataset, and therefore possesses
more stable clustering behavior.

Figure 5 Cluster Stability Matrix -- Spotted Array
Dataset
3.4 Comparing Cluster Sets Using Pairwise
Stability Matrices
Figure 4 Cluster Stability Matrix -- Agilent Dataset
Reordered
3.3 Comparing Quality of Different Datasets
using the Cluster Stability Matrix
The cluster stability matrix provides a means of
comparing the data quality for the same record values
occurring in two separate chip type experiments on the
same data. As the quality of the data improves it can be
expected that the cluster sets would exhibit greater
stability. This would be reflected in the relative amount

11th International Conference Information Visualization (IV'07)
0-7695-2900-3/07 $20.00 © 2007

Pairwise stability matrices provide the ability to
graphically compare the performance of two clustering
algorithms. If the pairwise heat map has low or zero
values in a relatively large portion of the cells, the two
clustering techniques exhibit similar record distribution
results amongst the clusters. This behavior is exhibited
in both Figure 6, a pairwise stability matrix for density
based (DB) clustering vs. K-means (KM) clustering, as
well as in Figure 7, a pairwise stability matrix for density
based clustering vs. expectation maximization (EM)
clustering. The former has a greater amount of dark area
than the latter. The fact that the density based clusters

and the K-means clusters fall along the diagonal suggests
that the two techniques are similar not only in terms of
results but also in terms of the manner in which those
results were arrived at.

seen in Figures 1, 4, and 5 above, the lighter squares
along the diagonal have patterns of light and dark cells
within them. By reordering the records within these
squares, a more homogeneous display can be generated.
This leads to a clearer understanding of the stability of
the records across cluster sets.

Acknowledgements
The authors acknowledge support to the IVPR and
CIB from the CFCI at the University of Massachusetts
Lowell as well as partial funding from a DARPA
Restorative Injury Repair Grant.

References
[1]

[2]

Figure 6 DB vs. KM Clustering Applied to the Agilent
Dataset
[3]

[4]

[5]

[6]

Figure 7 DB vs. EM Clustering Applied to the Agilent
Dataset

4.0 Conclusions
Employing complex biological microarray datsets of
different precision, this investigation study has shown
that the cluster stability matrix is useful in assessing the
gene record stability of cluster sets, as well as being
useful in visually identify clusters that exhibit similar
characteristics. In addition it provides a rapid method for
comparing the data quality of the same gene record
values found in the two microarray experiments
possessing different precision levels.
One promising extension of the use of the cluster
stability matrix is to investigate the impact of reordering
the records along the axes within clusters. As can be

11th International Conference Information Visualization (IV'07)
0-7695-2900-3/07 $20.00 © 2007

Cvek, Urska 2004 Visual and Analytic Tools for Record
Level Cluster Analysis, Submitted in partial fulfillment
of the requirements for the degree of Doctor of Science
in Computer Science, University of Massachusetts
Lowell and unpublished communications
Zhou, Jianping 2007 Stability Metric and Visualization
for Partition Comparison and Evaluation, Submitted in
partial fulfillment of the requirements for the degree of
Doctor of Science in Computer Science, University of
Massachusetts Lowell
A. Ben-Hur, A. Elisseeff, and I. Guyon, (2002) A
stability based method for discovering structure in
clustered data, Pacific Symposium on Biocomputing,
vol. 7, 2002, pp. 6--17.
C. D. Giurcaneanu, I. Tabus, I. Shmulevich, W. Zhang
(2003) Stability-based cluster analysis applied to
microarray data, Seventh International Symposium on
Signal Processing and its Applications, Paris, France
Costa, I. G., de Carvalho, F. A. T., de Souto M. C. P.
(2002), Stability Evaluation of Clustering Algorithms for
Time Series Gene Expression Data, Proc. of I Brazilian
Workshop on Bioinformatics, 2002, 88-90.
Fayyad U., G. Grinstein and A. Wierse (2001).
Information Visualization in Data Mining and
Knowledge Discovery, Morgan-Kaufmann Publishers


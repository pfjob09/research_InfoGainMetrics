2009 13th International Conference Information Visualisation

Visualisation of Client Networks from a Large Database
Terry Bossomaier, Russell K. Standish, Mike Harr´e
Centre for Research in Complex Systems, Charles Sturt University (CRiCS and UNSW, CRiCS
tbossomaier@csu.edu.au hpcoder@hpcoders.com.au, mharre@csu.edu.au
Abstract

visors were given hidden trailing commissions or promoted
a fund owned by their parent organisation.
Thus trust in financial services became an important issue for banks and other providers to confront. Trust comes
in many flavours. It may arise as trust in the integrity of
institutions, trust in professions (such as doctors), trust in
qualifications and so on. Trust and reciprocity are fundamental mechanisms in social groups [11],[8],[12].
Recently a lot of interest has appeared in the fundamental neuroscientific basis of trust. Hormones such as oxytocin are now known to mediate trust between individuals [6]. On the other hand the behaviour of individuals in
economic games may be used to assess how trust grows [4]
and brain imaging studies have begun to show how trust is
implemented in the brain [5] [9], [10], [14].
This paper is embedded within a larger project focussed
on building an ABM of trust between Wealth Management Advisors (WMAs) and their clients, fusing together
insights from social/evolutionary theory, neuroscience and
psychology. It has two distinct goals:

This paper describes the analysis of a large customer
dataset derived from the banking sector as part of a larger
project in agent based modelling. Mutual information is
used to determine connections between customers and statistical analysis can be carried out on this network. However, the standard metrics of small world or scale free networks do not fit well and visualisation is essential to a
deeper understanding of the network structure.
Keywords— Social networks; financial advice; mutual information; large graph layout.

1

Introduction

Today’s companies operate in a very complicated and
sometimes turbulent environment. Unexpected changes in
global resources, such as food crises in 2008 and escalating
oil price can dramatically change market positions. On the
other hand the subprime mortgage meltdown has revealed
just how complicated and fragile financial systems can be.
Decision support systems and mining of the vast quantities of consumer data in corporate data warehouses are
valuable but their capacity to predict future requirements is
often limited to narrow extrapolation from the past. More
powerful scenario planning systems are needed which can
explore new trends, such as, for example, the rapid switch
of agricultural land from food to biofuel production, the
effects of bioterrorism, or the interaction of people and
climte change.
Agent based models (ABMs) attempt to model people,
companies and external forces and to go beyond simple
extrapolation. From early minimalist models, some ABMs
now incorporate many millions of agents, such as the large
Epicast models for studying pandemics in the USA.
Until a few years ago Australian workers were in general locked in to the superannuation fund provided by their
employer. But following deregulation, people were allowed to choose to which of many available funds they
belonged. Inevitably this created a significant market for
financial advisors. At first such services were poorly monitored and advice was not always sound. Worse there were
a number of concerns about conflict of interest, where ad978-0-7695-3733-7/09 $25.00 © 2009 IEEE
DOI 10.1109/IV.2009.77

1. to examine the dynamics of trust, to look for phase
transitions and indicators of declining trust. This
was essentially an abstract artificial life model [2].
2. to build a realistic agent based model derived from
real data (referred to as a full ABM).
It is the second model which drives this this paper. To
build a successful full ABM requires several components:
(a) data or validated psychological models of the behaviour
of agents (in this case clients and advisors) (b) the connectivity of the agents, who interacts with whom, and data
to validate the model; (c) external forces such as general
economic conditions. This paper concerns only (b), the
construction of the client networks. Companies frequently
collect large volumes of customer data, but this is often not
collected with particular mining operations in mind. In the
present project the relationships and interactions of customers was not stored in the database and methods of visualising and subsequently modelling these interactions
were required.
369

2

The Datasets

know and share information with each other, then investments made by one may be followed by similoar investments made by the other. Thus there will be shared (mutual) information between the investement time series.

A large dataset of 456 million records describing 14
million customers over a five year period, and a smaller
more detailed dataset of 42 million records describing the
investment profiles of 1.5 million customers over a three
year period were supplied to the project.
The larger dataset was collected over a 60 month period, whereas the smaller one was collected over a shorter
time period of 24 months. Although both datasets contained much information about clients (although rendered
anonymous for the research), neither of them possesed crucial information about the social networks of the clients.
The smaller dataset had the advantage that the balances
for each of 20 financial instruments (investment products)
were recorded separately and their performance in the market was also available from the bank’s website. Since this
information is crucial to the ABM the smaller dataset, referred to hereafter as just the dataset was used.
From the dataset, it was possible to establish the investment profiles of the 1.5 million investment customers.
Whilst product performance was not available in this
database, it was possible to match the internal product
identifiers to published product information for 20 different
investment products, and to download the relevant product
performance from the bank’s website. Of the 1.5 million
customers in this dataset, some 118,528 had invested in one
or more of these investment products. The overwhelming
majority of customers in this dataset had only savings or
loan account.

3

3.1

Methods

The investment timeseries of the nearly 120,000 customers investing in products with known performance data
was computed using the technique described in sections 2
and 3.1. Since the absolute balances of the product investment do not carry meaningful information, and even
relative balance (monthly investment divided by product
balance) is distorted, the timeseries were converted to the
range {−1, 0, 1}, representing withdrawal, no investment
and investment respectively in a product. Mutual information, M , was calculated in the usual way between these
reduced investment timeseries I(c, pr, t) for customer c,
product pr at time t:
M (c1 , c2 ; ∆)

=

p(x, y) ln
x,y

p(x, y) ≡

p(x, y)
p1 (x)p2 (y)

p(I(c1 , pr, t) = x,
I(c2 , pr, t + ∆) = y)

p1 (x) ≡

p(I(c1 , pr, t) = x)

p2 (y) ≡

p(I(c2 , pr, t + ∆) = y)

(x, y) ∈ {−1, 0, 1}2 |(x, y) = (0, 0)

(1)

Here the probability distributions were computed from the
histograms of the 20 investment products and all timeseries
points t (Jan 2002 – Aug 2003 inc).
If we time shift one series, A, relative to the other,
B, then if A causes B, the causative effect in A occurs
earlier than the effect in B. So the mutual information
should be maximal when the series are time shifted by this
amount. Formally, offsetting the timeseries by ∆ in the
range [−3, +3] months allows for possible causality to be
inferred, but there are circumstances where a prior common cause may also cause the maximum to be at a nonzero ∆. By maximising the mutual information over ∆,

Network Analysis

As discussed above, the trust model requires understanding of the social networks of clients. Although there
is plenty of empirical evidence for small world [16] or
scale free connectivity [1], there are no fields in the data
warehouse which capture the links between clients. Furthermore there are no obvious proxies, e.g. children attending the same school or membership of the same sports
clubs may be harbingers of interactions, but no data of this
kind is available. Hence a deeper inference system was
needed. The solution is in looking at the time series of
investments and determining how one client’s investments
correlates with another. Correlation between time series is
a well understood metric but it can sometimes miss nonlinear interactions commpletely. Mutual information is a
more powerful, although computationally more demanding technique [3].
To see how this works, imagine two clients who have
no relationship with one another. Outside the turmoil of
stock market crashes or bubbles in particularly sectors, the
investment behaviour of one will only weakly predict the
other. Thus the time series of their investments will have
a low mutual information. On the other hand if the clients

M (c1 , c2 ) max M (c1 , c2 ; ∆)
∆

(2)

the sign of ∆ for which the M is maximised could suggest a direction on the network link, pointing from c1 to
c2 if ∆ is positive, and vice versa. The visualisations here
use the maximum M but do not include the directionality.
Section 4 suggests methods for more accurately assessing
causality.
The customers in the dataset could be classified according to whether their investment patterns were static “setand-forget” (either no investment, or a regular monthly

370

1e+08

"histo0.1.dat"

1e+07

1e+06

100000

10000

1000

100

10

1
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

Figure 1: Histogram of mutual information values

amount set up as an autopay), or actively managed. Therefore, the dataset was further reduced to just those customers classified as active investors more than 5% of the
time (almost 120,000 customers).
With a continuous measure of distance such as this one,
the network is effectively fully connected. Hence some
thresholding is necessary. The approach here is to examine
the histogram of M values as shown in figure 1.
The account balances against each of these is given
monthly for a period of 20 months, making each investment series 420 points in length. Using this approach, the
mutual information will show sharp changes as the number
of products mutually invested in by the clients increases.
In fact few clients invest in more than a couple of products,
leading to plateau like characterisitics. Note that if a client
shows similar temporal investement behaviour, but with a
different financial instrument, this will show up as a low
mutual information value. Furthermore, the two timeseries
are shifted relative to each other by up to 3 months, and
the maximum mutual information taken. The sign of the
offset value indicates a possible causal influence between
the two clients, whereas a zero offset might indicate that
both clients are under the influence of a third party (who
may or may not be in the dataset). The results are then collected for the maximum mutual information across these
time shifts.
Figure 1 shows the histogram of the mutual information
values. The regions of lower average slope suggest fundamental changes in client behaviour or relationships and
possible thresholds for which to examine the networks. At
a threshold of 0.5 or above, the networks essentially disappear, leading us to examine thresholds of 0.25 and 0.35
Displaying graphs with very large numbers of nodes

and edges is not easy. Figure 2 shows the result of using the Large Graph Layout (LGL) software [7] to display
the network with a threshold of 0.25 corresponding to the
first plateau in figure 1. With a higher threshold of 0.35,
much of the overall structure remains but there are significant differences (figure 3). LGL uses a spring model where
each edge is represented by a spring. After thresholding
the edges all have the same weight and are non-directional.
An equilibrium position is found when the spring energy is
minimal across all the nodes.

4

Discussion

The data warehouse did not contain any information
about client networks and thus a new inferential approach
was explored. The mutual information in the investment
time series between clients was calculated and client networks were inferred for different threshold values.
Much recent work in networks has realised two common types of network in social systems, scale free and
small world. Scale free networks have a power law distribution of node degree distributions [1] according to equation 3
p(k) ∝ k −γ

(3)

where k is the number of connections and γ a constant.
Such networks exhibit increasingly large “hub” nodes as
the total network size increases, rather akin to the hubs
used by airlines in their routing. The highly connected
hubs make the graph diameter low, i.e. the shortest path
between any two nodes is low. So to go from Bathurst in
regional Australia to the small community of Santa Fe in
New Mexico, requires just Sydney, Los Angeles and Albuquerque as intermediate nodes.

371

Figure 2: Large Graph Layout of the mutual information links with a threshold of 0.25. The graph comprises 118,528 nodes
with 14 million links. The nodes are red. The edges vary from yellow to black.

372

Figure 3: Large Graph Layout of the mutual information links with a threshold of 0.35. There are 118,528 nodes with 5
million links.

373

References

Small world networks on the other hand have low graph
diameters, but do not have the large hubs. The low diameter is achieved through short cuts between distant nodes.
Although these types of network are common in social
situations, the visualisations (and numerical estimates) do
not seem to support there presence here. The networks
have one large cluster around the root node (the node with
highest number of links), with distinct local clusters (the
hot-cross bun like features clearly visible in figure 2. Yet
there are also a few satellites outside with relatively weak
connection to the central cluster. The strong red colour indicates that these satellites contain a significant number of
nodes.
These visualisations have directed further analysis of
the data. The hot-cross bun features need to be examined
in detail to determine whether the clustering is a feature
of geography, client profile or is in some way related to the
bank. The central cluster satellite structure is itself interesting and not what one would have expected from previous
work on social networks.
The threshold approach used here exploits the characteristics of the histogram. But there are other approaches
which could be investigated. Tumminello et al. [15] examine the topology of graphs for stock market data. They
find that much of the edge weight of their stockmarket data
can be captured by a genus 0 subgraph — i.e. the graph
which captures as many edges as possible whilst remaining planar (i.e. can be drawn in the plane with no edges
crossing over). The significance of topological simplicity
is not fully understood, but this seems worthy of further
investigation for our data.

5

[1] A-L. Barab´asi. Linked: The New Science of Networks. Perseus, Cambridge, Massachusetts, 2002.
[2] T. Bossomaier, D. Jarratt, M.M. Anver, J. Thompson,
and J. Cooper. Optimisation of client trust by evolutionary learning of financial planning strategies in an
agent based model. In Proc, IEEE Conf. on Evolutionary Computing, pages 856–863, 2005.
[3] C. Cellucci, A. Albano, and P. Rapp. Statistical validation of mutual information calculations: Comparison of alternative numerical algorithms. Physical Review E, 71, 2005.
[4] J.C. Cox. How to identify trust and reciprocity.
Games and Economic Behaviour, 46:260–281, 2004.
[5] B. King-Casas, D. Tomlin, C. Anen, C. Camerer,
S. Quartz, and P. Montague. Getting to Know You:
Reputation and Trust in a Two-Person Exchange. Science, 308:78, 2005.
[6] M. Kosfeld, M. Heinrichs, P.J. Zak, U. Fischbacher,
and E. Fehr. Oxytocin increases trust in humans. Nature, 435:673–676, 2005.
[7] LGL. Large Graph Layout
.
http://bioinformatics.icmb.utexas.edu/lgl/ (2008) .
[8] A. Lotem, M.A. Fishman, and L. Stone. From reciprocity to unconditional altruism through signalling
benefits. Proc. R. Soc. Lond. B, 270:199–205, 2003.
[9] K. A. McCabe, D. Houser, L. Ryan, V.L. Smith,
and T. Trouard. A functional imaging study of cooperation in two-person reciprocal exchange. pnas,
98:11832–11835, 2001.

Conclusions

This paper has presented a novel approach to identifying and visualing relationships between very large numbers of clients from a corporate data warehouse. The mutual information in the time series of their investments indicates conjoint behaviour which was visualised with established graph techniques. The mutual information may be
influenced by common external factors influencing client
investment patterns. A computationally more demanding
measure advocated by [13] is the transfer entropy, in which
the joint probabality in the mutual information is replaced
by a conditional probabability. Further work will study the
networks based on transfer entropy and how it compares to
the time lags which generate the maximum mutual information.

[10] K.A. McCabe, M.L. Rigdon, and V.L. Smtih. Positive reciprocity and intentions in trust games. J. Econ
Behaviour & Organization, 2(267–275), 2003.
[11] M.A. Nowak and K. I. Sigmund. Evolution of indirect reciprocity. Nature, 437:1291–12298, 2005.
[12] K. Panchanathan and R. Boyd. Indirect reciprocity
can stablize cooperation without the second-order
free rider probem. Nature, 432:499–502, 2004.
[13] T. Schreiber. Measuring information transfer. Phys.
Rev. Lett, 85:461–464, 2000.

ACKNOWLEDGEMENT
This work was supported in part by grant LP0453657
from the Australian Research Council and a grant of computer time from the Australian Centre for Advanced Computing and Communications.

[14] T. Singer, B. Seymour, J.P. O’Doherty, K.E. Stephan,
R.J. Dolan, and C.D. Frith. Empathic neural responses are modulated by the perceived fairness of
others. Nature, 439:466–469, 2006.

374

[15] M. Tumminello, T. Aste, T. Di Matteo, and R.N.
Mategna. A tool for filtering information in complex
systems. Proc. Natl. Acad. Sci, 102:10421–10426,

2005.
[16] D.J. Watts. Small Worlds. Princeton University Press,
1999.

375


Elimination the Influence of the Mesh Geometry
to the Quality of Global Smoothing
Gernot Opriessnig, Markus Kettler and Gernot Beer
University of Technology Graz
Institute for Structural Analysis
SiTu-Research Group
LessingstraRe 25/11 A - 8010 Graz Austria
Tel.: +43-316-873-6686
Fax: +43-316-873-6185
email: gernot.opriessnig@ifb.tu-graz.ac.at

The visualisation system is currently available on a
workstation with stereo option, on a PC running Windows
NT using head mounted display and has undergone
preliminary tests in the CAVE environment at Chalmers
University in Gothenborg, Sweden.
The major field of application for the Tunnelling
Visualisation System is the display of simulation data.
Usually numerical simulation is done, if an exact
mathematical formulation of the problem is impossible,
too complicated or the calculation would take too much
time. In the field of tunnelling an exact mathematical
formulation of the problem cannot be found, because it is
not possible to describe the geometrical and physical
properties of the rock with mathematical equations. A
high percentage of numerical simulation in tunnelling is
done using the Finite Element Method (FEM) [ 5 ] , so one
of the major requirements to TVS is the ability, to display
the results of a three-dimensional finite element
simulation of the tunnel advance.

Abstract
lti the lust years available coniputer-perfortnurice
becunie very high, new methods of solution huve beeti
developed, so more and inore tiumericul calculations cuti
be done in uti acceptuble time. That’s one reason, why
such methods are being used very frequently.
But not onl? the calculatioti itself; also the
visualisation of the dutu places a challenge to the
techniques used. Siniulution results huve very special
properties, which liuve to be considered f o r the
visualisation. Ignoring this fact produces uti output, that
tnakes it inipossible, to produa? confidence in the results.
A high qualit!, display of the results in realtinie is
necessuq’, in order to sell the nunierical siniulation to a
large audience. But the basic characteristics of the datu
niust not nie changed in order 10 keep the basic message.
The techniques, described here, fulfil this very
iniportunt requirenzent of scientific injorniution
visualisation.

2. Properties of FEM-Results
1. Introduction

The geometry for a finite element calculation is being
described with a mesh. Such a mesh consists of nodes and
elements, which are connected to of the nodes. All results
of the simulation are located on this mesh, so it is also the
base for the visualisation. One, very special property of
the calculation data is their position within the mesh.
Displacements are located in the nodes of the geometry,
where they also are needed for the visualisation. But the

Within the Austrian joint research initiative
“Numerical Simulation in Tunnelling” [ I , 21 a
visualisation project was established, to develop a
visualisation tool for the field of tunnelling. This
software, the “Tunnelling Visualisation System” [3]
(TVS) is being developed, to display information in a
way, that an engineer on a tunn.el-site can understand.

351
0-7695-1195-3/01 $10.00 02001 IEEE

function is, to make a difference between points which
are close to the searched value and ones which are fare
away. As a matter of course the influence of a point must
decrease with the distance. A function, used for weighting
has to fulfil this requirement. Mathematically formulated
that means, that the function have to be declining in a
strictly monotonously manner.

values of the stress-tensor are calculated in points within
each element, the so called Gauss-Integration points.
Elements are defined in a local system of coordinates 5 ,
q and 5. The edges have the local coordinates f 1 , the
Gauss-Integration Points k l/& .
Figure 1 shows an element with these points.

Figure 1: Finite Element with four Gauss-Integration
points.

To draw the geometry only the nodal points can be
used, because the model cannot be described using the
Gauss-points. Sometimes, when threedimensional
elements are used, these points are even not part of the
drawn surface.
For the visualisation of scalar surface-data as contour
plot it is necessary, to know the contour-value in the
mesh-nodes. As stresses are not known there, it is
necessary, to extrapolate. This is the reason for a special
problem: Due to the calculation-method it is not
guaranteed, that the extrapolated values from different
elements are equal in one point. If the data are visualised
as they are, this circumstance causes discontinuous
contours (Fig. 2). That does not mean, that the results are
incorrect, but inappropriate for presentation.

Figure 2: Discontinuous contours in the display of stress

3.1 Parameter tests f o r regular meshes
To find the most suitable one, parameter-tests have
been performed. Figure 3 shows the tested types of
functions, where a is the parameter, to modify the
characteristic of the function and r is the distance.

1

3. Global Smoothing
To solve this problem, it is necessary to find a unique
value for each surface node. In [6] a method to find this
data has been presented. This global smoothing algorithm
is based on a weighted average of all available data
points. In case of a Finite Element calculation these points
are the Gauss-Integration points. A weighted average can
be divided into two major parts: The weighting function
and the kind of average. The purpose of the weighting

I

Figure 3: Weighting functions

352

cos( r)['

The second part of the algorithm is the kind of
average. The mathematics know a lot of methods for this
purpose. For the parameter test four types have been
selected:

Elements. The third coordinate was set to.zero. From the
resulting 5*5 square, only the middle three upper element
borders have been evaluated, to prevent boundary effect
caused by the low number of elements. Figure 4 shows
the configuration.

Arithmetic:

Zf ( 5 )
i=l

Geometric:
Figure 4: Geometrical base for the tests
The criteria for the selection are the quality of the
results and the necessary calculation effort. One very
important aspect concerning quality is the keeping of
basic characteristics. If the unsmoothed data have a linear
trend, the smoothed ones must also have this. That's why
the tests have been done also with regular data-sets (Fig.

Quadratic:

5).

Figure 5: Extrapolated test-data compared to smoothed
ones (top) based on a regular base (bottom)

n.. total number of Gauss points (GP)

rl.. distance between GP, and unknown point
f(r,)..weighting function
wl.. value in GP,

The best combination as a result of these test is the
arithmetic average, weighted with the square of the
distance.
1

In general it can be said:

HM I GM 5 AM 5 QM
Wndr

To find the best combination of weighting function
and kind of average parameter tests have been performed.
The geometrical base of the test was a cube with 5*5*5

=

Z w ;*i=I
(5

$L
i=1

353

>'

(I;)*

3.2 Parameter tests for irregular meshes
To prevent this, it is necessary, to include the size of
the element to the weighting function. The most easy and
mathematical reasonable way of this is to do this linear.
Therefore the global smoothing algorithm has to be
modified. so that it becomes to:

The tests described here are based on a very regular
geometry. A mesh for a calculation with the method of
finite elements usually is not regular, so it is necessary to
standardise the algorithm. The first aspect here is the
global size. If you look at the weighting function, you will
see, that it would make an unacceptable difference if the
geometry is defined e.g. in meters or centimetres.
Therefore a internal standard size has to be defined. The
Tunnelling Visualisation System scales all data-sets to a
size of 30. That means, that the influence to a point with
the largest possible distance is approximately 0.1 %.
Experience shows, that this value is OK.
The second aspect of irregularity are elements with a
different size. For the algorithm used, it must not make a
difference, if the same area is subdivided by one or 10
elements. To analyse the influence of the element size the
test configuration has been modified: The left column of
the box has been subdivided five times. If the size of the
element is ignored during calculation the influence of this
area to the global results is too high. Fig. 6 shows an
example for this effect.

n

T;' 1.47

A,..

*-

The element-size associated to GPi

The dimension of A; depends on the dimension of the
element. If this is threedimensional, A; is a volume,
otherwise an area or length. With this modified algorithm
the error in the results shown in figure
6 is eliminated.
(Fig. 7)

Figure 6: Extrapolated and smoothed results for geometric
irregular data including the influence of the element-size
Figure 6 : Extrapolated and smoothed results for geometric
irregular data

If the data base is a FE-mesh, A, can be found with
the help of that equations, which are used to describe one

354

element [5].As mentioned a linite element is defined in a
local system of coordinates (t , q and 5) with values in
the range between -1 and 1 . The element is being
described using shape-function. Each node has one shapefunction which has the local coordinates as parameter.
The order of the function depends on the type of element.
For a simple quadrilateral element:

Setting the integration borders to +/-1 will give the total
area as result. The range from 0 to 1 for both will give the
area of Gauss-Point 1.
The advantage of this method is that it works
independent from the type of element With the suitable
shape function it can be used for linear, parabolic, flat and
volumetric elements.

1
N , =-(1-<)(l-q)
4
1
N , =-(1+<)(1-~)
- 4

N,,. . .

4. Results
The modified global smoothing algorithm works
very well, independent from the mesh-geometry. Figure
7. shows the result of a test based on Figure 4 but
distorted, and a parabolic characteristic of the data, which
is excellent.

Shape function for node n

To transform local to global coordinates:

global coordinate vector at the position (5. v)
Global coordinates at node n

Figure 7: Extrapolated and smoothed results for distorted
geometry including the influence of the element-size

(v3I = lJ(

This algorithm can be applied to the output of any
finite element or boundary element calculation. Figure 8
shows the visualisation of the same data than in Figure 2,
but after application of the modified global smoothing
described in this paper. But it is not restricted to data from
numerical simulation. In the field of tunnelling a lot of
measurement data is available. The global smoothing
algorithm makes i t possible to find a realistic value in
each position, if the source data is a couple of geometrical
distributed points. This is the case for measurement data,
so it is possible to display the measurement data on the
same model than the simulation data.

where J is the Jacobian [5]

The size of the Element (in this case the area) can be
found with:

355

6. ACKNOWLEDGEMNT
The work reported here was supported by the
Austrian Science Found (Project Nr.: FWF-SO8001-TEC)

7. References
Beer G. et. al. ,,Austrian Research Initiative on
[I]
Numerical Simulation in Tunnelling" Proceedings of the World
Tunnel Congress 1999, A.A. Balkema/Rotterdam/Brookfield
Beer G. et. al. ,,Joint Research Initiative on Numerical
[2]
Simulation in Tunnelling" Felsbau 1/99, Verlag Gliickauf

GmbH Essen
Opriessnig G. ,,Visualisation in Tunnelling- a Virtual
[3]
Reality Environment for Tunnelling Engineers"
Felsbau 1/99, Verlag Gliickauf GmbH Essen

Figure 8: Simulation from Fig. 2 with modified global
smoothing

Golser H. ,,Application of Numerical Simulation
[4]
Methods on Site" Felsbau 1/99, Verlag Gliickauf GmbH Essen

G. Beer, J . Watson ,,Introduction to Finite and
[5]
Boundary Element Methods for Engineers" John Wiley & Sons,
1992

5. Conclusion and Future Outlook
Visualisation in an excellent quality is absolute
necessary to sell the numerical simulation. The
development and application of advanced visualisation
techniques is the consequence of the increase in use of
numerical methods. The result of a calculation is not
visible - not in a way that might be suitable to a large
number of users. The visualisation is the necessary link
between the data and the person, sitting in front of the
screen. The modified global smoothing algorithm
described in this paper is an essential part of the dataprocessing for the visualisation. It helps the user to
interpret and understand the information. Each step in
processing the data has to be done very carefully, because
the data must not be changed by the methods used. The
global smoothing algorithm fulfils this requirements.
The planned research in this area is the reduction of
the necessary calculation effort. This is necessary to apply
it to concurrent calculation e.g. for realtime simulation of
fire in a tunnel.

Opriessnig G., Beer G. ,,Visualisation in Tunnelling [6]
New Developments" Proceedings of 1999 IEEE Conference on
Information Visualisation IV'99
Opriessnig G., Beer G. ,,Data Optimisation for the
[7]
Visualisation of FEM-Results" Proceedings of 2000 IEEE
Conference on Information Visualisation IV'2000

,356


Finite Difference Surface Representation Considering
Effect of Boundary Curvature
Lihua You
Jian J Zhang
National Centre for Computer Animation
Bournemouth University
Poole, Dorset BH12 5BB
United Kingdom
Email: jzhang@boumemouth.ac. uk
computer graphics and computer-aided design to
complement the traditional geometrically based modelling
methods. Terzopolous et al. were among the first
researchers to study physically based surface modelling
approaches for computer graphics. In their initial work, an
elastic deformation model was proposed by Terzopolous
et al. [18]. Based on the theories of elasticity and the
finite element technique, deformable curve and surface
finite element formulae were implemented by Celniker
and Gossard [4]. The elastic deformation model was later
extended to include viscoelasticity, plasticity and fracture
by Terzopolous, et al. [19, 201. In order to describe
dynamic surface deformation, various physically based
dynamic surface modelling methods were developed by
Terzopolous, Qin, Mandal and Vemuri [13, 16, 17, 211.

Abstract
Surface representation using the solution to a partial
diflerential equation (PDE) is an important topic of
computer graphics and computer aided design. In existing
references, various free-from surfaces were created with
a fourth order PDE which is only able to meet the
tangential conditions at the surface boundaries. The need
for a sixth order PDE in surface modelling arises in two
situations: one is to generate surfaces with curvature
continuity; and the other is to use curvature values as a
user handle for surface shape manipulation. In this paper,
we introduce such a sixth order PDE for free-form
surface generation and develop a finite digerenee method
to solve this PDE. We also investigate the effects of
boundav curvature and the vector-valued shape
parameters on the surface shape. It is found that their
variation has strong influence on the shape of the
surfaces, therefore, can be used as flexible user handles.
Key Words: Surface representation, sixth order partial
differential equation, finite difference solution, boundary
curvature, shape parameters

These static and dynamic surface modelling methods

were developed from the theories of elasticity, plasticity
and fracture mechanics and implemented using the finite
element method and finite difference method. Applying
other mechanics approaches to generate surfaces has also
been studied by some researchers. For example, Leon and
Verson [9], and Guillet and Leon [8] applied a bar
network mechanics method to deform free-form surfaces.
Partial differential equation based surface modelling
method should also be classified as physically based
modelling. For cloth and other flexible fabrics, their
governing equations that represent the deformed surfaces
can be derived from the physical laws of elastic cloth
deformation and motion which are the fourth order
dynamic PDEs involving the mechanical properties [22,
241. PDE based surface modelling was first proposed by
Bloor et al. [2]. In order to extend the PDE based methods
to solve more complicated surface modelling problems,
some numerical methods, such as the finite element
method [IO, 11, 121, finite difference method [5, 61 and
collocation method [3] have been developed. Zhang and
You [25] also discussed the effectiveness and efficiency

1. Introduction
BCzier, B-spline and NURBS [7] are common
traditional surface and curve representations. Surfaces and
curves are manipulated through the use of the control
points.
In the real world, all objects have certain physical
properties and will change shape when they are subject to
internal and external actions. But the traditional surface
modelling methods do not attempt to describe the effect
of physics laws.
Physically based surface modelling methods have
attracted more and more attention in the communities of

0-7695-1195-3/01
$10.00 0 2001 IEEE

404

of surface modelling using the second, fourth and mixed
order PDEs.
In the above work, only the: second and fourth order
PDEs were applied. For a fourth order PDE, tangent
continuity.at the boundary curves of the surfaces to be
created can be taken into account. Therefore, such an
equation is effective in generating surfaces requiring
tangent continuity. However, in many engineering design
tasks, curvature continuity must be considered to satisfy
the functional or visual requirements. For example, the
streamlined surfaces of an aircraft, ship and submarine
with curvature continuity do not only look pleasant, but
more importantly reduce the risk of flow separation and
turbulence. In contrast, a cam dlxigned without curvature
continuity between two connected surfaces will cause
abrupt changes in acceleration resulting in harmful
impact.
Pegna [I41 proposed a method with which curvature
continuous fairing surfaces can be interactively generated.
For designing curvature continuous blending surfaces,
Pegna and Wolter [15] developed a linkage curve
theorem. Curvature continuity between two rectangular or
triangular patches was examined by Zheng et al. [26] with
the two patches being represented with rational BCzier
surfaces. Aumann [ 11 proposed the so-called normal
ringed surfaces to form curvature continuous connections
of cones andlor cylinders.
In this paper, we will use a sixth order PDE for freefrom surface representation to account for the effect of
boundary curvature. Since finding the closed form
solution of a sixth order PDE is imore difficult than that of
a fourth order PDE, we also develop a finite difference
technique to solve the propclsed sixth order partial
differential equation. How boundary curvature and the
shape parameters affect the surface shape will be
investigated. Surface representation examples will be
given to demonstrate the applications of the developed
method.

where

c = [cx c y c z

au6

a6

a

au4av2

au2;)v4

b ___ + c--

a6

+d-)x=O

av6

d = [d, d , d,

3’

are

vector-valued

a2x

curves, i. e., -. In this way, the boundary conditions

au

which include the effects of boundary tangent and
curvature can be written as

The solution of the sixth order partial differential
equation under boundary conditions (2) will result in the
representation of a surface.

3. Finite difference technique
The analytical solution of PDE ( 1 ) subject to
boundary conditions (2) is usually very difficult to obtain.
Only for some simple boundary conditions and special
combinations of the shape parameters, does the closed
form solution of Eq. ( 1 ) exist. Generally, Eq. ( 1 ) can only
be solved with numerical methods such as the abovementioned finite element method, finite difference
method and weighted residual method [23].
Among them, the finite difference method transforms
a PDE to a system of algebraic equations by replacing all
the partial derivatives in the differential equation with
their discretized approximations. In the following, we will
develop such a finite difference technique to solve PDE
(1) subject to boundary conditions (2).
T o facilitate the description, we define a new vector
product operator whose operands are two vectors of the
same dimension and each element of the resultant vector
is the product of the corresponding elements of the two
vectors, i. e.,

Boundary curvature continuity can be taken into
account with a sixth order PDE. Since the vector-valued
shape parameters in the equation exert a strong effect on
surface shape, they act as user handles for surface
manipulation. Therefore, instead of using one shape
parameter proposed by Bloor et ,al. [2], we introduce four
shape parameters and propose to use the following sixth
order PDE to represent free-from surfaces considering the
curvature boundary conditions

a6

p‘ ,

b=[bxbyb,Ir,

shape
parameters,
x = [x(u, v ) , y ( u , v ) , z(u, v)]’
represents a vector-valued function, and U , v are the
parametric variables.
Depending on the boundary conditions and the shape
parameters, PDE (1) can represent various free-form
surfaces.
In order to solve a PDE for the generation of a surface,
we must define proper boundary conditions first.
Normally, the curvature of a surface x = x(u, v ) can be
described with its second partial derivatives. In this paper,
we only consider the curvature crossing the boundary

2. Governing equations aind boundary
conditions

(a-+

a = [a, a y a , ]’,

(1)

405

(3), we obtain its finite difference formula at the typical
node 0 as follows

=[px

where P
p Y p z Y and q = [qx q y qzr' are two
column vectors.
Using the Taylor series expansion of a continuous
function f(u,v), we can derive its central finite
difference approximations of the first and second partial
derivatives at a typical node 0 shown in Figure 1 . Then
using the basic finite difference approximations of the
first and second derivatives to formulate the fourth and
sixth partial derivatives, we can obtain the finite
difference approximations of all the partial derivatives
required.
Substituting
these
finite
difference
approximations into PDE (1) and using the notation of Eq.

-4(5a + 3b + 3c + 4d)Xo + (15a + 8b + 6c)x I + (6b
+8c+15d)x2 +(15a+8b+6c)x3 +(6a+8c+15d)
~4 -4(b+c)(xS +X6 +X7 +x8)-2(3a+b)(x9

+~

1 1) 2(c+ W x 1 0

+xi2 )+b(xis + xi9 +x22
+x23)+c(x17 +x20+x21 +x24)+a(x25 +x27)
+d(x26 + x 2 8 ) = 0

(4)

-

where xi (i = 0 12,17 - 28) represents the co-ordinate
value of function x at node i .

r

Figure 1. Typical finite difference nodes
Substituting the basic finite difference approximations

where vo is the value of the parametric variable v at
node 0 .

of the first and second derivatives into boundary
conditions (2), the finite difference formulae at the typical

Dividing the resolution domain into m by n discrete
nodes, we can obtain the same finite difference formula
(4) for all the nodes at the inner resolution domain and
finite difference formula (5) for all the nodes at the
boundaries. Writing these finite difference formulae into a
matrix form, we obtain a set of linear algebraic equations
which has the form of

node 0 can be written as
u=o

xo =GI(%)
XI -x3 = 26G2(vo)
XI

u=l

XO
XI
XI

+x3 - 2 ~ 0= 6 2 G 3 ( ~ 0 )
(5)

= G4 ( V O )

-x3 =26G5(vo)

KX=F

(6)

The resolution of equations (6) will lead to the finite
difference solution of partial differential equation (1)
under boundary conditions (2).

2

+x3 - 2 ~ 0= S G g ( ~ 0 )

406

4. Effect of boundary curvature
In our previous discussions, we have mentioned that
the boundary curvature has a great influence on the shape
of surfaces to be created. In order to explore this effect
and develop it into a user handle for shape manipulation,
in this section, we will investigate the effect of boundary
curvature on the surface shape by a concrete problem of
vase surface representation.
The vase surface to be generated is defined by two
boundary curves represented with two concentric circles
of different radii. The boundary conditions considering
tangent and curvature effects can be written as
U

ax

= U , x = r, cos 2 m -= r,"cos 27m -= r:cos

a2x
au *

2m

JY = r,' sin 27m
y = r, sin 2 m -

5
= r:sin
au

2nv

z=h,

-- - h,"

au

au
az
-= h,'
au

-

h

2

au*

( i = 0 , 1)
(7)
where uo = 0, u1 = 1, ho = 0, and hl = h .
For the surface to be generated, the resolution domain
is a unit square in a two-dimensional space of parametric
variables U and v . Uniformly dividing this square
resolution domain into 20x20 nodes and solving the
above-developed finite difference equation (6), we obtain
the co-ordinate values of the surface at these nodes. In
this section, the basic geometric parameters are taken to
be: ro = 0.3, rd = r; = rl = 0.13 , hh = h; = h; = r; = 1 ,
r ; = O , h = 3 and h ; = 0 . 1 .
In order to investigate
the effect of boundary
curvature on surface shape, we fix the shape parameters in
a

vector-valued

form

a = c = d = [1 1 1IT

d

C

, .

e

. ..

" .

t

and

b =[-IO
-10
for all the case studies in this
section and only change the boundary curvature. Let us
first consider the effect of the boundary curvature whose
value is determined by r{ on the vase surface shape. The
initial value of r; given above produces the vase surface
in Figure 2a. Then it is set to r;=-20 and the image in
Figure 2a is changed to that in Figure 2b. Further setting
i t to r;=50 gives the surface shape in the Figure 2c.
Next, we investigate the effect of the boundary curvature
whose value is determined by I( on vase surface shape.
With the above basic geometric parameters but changing
r; to 30, the vase shape is changed to that in Figure 2d.
The image in Figure 2e is created with r;=-lO.
Similarly, the boundary curvature determined by h; and

f

,

.. .

.,

I

.~..

"

I

*'

Figure
Effect Of boundary curvature On
surface shape
h; also have an obvious effect on surface shape. Firstly,
taking h; = 80, we obtained the
shape in Figure 2f.

407

For simplicity, we demonstrate this with the same vase
surface representation example and the same node
collocation within the resolution domain as those in the
previous section. All the geometric parameters are also
taken to be those given in the previous section. Only the
shape parameters are changed. Firstly, we set the values

It is changed to that in Figure 2g when h: = -50. For the
boundary curvature determined by h;, a value of 30
gives the shape in Figure 2h and the value of -90 creates
that in Figure 2i.
These images clearly show that the boundary
curvature can effectively affect the shape of the surfaces.
By adjusting the values of the coefficients of the
boundary curvature functions in Eq. (7), we can obtain
different surface shapes.

of the shape parameters to a = 0 , b = [-lo -10 -10IT ,

c = d = [l 1 1IT resulting in the vase surface in Figure 3a.
Then fixing parameters b and d , and changing
parameters

5. Effect of vector-valued shape parameters

a

to

[l 1 I I T

and

c

to

[SO00 5000 500O]*, the surface shape in Figure 3b is
obtained. Keeping a and b unchanged, and setting c

Similar to the effect of the vector-valued shape
parameters in a fourth order PDE, the shape parameters in
our proposed sixth order PDE should also have a strong
influence on the surface shape. In order to study this
influence, in this section, we examine how the shape
parameters in PDE (1) affect the surface shape.

and d to [l 1 1IT and [70000 70000 70000IT,
respectively, the vase surface shape in Figure 3c is
generated. Finally, by only changing b to [30 30 30IT,
the shape in Figure 3c is changed to that in 3d.
From these images, it is clear that all the shape
parameters in the sixth order partial differential equation
(1) have a strong effect on the shape of the surfaces to be
generated. Therefore, these parameters can be effectively
applied as a surface shape manipulation tool.

6. Conclusions

a

Surface representation considering boundary curvature
is useful in both engineering design and computer
graphics. Existing surface representation methods based
on the solution of partial differential equations did not
tackle this problem. In this paper, we have proposed a
sixth order PDE which is capable of coping with such
boundary conditions for surface generation. In addition,
the proposed PDE introduces four vector-valued shape
parameters, which can be effectively used as surface
shaping tools.
Since the analytical solution of a sixth order PDE is
far more difficult to achieve than that of a fourth or lower
order PDE, a numerical resolution method is usually
sought as an alternative. In order to solve the proposed
sixth order PDE effectively, we have derived the basic
finite difference approximation formulae taking up to the
sixth partial derivatives. We have also transformed the
proposed sixth order PDE and the boundary conditions
into a resultant finite difference equation represented in a
matrix form.
W e have made some investigations to understand the
effects of the boundary curvature and the shape
parameters in shape manipulation. It was found that all
boundary curvature conditions and the shape parameters
have a great influence on the surface. Therefore, they can
be implemented into a surface modelling system as an
effective tool for surface deformation.

b

C

d

Figure 3. Effect of vector-valued parameters on
surface shape

408

[14] Pegna, J., 1989, Interactive design of curvature continuous
fairing surfaces, Proceedings of the Eighth International
Conference on Offshore Mechanics and Arctic
Engineering, ASME, New York, 191-198.

References
Aumann, G., 1995, Curvature continuous connections of
cones and cylinders, Computeji Aided Geometric Design,
27(4):293-301.
Bloor, M. I. G. and Wilson, hl. J., 1989, Generating blend
surfaces using partial differential equations, Computer
Aided Design, 21(3): 165-171.

[IS] Pegna, J. and Wolter, F.-E., 1992, Geometrical criteria to
guarantee curvature continuity of blend surfaces, Joumal
of Mechanical Design, Transactions of the ASME,
114:201-210.

Bloor, M. I. G. and Wilson, M. J., 1990, Representing PDE
surfaces in terms of B-splines, Computer Aided Design,
22(6):324-33 1 .

[I61 Qin, H. and Terzopoulos, D., 1995, Dynamic NURBS
swung surfaces for physical-based shape design,
Computer-Aided Design, 27(2): 11 1-127.

Celniker, G. and Gossard, D., 1991, Deformable curve and
surface finite-elements for free-form shape design,
Computer Graphics, 25(4):257-266.

[17] Qin, H. and Terzopoulos, D., 1997, Triangular NURBS
and their dynamic generations, Computer Aided
Geometric Design, 14:325-347.

Cheng, S. Y., Bloor, M. I. G . , Saia A. and Wilson, M. J.,
1990, Blending between quadric surfaces using partial
differential equations, in Ravani, B. (Ed.), Advances in
Design Automation, Vol. 1, Computer Aided and
Computational Design, ASME, 257-263.

[I81 Terzopoulos, D., Platt, J., Barr, A. and Fleischer, K.,
1987, Elastically deformable models, Computer Graphics,
21(4):205-2 14.
[19] Terzopoulos, D. and Fleischer, K., 1988, Modeling
inelastic deformation: viscoelasticity, plasticity, fracture,
Computer Graphics, 22(4):269-278.

Du, H. and Qin, H., 2000, Direct manipulation and
interactive sculpting of PDE surfaces, Computer Graphics
Forum (Eurographics’2000 Prcc.), 19(3):261-270.

[20] Terzopoulos, D. and Fleischer, K., 1988, Deformable
models, The Visual Computer, (4):306-33 I .

Farin, G., 1997, Curves and Surfaces for Computer Aided
Geometric Design: A Practical Guide, 4th Edition,
Academic Press.

[21] Terzopoulos, D. and Qin, H., 1994, Dynamic NURBS
with geometric constraints for interactive sculpting, ACM
Transactions on Graphics, 13(2):103-136.

Guillet, S. and Leon, J. C., 1998, Parametrically deformed
free-form surfaces as part of a variational model,
Computer-Aided Design, 30(8):621-630.

[22] You, L. H., Zhang, J. J. and Comninos P., 1999, Cloth
deformation modelling using a plate bending model, The
7th International Conference in Central Europe on
Computer Graphics, Visualisation and Interactive Digital
Media, 485-49 1.

Leon, J. C. and Veron, P., 1997, Semiglobal deformation
and correction of free-form surfaces using a mechanical
altemative, The Visual Computer, 13:109-126.

1231 YOU,L. H., Zhang, J. J. and Comninos, P., 2000, A solid
volumetric modei of muscle deformation for computer
animation using the weighted residual method, Computer
Methods in Applied Mechanics and Engineering,
1901853-863.
~~

[lo] Li, Z. C., 1998, Boundary penalty finite element methods
for blending surfaces, I. 13asic theory, Joumal of
Computational Mathematics, 1 (i:457-480.
[I 11 Li, Z. C., 1999, Boundary penalty finite element methods
for blending surfaces, 11. Biharmonic equations, Journal of
Computational and Applied Mathematics, 1 10:155176.

[241

J.
L. H. and Comninos ‘.’ 1999,Computer
simulation of flexible fabrics, The 17‘h Eurographics UK
Conference, 27-35.

[I21 Li, Z. C. and Chang, C.-S., 1999, Boundary penalty finite
element methods
for blending
surfaces,
111,
Superconvergence and stability and examples, Journal of
Computational and Applied Mathematics, 1 10:241-270.

[2si

J. J’ and
L.H’!
Surface representation
using second, fourth and mixed order partial differential
equations, International Conference on Shape Modelling
and Applications, Genova, Italy, 7-1 1, May.

[13] Mandal, C., Qin, H. and Vemuri, B., 2000, Dynamic
modeling of butterfly subdivision surfaces, IEEE
Transactions on Visualization and Computer Graphics,
6(3):265-287.

[26] Zheng, J. M., Wang, G. Z., and Liang, Y. D., 1992,
Curvature continuity between adjacent rational BCzier
patches, Computer Aided Geometric Design, 9(5):32 1335.

409

J7

2o011


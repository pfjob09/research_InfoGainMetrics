A rational cubic spline for the visualization of convex data
Zulfiqar Habib
Department of Mathematics and
Computer Science, Graduate School
of Science and Engineering, Kagoshima
University, Kagoshima 890-0065, Japan
zulfiqar-habib @ hotmail.com

Muhammad Sarfraz
Department of Information and
Computer Science, King Fahd University
of Petroleum and Minerals, KFUPM # 15 10
Dhahran 3 1261, Saudi 'Arabia
sarfraz@kfupm.edu.sa

Abstract

are discussed in Section 3. Section 4 describes the generation of a C2 spline which can preserve the shape of convex
data with no inflection point and singularity. It also demonstrates the output of the scheme for various C and S-type
data sets in literature. Concluding remarks are given in Section 5.

This paper discusses the distribution of injection points
and singularities on a piecewise parametric rational cubic
spline. Necessaiy and suficient conditions f o r a convei
data have been presented. High degree of snioothness is
obtained with automatic estimation of tcvofamilies of shape
preserving parameters for local convexity.

2

Let F, E R', i = 1,.., n, be a given set of data points at
the distinct knots t , E R. where t l < t r < ... < t,. Then
a parametric C1-piecewise rational cubic Hermit function
P:R-+R' is defined by

1 Introduction
Smooth curve representation, to visualize the data without undesirable infelction points and singularities, is of
great significance. In CAGD applications, it is often desirable to find the conditions such that a curve may or
may not have cusps and inflection points. The detection
of cusps and infection points are addressed in [2][3] and
there is a considerable literature on numerical methods for
generating shape preserving interpolation; see for example,
[ 1][4][5][6].We show, in this paper, that curvature continuity and high accuracy can be achieved by a simple algorithm
which is based on the geometric characterization of C' continuity. The objectives of this paper are as follows:
a) to obtain the distribution of inflection points and a singularity (a loop or a cusp) on the planar rational Bezier cubic curve.
b) to produce C' interpolant for high degree of smoothness which provides an automatic procedure to obtain the
derivative parameters instead of the approximation choices.
No additional points (knots) are required.
The paper begins with a definition of the rational function in Section 2 where the description of rational cubic
spline, which does not preserve the shape of a convex data,
is made. This section derives the constraints, on derivative
parameters, which lead to a linear system of equations and
seek for the existence and uniqueness of their robust solution. The distribution of inflection points and singularities

(1)

where

+

p(t) = (1 - t)",
t ( l - t)2u,V,
t 2 ( l- t ) w , W , + t 3 F L + l

+

q(t)

V,

+

= (1 - t ) 3 t ( l - t)",
D,
= F, + -

+ t'(1

- t)W,

+t3

U,

We use this Hermite function to generate an ,interPolatory parametric curve which preserves the shape of locally
convex data. Let

where

744

0-7695-1195-3/01 $10.00 0 2001 IEEE

Rational cubic spline with shape control

where

5’: = (FZ1 - F,”),S,V
= ( Fz Y
+l

-F3

a ( t )=

and D, denotes the tangent vector to the curve at the knot

+

tz.

- 2st3
ASt(2Vit2

- s2t2wi

+ 2wzs2 + 3st + vzwzst)

q t ) = t 4 - 2s3t - s2t2vi
+ pst(2vit2 + 2 W i S 2

2.1 Shape control analysis

+ 3st + vzwzst)

Taking derivative of (3) w.r.t. t , we get,

The parameters vi and wtcan be utilized properly to
modify the shape of the curve according to the desire of
the user. Their effectiveness, for the shape control at knot
points, can be seen that if vi:wi-1 -+ CO, then the curve
is pulled towards the point :Fi in the neighbourhood of
the knot position ti. This shape behaviour can be observed by looking at P(t) in ( I ) . One can observe that if
vi,wi-1 -+ m, then Vi and ‘Wi-l -+ Fi. When both vi
and wj -+ 00,then Vi -+ Fi and Wi -+ Fi+l.

0.E

2.2 Determination of derivatives

0.4

The smoothness of the interpolant (1) is C1. We achieved
higher degree of smoothness to C’ by imposing the second
derivative constraints:

0.;

- A

c

p(’)(ti-) = P(’’(ti+),‘rj = 2 , 3: ..., 71 - 1
-0.;

at the knot positions of the interpolant ( 1 ) . It leads to the
consistency equations:

-0.

c

-0. i

For given appropriate end conditions Dl and D,,, this
system of equations is a tridiagonal linear system. This is
also diagonally dominant for vi , w,2 2, i = 2 , 3 , ..., n - 1
and hence has a unique solutiori for D,.

3

Figure 1. Distribution of inflections and singularity.
To determine inflection points on ( I ) we take P’(t) x
P”(t)= 0, 0 < t < 1 and get

Inflection points and singularities

a(t)b‘(t) - a ’ ( t ) b ( t )= 0

In this paper, we assume that the tangent vectors D,
and D,+1, z = 1 , 2 , .. . , n - 1,are not parallel. Note that
S,(= F,+l -F,) can be represented as S, = AD, +pD,+I
where (A, p ) are easily determined from the given data, i.e.,
(A, p ) = (S, x D,+1,D, x S,)/(D, x D,+l).We introduce
an auxiliary plane with the coordinates A and p.

InJlectionpoints: Using S, = A:Dl
we obtain

I

I

P u t t = 1/(1 + U ) , 0

(4)

< U < CO, we get

The number of inflection points being equal to the number of simple positive roots of the cubic equation ( 5 ) .
We have for N,, 0 5 i _< 2 representing the regions for
which the curve has i inflection points and no singularity as
shown in Fig. 1:

+ pDl+l and s = 1 - t ,

745

(a) A L 1/vi9p 2 l / w i : ( x , ~ E
) NO
(b) (A - l / v i ) ( p - l / w i ) < 0 or X = l / v i , p < l / w i
or X < l / q , p = l / w i : (Alp) E NI
(c) X < l / u i , p < l / w i : Descartes’ Rule of Signs
implies that the number of the positive roots of c is either
zero or two, counting any double root twice. Remark that
(Alp) is on the boundary between these cases if a double
root occurs. At a positive double root g, the cubic (5) and
its derivative must vanish, which gives two equations that
are linear in X and p:
X(3a

+ +p(32 +wp3)
Vi)

X+p(2ff

+wzff2)

+

=

1

=

ff2

Hence, we consider the image of (Alp) by (8) and (9)
under 0 < a < p < 1 to get the necessary and sufficient
conditions for the existence of the loop on (1). First
the image of the boundary of the region determined by
inequalities 0 < a < p < 1,is given by:

Jacobian matrix of ( A l p ) w.r.t. ( a , p ) is nonsingular for
( a l p )= (1/(1 c), 1 / ( 1 d ) ) , 0 < d < c, as follows:

+

+

ff3

Solving for X and p, we get

A

=
=

+

2 - ff3 wzff
= 4.1
3ff + 2v, + 2 w d + v,w,ff

(6)

2@3 +
-1
+ 2v, + 2w,ff2 + w,w,a) = dff)( 7 )

Note that a cusp on a curve can be regarded as the limit
of a loop. In Fig. 1, C (or L limited by A,B,C) means
the region for the curve to have a cusp (or a loop) and no
inflection point.

v,u2

a(3a

Thus it is straightforward to identify the required boundary: (A, p ) = ( z ( a ) , y ( a ) ) .Taking into account of the signs
of the coefficients of ( 5 ) , ( A , p ) E NO for A = ~ ( c ) ,
p 5 y ( a ) and ( A l p ) E 1112 for X = ~ ( c T p
) , > y(c).
The curve C : ( z ( c ~ ) , y ( a ) )0, < a < cc is a branch of
k ( X , p ) = 0 limited by X < l / v i , p < l / w i :

k ( x , p ) = 4(wzP - q x 3

+ +,A

-

qP3

-

3

~

+

~

4

Preserving local convexity

In the light of discussion in previous section we can set
< t < 1, for convex curve. This
we propose to choose:
implies, U , > 1/X, and w,> l/pLL.

P’(t) x P”(t) > 0, 0
2

[(vLX- l)(w,p - 1)12 - 6(v,X - l ) ( w l p - 1 ) X p
Ui

k ( X , p ) = 0 has two straight lines X = l / v , and p =

l/w, as its asymptotic lines. So region No contains the
boundaries A and B.

wj

= “(3,
=

X f l

-)

x

m a 2 ( 3 ,P- +) 1
P

as shape parameters.

Singularities. A loop occurs if P ( a ) = P(p) for 0 < LY <
p < 1. Since Di and Dj+l are independent, letting the
coefficients of the two vectors in {P(cy)- P(p)) be zero
gives:

*

> $4> $ + ( X , P )

E No

Let us substitute the sufficient conditions for convexity

(IO) and (1 1) into (2), we get:

D,-,
where
where

746

+ a,D, + D2+l= b,,i = 2 , 3 , ...,rc. - 1

(12)

Figure 4. The default rational cubic spline for
-- 3 = wa.

Figure 2. The default rational cubic spline for
-- 3 = wi.

U 2.

21.2

4 is a cubic plot of S type data with one inflection point.

5 Concluding remarks
A rational cubic interpolant, with two families of shape
parameters, has been utilized to obtain distribution of inflection points and singularities. Then C 2 convexity preserving interpolatory spline curve is presented. The shape
constraints are restricted on shape parameters to assure the
shape preservation of the data. For the C 2 interpolant,
the consistency equations on the derivative parameters have
been derived. The solution to this system of linear equations
exists and provides a unique solution. A robust solution, using the LU decomposition method, has been recommended.
For an efficient implementation of the C' scheme, an
algorithm has been designed which, in each of the interval,
intelligently saves the higher degree arithmetic into a lower
degree according to the nature of the slope.

Figure 3. The rational cubic shape preserving
spline curve.

Given D1 and D,, the set of equations (12) gives
a system of n-2 linear equations for the unknowns
Da, D3, . . . ,D,-I. This is diagonally dominant tridiagonal system and hence has a unique solution.
Although any end conditions ID1, D, will work for the
scheme, however three-point difference approximations:

Acknowledgements
The authors would like to thank Prof. Manabu Sakai for
helpful and valuable comments led to a considerably improved representation of the results. We also acknowledge
the financial support of Monbusho (Ministry of education,
Japan). The support of PSF, under project no. P-PUNaths
(17), is acknowledged too.

References

which depend on the given data, have been found to produce visually pleasing results.
We now present some numeric:al examples. Figure 2 is
without convexity preserving cond!itions with default values
of shape parameters vi = 3 = w i , V i . Figure 3 demonstrates the effect of convexity preserving condition. Figure

I

[ I ] G . Farin. Curves and Surfaces for Computer Aided Geometric
Design-Practical Guide. Academic Press, New York, 1995.
[2] M. Sakai. Inflections and singularity on parametric rational
cubic curves. Numer: Math., 76:403-417, 1997.

747

[3] M. Sakai. Inflection points and singularities on planar rational
cubic curve segments. Computer-Aided Design, 16:149-1 56,
1999.
[4] M. Sarfraz. Convexity preserving piecewise rational interpolation for planar curves. Bull. Korean Math. Soc., 29(2):193200, 1992.
[5] M. Sarfraz. Interpolatory rational cubic spline with biased, point and interval tension. Computers & Graphics,
16(4):427-430, 1992.
[6] M. Sarfraz. Local convexity preserving rational cubic spline
curves, proceedings ieee conference on information visualization. Proceedings IEEE Conference on Information Visualization, IV’97, London, pages 21 1-218, 1997.

748


Eurographics Symposium on Geometry Processing 2009
Marc Alexa and Michael Kazhdan
(Guest Editors)

Volume 28 (2009), Number 5

Gromov-Hausdorff Stable Signatures for Shapes
using Persistence
Frédéric Chazal1 and David Cohen-Steiner2 and Leonidas J. Guibas3 and Facundo Mémoli4 and Steve Y. Oudot1
1 INRIA

Saclay 2 INRIA Sophia 3 Stanford University, Dept. Computer Science 4 Stanford University, Dept. Mathematics

Abstract
We introduce a family of signatures for finite metric spaces, possibly endowed with real valued functions, based on
the persistence diagrams of suitable filtrations built on top of these spaces. We prove the stability of our signatures
under Gromov-Hausdorff perturbations of the spaces. We also extend these results to metric spaces equipped
with measures. Our signatures are well-suited for the study of unstructured point cloud data, which we illustrate
through an application in shape classification.
Categories and Subject Descriptors (according to ACM CCS): I.3.5 [Computer Graphics]: Computational Geometry
and Object Modelling—

1. Introduction
In recent years, great advances have been made in the fields
of data acquisition and shape modelling, and huge collections of digital models have been obtained. With the goal of
organizing these collections, it is very important to be able
to define and compute meaningful notions of similarity between objects that exhibit invariance to different deformations or poses of the objects represented by the data. Problems of this nature arise in areas such as molecular biology,
metagenomics, face recognition, matching of articulated objects, graph matching, and pattern recognition in general.
In many practical applications, data are endowed with a
notion of distance between their points, which turns them
into metric spaces. The information contained in such data
sets typically takes the form of metric invariants, which it
is of interest to capture and characterize. For instance, when
the data have been obtained experimentally, the analysis of
these invariants can provide insights about the nature of the
underlying phenomenological science.
Relevant work. In the context of shape analysis, one typically wishes to be able to discriminate shapes under different notions of invariance. Many approaches have been
proposed for the problem of (pose invariant) shape classification and recognition, including the size theory of Frosini
and collaborators [Fro90, CFL06a, CFL06b], the work of
Hilaga et al. [HSKK01], the shape contexts [BMP02], the
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

integral invariants of [MCH∗ 06], the eccentricity functions
of [HK03], the shape distributions of [OFCD02], the canonical forms of [EK03], and the shape DNA and global point
signatures based spectral methods in [RWP05] and [Rus07],
respectively. The common underlying idea revolves around
the computation and comparison of certain metric invariants,
or signatures, so as to ascertain whether two given data sets
represent in fact the same object, up to a certain notion of
invariance.
The question of proving that a given family of signatures
is indeed able to signal proximity or similarity of shapes in
a reasonable way has been hardly addressed. In particular,
the degree to which two shapes with similar signatures are
forced to be similar is in general not well understood. Conversely, one can ask the more basic question of whether the
similarity between two shapes forces their signatures to be
similar. These questions cannot be completely well formulated until one agrees on: (1) a notion of equality between
shapes, and (2) a notion of (dis)similarity between shapes.
By regarding sampled shapes as finite metric spaces, one
can use the Gromov-Hausdorff distance [Gro99] as a measure of dissimilarity between shapes [MS04, MS05]. By endowing the point clouds with different metrics, one obtains a
great deal of flexibility in the different degrees of invariance
that one can encode in the measure of dissimilarity. For instance, using the Euclidean metric in Rd makes the GromovHausdorff distance invariant under ambient rigid isome-

1394 F. Chazal, D. Cohen-Steiner, L. Guibas, F. Mémoli, S. Oudot / Gromov-Hausdorff Stable Signatures for Shapes using Persistence
tries [Mém08]. In contrast, using intrinsic metrics within the
shapes makes the Gromov-Hausdorff distance blind to intrinsic isometries, such as when a same animal is represented
in different poses (Figure 1). Bronstein et al. [BBK09] suggested to combine intrinsic and extrinsic metrics to increase
the discriminating power of shape signatures. We illustrate
this idea in Figure 6, where the first two shapes (circle and
helicoidal curve on a torus) have same length and are therefore isometric embeddings of a same object into R3 . As a
result, signatures obtained from geodesic distances are identical whereas signatures based on Euclidean distances differ.

• Second, we extend the approach to the case of metric spaces endowed with real-valued functions. This latter
step enables the design of new signatures for finite metric spaces by considering canonically-defined functions on
these spaces, such as eccentricities (Section 4). As a result,
more shapes can be discriminated using our approach. For
instance, in Figure 6, the sphere and ellipsoid cannot be
discriminated using standard Rips filtrations (see Definition
2.7) because their diagrams are the same up to rescaling and
small noise (rows 2 and 3). In contrast, using a fraction of
the eccentricity as function modifies the shapes of the 1- and
2-dimensional diagrams of the ellipsoid significantly, while
the ones for the sphere hardly change due to the fact that the
eccentricity is constant (row 4).
Our signatures are also adapted to deal with measure metric spaces [Gro99, Chapter 3. 12 ], where additional information is provided in the form of a collection of weights, one
per point of the shape. In this case, stability is guaranteed under small perturbations in the Gromov-Wasserstein distance
(Section 5).

Figure 1: The database of shapes used in our experiments.
Once the finite metric space representation of shapes has
been adopted, the question becomes whether a given family of signatures is stable under perturbations of the shape
in the Gromov-Hausdorff distance. A somewhat different
version of the problem is when the spaces are endowed
with measures, a case in which perturbations are understood in the sense of the (l ∞ ) Gromov-Wasserstein distance [Mém07]. These questions about stability of invariants are addressed in [Mém07] for a limited set of signatures [HK03, MCH∗ 06, BMP02, OFCD02].
Our contributions. Using tools from persistent homology
[ELZ00, ZC05], we construct a novel class of GromovHausdorff stable metric invariants. Our approach is in the
spirit of [CZCG05] and [dFL06, dFL05] in that we try to devise certain topologically motivated signatures that naturally
combine the classificatory power of topology with the flexibility of metrics.

Since the computation of the Gromov-Hausdorff distance
leads to hard combinatorial problems akin to the quadratic
assignment problem (which is NP hard), the construction
of easily computable Gromov-Hausdorff stable invariants is
very important. We show in Section 6 that the computation of our invariants yields simple bottleneck assignment
problems, which can be solved in polynomial time. In contrast with other approaches that generally involve some delicate numerical algorithms and/or require the availability of
a mesh of the underlying object [MS04, BBK06], the algorithm for computing and comparing our signatures is entirely
combinatorial and can be applied on the sole input of a distance matrix.
Finally, our invariants prove to be useful for discriminating between different classes of shapes in a classification
task performed on the database of Figure 1. The results are
presented in Section 7.
2. Mathematical background
2.1. Metric spaces and Gromov-Hausdorff distance(s)

We enrich the pool of shape signatures available in the
literature in two ways (see Section 3):

Recall that a metric space is a pair (X, dX ) where X is a set
and dX : X × X → R is a non-negative map such that for
any x, y, z ∈ X, dX (x, y) = 0 if and only if x = y, dX (x, y) =
dX (y, x) and dX (x, z) ≤ dX (x, y) + dX (y, z).

• First, we extend zero-dimensional connectivity-based signatures such as the dengrograms of [CM09] or the invariants computed by size theory [dFL06, dFL05] to higherdimensional homology classes, and we prove their stability
under small Gromov-Hausdorff perturbations. This greatly
increases the discriminative power of the approach, as illustrated in Figure 6, where all shapes have been ε-sampled for
a same value of ε and therefore all zero-dimensional diagrams are the same (rows 2 and 3).

In the sequel X denotes the collection of all compact metric spaces. Two compact spaces (X, dX ) and (Y, dY ) are said
to be isometric if there exists a bijection φ : X → Y that
preserves distances, namely: ∀x, x′ ∈ X, dY (φ(x), φ(x′ )) =
dX (x, x′ ). Such a map is called an isometry. The set of isometry classes of compact metric spaces can be endowed with
a distance called the Gromov-Hausdorff distance [BBI01,
Thm. 7.3.30], whose definition uses the following notion of
correspondence between sets [BBI01, Def. 7.3.17]:
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

F. Chazal, D. Cohen-Steiner, L. Guibas, F. Mémoli, S. Oudot / Gromov-Hausdorff Stable Signatures for Shapes using Persistence 1395

Definition 2.1 A correspondence between two sets X and
Y is a subset C ⊂ X × Y such that: ∀ x ∈ X, ∃y ∈ Y s.t.
(x, y) ∈ C, and ∀ y ∈ Y , ∃x ∈ X s.t. (x, y) ∈ C. The set of
all correspondences between X and Y is denoted C(X,Y ).
Definition 2.2 The Gromov-Hausdorff distance between
compact metric spaces (X, dX ), (Y, dY ) is:
dGH ((X, dX ), (Y, dY )) =

1
2

inf

C∈C(X,Y )

ΓX,Y

l ∞ (C×C) ,

Another way of defining the Gromov-Hausdorff distance
is via common isometric embeddings of the two spaces.
Specifically, given two compact subsets X,Y of a same metric space (Z, dZ ), the Hausdorff distance between X and Y is
the quantity:
dZH (X,Y ) = max{max min dZ (x, y), max min dZ (x, y)}.
y∈Y x∈X

The Gromov-Hausdorff distance is then defined as follows:
Definition 2.3 The Gromov-Hausdorff distance between
compact metric spaces (X, dX ), (Y, dY ) is:
dGH ((X, dX ), (Y, dY )) = inf dZH (γX (X), γY (Y )),
Z,γX ,γY

(2)

where γX , γY range over all the isometric embeddings of X,Y
into some same metric space (Z, dZ ).
Definitions 2.2 and 2.3 are known to be equivalent [BBI01,
Thm. 7.3.25]. In particular, when the spaces are compact, the
proof of equivalence shows that the infima in Eqs. (1) and (2)
are in fact minima.
We now turn our focus to compact metric spaces endowed
with continuous real-valued functions. Let X1 be the collection of all such spaces:
X1 = {(X, dX , fX ) | (X, dX ) ∈ X , fX : X → R continuous}.
We deem two spaces X,Y ∈ X1 isomorphic whenever there
exists an isometry φ : X → Y s.t. fX = fY ◦ φ. We then extend
the Gromov-Hausdorff distance as follows:
Definition 2.4 Given X,Y ∈ X1 , d1GH (X,Y ) =
inf

C∈C(X,Y )

max

where fX − fY

1
ΓX,Y
2
l ∞ (C)

l ∞ (C×C) ,

fX − fY

l ∞ (C)

Theorem 2.5 d1GH defines a metric on the set of isomorphism
classes of X1 .
The proof of this result is a direct adaptation of the proof
[BBI01, Thm. 7.3.30].

(1)

where ΓX,Y : X × Y × X × Y → R+ is defined by
(x, y, x′ , y′ ) → |dX (x, x′ ) − dY (y, y′ )| and the notation
ΓX,Y l ∞ (C×C) stands for sup(x,y),(x′ ,y′ )∈C ΓX,Y (x, y, x′ , y′ ).

x∈X y∈Y

we have dC (x, y) ≤ 21 ΓX,Y l ∞ (C×C) and | fX (x) − fY (y)| ≤
fX − fY l ∞ (C) whenever (x, y) ∈ C.

(3)

stands for sup(x,y)∈C | fX (x) − fY (y)|.

Note that if fX and fY are equal constant functions, then one
recovers dGH .
As in the case of the standard Gromov-Hausdorff distance, the infimum in Eq. (3) is a minimum when the spaces
are compact. Moreover, the proof of [BBI01, Thm. 7.3.25]
shows that, for any correspondence C ∈ C(X,Y ), the disjoint
union X ⊔Y can be endowed with a metric dC that coincides
with dX over X × X and with dY over Y × Y , and such that
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

2.2. Filtrations, persistence diagrams and stability
Throughout the paper we consider simplicial homology with
coefficients in a field, and we make a large use of topological persistence theory [ELZ00, ZC05]. Thorough introductions to these subjects can be found in [Mun84,EH,CCS07].
Recall that a simplicial complex K is a finite collection of
simplices such that every face of a simplex of K is also in K
and the intersection of any two simplices is either empty or
a common face of each of them. A filtration K of a simplicial complex K is a nested sequence of subcomplexes
∅ = Kα0 ⊆ Kα1 ⊆ · · · ⊆ Kαm = K, where α0 < α1 < · · · < αm
is an ordered sequence of real numbers. The inclusion maps
between the subcomplexes induce a directed system of vector spaces, called a persistence module, involving their kdimensional homology groups:
φ1

φ2

φm
m−1

0
1
Hk (Kα1 ) −→
· · · −→ Hk (Kαm ).
Hk (Kα0 ) −→

(4)

The structure of this persistence module can be encoded as a
multi-set of points Dk K, called the k-th persistence diagram
of K (see Figure 2). Intuitively, each point p ∈ Dk K encodes
the lifespan of some k-dimensional homological feature appearing at time px and dying at time py in the filtration K.
More formally, Dk K is a multi-subset of the extended plane
2
R , where R = R ∪ {−∞, +∞}, contained in the union of
the extended diagonal ∆ = {(x, x) : x ∈ R} and of the grid
{α0 , · · · , αm } × {α0 , · · · , αm , α∞ = +∞}. The multiplicity
of the points of ∆ is set to +∞, while the multiplicities of the
(αi , α j ), 0 ≤ i < j ≤ +∞, are defined in terms of the ranks of
j
j
∗
the homomorphisms φi = φ j−1 ◦ · · · ◦ φi+1
i . See [CCSG 09]
for a precise definition.
The concept of persistence extends to the case of a filtration defined by the sublevel-sets of a continuous function f : X → R, under some tameness condition [CSEH05]
stating that the family of inclusions f −1 ((−∞, α]) ⊆
f −1 ((−∞, β]) induces at k-dimensional homology level a
persistence module of the same (finite) type as in Eq. (4).
The definition of k-th persistence diagram of such a function
carries over. The use of persistence to devise signatures is
motivated by the following stability property:
Theorem 2.6 (Stability [CSEH05]) Let X be a triangulable
space and f , g : X → R two tame continuous functions. Then,
the bottleneck distance between the persistence diagrams of
2
f and g in the extended plane R is at most f − g ∞ .
Recall that the bottleneck distance d∞
B (A, B) between two

1396 F. Chazal, D. Cohen-Steiner, L. Guibas, F. Mémoli, S. Oudot / Gromov-Hausdorff Stable Signatures for Shapes using Persistence
endowed with a real valued function f , we define a filtration R(X, dX , f ) = {Rα (Xα )}α>0 where Xα denotes the set
f −1 ((−∞, α]) ⊆ X.

∞

∞

0.75

It has been shown in [CO08] that for well-chosen values
of α, the Rips complex Rα (X, dX ) of a finite metric space
(X, dX ) can be used to recover the homology of an unknown
shape that is sufficiently densely sampled by X. In this paper, we adopt a more general point of view by studying the
stability properties of the entire Rips filtration R(X, dX ).

0.5

2.3. Technical results
0.25
0
0

0

Figure 2: Top row, left: a set X of 100 points sampled uniformly at random in i.i.d. fashion from an offset of the unit
circle in the plane. The point cloud is endowed with the ambient Euclidean metric dE . Top row, right: the 2-skeleton
of the Rips filtration R(X, dE ), containing 4, 950 edges
and 161, 700 triangles. The simplices are colored according to their time of appearance in the filtration, from light
blue to orange. Bottom row: the 0-dimensional (left) and 1dimensional (right) persistence diagrams of R(X, dE ).

2

multi-sets in (R , l ∞ ) is the quantity minγ max p∈A p −
γ(p) ∞ , where γ ranges over all bijections from A to B.
Theorem 2.6 has been recently extended to wider classes
of functions and spaces using a new notion of proximity between persistence modules called ε-interleaving
[CCSG∗ 09]. This extended stability result will be instrumental in the proof of Theorem 3.2.
From a practical point of view, the persistence diagrams
of a given filtration can be efficiently computed using the socalled persistence algorithm [ELZ00, ZC05]. In this paper
we use a particular family of complexes, called Rips complexes, to build filtrations on top of finite metric spaces (possibly endowed with functions), and we use their persistence
diagrams as signatures for the spaces, as shown in Figure 2.
Definition 2.7 Given a finite metric space (X, dX ) and a
parameter α > 0, the Rips complex Rα (X, dX ) is the abstract simplicial complex of vertex set X, whose simplices
correspond to the non-empty subsets of X of diameter less
than 2α in the metric dX † . The Rips filtration of (X, dX ),
noted R(X, dX ), is the nested family of Rips complexes obtained by varying parameter α from 0 to +∞. When X is
† Note that we depart from the usual definition, where the Rips
simplices correspond to subsets of X of diameter less than α. The
reason for this choice is purely formal: it boils down to eliminating
factors of 2 in the indices.

The following results will be used in the proofs but are not
necessary to understand the general approach. We begin with
a standard result (see e.g. example 3.5.3 and exercise 3.5.4
of [BBI01]) that will be key in the next section:
Lemma 2.8 Any finite metric space of cardinality n can be
isometrically embedded into (Rn , l ∞ ).
In view of this lemma, Rips filtrations of finite subsets X
of Rn endowed with the l ∞ -distance are of particular interest for the rest of the paper. In particular they are closely
ˇ
related to the so-called Cech
filtration of X within (Rn , l ∞ ),
which is also defined as a nested family of abstract simplicial complexes of vertex set X. Specifically, for all α > 0,
the simplices of Cα (X, Rn , l ∞ ) correspond to the non-empty
subsets of X that are centers of open l ∞ -balls of same radius
α with a non-empty common intersection in Rn .
Lemma 2.9 ( [GM05]) For any finite set X ⊂ Rn and any
α > 0, one has Cα (X, Rn , l ∞ ) = Rα (X, l ∞ ).
ˇ
Note that the Cech
complex Cα (X, Rn , l ∞ ) is nothing but
the nerve of the collection of open l ∞ -balls of same radius α
about the points of X. The topological structures of unions of
open balls in (Rn , l ∞ ) are related to the ones of their nerves
through the following extension of the Nerve Lemma which,
more generally, relates good open covers to their nerves.
Given a topological space S and a family U = {Ux }x∈X of
open subsets covering S, the family defines a good cover
if for every finite subset Y of X the common intersection
T
y∈Y Uy is either empty or contractible. The nerve N U is
the abstract simplicial complex of vertex set X such that
x0 , · · · , xk form a simplex if and only if Ux0 ∩ · · · ∩Uxk = ∅.
Lemma 2.10 (Persistent Nerve [CO08]) Let S ⊆ S′ be
two paracompact spaces, and let U = {Ux }x∈X and U ′ =
{Ux′′ }x′ ∈X ′ be good open covers of S and S′ respectively,
based on finite parameter sets X ⊆ X ′ such that Ux ⊆ Ux′
for all x ∈ X. Then, the homotopy equivalences N U → S
and N U ′ → S′ provided by the Nerve Theorem [Hat01,
§4G] commute with the canonical inclusions S ֒→ S′ and
N U ֒→ N U ′ at homology level.
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

F. Chazal, D. Cohen-Steiner, L. Guibas, F. Mémoli, S. Oudot / Gromov-Hausdorff Stable Signatures for Shapes using Persistence 1397

3. Persistence based lower bounds for
Gromov-Hausdorff distance
Computing the Gromov-Hausdorff distance between two finite metric spaces appears to be practically intractable in
most cases. To distinguish such spaces from a metric point of
view, it is thus important to exhibit reasonable lower bounds
whose computation is tractable. The results of this section
show that the bottleneck distances between persistence diagrams of Rips filtrations of finite metric spaces are reasonable lower bounds.
Theorem 3.1 For any finite metric spaces (X, dX ) and
(Y, dY ), for any k ∈ N,
d∞
B Dk R(X, dX ), R(Y, dY ) ≤ dGH ((X, dX ), (Y, dY )).
Note that this lower bound on the Gromov-Hausdorff distance is tight. For instance, take for X a set of two points at
distance 2 and for Y a set of two points at distance 2 + 2ε.
Then, (X, dX ) and (Y, dY ) can be isometrically embedded
into the real line, with X mapped to {0, 2} and Y mapped
to {−ε, 2 + ε}, which shows that their Gromov-Hausdorff
distance is at most ε. Now, the 0-dimensional persistence diagram of the Rips filtration of (X, dX ) is made of two points,
namely (0, +∞) and (0, 1), while the 0-dimensional persistence diagram of the Rips filtration of (Y, dY ) is made of
(0, +∞) and (0, 1 + ε), hence their bottleneck distance is ε.
Proof of Theorem 3.1. Let ε = dGH ((X, dX ), (Y, dY )). As
mentioned after Definition 2.3, the infimum in Eq. (2) is in
fact a minimum, which means that there is a metric space
(Z, dZ ) and two isometric embeddings γX : X → Z and γY :
Y → Z such that the Hausdorff distance dZH (γX (X), γY (Y )) is
ε. Consider now the subspace γX (X) ∪ γY (Y ) ⊆ Z, endowed
with the induced metric. Since this subspace is finite, it can
be isometrically embedded into (Rn , l ∞ ), where n = #X +
#Y , by Lemma 2.8. Let γ be the isometric embedding. We
Z
then have d∞
H (γ ◦ γX (X), γ ◦ γY (Y )) = dH (γX (X), γY (Y )) = ε.
n ∞
Hence, inside (R , l ), the distance function δX to γ◦γX (X)
and the distance function δY to γ ◦ γY (Y ) are ε-close in the
max norm. Moreover, since δX and δY are lower envelopes
of finitely many piecewise-linear functions, they are themselves piecewise-linear and therefore tame and continuous.
As a consequence, their persistence diagrams are ε-close in
the bottleneck distance, by Theorem 2.6.
Recall now that for all α ∈ R, the open α-sublevel-set of
δX is the α-offset of γ ◦ γX (X), i.e. the union of the open l ∞ balls of same radius α about the points of γ ◦ γX (X), noted
γ ◦ γX (X)α . Since the l ∞ -balls are hypercubes, they are convex and therefore their intersections are either empty or contractible. As a result, the Persistent Nerve Lemma 2.10 enˇ
filtration C(γ ◦ γX (X), Rn , l ∞ )
sures that δX and the Cech
have identical persistence diagrams. Furthermore, Lemma
2.9 guarantees that C(γ ◦ γX (X), Rn , l ∞ ) coincides with the
Rips filtration R(γ ◦ γX (X), l ∞ ), which in return is equal to
R(X, dX ) since γ◦γX is an isometric embedding. As a consequence, the persistence diagram of R(X, dX ) coincides with
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

the persistence diagram of δX . The same is true for Y , therefore the persistence diagrams of R(X, dX ) and R(Y, dY ) lie
at bottleneck distance at most ε of each other.
Theorem 3.1 extends to finite metric spaces endowed with
real valued functions as follows:
Theorem 3.2 Let (X, dX ) and (Y, dY ) be two finite metric
spaces endowed respectively with f : X → R and g : Y →
R. Then, for any k ∈ N, the bottleneck distance between
the persistence diagrams of the filtrations R(X, dX , f ) and
R(Y, dY , g) is at most d1GH ((X, dX , f ), (Y, dY , g)).
In the limit case where f = g ≡ 0, R(X, dX , f ) and
R(Y, dY , g) become respectively R(X, dX ) and R(Y, dY ),
and we have d1GH = dGH . Thus, we obtain the statement of
Theorem 3.1 as a special case of the above result.
Proof of Theorem 3.2. Let ε = d1GH ((X, dX , f ), (Y, dY , g)).
We follow the same strategy as in the proof of Theorem
3.1. For all α ∈ R, we let Xα = f −1 ((−∞, α]) ⊆ X and
Yα = g−1 ((−∞, α]) ⊆ Y . As mentionned after definition
2.4, the infimum in Eq. (3) is in fact a minimum, realized
by some correspondence C ∈ C(X,Y ), and the disjoint union
Z = X ⊔ Y can be endowed with a suitable metric dZ such
that the canonical inclusions γX : X ֒→ Z and γY : Y ֒→ Z
are isometries onto their images, and such that for every pair
(x, y) ∈ C we have dZ (γX (x), γY (y)) ≤ 12 ΓX,Y l ∞ (C×C) ≤ ε
and | f (x) − g(y)| ≤ f − g l ∞ (C) ≤ ε. By Lemma 2.8, we
can then embed the finite subspace (γX (X) ∪ γY (Y ), dZ ) into
(Rn , l ∞ ), where n = #X + #Y , through some isometric embedding γ. We thus get two isometric embeddings γ ◦ γX and
γ ◦ γY of X and Y respectively into (Rn , l ∞ ), such that for
every pair (x, y) ∈ C we have γ ◦ γX (x) − γ ◦ γY (y) ∞ ≤ ε
and | f (x) − g(y)| ≤ ε. It follows that the offsets filtrations
{γ ◦ γX (Xα )α }α>0 and {γ ◦ γY (Yα )α }α>0 are ε-interleaved,
in the following sense: ∀α > 0,
γ ◦ γX (Xα )α ⊆ γ ◦ γY (Y(α+ε) )α+ε ⊆ γ ◦ γX (X(α+2ε) )α+2ε .
Indeed, for any point p ∈ γ ◦ γX (Xα )α , there is an x ∈ X such
that p−γ◦γX (x) ∞ ≤ α. Letting y ∈ Y be such that (x, y) ∈
C, our embedding ensures that γ ◦ γX (x) − γ ◦ γY (y) ∞ ≤ ε
and g(y) ≤ f (x) + ε ≤ α + ε. Hence, y belongs to Y(α+ε) , and
by the triangle inequality we have p − γ ◦ γY (y) ∞ ≤ α + ε.
It follows that p ∈ γ ◦ γY (Yα+ε )α+ε . The second inclusion in
the above equation follows by symmetry.
Since the two offsets filtrations are ε-interleaved,
the extended stability Theorem [CCSG∗ 09, Thm
4.4] guarantees that their persistence diagrams are
ε-close to each other in the bottleneck distance. By
Lemma 2.10, so are the persistence diagrams of the
ˇ
Cech
filtrations {Cα (γ ◦ γX (Xα ), Rn , l ∞ )}α>0 and
{Cα (γ ◦ γY (Yα ), Rn , l ∞ )}α>0 . By Lemma 2.9, so
are the persistence diagrams of the Rips filtrations
{Rα (γ ◦ γX (Xα ), l ∞ )}α>0 and {Rα (γ ◦ γY (Yα ), l ∞ )}α>0 .
Finally, so are the diagrams of R(X, dX , fX ) and
R(Y, dY , fY ), since these filtrations coincide with

1398 F. Chazal, D. Cohen-Steiner, L. Guibas, F. Mémoli, S. Oudot / Gromov-Hausdorff Stable Signatures for Shapes using Persistence
{Rα (γ ◦ γX (Xα ), l ∞ )}α>0 and {Rα (γ ◦ γY (Yα ), l ∞ )}α>0
respectively.

4. Persistence-based signatures for finite metric spaces
The results of section 3 suggest that the persistence diagrams of Rips filtrations built on top of finite metric
spaces endowed with well-chosen functions (see Definition
4.1) provide stable signatures to distinguish between different shapes.
Definition 4.1 Let HL be the class of maps h : X → X1 that
preserve the metric and satisfy for some L > 0
1
ΓX,Y l ∞ (C×C)
(5)
2
for all (X, dX ), (Y, dY ) ∈ X and all C ∈ C(X,Y ), where
h(X, dX ) = (X, dX , fX ) and h(Y, dY ) = (Y, dY , fY ).
fX − fY

l ∞ (C)

≤ L·

An alternative to eXm . Instead of the eccentricies, one may
consider using the following inductive family of functions:
X
(x) = maxx′ ∈X dX (x, x′ ) + fmX (x′ ) . It
f0X ≡ 0, and fm+1
can be shown that for each m ∈ N the map hm : (X, dX ) →
(X, dX , fmX ) is in Hm . The complexity associated with computing hm is O(m · N 2 ), where N is the cardinality of the
metric space.
Remark 1 The above examples give rise to a large variety
of maps in HL . Indeed, given h : (X, dX ) → (X, dX , fX ) and
h′ : (X, dX ) → (X, dX , fX′ ) in HL , observe that max(h, h′ ) and
sup(h) : (X, dX ) → (X, dX , max( fX )) are both in HL . Moreover, h + h′ ∈ H2L , and for any λ ∈ R, λh ∈ H|λ|L . It is important to note that the persistence diagrams of R( fX ) and
R(λ fX ) are not related by a simple transformation: different
choices of λ give different signatures.

From Definitions 2.4 and 4.1 and Theorem 3.2 we obtain:

5. Introducing measures

Corollary 4.2 Let X,Y ∈ X1 be finite. Then, for any h ∈ HL ,

For the sake of generality, it is important to make the class
of admissible functions as large as possible. Unfortunately,
it seems that certain canonical functions such as the average distance to a point are not directly controllable by the
GH distance. This is intuitively clear since in averaging the
values ∑x′ =x dX (x, x′ )α(x′ ) there is a choice to be made for
1
the weights {α(x′ )}x′ ∈X , the choice α(x′ ) = |X|
being one
of many possible. In order to incorporate this extra structure
(weights) into our formulas, we define a new metric on the
class of spaces that arise in [Mém07, Mém08]. This metric
belongs to the class of Gromov-Wasserstein metrics on metric spaces enriched with weights.

d∞
B (Dk R( f X ), Dk R( fY ))
≤ dGH (X,Y )
max(1, L)
where h(X, dX ) = (X, dX , fX ), h(Y, dY ) = (Y, dY , fY ) and
R( fX ) = R(X, dX , fX ), R( fY ) = R(Y, dY , fY ).
When the context is clear, we will abuse notations and omit
some of the arguments in the expression R(X, dX , fX ). Below we provide examples of maps that are in HL :
The diameter map. Our easiest example is the map hdiam :
(X, dX ) → (X, dX , fX ) where fX : X → R is the constant
function fX ≡ diam(X). It is easily seen that hdiam ∈ H2 .
The eccentricity map. The map he1 : (X, dX ) → (X, dX , eX1 )
where eX1 : X → R is given by eX1 (x) = maxx′ ∈X dX (x, x′ ) is
in H2 . Indeed, assume X,Y ∈ X and C ∈ C(X,Y ), and let
η = ΓX,Y l ∞ (C×C) . Pick (x, y), (x′ , y′ ) ∈ C and notice that
dY (y, y′ ) + η.
dX (x, x′ ) ≤ dY (y, y′ ) + η ≤ max
′
y ∈Y

Hence, eX1 (x) ≤ eY1 (y) + η
|eX1 (x) − eY1 (y)| ≤ η for all

for all (x, y) ∈ C. By symmetry,
(x, y) ∈ C.

Higher-order eccentricities. A more general construction
is as follows: given m ∈ N, let hem : X → X1 be the map
(X, dX ) → (X, dX , eXm ), where eXm : X → R is defined by
∀x0 ∈ X, eXm (x0 ) = max

min

x1 ,··· ,xm 0≤i< j≤m

dX (xi , x j ),

A measure metric space (mm space, for short) is a triple
(X, dX , µX ) where (X, dX ) ∈ X and µX is a Borel probability
measure such that supp[µX ] = X. Here, supp[µX ] denotes the
support of X, i.e. the minimal closed set Z s.t. µX (X\Z) = 0.
Let X w denote the collection of all mm spaces, and X1w
the collection of all mm spaces endowed with continuous
real-valued functions. Two mm spaces (X, dX , µX , fX ) and
(Y, dY , µY , fY ) are said to be isomorphic if there exists an
isometry φ : X → Y s.t. fX = fY ◦φ and µX φ−1 (Z) = µY (Z)
for all measurable sets Z ⊂ Y . It turns out that we can metrize
the set of isomorphism classes of X1w by replacing correspondences between X and Y in X w by couplings, that is,
probability measures on X × Y whose marginals on the first
and second factors are µX and µY respectively. Since X,Y
are compact and µX , µY have full support, the support of a
coupling is a correspondence [Mém07, Lemma 1].

where x1 , . . . , xm range over X. It turns out that hem is in H2 .
In addition, observe that for m > 1, eXm provides more information than just eX1 : consider for instance Sn endowed
n
with the usual intrinsic metric. Then, eS1 ≡ π for all n ∈ N,

Given X,Y ∈ X1w we then define d1GW,∞ (X,Y ) to be the
infimal η > 0 such that there exists a coupling µ for which
both 12 ΓX,Y l ∞ (C(µ)×C(µ)) ≤ η and fX − fY l ∞ (C(µ)) ≤ η,
where C(µ) denotes the correspondence supp[µ].

whereas eS4 ≡ π/4 is different from eS4 ≡ 2 arcsin( 2/3) >
π/4. Note however that the complexity of computing eXm on
a finite metric space with N points is roughly O(N m+1 ).

For any X,Y ∈ X w , we define the Gromov-Wasserstein
distance dGW,∞ (X,Y ) to be equal to d1GW,∞ (X,Y ), where
we regard X,Y as elements in X1w by endowing them

1

2

c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

F. Chazal, D. Cohen-Steiner, L. Guibas, F. Mémoli, S. Oudot / Gromov-Hausdorff Stable Signatures for Shapes using Persistence 1399

with the zero functions. One can prove that dGH (X,Y ) ≤
dGW,∞ (X,Y ) for all X,Y ∈ X w [Mém07, Proposition 6].
The approach of Sections 3 and 4 generalizes almost verbatim to this measured setting. In particular, we have the
following analogous of Corollary 4.2. Let HLw be the class
of maps h : X w → X1w that preserve the metric and the measure and satisfy, for some L > 0,
fX − fY

l ∞ (C(µ))

≤ L·

1
ΓX,Y
2

l ∞ (C(µ)×C(µ))

(6)

for all (X, dX ), (Y, dY ) ∈ X w and all µ ∈ M(µX , µY ).
Here, h(X, dX , µX ) = (X, dX , µX , fX ), h(Y, dY , µY ) =
(Y, dY , µY , fY ), and M(µX , µY ) denotes the set of all
couplings between (X, µX ) and (Y, µY ).
Corollary 5.1 Let X,Y ∈ X w be finite. Then for any h ∈ HLw ,
d∞
B Dk R(h(X)), Dk R(h(Y ))
≤ dGW,∞ (X,Y ).
max(1, L)

The class HLw is actually larger than HL . For instance, given
(X, dX , µX ) ∈ X w and p ≥ 1 we define the p-eccentricity
function as
sX,p (x) :=

Z

X

1/p

dX (x, x′ ) p µX (dx′ )

,

and for p = ∞, sX,∞ (x) := maxx′ ∈X dX (x, x ).

Proof . let X,Y ∈ X w and µ ∈ M(µX , µY ). Then, for all x ∈ X
and y ∈ Y , the triangle inequality in the l p (µ)-norm implies:
dY (y, ·)

l p (µ)

≤ ΓX,Y (x, y, ·, ·)

Since µ ∈ M(µX , µY ), it follows easily that dX (x, ·)
sX,p (x) and dY (y, ·) l p (µ) = sY,p (y). Hence,

l p (µ) .
l p (µ)

sX,p (x) − sY,p (y) ≤

ΓX,Y (x, y, ·, ·)

l p (µ)

≤

ΓX,Y (x, y, ·, ·)

l ∞ (C(µ)) .

=

In particular, for all (x, y) ∈ C(µ),
sX,p (x) − sY,p (y) ≤ ΓX,Y

Lemma 6.1 Given a filtration K and its t-thresholded variant
t
t
K , there is a multi-bijection γ : Dk K → Dk K such that:
• the restriction of γ to the lower-left quadrant (−∞,t] ×
(−∞,t] is the identity;
• the restriction of γ to the upper-left quadrant (−∞,t] ×
(t, +∞) is the vertical projection onto the line y = t;
• the restriction of γ to the line y = +∞ is the horizontal
projection onto the extended half-plane (−∞,t] × R;
• finally, the restriction of γ to the half-plane (t, +∞) × R
is the projection onto the diagonal point (t,t).

t

Lemma 5.2 The p-eccentricity map hs p : X w → X1w defined
by (X, dX , µX ) → (X, dX , µX , sX,p ) is in H2w .

l p (µ) −

To deal with problem (1) above, we restrict the computation of our filtrations as follows: given a filtration ∅ = Kα0 ⊆
· · · ⊆ Kαn = K and a threshold t ∈ R, we let m be such that
αm−1 < t ≤ αm and we consider only the t-thresholded filtration ∅ = Kα0 ⊆ · · · ⊆ Kαm−1 ⊆ K. The reason why we replace Km by K is to preserve bottleneck distances, as will be
shown below. The drawback is that in principle we should
still have to compute the full complex K. Nevertheless, we
will see that this is not necessary in practice. The thresholding operation affects persistence diagrams in the following
way (see also Figure 3):

The proof of this rather intuitive result is omitted. Lemma
6.1 implies that for any filtrations F, G and any threshold t:

′

dX (x, ·)

6.1. Thresholding filtrations

l ∞ (C(µ)×C(µ)) ,

t

∞
d∞
B (Dk F , Dk G ) ≤ dB (Dk F, Dk G).

(7)

This means that the results of Sections 3 through 5 still hold
when the filtrations are replaced by their t-thresholded versions. In addition, Lemma 6.1 provides a way of computing
t
Dk R (X, dX , fX ) without building R∞ (X, dX , fX ) explicitly.
Indeed, we know that R∞ (X, dX , fX ) is the full simplex on
the vertex set X, therefore the filtration R(X, dX , fX ) has
only one essential homology class [c], easily identified as the
connected component created by the point of X with minit
mum fX -value. It follows that Dk R (X, dX , fX ) can be obtained first by computing the diagram of the truncated filtration {Rα (Xα )}0<α≤t , and then by projecting the resulting
multi-set (save the point corresponding to [c] when k = 0)
vertically onto the lower-left quadrant (−∞,t] × (−∞,t].
∞

hence
sX,p − sY,p

l ∞ (C(µ))

≤ ΓX,Y

l ∞ (C(µ)×C(µ)) ,

t

which means that hs p is in H2w (cf. Eq. (6)).

6. Algorithmic aspects
In implementing the lower bounds given by Corollaries 4.2
and 5.1, one must take into account the facts that (1) the
computation of the full persistence diagrams may be too expensive and (2) the bottleneck matching of the diagrams may
be time consuming. This section addresses these two issues.
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

t

∞

Figure 3: Effect of thresholding on a persistence diagram.

1400 F. Chazal, D. Cohen-Steiner, L. Guibas, F. Mémoli, S. Oudot / Gromov-Hausdorff Stable Signatures for Shapes using Persistence
6.2. Simplifying persistence diagrams
To address problem (2) above, we simplify each considered persistence diagram Dk F as follows: given a parameter
ε ≥ 0, we snap all points of Dk F lying within l ∞ -distance ε
of the diagonal ∆ onto ∆. The resulting simplified diagram is
called Dεk F . The triangle inequality implies that for any persistence diagrams Dk F , Dk G and any parameters ε, ε′ ≥ 0,
′

ε
ε
∞
d∞
B Dk F , Dk G − dB Dk F , Dk G

≤ max{ε, ε′ }. (8)

In our experiments, we specify a maximal number N of offdiagonal points to be kept per diagram. Specifically, we keep
the points with largest l ∞ -distance to ∆. For every diagram
Dk F considered, we perform this simplification and record
the incurred projection error ε ≥ 0, which remains small if
N is chosen sufficiently large.
6.3. Computing the bottleneck distance
′

p−q

∞,

Let P := {1, 2, 3, ∞}, H+ = {hs p , p ∈ P} ⊂ H2w and
H = {sup(hs p ) − hs p , p ∈ P} ⊂ H4w (recall Remark 1). Let
H denote the union of these two sets of functions, and let
−

Given two simplified persistence diagrams Dεk F and Dεk G,
each containing at most N off-diagonal points, we proceed
as follows. Firstly, we discard the diagonal and consider only
′
Dεk F \ ∆ and Dεk G \ ∆, whose total multiplicities are finite,
bounded from above by N. Secondly, we add arbitrary di′
agonal points to Dεk F \ ∆ and Dεk G \ ∆, so that the resulting
multi-sets { fi }i and {g j } j contain exactly N points each. Finally, we solve the following Bottleneck Assignment Problem: compute c∗ = minπ maxi d fi , gπ(i) , where π ranges
over all permutations of the set {1, . . . , N}, and where
d p, q = min

stra’s algorithm on the 1-skeleton graph G(Xi ) of the mesh‡ .
We then select a uniform subset Xir of 4K vertices using
the Euclidean farthest point sampling procedure. Briefly, we
first randomly choose a point from the vertex set. Then, we
choose the second point as the one at maximal distance from
the first one. Subsequent points are chosen always to maximize the distance to the points already chosen. Let Xir denote
this reduced model with 4K vertices. We further subsample
Xir using the farthest point procedure, this time in the distance di computed using G(Xi ), and retain only 300 points.
We denote the resulting coarse set by Xirr , which we endow
with the distance di , properly normalized so that the diameter of Xirr is 1. We also equip Xirr with a probability measure
µi based on intrinsic Voronoi partitions, where the measure
at point x ∈ Xirr equals the proportion of points of Xir that are
closer to x than to any other point of Xirr . From each model
Xi we thus obtain a discrete mm-space Xirr , di , µi . Let S
denote the collection of all 62 such mm-spaces.

1
max{|py − px |, |qy − qx |} .
2

In plain words, d(p, q) measures the cost of matching p with
q against the cost of matching both points with the diagonal
ε
ε′
∆. It can then be easily checked that c∗ = d∞
B (Dk F , Dk G).
In addition, we have that d(p, q) = d(p, q′ ) whenever q, q′ ∈
∆, which makes the choice of the locations of the diagonal points inserted during the second step of our procedure
unimportant. In practice, we compute c∗ using the thresholding algorithm of [BC99, Section 5], whose running time
is O N 2.5 log N .
7. Application to shape classification
We exemplify the use of our framework on a shape classification problem under invariances. We used the publicly
available database of (triangulated) shapes [SP04]. This
database comprises 62 shapes from six different classes:
camel, cat, elephant, face, head and horse. Each
class contains several different poses of the same shape.
These poses are richer than just rigid isometries, as can be
seen from Figure 1. The number of vertices in the models
range from 7K to 30K. We equip each model Xi with an intrinsic distance di between pairs of points in Xi using Dijk-

Λ := {0, 0.01, 0.1, 0.2, . . . , 0.9, 1, 2, 3, 4, 5, 10, 30, 50, 70, 90}.
For each pair of mm-spaces X and Y in S, for a choice of
λ ∈ Λ and a function h ∈ H we estimate the lower bound
given by Corollary 5.1 as follows:
t
1. We first construct the thresholded filtrations R(λ · h(X))
t
and R(λ · h(Y )) up to their 3-dimensional skeleta, as discussed in Section 6.1. The thresholding parameter t is
chosen so as to guarantee that the 1-skeleta of the undert
t
lying complexes of R(λ · h(X)) and R(λ · h(Y )) contain no more than a fraction s of the (quadratic) number
of edges of the complete graph. The value of s chosen in
our experiments is 7%, which allows a reasonable execution time of approximately 1.5 seconds per pair of mmspaces, on average.
2. We use the software jplex [JPl] and the procedure of
Section 6.1 to compute the kth persistence diagrams of
each thresholded filtration, for k = 0, 1, 2.
3. We apply the simplification step described in Section
6.2 with N = 30. For each k = 0, 1, 2, let Ek (X) =
t
t
ε (X)
ε (Y )
Dkk R(λ · h(X)) and Ek (Y ) = Dkk R(λ · h(Y )) be
the simplified diagrams, where εk (X) and εk (Y ) are the
projection errors.
4. We use the procedure of Section 6.3 to compute the quantity c(h, λ; X,Y ) =
maxk max d∞
B Ek (X), Ek (Y ) − max{εX (k), εY (k)}, 0
max(1, λ · L(h))
‡ In this particular application we take advantage of the fact that
a mesh is available for each of the shapes. In full generality, one
can replace G(Xi ) by some neighborhood graph in the ambient Euclidean metric, with similar guarantees.
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

,

F. Chazal, D. Cohen-Steiner, L. Guibas, F. Mémoli, S. Oudot / Gromov-Hausdorff Stable Signatures for Shapes using Persistence 1401

where L(h) is 2 if h ∈ H+ and 4 if h ∈ H− . By
Corollary 5.1, Lemma 6.1 and Eq. (8), we know that
dGW,∞ (X,Y ) ≥ c(h, λ; X,Y ).
For any pair X,Y ∈ S, we can now bound dGW,∞ (X,Y ) from
below by c(X,Y ) := maxh∈H,λ∈Λ c(h, λ; X,Y ). Let M denote the matrix with elements c(X,Y ), X,Y ∈ S. Figure 4
(left) shows the result of these computations on our database,
while Figure 5 shows the result of applying the metric multidimensional scaling procedure implemented by the Matlab
command mdscale to M.
C

the probability Pe (M) of mis-classification. We repeat this
procedure for 2K random choices of the training set. Using
the same randomized procedure we obtain an estimate of the
confusion matrix for this problem, whose entry (i, j) is the
probability that the classifier will assign class j to a shape
when the actual class is i — see Figure 4 (right). We obtained Pe (M) = 4%. As Figure 5 shows, there is a shape of
class camel that lies very close to the cluster formed by
the class horse. Removal of this shape from the database
reduced the probability of error to 2%.

1

0.04

camel

0.9

8. Perspectives

10
0.8

0.035
cat

0.7

0.03

20

0.025

0.6

elephant

30

0.5

0.02
face

40

0.4

0.015
0.3
head

0.01
0.2

50

0.005

0.1

horse

60
10

20

30

40

50

camel

60

cat

elephant

face

head

horse

0

Figure 4: Left: estimate of the Gromov-Wasserstein distance
computed on the database S. Right: estimated confusion matrix for the 1-nearest neighbor classification problem described in the text. The overall error rate is 4%.
MDSCALE with M
0.04

camel
cat
elephant
0.03

face
head
horse

0.02

0.01

0

-0.01

-0.02

-0.03
-0.03

-0.02

-0.01

0

0.01

In this paper we only used Euclidean and geodesic distances
to illustrate our approach, however many other metrics may
be considered, such as the diffusion distance [BBK∗ ].

0.02

0.03

0.04

0.05

Figure 5: MDS plot of the matrix M with labels corresponding to each class. The overall error is estimated to be
4%. Notice how there is excellent clustering of the different
classes, save for a single shape of the class camel that lies
very close to the cluster formed by the class horse. Removal of this shape reduces the classification error to 2%.
In order to evaluate the discriminative power contained in
the matrix M, we consider a classification task as follows:
We randomly select one shape from each class, form a training set T and use it for performing 1-nearest neighbor classification (where nearest is with respect to the metric defined by M) of the remaining shapes. By simple comparison
between the class predicted by the classifier and the actual
class to which the shape belongs we obtain an estimate of
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

The generality of our approach makes it applicable in a
large variety of contexts beyond 3d shape classification. Our
signatures are indeed well-defined, stable and computable
for any arbitrary finite metric space that is given in the form
of a distance matrix or equivalent representation. This makes
our approach well-suited for classification problems in general, even in cases where the data are high-dimensional or
lying in some non-Euclidean space without any information
on the embedding beside the inter-point distances.
At a more theoretical level, let us point out that Theorem 3.1 enables us to define limit Rips persistence diagrams
for compact metric spaces. Indeed, given a compact metric space (Z, dZ ), consider a sequence of finite ε-samples of
(Z, dZ ) such that ε converges to zero. The k-th Rips persistence diagram of (Z, dZ ) can then be defined as the limit
of the k-th persistence diagrams of the Rips filtrations of
the sequence. This limit is independent of the choice of the
sequence of ε-samples, since any two finite ε-samples of
(Z, dZ ) lie at Gromov-Hausdorff distance 2ε of each other,
which by Theorem 3.1 implies that the persistence diagrams
of their Rips filtrations are 2ε-close in the bottleneck distance. Thus, the limit Rips persistence diagram of (Z, dZ ) is
well-defined, and by Theorem 3.1 it is stable under small
perturbations of the space in the Gromov-Hausdorff distance. Similarly, for any real-valued function f : X → R,
Theorem 3.2 enables to define limit Rips persistence diagrams for (X, dX , f ) and to guarantee their stability. This
concept of limit persistence diagram of a compact metric
space (X, dX ) is reminiscent of the approach to topological
persistence developed in [CCSG∗ 09]. However, it may not
be equivalent to the persistence diagram of the limit filtration R(X, dX ) or R(X, dX , f ) in general. Finding the exact
relationships that exist between these diagrams is still open.
Acknowledgements. This work was carried out within the
Associate Team TGDA: Topological and Geometric Data
Analysis involving the Geometrica group at INRIA and the
Geometric Computing group at Stanford University. The authors wish to thank the referees for their suggestions to make

1402 F. Chazal, D. Cohen-Steiner, L. Guibas, F. Mémoli, S. Oudot / Gromov-Hausdorff Stable Signatures for Shapes using Persistence
the paper more accessible to non-specialists. They acknowledge the support of NSF through grants ITR 0205671, FRG
0354543 and FODAVA 808515, of NIH through grant GM072970, of ONR through grant N00014-09-1-0783, and of
DARPA through grant HR0011-05-1-0007.

References
[BBI01] B URAGO D., B URAGO Y., I VANOV S.: A Course in
Metric Geometry, vol. 33 of Graduate Studies in Mathematics.
American Mathematical Society, Providence, RI, 2001.
[BBK∗ ] B RONSTEIN A. M., B RONSTEIN M. M., K IMMEL R.,
M AHMOUDI M., S APIRO G.: A gromov-hausdorff framework
with diffusion geometry for topologically-robust non-rigid shape
matching. Submitted.
[BBK06] B RONSTEIN A. M., B RONSTEIN M. M., K IMMEL R.:
Efficient computation of isometry-invariant distances between
surfaces. SIAM J. Scientific Computing 28, 5 (2006), 1812–1836.
[BBK09] B RONSTEIN A. M., B RONSTEIN M. M., K IMMEL R.:
Topology-invariant similarity of nonrigid shapes. Intl. Journal of
Computer Vision (IJCV) 81, 3 (March 2009), 281–301.
[BC99] B URKARD R., C ELA E.: Linear assignment problems
and extensions. In Handbook of Combinatorial Optimization,
supplement vol. A, Du D.-Z., Pardalos P. M., (Eds.). Kluwer Academic Publishers, 1999, pp. 75–149.
[BMP02] B ELONGIE S., M ALIK J., P UZICHA J.: Shape matching and object recognition using shape contexts. IEEE Trans.
Pattern Anal. Mach. Intell. 24, 4 (April 2002), 509–522.
[CCS07] C HAZAL F., C OHEN -S TEINER D.: Geometric Inference. to appear as a book chapter, Springer, 2007.
[CCSG∗ 09] C HAZAL F., C OHEN -S TEINER D., G UIBAS L. J.,
G LISSE M., O UDOT S. Y.: Proximity of persistence modules and
their diagrams. In Proc. 25th ACM Symp. Comp. Geom. (2009).
[CFL06a] C ERRI A., F ROSINI P., L ANDI C.: Stability in multidimensional size theory, 2006.
[CFL06b] C ERRI A., F ROSINI P., L ANDI C.: Stability in multidimensional size theory, 2006.
[CM09] C ARLSSON G.,
tion and stability of

M ÉMOLI F.:
Characterizahierarchical clustering methods.
http://comptop.stanford.edu/preprints/, 2009.

[CO08] C HAZAL F., O UDOT S. Y.: Towards persistence-based
reconstruction in Euclidean spaces. In Proc. 24th ACM Sympos.
Comput. Geom. (2008), pp. 232–241.
[CSEH05] C OHEN -S TEINER D., E DELSBRUNNER H., H ARER
J.: Stability of persistence diagrams. In Proc. 21st ACM Sympos.
Comput. Geom. (2005), pp. 263–271.

[EK03] (E LBAZ ) A. E., K IMMEL R.: On bending invariant signatures for surfaces. IEEE Trans. Pattern Anal. Mach. Intell. 25,
10 (2003), 1285–1295.
[ELZ00] E DELSBRUNNER H., L ETSCHER D., Z OMORODIAN
A.: Topological persistence and simplification. In Proc. 41st
Annu. IEEE Sympos. Found. Comput. Sci. (2000), pp. 454–463.
[Fro90] F ROSINI P.: A distance for similarity classes of submanifolds of euclidean space. Bull. Austral. Math. Soc. 42:3 (1990),
407–416.
[GM05] G HRIST R., M UHAMMAD A.: Coverage and holedetection in sensor networks via homology. In Proc. the 4th
International Symposium on Information Processing in Sensor
Networks (IPSN’05) (2005), pp. 254–260.
[Gro99] G ROMOV M.: Metric structures for Riemannian and
non-Riemannian spaces, vol. 152 of Progress in Mathematics.
Birkhäuser Boston Inc., Boston, MA, 1999.
[Hat01] H ATCHER A.: Algebraic Topology. Camb. Univ. Press,
2001.
[HK03] H AMZA A. B., K RIM H.: Geodesic object representation and recognition. In Lecture Notes in Computer Science,
vol. 2886. Springer, 2003, pp. 378–387.
[HSKK01] H ILAGA M., S HINAGAWA Y., KOHMURA T., K UNII
T. L.: Topology matching for fully automatic similarity estimation of 3d shapes. In SIGGRAPH ’01: Proceedings of the 28th
annual conference on Computer graphics and interactive techniques (New York, NY, USA, 2001), ACM, pp. 203–212.
[JPl]

JP LEX:

Persistent Homology Computations Library.

http://comptop.stanford.edu/programs/jplex/index.html.

[MCH∗ 06] M ANAY S., C REMERS D., H ONG B., Y EZZI A.,
S OATTO S.: Integral invariants for shape matching. PAMI 28,
10 (October 2006), 1602–1618.
[Mém07] M ÉMOLI F.: On the use of Gromov-Hausdorff Distances for Shape Comparison. Botsch M., Pajarola R., Chen B.,
Zwicker M., (Eds.), Eurographics Association, pp. 81–90.
[Mém08] M ÉMOLI F.: Gromov-Hausdorff distances in Euclidean
spaces. In CVPR Workshop on Non-Rigid Shape Analysis and
Deformable Image Alignment (NORDIA’08) (2008).
[MS04] M ÉMOLI F., S APIRO G.: Comparing point clouds. In
SGP ’04: Proceedings of the 2004 Eurographics/ACM SIGGRAPH symposium on Geometry processing (New York, NY,
USA, 2004), ACM, pp. 32–40.
[MS05] M ÉMOLI F., S APIRO G.: A theoretical and computational framework for isometry invariant recognition of point
cloud data. Found. Comput. Math. 5, 3 (2005), 313–347.
[Mun84] M UNKERS J. R.: Elements of algebraic topology.
Addison-Wesley, Redwood City, California, 1984.
[OFCD02] O SADA R., F UNKHOUSER T., C HAZELLE B.,
D OBKIN D.: Shape distributions. ACM Trans. Graph. 21, 4
(2002), 807–832.

[CZCG05] C ARLSSON G., Z OMORODIAN A., C OLLINS A.,
G UIBAS L. J.: Persistence barcodes for shapes. International
Journal of Shape Modeling 11, 2 (2005), 149–187.

[Rus07] RUSTAMOV R. M.: Laplace-beltrami eigenfunctions for
deformation invariant shape representation. In Symposium on Geometry Processing (2007), pp. 225–233.

[dFL05] D ’A MICO M., F ROSINI P., L ANDI C.: Natural pseudodistance and optimal matching between reduced size functions.
Tech. Rep. 66, DISMI, Univ. degli Studi di Modena e Reggio
Emilia, Italy., 2005.

[RWP05] R EUTER M., W OLTER F.-E., P EINECKE N.: Laplacespectra as fingerprints for shape matching. In SPM ’05: Proceedings of the 2005 ACM symposium on Solid and physical modeling
(New York, NY, USA, 2005), ACM Press, pp. 101–106.

[dFL06] D ’A MICO M., F ROSINI P., L ANDI C.: Using matching
distance in size theory: A survey. IJIST 16, 5 (2006), 154–161.

[SP04] S UMNER R. W., P OPOVI C´ J.: Deformation transfer for
triangle meshes. In SIGGRAPH ’04: ACM SIGGRAPH 2004 Papers (New York, NY, USA, 2004), ACM, pp. 399–405.

[EH] E DELSBRUNNER H., H ARER J.: Persistent Homology - A
survey. eds J. E. Goodman, J. Pach and R. Pollack, AMS, to
appear.

[ZC05] Z OMORODIAN A., C ARLSSON G.: Computing persistent
homology. Discrete Comput. Geom. 33, 2 (2005), 249–274.

c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

F. Chazal, D. Cohen-Steiner, L. Guibas, F. Mémoli, S. Oudot / Gromov-Hausdorff Stable Signatures for Shapes using Persistence 1403

circle

helicoid

geodesic / no function

sphere

geodesic / no function

ellipsoid

geodesic / no function

geodesic / no function

∞

∞

∞

∞

1

1

1

1

0

0

0

0

0

0

0

euclidean / no function

euclidean / no function

euclidean / no function

0

euclidean / no function

∞

∞

∞

∞

1

1

1

1

0

0

0

0

0

0

0

0

euclidean / eccentricity

euclidean / eccentricity

euclidean / eccentricity

euclidean / eccentricity

∞

∞

∞

∞

1

1

1

1

0

0
0

0
0

0
0

0

Figure 6: Some toy examples, from left to right: the unit circle, a helical curve of same length 2π drawn on a torus, the unit
sphere, an ellipsoid whose smallest equatorial ellipse has same length 2π as the equator of the sphere. On each shape, a uniform
0.0125-sample has been generated, on top of which various Rips filtrations have been constructed using different metrics and
functions: geodesic distance and no function (second row), Euclidean distance and no function (third row), Euclidean distance
and 0.2 times the eccentricity (fourth row). The corresponding persistence diagrams are presented in rows 2 through 4: each
picture shows the 0-dimensional (blue), 1-dimensional (red), and 2-dimensional (green) diagrams super-imposed.

c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.


Eurographics Symposium on Rendering 2009
Hendrik P. A. Lensch and Peter-Pike Sloan
(Guest Editors)

Volume 28 (2009), Number 4

Anomalous Dispersion in Predictive Rendering
Andrea Weidlich1 and Alexander Wilkie2
1 Vienna
2 Charles

University of Technology, Austria
University in Prague, Czech Republic

Abstract
In coloured media, the index of refraction does not decrease monotonically with increasing wavelength, but behaves in a quite non-monotonical way. This behaviour is called anomalous dispersion and results from the fact
that the absorption of a material influences its index of refraction.
So far, this interesting fact has not been widely acknowledged by the graphics community. In this paper, we demonstrate how to calculate the correct refractive index for a material based on its absorption spectrum with the
Kramers-Kronig relation, and we discuss for which types of objects this effect is relevant in practice.
Categories and Subject Descriptors (according to ACM CCS): Computer Graphics [I.3.3]: Three-Dimensional
Graphics and Realism—

1. Introduction
Dispersive refraction – the split of polychromatic light into
its spectral components – is perhaps the simplest, but also
one of the most visually prominent attributes of all transparent materials. Frequently included in computer graphics applications, the effect can be considered common knowledge
in the graphics engineering community. However, most current graphics implementations of dispersive refraction use
approximative formulas taken from optics, which implicitly
assume that the index of refraction (IOR) always decreases
towards shorter wavelengths. This is a valid assumption for
colourless transparent solids; however, for coloured transparent objects, it often is not. For such objects, the IOR
can exhibit a markedly non-monotonic behaviour. This behaviour is called anomalous dispersion in optics literature
(in contrast to the normal dispersion found in plain transparent substances), and its most obvious consequence is a
partial reversal of the usual sequence of prismatic colours
(see figure 1 for an illustration).
Regions of anomalous dispersion always occur around absorption frequencies, because there is a direct connection between the IOR and the absorption of a material. This means
that every substance has regions of normal and anomalous
dispersion, because every real material has one or more
bands of absorption. If at least one of them lies in the visible spectrum (which is the case for coloured dielectrics) the
phenomenon of anomalous dispersion is visible.
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

(a)

(b)

Figure 1: Dispersive refraction of light falling through
prisms made of (a) clear BK7 glass, and (b) a Fuchsine solution. For the pink prism, the order of the spectral colours is
reversed and the pattern is much larger, although the average
IOR is approximately the same for both materials. The green
part of the incident light is completely absorbed in (b).

In this paper we investigate the importance of this effect
for computer graphics applications, and also show how one
can include this effect in a ray-based renderer. Our goal is
to make this particular area of optics knowledge accessible
to computer graphics engineers, by giving a brief introduction into the relevant physical background, and by presenting a ready-to-use technique that computes the IOR from absorption data. Since the classical, simple dispersion formulas
cannot be used to calculate this effect, we show how one can
use the Kramers–Kronig relations to calculate the index of
refraction from absorption data. We then demonstrate that

1066

A. Weidlich & A. Wilkie / Anomalous Dispersion in Predictive Rendering

the effect of anomalous dispersion can really lead to visible
artefacts in scenes that contain coloured dispersive objects,
and also discuss when one can safely omit such calculations.

n

k
UV

Visible

Infra red

0.7

1.8

UV

Visible

Infra red

0.6

1.6

0.5
0.4

1.4

0.3
1.2

2. Background

0.2

1.0

While the connection between the absorption characteristics
of an object and its IOR is well known to physicists, this
fact has received hardly any attention in the graphics community so far, except for very recently [FCJ07], but even
there, anomalous dispersion as such was not investigated.
In [Fri08] the influence of the absorption on the reflection
was discussed. The main reason why this connection is relevant for computer graphics is that the common modelling
practice of choosing the IOR and colour of a transparent object independently of each other is physically incorrect, and
can lead to visually detectible errors.

0.1
0.1

0.5
0.5

1.0

5.0

10.0

50.0 100.0

m

0.1

(a)

0.5

1.0

5.0

10.0

50.0 100.0

m

(b)

Figure 2: (a) n and (b) k of water ice from the UVto the far
infra-red. Outside the visible range the index of refraction
changes dramatically while it is smooth in the visible region,
because no absorption occurs there. After [War84].

where α(λ ) is the absorption coefficient that describes the
absorbance A(λ ) of a medium with path length l.
A(λ ) = α(λ )l

(4)

2.1. Dispersive Refraction
When light strikes an interface between two different media,
some of the energy is reflected, propagates in the mirror direction and stays within the first medium. In most cases, a
part of the incident energy also enters the second medium,
and continues its propagation there. How large this second
part is, and in which direction it continues its path, is dependent on the relative density of the two media; the speed of
light is changed at the interface between the two, and (except
at normal incidence) a change of direction occurs – the light
is said to be refracted. The relationship between angle of
incidence and angle of refraction of a light wave when travelling between two media with different refractive indices is
given by Snell’s law
n1 (λ ) sin θ1 = n2 (λ ) sin θ2

(1)

where n1 (λ ) and n2 (λ ) are the respective, wavelengthdependent refractive indices, and θ1 and θ2 are the angles
between normal and incident, and normal and refracted ray.
Since the IOR of all transparent materials is not a constant, but depends on the wavelength, light of different wavelengths is deflected in slightly different directions, which
produces an angular separation of the colours, called dispersion.
Strictly speaking, equation 1 is only valid for light that enters a perfectly transparent material. For all materials that do
exhibit some form of attenuation when light passes through
them, it is convenient to group information about the IOR
and the attenuation characteristics into a single, complexvalued entity, the complex index of refraction n(λ
˜ ):
n(λ
˜ ) = n(λ ) + i k(λ ),

(2)

where n(λ ) is the real-valued IOR from equation 1, and k(λ )
is referred to as the extinction coefficient (or, sometimes, the
absorption index) of the material. k is given by
k(λ ) =

λ α(λ )
,
4π

(3)

It is worth noting that in principle, all materials can be
described by a complex-valued IOR; perfectly transparent
materials are simply assumed to have a k(λ ) of zero. In computer graphics, one usually only encounters k(λ ) when the
Fresnel terms for strongly absorbing media (such as metals)
have to be evaluated. But in fact all coloured, transparent
objects have an IOR with a non-zero imaginary component,
even though it is usually quite small for such materials.
2.2. Anomalous Dispersion of Light
For practically all colourless dielectrics, the IOR monotonically decreases for increasing wavelengths in the visible
range, which means that the dispersive fan-out will be in the
strict wavelength order one has grown accustomed to from
rainbows of all sorts: from violet and blue via green to yellow, orange and red. However, even for objects that are completely transparent in the visual range, the refractive index is
not monotonic everywhere.
In this context, it is instructive to examine an IOR plot
that covers a wide range of wavelengths, such as figure 2,
which shows the refractive behaviour of water ice from the
UV to the far infra-red. Plots like that reveal that for all dielectric substances, the IOR only behaves monotonically in
the regions between the absorption bands. In the immediate
neighbourhood of the absorption band the IOR first starts to
decrease strongly with increasing wavelength, then abruptly
increases, and finally decreases to a normal level again.
The reason for this is as follows: when an electromagnetic
wave encounters a collection of atoms, an oscillating electromagnetic field E is superimposed on the field of forces that is
responsible for the coherency of the material. As a result of
this external force, the electrons in the material are forced to
leave their equilibrium positions. One consequence of this
is that the entire atom to which the displaced electron belongs turns into an electric dipole, and that the atom starts to
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

1067

A. Weidlich & A. Wilkie / Anomalous Dispersion in Predictive Rendering

exhibit an electric polarisation P [BW99].
P = ε0 χE

(5)

where ε0 is the electric permittivity and χ is the electric susceptibility. This electron displacement grows larger as the
excitation frequency moves closer to one of the characteristic resonance frequencies ωo of the material. As long as
the excitation frequency is smaller than the resonance frequency, the excited and the forced oscillation of individual
dipoles are in phase, and the dipoles can respond to the excitation. At the actual resonance frequency, energy can be
transferred to the system with very little resistance. The amplitude of the resulting oscillations becomes very large –
much larger than the amplitude of the driving force, as the
light can travel with low resistance, and the IOR decreases
rapidly. Once the excitation frequency is larger than the resonance frequency, though, excitation and oscillation of the
dipoles are suddenly 180◦ out of phase. The dipoles are no
longer able to properly react to incident oscillations that are
now too fast for them, and energy can only be transferred to
the system by overcoming a significantly higher resistance.
Consequently, light suddenly travels much slower, and the
IOR increases significantly once the frequency of incident
light has moved past the absorption frequency. Once the incident frequency moves further away from the absorption
frequency, this effect gradually wears off, and normal, undisturbed propagation in the material resumes.
All this leads us to the somewhat surprising conclusios
that (a) even for the simple case of colourless dielectrics,
the dispersion behavior of the material in the visible range
is actually directly determined by the location and intensity
of the absorption bands that the substance exhibits in the regions of the electromagnetic spectrum adjacent to the visible
range and (b) that all materials have regions of normal and
anomalous dispersion, because apart from the limit case of
vacuum, one or more strong absorption bands can be found
in every real material. The effect becomes directly visible
(and thereby relevant for computer graphics) if one or more
absorption bands lie in the visible region.
3. Kramers-Kronig Relations
Since the classical dispersion formulas implicitly assume the
IOR to be monotonically falling, they cannot be used if the
material has one or more absorption bands in the visible part
of the spectrum, i.e. if the material is not colourless. Tables
with measured IOR data are a rarity in literature, so an analytical approach is needed. Fortunately, there is a direct connection between the IOR and the absorption characteristics
of a material, and it is possible to calculate one from the
other using the Kramers–Kronig relations (KKR).
3.1. Kramers–Kronig Relations for the IOR
In physics, the Kramers–Kronig relations (KKR) are a well
known tool that, given one component of a meromorphic
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

complex-valued function, can be used to determine the other
component. In our case this means we can calculate the realvalued IOR from the imaginary extinction coefficient.
The reason for this is one of the most fundamental notions
in physics: the principle of causality – a system cannot respond before an excitation has actually taken place. It also
holds for light-object interactions. Matter is excited by the
electric field of the incident beam, which forces the dipoles
of the material to vibrate, and the material responds with polarisation. The electric charges become the source of an electromagnetic wave which results in reflected and transmitted
beams of light (Huygens’ principle). If the field varies with
time, so does the polarisation, whereas P is proportional to
E. Equation 5 can be written as a response function.
∞

P(t) = ε0

−∞

¯ − t )dt
E(t )χ(t

(6)

Equation 9 is a time-dependent function a(t)
¯
with a(t)
¯ =
0 for t < 0. The principle of causality guarantees that for
the Fourier transform a(ω) of a(t)
¯ the real and imaginary
components are Hilbert transforms of each other, so that the
¯
Fourier transform of χ(ω) of the susceptibility χ(t)
can be
written as [LPSV05]
∞ ω Im{χ(ω )}
2
dω
P
π
ω 2 − ω2
0
∞ Re{χ(ω )}
2ω
Im{χ(ω)} = −
P
dω
π
ω 2 − ω2
0

Re{χ(ω)} =

(7)
(8)

where P denotes the principal value of the integral. Since
1 + 4π χ(ω) = n(ω) + ik(ω)

(9)

is holomorphic in the upper complex ω-plane, equation 7
and 8 can be rewritten in a form that it connects the real and
imaginary parts of the frequency-dependent complex-valued
refractive index n(ω)
˜
[LPSV05]
ω k(ω )
dω
(10)
2 − ω2
ω
0
∞ n(ω ) − 1
dω
(11)
0 ω 2 − ω2
These relations are called the the Kramers-Kronig relations;
the structure of this relationship is derived from mathematical considerations alone. If used in the optical context discussed above, ω can take on the meaning of the frequency
for which the frequency-dependent resonance behaviour of
the material is being evaluated. In physics literature the KKR
are normally given in terms of angular frequency ω, and for
an integration range of [0, ∞]. For our purposes it is more
convenient to rewrite them in terms of wavelength λ , and
for a given, finite integration range [λmin , λmax ]; the latter is
necessary because absorption data is usually not available
for the entire frequency range [WO03].
2
P
π
2ω
k(ω) = −
P
π

∞

n(ω) = 1 +

n(λ ) = nb +

2λ 2
P
π

λmin
λmax

k(λ )
dλ
λ (λ 2 − λ 2 )

nb is the background refractive index.

(12)

1068

A. Weidlich & A. Wilkie / Anomalous Dispersion in Predictive Rendering

3.2. Solving the Kramers–Kronig Relation

where

There are two potential problems which limit the practical
usefulness of the KKR:
• An analytical solution for equation 10 would require absorption data over the range [0, ∞]. This is clearly impractical for use in computer graphics, since one usually only
has absorption data for a small part of the entire frequency
range, such as the visible spectrum, available.
• The integral has a pole at λ 2 − λ 2 . This pole requires an
approximation.
In practice, this means one has to extrapolate the absorbance
values beyond the actual measurement data and perform the
numerical integration by using a specific numeric integration
formula on the KKR integrals that can handle the pole λ 2 −
λ 2 . In the following two sections, we describe each of these
tasks in more detail.
3.2.1. Dealing With Measurement Data Taken Over a
Finite Range
Since absorption data cannot be measured over the complete
spectral domain with reasonable effort, one has to decide
what to do with the limited data. One strategy is to extrapolate the data outside the measured range by defining a physical model which corresponds to the optical property under
investigation (usually a Gauss distribution is used to simulate an absorption band). A different approach is to directly
use the limited experimental data that is available, without
attempting any extrapolation. This strategy is expected to be
successful only when the optical property in question falls
off quickly outside the measured spectral range, and remains
at zero for all frequencies outside the measured range.
3.2.2. Performing the Integration
The problem of how to perform the actual integration in the
presence of a pole in the function is of a numerical nature,
and a moderate amount of literature exists on how one can
tackle such an issue. One possibility is the use of Fourier
transforms [Kin07]. A different, rather straight-forward and
accurate method to solve the KKR is the use of Maclaurin’s
Formula since it is very easy and also accurate [OI88]; this
is the technique we resorted to.
If the values of an absorption spectrum k(λ ) are transformed and stored as m discrete values
k(λ )1 , k(λ )2 , k(λ )3 , ..., k(λ ) j , ..., k(λ )m−1 , k(λ )m

(13)

and
h = λ j+1 − λ j for ( j = 1, 2, ..., m − 1)

(14)

is the integration interval, we can approximate the estimate
of the integral by taking every other point into account so
that
Ii =

2λ 2
× 2h ×
π

∑ fj
j

(15)

fj =

k(λ )
λ (λ 2 − λ 2 )

(16)

The ∑ j denotes that if i is odd, j = 2, 4, 6, ..., i − 1, i + 1, ...,
and if i is even, j = 1, 3, 5, ..., i − 1, i + 1, .... This way we
can avoid a calculation of the pole at i = j. Mathematica R
code that shows how this formula can be used to calculate
the IOR from the extinction coefficient in practice can be
found in appendix A.
Generally, the error incurred by truncating the function
outside the visual range is quite small, which, given the inherently rather local influence of each component on the
other, is not entirely surprising. However, an exact assessment of the truncation error is also possible and can be found
in [LPSV05]. A discussion of the error that arises though
the use of Maclaurin’s Formula can be found in [OI88].
These issues should always be kept in mind when performing anomalous dispersion calculations based on absorbance
data, in particular if highly accurate results are desired.

4. Results
4.1. Integration of Dispersion into a Ray-based
Renderer
The simulation of normal dispersion has been addressed numerous times in computer graphics. It was first introduced
to computer graphics by [Tho86] as an add–on to a standard ray tracer that breaks up the incident energy into six
subrays, where each one represented only a part of the spectrum. [YKIS88] managed to reduce the computational complexity by using only three rays to represent a spreading incident ray. Dispersion was further investigated by [SFD00b],
who used a hybrid spectral model which decomposed the
spectrum into its smooth component, and a collection of
spikes to optimally represent monochromatic light rays and
spiky emission spectra to render dispersion in gemstones,
later also in combination with absorption [SFD99]. [GS04]
presented an integrated real-time system capable of interactively rendering gemstones including dispersion effects.
We decided to use a stratified sampling approach similar to that of [SFD00a]; a polychrome ray is split up into a
fixed number of monochrome sub-rays on the first dispersive interface, which are then followed individually through
the scene without any further path forking. The wavelength
of each sub-ray is chosen stochastically from the spectrum
that was first partitioned into as many segments as sub-rays
will be generated in each step. We used 45 sub-rays; comparisons with 450 showed no visually detectible differences.
We choose this approach because is straight-forward to implement. Also, a more sophisticated approach that chooses
the number of samples according to the dispersion value of
the material could be counterproductive in this scenario due
to the anomalous behaviour of the IOR.
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

A. Weidlich & A. Wilkie / Anomalous Dispersion in Predictive Rendering

Although the realisation of dispersion is possible in a tristimulus based rendering system, it does not yield good results due to the limited number of colours and the resulting low quality rainbow effects. For this reason we used the
Advanced Rendering Toolkit (ART), a spectral rendering research system, as our implementation testbed, instead of a
conventional RGB colour space rendering system.

1069

prominent exactly in those wavelength regions where the absorption of light is strongest. Nonetheless, there are several
ways to make this effect visible. The first person who observed and analysed anomalous dispersion was [Chr71] by
using an alcohol Fuchsine solution of 19 percent and a prism
with a very small refractive angle of 1◦ 14’. Later [Kun71]
and [Pfl98] as well as [Woo99] [WM01] further examined
techniques to make anomalous dispersion visible and measured the change in the index of refraction. A complete review of the known techniques to observe anomalous dispersion can be found in [EHB98] where also a photo of the
effect can be seen.
The most striking demonstration of the phenomenon is
that if one uses a strongly coloured prism to split a light
ray into its rainbow components, the order of the rainbow
colours will be partially reversed in some regions of the
spectrum. So after establishing the theoretical foundations
outlined in the previous sections, our next goal was to reproduce the effect in various renderings, in order to properly
assess its importance for computer graphics.

Figure 3: An overview rendering of the scene geometry we
used to demonstrate the effect. The white arrows show the
approximate optical path that caused the rainbow pattern in
this image. Figure 5 shows close-up images of these rainbow
patterns for various prism materials.
n

1.37

k

0.04

1.36

0.03

1.35

0.02

1.34

0.01

1.33

400

450

500

550

(a)

600

650

700

m

300

400

500

600

700

m

(b)

Figure 4: (a) n and (b) k for rose bengal solutions of varying
concentration. The three curves correspond to the dispersion
patterns shown in the top row of figure 5 – dark pink for
image 5a (high concentration), medium pink for 5c (medium
concentration), and bright pink for 5e (weak concentration).
The dotted line in (a) is the IOR of pure water.

4.2. Rendering of Anomalous Dispersion Effects
The characteristic partial reversal of the colour sequence in
a rainbow that results from the anomalous behaviour of the
refractive index is occasionally mentioned in physics literature, sometimes even schematically sketched (e.g. [Ber93]
or [Nas01]). However, actual photos of the effect are quite
rare, since it is difficult to observe in an experimental setting.
This lies in the nature of the phenomenon; the effect is most
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

To demonstrate the effect, we first performed this experiment; an overview is shown in figure 3. As material properties for the prism we assumed those of rose bengal diluted in
water, and used the extinction coefficient and IOR data provided by [van15] as input. We performed our virtual optical
experiment with a prism being made up from three solutions
of rose bengal with different concentration; a strongly dyed
10 percent solution, a less concentrated 3.3 percent solution
and a 1 percent solution of the same substance. The indices
of refraction and the extinction coefficients can be seen in
figure 4 for all concentrations. The same prisms were also
rendered with the IOR of pure water to see what happens if
the influence of the extinction coefficient is neglected.
Just like in the classical experimental setup for this phenomenon, a directional light source was placed at the thin
edge of the coloured prism so that the incident rays are already split into their prismatic colours, but the absorption
is still weak. The result was as expected and in accordance
with the photo that can be seen in [EHB98] – the colors are
separated and reversed, since the anomalous change in the
refractive index is very strong in this case (figure 5a). Two
things can be observed:
• The colour sequence goes from indigo to blue and violet,
is followed by red through orange to yellow. Green is absorbed completely. However, there is no clear separation
between blue and violet, because some wavelengths have
the same index of refraction, and therefore some colours
that are normaly seperated are mixed together.
• The dispersive fan-out is much wider for anomalous dispersion, than for a pure water solution in the same geometrical setting (figure 5b).
However, once we moved the light source towards the
thicker part of the prism, the dispersion pattern soon van-

1070

A. Weidlich & A. Wilkie / Anomalous Dispersion in Predictive Rendering

(a)
(a)

(b)

(c)

(b)

Figure 6: Comparison of a strongly coloured, brilliant cut
gemstone of 1mm size, rendered (a) with and (b) without
anomalous dispersion effects and a difference image (c).

(c)

(d)

dilution of the coloured solution requires care, and hollow
prism of quite specific shape is needed. Unsurprisingly, the
experiment proved to be very simple to set up in its simulated form by comparison.
4.3. Anomalous Dispersion in Crystals

(e)

(f)

Figure 5: Dispersion patterns created by light falling through
a prism filled with – from top to bottom – decreasing concentrations of rose bengal, diluted in water (left column), and
patterns created by light falling through prisms with exactly
the same transmission characteristics, but with the IOR of
plain water where the order of the rainbow colours stays the
same (right column).

ished, because all light is swallowed by the much stronger
absorption.
The dispersion curve of the second solution with decreased concentration also exhibited some anomalous behaviour, but not as strongly as in the first experiment (figure
5c). Still, compared to rendered images that use just a normal dispersion curve, a difference can be seen, even if the
light source is moved away from the edge and the absorption becomes stronger.
The anomalous behavior of the dispersion becomes even
weaker for the third solution (figure 5e). There is only a
small region of anomalous behaviour and only the colours
between 480 and 570 nm are mixed together; the visual difference is only marginal otherwise, and the colour sequence
is similar to the dispersion pattern of pure water (figure 5f).
If done with a real tinted solution in a lab setting, the experiment is allegedly hard to get right, since controlling the

After the experiment discussed in the previous section had
shown that, at least in principle, there are certain materials and situations where anomalous dispersion cannot be neglected if truly accurate rendering is desired. We wanted to
focus on the one application where this phenomenon might
make a difference that is large enough to warrant its consideration in production rendering systems – the area of gemstone rendering. Coloured, transparent cut gemstones such
as sapphires, rubies and emeralds all obviously owe their
colour to absorption bands in the visible range, and therefore ought to exhibit the phenomenon to some degree.
In order to determine whether the inclusion of the effect
causes visually detectable differences in the appearance of
rendered gemstones, we performed two experiments. In each
of these, we rendered a gemstone with and without anomalous dispersion, and compared the differences. The two test
cases were a strongly coloured brilliant cut blue spinel, and
an intensively coloured pink gemstone that we rendered in
four different sizes. As with the rose bengal prism, we did
not want to use artificial data for the absorption characteristics of the gemstone. We wanted to examine the influence of
the effect on a real gemstone, so we used the data of [Tro34].
He measured the IOR and the absorption of several different types of spinel, which clearly illustrate the change from
normal to anomalous dispersion with increasing absorption.
Since the absorption data is only given in galvanometer readings, we used the KKR to calculate the extinction coefficient
from the IOR for the visible spectrum.
As can be seen in figure 6, the results of this experiment
are at best ambiguous although a few differences are visible – a few of the colourful dispersion "flashes" that can be
seen on the crown are different. For this case, one can conclude that anomalous dispersion only has to be included if
perfect pixel-by-pixel accuracy of renderings of such a stone
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

A. Weidlich & A. Wilkie / Anomalous Dispersion in Predictive Rendering

1071

Figure 8: Spheres coated with three different effect lacquers
of the type described by [SMAS08], without (left half of images) and with (right half) anomalous dispersion of the pigment particles taken into account. Apart from the dispersion
characteristics of the pigments, the BRDF parameters (and
in particular, the absorption characteristics of the pigment
particles) are identical.
(a)

(b)

(c)

(d)

Figure 7: A brilliant cut gemstone with the basic dispersion
characteristics of diamond, and a single strong region of absorption in the green region of the spectrum. The top row are
images rendered with a naive, physically incorrect IOR, the
next row shows the results if anomalous dispersion is taken
into account, and the last row are difference images.

is desired. For all other applications, the normal IOR of an
un-coloured stone is apparently sufficient.
However, the situation is different for smaller objects. We
rendered four different brilliant cut gemstones with the same
overall transparency and colour (figure 7). The difference
between the four cases is the size of the stone: (a) shows
a stone with a diameter of 1cm, (b) of 1mm, (c) 0.1mm,
and (d) 0.01mm. The absorption was scaled so that all four
stones have similar overall appearance; this means that the
minuscule stone used for case (d) is made from a much more
opaque material than the one shown in (a). (a) has the absorption characteristics of a pink diamond; for the remaining stones we increased its absorbance, i.e. the data for the
stones in (b) to (d) is artificial – but still plausible – and we
used the KKR to calculate the corresponding IOR. Cases (c)
and (d) exhibit significant changes, although the effect does
cause some smaller differences even for case (b).

complex, layered BRDFs or pigments that can be found in
cosmetic products, with an appearance that is partly determined by the inclusion of such particles [SMAS08] or the
prediction of the appearance of fibers from e.g. woven fabrics [RKS97].
To demonstrate the former point, we rendered three
spheres coated with an effect lacquer that derives its appearance from very small, strongly absorbing particles that are
supported in a binder matrix. We used the model similar to
that proposed by [SMAS08]; the particles are non-spherical,
and oriented randomly according to a Gaussian distribution.
The transfer matrix method was used to compute the actual
reflectance values, and the material parameters were those
of actual substances used in such coatings. The parameter
values were taken from literature, e.g. for mica covered with
titanium dioxide that is again covered by iron oxide particles
(one of our test cases).
As can be seen in figure 8, the difference in chroma between a simulation that considers anomalous dispersion, and
one that does not, is quite strong. Also, the goniochromic
behaviour of the BRDF is obviously also altered by the inclusion of this effect, as can be best seen on the leftmost
sphere. This example illustrates that the common practice in
contemporary computer graphics to neglect anomalous IOR
behaviour in lacquer models that include pigments is a potentially major source of error.

4.3.1. Coatings
Due to the minuscule size of the smallest of the four test
objects, this feature probably still does not make anomalous dispersion particularly relevant for actual renderings
of macroscopic objects, except perhaps for tiny crystals at
very large magnifications. However, as can be seen from the
large visual differences in the third and fourth cases shown
in figure 7, the dispersion behaviour of small structures made
of strongly absorbent material is indeed very susceptible to
changes due to anomalous dispersion. Which makes the phenomenon very relevant for all simulations that involve small
structures that contain strongly absorbent materials, such as
c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.

5. Conclusion and Future Work
In this paper we have shown the following three main points:
1. How one can, for a given material absorbance, compute
the correct changes that have to be made to the index of
refraction compared to a similar transparent material,
2. that the effect of anomalous dispersion is not particularly
relevant for normal-sized objects, except if utmost accuracy is desired, but we also showed
3. that the effect can cause large deviations from normal refractive behaviour if the objects in question are very small

1072

A. Weidlich & A. Wilkie / Anomalous Dispersion in Predictive Rendering

or thin, and made from strongly absorbent materials; this
includes strongly absorbent particles in complex BRDFs.
Future work in this area will include further investigations
of scenarios that might require anomalous dispersion capabilities for accurate prediction of their appearance. Candidates for such scenarios are woven materials made from thin,
strongly absorbent fibers, certain types of crystalline surface
coatings, and specialised forms of effect paintwork that include small, non-metallic, and strongly absorbing particles
like e.g. dyes to achieve their appearance.
Appendix A: Calculating the IOR from absorbance values
This code shows how the KKR can be used to calculate
the IOR from the extinction coefficient. There are two input parameters: the first is a two-dimensional list with n elements s[{{λn , kn }}]; the first component of each element
contains the wavelength, and the second the extinction coefficient at this wavelength. The second is a one-dimensional
list nb[{nn }] that stores the basic IOR.
maclaurinN[s_, nb_] := Module[
{ m, mm, k, v, i, j },
m = 84; (* number of sample points *)
mm = (720-300)/m; (* Distance between sample points *)
fOdd[i_]:=
Sum[ s[[j]][[2]] / (s[[j]][[1]]*s[[i]][[1]]2 - s[[j]][[1]]2 )),
{j, 2, m, 2}];
fEven[i_] :=
Sum[ s[[j]][[2]] / (s[[j]][[1]]*(s[[i]][[1]]2 - s[[j]][[1]]2 )),
{j, 1, m, 2}];
f[i_] := If[ Mod[i, 2] == 0, fEven[i], fOdd[i] ];
maclaurin[i_, h_] := (2*s[[i]][[1]]2 ) / π *2h*f[i];
n = Table[{300 + λ *mm,
nb[300 + λ *mm] + maclaurin[λ , mm] },{λ , m}] ]

References
[Ber93] B ERGMANN L.: Optik, vol. 3 of Lehrbuch der Experimentalphysik. de Gruyter, 1993.
[BW99] B ORN M., W OLF E.: Principles of Optics. Electromagnetic Theory of Propagation, Interference and Diffraction of
Light, 7 ed. Cambridge University Press, Cambridge, 1999.

[GS04] G UY S., S OLER C.: Graphics gems revisited. ACM
Transactions on Graphics (Proceedings of the SIGGRAPH conference) 23, 3 (2004), 231–238.
[Kin07] K ING F. W.: Numerical evaluation of truncated kramerskronig transforms. J. Opt. Soc. Am. B 24, 7 (2007), 1589–1595.
[Kun71] K UNDT A.: Über anomale Dispersion. Annalen der
Physik 220 (1871), 128–137.
[LPSV05] L UCARINI V., P EIPONEN K.-E., S AARINEN J. J.,
VARTIAINEN E. M.: Kramers-Kronig Relations in Optical Materials Research. Springer, Berlin Heidelberg, 2005.
[Nas01] NASSAU K.: The Physics and Chemistry of Color, 2 ed.
John Wiley & Sons, Inc., United States, 2001.
[OI88] O HTA K., I SHIDA H.: Comparison among several numerical integration methods for Kramers-Kronig transformation.
Applied Spectroscopy 42 (Aug 1988), 952.
[Pfl98] P FLÜGER A.: Prüfung der Ketteler-Helmholtz ’schen
Dispersionsformeln an den optischen Constanten anomal dispergirender, fester Farbstoffe. Annalen der Physik 301 (Jan 1898),
173–213.
[RKS97] RUBIN B., KOBSA H., S HEARER S. M.: Prediction
and verification of an iridescent synthetic fiber. Appl. Opt. 36, 25
(1997), 6388–6392.
[SFD99] S UN Y., F RACCHIA F. D., D REW M. S.: Rendering the
phenomena of volume absorption in homogeneous transparent
materials. In 2nd Annual IASTED International Conference on
Computer Graphics and Imaging (CGIM ’99) (1999), pp. 283–
288.
[SFD00a] S UN Y., F RACCHIA F., D REW M.: Rendering diamonds. In Proceedings of the 11th Western Computer Graphics
Symposium (WCGS) (2000), pp. 9–15.
[SFD00b] S UN Y., F RACCHIA F. D., D REW M. S.: Rendering
light dispersion with a composite spectral model. In 1st International Conference on Color in Graphics and Image Processing
(Nov. 2000), pp. 51–56.
[SMAS08] S HIOMI H., M ISAKI E., A DACHI M., S UZUKI F.:
High chroma pearlescent pigments designed by optical simulation. Journal of Coatings Technology and Research 5, 4 (Dec.
2008), 455–464.
[Tho86] T HOMAS S. W.: Dispersive refraction in ray tracing. The
Visual Computer 2, 1 (Jan. 1986), 3–8.
[Tro34] T ROMNAU H.-W.: Chemische und physikalische untersuchungen an synthetischen mit kobalt gefärbten spinellen.
Neues Jahrbuch für Mineralogie, Geologie und Paläontologie,
Beil-Bd 68 (1934), 349–376.
[van15] VAN DER P LAATS B. J.: Untersuchung über Absorption
und Dispersion des Lichtes in Farbstofflösungen. Annalen der
Physik 352 (1915), 429–462.
[War84] WARREN S. G.: Optical constants of ice from the ultraviolet to the microwave. Applied Optics 23, 8 (1984), 1206–1225.

[Chr71] C HRISTIANSEN C.: Über das Brechungsverhältniss des
Fuchsins. Annalen der Physik 219 (1871), 250–259.

[WM01] W OOD R., M AGNUSSON C.: The anomalous dispersion
of cyanin. Philos Mag 1 (Jan 1901), 36–45.

[EHB98] E RDÉLYI M., H ILBERT M., B OR Z.: Anomalous dispersion of dye solutions observed in a prismatic cuvette. American Journal of Physics 66 (Sept. 1998), 791–793.

[WO03] WAKAMATSU T., O DAUCHI S.: Thermal-changeable
complex-refractive-index spectra of merocyanine aggregate
films. Appl. Opt. 42, 34 (2003), 6929–6933.

[FCJ07] F RISVAD J. R., C HRISTENSEN N. J., J ENSEN H. W.:
Computing the scattering properties of participating media using
lorenz-mie theory. ACM Trans. Graph. 26, 3 (2007), 60.

[Woo99] W OOD R.: On cyanine prisms and a new method of
exhibiting anomalous dispersion. Proceedings of the Physical
Society of London 1 (Jan 1899), 671–674.

[Fri08] F RISVAD J. R.: Light, Matter, and Geometry : The Cornerstones of Appearance Modelling. VDM Verlag Dr. Müller,
2008.

[YKIS88] Y UAN Y., K UNII T. L., I NAMOTO N., S UN L.: Gemstone fire: adaptive dispersive ray tracing of polyhedrons. The
Visual Computer 4, 5 (1988), 259–270.

c 2009 The Author(s)
Journal compilation c 2009 The Eurographics Association and Blackwell Publishing Ltd.


Volume 28 (2009), Number 2

EUROGRAPHICS 2009 / P. Dutré and M. Stamminger
(Guest Editors)

Color correction for tone mapping
R. Mantiuk1,3 , R. Mantiuk2 , A. Tomaszewska1 and W. Heidrich2
1

2
3

Szczecin University of Technology, Szczecin, Poland
The University of British Columbia, Vancouver, Canada
Max-Plack-Insitut für Informatik, Saarbrücken, Germany

Abstract
Tone mapping algorithms offer sophisticated methods for mapping a real-world luminance range to the luminance range of the output medium but they often cause changes in color appearance. In this work we conduct a
series of subjective appearance matching experiments to measure the change in image colorfulness after contrast
compression and enhancement. The results indicate that the relation between contrast compression and the color
saturation correction that matches color appearance is non-linear and smaller color correction is required for
small change of contrast. We demonstrate that the relation cannot be fully explained by color appearance models.
We propose color correction formulas that can be used with existing tone mapping algorithms. We extend existing global and local tone mapping operators and show that the proposed color correction formulas can preserve
original image colors after tone scale manipulation.
Categories and Subject Descriptors (according to ACM CCS):
Generation—Display algorithms;

1. Introduction
While many tone mapping algorithms offer sophisticated
methods for mapping a real-world luminance range to the
luminance range of the output medium, they often cause
changes in color appearance. The most common tone manipulation is luminance compression, which usually causes
darker tones to appear brighter and distorts contrast relationships. Figure 1B shows an HDR image after compressing
luminance contrast by a factor of 0.3 while preserving pixel
chrominance values (in terms of the CIE xy chromatic coordinates). When compared to the non-compressed image (exposure adjustment + sRGB display model) in Figure 1A, the
colors are strongly over-saturated. If, instead of compressing luminance, all three color channels (red, green and blue)
are compressed, the resulting image is under-saturated, as
shown in Figure 1C. To address this problem, tone mapping
algorithms often employ an ad-hoc color desaturation step,
which improves the results, but gives no guarantee that the
color appearance is preserved and requires manual parameter adjustment for each tone-mapped image (Figure 1D).
The goal of this work is to quantify and model the corc 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

Computer Graphics [I.3.3]: Picture/Image

rection in color saturation that needs to be made after tone
mapping. We do not rely on the predictions of the existing
appearance models but instead conduct a subjective appearance matching in which we measure the necessary color
correction. Given a tone-curve in the luminance domain,
we want to find new chrominance values such that the resulting image closely matches the appearance of the image with no tone modification. However, unlike other approaches [PFFG98,PTYG00,FJ04,AR06,KJF07], we do not
want to compensate for the difference in viewing conditions
between a display and the real-world scene, such as adapting
luminance, chromatic adaptation (white balancing) or color
appearance effects due to the difference in absolute luminance levels. The color-corrected images should preserve the
appearance of the reference image with unmodified contrast
shown on the same display. For HDR scenes the reference
image is the best exposure displayed after accounting for
a display function (display model). We also do not study
the aspect of color preference, although it is known that
more saturated colors are preferred in reproduction [FdB97].
These assumptions are necessary to isolate different effects,
which would otherwise obscure the experimental results.

194

R. Mantiuk, R. Mantiuk, A. Tomaszewska & W. Heidrich / Color correction for tone mapping

Figure 1: An original image A) compared with three images after contrast compression. Two common color correction methods
B) and C) are compared with manual color adjustment D). Existing color correction methods cannot adjust colors for large
contrast compression.

This paper offers the following contributions:
• Color reproduction properties of the color correction
methods commonly used in tone mapping are analyzed
in Section 3.
• We measure the necessary color correction in an experimental study and derive a color correction model in Section 4.
• We demonstrate that color appearance models cannot
fully explain experimentally measured color correction in
Section 5.
• In an additional experiment we measure the color correction in the CIELAB color space [Col86] (Section 6) and
then discuss the limitations of this method in Section 7.
• Local and global tone mapping operators are extended to
include the proposed color correction in Section 8.
2. Related work
Color reproduction on devices of limited color gamut have
been well studied in the context of gamut mapping [ML01,
GSS∗ 07]. However, gamut-mapping differs from our problem in three major aspects: Firstly, gamut mapping attempts to modify both luminance (lightness) and chrominance (chroma) to preserve color appearance. In our case,
the luminance modification (tone-curve) is given by the
tone mapping operator and we are allowed to modify only
chrominance. Secondly, gamut mapping considers mostly
mapping colors from one device to another of comparable
dynamic range. Therefore, the contrast compression used in
gamut mapping is much smaller than that applied for tone
mapping, which needs to compress the dynamic range found
in the real-world to the fraction of that range that is available on an output device. Finally, gamut mapping operates
on display-referred images, which have been already tonemapped by a camera, while tone mapping operates on scenereferred images.
Color appearance studies have revealed many factors that
influence our color perception. The apparent colorfulness
of uniform color patches has been found to vary with the
luminance (Hunt effect) [Hun52], image size [NB06] and
the color of the surround [BM97]. The apparent lightness or
brightness of heterochromatic patches depends on chromacity (Helmholtz&Kohlrausch effect) [Nay97] and apparent

hue depends on luminance (Abney effect) [ANK87]. Calabria and Fairchild [CF03] found that the perceived contrast
of complex images decreases with reduced chroma and the
relation is sigmoidal. The sigmoidal relation does not hold
for achromatic images, which are perceived to have higher
contrast than images at 20% chroma level.
Most of the work on color reproduction in tone mapping
is focused on preserving color appearance of the real-world
scene, as it is perceived by the human eye, on a computer
screen [PFFG98, PTYG00, FJ04, AR06,KJF07]. Pattanaik et
al. introduce a complex model of human color vision, incorporating separate pathways for rod and cone vision, opponent color processing, and gain control for both luminance
and contrast signals [PFFG98]. Later work [PTYG00] focuses on the aspects of temporal adaptation, uses the photoreceptor model instead of the luminance gain control, and
employs a simplified appearance model based on Hunt’s
model. The early iCAM color appearance model [FJ04]
achieves contrast compression by applying a spatially varying power function to the three color channels in the LMS
color space. The newer iCAM06 model [KJF07] replaces
the power function with the photoreceptor response model
and considers separately scotopic and photopic signals. It
also accounts for perceived contrast change with adapting luminance level due to the Stevens effect [SS63] and
with surround luminance due to the Bartleson-Breneman
effect [BB67], and compensates for increased colorfulness
with luminance due to the Hunt effect [Hun52]. While these
papers describe self-contained tone-mappers that address
color appearance issues, Akyüz and Reinhard [AR06] propose a color processing framework that could be adapted to
any tone mapping that preserves the ratios between color
channels. Their method transforms an HDR image using a
forward and then backward CIECAM’02 color appearance
model [MFH∗ 02], and then the resulting luminance map is
replaced with the result of a tone mapping operator.
The above tone mapping operators account for the color
differences that are the result of different luminance and
chromatic adaptation between a real-world scene and display
viewing conditions. However, none of these approaches considered the change in color appearance that is caused by the
tone mapping curve itself, which is the subject of our study.
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

R. Mantiuk, R. Mantiuk, A. Tomaszewska & W. Heidrich / Color correction for tone mapping

formula, which preserves luminance and involves only linear
interpolation between chromatic and corresponding achromatic colors:

90
120

60

150

Lightness (J)

80
45
10
s=0

180

0

s=1

210

Hue

80

150 Chroma
115
30

s=1.8

240

60

40

20

330

270

Cout =

s=1.6

s=0

0
0

300

s=1
50

100
Chroma (C)

150

90
120

60

80

150 Chroma
115
30

150

180

0

s=1

210

Lightness (J)

80
45
10
s=0

60

40

20

330

s=0

s=1

s=2

Hue

0
0

300

240
270

50

s=2

100
Chroma (C)

150

Figure 2: CIECAM02 prediction of hue, chroma and lightness for the non-linear (two plots at the top, Equation 2) and
luminance preserving (two plots at the bottom, Equation 3)
color correction formulas. The lines depict the change of
perceptual attributes for six basic colors (red, magenta, blue,
cyan, green and yellow) of different luminance when the
saturation factor s varies from 0 to 2. The initial points
(s = 1) are marked with black squares. The non-linear formula (Equation 2) strongly distorts lightness, but better preserves hues than the luminance preserving formula (Equation 3).

3. Color correction in tone mapping
The common approach to color treatment in tone mapping,
introduced by Schlick [Sch94], is preserving color ratios:
Cout =

Cin
Lout ,
Lin

(1)

where C denotes one of the color channels (red, green, or
blue), L is pixel luminance and in/out subscripts denote pixels before and after tone mapping. All values are given in linearized (not gamma-corrected) color space. Later papers on
tone mapping, employing stronger contrast compression, observed that the resulting images are over-saturated, as shown
in Figure 1B, and suggested an ad-hoc formula [TT99]:
Cout =

Cin
Lin

195

s

Lout ,

(2)

where s controls color saturation. The drawback of the above
equation is that it alters the resulting luminance for s=1 and
for colors different from gray, that is kR Rout + kG Gout +
kB Bout =Lout , where kR,G,B are the linear factors used to
compute luminance for a given color space. This formula
can alter the luminance by as much as factor of 3 for highly
color saturated pixels, which is an undesirable side effect.
Therefore, we introduce and examine in this paper another
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

Cin
− 1 s + 1 Lout .
Lin

(3)

The difference between the color correction formulas
from Equations 2 and 3 is best shown on the plots of hue,
chroma and lightness as predicted by the CIECAM02 color
appearance model, shown in Figure 2. The change in color
correction factor s for the non-linear formula from Equation 2 modifies not only chroma, but also the lightness of
the colors. The luminance preserving formula from Equation 3 can prevent such lightness shift, but leads to stronger
hue shift, especially for red and blue colors. Therefore the
choice of one formula over another may depend on whether
preserving hue or luminance is more important for a particular application.
Another approach to color treatment is to apply the same
tone-mapping curve to all three color channels. It can be
shown however that this is equivalent to Equation 2 if the
color correction factor s is equal to the contrast compression
factor c, and the tone curve has the form:
Lout = (Lin b)c ,

(4)

where b is the brightness (exposure) adjustment that normalizes for maximum display brightness (Lout = 1 for the peak
display luminance).
If the tone-curve is an arbitrary function, applying the
same tone-curve to all color channels is not equivalent to
Equation 2 under s = c, but the results are very close. In
case of local tone mapping operators, the three color channels usually cannot be modified simultaneously. Therefore,
those operators must rely on color transfer formulas, such as
Equation 2 or 3. The assumption that s = c, or altering the
three color channels simultaneously, works well for small
contrast compression, but leads to images with faded colors
for smaller c, as shown in Figure 1C.
The Equations 2 and 3 above offer a convenient way of
correcting colors in the RGB color space, but they require
manual adjustment of the parameter s. The main goal of
this work is to estimate the parameter s given a luminancespecific tone-curve.
The RGB color space used in this paper assumes the
sRGB color primaries and D65 white point. The RGB
trichromatic values are linear with respect to radiance (not
gamma-corrected). All results included in the paper and in
the supplementary materials are transformed to the sRGB
color space (γ = 2.2).
4. Experiment 1: color matching for tone mapping
We conducted a subjective study in order to investigate how
much color correction is required to compensate for the contrast compression.

196

R. Mantiuk, R. Mantiuk, A. Tomaszewska & W. Heidrich / Color correction for tone mapping

Figure 4: Tone mapping and color correction used in the
experiments.

levels 0.7 and 300 cd/m2 respectively). We used the native NEC 2690 settings for color primaries and white point,
which were close to the sRGB model. The display response
for red, green and blue color channels was carefully measured using the Minolta CS-100A colorimeter and then used
as a lookup table in the display model and inverse display
model. The experiment was conducted under dim illumination (60 lux).

Figure 3: HDR and LDR images used in the experiments.

4.1. Participants
The experiment was split into two parts to test both nonlinear (Equation 2) and luminance preserving (Equation 3)
color correction formulas. Eight participants (3 females and
5 males) finished the first part and ten (2 females and 8
males) the second part. Their age was between 23 and 38
years, with average of 32 years. They had normal or corrected to normal visual acuity. Six participants had basic expertise in imaging, and the remaining four were not experienced in computer graphics. None of them was aware of
the technical details of the experiment. All participants had
correct color vision and only three of them shared both parts.
4.2. Stimuli
We used 8 natural images in the experiment (shown in Figure 3). They encompass a broad range of color hues and saturations appearing in photographs presenting human faces,
close-ups, indoor and outdoor scenes. To test both sceneand output-referred images, 4 HDR and 4 LDR images were
used.
The images were displayed on a 26” LCD display (NEC
SpectraView 2690, with screen size 55x33.5 cm, resolution 1920x1200 pixels, minimum and maximum luminance

Figure 4 illustrates the image processing applied to LDR
and HDR images before showing them on the display. Image
contrast was modified using Equation 4 and contrast factor c
varied from 0.1 to 1.6. Color saturation factor s was adjusted
by a participant and colors were corrected using either Equation 2 or 3. Contrast compression and color correction were
performed in the linear domain after applying an inverse display model to the LDR images. The exposure of individual
HDR images was adjusted to the level that gave the best visualization of unmodified HDR images on the monitor.
Contrast compression and color correction cause a strong
luminance increase for small values of c and high values
of s, which leads to out-of-gamut colors and problems with
subjective comparison of colorfulness due to the hue shift
caused by color clipping. To avoid out-of-gamut colors we
decided to reduce the luminance of the input images to 33%
(100 cd/m2 ) of the peak luminance of the display, which
also makes the peak luminance closer to the typical settings
of an office display.
4.3. Experimental procedure
Figure 6 shows a screen-shot from the experiment. Participants were asked to adjust the overall colorfulness of the left
image to make it appear as close as possible to that of the
reference image but slightly and visibly lower. Likewise, the
right image should be adjusted to be perceived as slightly but
visibly more colorful. Then, the matching colorfulness is assumed to be the mean of both left and right target images.
As we verified in a pilot study, this method gives less interand intra-subject variations than direct color matching of images with the same number of comparisons. Differences in
colorfulness are difficult to discriminate and direct matching results a random point from the distribution with a large
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

197

R. Mantiuk, R. Mantiuk, A. Tomaszewska & W. Heidrich / Color correction for tone mapping

1.2

Saturation factor − s

Saturation factor − s

1.2

1

0.8

0.6

1

0.8

0.6

0.4

0.4

0.2

Averaged results

Averaged results

Best fit: Equation 5 (k1=1.6774, k2=0.9925,χ2=0.0316)

Best fit: Equation 5 (k1=2.3892, k2=0.8552,χ =0.0027)

k3

Approximation c
0.1

0.35

0.6

2

(k3=0.4681,χ =0.0489)

0.85 1
1.35
Contrast factor − c

1.6

2

0.2

k3

Approximation c
0.1

0.35

0.6

2

(k3=0.3611,χ =0.0260)

0.85 1
1.35
Contrast factor − c

1.6

Figure 5: Result of matching colors between image with altered contrast and an original image. Left: for non-linear color
correction, right: for luminance preserving correction. The solid lines show averaged results and the dotted lines indicate the
saturation factor for images 1 JND more and less saturated, and the continuous line is their mean. Error bars show the standard
error of mean. The red line shows the best fitting model.

for small contrast modification (slope<1) and much stronger
correction for strong contrast compression. The interpolated
line for the non-linear color correction formula (left plot) do
not cross the point s(1) = 1, which could be explained by the
measurement error and lack of data near that point.

Figure 6: Screenshot from the experiment. In the center is
the linearly mapped reference image. Left and right are two
tone mapped images adjusted by a participant. Background
color is set to neutral grey.

standard error. By measuring ±1 just noticeable difference
(JND) and taking the average, we obtain a point that is more
likely to lie close to the mean of the distribution.
For each color correction formula, participants matched
image colors in a total of 48 tests, one for each of the 8 images and 6 compression levels (c=0.1, 0.35, 0.6, 0.85, 1.35,
and 1.6). The whole experimental procedure took approximately 30 minutes for a single participant. Before actual
experiment, each participant conducted a short pilot experiment in which he/she was explained how to interpret the
"overall image colorfulness".
4.4. Results
Figure 5 shows averaged results for both color correction
formulas. The plots indicate moderate contrast correction
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

To check the statistical significance of other factors, we
conducted several Analysis of Variance (ANOVA) tests. We
found no statistical difference between LDR and HDR images (F(1, 863) = 0.1 for the test of 2 LDR/HDR × 6 contrast levels × 2 contrast correction formulas), which suggests that the relation holds for both output-referred and
scene-referred images. There is a significant effect of gender
(F(1, 863) = 12.13; p < 0.01 for 2 (gender) × 6 (contrast)
× 2 (formula) test), with females choosing slightly less saturated images. We found also an effect of expertise in imaging
(F(1, 863) = 9.53; p < 0.01 for 2 (expert) × 6 (contrast) ×
2 (formula) test), with those participants who work professionally with images selecting a slightly higher s factor.
The relation between c and s can be approximated with a
power function s(c) = ck3 , but the function is not plausible at
extrapolated values for c > 1.6 and the fit is poor (see plots
in Figure 5). Therefore, we use instead a sigmoid function:

s(c) =

(1 + k1 ) ck2
.
1 + k1 ck2

(5)

The function has been selected, so that it does not change
color saturation if contrast is left unchanged (s = 1 for c = 1)
and eliminates all color information when an image has no
contrast (s = 0 for c = 0). The parameters for the best leastsquare fit are shown on the plots.

198

R. Mantiuk, R. Mantiuk, A. Tomaszewska & W. Heidrich / Color correction for tone mapping
90
120

60

100

c=0

110 s

CIECAM02

80

30

60
35
10
0

c=0

J

180

330

210
c=1

h

300

CIECAM02 240

270

CIECAM02

85

150

60
40

c=0.5

20
0
0

c=1

20

40

60
sCIECAM02

80

c=2
100

Figure 7: CIECAM02 prediction (hue, saturation, lightness)
for color change due to contrast modification (c ∈ [0, 2]),
while color correction s =model prediction (solid lines, circles) or s = 1 (dotted lines). Plots for non-linear color correction formula. The notation is the same as in Figure 2.
The black squares indicate initial color coordinates (c = 1).
Corrected colors are not linearly related to any perceptual
attribute.

5. Color appearance models and color correction
The results of Experiment 1 demonstrated that the desirable
color saturation level is related to contrast compression in a
complex and non-linear way. Color appearance models attempt to predict non-linearities in the visual system and provide a set of perceptual attribute predictors, such as colorfulness, chroma and saturation, which should be linearly related to our color perception. In this section we test whether
an appearance model can explain the non-linear relation we
found in our experiment. We want to find which perceptual
attribute should be preserved after contrast compression to
achieve the best color match with an original image.
We choose six basic colors of different hue, saturation and
lightness, distort them by compressing contrast (c ∈ [0, 2])
with respect to a reference white, and process them with
both color correction formulas (Equations 2 and 3) using the
color correction factor s given by the models found in the experiment (Equation 5). The resulting colors are transformed
to the space of perceptual attribute predictors of hue, lightness, chroma, saturation and colorfulness, using of one of
the popular appearance models: CIELAB, CIELUV [Col86],
CIECAM02 [MFH∗ 02] and iCAM [FJ04].
From all perceptual attributes, the CIECAM02 saturation
was the most consistent across contrast variation and was
selected for the plot in Figure 7. The remaining plots can
be found in the supplementary materials. Even though the
CIECAM02 saturation was the most consistent, solid lines in
Figure 7 indicate a non-linear relation between CIECAM02
saturation and contrast compression. Therefore, preserving
CIECAM02 saturation or altering it according to a simple linear rule cannot correct colors when contrast is compressed. This shows that none of the perceptual attributes
in any of the considered appearance models can explain our
experimental data.

Figure 8: To correct colors in the CIELAB color space,
CIELAB chroma from the original image is corrected by
the factor sLAB and combined with the lightness L∗ from the
tone-mapped image.

6. Experiment 2: Color correction in CIELAB
In Section 3 we discussed the limitations of the simple color
correction formulas in the RGB color space, which either
preserve lightness but distort hue, or better, preserve hue but
distort lightness. Perhaps if colors are corrected in the space
of perceptual attributes, along the axis of chroma or colorfulness (along the radius on the hue/chroma plots in Figure 7),
the color correction will be simpler and the resulting images
will give a better match to the originals. We test this hypothesis in the following experiment.
Both CIELAB and CIELUV models can be easily adapted
to our color correction scheme. Luminance can be modified using a contrast altering formula (Equation 4) while
CIELAB or CIELUV chroma is preserved or modified along
the chroma axis. The framework for color correction in the
CIELAB color space is shown in Figure 8. A similar color
correction procedure cannot be found for CIECAM02. Because of the interactions between chrominance and luminance that are modeled in CIECAM02, there can be no chromatic coordinates that would result in exactly the same colorfulness and hue values after altering luminance. It is only
possible to find a least-squares approximation of the original
colorfulness, but this would be too expensive computationally for any practical application. Therefore, we restrict our
considerations to the CIELAB color space.
Experiment 2 has the same goal and procedure as Experiment 1, but this time we limit the number of participants to
4 and apply color correction in the CIELAB color space, as
shown in Figure 8. The results of the experiment are shown
in Figure 9. For small contrast modifications (0.6 < c < 1.6)
the color correction is almost unnecessary (sLAB ≈ 1). Therefore, preserving chroma in the CIELAB space for small contrast changes should produce desirable results. This is consistent with common practice in gamut mapping where color
operations are usually performed in the lightness / chroma
space. However, for strong contrast compression (c < 0.6)
colors need to be desaturated, similarly to the RGB color
correction formulas.
Figure 10 illustrates the sLAB color correction in the
CIECAM02 hue, saturation and lightness coordinates using
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

R. Mantiuk, R. Mantiuk, A. Tomaszewska & W. Heidrich / Color correction for tone mapping

199

1.2

Saturation factor − sLAB

1.1
1
0.9
0.8
0.7
0.6
0.5
CIELAB color correction
2
Best fit to Eq. 6, k1=38.7889, k2=1.5856, χ =0.0156

0.4
0.3

0.1

0.35

0.6

0.85
1
Contrast factor − c

1.35

1.6

Figure 9: Result of matching image colors using color correction in the CIELAB color space. The notation is the same
as for Figure 5.
90
120

60

100

150

0

180

0

90
Lightness (J)

60 Saturation
50
30
40
30
20
10

80

c=0.35
c=0.6

70

c=0.85

60
50

c=0.1
c=0.35
c=1

210

Hue

330

300

240
270

Figure 11: High dynamic range image before and after tonemapping [MDK08] while preserving CIELAB chroma. The
resulting colors strongly depend on the selection of the absolute white point for the CIELAB transformation.

c=0.1

c=1.35
c=1.6

40
30
20

30

40
Saturation

50

60

Figure 10: CIECAM02 prediction for color correction in the
CIELAB space (Figure 8). a∗ and b∗ components were modified based on sLAB from Figure 9. The notation is the same
as in Figure 7, except that the dotted lines in the right plot
show color change for c = 1 and sLAB ∈ [0, 2] (same characteristic as shown in Figure 2).

the same notation as the plots in Figure 7 for the RGB color
correction formulas. The color correction in CIELAB better preserves hue and lightness (compare dotted lines in Figure 10 with Figure 2). The trend is similar to that in Figure 7.
This confirms the observation that although saturation is the
attribute that requires the least correction after contrast modification, it cannot explain stronger desaturation for contrast
compression c < 0.6.
7. Are color appearance models suitable for tone
mapping?
The results of Experiment 2 suggest that the CIELAB
chroma predictor can better preserve the color appearance
after contrast modification, and therefore seems to be an
attractive alternative to color correction in the RGB color
space (Equations 2 and 3). The CIELAB color space as well
as CIECAM02 or CIELUV, however, cannot be easily used
for high dynamic range scenes. The major difficulty is accurate estimation of the reference white color, both in terms of
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

chrominance and absolute luminance. Figure 11 shows that
different selection of a reference white leads to completely
different colors in tone mapped images. In the top row we
assumed the reference white appropriate for the background
and in the bottom row we assumed the reference white appropriate for the foreground. Automatic estimation of a reference white on the pixel level is a difficult problem, and
although some methods exist [KMS05], they may lead to
unreliable estimation. At the same time, CIELAB predictions completely fail if a reference white is poorly estimated.
Therefore, a fully automatic color correction in the CIELAB
color space is currently a viable alternative only for low dynamic range scenes.
Another important observation is that the goal of most appearance models is different than the goal of our experiment
and of most tone mapping operators. Appearance models
try to predict perceived colors accounting for all limitations
of the visual system, such as poor color vision under low
light. In our study and in most tone mapping operators, the
goal is to preserve photographic colors, which are the colors that could be expected under optimal camera exposure
settings. Those photographic colors do not turn pale under
low light and are closer to the memory colors of a particular
object [BT02].

8. Application in tone mapping
In this section we demonstrate how the relation between contrast compression and desired color correction, which we

200

R. Mantiuk, R. Mantiuk, A. Tomaszewska & W. Heidrich / Color correction for tone mapping

Figure 12: Result of four color correction methods for contrast compression (top) and enhancement (bottom).

found in the subjective study, can be used to extend global
and local tone mapping operators.
Probably the most common tone operation is contrast
compression and enhancement using a power function
(Equation 4). Figure 12 shows an example from a large test
set we used for validation (the full test set can be found in the
supplementary materials). The figure contains images after
contrast compression and enhancement, whose colors were
corrected using both color correction formulas (Equations 2
and 3), and the color correction factor was either assumed
to be equal to the contrast compression factor (s = c) or was
computed from our experimental models (Equation 5). The
assumption s = c produces satisfactory results for many images. However, this example shows over-saturated images
for contrast enhancement and images that are too washedout for contrast compression. The contrast-compressed images that were color corrected with the model (1st row, 2nd
and 4th column) may look slightly unnatural due to strong
saturation, but the goal of our color correction is the best
match to the reference rather than the most natural look or
the preference. Another important observation is that the luminance preserving formula (right side) often results in a hue
shift for red colors, as discussed in Section 3 and shown in
Figure 7.
The tone mapping based on the bilateral filtering [DD02]
can be easily extended to include the proposed color correction formulas. The operator uniformly reduces the contrast
of the base layer (low pass + edges) while preserving details (high frequencies). The amount of compression in the
logarithmic domain is equivalent to the contrast compression factor c. The original algorithm does not perform any
desaturation and employs Equation 1. This produces good
results when the operator is run with the default parameters
but results in over-saturated colors for strong contrast compression, as shown in Figure 13. We employ the non-linear
color correction formula (Equation 2) with the experimental
model (Equation 5) to fix the over-saturated colors.
The color correction formulas proposed in this paper can

be applied not only to the simplified operator (Equation 4)
with a known contrast compression factor c, but to any tone
mapping function. The contrast factor can be approximated
by the slope of the tone curve on the log − log plot, which is
given by the derivative of the tone-curve in the logarithmic
space. Denoting L = log10 (L), c is given by:
Lout := tmo(Lin )
c(Lin ) = d tmo(Lin )

(6)

dL

A similar approach was used in [PTYG00] to relate the saturation factor s to the local contrast compression. The function c(Lin ) gives us an estimate of contrast compression for
each tone level, which we can use in combination with any cs relation model (Equation 5) and with any color correction
formula (e.g. Equations 2 and 3).
We modify the display adaptive tone mapping operator
[MDK08] to include our color correction formula (Equation 5). The original algorithm employs Equation 2 to compensate for color difference, in which the parameter s has to
be manually adjusted. The first column of Figure 14 shows
that for the same color correction factor (s = 0.3) color correction need to be readjusted when tone mapping for displays of different dynamic range. The proposed color correction model can compensate for these differences and automatically readjust color correction factor s.
Full size results for over 40 LDR and HDR images can be
found in the supplementary materials.
9. Discussion
The considerations of this paper seem to be limited only to
global tone mapping operators, which affect only low frequencies. We conducted a pilot study in which we investigated the effect of a local operation, unsharp masking, on
the colorfulness of images. Figure 15 shows an image that
has enhanced (left) or reduced (right) details (top) and global
contrast (bottom). The image clearly indicates that sharpening has little effect on perceived image colorfulness. Since
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

R. Mantiuk, R. Mantiuk, A. Tomaszewska & W. Heidrich / Color correction for tone mapping

201

Figure 13: The result of the “bilateral” tone mapping [DD02] with strong contrast compression, original algorithm compared
to the algorithm with color correction.

Figure 14: The result of the “display adaptive” tone mapping [MDK08] for a display of reduced, typical and extended dynamic
range (from top to bottom row). The original algorithm with a constant color correction factor (s = 0.3 and s = 1) is compared
to result of the proposed color correction. The yellow color that can be seen in the reference image (top row) is an artifact of
color clipping and is not visible when clipped colors are masked (center row) or exposure is reduced (bottom row).

sharpening is often the main component of local tone mapping operators, our color correction method is also valid for
those operators.
To better isolate the effect of contrast compression on
image colorfulness, all the experiments were designed to
minimize clipping of colors that exceeded the display color
gamut. We did not use the full dynamic range of the display to reserve margins for highly saturated colors and we
did not consider very strong contrast enhancement. We also
allowed for colors that would not be available on an sRGB
display with a peak luminance of 100 cd/m2 . We conducted
a pilot study in which we did not observe any difference
in measurement if we clipped colors to the limited sRGB
color gamut or if we used all the available gamut of our display. Further studies, however, should investigate the effect
of color clipping on the necessary contrast correction, especially for large contrast enhancements.
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

10. Conclusions and Future Work
Tone mapping inevitably results in an image distortion
which affects both tone and color reproduction. In this work
we analyze how such color distortions can be reduced.
The main contributions of this paper are two models predicting desirable color correction given contrast distortion
due to tone mapping. The models are used with simple
and computationally inexpensive color correction formulas,
which are applicable for global tone mapping operators and
give good practical results for local operators. We found
that the non-linear color correction formula strongly distorts
lightness but introduces less hue distortion than the luminance preserving formula, and is therefore more suitable for
tone mapping. We experimented with color appearance models, which can potentially produce less hue and chroma distortions, but are less suitable for high dynamic range images

202

R. Mantiuk, R. Mantiuk, A. Tomaszewska & W. Heidrich / Color correction for tone mapping
[CF03] C ALABRIA A., FAIRCHILD M.: Perceived image contrast
and observer preference: I. the effects of lightness, chroma, and
sharpness manipulations on contrast perception. The Journal of
Imaging Science and Technology 47, 6 (2003), 479–493.
[Col86] C OLORIMETRY C.: CIE Publication No. 15.2. Commission Internationale de I’éclairage, Vienna (1986), 19–20.
[DD02] D URAND F., D ORSEY J.: Fast bilateral filtering for the
display of high-dynamic-range images. ACM Trans. on Graph.
21, 3 (2002), 257–266.
[FdB97] F EDOROVSKAYA E., DE R IDDER H., B LOMMAERT F.:
Chroma variations and perceived quality of color images of natural scenes. Color Res. and Application 22, 2 (1997), 96–110.

Figure 15: Enhancement (left) and compression (right) of
details (high frequencies) has little effect on colorfulness
(top row) as compared to global contrast modification (bottom row).

[FJ04] FAIRCHILD M., J OHNSON G.: The iCAM framework for
image appearance, image differences, and image quality. Journal
of Electronic Imaging 13, 1 (2004), 126–138.
[GSS∗ 07] G IESEN J., S CHUBERTH E., S IMON K., Z OLLIKER
P., Z WEIFEL O.: Image-Dependent Gamut Mapping as Optimization Problem. Image Processing, IEEE Transactions on 16,
10 (2007), 2401–2410.
[Hun52] H UNT R.: Light and dark adaptation and the perception
of color. J. Opt. Soc. Am. 42, 3 (1952), 190–199.

because of problems with reference white estimates and different rendering intents.
Our results suggest that the image colorfulness is affected
by overall image contrast, defined as a slope of a tone-curve
on the log-log plot (gamma) and is not influenced by sharpenning. Such overall contrast, however, is difficult to define
for local tone-mapping operators that introduce strong discontinuities on the tone curve. Further studies are needed to
isolate a set of factors that influence colorfulness after local
tone-mapping operations.
Acknowledgments
We would like to thank Karol Myszkowski, Allan Rempel,
Ivo Ihrke and anonymous reviewers for their valuable suggestions. Images used in the experiment are the courtesy
of Paul Debevec, Dani Lischinski, Grzegorz Krawczyk, Industrial Light and Magick, PhotoDisc Inc. and Flickr community. The research work, which results are presented in
this paper, was sponsored by Polish Ministry of Science and
Higher Education (years 2007-2008).
References
[ANK87] AYAMA M., NAKATSUE T., K AISER P.: Constant hue
loci of unique and binary balanced hues at 10, 100, and 1000 td.
J. Opt. Soc. Am. 4 (1987), 1136–1144.
[AR06] A KYÜZ A., R EINHARD E.: Color appearance in highdynamic-range imaging. Journal of Electronic Imaging 15
(2006), 033001.
[BB67] BARTLESON C., B RENEMAN E.: Brightness perception
in complex fields. J. Opt. Soc. Am. 57 (1967), 953–957.
[BM97] B ROWN R., M AC L EOD D.: Color appearance depends
on the variance of surround colors. Current Biology 7, 11 (1997),
844–853.
[BT02] B ODROGI P., TARCZALI T.: Investigation of colour
memory. In Colour Image Science, MacDonald L., Luo M. R.,
(Eds.). John Wiley & Sons, 2002, ch. 2, pp. 23–48.

[KJF07] K UANG J., J OHNSON G., FAIRCHILD M.: iCAM06:
A refined image appearance model for HDR image rendering.
Journal of Visual Communication and Image Representation 18,
5 (2007), 406–414.
[KMS05] K RAWCZYK G., M YSZKOWSKI K., S EIDEL H.-P.:
Lightness perception in tone reproduction for high dynamic
range images. Comp. Graph. Forum 24, 3 (2005), 635–645.
[MDK08] M ANTIUK R., DALY S., K EROFSKY L.: Display
adaptive tone mapping. ACM Trans. Graph. 27, 3 (2008).
[MFH∗ 02] M ORONEY N., FAIRCHILD M., H UNT R., L I C.,
L UO M., N EWMAN T.: The CIECAM02 color appearance
model. In Proc. IS&T/SID 10th Color Imaging Conference
(2002), pp. 23–27.
[ML01] M OROVIC J., L UO M.: The fundamentals of gamut mapping: A survey. Journal of Imaging Science and Technology 45,
3 (2001), 283–290.
[Nay97] NAYATANI Y.: Simple estimation methods for the
Helmholtz&Kohlrausch effect. Color Research and Application
22 (1997), 385–401.
[NB06] N EZAMABADI M., B ERNS R.: The effect of image size
on the color appearance of image reproductions using colorimetrically calibrated lcd and dlp displays. Journal of the Society for
Information Display 14 (2006), 773–783.
[PFFG98] PATTANAIK S. N., F ERWERDA J. A., FAIRCHILD
M. D., G REENBERG D. P.: A multiscale model of adaptation
and spatial vision for realistic image display. In Proc. of SIGGRAPH’98 (1998), pp. 287–298.
[PTYG00] PATTANAIK S., T UMBLIN J., Y EE H., G REENBERG
D.: Time-dependent visual adaptation for realistic image display.
In Proc. of SIGGRAPH’00 (2000), pp. 47–54.
[Sch94] S CHLICK C.: Quantization techniques for the visualization of high dynamic range pictures. In Photorealistic Rendering
Techniques (1994), Eurographics, Springer-Verlag Berlin Heidelberg New York, pp. 7–20.
[SS63] S TEVENS J., S TEVENS S.: Brightness function: Effects
of adaptation. J. Opt. Soc. Am. 53 (1963), 375–385.
[TT99] T UMBLIN J., T URK G.: LCIS: A boundary hierarchy
for detail-preserving contrast reduction. In Siggraph 1999, Computer Graphics Proceedings (1999), pp. 83–90.

c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.


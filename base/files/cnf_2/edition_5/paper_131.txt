DOI: 10.1111/j.1467-8659.2011.01984.x
Eurographics Symposium on Rendering 2011
Ravi Ramamoorthi and Erik Reinhard
(Guest Editors)

Volume 30 (2011), Number 4

Anaglyph Stereo Without Ghosting
H. Sanftmann and D. Weiskopf
VISUS, Universität Stuttgart, Germany

Abstract
Anaglyph stereo provides a low-budget solution to viewing stereoscopic images. However, it may suffer from
ghosting and bad color reproduction. Here we address the first issue. We present a novel technique to perceptually
calibrate an anaglyph stereoscopic system and to use the calibration to eliminate ghosting from the anaglyph
image. We build a model based on luminance perception by the left and right eyes through the anaglyph glasses.
We do not rely on power spectra of a monitor or on transmission spectra of anaglyph glasses, but show how the
five parameters of our model can be captured with just a few measurements within a minute. We present how full
color, half color, and gray anaglyphs can be rendered with our technique and compare them to the traditional
method.
Categories and Subject Descriptors (according to ACM CCS): I.3.7 [Computer Graphics]: Color, shading, shadowing, and texture—

1. Introduction
There are several ways to use stereoscopy to provide 3D
depth perception for images, videos, or computer graphics: side-by-side viewing, anaglyphs, shutter glasses, polarized light, Infitec glasses, and autostereoscopic displays.
Anaglyphs use colored filters to separate the left and the
right image. Nowadays red-cyan glasses are most common,
which can be purchased for just a few cents.
However, anaglyph stereo suffers from ghosting, limited
color reproduction, and retinal rivalry. Ghosting results from
crosstalk, which refers to the fact that a color channel of the
image that should be filtered out for an eye passes the filter partially. Crosstalk comes from the imperfection of the
anaglyph filters and the display device and cannot be eliminated by an algorithm. However, we present a technique to
reduce ghosting substantially, so that it becomes negligible.
We want the luminance of images perceived through the
glasses to correspond to the value perceived without the
other image. We do not want to rely on emission spectra of
displays or on transmission spectra of filters, since these can
seldom be obtained without measurements, neither do we
rely on a properly calibrated monitor. Instead we target lowcost environments and, therefore, will acquire the relevant
data through simple and easy-to-use perceptual measurements that come at no extra cost. First we will present how
to measure perceived luminance through anaglyph glasses.
© 2011 The Author(s)
Computer Graphics Forum © 2011 The Eurographics Association and Blackwell Publishing Ltd. Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ,
UK and 350 Main Street, Malden, MA 02148, USA.

Next we will show how to use the measurements to compensate for crosstalk and eliminate the aspect of ghosting caused
by luminance. Our technique can render anaglyphs, similar
to the anaglyphs known as full color (Photoshop algorithm),
half color (modified Photoshop method), and grayscale, but
with removed ghosting artifacts.
After the discussion of related work, we will present our
model and show how to derive the parameters by just a few
measurements. In Section 4, we will show how ghosting can
be corrected given the model parameters. Section 5 generalizes our model to arbitrary filter colors. Section 6 illustrates the results of the correction process using two idealized models for the sources of crosstalk. In Section 7, we analyze a combination of monitor and glasses based on transmission and emission spectra and compare the result to the
idealized models. Section 8 describes how luminance ghosting can be eliminated even for high contrast input images.
2. Related Work
Dubois [Dub01] considers the spectral distribution of the
display colors and the transmission of the filters to calculate
anaglyphs based on minimizing projection error between the
original stereo pair and the anaglyph seen. This is closely
related to our method; however, we do not need the spectral distributions and the transmission curves but derive our
anaglyphs based on few measurements capturing the rel-

1252

H. Sanftmann & D. Weiskopf / Anaglyph Stereo Without Ghosting

evant interrelations. Dubois uses a weighted square error
in CIE XYZ space, which is not perceptually uniform. A
perceptually uniform space would be more appropriate, but
these spaces are non-linear. Hence, a non-linear transformation would be required since a simple linear transformation
cannot capture the non-linearity. In contrast to this approach,
we focus on luminance, which is most important to perception of high special frequencies [Mul85]. Additionally, our
method does not try to minimize the error between the original stereo image and the final anaglyph but the error between the stereo image seen through the filter and the final
anaglyph.
Sanders and McAllister [SM03] compare three stereo
generation approaches: the Photoshop algorithm, the algorithm proposed by Dubois [Dub01], and the midpoint algorithm operating in CIE L*a*b* space. They put a threshold
on the value of the red channel of the anaglyph and claim
that an algorithm that produces a red channel value above the
threshold will cause ghosting. This is a heuristic approach
that has little validity without considering the colors in the
two images.
Ideses and Yaroslavsky [IY05] point out that anaglyphs
are one of the most economical methods for stereoscopic
presentation and propose several methods to reduce ghosting in anaglyph stereo images. These rely on stereo image
registration, defocusing, and a non-linear operation on depth
maps. Ghosting can be eliminated by registering the images
and bringing them to alignment. Since accommodation is related to convergence [OUW∗ 06,Uka06], aligning the images
is beneficial. However, only one depth plane can be aligned
at once, which limits the utility of this technique. Ideses and
Yaroslavsky [IY05] also show how blurring the image color
components can reduce ghosting effects in anaglyphs. Lobel [Lob09] carries this to extremes by presenting magentacyan anaglyphs, for which both eyes receive the blue channel
that is blurred to reduce ghosting. However, Lobel reports
ghosting as a limitation of his approach; our technique could
be used to solve this issue.
Some methods rely on explicit knowledge of the spectral distributions of the display device and the transmission functions of the filters, which is not required for our
method. Such a technique was introduced by McAllister
et al. [MZS10] and compared to different other techniques.
Similarly, Sorensen et al. [SHS04] designed a special amberblue filter pair, known as ColorCode 3-D, with the goal to
separate the color information and the depth information to
the two eyes.
Woods et al. [WYK07] discuss crosstalk in anaglyph
stereoscopic images and also explain crosstalk, the
source of ghosting [WT02], for different stereoscopic displays [Woo10]. According to Woods et al., three factors
play an important role when looking at crosstalk in anaglyph
stereo: the spectral quality of the display, the spectral quality of the glasses, and the quality of the anaglyph image

generation matrix. Woods and Harris [WH10] compare the
crosstalk of different anaglyph glasses on different displays
and recommend good matches for a given monitor to minimize crosstalk. Using the “right” anaglyphs for a given monitor is much less important with our technique. If it happens
that you have the “right” glasses for your monitor, you will
simply not notice any difference using our technique, since
there is no need to compensate for non-existent ghosting.
However, if you wear the “wrong” glasses, our technique
can significantly reduce ghosting. Bloos [Blo08] designed
a test pattern for ghosting determination. In contrast to our
calibration method, he uses a static image to determine two
measurement values for both eyes; these, in contrast to our
method, do not serve a calibration purpose but are a quality
measure to enable the comparison of two stereo renderings.
There are several software applications for the generation of anaglyph stereo images. One typical example is
StereoPhoto Maker [SS10], which allows the user to generate anaglyphs for different filters using a variety of algorithms and also by providing a custom matrix.
3. Determining Filter Parameters
We use tuples instead of column vectors throughout the paper:
 
a
(a, b, c) = b
c
3.1. Model
With our model we want to determine how we can account the different color channels for the received luminance
through a filter of some anaglyph glasses. With such a model
we want to answer questions of the following kind: how
much of the luminance coming from the green channel is
leaking through the red filter?
First, let us consider the following model:
γ

γ

γ

al xlr + bl xlg + (1 − al − bl )xlb = Y

(1)

Here, we denoted xlr xlg xlb as the non-linear RGB values,
ranging from 0 to 1, Y is the (normalized) luminance and
al , bl , and γ are our model parameters. If we could obtain
measurements of Y for varying RGB values, we could fit our
model by least squares fitting on Y and obtain our model
parameters. Unfortunately, we cannot measure luminance
without additional hardware. However, we can modify our
model instead:
γ

γ

γ

al xlr + bl xlg + (1 − al − bl )xlb = yγ
Here y denotes a gray value (red, green, and blue have identical values); therefore, we can obtain our model parameters
without requiring any additional hardware. So far, the model
is designed for the luminance arriving at one eye. We could
© 2011 The Author(s)
© 2011 The Eurographics Association and Blackwell Publishing Ltd.

1253

H. Sanftmann & D. Weiskopf / Anaglyph Stereo Without Ghosting

build an identical model for the other eye’s filter. However,
since γ is identical for the two eyes, we can also combine
them into one model:
γ

γ

γ

(al xlr + bl xlg + (1 − al − bl )xlb +
=y

The (leading) subscripts l and r refer to quantities related
to the left and right eyes, respectively. When measuring for
the left eye, we set xrr = xrg = xrb = 0, resulting in Eq. (1)
for the single-eye model. When measuring for the right eye,
we set the left eye’s values to zero. y is always used for the
measured gray value.

.b

γ
γ
γ
ar xrr + br xrg + (1 − ar − br )xrb )1/γ

.1

.
To calculate the luminance parameters we conducted measurements on the left and right eyes while wearing the
anaglyph glasses. The user had to adjust the luminance of
red, green, blue, cyan, magenta, and yellow to match a gray
value by face-based luminance matching [KRC02]. We performed this process not just for one but for 20 gray values,
resulting in 120 measurement points for each eye.

.b

3.2. Measurement Process

3.3. Model Evaluation
The sRGB standard uses a slightly different model for
gamma than we. The sRGB color system uses a piecewise
function with a linear and a power function part. However,
since modern LCD monitors often have a gamma substantially different from the one in sRGB, our model allows
us to fit measurements better. Figure 1 shows the differences between the measured data values and our fitted model
for the red-cyan glasses (the model parameters will be presented in Section 6.2). The estimated population variance
is 0.00660=1.68/255. This low variance indicates that our
model is valid. We tested the model with different persons,
even with one red-green blind person; each of them had very
similar calibration results. We also tested it with different
LCD monitors and a CRT monitor and obtained low variances.
3.4. Reduced Calibration
Since it is time-consuming to take 240 samples, we have reduced the number of samples to 3 for each eye for practical calibration purposes. We have developed the following
heuristics for good sample positions. Since we adjust the intensity of colors to match that of a gray sample, we should
choose colors that are far away from the main diagonal of
the color cube, where the gray colors are. At the same time,
we should choose colors that are far away from each other.
Therefore, pure red, green, and blue are good sample positions for both eyes.
Having few sample positions is more likely to cause problems with the fitting algorithm, which requires the first-order
© 2011 The Author(s)
© 2011 The Eurographics Association and Blackwell Publishing Ltd.

.

.
.
.
.
.
.
.
.
.

0. .8
0. .6
.
.0.4
.0.2
.1
.0.8
.0 .
.0.6
0. .0.1
.0.4
.0.2 .0.3 .0.4
.g
0
.
.5
.
.0.2
.0.6 .0.7 .0.8
.0.9 .1 .0
r.
.
.
.
.
.
1.
b. lue
.
.
0. .8
. agenta
m
.
.0.6
..
c. yan
.0.4
g. ray=0.25
0. .2
.1
r.ed
.
y. ellow
0. .8
0.
0. .6
0. 0. .1
.0.4
.0.2 .0.3 0. .4
g.
.
0
.5
.
0. .6 0. .7
.0.8 0. .9 1. 0. 0. .2
r.

.
. 4/255
−
.
. 3/255
−
.
. 2/255
−
.
. 1/255
−
.
0. /255
.
1. /255
.
2. /255
.
3. /255
.
4. /255

.
. 4/255
−
.
. 3/255
−
.
. 2/255
−
.
. 1/255
−
.
0. /255
.
1. /255
.
2. /255
.
3. /255
.
4. /255

Figure 1: Difference between model and measured values
for the left (red) and right (cyan) eyes, in the top and bottom
image, respectively. The axes are scaled between 0 and 1.
The bottom image additionally illustrates the color values
whose luminance is perceived equal to gray=0.25.

derivatives of the model function with respect to the model
parameters. These derivatives have terms xβ with fractional
β (γ and 1/γ ) and—due to inaccuracies—negative x. Such
functions cannot be evaluated since xβ is undefined, causing
the fitting algorithm to stuck. Our solution is to extend the
function C1 continuously at 0 to negative values by a linear
function.
4. Correction of Ghosting
The main idea behind our ghosting correction technique is
that we want the anaglyph image to be identically perceived
through the glasses as if the display showed the original images.
If we had ideal red-cyan glasses together with a corresponding display device, the red filter would entirely filter
out the green and blue components for the left eye and the
cyan filter would entirely filter out the red component for
the right eye and we could fulfill our desiderata by just tak-

1254

H. Sanftmann & D. Weiskopf / Anaglyph Stereo Without Ghosting

.

.No ghosting anaglyph

.c = 0.3

.Cl
.Cr

.P

.(Yl ,Yr , c)

.R

.C

.

.g

.
.

.(al , bl , ar , br , γ )
Figure 2: First the luminance values for the input images
(Yl and Yr ) and a chromaticity value (c) are calculated by
the transformation P . Next an output color is calculated that
has the desired luminance values and the desired chromaticity value by the transformation R.

.

Since neither anaglyph filters nor displays are ideal, there
always is some leakage from the one image to the other one,
which may cause ghosting. The color difference between the
desired and the perceived image can be described by the luminance and the chromaticity difference. Luminance differences result in much more distracting ghosting than chromaticity differences. Therefore, our main goal is to eliminate luminance differences. We have three degrees of freedom when rendering the anaglyph image, two of them are
fixed due to luminance. Thus, we have one remaining degree of freedom that we use to minimize the most significant
chromaticity difference.
4.1. Anaglyphs Without Ghosting
In this subsection, we present our color anaglyph generation
technique that does not produce luminance ghosting. Each
pixel is processed independently. We take as input RGB colors for the left (R′l , G′l , B′l ) and right (R′r , G′r , B′r ) eyes and
produce an RGB anaglyph color (R′ , G′ , B′ ) that does not
exhibit luminance ghosting.
First we transform the non-linear R′ G′ B′ colors to linear
RGB space by using the γ value measured:
C = C ′γ
where
C ∈ {Rl , Gl , Bl , Rr , Gr , Br }
{R′l , G′l , B′l , R′r , G′r , B′r }.

and

C′

∈

For both eyes, we reproduce luminance exactly. Additionally, one chromaticity channel is reproduced for one eye.
Figure 2 shows how the general approach can be described
by two transformations P and R; in this section, we will
derive R.
Luminance can be calculated, using the calibrated values
that exactly capture the luminance through the three color
channels, by:
YEYE ((R, G, B)) = aEYE R + bEYE G + cEYE B

.

.blueish

.

.
Y
. r = 0.5

.greenish
.
.b
.

ing the red component from the left eye image and the green
and blue components from the right eye image.

.

.

.

.

Y
. l = 0.5

.

.r

Figure 3: Points in linear RGB space, where luminance for
the left eye (Yl )=0.5 and luminance for the right eye (Yr )=0.5
and chroma (c)=0.3 lie on planes. The plane normals are
the row entries of R− . The figure illustrates the red-cyan
glasses that are measured in Section 6.2.

where cEYE = 1 − aEYE − bEYE .
Some of the following considerations are specific to redcyan filter pairs, the obtained solution is generalized for
arbitrary filters in Section 5. Using red-cyan glasses, the
most prominent chromaticity channel we can perceive is the
green-blue channel seen through the cyan glass on the right
eye. We therefore set c = G − B. Hereby, we obtain the linear transform that maps a color vector to a (luminance left,
luminance right, chromaticity) vector (YYc space) by:


zr zg zb
−
R = yr yg yb 
0 1 −1
where yr = ar , yg = br , yb = 1 − ar − br , zr = al , zg = bl ,
and zb = 1 − al − bl . Thus we can take the inverse of R− ,
which is R, to calculate no ghosting anaglyphs.


y + yb −zg − zb yg zb − yb zg
1  g
−yr
zr
yb zr − yr zb 
R=
zr − yr
−yr
zr
yr zg − yg zr
The transformation from YYc space to RGB space is illustrated in Figure 3. In the following, we will present full color,
half color, and gray variants that only differ in P but have
the same R.
4.2. Full Color Anaglyphs
In the same manner as R− maps a color to YYc space, P
needs to map two colors to YYc space. Yl has to be calculated using the color of the left, Yr and c using the color of the
right images. The transformation that maps the input colors
for the images can be described by a linear transformation.
© 2011 The Author(s)
© 2011 The Eurographics Association and Blackwell Publishing Ltd.

1255

H. Sanftmann & D. Weiskopf / Anaglyph Stereo Without Ghosting

As input, we take the vector (Rl , Gl , Bl , Rr , Gr , Br ). Hence P
can be represented by the following 3 × 6 matrix:


z r zg zb 0 0
0
P =  0 0 0 yr yg yb 
0 0 0 0 1 −1
4.2.1. Nice Properties
Our full color anaglyphs have some nice properties. First,
in case the input for the left and right eyes is identical
(Cl = Cr ), the anaglyph will just reproduce the input color.
Second, the luminance for both eyes is preserved. The last
property we describe for red-cyan glasses: in case the green
and blue components are identical in the input image for the
right eye (cyan filter), they will be identical in the anaglyph
image. From these properties, we could derive some equations and obtain the same overall transformation (RP ) like
we presented above. However, the introduction of the YYc
space helps us to obtain an intuitive understanding of our
transformation, which also holds for the half color and gray
anaglyphs presented below.
4.3. Half Color Anaglyphs
Full color anaglyphs cause binocular rivalry (aka retinal rivalry) for some people. Half color anaglyphs are designed to
reduce binocular rivalry by taking the gray value instead of
the red component of the left image as red component for the
anaglyph image. Considering our technique, we can replace
the individual luminance calculation for the left and right images by a calculation that treats the left and right image channels identically. A reasonable calculation can be based on the
luminance from the RGB calculation of the sRGB model,
given by Y ((R, G, B)) = sRGBY (R, G, B) with the row
vector [xr , xg , xb ] = sRGBY ≈ [0.2126, 0.7152, 0.0722].
Hence P can be represented by:


xr xg xb 0 0
0
0 xr xg xb 
P = 0 0
0 0
0 0 1 −1
4.4. Gray Anaglyphs
For gray anaglyphs, the green and blue components need to
be identical, which is the case when c is zero. Hence P is
given by:


xr xg xb 0 0 0
P =  0 0 0 xr xg xb 
0 0 0 0 0 0
4.5. Removing Ghosting from Anaglyphs Generated by
Naïve Methods
Now we will provide a method to correct ghosting in
anaglyph images generated by naïve methods, see Figure 4.
The naïve methods use the red component (full color) or the
© 2011 The Author(s)
© 2011 The Eurographics Association and Blackwell Publishing Ltd.

. ′ G′ B′LEFT
R
. ′ G′ B′RIGHT
R
.

.naÏve
.ghosting
.correc.tion

.Rl /Y (Cl ) R
. ′ G ′ B′
.Gr
.Br

. ′ G ′ B′
R

.(al , bl , ar , br , γ )
Figure 4: First the images for the left and right eyes are
composed by the naïve approach to an anaglyph stereo image, by selecting the red channel or the luma of the left and
the green and blue channels of the right image. We take the
naïve anaglyph image and eliminate ghosting by using the
filter values obtained in Section 3.

luma (half color and gray) of the left image and the green
and blue components (full and half color) of the right image,
which are assigned to the red, green, and blue components
of the anaglyph image. The green and blue components are
replaced by the luma of the right image in the gray anaglyph
case. We interpret the red component of the anaglyph image
as luminance of the left image, since this is the only information we have from the left image; therefore, it is the best estimation of luminance available. To estimate the luminance
of the right image we use the green and blue components
weighted by the filter values, which need to be normalized to
account for the unknown red component. Hence P is given
by:


1
0
0
yg
y
b

P = 0 y +y
y +y
g

0

b

1

g

−1

b

5. Filter Color Estimation
Our technique is not limited to red-cyan glasses. The only
thing we need to fix is which chromaticity channel we want
to preserve. This is the green-blue channel of the right eye
in the red-cyan case. In the general case, we will make the
decision based on the filters.
The vector (aEYE , bEYE , 1 − (aEYE + bEYE )) actually is
the luminance from the red, green, and blue color channels, respectively, as perceived through the filters. From the
sRGB model, we can take the linear RGB to luminance
transformation Y ((R, G, B)) = sRGBY (R, G, B). Since we
have a filter between the display and our eyes, not all of
the luminance arrives: (aEYE , bEYE , 1 − (aEYE + bEYE )) =
fEYE fEYE ◦ [0.2126, 0.7152, 0.0722]T , where ◦ denotes the
entry-wise vector product and fEYE is used to normalize
fEYE in the way that the largest component is 1. Given this
relationship, we can calculate the filter values fEYE .
Anaglyph filters are designed in a way that one from the
filter pair filters out all but one color channel (this is the
red filter for the red-cyan filter pair, which filters out all but
the red channel); we choose to preserve the other two color

1256

H. Sanftmann & D. Weiskopf / Anaglyph Stereo Without Ghosting

channels of the other eye. Algorithmically, we make the decision which eye we choose based on the second largest filter component. We do not need to derive new equations but
simply interchange the input channels when we calculate the
correction matrix.

did not consider the chromaticity perceived (i.e., as which
color this luminance is perceived). Given the filter values, we
can estimate the color of an image seen through the glasses.
However, without having further measurement data capturing color perception, not just luminance, we need to make
some assumptions.

6. Results

When we assume that the filter only affects the luminance
but not the color hue and saturation, we obtain the images
shown in the left columns of Figure 5, which are calculated by simply multiplying the RGB values with the filter transmission values. This behavior would be obtained by
monochromatic primaries.

We developed an application using C++, OpenGL, and
Qt, which is included in the supplementary material and
for which we provide updates on our website www.vis.
uni-stuttgart.de (in “Research”). We use GLSL for
rendering the anaglyph image out of the left and right images. The 3 × 6 transformation matrix (RP ) can be decomposed into a dot product of a 3-component vector from one
image and a 3 × 4 matrix multiplication taking the result of
the dot product and the other source image, which can be
efficiently evaluated in the shader.
We measured ColorCode 3-D and red-cyan paper-frame
glasses on a Dell U2410 monitor, with the Standard Preset
Mode.
6.1. ColorCode 3-D (Amber-Blue)
For the ColorCode 3-D glasses, we obtain the following results: al = 0.4581, bl = 0.5183, ar = 0.0076, br = 0.0552,
γ = 1.856. Using this, we obtain fl = (1, 0.336, 0.152) and
fr = (0.003, 0.006, 1). This means, the left eye glasses let
pass the entire red component, 34% of the green, and 15%
of the blue component; and the right eye filter lets pass the
blue component, 0.3% of the red, and 0.6% of the green
component. This is remarkable, since on the left eye we can
potentially distinguish all colors and only have a limited luminance leaking consisting of 2.4% (= 1 − (al + bl )), which
causes ghosting. On the right eye, we have 6.3% luminance
leaking. With our technique, we can eliminate the luminance
leakages, but it is not possible to eliminate the color leakage
of the blue component to the left eye.
6.2. Red-Cyan Filter
For the red-cyan glasses, we obtain the following results:
al = 0.9260, bl = 0.0612, ar = 0.0094, br = 0.8705, γ =
1.668; fl = (1, 0.020, 0.041); fr = (0.027, 0.732, 1). 2% of
the green and 4% of the blue channel are not enough to see
green or blue on the left eye. The 3% red on the right eye
is also not apparent. Considering the ghosting, we have 7%
for the left eye’s luminance but just 1% for the right eye’s
luminance, which means there is strong ghosting on the left
eye.
6.3. Illustration
In the previous section, we measured how much luminance
is perceived from the primaries through the filters, but we

Monitor primaries usually are not monochromatic but extended and overlap partially [BDM04]. Let us assume that
we have anaglyph filters that clearly separate. In such a case,
light from the red, green, and blue channels passing the red
filter appears red, since the blue and green frequencies are
totally removed by the ideal filter. Light from the red, green,
and blue channels passing the cyan filter does not appear red.
This means, we can collect the luminance from the green
and blue color channels passing through the red filter and
replace it with a luminance that we add to the red channel;
and the same way we distribute the luminance from the red
channel passing through the cyan filter to the green and blue
channels. Contrary to the previous assumptions, which represent the worst case for our ghosting removal technique,
this model leads to the best case. The resulting images are
shown in the right columns of Figure 5.
The first thing to note is that there are no visible differences between the cyan images; this could be expected,
since just 1% of the luminance from the red channel leaks
through the cyan filter. However, there is visible ghosting in
the anaglyph image generated by the naïve method as seen
through the red filter in both cases. This ghosting is mainly
caused by the luminance differences to the original image
as seen through the glasses. With our technique, we eliminate the luminance differences. In the first case, there may
remain differences in color hue and saturation—depending
on your display the compensation shown in the figure may
be too large or to small, resulting in remaining luminance
differences—but in the second case, we can eliminate ghosting entirely (if the dynamic range is sufficient, see Section 8).
7. Analysis
In the previous section, we made some assumptions on the
filter transmission and the monitor primaries spectra and obtained two different estimates. The second one (idealized filter) obtained very good results, while the first one (idealized
device) suffered from quite strong color leakage. Here, we
will analyze a real system to identify which of the two models comes closer to the real situation.
To simulate the colors the observer sees through the fil© 2011 The Author(s)
© 2011 The Eurographics Association and Blackwell Publishing Ltd.

1257

H. Sanftmann & D. Weiskopf / Anaglyph Stereo Without Ghosting

original
left

anaglyph
right

naïve

estimated with ideal display device
left
right

ghosting reduced

estimated with ideal filter
right

ghost. red. est.

naïve est.

orig. l-r est.

left

.1

.0.5

.0 . .
.430 .470
.

.e-/trans-mission

.e-/trans-mission

.1

.550

.0 . .
.430 .470

.620 .670

.λ (nm)

.0.5

.

.550

.620 .670

.λ (nm)

Figure 5: The diagrams illustrate the transmission spectra of the red-cyan filters as dashed lines, and the emission spectra of
the monitor primaries as shaded areas. The left diagram uses an idealization with respect to the display device in the sense that
the spectra are narrow; however the red-cyan filters do not separate well. The right diagram uses an idealization with respect
to the filter, in the sense that the filter has a clear separation; however the display spectra overlap. From top to bottom, we see
the original left and right images and the naïve and ghosting reduced anaglyphs in the first row; the (non-anaglyph) images as
they look through red-cyan glasses (second row), the naïve anaglyph images as they look through the glasses (third row), our
ghosting reduced anaglyph images as they look through the glasses (forth row). (Colors may be strongly distorted in printouts.)

ters, we analyze the power spectrum of a monitor together
with a pair of red-cyan anaglyph glasses. CRT monitors
have quite similar spectra [WT02]—which differ from LCD
spectra [Sha02]. We used the monitor spectra of the right
Sony Trinitron Multiscan GDM-F500 monitor presented
by Boyaci et al. [BDM04] and the transmission spectra
of the paper-frame glasses (perspektrum.de) presented by
© 2011 The Author(s)
© 2011 The Eurographics Association and Blackwell Publishing Ltd.

Wieser [Wie06] for the calculations. Using the CIE 1931
2 ◦ Standard Observer color matching functions, we calculated the gamut and white point of the GDM-F500, see Figure 6. The cyan and red gamuts are calculated the same
way, but with multiplying the monitor spectra with the filters
transmission spectra beforehand. Both the red and the cyan
gamuts lie completely outside the GDM-F500 and the sRGB

1258

H. Sanftmann & D. Weiskopf / Anaglyph Stereo Without Ghosting

.0.8

.sRGB

.IF cyan

.0.6

.Y

.1

.10%
.full
.x

.y

.y

.

. .8
0
. .6
0
.0.4
.0.2 .
.0

.0.4
.ID
.ID

.MS
.0.2

.IF red
.MS

sponds to the measured filter values for the red-cyan glasses
(see Section 6.2).
After applying the ghosting correction matrix, resulting
colors do not necessary lie within [0, 1]. Concrete example:
the left input image is dark Cl = (0.02, 0.02, 0.02) and the
right one is bright Cr = (0.9, 0.9, 0.9), resulting in point
A. The anaglyph color after ghosting correction would be
C = (−0.051, 0.909, 0.909). Unfortunately, the red component needs to be reduced to negative values to compensate
for the luminance coming from the green and blue channels
of the output image shining through the red filter. Next we
present two solutions that bring the colors to the [0, 1] interval.

.GDM-F500
.sRGB
8.1. Clamp to Range

.0 .
.0
.

.0.2

. .4
0
.x

.0.6

Figure 6: Gamuts (as triangles) and white points (as circles) of the idealized display model (ID), the idealized filter
model (IF), and the spectral measurement (MS) in the CIExy
coordinate system. Gamut parts reaching 10% of the maximal possible luminance are drawn as shaded areas. In blue,
the gamut and white point of the Sony Trinitron Multiscan
GDM-F500 are shown; the ID gamuts are identical to the
sRGB gamut (in gray) at Y ≈ 0.

gamuts, and can therefore not be reproduced on these monitors. Color gamuts are 3D structures, which can be presented
in xyY space. At Y ≈ 0 they are defined by the primaries.
As luminance increases, the gamut shrinks and collapses to
the white point at Y = 1. Gamuts are usually presented as
projection to the xy plane, which corresponds to the Y ≈ 0
gamut. At Y ≈ 0, the gamuts used by the idealized display
device model correspond to the full monitor gamut. As additional information we show gamut parts reaching 10% of
the maximal luminance as shaded areas in Figure 6.
Notice that for the red filter the spectral measurement’s
gamut significantly differs from the idealized display device
model’s gamut but comes close to the idealized filter model’s
gamut. This means, the idealized filter model is more adequate and we should expect low color leakage in the real
world.

The easiest way to deal with the problem is to clamp the
output color values to [0, 1], resulting in (0, 0.909, 0.909) for
A. Actually, this is a projection to the closest point inside
the gamut. This way, luminance for inside gamut points is
corrected for leakage and reproduced exactly and luminance
for outside gamut points is maintained as close as possible.
Ghosting can appear for outside gamut points.
8.2. Complete Ghosting Elimination
To be able to completely eliminate ghosting we need to remove points that get mapped outside the gamut. This can be
done by applying a transformation to the input color values.
We restrict the luminance values to lie within given intervals in a way that the resulting combinations of luminance
values (forming an axis-aligned rectangle) lie completely inside the gamut. By mapping Clnew = 1 − zr + (2zr − 1)Clold
and Crnew = 1 − yr + (2yr − 1)Crold , we obtain a range having the luminance of pure red and pure cyan in its corners for
the red-cyan glasses, shown as dashed line in Figure 7. For
Anew , we obtain Yl = 0.091, Yr = 0.892, and (0.026, 0.901,
0.901) as resulting anaglyph color. The dynamic range with
respect to the luminance on the right eye still is large. Unfortunately, it significantly reduces the dynamic range with
respect to the left eye (Yl ). We cannot produce as bright colors as before, neither can we produce dark color on the red
eye. Nevertheless, we can guarantee that no ghosting will
appear in the output image. As noted above the intervals are
not predefined; usually, dynamic range for one eye can be
traded for dynamic range for the other one. The dotted line
in Figure 7 shows intervals that slightly improve the range
for the left but significantly reduce the range for the right
eye.

8. Dynamic Range
With imperfect filters, luminance intended for one eye
reaches the other eye and vice versa. This implies that we
cannot achieve each combination of luminance for the two
eyes, as illustrated in Figure 7. The gamut directly corre-

9. Conclusions and Future Work
We have presented a model for luminance perceived through
anaglyph glasses that can be used to substantially remove
ghosting artifacts from anaglyph stereo images. We have
© 2011 The Author(s)
© 2011 The Eurographics Association and Blackwell Publishing Ltd.

H. Sanftmann & D. Weiskopf / Anaglyph Stereo Without Ghosting

.1

1259

[Blo08] B LOOS W.:
Ghosting test.
http://www.
stereoforum.org/viewtopic.php?f=16&t=53,
2008. Last accessed on 8 Apr 2011. 2

.A
. .(0.0612, 0.8705)

[Dub01] D UBOIS E.: A projection method to generate anaglyph
stereo images. In Proceedings of the IEEE International Conference on Acoustics, Speech, and Signal Processing (2001), vol. 3,
pp. 1661–1664. 1, 2

.0.6

[IY05] I DESES I., YAROSLAVSKY L.: Three methods that improve the visual quality of colour anaglyphs. Journal of Optics
A: Pure and Applied Optics 7 (2005), 755–762. 2

.0.4

[KRC02] K INDLMANN G., R EINHARD E., C REEM S.: Facebased luminance matching for perceptual colormap generation.
In Proceedings of the IEEE Conference on Visualization (2002),
pp. 299–306. 3

.0.2

[Lob09] L OBEL R.: Magenta-cyan anaglyphs. http://www.
divideconcept.net/papers/MCA-RL09.pdf, 2009.
Last accessed on 08 April 2011. 2

Y
.r

.0.8

.0 .
.0
.

.(0.9260, 0.0094)
.0.2

.0.4

.0.6

.0.8

.1

Y
.l

Figure 7: This figure illustrates the perceived luminance
through the left and right glasses of the red-cyan filter (presented in Section 6.2) for different colors displayed on the
screen. Luminance combinations that cannot be obtained
through the glasses are shown outside the gray area. In particular, low luminance on the left eye cannot be obtained
when we have high luminance on the right eye (point A). Restricted working spaces are illustrated by dashed and dotted
lines.

showed how the model parameters can be estimated with
just six measurements. Our method can be used to render full color, half color, and gray anaglyphs without luminance ghosting, as well as for removing luminance ghosting artifacts from anaglyphs created with a naïve method.
Our method is not limited to red-cyan glasses, it determines
which glasses are in use during calibration, no further information is required. We have illustrated the results of our
method for different display devices and filters and related
the results to a real monitor and filter combination. Finally,
we have showed how ghosting can be eliminated independently of the luminance combinations in the source images
by sacrificing dynamic range.
We believe that our method be of interest since it greatly
enhances anaglyph stereo rendering. It is versatile and can
also be combined with current approaches. A combination
with the magenta-cyan technique targeting reduction of retinal rivalry is a good example of an interesting combination.

[Mul85] M ULLEN K. T.: The contrast sensitivity of human colour
vision to red-green and blue-yellow chromatic gratings. The
Journal of Physiology 359 (1985), 381–400. 2
[MZS10] M C A LLISTER D. F., Z HOU Y., S ULLIVAN S.: Methods for computing color anaglyphs. In Proceedings of SPIE 7524
(2010), pp. 75240S–75240S–12. 2
[OUW∗ 06] O KADA Y., U KAI K., W OLFFSOHN J. S.,
G ILMARTIN B., I IJIMA A., BANDO T.: Target spatial frequency determines the response to conflicting defocus- and
convergence-driven accommodative stimuli. Vision Research 46,
4 (2006), 475–484. 2
[Sha02] S HARMA G.: LCDs versus CRTs-color-calibration and
gamut considerations. Proceedings of the IEEE 90, 4 (2002),
605–622. 7
[SHS04] S ORENSEN S. E. B., H ANSEN P. S., S ORENSEN N. L.:
Method for recording and viewing stereoscopic images in color
using multichrome filters, 2004. 2
[SM03] S ANDERS W., M C A LLISTER D. F.:
Producing
anaglyphs from synthetic images. In Proceedings of SPIE 5006
(2003), pp. 348–358. 2
[SS10] S UTO M., S YKES D.: StereoPhoto Maker. http://
stereo.jpn.org/eng/stphmkr/, 2010. 2
[Uka06] U KAI K.: Human factors for stereoscopic images. In
Proceedings of the IEEE International Conference on Multimedia and Expo (2006), pp. 1697–1700. 2
[WH10] W OODS A. J., H ARRIS C. R.:
Comparing levels of crosstalk with red/cyan, blue/yellow, and green/magenta
anaglyph 3d glasses. In Proceedings of SPIE Stereoscopic Displays and Applications (2010), vol. 7524, p. 75240Q. 2
[Wie06] W IESER W.: Anaglyph glasses transmission spectra.
http://www.triplespark.net/render/stereo/
anaglyph/glasses/, 2006. 7
[Woo10] W OODS A.:
Understanding crosstalk in stereoscopic displays.
(Keynote Presentation) at 3DSA (ThreeDimensional Systems and Applications) conference, 2010.
http://citeseerx.ist.psu.edu/viewdoc/
summary?doi=10.1.1.165.5355. 2

References

[WT02] W OODS A. J., TAN S. S. L.: Characterising sources
of ghosting in time-sequential stereoscopic video displays. In
Proceedings of SPIE Stereoscopic Displays and Virtual Reality
Systems (2002), pp. 66–77. 2, 7

[BDM04] B OYACI H., D OERSCHNER K., M ALONEY L. T.: Perceived surface color in binocularly viewed scenes with two light
sources differing in chromaticity. Journal of Vision 4, 9 (2004),
664–679. 6, 7

[WYK07] W OODS A. J., Y UEN K. L., K ARVINEN K. S.: Characterizing crosstalk in anaglyphic stereoscopic images on LCD
monitors and plasma displays. Journal of the Society for Information Display 15, 11 (2007), 889–898. 2

© 2011 The Author(s)
© 2011 The Eurographics Association and Blackwell Publishing Ltd.


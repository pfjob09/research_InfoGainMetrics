DOI: 10.1111/j.1467-8659.2011.02072.x

COMPUTER GRAPHICS

forum

Volume 30 (2011), number 8 pp. 2427–2439

A General BRDF Representation Based on Tensor
Decomposition
¨ urk2 and Murat Kurt1
Ahmet Bilgili1 , Aydın Ozt¨
1 International

Computer Institute, Ege University, Turkey
ahmetbilgili@gmail.com and murat.kurt@ege.edu.tr
2 Department of Computer Engineering, Yasar University, Turkey
aydin.ozturk@yasar.edu.tr

Abstract
Generating photo-realistic images through Monte Carlo rendering requires efficient representation of light–surface
interaction and techniques for importance sampling. Various models with good representation abilities have
been developed but only a few of them have their importance sampling procedure. In this paper, we propose a
method which provides a good bidirectional reflectance distribution function (BRDF) representation and efficient
importance sampling procedure. Our method is based on representing BRDF as a function of tensor products.
Four-dimensional measured BRDF tensor data are factorized using Tucker decomposition. A large data set is
used for comparing the proposed BRDF model with a number of well-known BRDF models. It is shown that the
underlying model provides good approximation to BRDFs.
Keywords: BRDF representation, importance sampling, global illumination, rendering, Tucker decomposition
ACM CCS: I.3.7 [Computer Graphics]: Three-Dimensional Graphics and Realism

1. Introduction
The problem of developing an adequate representation for
the distribution of light scattered from a surface has been
studied extensively in computer graphics. The bidirectional
reflectance distribution function (BRDF) is commonly used
to describe surface reflectance. A wide range of models have
been proposed to approximate the BRDFs.
The incoming radiance (Li ) and outgoing radiance (Lo )
are closely related through the BRDF (ρ) by the following
well-known relationship:
Lo (ωo ) =

Li (ωi )ρ(ωi , ωo )(ωi · n) dωi ,

(1)

where ωi = (θi , φi ) and ωo = (θo , φo ) are the incoming and
outgoing direction vectors with elevation and azimuth angles θ and φ, respectively, and n is the surface normal
vector.
Computing the outgoing radiance involves two important
issues that need to be resolved. First we need to find an
c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics
Association and Blackwell Publishing Ltd. Published by
Blackwell Publishing, 9600 Garsington Road, Oxford OX4
2DQ, UK and 350 Main Street, Malden, MA 02148, USA.

adequate model for representing the BRDF, and second we
need to develop an efficient importance sampling procedure
for evaluating the integral in Eq. (1) by using Monte Carlo
techniques. Various models with good representation abilities
have been developed but a few of them have their importance
sampling procedure.
In this work, we propose to represent the BRDF by employing tensor products. Tensor products are based on factorizing the underlying data into certain components. Using
different techniques, several researchers have investigated
the possibility of BRDF factorization for real-time rendering [KM99, MAA01]. Lawrence et al. [LRR04] used nonnegative matrix factorization (NMF) to represent BRDF as
a product of univariate probability distributions. They used
this factorization especially for efficient importance sampling. Our approach provides a general method for both efficient BRDF representation and simple importance sampling
procedure. Empirical results show that the proposed method
achieves high compression ratios CRs while maintaining certain properties of BRDF including Fresnel effects and offspecularity.

2427

2428

A. Bilgili et al. / A General BRDF Representation Based on Tensor Decomposition

A physically plausible BRDF representation should dictate
non-negativity, Helmholtz reciprocity and energy conservation [NNSK99, EBJ∗ 06]. Our visually plausible representation satisfies the non-negativity property, but not the others,
namely, the Helmholtz reciprocity and the energy conservation.
For representing the measured BRDF, we use Tucker decomposition algorithm. This algorithm is used for computing
the tensor factors. Our BRDF model is based on halfway vector representation of the BRDF, followed by a compact and
accurate decomposition of this four-dimensional (4D) representation into univariate factors. We evaluate the 4D BRDF
as the sum of terms, each of which is defined as the product
of four univariate functions.
The proposed method also lends itself to developing an
efficient and simple importance sampling algorithm. The
most significant factors are identified and selected by using Tucker’s orthogonal projections, and samples are generated from the bivariate probability distributions of these
factors. Extensive empirical comparisons with a number of
well-known models have shown that the proposed model provides good approximation to measured BRDFs for various
isotropic and anisotropic materials.

2. Previous Work
The BRDF is the core part of the rendering equation [Kaj86].
Therefore, a wide range of BRDF models have been proposed to represent surface reflectance. These models can be
classified in two main groups: analytical BRDF models and
data-driven BRDF models.

2.1. Analytical BRDF models
One of the most well-known analytical model, is the Phong
model [Pho75]. An improved version of the Phong model
[Pho75] is the Blinn–Phong model [Bli77]. While the Phong
model is based on reflection vector, the Blinn–Phong model
is based on halfway vector. The halfway vector-based BRDF
representation is more convenient than the reflection vectorbased representation [NDM05]. Ward [War92] proposed a
simple formula to describe isotropic and anisotropic surface
reflectance. Lafortune et al. [LFTG97] obtained a generalization of the Phong BRDF model. This generalized Phong
model can represent non-Lambertian diffuse reflection, retroreflection and the Fresnel effects. Duer [Due05] presented a
variation of the Ward BRDF model, known as the Ward–Duer
BRDF model. This model has a different normalization factor
from the Ward representation, and thus improves the fitting
results [NDM05]. The Phong, the Blinn-Phong, the Ward, the
Ward-Duer and the Lafortune models are phenomenological
models. Some physically based BRDF models also have been
developed. The BRDF models of this category (e.g. [TS67,
CT81, HTSG91, ON94]) are more sophisticated and can

represent effects such as a Fresnel reflection and rough microgeometry. Anisotropic BRDF models [Kaj85, PF90, War92,
LFTG97, AS00, Due05, EBJ∗ 06] can represent the reflective
properties of oriented surfaces such as brushed metal, satin
and velvet.
The aforementioned analytical BRDF models have nonlinear parameters. On the other hand, the BRDF can be approximated using linear functions [WAT92, SS95, KvDS96,
LF97, OKBG08]. Westin et al. [WAT92] used spherical harmonics; Koenderink et al. [KvDS96] used Zernike polynomials; Schr¨oder and Sweldens [SS95] and Lalonde and Fournier
[LF97] used wavelets; Stark et al. [SAS05] proposed a new
barycentric coordinate system with respect to a triangular
support for reducing the dimensionality of some BRDF mod¨ urk et al. [OKBG08] used Principal Component
els; and Ozt¨
(PC) transformations of some explanatory variables for approximating BRDFs linearly. The main disadvantage of these
linear BRDF models is that they require a large number of
coefficients to represent BRDFs accurately.

2.2. Data-driven BRDF models
Acquiring dense measurements of the BRDF and using these
measurements directly in the rendering process have been
used in [MPBM03]. Unfortunately, this technique has large
storage complexity. Therefore, accurate and compact representations of measured BRDFs using factorization have
been investigated [KM99, MAA01, LRR04]. In all cases, 4D
BRDFs have been factored into product of two-dimensional
(2D) functions. More importantly, only Lawrence et al.
[LRR04] have developed an importance sampling procedure.
For isotropic BRDFs, Romeiro et al. [RVZ08] reduced the
measured BRDF data into a 2D representation by averaging
BRDF around φ d , which is one of the parameters defining incident vector in the Rusinkiewicz [Rus98] coordinate
system.

2.3. Importance sampling
Many analytical BRDF models [Pho75, Bli77, War92,
LFTG97, AS00, Due05, EBJ∗ 06] have their own importance sampling procedures. Importance sampling algorithms
are not available for some analytical BRDF models [TS67,
CT81]. Some other analytical models which have importance sampling schemes, often have problems approximating more complex BRDFs. Furthermore, fitting these analytical BRDF models to measured data often is not trivial
and non-linear optimizers must be used. These optimizers
need careful user intervention when fitting more than two
specular lobes [LRR04]. Lawrence et al. [LRR04] presented
a factored BRDF model, which has an efficient importance
sampling procedure. Lawrence et al. [LRR05] proposed an
importance sampling algorithm which depends on polygonal approximation of multi-dimensional tabular cumulative

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

A. Bilgili et al. / A General BRDF Representation Based on Tensor Decomposition

2429

distribution functions (cdfs) using Douglas–Peucker algorithm. This algorithm requires large storage space but provides low variance results for BRDF sampling. This algorithm also enables importance sampling of environment
maps. A sampling algorithm proposed by Montes et al.
[MUGL08], is based on rejection sampling of hierarchical
parameterless probability distribution functions (pdfs). Their
hierarchical structure reduces the number of fails in rejection
sampling, thus it increases the sampling speed and reduces
the variance.

2.4. Tensor approximation using factorization
In computer graphics, tensor approximations using factorization [KB09] have been used for data compression [VT04,
WWS∗ 05]. Sun et al. [SZC∗ 07] employed Tucker decomposition to decompose the BRDF data. They used this decomposition method to represent BRDF in a real-time global
illumination algorithm. They decomposed the data into three
2D matrices and a core tensor. Following a similar decomposition method we use univariate tensor functions to estimate
the BRDF recursively. Furthermore, we use Tucker decomposition to develop an efficient important sampling procedure.
Similarly we also employ Tucker decomposition to represent the measured BRDF data, but opposed to storing data
as 2D matrices and core tensor we evaluate the 4D BRDF as
the sum of terms, each of which is defined as the product of
four univariate functions.

Figure 1: Tucker factorization of a 3D tensor: Three univariate factors and a scalar constant representing the core
tensor.

tijk can be approximated by
P

Q

R

tijk ≈

gpqr xip yjq zkr ,

(2)

p=1 q=1 r=1

The 4D BRDF data can be represented through a Tucker
representation in a similar way as explained in the above
example. Our BRDF model is based on the halfway vector
representation. The halfway vector ωh = (θh , φh ) is defined
in terms of ωi and ωo as
ωh =

ωi + ωo
.
ωi + ωo

(3)

The halfway vector parametrization aligns certain BRDF features with directions of certain BRDF phenomena [NDM05].
3. Tensors and Tucker Factorization
Tensors are geometric entities presented to generalize the
notion of scalars, vectors and matrices to higher orders. The
order of the tensor is defined as the number of dimensions
used to represent the multi-way arrays. For example, a firstorder tensor can be viewed as a vector, a second-order tensor
as a matrix, a third-order tensor as a cube and so on.
The problem of expressing a tensor as a product of certain factors was first studied by Hitchcock in 1927 [Hit27a,
Hit27b] but it is named after the work of Tucker [Tuc63,
Tuc64, Tuc66]. Basically, the Tucker factorization is a generalization of higher order principal component analysis that
decomposes a tensor into a set of matrices and one small
core tensor. It has been used widely in various fields including image compression, data mining and psychometrics. A
good review of the topic can be found in [KB09].
The Tucker decomposition of a three-dimensional
(3D) matrix T = {tij k }, i = 1, . . . , I , j = 1, . . . , J , k =
1, . . . , K into a small 3D matrix G = {gpqr }, p =
1, . . . , P , q = 1, . . . , Q, r = 1, . . . , R and three 2D matrices X = {xip }, Y = {yj q }, Z = {zkr }, is illustrated in
Figure 1 . Based on this representation, a tensor element

Non-negativity of the estimated BRDF values is an important issue to consider in modelling BRDF data. Lawrence
et al. [LRR04] have employed NMF algorithm to avoid
negative BRDFs. In this paper we used the logarithmic transformation of the measured BRDF data. The logarithmic transformation not only provides a more convenient input for the
Tucker factorization but also eliminates the problem of estimated negative BRDF values.
For a given 4D sample matrix B = {bij kl }, i =
1, . . . , Nθh , j = 1, . . . , Nφh , k = 1, . . . , Nθo , l = 1, . . . ,
Nφo , where Nθh , Nφh , Nθo and Nφo are the sampling resolutions for each tensor axis, corresponding expression for the
BRDF can be written as
nθh nφh nθo nφo

bijkl ≈

gpqrs xip yjq zkr wls ,

(4)

p=1 q=1 r=1 s=1

where X = {xip }, p = 1, . . . , nθh , Y = {yj q }, q = 1, . . . ,
nφh , Z = {zkr }, r = 1, . . . , nθo and W = {wls }, s = 1, . . .
, nφo are the factor matrices and G = {gpqrs } is the core
tensor matrix and nθh , nφh , nθo and nφo are the Tucker
parameters. When nθh , nφh , nθo and nφo are smaller than
Nθh , Nφh , Nθo and Nφo , respectively, then the corresponding

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

2430

A. Bilgili et al. / A General BRDF Representation Based on Tensor Decomposition

core matrix G can be viewed as a compressed version of the
BRDF matrix B.

4. Approximating the BRDF Using the Tucker
Factorization
As is seen from Eq. (4), the Tucker factorization involves
the evaluation of four nested loops, each of which requires
a large number of iterations. Naturally, the accuracy of the
approximation is improved at the expense of increased computational cost. For certain applications the underlying cost
can be prohibitively large. On the other hand, decreasing
the number of iterations would cause large approximation
errors. To provide an intermediate solution to the problem,
we propose first to simplify the approximation procedure by
setting the parameters nθh , nφh , nθo and nφo of the Tucker
factorization all to 1 in Eq. (4) and then reduce the error
of approximation in a stepwise manner. From the point of
practical application, it turns out that this approach not only
provides a simple approximation to the BRDF but is also a
good ground for importance sampling.
Based on the simplified expression nθh = nφh = nθo =
nφo = 1, the corresponding Tucker approximation for a 4D
BRDF can be expressed as
log(bijkl ) ≈ gf 1 (θhi )f2 (φhj )f3 (θok )f4 (φol ),

(5)

where g is the core tensor which is a scalar for this
simplified case; f 1 (θ hi ), f 2 (φ hj ), f 3 (θ ok ) and f 4 (φ ol ) are
univariate tensor functions evaluated at θ hi , φ hj , θ ok and
φ ol ; and i = 1, . . . , Nθh , j = 1, . . . , Nφh , k = 1, . . . , Nθo
and l = 1, . . . , Nφo are the 4D BRDF matrix indices.
Clearly, Eq. (5) provides a rough approximation to the
BRDF. To improve the accuracy of this approximation we
propose applying the Tucker factorization recursively on the
corresponding error term. The first approximation model in
Eq. (5) can be rewritten as
B0 = B0 + e1 ,

When a BRDF data set is approximated by using our proposed approach, the corresponding CR will be:
CR =

L(1 + Nθh + Nφh + Nθo + Nφo )
.
Nθh Nφh Nθo Nφo

(9)

For a special case when Nθh = Nφh = Nθo = Nφo = N then
the corresponding CR becomes L(1 + 4N)/N 4 .
To render a colour image at a given outgoing direction,
we applied the Tucker approximation to the mean values of
measured BRDFs of the three colour channels. Following
a similar approach that was used by Ngan et al. [NDM05],
we estimated the diffuse and specular parameters for each
pair of measured BRDF of each colour channel and the approximated BRDF values using a robust linear regression
procedure [DO89].

5. Importance Sampling

(7)

where e1 is the Tucker approximation of e1 , and e2 is the error
term of the second approximation. This process is continued
until a satisfactory level of accuracy is obtained. Finally, the
log BRDF values can be approximated by
B0 ≈ B0 + e1 + e2 + · · · + eL−1 ,

needs to be determined empirically. This process is illustrated
in Figure 2 .

(6)

where B0 is the data matrix based on logarithms of the
BRDFs; B0 is the approximation to B0 ; and e1 is the error matrix of this first approximation. Next we model the
error term in a similar way as
e1 = e1 + e2 ,

Figure 2: This figure shows error modelling using Tucker
factorization. In this figure, e1 , e2 , e3 , . . . are errors,
B0 , e1 , e2 , e3 , . . . are tensors produced by Tucker factorization.

(8)

where L is the total number of iterations. Accuracy of the approximation closely depends on the number of iterations and

The BRDF data can be viewed as sampled frequencies of
¨
a multi-variate probability distribution [OKB10].
If an empirical estimate of the corresponding probability distribution
can be obtained through an appropriate normalization then
standard statistical methods can be used to generate incident
vectors for a given outgoing direction.
In Figure 3, we illustrate the decomposed univariate
Tucker factors of three isotropic materials (fruitwood-241,
nickel and red-metallic-paint) and an anisotropic material
(brushed-aluminum). It is interesting to observe in this
figure that the functions of φ h and φ o are approximately
uniform for isotropic materials (fruitwood-241, nickel and
red-metallic-paint). This suggests that most of the total variation is explained by two components corresponding to

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

2431

A. Bilgili et al. / A General BRDF Representation Based on Tensor Decomposition
0.5

0

0.12

0.26

0.4

0.06
0.04

0.3

f31(θo)

0.08

0.2

f41(φo)

0.25

f21(φh)

f11(θh)

0.1

0.24
0.23
0.22

0.1

0.02

0.21

16

32

48

64
θh

80

96

112

0

128

4

8

12

φh

16

4

8

12

θo

16

0.5

16

24

32
φo

40

48

56

64

8

16

24

32
φo

40

48

56

64

8

16

24

32
φo

40

48

56

64

16

32

48

64
φo

80

96

112

128

0.26

0.12
0.4

0.1

0.04
0.02

0.3

f31(θo)

f21(φh)

0.06

0.2

32

48

64
θh

80

96

112

0.22

0

128

0.24
0.23

0.1

0
16

f41(φo)

0.25

0.08
f11(θh)

8

0

4

8

12

φh

16

4

8

12

θo

16

0.5

0
0.26

0.4

0.1

0.2

16

32

48

64
θh

80

96

112

0.22

0

128

0.24
0.23

0.1

0

f41(φo)

0.3

f31(θo)

f21(φh)

f11(θh)

0.25
0.05

4

8

12

φh

16

4

8

12

θo

16

0.5

0.1

0.2

0.19
0.4
0.18

0.1

0

0.16

0.3

f41(φo)

0.17

f31(θo)

f11(θh)

f21(φh)

0.05

0.2

0

0.15
0.1
0.14
16

32

48

64
θh

80

96

112

128

4

8

12

16
φh

20

24

28

32

0

4

8

12

16
θo

20

24

28

32

Figure 3: Plots of Tucker univariate factors for isotropic and anisotropic materials. First row: fruitwood-241 (isotropic),
second row: nickel (isotropic) and third row: red-metallic-paint (isotropic). Fourth row brushed-aluminum material (anisotropic).
univariate functions of θ h and θ o . This empirical property
has been the case for all of the other isotropic materials
considered in this work. We could not establish a physical
correspondence for this situation. However, we used this empirical property of the measured data of isotropic materials
to facilitate an importance sampling procedure. As may be
seen from the figure, a similar property is observed for the
anisotropic material also but the univariate factors are the
functions of θ h and φ h for this case.
Based on the empirical properties explained, the Tucker
factorization can be used to reduce the 4D sampling problem
into a 2D case. Thus, our importance sampling strategy is
based on treating the 4D BRDF data as sampled frequencies
of the underlying distribution and approximating it by 2D
functions.
We define the joint pdf ph (θ h , φ h , θ o , φ o ) by normalizing
the approximated BRDF ρ(θ h , φ h , θ o , φ o ) as
ρ(θh , φh , θo , φo ) sin θh
,
ph (θh , φh , θo , φo ) =
K

ph (θh , φh , θo , φo )
,
K

(12)

where
Nθh Nφh
j

K =

ph (θhi , φh , θo , φo ) θh φh .

(13)

i=1 j =1

Eq. (1) is defined as a function of ωi and ωo over the
hemisphere where coordinate system is defined in terms of θ i ,
φ i , θ o and φ o . To convert the halfway representation into this
coordinate system we multiply the conditional distribution in
Eq. (12) by the Jacobian of the corresponding transformation
[PH04] which yields
pi (ω i | ω o ) =

ph (θh , φh | θo , φo )
.
4(ωh · ωi )

(14)

5.1. Importance sampling for isotropic materials

Nθh Nφh Nθo Nφo
j

i=1 j =1 k=1 l=1

ph (θh , φh | θo , φo ) =

(10)

where
K=

Given an outgoing vector, the incident vector can be generated from the conditional distribution

ρ θhi , φh , θok , φol sin θhi θh φh θo φo
(11)

is the normalizing coefficient, θh = π/(2Nθh ), φh =
2π/Nφh , θo = π/(2Nθo ) and φo = 2π/Nφo .

We applied Tucker factorization on the logarithms of
measured BRDF values, with parameters nθh = 200, nθo =
32, nφh = 1 and nφo = 1 on a sample with Nθh × Nφh ×
Nθo × Nφo = 200 × 3 × 32 × 3 to obtain a compact representation of BRDF data. Using this representation we

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

2432

A. Bilgili et al. / A General BRDF Representation Based on Tensor Decomposition

proceeded to perform an importance sampling in a region
defined by θ h and θ o only since the Tucker factors related
to φ h and φ o are approximately constant functions of these
parameters.

The empirical cdf of φ h can be approximated by

Based on these considerations, the conditional distribution
of θ h and φ h given that θ o and φ o can be simplified is

To simulate the vector ωh = (θh , φh ), first we generate φ h as

ph (θh , φh | θo , φo ) = ph (θh | θo ).
j

j
j

ph θhi | θo

θh .

To simulate the vector ωh = (θh , φh ), first we generate a pair
of uniformly distributed random variables (ξ 1 and ξ 2 ) on the
interval [0, 1]. Next φ h is generated as
φh = 2π ξ1 ,

(17)

(19)

5.2. Importance sampling for anisotropic materials
Importance sampling is performed in a similar way for
anisotropic materials as in the isotropic case. For this purpose we used a different anisotropic data set obtained by
Ngan et al. [NDM05] who have proposed a method for using
their data for direct rendering. We also employed their technique to create anisotropic data. Based on this anisotropic
data, we observed that the BRDF depends on θ h and φ h
only as shown in Figure 3 (bottom row). For this data
set we used a Tucker factorization with parameters nθh =
96, nφh = 48, nθo = 1 and nφo = 1 on a sample with a resolution of Nθh × Nφh × Nθo × Nφo = 256 × 48 × 16 × 16
for representing the BRDF. The incident vectors are generated using the joint conditional distribution of θ h and φ h
for given values of θ o and φ o .
Based on the empirical results for the anisotropic BRDFs
in Figure 3, marginal distributions of θ o and φ o can be assumed to be approximately uniform. The conditional distribution of θ h and φ h given that θ o and φ o can be written
as
ph (θh , φh | θo , φo ) = ph (θh , φh ).

(21)

(22)

where ξ 1 is a uniform random variable. Then, θ h is generated
using the inverse of the empirical conditional cdf Ph (θ h |φ h ),
which is approximated as
i

Ph θhi

j
| φh

=
m=1

j

ph θhm , φh
Nθ h
k=1

j

.

(23)

ph θhk , φh

Finally, for a given φ h and ξ 2 , which is a uniform random
variable, θ h is sampled as
θh = Ph−1 (ξ2 | φh ).

(24)

(18)

θ h and φ h are substituted in Eq. (14) to evaluate the function value of the conditional pdf. Finally we compute the
incident vector using the well-known relationship between
the halfway vector and the incident and outgoing direction
vectors:
ωi = 2(ωo · ωh )ωh − ωo .

θh φh .

φh = Ph−1 (ξ1 ),

and θ h is generated using the inverse of the empirical cdf Ph
in Eq. (16) as
θh = Ph−1 (ξ2 | θo ).

ph θhk , φhi

(16)

i=1

Nθ h

i=1 k=1

(15)

The empirical cdf evaluated at θ h = θ h can be expressed as
Ph θh | θo =

j
j

P h φh =

(20)

6. Results
To investigate some empirical properties of the proposed
factored model, a data set based on 100 isotropic materials
acquired by Matusik et al. [MPBM03] (from the MERL MIT
database), and another data set based on four anisotropic
materials acquired by Ngan et al. [NDM05] have been
used.
As was reported recently, Matusik et al.’s [MPBM03]
data include some noisy measurements [LRR04, NDM05].
To minimize sampling errors, we ignored the measurements with incident or outgoing angles greater than 85◦ .
Furthermore, Matusik et al.’s data’s missing measurements
were estimated by their corresponding column and row
averages.
We used samples with a fixed resolution of Nθh × Nφh ×
Nθo × Nφo = 128 × 16 × 16 × 64 and 128 × 32 × 32 × 128
for all isotropic and anisotropic BRDFs, respectively. Samples of resolutions Nθh × Nθo = 200 × 32 and Nθh × Nφh =
256 × 48 for isotropic and anisotropic importance sampling
were also considered.
In this work we used N-way Toolbox [AB00] with the orthogonal projection option for all computations corresponding to Tucker factorizations, and ROBUSTFIT [DO89] with
the bisquare option for estimating the diffuse and specular
colour parameters in MATLAB. The rendered images were
produced with Physically Based Rendering Toolkit (PBRT)
[PH04]. Analytical BRDF models that were chosen for empirical comparisons were fitted to measured BRDF data using Ngan et al.’s fitting procedure [NDM05]. As was suggested by various authors [NDM05, EBJ∗ 06], we considered multiple specular lobes for these analytical models. We

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

A. Bilgili et al. / A General BRDF Representation Based on Tensor Decomposition

2433

Figure 4: Spheres were rendered using measured BRDF data and our factored BRDF model: (a) blue-fabric, (b) blue-metallicpaint, (c) nickel, (d) yellow-matte-plastic, (e) grease-covered-steel, (f) red-velvet and (g) yellow-satin materials were presented.
All images were rendered at 1024 samples/pixel. Top row: reference images; middle row: our factored model; bottom row:
colour-coded differences between the reference images and the rendered images of factored model. For better comparison,
colour-coded differences were scaled. Below each image we also report the PSNR value.

Figure 5: The PSNR values of seven BRDF models for 100 isotropic materials. The PSNR values are sorted in the PSNRs of the
Cook–Torrance model (Magenta) for visualization purpose. Our model gives the highest PSNR values in 66 out of 100 materials
(higher is better).
c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

2434

A. Bilgili et al. / A General BRDF Representation Based on Tensor Decomposition

Figure 6: The Princeton scene was rendered for visual comparisons of well-known BRDF representations. (a) Reference image
was rendered using measured BRDF data; (b), (c), (d), (e), (f), (g) and (h) were rendered using the Ashikhmin–Shirley, the
Cook–Torrance, the Edwards et al., the Lawrence et al., the Ward, the Ward-Duer and our factored BRDF models, respectively.
All images were rendered at 262 144 samples/pixel using a path tracing algorithm. Insets show a colour-coded difference
between the reference image and the rendered image. For better comparison, colour-coded differences were scaled. Below each
image we also report the PSNR value.

Figure 7: (a) Image MSE for measured nickel BRDF as a function of the number of samples in constant environment. (b) Image
MSE for measured nickel BRDF as a function of the number of samples in Grace Cathedral environment. At 256 paths/pixel we
see the values for which the factor of improvement is listed in Tables 1 and 2.

compared our rendering results with those of Lawrence et
al. [LRR04], using the parameter values given in their paper.
The peak signal-to-noise ratio (PSNR) [Ric02] values were
obtained to compare the visual quality of the underlying
models.

Based on our model, renderings under direct illumination
are shown in Figure 4 for various isotropic and anisotropic
materials. It can be seen from the colour-coded difference
images that our compact factored model provides a satisfactory representation both for isotropic and for anisotropic

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

2435

A. Bilgili et al. / A General BRDF Representation Based on Tensor Decomposition

materials. Using 100 isotropic materials, we carried out an extensive comparison of our model with six well-known BRDF
models, namely Ashikhmin–Shirley [AS00], Cook–Torrance
[CT81], Edwards et al. [EBJ∗ 06], Lawrence et al. [LRR04],
Ward [War92] and Ward-Duer [Due05] (Figure 5). It is interesting to observe that the proposed model has resulted in
the highest PSNR values in 66 cases and performed well
for the remaining 34 materials. We also obtained renderings of the Princeton scene [LRR04, EBJ∗ 06] and presented these in Figure 6. The PSNR values calculated for
the materials given in the figure shows that our factored
BRDF model gives the best representation for this special
case.
We notice that the BRDF properties at grazing angles are
represented well with our method. However, for specular
regions appear to be more specular than expected for highly
specular materials such as brass, chrome, chrome-steel and
red-metallic-paint (see supplementary document).
To evaluate the efficiency of our importance sampling
procedure quantitatively, we rendered spheres (visibility
is not considered) lit by both constant and complex environment maps. The importance sampling methods selected for comparison include analytical samplings of
Ashikhmin–Shirley [AS00], Edwards et al. [EBJ∗ 06] BRDF
models and Lawrence et al.’s [LRR04] factored BRDF
model.
To investigate the effects of importance sampling procedures on the image quality, we calculated the MSEs
for various sample sizes (number of samples per pixel).
The mean squared errors (MSEs) obtained for bluemetallic-paint, nickel and yellow-matte-plastic are shown in
Figure 7. Reference images used in these comparisons
were rendered with 262 144 samples per pixel. We also
compared our method with the others in terms of the ratios of
corresponding MSEs. The results for constant and complex
environments are given in Tables 1 and 2, respectively. The
ratios of the MSEs given in these tables can be used to
estimate about how much longer the alternative approaches
would need to run to produce the same quality results
in rendered images as our method. Ratios greater than 1

Table 1: The efficiency of BRDF sampling in a constant environment. This table lists the factor of improvement in MSEs resulting
from sampling the BRDF according to our factored representation
in the constant environment.

Material
Ashikhmin–Shirley
Edwards et al.
Lawrence et al.

Blue-metallicpaint

Nickel

Yellow-matteplastic

0.5697
0.5330
0.4099

0.9432
1.8501
6.4845

0.7328
0.8134
1.3159

Table 2: The efficiency of BRDF sampling in Grace Cathedral environment. This table lists the factor of improvement in MSEs resulting
from sampling the BRDF according to our factored representation
in the Grace Cathedral environment.

Material
Ashikhmin–Shirley
Edwards et al.
Lawrence et al.

Blue-metallicpaint

Nickel

Yellow-matteplastic

1.029
0.8851
1.0158

0.9903
0.9672
1.2752

0.9361
0.9111
1.0759

indicate that the proposed importance sampling procedure
performs better than its competitors. As is seen from Figure 7
and Tables 1 and 2, our importance sampling method gives
comparable results. We also rendered the Princeton scene
using a path tracer with global illumination, which is shown
in Figure 8. In this case, multiple importance sampling (MIS)
methods [VG95] do not work, therefore the BRDF sampling
is the only reasonable strategy. In Figure 8, it should be noted
that the differences in the glossy highlights are caused by
different approximations produced by the respective models
(e.g. our representation cause colour-shift); the importance
sampling itself is unbiased. Clearly, our importance sampling
method is comparable to the importance sampling technique
presented by Ashikhmin–Shirley [AS00] and Lawrence
et al. [LRR04]. The sampling times based on 256 samples
per pixel for the Princeton scene which was rendered
under direct illumination, were found to be 1067.392,
1109.015, 1161.327 and 1261.461 seconds for Lawrence
et al. [LRR04], Ashikhmin–Shirley [AS00], our Tucker importance sampling procedure and Edwards et al. [EBJ∗ 06],
respectively. These results show that sampling times
are approximately the same for all importance sampling
algorithms.
We also compared the storage need of our model with
another factored BRDF model proposed by Lawrence et al.
[LRR04]. As it can be seen from Table 3, the storage needs of
our factored BRDF model are roughly two–three times less
than that of Lawrence et al.’s representation, while providing better representation. The parameter L defined in Eq. (9)
plays an important role both for storage complexity and representation ability. The values for L used in this comparison
are 15, 15 and 13 for blue-metallic-paint, nickel and yellowmatte-plastic, respectively. Our empirical results have shown
that a typical number of iterations (L) is about 13.
A similar comparison was performed on rendering times
of the models based on Figure 4. The corresponding results
are presented in Table 4. Rendering times were acquired on
an Intel Core i7 2.66 GHz computer with a 12 GB memory.
As seen from Table 4 that the rendering times of our factored
BRDF model is slightly higher than the rendering times of
the other models.

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

2436

A. Bilgili et al. / A General BRDF Representation Based on Tensor Decomposition

Figure 8: For visual comparison of sampling efficiency, the Princeton scene was rendered using a path tracer for global
illumination and paths up to five bounces were included: (a), (b), (c) and (d) were rendered using the Ashikhmin–Shirley BRDF,
the Edwards et al. BRDF, the Lawrence et al.’s factored BRDF and our factored BRDF at 256 samples/pixel, respectively. The
bottom row shows closeups of highlighted regions for all models.
Table 3: Required storage spaces by the three BRDF representations for various materials. Rendering data are prepared in binary
double precision for all BRDF representations.

BRDF Model
Measured
Lawrence et al.
Our factored model

Blue-metallicpaint

Nickel

Yellow-matteplastic

33.4 MB
139.0 KB
76.7 KB

33.4 MB
96.5 KB
76.7 KB

33.4 MB
331.9 KB
73.2 KB

Table 4: Rendering times (in seconds) of various BRDF representations.

BRDF Model
Measured
Cook–Torrance
Lawrence et al.
Ward
Our factored model

Blue-metallicpaint

Nickel

Yellow-matteplastic

1802.83
1647.43
1854.53
1465.93
2048.73

1894.33
1759.23
1795.97
1563.70
2122.40

1830.87
1770.70
1831.27
1591.10
2015.23

materials. Furthermore, we showed that our importance sampling procedure performed as well as other well-known importance sampling techniques.
Our future work will be continued to generalize the proposed factorization technique to higher dimensional data and
to implement our factored BRDF representation in real-time
global illumination algorithms.
Appendix
Algorithm 1 performs logarithmic transformation on the
measured BRDF data.
Algorithm 2 calculates the coefficients of Tucker factors
for a given number of iterations (L) by using the factorization
algorithm (tuckerFit) [AB00]. This algorithm also employs
robustFit [DO89] to obtain the robust regression estimates
of diffuse and specular parameters. While tuckerFit function
uses orthogonal projection option as a default parameter, robustFit function uses bisquare option as a default parameter.
Algorithm 3 reconstructs a tensor using the coefficients of
Tucker factors. Finally, Algorithm 4 evaluates the estimated
BRDF values.

7. Conclusions and Future Work
In this paper, we have introduced a factored BRDF model
which provided good approximation and an efficient importance sampling for BRDF. Our factored BRDF representation
can be considered as a compression technique for measured
BRDF data. We showed that our factored method can provide good approximations both for isotropic and anisotropic

Algorithm 1: prepareFittingData(measuredBRDF)
1:
2:
3:
4:

/∗ Br , Bg and Bb are BRDF tensors for each color channel∗ /
B = (Br + Bg + Bb )/3
B0 = log(B)
return B0

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

A. Bilgili et al. / A General BRDF Representation Based on Tensor Decomposition

References

Algorithm 2: fittingProcedure(B0 , L)
let e = B0
let logBRDF = 0
for i = 1 to L
[gi , f1{i} , f2{i} , f3{i} , f4{i} ] = tuckerFit(e)
e = e − tuckerEvaluateTensor(gi , f1{i} , f2{i} , f3{i} , f4{i} )
end for
for i = 1 to L
logBRDF = logBRDF+
tuckerEvaluateT ensor(gi , f1{i} , f2{i} , f3{i} , f4{i} )
9: end for
10: [kdr , ksr ] = robustFit(exp(logBRDF), Br )
11: [kdg , ksg ] = robustFit(exp(logBRDF), Bg )
12: [kdb , ksb ] = robustFit(exp(logBRDF), Bb )
13: return g{1...L} , f 1{1...L} , f 2{1...L} , f 3{1...L} , f 4{1...L} ,kdr , kdg , kdb , ksr ,
ksg , ksb , ksr , ksg , ksb

1:
2:
3:
4:
5:
6:
7:
8:

Algorithm 3: tuckerEvaluateTensor(g, f 1 , f 2 , f 3 , f 4 )
1:
2:
3:
4:
5:
6:
7:
8:
9:
10:
11:

2437

let evaluatedTensor = 0
for i = 1 to Nθh
for j = 1 to Nφh
for k = 1 to Nθo
for l = 1 to Nφo
evaluatedTensorijkl = g ∗ f1 (i) ∗ f2 (j ) ∗ f3 (k) ∗ f4 (l)
end for
end for
end for
end for
return evaluatedTensor

[AB00] ANDERSSON C. A., BRO R.: The n-way toolbox for
matlab. Chemometrics and Intelligent Laboratory Systems
52, 1 (Aug. 2000), 1–4.
[AS00] ASHIKHMIN M., SHIRLEY P.: An anisotropic Phong
BRDF model. Journal of Graphics Tools, 5, 2 (2000),
25–32.
[Bli77] BLINN J. F.: Models of light reflection for computer
synthesized pictures. Computer Graphics 11, 2 (1977),
192–198. (Proc. SIGGRAPH ’77).
[CT81] COOK R. L., TORRANCE K. E.: A reflectance model
for computer graphics. Computer Graphics 15, 3 (1981),
307–316. (Proc. SIGGRAPH ’81).
[DO89] DUMOUCHEL W. H., O’BRIEN F. L.: Integrating a robust option into a multiple regression computing environment. In Computing Science and Statistics: Proceedings
of the 21st Symposium on the Interface (Alexandria, VA,
1989), K. Berk and L. Malone (Eds.). American Statistical
Association, pp. 297–301.
[Due05] DUER A.: On the Ward model for global illumination. Unpublished material, 2005.
[EBJ∗ 06] EDWARDS D., BOULOS S., JOHNSON J., SHIRLEY P.,
ASHIKHMIN M., STARK M., WYMAN C.: The halfway vector
disk for BRDF modeling. ACM TOG 25, 1 (Jan. 2006),
1–18.
[Hit27a] HITCHCOCK F. L.: The expression of a tensor or a
polyadic as a sum of products. Journal of Mathematics
and Physics, 6, 1 (1927), 164–189.

Algorithm 4: renderTuckerBrdf(g{1...L} , f 1{1...L} , f 2{1...L} , f 3{1...L} ,
f 4{1...L} , θ hind , φ hind , θ oind , φ oind , kdr , kdg , kdb , ksr , ksg , ksb )
1: let logBRDF = 0
2: for i = 1 to L
3: logBRDF = logBRDF + g1{i} ∗ f1{i} (θhind ) ∗ f2{i} (φhind )∗
f3{i} (θoind ) ∗ f4{i} (φoind )
4: end for
5: return kdr + ksr ∗ exp(logBRDF), kdg + ksg ∗ exp(logBRDF),
kdb + ksb ∗ exp(logBRDF)

[Hit27b] HITCHCOCK F. L.: Multiple invariants and generalized rank of a p-way matrix or tensor. Journal of Mathematics and Physics, 7, 1 (1927), 39–79.
[HTSG91] HE X. D., TORRANCE K. E., SILLION F. X.,
GREENBERG D. P.: A comprehensive physical model
for light reflection. Computer Graphics 25, 4 (1991),
175–186. (Proc. SIGGRAPH ’91).
[Kaj85] KAJIYA J. T.: Anisotropic reflection models. Computer Graphics 19, 3 (1985), 15–21. (Proc. SIGGRAPH
’85).

Acknowledgments
The authors thank anonymous reviewers for their comments
and Wojciech Matusik et al. [MPBM03] for using their measured BRDF data. This work was supported by a grant from
the Scientific and Technical Research Council of Turkey
(Project No:108E007).

[Kaj86] KAJIYA J. T.: The rendering equation. Computer
Graphics 20, 4 (1986), 143–150. (Proc. SIGGRAPH ’86).
[KB09] KOLDA T. G., BADER B. W.: Tensor decompositions and applications. SIAM Review 51, 3 (Sept. 2009),
455–500.

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

2438

A. Bilgili et al. / A General BRDF Representation Based on Tensor Decomposition

[KM99] KAUTZ J., MCCOOL M. D.: Interactive rendering
with arbitrary BRDFs using separable approximations.
In Proceedings of Eurographics Workshop on Rendering (Granada, Spain, 1999), D. Lischinski and
G. W. Larson (Eds.). Eurographics Association, pp. 247–
260.
[KvDS96] KOENDERINK J. J., VAN DOORN A. J., STAVRIDI M.:
Bidirectional reflection distribution function expressed in
terms of surface scattering modes. In ECCV ’96: Proceedings of the 4th European Conference on Computer
Vision-Volume II (London, UK, 1996), B. F. Buxton and
R. Cipolla (Eds.), vol. 1065 of Lecture Notes in Computer
Science, Springer-Verlag, pp. 28–39.
[LF97] LALONDE P., FOURNIER A.: A wavelet representation of reflectance functions. IEEE Transactions on
Visualization and Computer Graphics, 3, 4 (1997), 329–
336.
[LFTG97] LAFORTUNE E. P., FOO S.-C., TORRANCE K. E.,
GREENBERG D. P.: Non-linear approximation of reflectance
functions. In Proceedings SIGGRAPH ’97 (New York,
NY, USA, 1997), ACM Press/Addison-Wesley Publishing Co., pp. 117–126.
[LRR04] LAWRENCE J., RUSINKIEWICZ S., RAMAMOORTHI R.:
Efficient BRDF importance sampling using a factored
representation. ACM TOG 23, 3 (2004), 496–505. (Proc.
SIGGRAPH ’04).
[LRR05] LAWRENCE J., RUSINKIEWICZ S., RAMAMOORTHI R.:
Adaptive numerical cumulative distribution functions for
efficient importance sampling. In Proceedings of Eurographics Symposium on Rendering (Konstanz, Germany,
2005), K. BALA and P. DUTRE´ (Eds.), Eurographics Association, pp. 11–20.
[MAA01] MCCOOL M. D., ANG J., AHMAD A.: Homomorphic
factorization of BRDFs for high-performance rendering.
In Proceedings SIGGRAPH ’01 (New York, NY, USA,
2001), ACM, pp. 171–178.
[MPBM03] MATUSIK W., PFISTER H., BRAND M., MCMILLAN
L.: A data-driven reflectance model. ACM TOG 22, 3 (July
2003), 759–769. (Proc. SIGGRAPH ’03).
[MUGL08] MONTES R., UREN˜ A C., GARC´IA R. J., LASTRA M.:
Generic BRDF sampling: A sampling method for global
illumination. In Proceedings of Third International Conference on Computer Graphics Theory and Applications
(Funchal, Madeira, Portugal, 2008), J. Braz, N. J. Nunes
and J. M. Pereira (Eds.), pp. 191–198.
[NDM05] NGAN A., DURAND F., MATUSIK W.: Experimental
analysis of BRDF models. In Proceedings of Eurographics Symposium on Rendering (Konstanz, Germany, 2005),

K. Bala and P. Dutr´e (Eds.), Eurographics Association,
pp. 117–126.
[NNSK99] NEUMANN L., NEUMANN A., SZIRMAY-KALOS L.:
Compact metallic reflectance models. Computer Graphics
Forum, 18, 3 (1999), 161–172.
¨
¨ ZTU¨ RK A., KURT M., BILGILI A.: A copula based
[OKB10]
O
BRDF model. Computer Graphics Forum 29, 6 (Sept.
2010), 1795–1806.
[OKBG08] OZTURK A., KURT M., BILGILI A., GUNGOR C.:
Linear approximation of bidirectional reflectance distribution functions. Computers & Graphics 32, 2 (April 2008),
149–158.
[ON94] OREN M., NAYAR S. K.: Generalization of Lambert’s reflectance model. In Proceedings SIGGRAPH ’94 (
New York, NY, USA, 1994), ACM, pp. 239–246.
[PF90] POULIN P., FOURNIER A.: A model for anisotropic reflection. Computer Graphics 24, 4 (1990), 273–282. (Proc.
SIGGRAPH ’90).
[PH04] PHARR M., HUMPHREYS G.: Physically Based Rendering: From Theory to Implementation. Morgan Kaufmann
Publishers Inc., San Francisco, CA, 2004.
[Pho75] PHONG B. T.: Illumination for computer generated pictures. Commun. ACM 18, 6 (June 1975), 311–
317.
[Ric02] RICHARDSON I. E.: Video Codec Design: Developing
Image and Video Compression Systems. John Wiley &
Sons, Inc., New York, NY, 2002.
[Rus98] RUSINKIEWICZ S. M.: A new change of variables
for efficient BRDF representation. In Proceedings of
Eurographics Workshop on Rendering (Vienna, Austria,
1998), G. Drettakis and N. L. Max (Eds.), Springer,
pp. 11–22.
[RVZ08] ROMEIRO F., VASILYEV Y., ZICKLER T.: Passive reflectometry. In ECCV ’08: Proc. of the 10th European Conference on Computer Vision: Part IV (Marseille, France,
2008), D. A. Forsyth, P. H. S. Torr and A. Zisserman
(Eds.), vol. 5305 of Lecture Notes in Computer Science,
Springer-Verlag, pp. 859–872.
[SAS05] STARK M. M., ARVO J., SMITS B.: Barycentric parameterizations for isotropic BRDFs. IEEE Transactions
on Visualization and Computer Graphics 11, 2 (March
2005), 126–138.
[SS95] SCHRO¨ DER P., SWELDENS W.: Spherical wavelets: Efficiently representing functions on the sphere. In Proc.
SIGGRAPH ’95 (New York, NY, USA, 1995), ACM, pp.
161–172.

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

A. Bilgili et al. / A General BRDF Representation Based on Tensor Decomposition
∗

[SZC 07] SUN X., ZHOU K., CHEN Y., LIN S., SHI J., GUO B.:
Interactive relighting with dynamic BRDFs. ACM TOG
26, 3 (2007), 27:1–27:10. (Proc. SIGGRAPH ’07).
[TS67] TORRANCE K. E., SPARROW E. M.: Theory for offspecular reflection from roughened surfaces. Journal
of the Optical Society of America 57, 9 (Sept. 1967),
1105–1114.
[Tuc63] TUCKER L. R.: Implications of factor analysis of
three-way matrices for measurement of change. In Problems in Measuring Change, C. W. Harris (Ed.), University
of Wisconsin Press, Madison, WI, 1963, pp. 122–137.
[Tuc64] TUCKER L. R.: The extension of factor analysis to
three-dimensional matrices. In Contributions to Mathematical Psychology, H. Gulliksen and N. Frederiksen
(Eds.), Holt, Rinehart and Winston, New York, 1964, pp.
110–127.
[Tuc66] TUCKER L. R.: Some mathematical notes on threemode factor analysis. Psychometrika 31, 3 (Sept. 1966),
279–311.

2439

[VG95] VEACH E., GUIBAS L. J.: Optimally combining sampling techniques for Monte Carlo rendering. In Proc.
SIGGRAPH ’95 (New York, NY, USA, 1995), ACM, pp.
419–428.
[VT04] VASILESCU M. A. O., TERZOPOULOS D.: Tensortextures: Multilinear image-based rendering. ACM TOG 23,
3 (2004), 336–342. (Proc. SIGGRAPH ’04).
[War92] WARD G. J.: Measuring and modeling anisotropic
reflection. Computer Graphics 26, 2 (1992), 265–272.
(Proc. SIGGRAPH ’92).
[WAT92] WESTIN S. H., ARVO J. R., TORRANCE K. E.:
Predicting reflectance functions from complex surfaces.
Computer Graphics 26, 2 (1992), 255–264. (Proc.
SIGGRAPH ’92).
[WWS∗ 05] WANG H., WU Q., SHI L., YU Y., AHUJA N.:
Out-of-core tensor approximation of multi-dimensional
matrices of visual data. ACM TOG 24, 3 (2005), 527–
535. (Proc. SIGGRAPH ’05).

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.


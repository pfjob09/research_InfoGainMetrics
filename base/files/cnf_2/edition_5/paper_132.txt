DOI: 10.1111/j.1467-8659.2011.01985.x
Eurographics Symposium on Rendering 2011
Ravi Ramamoorthi and Erik Reinhard
(Guest Editors)

Volume 30 (2011), Number 4

Perceptual Global Illumination Cancellation in
Complex Projection Environments
Yu Sheng†1 , Barbara Cutler1 , Chao Chen2 and Joshua Nasman1
1 Department

of Computer Science, Rensselaer Polytechnic Institute, 2 Institute of Science and Technology, Austria

Abstract
The unintentional scattering of light between neighboring surfaces in complex projection environments increases
the brightness and decreases the contrast, disrupting the appearance of the desired imagery. To achieve satisfactory projection results, the inverse problem of global illumination must be solved to cancel this secondary
scattering. In this paper, we propose a global illumination cancellation method that minimizes the perceptual difference between the desired imagery and the actual total illumination in the resulting physical environment. Using
Gauss-Newton and active set methods, we design a fast solver for the bound constrained nonlinear least squares
problem raised by the perceptual error metrics. Our solver is further accelerated with a CUDA implementation
and multi-resolution method to achieve 1-2 fps for problems with approximately 3000 variables. We demonstrate
the global illumination cancellation algorithm with our multi-projector system. Results show that our method
preserves the color fidelity of the desired imagery significantly better than previous methods.
Categories and Subject Descriptors (according to ACM CCS): I.3.7 [Computer Graphics]: Three-Dimensional
Graphics and Realism—Virtual reality, Radiosity

1. Introduction
As the brightness, contrast, resolution, and affordability of
projectors increases, large-scale displays and projection systems are becoming more prevalent and can be integrated into
our physical surroundings. Projection environments with
multiple projection surfaces facing each other can suffer dramatically from the secondary scattering of light. This unintended reflection of light can lead to a scene with increased
brightness, decreased contrast, and loss of color fidelity. To
generate projection results that most faithfully capture the
desired appearance, we must compute appropriate projection images that take into account this unintentional light
scattering. Essentially we must solve an inverse global illumination optimization problem – given a physical scene
and a desired appearance, we compute the optimal projected
illumination such that the actual total illumination, which is
the sum of projected illumination and secondary scattering,
most closely matches the desired appearance.
For the examples in this paper, we transform the appearance of an existing physical geometry with diffuse white or
† shengyu@cs.rpi.edu
c 2011 The Author(s)
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd. Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ,
UK and 350 Main Street, Malden, MA 02148, USA.

light grey surfaces into colorful scenes. By modeling the diffuse illumination transport in the physical model, we are
able to cancel indirect scattering of the projected light and
more accurately control the total illumination of patches in
the physical model. We address this problem using a patchbased radiosity framework [GTGB84]. We define Kp to be
the radiosity matrix for the physical model, Bd,i to be the
desired radiosity of each patch, and B p,i to be the radiosity
(reflection of both direct and indirect illumination) of patch
i in the physical environment. E p,i is the necessary emitted
light of patch i in the physical scene, which will be provided
by direct illumination from the projectors. Using the classic radiosity equation, reverse radiosity [BGZ∗ 06, MKO06]
assumes Bd,i is always achievable, and lets Bp = Bd :
Ep = Kp Bp = Kp Bd

(1)

Although this method provides an exact solution to Equation (1) with realtime computing rates, it may require negative emittances at some physical patches. To alleviate this
issue, Sheng et al. [SYC10] proposed a bound constrained
optimization method to find the optimal Ep that minimizes
the difference between Bd and Bp = Kp −1 Ep in the linear
YPbPr color space. However, the linear error metrics do not

1262 Y. Sheng, B. Cutler, C. Chen & J. Nasman / Perceptual Global Illumination Cancellation in Complex Projection Environments

Figure 1: We transform a simple diffuse white room into a more colorful room with simulated light emitted from the lamp shade
and false windows. Simply projecting the desired imagery into the scene results in a washed out appearance due to indirect
scattering. The exact inverse solution requires negative light that is discarded before projection. A linear optimization using
YPbPr space produces a reasonable result, but we can guarantee the optimal result for human perception only by solving the
problem in a perceptually uniform space, e.g., L*a*b*.




 


116h( YYn ) − 16
match human perception, and sometimes produce noticeably
R
L
X


Y
X
different results (Figure 1).
 a = 500 h( Xn ) − h( Yn )  ,  Y = T  G  , (2)


B
b
Z
We propose a perceptual global illumination cancellation
200 h( YYn ) − h( ZZn )
method to faithfully preserve the contrast and color fidelity
where T is the 3 × 3 transformation matrix. Xn , Yn , and Zn
in multi-surface projection environments, such as the Office
are CIE XYZ values of the reference white point. Function
of the Future [RWC∗ 98] and architectural daylighting visuh is a piecewise function defined by
alization [SYYC11]. Our contributions in this paper include:
• A formulation of the objective function in a perceptually
uniform color space. We define the error metric in the CIE
L∗ a∗ b∗ [McL76] color space, which is commonly used for
measuring human perception of color difference.
• A fast nonlinear optimization algorithm to solve the perceptual objective function. We present a fast solver for the
bound constrained nonlinear least squares problem with
the Gauss-Newton and active set methods.
• We leverage GPGPU techniques and a multi-resolution
strategy to further accelerate our nonlinear solver. Our algorithm achieves fast computing rates and can be used in
iterative design applications.
2. Related Work
2.1. Visual Difference Metrics
The linear error metric proposed in Sheng et al.’s
work [SYC10] is not a perceptual measurement of the difference. MacAdam ellipses [Mac42] demonstrate that equal
distances in linear color spaces, such as RGB, YPbPr, or
XYZ, do not correspond to equal perceptual difference. In
contrast, the CIE L∗ a∗ b∗ [McL76] color space was designed
to be perceptually uniform. An RGB color triplet can be converted to a triplet (L, a, b) in L∗ a∗ b∗ color space:

1

h(t) =

t3
1 29 2
4
3 ( 6 ) t + 29

t > (6/29)3
Otherwise

(3)

The difference between any two colors in L∗ a∗ b∗ is defined as ∆E = (L1 − L2 )2 + (a1 − a2 )2 + (b1 − b2 )2 . Two
colors are considered distinguishable if ∆E is greater than
2.3 [McL76]. Metrics based on the L∗ a∗ b∗ color space have
been designed to evaluate the perceptual differences for
complex color images [ZW97, CL07]; however, these error
metrics are designed for 2D images and cannot be directly
applied to our 3D global illumination cancellation problem.
2.2. Inverse Lighting
Projectors have been widely used to create immersive
or semi-immersive environments for scientific visualization, education, and entertainment. Photometric calibration [MS04] and radiometric compensation [NPGB03,
GB08] allow seamless display via multiple projectors on everyday surfaces. When projecting imagery into complex environments, effects such as reflection and refraction can be
significant and should not be ignored.
Seitz et al. propose the inter-reflection cancellation operator (IRC), which, in theory, can be used to cancel indirect
c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Y. Sheng, B. Cutler, C. Chen & J. Nasman / Perceptual Global Illumination Cancellation in Complex Projection Environments

scattering for general BRDFs [SMK05]. However, acquiring
the full IRC matrix is time consuming and requires significant storage. The light transport matrix [SCG∗ 05] models
full light transport between a camera image and projection
image and captures a variety of global illumination phenomena. Methods based on the matrix [WB07, BCNR10] produce projection images by solving a linear equation. However, calibration of the transport matrix is both time and
storage consuming, and furthermore, when the projection
surfaces or projector configurations are modified the system
must be fully re-calibrated. O’Toole and Kutulakos [OK10]
propose a novel method to perform optical computing without explicitly capturing the matrix. For diffuse projection
environments, reverse radiosity [BGZ∗ 06, MKO06] and an
optimization based cancellation method [SYC10] have been
demonstrated to compensate for secondary scattering.
2.3. Nonlinear Least Squares
Many problems in computer vision and computer graphics
can be posed as a Nonlinear Least Squares (NLSQ) optimization problem in the form
minn ||f(x) − y||2 ,

x∈R

(4)

where f(x) is a smooth Rn → Rm

(m ≥ n) nonlinear function,
y ∈ Rm . For the rest of the paper, we only assume m = n.
For NLSQ problems, the second-order derivative (Hessian)
can be well approximated by the first-order derivative (Jacobian). Gauss-Newton takes advantage of this fact and transforms the nonlinear problem to a linear least squares problem at each iteration. The Gauss-Newton method may not
find a descent direction when the Jacobian matrix J of the
objective function is rank deficient or close to rank deficient.
The Levenberg-Marquardt (LM) method [Lev44] addresses
this problem by adding a damping factor to the diagonal entries of matrix J⊺ J. LM is a hybrid method of steepest descent and Gauss-Newton, and its convergence rate is often
not as fast as Gauss-Newton.

1263

and quantitative comparison show that our error metric preserves color fidelity significantly better than previous methods.
3.1. Perceptual Error Metrics
We define Li′ , a′i , b′i as the L∗ , a∗ , and b∗ components of each
patch for the desired appearance, and Li , ai and bi as the
resulting physical scene color with projection. v and v0 are
3n × 1 (n is the number of patches) vectors defined by:
v = [L1 , ..., Ln , a1 , ..., an , b1 , ..., bn ]⊺ = [L, a, b]⊺
v0 = [L1′ , ..., Ln′ , a′1 , ..., a′n , b′1 , ..., b′n ]⊺ ,
r = v − v0 is the difference vector.
The objective function consists of two parts, the absolute
term and the spatial term.
Absolute Error Term. The first term defines the area
weighted sum of absolute luminance and chrominance errors of the physical scene over all patches:
φabs =

∑i Ai [(Li − Li′ )2 + (ai − a′i )2 + (bi − b′i )2 ]
Aavg

= r⊺ W1 r,

(5)

where Ai is the area of patch i in the physical scene, and
is used to weight the importance of each patch based on its
size. We normalize this term by dividing by the average area
of all the patches. W1 in Equation (5) is a 3n × 3n diagonal
matrix, with AAavgi as each diagonal element.
Spatial Error Term. Our second term aims to preserve the
gradients and discontinuities between neighboring patches:
φspt =∑ [(Li − L j )−(Li′ − L′j )]2 +[(ai − a j )−(a′i − a′j )]2
(i, j)∈nbd

+ [(bi − b j ) − (b′i − b′j )]2 = r⊺ W2 r,
where (i, j) ∈ nbd indicates patches i and j share a common
edge in the mesh. W2 is a 3n × 3n block diagonal matrix,
whose diagonal element is the Laplacian matrix of the dual
graph of the geometry.

Determining if a variable satisfies a bound constraint
is straightforward; therefore, most bound constrained optimization solvers adopt the active set strategy. The active set
method divides the variables into two sets, active and free
variables. The active variables either satisfy the KKT condition or are close to bound constraints and can be solved by
steepest descent. For free variables, traditional methods such
as the Newton or Quasi-Newton may be used to compute a
descent direction. Line search is then used to compute a step
size, and the final result is projected to the feasible region.

Complete Objective Function. The complete objective
function then can be computed as a weighted sum of φabs
and φspt :
φ = αφabs + (1 − α)φspt

3. Perceptual Global Illumination Cancellation

We use the black level and maximum brightness of the
projector as bound constraints for our optimization problem.
The objective function φ can be written in the general form
of bound constrained nonlinear least squares,

To optimize the final projection appearance for human perception, we formulate our objective function by measuring
the difference between Bp and Bd in the CIE L∗ a∗ b∗ color
space and enforcing the smoothness of Bp . Visual inspection
c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

= r⊺ [αW1 + (1 − α)W2 ]r = r⊺ Wr.

(6)

The equation can be denoted as a function of Ep by further
transforming r = v−v0 . For each triplet (Li , ai , bi ) in v, it can
be rewritten as a nonlinear function of a triplet (Bri , Bgi , Bbi )
in Bp , by Equation (2) and (3). Then the emittance Ep can
be computed from Bp by equation (1).

min ||f(x) − y||2 , such that l ≤ x ≤ u,

x∈Rn

(7)

1264 Y. Sheng, B. Cutler, C. Chen & J. Nasman / Perceptual Global Illumination Cancellation in Complex Projection Environments
columns

green trapezoid

interior partitions

Our method

Sheng et al. 2010

Desired appearance

L-shaped

Figure 2: Four example scenes illustrate the differences between our perceptual compensation method and previous work. In
each example we aim to transform geometry with diffuse white surfaces into the desired appearance shown in the top row. The
first two examples demonstrate that high frequency detail textures may be combined with the per patch radiosity values.
where f(x) is a Rn → Rn nonlinear function, y ∈ Rn . In section 4, we propose an efficient solver for this problem.

4.1. Properties of the Objective Function
Property 1 The Jacobian matrix J of function f is always
full rank if α > 0.

3.2. Comparison of Cancellation Algorithms
We compare perceptual cancellation algorithm to Sheng et
al.’s method [SYC10]. Figure 2 shows the results of several
moderately complex comparison experiments. With these
four examples, we observe that our method more faithfully
preserves the saturated colors and contrast in the desired image than previous work. For each of the simulation images,
the color difference between the desired appearance and the
simulated projection results of both algorithms is computed
using the CIE ∆E calculation. Table 1 lists the per-pixel average and maximum ∆E for each scene. In all of the examples, the perceptual cancellation algorithm produces much
smaller numerical differences than Sheng et al.’s method.
4. Efficient Nonlinear Solver
Due to the nonlinearity of perceptual color space, we need
to solve a nonlinear least squares problem defined by equation (6) with bound constraints. In this section, we prove two
important properties of the objective function, and propose
a fast nonlinear least squares solver based on the GaussNewton and active set methods.

Proof If α > 0, W is a symmetric positive definite matrix.
R is a 3n × 3n block diagonal matrix and is the Cholesky
factorization of W. L, a, and b are the L*, a*, and b* values
for each patch in the physical scene. u is the X, Y, and Z
values for each patch in the physical scene:


T11 T12 T13
u = [x1 , ..., xn , y1 , ..., yn , z1 , ..., zn ]⊺ , T = T21 T22 T23 
T31 T32 T33
T is a 3n × 3n matrix and Ti j (i, j = 1, 2, 3) is a diagonal
matrix with diagonal entries equal to Ti j in the transformation matrix T in Equation 2. Since T is invertible, T is nonsingular. The Jacobian of function f can be written as,


∂L
0
0
∂y
∂v
∂v  ∂a ∂a

0
J = R×
(8)
× T × Kp ,
=  ∂x ∂y
∂u
∂u
∂b
∂b
0
∂y
∂z
Each block in ∂∂ uv is an n × n diagonal matrix. For a triplet
(L, a, b), its derivative with regards to (x, y, z) is:
c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Y. Sheng, B. Cutler, C. Chen & J. Nasman / Perceptual Global Illumination Cancellation in Complex Projection Environments

Methods

L-shaped

columns

green trapezoid

interior partitions

C-shaped

blue curves

Sheng et al. 2010

∆E=15.46

∆E=12.09

∆E=10.89

∆E=6.35

∆E=5.45

∆E=9.22

(linear)

∆Em =50.41

∆Em =49.16

∆Em =99.31

∆Em =79.23

∆Em =63.12

∆Em =84.98

Our method

∆E=9.20

∆E=10.78

∆E=7.01

∆E=4.45

∆E=4.18

∆E=5.63

(perceptual)

∆Em =41.72

∆Em =40.32

∆Em =81.21

∆Em =64.20

∆Em =52.59

∆Em =71.08

1265

Table 1: Per pixel average and maximum ∆E measurements (quantifying human perception) for the four example scenes in
Figure 2 and two example scenes in Figure 4.


h′ (t)




0
500 ′ x
Xn h ( Xn )

0

116 ′ y
Yn h ( Yn )
′ y
− 500
Yn h ( Yn )
200 ′ y
Yn h ( Yn )



0

0

′ z
− 200
Zn h ( Zn )

(9)

is the derivative of function h(t) in equation (3), which
is always non-zero. Therefore, matrix ∂∂ uv is always nonsingular. We can draw the conclusion that J is always full
rank because R, T, and Kp are non-singular matrices.
Furthermore, α > 0 means that the matching of absolute
luminance and chrominance for each patch is necessary. This
property leads to the following corollary,
Corollary 1 For function f defined by our problem, the
Gauss-Newton method will either have a valid descent direction or reach a critical point.
Property 2 The Jacobian matrix J (Eq (8)) satisfies the Lipschitz condition.
Proof We only discuss problems defined for real numbers.
A function f : RN → RM satisfies the Lipschitz condition if
there exists a real constant L ≥ 0, such that for any x1 and
x2 defined in RN , || f (x1 ) − f (x2 )|| ≤ L ||x1 − x2 ||. f is also
called Lipschitz continuous. Due to norm equivalence, we
will focus on the proof of 2-norm.
It is easy to show that any linear mapping from RN → RN
is bounded by the induced norm of the transformation matrix [Mrc95]. Another property of Lipschitz continuity is that
if both f and g are Lipschitz continuous, the product f g is
also Lipschitz continuous. In Equation (8), R, T, and Kp are
all linear mappings, thus we only need to show that the operator ∂∂ uv is Lipschitz continuous. For u0 ∈ R3n , ∂∂ uv (u0 ) can
be decomposed into:


 

1
116
0
0
0
0
Yn
Xn
∂v
∂
h


 

1
0 u0
− 500
0 ×  0
(u0 )= 500
Yn
Xn
Xn
∂u
∂t
1
200
200
0
0
− Zn
0
Zn
Yn
(10)
with h = [h(t), h(t), . . . , h(t)]⊺ . Note that in Equation (10),
the matrix is written in block format, each entry in the matrix represents a n × n diagonal matrix. Since the two matrices in Equation (10) are both linear mappings, we only
need to prove that Jacobian H′ = ∂∂ht satisfies the Lipschitz
c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

condition. We first prove that function h′ (t) is Lipschitz continuous.
1 − 23
t > (6/29)3
3t
h′ (t) =
(11)
1 29 2
Otherwise
3( 6 )
For any t1 < t2 ∈ R,
6 3
) , then |h′ (t1 ) − h′ (t2 )| = 0, which is al1. If t1 < t2 ≤ ( 29
ways bounded.
6 3
2. If ( 29
) < t1 < t2 , due to the mean value theorem, there
exists t ∈ [t1 , t2 ], such that,

|h′ (t1 ) − h′ (t2 )| = |h′′ (t)| · |t1 − t2 | ≤
3. If t1 ≤

6
29

3

2
9

29
6

5

|t1 − t2 |.

< t2 , it is easy to show that

|h′ (t1 ) − h′ (t2 )| ≤

2
9

29
6

5

|

6
29

3

− t2 | ≤

2
9

29
6

5

|t1 − t2 |

Therefore, h′ (t) is Lipschitz continuous. For any two vectors x1 , x2 ∈ R3n ,
2 29 5
||x1 − x2 ||2
H′ (x1 ) − H′ (x2 ) 2 ≤
9 6
Therefore, H′ is Lipschitz continuous, and we can safely
draw the conclusion that J satisfies Lipschitz condition.
The second property leads to the following Corollary [LHW10].
Corollary 2 The Gauss-Newton method is locally convergent for our objective function.
4.2. Active set Gauss-Newton algorithm
Corollaries 1 and 2 support the use of the Gauss-Newton algorithm to achieve a fast convergence rate. Using the core
idea of the active set Newton method [FJ98], we design a
modified Gauss-Newton method to solve our problem. To
extend the Gauss-Newton method for bound constraints, we
impose the constraints on each sub-problem, which is a linear least squares problem. In each iteration, we first identify
the active set, the variables that “touch” the boundary and
satisfy the KKT conditions. In other words, we find all variables xi that satisfy the condition
xi = li and ∇φi (x) > 0, or xi = ui and ∇φi (x) < 0.

(12)

These variables can be safely discarded during the solving
process, a significant performance boost. Then we compute

1266 Y. Sheng, B. Cutler, C. Chen & J. Nasman / Perceptual Global Illumination Cancellation in Complex Projection Environments
Algorithm 1 Active set Gauss-Newton algorithm
Input: handle to objective function f , initial point x0 , lower
bound l, and upper bound u
Output: Local minimum f val, x
1: x = x0 , project x to [l, u]
2: while not done do
3:
[ f val, grad, J] = f (x), H = J⊺ J
4:
Find all active variables that satisfy equation (12)
5:
Call Algorithm 2 to compute dF for free variables
6:
Find step size α with Armijo rule [Ber82].
7:
x = x + αd, f valnew = f (x)
8: end while

Algorithm 2 Modified projected Newton algorithm
Input: matrix H, vector f, initial point x0 , lower bound l,
and upper bound u
Output: vector x of a local minimum
1: x = x0 , project initial x to [l, u]
2: while not done do
3:
grad = 2 ∗ H ∗ f, find all active variables
4:
Solve linear system HF dF = gradF
dF gradF
5:
Compute step size α = − 2d
F HF dF
6:
x = x + α ∗ d, project x to [l, u]
7:
Set done=true if stopping criteria is satisfied.
8: end while

the descent direction dF for the free variables xF with a convex problem:

similarly fast for the first several iterations but then reverts
to a slower steepest descent method.

min d⊺F (J⊺ J)F + ∇φF (x)dF , s.t. lF − xF ≤ dF ≤ uF − xF .

5. Speedup Strategies

For each convex sub-problem, we use a modified projected Newton method [Ber82] to achieve a fast convergence rate. Instead of diagonalizing the sub-matrix of active
variables in the Hessian in the traditional projected Newton
method, we directly remove the rows and columns from the
Hessian for an improved running time. The detailed algorithm of our active set Gauss-Newton method is listed in
algorithm 1. The modified projected Newton algorithm is
listed in algorithm 2.
To guarantee the convergence of our algorithm, we perform a line search in each iteration. The proof of convergence can be made similarly to the active set Newton
method [FJ98], by substituting BkF with (J⊺ J)kF . In practice,
the step size computed from the line search procedure is always 1. This is not unexpected because our objective function is Lipschitz continuous and the unconstrained GaussNewton method without line search is locally convergent.
Therefore our modified algorithm can well preserve the fast
convergence rates of the classical Gauss-Newton method
(without line search).

CUDA Implementation CUDA provides an interface to
the parallel computing capability of modern GPUs. It also
provides libraries for high performance numerical computing. Our implementation makes use of the CUBLAS, CUSPARSE and Thrust libraries. We also use CULA, a GPU LAPACK library, to solve linear equations on the GPU. We use
single precision floating point computation with our GPU
implementation. We find that the accuracy with single precision is sufficient for our application. For all the examples in
this paper, the differences between the optimal result using
single precision and double precision are less than 0.05%
and do not cause any visual difference.
The CUDA implementation of our solver greatly improves the computing speed. On a desktop machine with an
NVIDIA GeForce GTX 480 graphics card and Intel Core 2
Quad Q9450 CPU, it takes 32-50 seconds for our C++ implementation to converge for systems with ~3000 variables.
The CUDA implementation requires 1.8-2.4 seconds.

6.6
Our method
Trust−Region
Levenberg−Marquardt

6.4

4.3. Comparison with Other Solvers

6
log(f)

We compare our algorithm with two general nonlinear least
squares solvers, a LM method based solver implemented in
C [Lou04] and a MATLAB solver based on the trust-region
reflective method [CGT88] (“lsqnonlin” function in MATLAB). For a fair comparison, we implemented our algorithm
both with MATLAB and C++. We use BLAS and LAPACK
libraries from Intel MKL for both our C++ implementation
and the LM solver. We ran all three algorithms for all the
examples in this paper and found that our algorithm is 10 to
30 times faster than the “lsqnonlin” function, and 20 to 25
times faster than the LM solver. Figure 3 is a plot of convergence speed for each algorithm. From the curves, we see that
our active set Gauss-Newton method has the fastest convergence speed. The Levenberg-Marquardt method converges

6.2

5.8
5.6
5.4
5.2
5
0

5

10

15

20

25
iteration

30

35

40

45

50

Figure 3: Comparison of the convergence speeds for different algorithms for a test case with 2880 variables. Our algorithm converges in 7 iterations, while other methods need
more iterations. The log scale of this plot emphasizes the
dramatic slowing of convergence with the LM method. In this
example, LM needs more than 150 iterations to converge,
and we do not plot all the iterations.
c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

(photo)

(photo)

(photo)

(photo)

(photo)

(photo)

(photo)

Sheng et al. 2010

our method

(photo)

our method

(photo)

desired appearance

geometry/materials

1267

Sheng et al. 2010
(photo)

desired appearance

geometry/materials

Y. Sheng, B. Cutler, C. Chen & J. Nasman / Perceptual Global Illumination Cancellation in Complex Projection Environments

Figure 4: Two example scenes illustrate the differences between our method and Sheng et al.’s method. We present both the
renderings of the expected computer simulations and photographic results from our physical projection experiments. We did not
calibrate the camera; thus, comparison of viewpoint and color of the simulations to the photographs is an approximate match.
Multi-resolution A multi-resolution method has been
adopted in our current implementation. We build a coarse
mesh with roughly one eighth as many patches as the
fine one. A simple correspondence is established between
patches in different resolutions allowing the desired appearance information to be pushed from high resolution to low
resolution and then to pull the solution projection data from
low resolution to initialize the optimization at high resolution. Implementation details can be found in Section 5.5.2
of [She11]. In practice, with the multi-resolution strategy,
the optimization algorithm is 2 to 4 times faster, converging
in 0.5-1.0 seconds, which is acceptable for iterative design
applications. Our implementation of the linear compensation method [SYC10] runs at 6 fps, 3 time faster than the
perceptual compensation method.
6. Physical System Demonstration
We constructed a multi-projector environment for architectural daylighting visualization [SYYC11] to further demonstrate our perceptual global illumination cancellation algoc 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

rithm. The projection surfaces in this space have reflectance
ρ = 0.9 and six calibrated projectors display the solution
images onto these surfaces. Our perceptual cancellation algorithm preserves color fidelity and overall appearance of
the desired scene significantly better than Sheng et al.’s
method [SYC10]. Figure 4 shows the results of two comparison experiments both in simulation and also with photographs of our physical test environment. For the first example (“C-shaped”) the apparent color of the left flat wall produced with the linear compensation algorithm is red, which
does not match the desired appearance. In contrast, our perceptual method accurately portrays the desired yellow appearance of this surface. The companion video shows that
the temporal appearance of the left flat wall is inconsistent
when applying the linear compensation method, while our
new perceptual method is consistent. In the second example
in Figure 4 (“blue curves”), with our method, the sharp contrast between the blue walls and the white wall on the right
is much more accurately captured. The ∆E metrics for these
two examples are shown in Table 1.

1268 Y. Sheng, B. Cutler, C. Chen & J. Nasman / Perceptual Global Illumination Cancellation in Complex Projection Environments
7. Conclusions and Future Work
We present a perceptual global illumination cancellation
framework for complex multi-surface diffuse projection environments that is practical for interactive applications. We
formulate the problem as a bound constrained nonlinear least
squares optimization problem and design a fast solver based
on active set Gauss-Newton methods. We demonstrate our
algorithm within a physical multi-projector environment.
Results show that our cancellation method can preserve the
appearance of the desired imagery more faithfully than previous methods.
We see several interesting avenues for future work in this
area. Our analysis of the result images is limited to a perpixel ∆E comparison. Future work on image-based perceptual differences [MMS04] that also take into account color
differences will allow a more complete analysis of our results. Due to the limited memory on the GPU, our algorithm is currently limited to 2500 surface patches (7500 variables). Therefore, improving the scalability of the algorithm
is an interesting topic. We also want to prove that our active
set Gauss-Newton algorithm also has the local convergence
property without using line search. The Lipschitz continuity
of the Jacobian J and consistent performance of the technique in practice suggest that convergence is guaranteed. Finally, it may also be useful to extend the method to allow
non-diffuse light transport within the system.
References
[BCNR10] BAI J., C HANDRAKER M., N G T.-T., R AMAMOOR THI R.: A dual theory of inverse and forward light transport. In
European Conference on Computer Vision (2010), pp. 1–8.
[Ber82] B ERTSEKAS D.: Projected newton methods for optimization problems with simple constraints. SIAM Journal on Control
and Optimization 20, 2 (1982), 221–246.
[BGZ∗ 06] B IMBER O., G RUNDHÖFER A., Z EIDLER T., DANCH
D., K APAKOS P.: Compensating indirect scattering for immersive and semi-immersive projection displays. In Proc. of the
IEEE Conference on Virtual Reality (2006), pp. 151–158.
[CGT88] C ONN A., G OULD I., T OINT P.: Global convergence
of a class of trust region algorithms for optimization with simple
bounds. SIAM J. Numer. Anal. 25 (April 1988), 433–460.
[CL07] C HOU C.-H., L IU K.-C.: A fidelity metric for assessing
visual quality of color images. In Proceedings of 16th International Conference on Computer Communications and Networks
(Aug. 2007), pp. 1154 –1159.
[FJ98] FACCHINEI F., J ÚDICE J.: An active set Newton algorithm
for large-scale nonlinear programs with box constraints. SIAM J.
on Optimization 8 (January 1998), 158–186.

[LHW10] L I C., H U N., WANG J.: Convergence behavior of
Gauss-Newton’s method and extensions of the smale point estimate theory. J. Complex. 26 (June 2010), 268–295.
[Lou04] L OURAKIS M.: levmar: Levenberg-Marquardt nonlinear
least squares algorithms in C/C++, Jul. 2004.
[Mac42] M ACADAM D.: Visual sensitivities to color differences
in daylight. J. Opt. Soc. Am. 32, 5 (1942), 247–273.
[McL76] M C L AREN K.: The development of the CIE 1976
L*a*b* uniform color-space and color-difference formula. J. of
the Society of Dyers and Colourists 92 (1976), 338–341.
[MKO06] M UKAIGAWA Y., K AKINUMA T., O HTA Y.: Analytical compensation of inter-reflection for pattern projection. In
Proceedings of the ACM symposium on Virtual reality software
and technology (2006), ACM, pp. 265–268.
[MMS04] M ANTIUK R., M YSZKOWSKI K., S EIDEL H.-P.: Visible difference predicator for high dynamic range images. In Proceedings of IEEE International Conference on Systems, Man and
Cybernetics (2004), pp. 2763–2769.
[Mrc95] M RCUN J.: Lipschitz spectrum preserving mappings on
algebras of matrices. Linear Algebra and its Applications 215
(1995), 113 – 120.
[MS04] M AJUMDER A., S TEVENS R.: Color nonuniformity in
projection-based displays: Analysis and solutions. IEEE Transactions on Visualization and Computer Graphics 10 (March
2004), 177–188.
[NPGB03] NAYAR S., P ERI H., G ROSSBERG M., B ELHUMEUR
P.: A projection system with radiometric compensation for
screen imperfections. In ICCV Workshop on Projector-Camera
Systems (PROCAMS) (Oct 2003).
[OK10] O’T OOLE M., K UTULAKOS K. N.: Optical computing
for fast light transport analysis. In ACM SIGGRAPH Asia 2010
papers (New York, NY, USA, 2010), ACM, pp. 164:1–164:12.
[RWC∗ 98] R ASKAR R., W ELCH G., C UTTS M., L AKE A.,
S TESIN L., F UCHS H.: The office of the future: A unified approach to image-based modeling and spatially immersive displays. In Proc. of SIGGRAPH 98 (July 1998), Computer Graphics Proceedings, Annual Conference Series, pp. 179–188.
[SCG∗ 05] S EN P., C HEN B., G ARG G., M ARSCHNER S.,
H OROWITZ M., L EVOY M., L ENSCH H.: Dual photography.
ACM Transactions on Graphics 24, 3 (Aug. 2005), 745–755.
[She11] S HENG Y.: Interactive Daylighting Visualization in Spatially Augmented Reality Environments. PhD thesis, Rensselaer
Polytechnic Institute, 2011.
[SMK05] S EITZ S., M ATSUSHITA Y., K UTULAKOS K.: A theory of inverse light transport. In ICCV ’05: Proceedings of
the Tenth IEEE International Conference on Computer Vision
(2005), IEEE Computer Society, pp. 1440–1447.
[SYC10] S HENG Y., YAPO T., C UTLER B.: Global illumination compensation for spatially augmented reality. In Computer
Graphics Forum 29, 2 (May 2010).

[GB08] G RUNDHÖFER A., B IMBER O.: Real-time adaptive radiometric compensation. IEEE Transactions on Visualization and
Computer Graphics 14, 1 (Jan./Feb. 2008), 97–108.

[SYYC11] S HENG Y., YAPO T. C., YOUNG C., C UTLER B.: A
spatially augmented reality sketching interface for architectural
daylighting design. in IEEE Transactions on Visualization and
Computer Graphics 17, 1 (2011), 38–50.

[GTGB84] G ORAL C., T ORRANCE K., G REENBERG D., BATTAILE B.: Modelling the interaction of light between diffuse surfaces. In Computer Graphics (Proceedings of SIGGRAPH 84)
(July 1984), vol. 18(3), pp. 213–222.

[WB07] W ETZSTEIN G., B IMBER O.: Radiometric compensation through inverse light transport. In Proceedings of the
15th Pacific Conference on Computer Graphics and Applications
(USA, 2007), IEEE Computer Society, pp. 391–399.

[Lev44] L EVENBERG K.: A method for the solution of certain
non-linear problems in least squares. The Quarterly of Applied
Mathematics 2 (1944), 164 – 168.

[ZW97] Z HANG X., WANDELL B.: A spatial extension of CIELAB for digital color-image reproduction. Journal of the Society
for Information Display 5, 1 (1997), 61–63.

c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.


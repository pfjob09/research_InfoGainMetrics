DOI: 10.1111/j.1467-8659.2011.02024.x
Eurographics Symposium on Geometry Processing 2011
Mario Botsch and Scott Schaefer
(Guest Editors)

Volume 30 (2011), Number 5

A Condition Number for Non-Rigid Shape Matching
Maks Ovsjanikov

Qi-Xing Huang

Leonidas Guibas

Stanford University

Abstract
Despite the large amount of work devoted in recent years to the problem of non-rigid shape matching, practical
methods that can successfully be used for arbitrary pairs of shapes remain elusive. In this paper, we study the
hardness of the problem of shape matching, and introduce the notion of the shape condition number, which captures
the intuition that some shapes are inherently more difficult to match against than others. In particular, we make a
connection between the symmetry of a given shape and the stability of any method used to match it while optimizing
a given distortion measure. We analyze two commonly used classes of methods in deformable shape matching, and
show that the stability of both types of techniques can be captured by the appropriate notion of a condition number.
We also provide a practical way to estimate the shape condition number and show how it can be used to guide
the selection of landmark correspondences between shapes. Thus we shed some light on the reasons why general
shape matching remains difficult and provide a way to detect and mitigate such difficulties in practice.
Categories and Subject Descriptors (according to ACM CCS): I.3.5 [Computer Graphics]: Computational Geometry
and Object Modeling—Geometric algorithms

1. Introduction
Shape matching is one of the most basic operations in digital
geometry processing, with applications ranging from medical image analysis [MV98] to shape interpolation [KMP07],
to reconstruction [LPC∗ 00], and to information (e.g. texture)
transfer [KS04]. In the most general setting, the goal of a
shape matching method is to recover an alignment between
two shapes, which can be represented as either a deformation
of one of the shapes or a correspondence between points on
two given shapes. Although shape matching can often be effortlessly performed by humans, practical and robust computational methods that can be used for a wide class of shapes
and their deformations remain elusive.
A major challenge in designing a successful shape matching
method is to define an informative measure by which potential alignments can be scored and compared. In the majority
of cases, such a score is represented through an energy function which assigns a single value to each potential solution
of the matching problem, and the goal is to find the alignment minimizing this score, locally or globally. The primary
objective of unsupervised shape matching is to formulate
an energy function entirely in terms of the shape geometry,
without prior knowledge on shape functionality, part decomposition or semantics. This constraint lies at the heart of the
difficulty of non-rigid shape matching, and as we will show
c 2011 The Author(s)
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd. Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ,
UK and 350 Main Street, Malden, MA 02148, USA.

Figure 1: Optimal placement of a landmark to improve stability
of shape matching using our method. Red to green means higher to
lower improvement in stability. Note that the best landmarks are in
the most featureless areas of the shape.

in this paper, prior information is often required to obtain a
single, reliable solution.
When the matching problem is phrased in terms of finding the optimal correspondence between points on the two
shapes, a commonly used strategy for defining an energy
function is to measure how well a correspondence preserves
distances between pairs points on each shape. In the context of non-rigid matching, distance preservation is often
interpreted in terms of geodesic distances, which translates
to recovering approximate intrinsic isometries — a problem

1504

Ovsjanikov et al. / A Condition Number for Non-Rigid Shape Matching

that has recently received a lot of attention, e.g. see [MS05,
BBK06, TBW∗ 09, LF09, OMMG10] among many others.
Alternatively, when the matching algorithm seeks a lowerdimensional deformation of a source shape onto the target
shape, and the deformed points may not lie on but only near
the target, the energy function is often formulated through
a trade-off between proximity to the target shape and the
local stretching introduced by the deformation, e.g. [LSP08,
HAWG08, ZSCO∗ 08, WAO∗ 09].
Note that in both formulations the solution space is associated with an energy landscape and the goal of the matching
algorithm is to find the global (or often local) minimum of
this energy. It is the case, however, that often there exist other
solutions with very similar energy values to the optimal one,
but which lie very far in the solution space. The simplest example of this scenario is matching symmetric shapes, which
admit at least two equally good maps. In the presence of
noise, which map will be chosen as optimal can be arbitrary,
and prior information such as shape semantics is necessary
to pick the single "correct" solution. Even without perfect
symmetry, however, small perturbations of one of the shapes
can cause the optimal solution to change wildly.
In this paper, we study the stability properties of non-rigid
shape matching with respect to a given energy function. Our
goal is to formalize the intuition that some shapes lead to
more “difficult” energy landscapes, and this difficulty can
be captured by measuring the stability of the “best” solution
under small perturbations. For example, a highly detailed,
non-symmetric shape may have a unique global minimum
of the deformation energy when matched even against a perturbed version of itself, while a near-symmetric shape may
have several equally good solutions, without a canonical way
to choose between them.
To capture this intuition we introduce a stability measure,
called the shape condition number, which measures the
worst-case behavior of how much the optimal solution can
change under perturbations of the input source shape or energy landscape. We then relate the condition number to a
simpler notion called the shape symmetry score which measures how far a shape is from symmetry. We analyze the
symmetry score for both correspondence-based and deformation based shape matching and show how appropriate notions can be defined and estimated in practice through an
eigenanalysis of certain matrices. Finally, we use these measures to derive methods for computing landmarks on a shape
that explicitly aim to improve the stability of shape matching. For example, Figure 1 shows the improvement in stability of matching after adding a landmark correspondence
for different points on the cat shape. Note that the best landmarks can often lie in the most featureless parts of the shape.
Although the notion that symmetric shapes lead to ambiguities in matching and are therefore more difficult to match
is intuitive and has been in the geometry processing folklore, we believe that we are the first to provide a rigorous

formulation of this idea via the concepts of the shape condition number and symmetry score and to study their properties. Furthermore, our stability-enhancing landmark selection strategy leads to landmark sequences with a distinctly
different flavor and better behavior from those that have appeared earlier.
2. Related Work
Although a wealth of methods exists for non-rigid matching, the questions of stability as well as the hardness of
shape matching, while observed in many settings, have not
received a great deal of attention.
In the context of rigid matching, [MGPG04] studies the
“funnel of convergence” of the point-to-plane Iterative Closest Point (ICP) algorithm of Chen and Medioni [CM92],
which is the set of initial shape configurations that lead to
convergence of ICP. The authors also propose a method that
is shown to have a more stable funnel of convergence for
a set of shapes. In a related work, Gelfand et al. [GIRL03]
study the problem of optimal placement of landmark correspondences for ICP and show that greater stability can be
achieved if the landmarks are chosen to decrease the slippage energy. Interestingly, the slippage energy is closely related to the symmetry structure of the shape, as developed
and exploited in [GG04].
In non-rigid shape matching, several techniques have been
proposed for finding landmark correspondences which can
be used as anchors to improve stability of matching.
Memoli and Sapiro [MS05] use Farthest Point Sampling
(FPS) on the geodesic distance function to find a covering of
a shape by landmarks which can be used to approximate the
Gromov-Hausdorff distance between a pair of shapes. Similarly, Bronstein et al. [BBK06] and Raviv et al. [RBBK07]
use FPS to reduce the complexity of finding a low distortion map between a large set of points. One of the drawbacks of FPS is its reliance of the randomness to compute
the first landmark point. To improve repeatability Zhang et
al. [ZSCO∗ 08] use the extremal points of the geodesic distance field as feature landmarks for correspondence. Sun et
al. [SOG09] and Ovsjanikov et al. [OMMG10] use extremal
points of the heat kernel function to find landmark points for
correspondence. These landmarks also show a large degree
of repeatability on a standard dataset [BBB∗ 10] (see also
references in [BBB∗ 10] for a list of evaluated feature detection methods). In a similar spirit, Ruggeri et al. [RPSS10]
use the extremal points of the eigenfunctions of the LaplaceBeltrami operator to find landmark correspondences. Note,
however, that while landmark repeatability of several feature detectors was evaluated by Bronstein et al. [BBB∗ 10],
in most of the existing methods there is no explicit connection between the performance of landmark selection and
the stability of shape matching. Note also that recently, Sun
et al. [SCF10] have introduced a Gromov-Hausdorff stable
c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Ovsjanikov et al. / A Condition Number for Non-Rigid Shape Matching

1505

modification of geodesic distances and used it to define a
notion of shape distance that they show more stable and discriminative than geodesic distortion on a benchmark set.
Perhaps the most closely related to ours is recent work by
Tevs and colleagues [TBW∗ 11] who propose a guided landmark selection process for shape matching, which adds landmark points according to the amount of information contained in them, as measured by the entropy of the appropriate
probability distribution. While entropy is a useful measure
of information gain, it is still not clear how to connect decrease in entropy with the stability of shape matching. Moreover, while Tevs et al. provide some practical evaluation of
performance under perturbation of distances, in the analysis
and motivation the authors assume that the two shapes are
exactly isometric, whereas our goal is precisely to study the
stability of shape matching under shape perturbations.
We also note that measuring the difficulty of matching
through self-similarity has been considered before in the
context of string matching, in the seminal works of Knuth,
Morris, Pratt [KMP77] and Boyer, Moore [BM77].
3. Motivation
Before we introduce the notion of the shape condition number, we provide some motivation as to why such a notion
is useful. In numerical stability theory (see e.g. [TB97]), a
problem is called well-conditioned if a small perturbation
in the input data leads to a small perturbation in the result.
For example, a linear system Ax = b is well conditioned if
given A(x + ∆x) = b + ∆b, small ∆b leads to a small ∆x for
any b. In this context, the (relative) matrix condition number
∆b
σmax
κ(A) = supb,∆b ∆x
= σmin,
where σmax and σmin
x
b
are the largest and smallest singular values of A respectively,
or, equivalently, if A is real and symmetric, absolute values
of largest and smallest eigenvalues. A linear system is wellconditioned if κ(A) is close to 1, and ill-conditioned if κ(A)
is large. In particular, if A is rank-deficient, κ(A) = ∞. Intuitively, κ(A) measures the difficulty of solving a linear system with A, regardless of the method used.
Our main goal is to use a similar notion for non-rigid shape
matching. To illustrate this problem, consider two simple
shapes in Figure 2a. They represent nearly perfect starshapes with a small modification at one of the ends (marked
in red). Thus, in the noise-free case, there exists a unique
map Topt that minimizes distortion of Euclidean distances
between pairs of points. However, when a small amount of
noise is added to Y , the optimal map can change drastically,
Figure 2b. Thus, even if a method obtains the “correct” map
in the noiseless case, this solution is not reliable since there
exist other maps with very similar distortion, but which look
very different. Note that in this case, and, as we show below,
in general, instability is closely related to shape symmetry.
In order to quantify and measure the stability of shape
c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

(a) Optimal map for the noise- (b) Optimal map after a small
free matching problem.
amount of noise.

Figure 2: For a pair of almost perfectly symmetric shapes (deviation marked in red), although the least-distortion map Topt is unique
(a), it can change dramatically with a small amount of noise (b).
matching we will first need to define a way to evaluate perturbations of the input shapes, as well as the induced changes
in the optimal matching solution. As we noted in the introduction, the solution to a shape matching problem between
shapes X and Y is either a map Topt : X → Y, which optimizes
some measure of distortion DX,Y (T ), or a set of deformation
parameters Popt , such that when X is deformed according to
Popt , it lies as close as possible to Y . In this setting again,
Popt are commonly chosen to minimize an energy function
EX,Y (P). Therefore, to define a condition number, we need
a way to measure stability of Topt and Popt . In the following
sections we outline several possibilities for correspondencebased and deformation-based shape matching methods.
4. Correspondence-Based Matching
In this section we define the condition number for
correspondence-based matching. Given two shapes X and Y ,
the output of a matching is a map Topt : X → Y that optimizes
some distortion measure DX,Y (T ) (see e.g. [MS05, BBK06,
TBW∗ 09, LF09] and related techniques). We would like to
say that a shape X is well-conditioned if a small perturbation
in Y leads to a small perturbation in Topt for all Y . One of the
difficulties in implementing this idea is that if Y is symmetric
then there may be several optimal maps T , regardless of X.
To avoid such situations we will assume that Y is a perturbation of X and will measure how far Topt is from the identity.
To formalize this notion, we will treat all shapes as compact metric spaces. Thus, we will represent a shape X as a
collection of point-to-point distances (e.g. geodesic or Euclidean). For simplicity, we will also assume that the shapes
consist of a finite number of points, although similar statements can also be made for continuous metric spaces. Finally, we would like all shapes to be scaled so that e.g. the
diameter is always 1. This is only to ensure that something
like a “small distance” makes sense. Then, given two shapes
X and Y, both containing N points, let:
Topt (X,Y ) = argmin DX,Y (T ),

(1)

T :X→Y

where DX,Y (T ) is some measure of distortion of distances
introduced by T , and the minimization done is over all bijections. Several measures of distortion, have been proposed
in the literature, but perhaps the most common one is the L p

1506

Ovsjanikov et al. / A Condition Number for Non-Rigid Shape Matching

norm on the difference of pairwise distances:
p

DX,Y (T ) =

∑

dX (x, x ) − dY (T (x), T (x ))

p 1/p

, (2)

x,x ∈X

where p is commonly set to be 1, 2 or ∞. In the latter
case: D∞
X,Y (T ) = maxx,x ∈X dX (x, x ) − dY (T (x), T (x )) .
Note that for finite metric spaces with the same number of points, the Gromov-Hausdorff distance d GH (X,Y ) =
1 ∞
2 DX,Y (Topt ), where Topt is the bijection that minimizes
D∞
X,Y [Mém07]. Note also that finding a map T that minimizes D p for any fixed p and arbitrary finite metric spaces is
NP-hard, as it includes the metric Traveling Salesman Problem as a special case. This can be shown by a simple modification of the proof in [BCPP98].
Given a distortion measure DX,Y (T ), we define Topt (X,Y ) as
the map between X and Y that minimizes DX,Y (T ). There
is an important subtlety of what happens when multiple Topt
exist with the same distortion. We will treat this question
separately, when we define the condition number below.
In order to quantify the distortion of Topt (X,Y ) under perturbations of Y , we will also need a way to measure distances
between maps T1 and T2 : X → Y . Here we use a similar L p
norm formulation:
d p (T1 , T2 ) =

∑ (dY (T1 (x), T2 (x))) p

1/p

(3)

identity map under perturbations of X. If the identity map
remains optimal after a perturbation of X, then κ(X) will be
small, and conversely, if a small perturbation of X alters the
˜ and takes it very far away from the
optimal map Topt (X, X)
identity, then κ(X) will be large.
Discussion Note that the condition number κ(X) captures
the worst-case behavior of matching a shape to its deformed
˜ any algorithm that tries to optimize
copy. Given X and X,
DX,X˜ (T ) is susceptible to uncertainty in the knowledge of
˜ Specifically, if all that is known about X and X˜ is pairX.
wise distances (or quantities derived from them such as the
Laplace-Beltrami operator), then any uncertainty in the distances will result in uncertainty in the optimal map found by
the algorithm. For a shape X, the condition number measures
˜
the worst case behavior in terms of X.
Note that in many cases some information, such as landmark
correspondences is known, or could potentially be specified
by the user. Such external information could improve the stability of isometric shape matching. We can incorporate this
information into the definition of κ(X) by modifying the definition of the optimal map Topt . Rather than optimizing over
all maps in Equation 1, we can restrict the choice to only
those maps that satisfy the known constraints. We exploit
this fact when we use our definition for computing landmark
correspondences in Section 6.

x∈X

Now suppose X˜ is a deformed version of X. For example, X˜
is the information we have about X due to acquisition and
representation error. Since X˜ is a deformed version of X, we
˜ : X → X.
˜ In
will assume that there is a natural bijection Id
˜ , where Id
˜ is
˜ Id
other words, we can think of X˜ as a pair X,
˜ When X is represented through
a canonical map from X to X.
a matrix of distances, we can think of X˜ as a matrix of the
˜ given as the natural identity corresponsame size with Id
dence between the rows and columns.
One way to measure the distortion between X˜ and X is via
the Gromov-Hausdorff distance. However, our task is made
easier since X˜ is a deformation of X and we have the canon˜ In this case, we can simply use:
ical map Id.
˜
˜ = D ˜ (Id),
d(X, X)
X,X
˜ is one of the distortion measures above.
where DX,X˜ (Id)
Given these measures, we define the condition number of X:
˜ Topt (X, X)
˜
d Id,
κ(X) = sup
.
˜
d(X,
X)
X˜

(4)

Note that if multiple Topt exist with the same distortion, we
take the one that leads to the highest κ(X).
We call κ(X) the condition number of X. Intuitively, the condition number will be large if a small change in X can trigger
a large change in the optimal map. In particular, the condition number measures the difficulty of finding the canonical

4.1. Condition number and Symmetry
One disadvantage of the notion of condition number intro˜
duced above is the optimization over all possible shapes X,
making it hard to estimate in practice. Intuitively, however,
the difficulty of matching a shape must be already encoded
in the shape itself. For example, if κ(X) = ∞, this means
that the shape X admits a non-identity map with 0 distortion.
In other words, X is symmetric. Thus κ(X) = ∞ if and only
if X has a perfect symmetry.
To capture this intuition, we introduce another quantity,
which is closely related to the shape condition number, that
we call the global symmetry score, and which will allow us
to relate the shape condition number to its symmetry structure. Given a compact shape X, we define its global symmetry score σ(X) as:
d(T, Id)
σ(X) = sup
,
(5)
T :X→X DX,X (T )
where T again varies over all bijections X → X. Intuitively,
σ(X) is attained for the self-map T that is as far as possible
from the identity while introducing the least possible distortion. Note that if X is perfectly symmetric and admits a
non-identity map with zero distortion, then σ(X) = ∞.
The main result of this section is the following Theorem,
which relates σ(X) with κ(X):
Theorem 4.1 For any finite shape X and the L p distortion
measures introduced above, σ(X) ≤ κ(X) ≤ 2σ(X) + 1.
c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

1507

Ovsjanikov et al. / A Condition Number for Non-Rigid Shape Matching

Proof: See Appendix.
Moreover, the following Lemma shows that when X and X˜
are isometric, then σ(X) = κ(X).
Lemma 4.2 A necessary and sufficient condition for κ(X) =
σ(X), is that the condition number κ(X) is achieved by a
˜ = 0.
shape X˜ that is isometric to X, i.e.: DX,X˜ (Topt (X, X))
Proof: See Appendix.
The two results above show that the difficulty of shape
matching, when measured by the stability of the optimal solution is intimately related to the symmetry structure of the
shape. This is also intuitively clear since a highly symmetric
shape will have several equally good maps when mapped to
another shape, and conversely a highly unstable shape must
have near-isometric self-maps that are far from identity.
4.2. Computing The Global Symmetry Score
Given a shape X, represented as a symmetric matrix of pairwise distances between points, our goal is to estimate its
global symmetry score σ(X). Moreover, we will assume that
both DX,X (T ) and dX (T, Id) are given by the L2 norm as
defined in Equations 2 and 3 above.
To estimate σ(X), we use a construction similar to the one by
Leordeanu and Hebert [LH05]. Namely, for a shape X represented by a finite collection of N points, let A be a matrix
of size N 2 × N 2 , where rows and columns represent pairs
2
of points, and A((x, x ), (y, y )) = dX (x, x ) − dX (y, y ) .
Moreover, let B be a diagonal matrix of the same size as
A, and B((x, x )) = dX (x, x )2 . Then, if λ0 and λmax are the
smallest and largest eigenvalues of the generalized eigenvalue problem Ax = λBx, we have: √ 1 ≤ σ(X) ≤ √1 .
λmax

λ0

2

To see this, note that every N -size vector x can be interpreted as a set of correspondences, by representing it in matrix form, taking blocks of N entries from x for each row. In
particular, if x is a binary vector and in its matrix representation every row and every column contain exactly one 1, then
x represents a bijection. Thus, using the Rayleigh quotient:
1
xT Bx
xT Bx
≥
sup
= sup T
T
λ0
x x Ax
x∈ bijections x Ax
= sup
T :X→X

= sup
T :X→X

∑ d(x, T (x))2
2
∑ (d(x, x ) − d(T (x), T (x ))
d 2 (T, Id)
= σ2 (X).
D2X,X (T )

The lower bound is established similarly. One consequence
of this result is that using Theorem 4.1 we can bound the
condition number of X simply as κ(X) ≤ 2 √1 + 1. Such a
λ0
bound is useful when e.g. selecting a set of landmark correspondences that would reduce the condition number. Note
that a similar algorithm for symmetry detection was recently
c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

proposed by Chertok and Keller [CK10], although importantly the authors did not use the normalizing matrix B.
The lower bound, on the other hand, albeit much looser, is
useful since it bounds the stability of any shape matching algorithm that tries to match X by optimizing a distortion measure D, while using only intrinsic quantities (i.e. distances
and their derived quantities, such as the Laplace-Beltrami
operator) without prior knowledge on the alignment.
Let us note that while the eigenvalue upper bound σ(X) ≤
1/ λ0 is conceptually useful, in practice we observed that it
is often too loose because it substitutes vectors representing
bijections with arbitrary N 2 -vectors. Thus, we use a quasiconvex optimization method to estimate σ(X) as follows:
given matrices A and B as above, we use binary search to
iteratively check whether xT Bx − λxT Ax ≤ 0 for a fixed λ
is feasible or not. To check the feasibility, we use the linear
programming relaxation technique which is frequently used
in solving Markov Random Fields [WJW05]. The basic idea
is to let Y = xxT such that the constraint xT Bx − λxT Ax ≤ 0
is linear in Y . Then we relax Y = xxT by the marginalization
constraints. We refer the reader to [WJW05] for exact details
of this approach.
5. Condition number for deformation-based matching
As mentioned in the introduction, another class of methods
for matching two shapes X and Y aims at deforming X to
align it as well as possible with Y under some deformation penalty e.g. [LSP08, HAWG08, ZSCO∗ 08, WAO∗ 09].
In this formulation, the output of a shape matching method
is a set of deformation parameters P that minimize some energy EX,Y (P). For example, P may consist of 3n variables,
each corresponding to a displacement of a point of X along
one of the 3 coordinate axes. The goal of the matching algorithm is then to find a displacement P that would minimize
the energy EX,Y (P). Note that in this scenario the majority
of methods use numerical optimization techniques to find a
local minimum of EX,Y (·).
To define the condition number and the symmetry score in
this setting, we will need a way to measure distances in the
deformation parameter space as well as distances between
shapes. Here we will assume that P can be represented as a
vector of deformation parameters, and that when a shape X
is matched against itself EX,X (0) = 0 is a global minimum
of the energy function. In other words, we assume that for a
non-deformed version of X, a vector of zeros leads to zero
distortion and EX,X (P) ≥ 0 for any P. We define the condition number, simply as:
κ(X) = sup
X˜

d(Popt , 0)
,
˜
d(X, X)

where Popt = argmin EX,X˜ (P), and if several deformations
exist that lead to the same error, we pick the one that maxi˜ is not
mizes κ(X). The exact nature of the distance d(X, X)

1508

Ovsjanikov et al. / A Condition Number for Non-Rigid Shape Matching

crucial in our setting. However, we will assume that it has the
following form: if X˜ = X(P), i.e. if X˜ is obtained by deform˜ ≤ EX,X (P). This is
ing X according to P, then d(X, X)
motivated by the fact that the deformation energy is usually
the sum of the squares of both pairwise distances between
points and some additional terms related to deviation from
rigidity. Moreover, we will assume that if X˜ = X(P) then P
is among the global minima of EX,X˜ (·).
To define the symmetry score, we simply use:
d(P, 0)
σ(X) = sup
.
EX,X (P)
P
Similarly to above, we have:

(6)

Lemma 5.1 For any shape X, σ(X) ≤ κ(X).
Proof Under the above assumptions, the proof is straightforward: given deformation parameters P, construct a shape
X˜ = X(P). Then note that P must be among the global min˜ ≥ EX,X (P) by assumpima of EX,X˜ and moreover d(X, X)
d(P,0)
tion. Therefore, √
≤
E(P)

d(P,0)
˜
d(X,X)

was a 6-dimensional vector corresponding to a linearization
of translation and rotation, and the deformation energy was
the point-to-plane ICP metric [CM92]. Gelfand et al. then
used the condition number of the Hessian of the deformation energy as a measure of stability of ICP. This number is
simply the ratio of the largest and smallest eigenvalues. The
difference of their definition from ours simply comes from
the fact that our notion of stability is absolute rather than relative, which is reasonable since we are only considering the
solutions around identity (a relative measure would also be
unclear for correspondence-based matching since it would
require us to define a norm of a map). Note, however, that
qualitatively the two notions behave similarly, and e.g. tend
to ∞ for rank-deficient matrices, which correspond to selfsymmetric (in the rigid case, slippable [GG04]) shapes. Note
also that spectral analysis of a deformation energy’s Hessian
has been used for shape analysis in the works of of Hildebrandt [HSvTP10] and Huang [HWAG09] among others.

≤ κ(X). Since this holds

for any P, the result follows.

6. Landmark selection

Note that the symmetry score σ(X) measures the worst-case
behavior for any set of deformation parameters P. However,
in many settings, methods that use a deformation penalty aim
at finding local minima of the deformation energy. In this
case, to measure the stability of a local minimum, we need
to restrict our attention to only infinitesimal deformations:
d(P, 0)
σinf = lim sup
.
ε→0 d(P,0)<ε
EX,X (P)

One of the main applications for the notions of stability introduced above is finding ways in which stability can be improved in practice. Note that the condition number gives a
lower bound on the stability of any method used to match
a given shape using only its metric structure. However, in
many cases additional information may exist that can be
used during matching. The most common strategy of introducing information for shape matching is by using landmark correspondences, which can be either specified by
the user or precomputed separately. Thus, when performing
shape matching the set of allowable shape deformations or
maps is restricted to only those that preserve known landmark correspondences. Note that even a few landmark correspondence can often greatly constraint the space of possible solutions and potentially improve stability significantly
[LF09, OMMG10]. However, with the notable exception of
the work of Tevs et al. [TBW∗ 11] the optimal placement of
landmark correspondences for shape matching has received
little attention.

Note that unlike the global version of the symmetry score,
its local counterpart can be thought as quantifying the certainty that a particular solution is indeed a local minimum,
and is closely related to the slippage analysis of Gelfand et
al. [GG04]. The two measures are complimentary and can be
used together to measure the difficulty of shape matching.
5.1. Computation of Local Symmetry Score
Interestingly, if d(P, 0) is measured as the L2 norm
of the vector P, i.e. d(P, 0) = P 2 = (∑ Pi2 )1/2 just
like the computation of the global symmetry score for
correspondence-based matching in Section 4.2, the computation of σinf reduces to an eigenvalue problem. Namely,
σinf = 2/ λmin (H), where H is the Hessian matrix of the
deformation energy EX,X evaluated at 0.
To see this simply note that locally: EX,X (P) = EX,X (0) +
∇EX,X (0) · P + 12 PT H P + o( P 2 ). Since E(0) = 0, and
E(P) ≥ 0 by assumption, meaning ∇EX,X (0) = 0, we get, up
to third order: EX,X (P) = 12 PT H P + o( P 2 ). Therefore:
2 P
=
σin f = sup √
PT HP
P

2
λmin (H)

.

Relation to prior work: Note that Gelfand et al. [GIRL03]
used a similar notion as a measure of stability of the ICP algorithm. In their work, the deformation parameters P = (c c)
¯

Our stability measures and especially the symmetry score
provide a general way to compute landmark points on a
shape in order to improve stability of shape matching. In
the definition of the symmetry score Equations 5 and 6,
adding landmark correspondences would mean restricting
the search to only those maps T and those deformation parameters P that fix the known landmark points. Note that the
symmetry score can only become smaller with addition of
constraints on the space of solutions.
In practice when computing the symmetry score using the
methods in Section 4.2 or Section 5.1 (in the case where P
represents displacements of points) adding landmark correspondences simply translates into removing the corresponding rows and columns from the matrices before performing
the eigen-decomposition.
c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

1509

Ovsjanikov et al. / A Condition Number for Non-Rigid Shape Matching

(a) 202.1

(b) 423.1

(c) 561.1

(d) INF

Figure 3: Symmetry score σ(X) computed on four near-symmetric
shapes. Note that the fish has an approximate reflectional symmetry
(in the undeformed state), as does the hand.

To find the optimal landmark points, we must therefore find
those points such that after removing the corresponding rows
and columns the symmetry score decreases the most, or,
equivalently, the smallest eigenvalue increases the most.
To implement this idea, we use a greedy sampling strategy
that evaluates for each point on the shape the reduction of
the symmetry score if this point is fixed. We then sample
the points that lead to the greatest reduction in the symmetry score. In the following section we illustrate this general method on two types of techniques for shape matching,
which are most useful for global and local search respectively. In all of the examples below we compute landmark
samples using the isometric correspondence-based matching
using the L2 norm as described in Section 4.2. We call this
method Condition Number Based Sampling (CNBS). We
emphasize that CNBS is not a feature detection method and
its goal is not to find the most repeatable landmark points
that are easy to identify and match on copies of the shape.
Rather, our goal is to find those points such that if their correspondences are known then the shape matching problem
becomes easiest. This is especially useful when the correspondences are provided by a user, and our goal is to minimize manual effort, before the matching problem is sufficiently easy to be solved automatically. Note also that by
introducing landmark points we get a more refined measure
of shape matching difficulty. Indeed, by concatenating the
scores after adding landmark points, we obtain a vector of
symmetry scores for each shape, which could be used to e.g.
distinguish between symmetric shapes such as a human and
a sphere which initially have infinite symmetry scores.
7. Results
We first illustrate the relevance of the notion of the symmetry score σ(X) for near-symmetric shapes. Figure 3 shows
the computed symmetry scores on four shapes with progressively more pronounced symmetries, ending with the horse
shape which is perfectly symmetric. Here and in all of the
experiments below we first sub-sampled the shapes using
Farthest Point Sampling (FPS) to only include 400 points,
and computed the symmetry score using the L2 norm of the
geodesic distortion as described in Section 4.2. Note that
although in theory our relaxation provides only an upper
c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

(a) David

(b) Dog

Figure 4: Heat maps showing the improvement in the symmetry
score after fixing landmarks at different points on the shape. Blue to
red corresponds to little to high improvement in the symmetry score
for the David (a) and Dog (b) models in the TOSCA dataset.
bound on the symmetry score, in practice it follows very
closely the near-symmetry structure of the shape. For a perfectly symmetric horse shape the symmetry score σ(X) = ∞
as expected, while for near symmetric hand (which has an
approximate front-back as well as reflectional symmetries),
fish (which represents a bending of a perfectly symmetric
shape) and foot shapes, the symmetry score decreases.
In the rest of this section we illustrate the performance of
our Condition Number Based Sampling (CNBS) for landmark selection. As described in Section 6 our method is
greedy and selects landmarks by considering the decrease
in the symmetry score after the landmark point is fixed during the computation of σ(X). Figures 1 and 4 show this improvement in the symmetry score for different points on the
Cat, David and Dog shapes taken from the TOSCA dataset
[BBK08]. As expected, landmark points close to the symmetry axis of the shape introduce little if any improvement in
the symmetry score and by extension the condition number.
Figure 5 also shows the first landmark as picked by the FPS,
the Planned Landmark Selection by Tevs et al. [TBW∗ 11],
and our Condition Number Based Sampling. In an attempt to
reduce randomness in FPS, here and in all of the evaluation
below, we always selected the farthest point form a random
point as the initial landmark in FPS.
Evaluation and comparison with prior work To evaluate
our landmark selection method, we compare it with the standard Farthest Point Sampling (FPS) and the Planned Landmark Sampling (PLS) method of Tevs et al. [TBW∗ 11]. Our
goals are two-fold: to compare the stability properties of the
landmark selection methods as measured by the symmetry
score and to demonstrate that the symmetry score provides a
useful measure for the “hardness” of matching the shapes.
For this, we evaluate landmark selection methods using two
criteria: first we compute the symmetry score of the shapes
after introducing the landmarks using the method described
in Section 4.2. Then, we use these sample points as landmark correspondences between pairs of shapes within the
same class of deformed models, and use the spectral matching approach of Leordeanu and Hebert [LH05] to discover
the remaining correspondences. To evaluate the matchings,

1510

Ovsjanikov et al. / A Condition Number for Non-Rigid Shape Matching

we measure the average distance of the computed correspondences from the ground truth across all shapes in the class.
In this experiment, we used 8 classes of shapes from the
TOSCA dataset of Bronstein et al. [BBK08]. Within each
class, we used the undeformed (null) shape to compute the
landmark points and evaluate the symmetry score. We then
matched the null shape against each remaining shape in the
class using the selected points as landmark correspondences
and spectral matching of Leordeanu and Hebert [LH05]. To
evaluate the matching, we measured the average (across all
matchings of null shape to other shapes in the same class)
geodesic distance of the computed correspondences from
the ground-truth ones (note that shapes within a class in the
TOSCA dataset contain the same number of points with corresponding vertices given by vertex id). The landmarks on
the null shapes were computed by the authors of [TBW∗ 11].
Figure 6 shows the landmark points selected by Farthest
Point Sampling (FPS), Planned Landmark Sampling (PLS)
and our (CNBS) method on 6 null shapes. The red points
correspond to the first three landmarks, while the green ones
represent the remaining landmarks. We used the same number of landmark points as provided by Tevs et al. and this
number is reported in the leftmost column of Figure 7a.
The table in Figure 7a shows the estimate of the symmetry
score after adding one, three and all landmark points on each
null shape, the maximum number being defined by PLS.
Note that the first landmark selected by PLS is computed
by only comparing descriptor values. Thus it may not reduce
the symmetry score significantly. Indeed, Figure 5 shows the
first landmark point on the cat shape for the three sampling
strategies. The first point picked by PLS lies close to the
symmetry axis thus not reducing the symmetry score significantly. However, with 3 landmark points, both PLS and
our method significantly outperform FPS, while for a larger
number of landmarks all methods seem to have comparable
performance.
The table in Figure 7b, shows the performance of spectral
matching [LH05] after fixing 3 and all landmark points. In
particular, we compute dense correspondences and measure
the average geodesic distance of the computed correspondences to the ground-truth in percent of the half-diameter of
the shape. Note that we averaged this distance over matchings from the null shape to each shape in a given class, which
roughly simulate a set of noisy deformations of the null
shape. Note that, as predicted, the symmetry score shown
in 7a correlates very well with the average error in 7b. In
other words, for shapes and landmarks with high symmetry
score, the average error also increases, which suggests that
the symmetry score and by extension the condition number are meaningful measures for the hardness of matching
a shape. Therefore, based on these preliminary results, we
conclude that 1) the condition number is consistent with the
matching error, 2) our method is comparable to or slightly
better than PLS and both methods are better than FPS, and
3) with more samples, these methods tend to be identical.

Figure 5: First landmark selected by FPS (yellow), PLS [TBW∗ 11]
(red) and our method (blue). Note the proximity of the red and yellow points to the symmetry axis .

8. Conclusion & Future Work
In this paper, we have analyzed the stability of shape matching for a fixed distortion measure and showed that it can be
captured by a notion called the shape condition number. We
also showed that the condition number is closely related to a
simpler measure which we called the shape symmetry score.
We demonstrated ways in which the condition number can
be estimated in practice, and described how the computation
can be used to guide to the selection of landmark points to
improve stability of shape matching.
A major limitation of our analysis is that it does not address partial shape matching, which can result in energy
landscapes with comparable local minima in the absence of
shape symmetries. Analyzing stability of partial shape shape
matching is an important and challenging problem for future work. Similarly, we are interested in analyzing different
matching methods for their stability with respect to the lower
bound provided by the condition number, and extending stability analysis of other problems beyond shape matching.
Acknowledgments This work was supported by NSF
grants CCF 1011228, a KAUST-Stanford AEA grant, and
a Stanford Graduate Fellowship. We also thank the anonymous reviewers for the valuable comments and suggestions.
References
[BBB∗ 10] B RONSTEIN A. M., B RONSTEIN M. M., B USTOS
B., C ASTELLANI U., C RISTANI M., FALCIDIENO B., G UIBAS
L. J., ET AL .: SHREC’10 Track: Feature detection and description. In Proc. 3DOR (2010), pp. 79–86. 2
[BBK06] B RONSTEIN A., B RONSTEIN M., K IMMEL R.: Generalized multidimensional scaling: a framework for isometryinvariant partial surface matching. PNAS 103, 5 (2006), 1168–
1172. 2, 3
[BBK08] B RONSTEIN A., B RONSTEIN M., K IMMEL R.: Numerical Geometry of Non-Rigid Shapes. Springer, 2008. 7, 8
[BCPP98] B URKARD R., C ELA E., PARDALOS P., P ITSOULIS
L.: The quadratic assignment problem. Handbook of Combinatorial Optimization (1998), 241–338. 4
[BM77] B OYER R. S., M OORE J. S.: A fast string searching
algorithm. Commun. ACM 20 (October 1977). 3
[CK10] C HERTOK M., K ELLER Y.: Spectral symmetry analysis.
IEEE Trans. PAMI 32, 7 (2010), 1227–1238. 5
[CM92] C HEN Y., M EDIONI G.: Object modelling by registration of multiple range images. Image Vision Comput. 10 (1992),
145–155. 2, 6

c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

1511

Ovsjanikov et al. / A Condition Number for Non-Rigid Shape Matching

Figure 6: Landmark points selected by Farthest Point Sampling (top), method of Tevs et al. [TBW∗ 11] (middle) and our method (bottom).
The points marked in red are the first 3 landmarks, while the points in green are the remaining landmarks.

Horse
Victoria
Michael
David
Dog
Centaur
CAT
Wolf

One Landmark
FPS
PLS CNBS
40.6
Inf
17.3
58.2
58.2
11.8
80.1
56.4
19.1
57.5
43.9
12
Inf
53.8
12.3
Inf
28.2
14.5
Inf
46.2
23.5
266.1
25.2
11.2

Three Landmarks
FPS
PLS
CNBS
21.1
15.9
13
9.4
7.4
6.3
9
7.6
6.1
11.02
10.15
5.1
20.46
6.31
7.2
12.74
8.51
7.77
15.21
8.87
10.22
5.82
4.51
4.64

FPS
8.1
4.7
5
6.49
5.28
7.9
6.56
2.74

All Landmarks
PLS CNBS # pts
7.5
7.8
14
3.8
3.7
13
4.7
4.8
16
5.6
4.2
15
5.44
5.57
12
6.38
5.43
7
6.51
6.42
7
2.71
2.56
5

(a) Estimates of the symmetry score after adding landmark correspondences

Three Landmarks
FPS
PLS CNBS
1.8
1.36
1.06
0.76
0.57
0.48
0.71
0.62
0.54
0.87
0.77
0.4
1.55
0.64
0.61
1.01
0.64
0.71
1.27
0.81
0.84
0.48
0.37
0.37

All Landmarks
FPS
PLS CNBS
0.66
0.64
0.61
0.39
0.34
0.33
0.42
0.4
0.39
0.58
0.44
0.31
0.47
0.46
0.43
0.59
0.51
0.52
0.56
0.54
0.54
0.23
0.22
0.21

(b) Dense correspondence accuracy

Figure 7:

(a) Estimates of the symmetry score after fixing one, three and all landmarks using Farthest Point Sampling (FPS), Planned
Landmark Sampling (PLS) [TBW∗ 11], and our CNBS method. The total number of landmarks fixed is shown in the last column. Note that the
first landmark in PLS is chosen using only point descriptor comparison, (b) Average distance of the dense correspondences to the ground-truth
(in percent of half-diameter of the shape), after applying spectral matching [LH05] to obtain dense correspondences from sparse ones.
[GG04] G ELFAND N., G UIBAS L.: Shape segmentation using
local slippage analysis. In Proc. SGP (2004), pp. 219–228. 2, 6

[GIRL03] G ELFAND N., I KEMOTO L., RUSINKIEWICZ S.,
L EVOY M.: Geometrically stable sampling for the ICP algorithm. In 3DIM (2003). 2, 6
[HAWG08] H UANG Q.-X., A DAMS B., W ICKE M., G UIBAS
L. J.: Non-rigid registration under isometric deformations. CGF
(Proc. SGP) 27, 5 (2008), 1449–1457. 2, 5

[KS04] K RAEVOY V., S HEFFER A.: Cross-parameterization and
compatible remeshing of 3d models. In Proc. of SIGGRAPH
(2004), pp. 861–869. 1
[LF09] L IPMAN Y., F UNKHOUSER T.: Möbius voting for surface correspondence. In Proc. of SIGGRAPH (2009), vol. 28:3,
pp. 72:1–72:12. 2, 3, 6
[LH05] L EORDEANU M., H EBERT M.: A spectral technique for
correspondence problems using pairwise constraints. In Proc. of
ICCV (2005), pp. 1482–1489. 5, 7, 8, 9

[HSvTP10] H ILDEBRANDT K., S CHULZ C., VON T YCOWICZ
C., P OLTHIER K.: Eigenmodes of surface energies for shape
analysis. In Advances in Geometric Modeling and Processing (2010), vol. 6130 of Lecture Notes in Computer Science,
Springer, pp. 296–314. 6

[LPC∗ 00] L EVOY M., P ULLI K., C URLESS B., RUSINKIEWICZ
S., KOLLER D., P EREIRA L., G INZTON M., A NDERSON S.,
DAVIS J., G INSBERG J., S HADE J., F ULK D.: The digital
Michelangelo project: 3D scanning of large statues. In Proc. SIGGRAPH (2000), pp. 131–144. 1

[HWAG09] H UANG Q., W ICKE M., A DAMS B., G UIBAS L.:
Shape decomposition using modal analysis. Computer Graphics Forum 28, 2 (2009), 407–416. 6

[LSP08] L I H., S UMNER R. W., PAULY M.: Global correspondence optimization for non-rigid registration of depth scans.
CGF (Proc. SGP’08) 27, 5 (2008). 2, 5

[KMP77] K NUTH D. E., M ORRIS J., P RATT V. R.: Fast pattern
matching in strings. SIAM Journal of Computing 6, 2 (1977),
323–350. 3

[Mém07] M ÉMOLI F.: On the use of Gromov-Hausdorff Distances for Shape Comparison. In Symposium on Point Based
Graphics (2007), pp. 81–90. 4

[KMP07] K ILIAN M., M ITRA N. J., P OTTMANN H.: Geometric
modeling in shape space. In Proc. SIGGRAPH (2007), pp. 64:1–
64:8. 1

[MGPG04] M ITRA N. J., G ELFAND N., P OTTMANN H.,
G UIBAS L.: Registration of point cloud data from a geometric
optimization perspective. In Proc. SGP (2004), pp. 23–31. 2

c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.

1512

Ovsjanikov et al. / A Condition Number for Non-Rigid Shape Matching

[MS05] M ÉMOLI F., S APIRO G.: A theoretical and computational framework for isometry invariant recognition of point
cloud data. Found. Comput. Math. 5, 3 (2005). 2, 3
[MV98] M AINTZ J., V IERGEVER M. A.: A survey of medical
image registration. Medical Image Analysis 2 (1998), 1 – 36. 1
[OMMG10] OVSJANIKOV M., M ERIGOT Q., M EMOLI F.,
G UIBAS L.: One point isometric matching with the heat kernel.
CGF 29, 5 (2010), 1555–1564. 2, 6
[RBBK07] R AVIV D., B RONSTEIN A., B RONSTEIN M., K IM MEL R.: Symmetries of non-rigid shapes. In Proc. NRTL (ICCV)
(2007), pp. 1 –7. 2
[RPSS10] RUGGERI M. R., PATANÈ G., S PAGNUOLO M.,
S AUPE D.: Spectral-driven isometry-invariant matching of 3d
shapes. IJCV (2010), 248–265. 2
[SCF10] S UN J., C HEN X., F UNKHOUSER T.: Fuzzy geodesics
and consistent sparse correspondences for deformable shapes.
CGF (Proc. SGP) 29, 5 (2010). 2
[SOG09] S UN J., OVSJANIKOV M., G UIBAS L.: A Concise and
Provably Informative Multi-Scale Signature Based on Heat Diffusion. CGF (Proc. SGP) 28, 5 (2009). 2
[TB97] T REFETHEN L. N., BAU D.: Numerical Linear Algebra.
SIAM: Society for Industrial and Applied Mathematics, 1997. 3
[TBW∗ 09]

T EVS A., B OKELOH M., WAND M., S CHILLING A.,
S EIDEL H.-P.: Isometric registration of ambiguous and partial
data. In Proc. CVPR (2009), pp. 1185–1192. 2, 3

[TBW∗ 11] T EVS A., B ERNER A., WAND M., I HRKE I., S EIDEL
H.-P.: Intrinsic shape matching by planned landmark sampling.
In Proc. Eurographics (2011), p. to appear. 3, 6, 7, 8, 9
[WAO∗ 09] WAND M., A DAMS B., OVSJANIKOV M., B ERNER
A., B OKELOH M., J ENKE P., G UIBAS L., S EIDEL H.-P.,
S CHILLING A.: Efficient reconstruction of nonrigid shape and
motion from real-time 3d scanner data. ACM Trans. Graph. 28
(May 2009), 15:1–15:15. 2, 5
[WJW05] WAINWRIGHT M. J., JAAKKOLA T., W ILLSKY A. S.:
Map estimation via agreement on trees: message-passing and linear programming. IEEE Transactions on Information Theory 51,
11 (2005), 3697–3717. 5
[ZSCO∗ 08] Z HANG H., S HEFFER A., C OHEN -O R , Z HOU Q.,
VAN K AICK O., TAGLIASACCHI A.: Deformation-driven shape
correspondence. In Proc. SGP (2008), pp. 1431–1439. 2, 5

9. Appendix
Proof of Theorem 4.1 Throughout this proof we will assume that DX,Y and dX,Y are given as L p norms, according
to Equations 2 and 3 with the same p.
1. σ(X) ≤ κ(X)
Proof Our goal is to show that for any bijection T : X → X,
we can construct X˜ such that:
˜ Topt (X, X)
˜
d Id,
d(T, Id)
≤
.
˜
DX,X (T )
d(X, X)
For this, given T : X → X, we let X˜ be such that
˜
˜ )) = dX (T (x), T (x )). This implies:
dX˜ (Id(x),
Id(x
˜ = DX,X (T )
˜ = DX,X˜ (Id)
d(X, X)
˜ ◦
Moreover, note that the map S : X → X˜ defined as S = Id
T −1 has zero distortion since for all x, x :

˜ −1 (x )) = d ˜ S(x), S(x ) .
˜ −1 (x)), Id(T
dX (x, x ) = dX˜ Id(T
X
˜ S),
Therefore, S ∈ Topt (X, Y˜ ). Moreover, d(T, Id) = d(Id,
since for any x:
˜
˜
˜ −1 (x)) = d ˜ Id(x),
dX (T (x), x) = dX˜ Id(x),
S(x) .
Id(T
X
Therefore,
κ(X) ≥

˜ S
˜ Topt (X, X)
˜
d Id,
d Id,
d(T, Id)
.
≥
=
˜
˜
DX,X (T )
d(X, X)
d(X, X)

Since this holds for any T , κ(X) ≥ σ(X) as claimed.
2. κ(X) ≤ 2σ(X) + 1
˜ with
˜ Id)
Proof Given a shape X and its deformed version (X,
˜ our goal is to
˜ s.t. D ˜ (T ) ≤ D ˜ (Id)
a map T : X → X,
X,X
X,X
produce a map S : X → X such that:
˜ T
d(S, Id)
1 d Id,
1
≥
− .
˜
DX,X (S)
2 d(X, X)
2
˜ Then, note that:
For this, simply let S = T −1 ◦ Id.
−1
˜ = D ˜ (T ) + D ˜ (Id).
˜
DX,X (S) ≤ DX,X
) + DX,X˜ (Id)
˜ (T
X,X
X,X

Moreover,

˜ T ) − D ˜ (T ),
d(S, Id) ≥ d(Id,
X,X

since d(S, Id) and DX,X˜ (T ), are given by L p norms for
˜ T ) ≥ D ˜ (T ) (otherwise
the same p. Thus, assuming d(Id,
X,X
κ(X) ≤ 1 and the bound holds trivially), and using the triangle inequality on DX,X (S):
˜ T ) − D ˜ (T )
˜ T)
DX,X˜ (T )
d(Id,
d(Id,
d(S, Id)
X,X
≥
−
≥
˜
˜
˜
DX,X (S)
DX,X˜ (T ) + DX,X˜ (Id)
2DX,X˜ (Id)
2DX,X˜ (Id)
≥

˜
˜ T)
˜ T)
DX,X˜ (Id)
1 d(Id,
1
d(Id,
−
=
− .
˜
˜
˜
2
2DX,X˜ (Id) 2DX,X˜ (Id) 2 DX,X˜ (Id)

Proof of Lemma 4.2
Proof We first prove necessity: suppose κ(X) = σ(X). Let
Sopt be the self-map that achieves σ(X), and X˜ be such that:
˜
˜ )) = dX (Sopt (x), Sopt (x )), and the map T2 :
dX˜ (Id(x),
Id(x
˜ T2 = T˜ ◦ S−1 . Then, T2 achieves zero distortion and
X → X,
moreover, since
˜
˜
˜ Id)
d(Topt (X, X),
d(T2 , Id)
κ(X) ≥
≥
= σ(X),
˜ X)
˜ X)
d(X,
d(X,
and we are given that κ(X) = σ(X), the inequalities are
equalities and κ(X) is achieved by X˜ and the isometry T2 .
To prove sufficiency, suppose that κ(X) is achieved by a
shape X˜ and a map T : X → X˜ such that DX,X˜ (T ) = 0. Then,
˜ Since T has
consider the map S : X → X, S = T −1 ◦ Id.
zero distortion: dX (S(x), S(x )) = dX˜ (T (S(x)), T ((x ))) =
˜
˜ )) ∀ x, x ∈ X. Thus: DX,X (S) = D ˜ (Id).
˜
dX˜ (Id(x),
Id(x
X,X
˜
Similarly: dX (S, Id) = d(Id, T ). Therefore, S is such that,
d(S,Id)

κ(X) = D (S) , which implies, using Lemma 4.1, that
X,X
κ(X) = σ(X).

c 2011 The Author(s)
c 2011 The Eurographics Association and Blackwell Publishing Ltd.


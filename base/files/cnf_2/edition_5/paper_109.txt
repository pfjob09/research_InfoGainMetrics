DOI: 10.1111/j.1467-8659.2011.01953.x
Eurographics / IEEE Symposium on Visualization 2011 (EuroVis 2011)
H. Hauser, H. Pfister, and J. J. van Wijk
(Guest Editors)

Volume 30 (2011), Number 3

Anatomy-Guided Multi-Level Exploration of Blood Flow in
Cerebral Aneurysms
Mathias Neugebauer†1 , Gabor Janiga2 , Oliver Beuing3 , Martin Skalej3 , Bernhard Preim1
1 Department

of Simulation and Graphics, University of Magdeburg, Germany
of Fluid Dynamics and Thermodynamics, University of Magdeburg, Germany
3 Department of Neuroradiology, University Hospital Magdeburg, Germany

2 Institute

Abstract
For cerebral aneurysms, the ostium, the area of inflow, is an important anatomic landmark, since it separates the
pathological vessel deformation from the healthy parent vessel. A better understanding of the inflow characteristics, the flow inside the aneurysm and the overall change of pre- and post-aneurysm flow in the parent vessel
provide insights for medical research and the development of new risk-reduced treatment options. We present an
approach for a qualitative, visual flow exploration that incorporates the ostium and derived anatomical landmarks. It is divided into three scopes: a global scope for exploration of the in- and outflow, an ostium scope that
provides characteristics of the flow profile close to the ostium and a local scope for a detailed exploration of the
flow in the parent vessel and the aneurysm. The approach was applied to five representative datasets, including
measured and simulated blood flow. Informal interviews with two board-certified radiologists confirmed the usefulness of the provided exploration tools and delivered input for the integration of the ostium-based flow analysis
into the overall exploration workflow.
Categories and Subject Descriptors (according to ACM CCS): I.3.6 [Computer Graphics]: Methodology and Techniques, Interaction Techniques—I.3.7 [Computer Graphics]: Three-Dimensional Graphics and Realism, Color,
Shading, Shadowing, and Texture—I.3.8 [Computer Graphics]: Applications—

1. Introduction
The diagnosis of vascular diseases benefits from the visualization of the vascular morphology and the internal blood
flow. As an example, the formation of cerebral aneurysms
is significantly influenced by the hemodynamic of the internal blood flow. Cerebral aneurysms represent a threatening
vascular disease that bears a high risk of rupture with often fatal consequences for the patient (fatality up to 52%).
Based on the patient-specific aneurysm anatomy, researchers
employ computational fluid dynamic (CFD) simulations and
4D PC-MRI flow measurement, to investigate the correlation between aneurysm morphology and blood flow patterns.
This research aims at gaining a deeper understanding of the
aneurysm growth, to evaluate the risk of rupture and develop
new treatment options by means of virtual stenting.
The exploration of 3D medical visualizations strongly
† mathias.neugebauer@ovgu.de
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

Figure 1: Anatomic features of parent vessel and ostium.

benefits from guidance based on anatomic features. The visualization can be focused on anatomically relevant information and a goal-directed interaction can be supported. We
present a multi-level exploration scheme where each level
takes advantage of anatomical features, extracted from the
vessel geometry (see Fig. 1). Thus, we are able to represent only the subset of the flow data that is potentially rele-

1042

Mathias Neugebauer et al. / Anatomy-Guided Multi-Level Exploration of Blood Flow in Cerebral Aneurysms

vant with respect to the aneurysm and provide constraints for
widget-based interaction. Due to the multi-level design, the
medical expert is able to gain an overview of the overall flow
characteristic before exploring details at anatomically meaningful regions. The main contributions of this paper are:
• Flow exploration at three scopes that integrates into an
workflow for the visual exploration of flow in aneurysms.
• An anatomy-guided seeding strategy and color schemes
for the streamline-based visualization of relevant flow, including slow-, fast-, in- and outflow characterization.
• A multi-parameter representation of the flow profile at the
ostium of the aneurysm.
• Anatomy-guided widgets that enable interactive exploration of local flow in the parent vessel and the aneurysm.

2. Related Work
The number of medical research applications that benefit from a qualitative exploration of flow fields is rising,
due to the increased availability of measured flow data and
hardware-driven cost and time reduction of computational
fluid dynamics (CFD) simulations. However, the primary
field of application is still the analysis of vascular diseases
by means of intravascular hemodynamics.
MRIView [Buo98] was one of the first applications towards the visual exploration of measured flow along cross
sections through a vessel, utilizing 4D PC-MRI. Improved
measurement and pre-processing techniques, presented by
Isoda et al. [IOKea10], allow to explore measured flow even
in the fine cerebral vasculature. Cebral et al. [CCA∗ 05] employ CFD studies on a broad range of patient-specific vessel reconstructions to investigate aneurysm formation and
to identify parameters for risk assessment. Among others
they employed visual side-by-side comparison of scalar data
mapped on the surface while Isoda et al. applied stream- and
particle tracing to visually explore the measured data. Visualization techniques for blood flow exploration can be categorized into dense approaches, that aim at representing a
complete flow field on a given subdomain, and tracing- or
feature-based approaches [PVH∗ 03]. Except for the separation into surface-near scalars and inner flow, the aforementioned visual exploration approaches do not define flow subdomains according to the anatomy. A definition of such subdomains requires some kind of anatomic reference system.
Piccinelli et al. [PVS∗ 09] present a framework for the geometric description of patient specific vessel surface models. It was applied to cerebral aneurysms to quantify the
angle between the aneurysm neck plane and the parent
artery bifurcation. Instead of a planar neck Neugebauer et
al. [NDSP10] extract anatomic landmarks to to reconstruct
the ostium, which separates the aneurysm from its parent
vessel. Chatziprodromou et al. [CBM∗ 03] utilize aneurysm
specific axis by employing cut planes that are orthogonal
to the central aneurysm axis and provide qualitative color-

and particle-based flow visualizations on those planes. In
[vPBB∗ 10] probing planes are positioned on the centerline
of the aortic artery. Streamlines seeded from these planes
and illustrative arrows are used to represent flow rates while
the surrounding vessel context is rendered in a toon-shading
style. Our anatomy-guided approach not only utilizes the
centerline and the intra-aneurysm axis but also the reconstruction of the ostium.
3. Data Pipeline
The anatomy-guided exploration of the aneurysm flow is
based on data such as the reconstructed vessel morphology
and the flow data. The flow data can be derived from CFD
simulations or direct measurement. The vessel morphology
is input for the CFD simulation and also used to derive the
needed anatomical features. How the anatomy-guided exploration is integrated into the overall workflow and what requirements need to be considered is described at the end of
this section.
3.1. Input Data
All data that is directly derived from scans, measurements
and simulations, is referred to as input data.
Vessel Morphology. As primary input data we have image slices either from Computed Tomography Angiography (CTA) or Magnetic Resonance Angiography (MRA).
Through the use of contrast agent or special sequences (e.g.
MRA: the Time-of-Flight sequence) the vessels bear high
contrast in both modalities. Thus, in cases with low noise
and artefact level, we employ thresholding for segmentation and Marching Cubes to generate a polygonal vessel surface. When the data quality is low, a deformable model is
used [LABFL09]. To ensure anatomical plausibility, the resulting surfaces where evaluated by our medical partners.
Simulated Flow Data. A CFD-compliant mesh is needed
as geometric input for the simulation. A high element quality is obtained by remeshing the surface that results from
Marching Cubes. We utilize an advancing front approach to
rebuild the mesh and optimize the quality by a combination
of metric and topological changes (for details see [Sch97]).
Concerning the tradeoff between accuracy and computation
time, we model the blood as Newtonian fluid with steady
flow and rigid walls. Cebral et al. [CCA∗ 05] have shown
that a qualitative flow characterization is still possible. The
border conditions (in-/outflow rate) are derived from medical
literature and validated by our medical partners. If measured
blood flow data is available, we derive the border conditions
from them.
Measured Flow Data. We obtain measured flow data
from time-resolved phase-contrast MRI (4D PC-MRI)
that encodes the flow direction and magnitude for each
voxel [MHBea07]. Measurement errors introduced by eddy
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Mathias Neugebauer et al. / Anatomy-Guided Multi-Level Exploration of Blood Flow in Cerebral Aneurysms

1043

the contour is bent by shifting P3 and P4 towards the parent vessel, for details see [NDSP10]. The bent contour and
a projection of the centerline into the ostium domain are the
input contours for an adapted bilinear interpolation approach
to generate a smooth surface [NP11] (see Fig. 3(a)).

Figure 2: Overall exploration workflow with application
examples. The step our approach belongs to is highlighted
in orange.

currents, noise, and velocity phase wraps are corrected in
an additional postprocessing step, for details see [HFSea11].
The measured data is sampled on a regular image grid
while the simulation results are represented on a hybrid
tetrahedron- prism grid. These grids form the input for the
visual flow representation.
3.2. Anatomic Features
The relevant anatomic features are derived from the surface
representation of the aneurysm and its parent vessel (Fig. 1).
Parent Vessel Centerline. Rather than deriving the centerline from image-based skeletonization it is directly calculated from the polygonal surface mesh. Thus, it does not include shape artifacts induced by the uniform sampling of the
underlying image data. With their vessel modeling toolkit
(VMTK), Piccinelli et al. [PVS∗ 09] introduced a robust implementation of the Voronoi diagram-based calculation of
the centerline. When passing below the aneurysm, the centerline tends to deviate into the aneurysm. Thus, the unreliable part below the aneurysm was identified and replaced
by a cubic Lagrange polynomial that has the four points at
the end pieces of the original centerline as control points
[NP11].
Ostium Plane. The ostium, the area of inflow into the
aneurysm, is an important anatomical feature, since it separates the aneurysm from the parent vessel. Additional
anatomic descriptors like the central aneurysm axis can be
derived from it. From expert interviews we learned that the
ostium plane can be described by four control points on the
aneurysm surface. Thus, to reconstruct the ostium, these four
control points need to be identified. First, the distance between centerline and surface is used to estimate the dome
point of the aneurysm. To restrict the search space for the
first two control points, the centerline is projected on the
surface towards the estimated dome point. A distance analysis between projected and original centerline is applied to
identify the location of the first two control points (P1 , P2 ).
Incorporating these locations, an initial, planar ostium contour is created and the remaining two control points (P3 , P4 )
are placed on this contour, in between P1 and P2 . Finally,
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Central Aneurysm Axis. This axis linearly connects the
center of the ostium and the dome point (see Fig. 1) and does
not resemble the medial axis of the aneurysm. The center of
the ostium is defined by the middle of the centerline, after it
is projected on the ostium plane (see Fig. 3(a)). The central
aneurysm axis (CAS) can be used to align widgets, compute
suitable camera positions or scale widgets and glyphs according to the aneurysm size. We use it mainly for widget
alignment and scaling.

3.3. Workflow Integration and Requirements
We conducted a series of interviews with three radiologists
from two hospitals to discuss a workflow for analysing blood
flow in the context of vascular anatomy. First, we tried to
characterize the current workflow and later to envision how
this workflow has to be extended to integrate the exploration
of flow, which is beyond the current practice. From these
interviews, we derived a set of scenario descriptions which
capture a sequence of individual steps relevant for medical research on certain kinds of aneurysms. After validating these scenario descriptions in another set of interviews,
we came up with the following workflow. To describe it, we
chose a spatially driven surface-to-flow layout (see Fig. 2),
which consists of several sub-tasks:
• Topologic Surface Exploration. The geometric description of the reconstructed surface is of interest. This is relevant for therapy (e.g. indication of previous bleeding) and
helps to estimate the quality of the reconstruction in comparison with underlying image data.
• Quantitative Surface Exploration. Near-wall flow parameters are assumed to indicate the risk of rupture. Special mapping approaches help to gain an overview of the
spatial parameter distribution on the surface [NGB∗ 09].
• Exploration of Flow-Surface-Interaction. To gain insight into the interaction between flow and vessel wall,
both must be visually represented. Since the vessel wall
embeds the flow, occlusion is a major problem. Specialized rendering techniques can reduce the occlusion while
conveying visual hints about the shape and features of the
surface [GNK∗ 10].
• Anatomy-guided Exploration of Flow. The approach
presented in this work belongs to this step. Instead of providing the complete vessel or flow or any combination, we
concentrate on local, anatomically relevant sections of the
flow.
• Topologic Flow Exploration. While most of the previous
steps incorporate flow partially or as context, this step is
focussing on the flow field. This includes the analysis of

1044

Mathias Neugebauer et al. / Anatomy-Guided Multi-Level Exploration of Blood Flow in Cerebral Aneurysms

topologic features like sources, sinks, saddle points and
vortex cores [LHZP07].
Requirement Analysis. In the current state, the workflow
aims primarily at the field of medical research and biomedical engineering. Questions answered by this workflow might
involve the evaluation of reconstruction- and simulationpipelines, insights into the biomechanical and hemodynamic
influence on aneurysm evolution or the simulation of various stent designs and patient specific geometries in order to
optimize the treatment process. Nevertheless, based on the
approaches used in this workflow, diagnostic tools for clinical use will be developed. They will offer a condensed set
of features to aid binary decisions instead of broad exploration as it is necessary for research. Thus, the requirements
for supporting anatomy-driven flow exploration in the scope
of this workflow are mainly derived from the application in
medical research, yet influenced by the perspective of a later
usage in diagnosis and treatment planning.
The requirements are derived from the challenge of transferring highly complex information from one expert domain
(hemodynamic analysis) to another (biomedical research).
Thus, the basic goal is to simplify the process as much as
possible, yet provide all necessary information. This can be
realized by satisfying three requirements:
• Automatic Visualization Setup: The effort of choosing and parameterizing various visualization techniques
should be as low as possible. An automatic process or parameter templates support interpersonal compatibility of
analysis results and prevents misjudgements due to an inappropriate parameter setup.
• Incorporate Anatomic Descriptions: According to the
above described workflow, our approach aims at supporting anatomy-guided exploration of flow. Thus, it is not
only important to choose the right parameter setup, but to
also apply it to the spatially relevant section of the dataset.
If possible, this task should be supported in an automatic
manner or, in case of interaction, by the restriction of the
degrees of freedom (DoF).
• Guided Interaction: As implied above, a meaningful restriction of DoF can ease interactive exploration and avoid
unfavourable states [SSS01]. Neuroradiologists are used
to 2D interaction (e.g. placing a measurement widget) on
image planes. Even if one is used to 3D interaction, the
control of an 6-DoF camera in conjunction with at least 6
DoF given by an 3D widget, is a tedious interaction task.
To summarize the requirements: in order to support medical
researchers exploring complex hemodynamics with respect
to anatomy, an approach must provide easy to use visualization setups and guide the user during interaction and selection of spatially relevant flow sections.
4. Exploration at Different Scopes
Our exploration approach is inspired by the visual
information-seeking mantra: "overview first, details on de-

(a) Initial

(b) Remeshed

Figure 3: The ostium plane before and after remeshing.

mand" [Shn96]. It separates into three different scopes: a
global scope that gives an overview about the blood flow into
and out of the aneurysm, an ostium scope that concentrates
on certain flow characteristics close to the area of in- and
outflow and a local scope that enables the user to investigate
the flow parameters in the parent vessel and the aneurysm in
detail.
4.1. Global Scope
In order to understand how the flow in the aneurysm is connected to the blood flow in the parent vessel, one needs to
know which portion the flow actually enters the aneurysm,
how it evolves and how it has changed when it leaves the
aneurysm. Streamlines are suitable representations to visually convey these flow characteristics. They encode direction
and, through an appropriate color scheme, additional characteristic scalar values. Due to their non-dense nature, the
geometric context given by the vessel surface is still visible. This is further supported by a hybrid rendering of the
vessel surface. The Fresnel-term is used to define the opacity of front side. Thus, a view towards the centerline of the
vessel is almost not occluded while higher opacities near the
visual edge of the vessel convey hints about its shape. The
back side of the vessel is rendered opaque, using a dark blue
color. It acts as a canvas for the light colored streamlines.
The placement of the streamline seed points implicitly influences which parts of the flow will be visible. Since we
are interested in the in- and outflow, we choose the vertices
of the ostium plane mesh as seed points. Due to the bilinear interpolation approach used to generate the plane mesh,
we initially gain an inhomogeneous distribution of the seed
points that is unrelated to the underlying geometry and the
flow (see Fig. 3(a)). Thus, the ostium plane is remeshed, using an advancing front method. Due to a Delaunay triangulation with almost identical Voronoi regions the uniformity of
the vertex distribution is increased (see Fig. 3(b)). Since this
distribution is not regular in the sense of a rectangular Cartesian grid, the underlying uniformity is almost not perceivable while the whole surface is sampled with the same rate.
An under- or overrepresentation of flow parts, that could be
caused by an unfavourable random seed point placement, is
avoided.
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Mathias Neugebauer et al. / Anatomy-Guided Multi-Level Exploration of Blood Flow in Cerebral Aneurysms

Streamlines traced from the ostium plane can provide instantaneous insights, e.g. which portion of the laminar inflow enters the aneurysm. For further visual exploration of
the qualitative nature of the flow, with respect to velocity
and direction, specially designed lookup tables are applied
to the streamlines.
• Slow/Fast Flow Enhancement. Areas of low flow
velocity are equivalent to areas with a higher chance
of thrombosis. Endovascular treatment tries to induce a
thrombosis within the aneurysm. Thus, a lookup table
that enhances slow flow areas supports the qualitative
estimation of treatment success. We propose a velocitybased color scheme as it is presented in Figure 4(a). It is
based on complementary colors: orange to yellow is used
to encode lower velocities while blue to white encodes
higher velocities. The opacity correlates inversely to
the velocity in an exponential manner. Thus, the faster
laminar flow does not occlude the slow and turbulent flow
within the vessel and aneurysm, yet acts as contextual
information (see Figure 4(a)). For certain research fields,
e.g. questions concerning the remodelling of the parent
vessel flow in order to support thrombosis, the fast flow is
of major interest. To switch the focus-context relation, we
apply the same color scheme, but with inverted opacity
(see Fig. 4(b)).
• In-/Outflow Enhancement: To visually separate in- from
outflow, we benefit from the anatomically guided placement of the seeding points. Since they lie on the ostium
plane, we can simply use the integration time. Since the
ostium plane is oriented towards the aneurysm, streamlines encoding the inflow bear a negative integration time
and outflow streamlines a positive integration time respectively. Nevertheless, we have to consider that due to the
ostium plane orientation, this applies only to streamline
in the parent vessel. We choose a color scheme that encodes inflow from white to blue and outflow from orange
to yellow. Green marks the separation at integration time
zero (see Fig. 4(c)). In- and Outflow can also be presented
separately, to visually enhance regurgitations or the influence of the parent vessel flow on the outflow.
4.2. Ostium Scope
The ostium separates the aneurysm from the healthy parent
vessel. Thus, the flow profile at the ostium is a central parameter to evaluate the success of treatment options that alter the
inflow to induce a thrombosis within the aneurysm or reduce
the physical stress. Features of this profile are: the regional
distribution of in- and outflow, direction and velocity of flow
and the volumetric flow rate. Except for the volumetric flow
rate, the features can be directly derived from the underlying
vector field.
The volumetric flow rate Ri is calculated for each of the k
triangular elements of the ostium mesh:
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

1045

k

Ri =

Ai (vi · ni ) ∑ Ri /Rmax
i=0

Where Ai is the element area, vi is the velocity vector of
the flow through the element and ni is the element’s normal
vector. Rmax , the maximum element-wise volumetric flow
rate, is used for normalization. This is necessary, since the
volumetric flow rate is area-dependent. The normalization
ensures that the overall volumetric flow rate profile is independent from the tessellation and allows for a comparison
of profiles on different ostium meshes. Each profile feature
is represented by an individual visualization technique, combined in a multi-parameter visualization on the ostium plane.
The choice of each technique was deduced from informal
expert interviews.
The flow velocity is color-coded on the ostium plane. To
gain conformity with the streamlines of the global scope,
a similar yellow/orange-to-blue/white color scheme is applied. The volumetric flow rate is represented by a contour
line overlay. Orange contour lines mark the inflow (positive
flow rate), blue contour lines the outflow (negative flow rate)
and a red contour line (flow rate zero) the separation between
in- and outflow area. Radiologists confirmed that the number and density of the contour lines is suitable for qualitative
flow rate representation. The simple, binary color scheme reduces a visual interference with the color-coded velocity on
the ostium plane.
At this level of detail, the multi-parameter visualization
provides information regarding two scalars, velocity and volume flow, and a qualitative representation of in- and outflow
areas (see Fig. 5(a)). To add a visual representation of the
flow direction we employ glyphs and short streamlines that
are placed and seeded respectively at the vertices of the ostium mesh. Cone shaped glyphs are interpreted intuitively
to encode direction. Nevertheless, a glyph encodes direction
just at a single position, the vertex of the ostium plane. Thus,
short streamlines are added to convey more detail of the flow
field close to the ostium. They help to emphasize directional
flow structures like vortices (see Fig. 5(b)). In order to reduce visual cluttering, the glyphs and streamlines are rendered half-transparent, using white color. The underlying,
color-coded scalar information is still perceivable.
To further support the interpretation of scalar and directional information on the ostium plane, we include contextual information about the surrounding flow as a third level
of detail. As in the global scopes, we employ streamlines.
To prevent the streamlines to occlude too much of the ostium plane, their number is halved. Also, they are rendered
in a special way: we use the same opacity map that was used
when visualizing the slow flow in the global scope, but this
time, a desaturated, white (low velocity) to black (high velocity) color table is used. Additionally, streamlines encoding higher velocities are blurred. The result is a cloud-like

1046

Mathias Neugebauer et al. / Anatomy-Guided Multi-Level Exploration of Blood Flow in Cerebral Aneurysms

(a) Slow Flow Enhancement

(b) Fast Flow Enhancement

(c) In-/Outflow Enhancement

Figure 4: Global Scope Overview (upper row - overview, lower row - details): By applying the slow flow enhancement, the
flow structures within the aneurysm become visible. A slower inner vortex is enclosed by a faster one while the surface near
flow is slow again (A). The fast flow enhancement shows how the flow changes from laminar (C) to turbulent (B). When only
representing one of the flow directions, structures like regurgitations (D) or the change of the vortex orientation (E - F) due to
the collision with the parent vessel flow become visible. The arrows encode the flow direction.

flow representation (see Fig. 5(c)). In still images, information on the ostium plane is still perceivable. When rotating
the view around the ostium plane, the blurred contextual
streamline provide clear hints about structures (e.g. vortices)
in the surrounding flow.

this kind of restriction is appropriate and not considered as
disturbing. We chose a planar layout that enables us to employ dense flow visualization techniques like Line Integral
Convolution (LIC). Additionally, we apply height fields and
glyphs to represent the velocity profile and flow directions.

The context information helps to relate between features
in the global scope (vortex) and the ostium scope (mixture
of in-/outflow area). Nevertheless, this level of detail is not
necessary all the time. Thus, we propose three levels of detail that can be selected through templates: the first level includes the scalar information about volume flow and velocity as well as the in- / outflow areas. The second level adds
the flow direction by means of desaturated glyphs and short
streamlines while the third level incorporates blurred streamlines as context information.

Parent Vessel Exploration Widget. This planar widget is
orthogonally oriented and centered with respect to the parent
vessel centerline. Thus, the user can move the widget along
the centerline and probe the complete parent vessel without
accidentally misplacing the widget. A screen space projection of the centerline is employed and the point closest to the
mouse coordinates is used to place the widget on the according position on the world space centerline. Thus, a natural
and fast change between visually but not geodetically close
centerline points is possible, without traversing the whole
centerline.

4.3. Local Scope
In cases, where sparse flow representation of the global
scope and the anatomy-guided flow section of the ostium
scope do not provided the required amount of flexibility and
detail, the user should be enabled to manually probe the flow.
This can take place in two anatomic domains: the parent
vessel and the aneurysm. Appropriate widgets must be provided for this interactive task [TS07]. As described in the
requirement analysis, the widget handling needs to be simple. Thus, we constrain the widget transformation with respect to specific anatomical landmarks given in the parent
vessel and the aneurysm. Informal evaluations revealed that

The velocity profile of the flow that intersects the widget plane is represented by a height field. The same color
scheme as applied to the ostium height field is used. To encode the flow direction, desaturated glyphs are placed on the
height field. To provide further visual hints about the qualitative characteristic of the flow, we employ LICs on the planar backside of the widget (see Fig. 6(a)). Additionally, we
provide global scope streamlines as context, using the same
blurred context rendering style as for the ostium scope (see
Fig. 6(a)). To provide different levels of detail, we propose a
strategy similar to the one used for the ostium scope: Beginning with scalar values (height field - velocity), directional
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Mathias Neugebauer et al. / Anatomy-Guided Multi-Level Exploration of Blood Flow in Cerebral Aneurysms

(a) Velocity and Flow Rate

(b) Added Velocity Glyphs & Short Streamlines

1047

(c) Added Contextual Streamlines

Figure 5: Ostium Scope Overview: At the first level of detail, velocity (color coded) and volumetric flow rate (contour lines)
are represented, while the red contour separates in- from outflow (a). Short streamlines and cone-glyphs provide directional
information; structures like vortices become visible (b). Blurred contextual streamlines help to relate between global scope
vortex and ostium plane vortex - view from below (c).

(a) Parent Vessel Exploration Widget

(b) Aneurysm Exploration Widget

Figure 6: Local Scope Overview: The context for the parent vessel widget is provided by blurred global scope centerlines. A
height field represents the velocity profile (A) while a LIC on the backsides conveys flow characteristics (B). The aneurysm
widget provides two transformation modes: Translation along the central aneurysm axis (C) and rotation around the widget
center (D). By selecting a point on the widget plane, additional probing planes can be added (E). In (E) blurred streamlines are
added as context while in (C) and (D) glyphs encode the flow direction.

information (glyphs - flow direction) and context (blurred
streamlines) can be added optionally.
Aneurysm Exploration Widget. Similar to the parent
vessel widget, the translation of this widget is constrained
with respect to the central aneurysm axis (CAS). Thus, it
cannot be accidently positioned outside the aneurysm. In its
initial state, the widget is orthogonally oriented with respect
to the CAS. We also provide the possibility to rotate the widget. A click on the broad border of the handle activates the
rotation mode while a click on the center enables translation (see Fig. 6(b)). The border point, selected when entering rotation mode, also defines the rotation direction. The
rotation axis lies on the widget plane. It is orthogonal with
respect to the axis given by the selected border point and the
widget center. The mouse position is orthogonally projected
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

onto the screen space representation of the rotation axis. The
screen space distance of the projected point and the widget
center defines the rotation angle. Thus, the rotation is aligned
to the mouse movement during rotation. Since any rotation
vector can be defined by selecting a point on the handle border, no additional keyboard inputs or viewpoint changes are
necessary to freely rotate the widget within the aneurysm.
As a visual transformation cue, the widget handle stays at its
initial position while the probing plane is moving.
Except for the height field, the same visualization techniques as for the parent vessel widget are used for aneurysm
exploration widget. Up to three orthogonal planes can be positioned by a single mouse click on the probing plane, defining the intersection point of the planes (see Fig. 6(b)). The
layout of the planes resembles a scheme radiologists are used

1048

Mathias Neugebauer et al. / Anatomy-Guided Multi-Level Exploration of Blood Flow in Cerebral Aneurysms

to from dealing with volume datasets (coronal, saggital and
axial image slices). The additional planes can be shifted by
selecting another point on the widget plane and the rotate
accordingly. Similar to the parent vessel widget, the blurred
rendering of the global scope streamlines serves as visual
context (see Fig. 6(b)). The aneurysm widget provides the
same three optional levels of detail as the parent vessel widget: scalar (color - velocity), directional (glyphs - flow direction) and additional context (blurred streamlines).
5. Results
The implementation of our approach is based on the Visualization Toolkit (VTK) and the prototyping environment
M E V IS L AB. To evaluate our exploration strategy, we choose
five representative datasets. For two patient scans the flow
was derived from CFD. They contained a small saccular
aneurysm (2mm ∅) at the left vertebral artery (An_01 see figures of the previous sections) and a larger basilar
aneurysm (7mm ∅) (An_02 - see Fig. 7(a)). Due to the complex configuration of the parent vessel, we included one
of the datasets of the V ISC stenting challenge 2009, also
with CFD derived flow data (An_03 - see Fig. 7(b)). As
an example for measured flow data, a 7 Tesla 4D PC-MRI
scan was applied to a phantom that contained three artificial
aneurysms, two of which (An_04: 8mm ∅, An_05: 10mm ∅
- see Fig. 7(c) and Fig. 7(d)) were included into the dataset
base. All CFD simulations were steady-flow and from the
measured flow data one time-step was extracted. The complexity of the volume flow grid ranged from app. 180.000
(small saccular aneurysm) to 4, 6 · 106 (VISC dataset) elements. Depending on the ostium shape 2500 to 3500 seed
points were used. For our prototypic system, the preprocessing time, including data loading, ostium generation and
stream tracing ranged from 10 to 40 sec. on a mid-class system (Core 2 Duo 3.16, 4GB Ram, nVidia GForce 9600GT).
Tasks during the actual exploration, e.g. viewpoint change,
change of color scheme for global scope or widget interaction, could be performed at interactive rates (15 - 30 fps).
6. Informal User Feedback
We conducted three interviews with two board-certified radiologists (expert A / B), who were not involved in the initial design process. The goal was to gain qualitative feedback that will be used to design a quantitative study with a
higher number of participants. The feedback from the first
interview (expert A) was also used to gain more background
knowledge as preparation for the second interview cycle (expert A / B). Our approach aims at satisfying the requirements
(see Section 3.3) by providing three anatomy-driven scopes,
visualization templates and guided interaction. Thus, the interviews were designed to find out, if the requirements were
principally met and which details might need improvement.
During the interviews, the experts freely interacted with

the exploration tools that were applied to the datasets An_01
to An_05. The interviews were divided into sections, one
for every scope. The experts were asked to evaluate the feasibility and describe possible limitations of each scope. In
the ostium scope, the experts were confronted with an alternative design, where an additional height field was used
to visualize the volumetric flow and the flow direction was
encoded with velocity-scaled colored glyphs (see Fig. 7(d)).
This was the initial version of the ostium scope visualization,
as it was presented to expert A in the first interview. The
current version (no height field, desaturated equally scaled
glyphs, short streamlines) was derived from the feedback of
this interview. After the scope sections of each interview, we
asked the experts to give an overall feedback about the usability of the multi-scope approach. To mimic an alternative,
as it is given by current commercial flow analysis tools (e.g.
E NSIGHT), we abandoned the anatomy-driven constraints of
our approach. We provided the opportunity to freely select
from the same set of visualization techniques that were used
in the different scopes and the experts where able to parameterize them. Additionally, the widgets of the local scope
could be moved without axis-constraints.
The experts clearly preferred our approach over the unconstrained alternative. When working with the alternative,
it could be observed, that both experts tried to mimic parts of
our anatomy-guided approach. As an example, they put high
manual effort in aligning the widgets with the centerline or
central aneurysm axis respectively. Nevertheless, the experts
stated that in rare cases an unconstrained interaction might
be necessary and should be included as an option. Overall, the experts considered the multi-scope approach as suitable for the qualitative exploration of flow inside aneurysms.
Also their order from global to local was appreciated. The
three-scope design was stated to be complete, no additional
scopes are needed. Regarding the global scope, the expert
liked the idea of separate views for slow/fast flow and in/outflow. The color scheme was considered comprehensible,
although radiologists are used to a red-blue color scheme
to encode velocities (e.g. ultrasound workstation). How to
adapt the proposed color scheme to resemble the red-blue
color scheme without losing visual details will be investigated in additional interviews and the final survey.
With respect to the ostium scope, the layout derived from
the initial interview was considered to be suitable and provides all necessary information about the flow profile at the
ostium. It was interesting to see that the experts had problems to interpret the scalar nature of the height field used
in the initial layout. We suppose, that radiologists are more
used to overlays (volumetric flow contour lines) than distorted geometry (volumetric flow height field). However, this
needs to be investigated in further studies. The expert stated
the blurred contextual flow rendering to be useful in special cases, but preferred to switch between global and ostium
scope to relate between flow and ostium profile.
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Mathias Neugebauer et al. / Anatomy-Guided Multi-Level Exploration of Blood Flow in Cerebral Aneurysms

(a) An_02

(b) An_03

(c) An_04

1049

(d) An_05

Figure 7: Exploration of different datasets: The aneurysm exploration widget in translation mode in a large basilar
aneurysm(a). The VISC dataset has a complex bifurcation below the aneurysm, the in-/outflow enhancement exhibits a central inflow (b). The parent vessel widget (c) and the ostium scope (d) applied to measured flow data.

The handling of the widgets of the local scope was considered easy to learn. Even the more complex free rotation
of the aneurysm exploration widget was not problematic.
We assume that this is related to the fact that no additional
viewpoint change is necessary to define the wanted rotation
angle. The experts stated, that the information conveyed by
the parent vessel widget was clearly understandable, yet, in
some cases hard to perceive due to an unfavourable camera position. As an alternative, they suggested an additional
viewport showing the widget profile in a static fashion or an
adaptive camera that automatically finds a suitable view on
the widget. The expert preferred the aneurysm exploration
widget with its basic planar layout. The addition of orthogonal planes was stated to be very complex and only necessary
in special cases and therefore should be optional.
The feedback, given by the experts, will be considered in
the next iteration of our approach. This version will be evaluated in a number of expert interviews and the results derived
from those interviews will form the basis for the design of a
quantitative study. The design of this study will be oriented
at the work of Laidlaw et al. [LKJ∗ 05]. For each scope, the
users will have to fulfil specific tasks, like finding and describing flow structures (global scope), finding features in
the inflow profile (ostium scope) or navigating the widgets
to provide detailed information about given spatial regions
(local scope).

7. Conclusion
We presented a multi-scope approach that supports a workflow to visually explore flow at different levels: a global
overview of flow in the aneurysm, the ostium flow profile
and the local probing with special widgets for the aneurysm
and the parent vessel. Informal interviews with radiology
experts confirmed the general usefulness of three distinct
scopes and guided interaction during widget placement. The
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

feedback of the informal interviews will be used to further
improve the approach and design an adequate user study.
In its current state, the applied visualization techniques
are suitable to explore steady flow simulation results or a
single time step of measured flow/unsteady flow simulation
respectively. The global scope of our approach is suited to
explore vortex structures within the aneurysm while our ostium scope represents in- and outflow regions at the ostium.
Mantha et al. [MBHM09] have shown that those two features, the aneurysm vortex and the in-/outflow region, are
stable over the phase of a pulsatile flow cycle. This is true
for varying aneurysm shapes and can even persist, if the flow
parameters are changed beyond normal physiological conditions. They conclude, that these two features may be analysed based on less time consuming steady flow simulations.
Thus, in its current state, our approach fits to the requirement of this analysis task. However, even if Mantha et al.
provide evidence that these two features might play a major
role for the development of therapy strategies, it is still unknown which additional time-dependent parameters might
also be important. The adaption of our anatomy-guided exploration approach to time-dependent data remains open for
future work. Due to the planar layout used in the ostium and
local scope, we believe it might be possible to include time
as an additional visual dimension. However, new strategies
are required to cope with the associated problem of visual
clutter. Due to the three-dimensional nature of the global
scope, an adaption to time dependent data makes it necessary to employ different visualization techniques. We assume that topological extraction may be appropriate to support this task. This needs to be researched in greater detail
based on a broader range of datasets.
Acknowledgment: We would like to thank U. Preim (University Hospital Magdeburg) for fruitful discussions and Fraunhofer
MEVIS for providing the prototyping platform MeVisLab. This
work has been funded by the federal state of Saxony-Anhalt in the
scope of the M O B E S TA N project (5161AD/0308M).

1050

Mathias Neugebauer et al. / Anatomy-Guided Multi-Level Exploration of Blood Flow in Cerebral Aneurysms

References
[Buo98] B UONOCORE M.: Visualizing blood flow patterns using
streamlines, arrows, and particle paths. MRM 40, 2 (1998), 210–
226. 2
[CBM∗ 03]

C HATZIPRODROMOU I., B UTTY V., M AKHIJANI V.,
Pulsatile blood flow in anatomically accurate vessels
with multiple aneurysms: A medical intervention planning application of computational haemodynamics. Flow, Turbulence and
Combustion 71 (2003), 333–346. 2
ET AL .:

[CCA∗ 05] C EBRAL J., C ASTRO M., A PPANABOYINA S.,
ET AL .: Efficient pipeline for image-based patient-specific analysis of cerebral aneurysm hemodynamics: technique and sensitivity. IEEE Trans Med Imaging 24, 4 (2005), 457–467. 2
[GNK∗ 10] G ASTEIGER R., N EUGEBAUER M., K UBISCH C.,
ET AL .: Adapted Surface Visualization of Cerebral Aneurysms
with Embedded Blood Flow Information. In EG VCBM (2010),
pp. 25–32. 3

[Sch97] S CHÖBERL J.: Netgen an advancing front 2d/3d-mesh
generator based on abstract rules. Computing and Visualization
in Science 1 (1997), 41–52. 2
[Shn96] S HNEIDERMAN B.: The eyes have it: A task by data type
taxonomy for information visualizations. In Proc. IEEE Symp on
Visual Languages (1996), IEEE Computer Society, pp. 336–. 4
[SSS01] S ALZMAN T., S TACHNIAK S., S TÜRZLINGER W.: Unconstrained vs. constrained 3d scene manipulation. In Proceedings of the 8th IFIP International Conference on Engineering for
Human-Computer Interaction (London, UK, 2001), EHCI ’01,
Springer-Verlag, pp. 207–220. 4
[TS07] T EATHER R. J., S TUERZLINGER W.: Guidelines for 3d
positioning techniques. In Proc. of Future Play (2007), pp. 61–
68. 6
[vPBB∗ 10] VAN P ELT R., B ESCOS J. O., B REEUWER M.,
ET AL .: Exploration of 4d mri blood flow using stylistic visualization. IEEE TVCG 16 (2010), 1339–1347. 2

[HFSea11] H ENNEMUTH A., F RIMAN O., S CHUMANN C.,
ET AL .: Fast Interactive Exploration of 4D MRI Flow Data. In
SPIE Medical Imaging (2011). To appear. 3
[IOKea10] I SODA H., O HKURA Y., KOSUGI T., ET AL .: Comparison of hemodynamics of intracranial aneurysms between MR
fluid dynamics using 3D cine phase-contrast MRI and MRIbased computational fluid dynamics. Neuroradiology 52 (2010),
913–920. 2
[LABFL09] L ESAGE D., A NGELINI E. D., B LOCH I., F UNKA L EA G.: A review of 3D vessel lumen segmentation techniques:
Models, features and extraction schemes. Medical Image Analysis 13, 6 (December 2009), 819–845. 2
[LHZP07] L ARAMEE R., H AUSER H., Z HAO L., P OST F.:
Topology-based flow visualization, the state of the art. In
Topology-based Methods in Visualization. 2007, pp. 1–19. 4
[LKJ∗ 05] L AIDLAW D. H., K IRBY R. M., JACKSON C. D.,
DAVIDSON J. S., M ILLER T. S., DA S ILVA M., WARREN
W. H., TARR M. J.: Comparing 2d vector field visualization
methods: A user study. IEEE Transactions on Visualization and
Computer Graphics 11 (January 2005), 59–70. 9
[MBHM09] M ANTHA A. R., B ENNDORF G., H ERNANDEZ A.,
M ETCALFE R. W.: Stability of pulsatile blood flow at the ostium
of cerebral aneurysms. Journal of Biomechanics 42, 8 (2009),
1081 – 1087. 9
[MHBea07] M ARKL M., H ARLOFF A., B LEY T. A., ET AL .:
Time-Resolved 3D MR Velocity Mapping at 3T: Improved
Navigator-Gated Assessment of Vascular Anatomy and Blood
Flow. J. of Magn. Reson. Imaging 25, 4 (2007), 824–831. 2
[NDSP10] N EUGEBAUER M., D IEHL V., S KALEJ M., P REIM
B.:
Geometric reconstruction of the ostium of cerebral
aneurysms. In Proc. of VMV (2010), pp. 307–314. 2, 3
[NGB∗ 09] N EUGEBAUER M., G ASTEIGER R., B EUING O.,
ET AL .: Map Displays for the Analysis of Scalar Data on Cerebral
Aneurysm Surfaces. Computer Graphics Forum 28 (3) (2009),
895–902. 3
[NP11] N EUGEBAUER M., P REIM B.: Generation of a Smooth
Ostium Surface for Aneurysm Surface Models. In Proc of BVM
(2011), p. to appear. 3
[PVH∗ 03] P OST F., V ROLIJK B., H AUSER H., ET AL .: The state
of the art in flow visualisation: Feature extraction and tracking.
In Computer Graphics Forum (2003), no. 4, pp. 775–792. 2
[PVS∗ 09] P ICCINELLI M., V ENEZIANI A., S TEINMAN D. A.,
R EMUZZI A., A NTIGA L.: A Framework for Geometric Analysis of Vascular Structures: Application to Cerebral Aneurysms.
IEEE Trans Med Imaging 28, 8 (2009), 1141–1155. 2, 3

c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.


DOI: 10.1111/j.1467-8659.2011.01954.x
Eurographics / IEEE Symposium on Visualization 2011 (EuroVis 2011)
H. Hauser, H. Pfister, and J. J. van Wijk
(Guest Editors)

Volume 30 (2011), Number 3

Prostate Cancer Visualization from
MR Imagery and MR Spectroscopy
Joseph Marino and Arie Kaufman
Stony Brook University, NY, USA

Abstract
Prostate cancer is one of the most prevalent cancers among males, and the use of magnetic resonance imaging
(MRI) has been suggested for its detection. A framework is presented for scoring and visualizing various MR data
in an efficient and intuitive manner. A classification method is introduced where a cumulative score volume is
created which takes into account each of three acquisition types. This score volume is integrated into a volume
rendering framework which allows the user to view the prostate gland, the multi-modal score values, and the surrounding anatomy. A visibility persistence mode is introduced to automatically avoid full occlusion of a selected
score and indicate overlaps. The use of GPU-accelerated multi-modal single-pass ray casting provides an interactive experience. User driven importance rendering allows the user to gain insight into the data and can assist
in localization of the disease and treatment planning. We evaluate our results against pathology and radiologists’
determinations.
Categories and Subject Descriptors (according to ACM CCS): I.3.3 [Computer Graphics]: Picture/Image Generation—Display algorithms; I.3.6 [Computer Graphics]: Methodology and Techniques—Interaction techniques;
I.3.8 [Computer Graphics]: Applications—; J.3 [Life and Medical Sciences]: Health—

1. Introduction
Prostate cancer (CaP) is the second most incident cancer for
males worldwide [PBFP05]. However, diagnostic methods
remain primitive and inexact, relying primarily on a nonspecific blood test and a digital rectal examination. Noncancerous prostate diseases can yield positive results, requiring biopsies to be performed. Though guided by transrectal
ultrasound (US), these biopsies are inexact, and many are
often necessary to successfully sample a cancerous region
[Loc07]. Recently, it has been noted that magnetic resonance
imaging (MRI) can be used for detecting CaP [HKC04],
though multiple MR images obtained with different settings
are necessary. Most commonly used is a combination of T2 weighted (T2 -w) and T1 -weighted (T2 -w) image sequences,
and the use of MR spectroscopic imaging (MRSI) has also
been suggested. We focus our work on using these three
common acquisitions for visualizing the prostate, CaP, and
the surrounding anatomy, as shown in Figure 1.
Radiologists will examine the MR data by viewing the
slices and trying to correlate matching positions between
scans in various orientations (e.g., axial and coronal). An
automated analysis combined with a 3D rendering system,
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

Figure 1: Visualization of the prostate gland and surrounding anatomy. The prostate is between the rectum (shown in
burnt orange) and the pelvic bone. Suspected areas of cancer and hemorrhages in the gland are indicated by blue and
red, respectively, and the seminal vesicles are in green.

1052

J. Marino & A. Kaufman / Prostate Cancer Visualization

which would allow for viewing of the entire gland at once
and include the data from each scan, would be more intuitive and efficient. This need for improved visualization techniques for treatment planning has been noted [Rob02]. For
physicians it is an additional tool to augment slice viewing,
and can be used to assist in localizing the disease and for
treatment planning. For the patient, a 3D visualization allows for a more intuitive explanation of their disease and
can be helpful in discussing what course of action to pursue.
We present a volume rendering framework that allows the
user to observe the prostate and its surrounding anatomy in
an intuitive 3D environment. We introduce the concept of a
score volume for visualizing the disease and present methods to observe all three types of multi-modal MR data in
a single 3D view. This score volume can also be integrated
into 2D slice-based views. User-driven importance rendering allows for different information to be emphasized based
on the user’s desires. We present a method of visibility persistence, where a score of interest can automatically maintain visibility when it would be occluded, and overlaps are
indicated. To render the surrounding anatomy, we use a single pass multi-volume ray caster accelerated on the GPU. A
method of interactive region painting is also presented and
integrated into the multi-volume ray caster.
The paper is organized as follows. Section 2 discusses related computer graphics and medical work. Background information on the use of MR for CaP detection is presented
in Section 3, and the data used for this work is detailed in
Section 4. Section 5 describes the creation of the score volume from multiple MR acquisition types and the related 2D
slice-based visualization. The integration of this score volume into a 3D visualization framework with surrounding
pelvic anatomy is described in Section 6. We discuss our
experimental details, including performance and evaluation,
in Section 7, and conclude the paper in Section 8.
2. Related Work
Volume rendering has become a standard technique for visualizing medical data, and volumetric ray casting, which
can be accelerated on the GPU, is the preferred method
[SHC∗ 09]. For cancer in solid organs, such techniques have
been applied for detection of tumors within the breast or
brain [CM09] and for treatment of liver tumors [RWS∗ 10].
Whereas for other applications it is often sufficient to render a single value of interest, prostate visualization necessitates the rendering of multiple score values at a single region based on multiple MR acquisition modes. For this, we
integrate a multichannel score volume into the ray casting,
allowing for all of the scores to be viewed and combined at
once as desired by the user.
Although the prostate has been a subject of research for
some time, most work in 3D has focused on shape reconstruction and the use of geometric models for simulation purposes [ZWZ06]. Volume rendering has typically been used

for illustration of the gland’s size and location. The prostate
and surrounding anatomy have been rendered from high resolution anatomical images of the Chinese visible human
[WZL∗ 10]. Simple rendering of MR and computed tomographic (CT) volumes to see the shape of the prostate for CTbased radiotherapy treatment planning has been proposed
[JJFP07], and US has been used for brachytherapy planning [MKM∗ 09]. Research has also been done to merge single photon emission computed tomography (SPECT) imaging, where the cancer is very apparent, with anatomical data
for treatment planning [LSRM05]. Our work focuses on visualizing cancerous regions from MR data of the prostate,
which provides better image quality than US, but does not
require exotic imaging modalities. Unlike previous work, we
aim to allow the user to interactively explore the gland, suspicious areas, and surrounding anatomy.
As more imaging techniques become popular, multimodal rendering has become common for dealing with the
increased data. Though technically not multi-modal since
they are all MR scans, the use of different acquisition types
leads to similar considerations. Early discussions centered
on how to combine multiple volumes for display [CS99]. In
medical applications, multi-modal rendering is often used to
combine functional data with anatomic data, such as positron
emission tomography (PET) and CT [RHR∗ 09], as well as
for surgery planning [BHWB07]. For these, values from different modes can be combined during rendering to achieve
a desired look. For our work, a simple combination of values from different types is not applicable, as different values
have different meanings. We first analyze the data and the
created score volume is used for visualization, where each
score can be manipulated and viewed individually.
The T2 -w, T1 -w, and MRSI data are acquired at different levels of resolution, being approximately 0.5 × 0.5 × 3
mm, 1 × 1 × 6 mm, and 7 × 7 × 3 mm, respectively. Since
we wish to visualize both the immediate area of the prostate
(gland and seminal vesicles) as well as the general pelvic region (bladder, rectum, and pelvis bone), multi-volume rendering is necessary. For ray casting, it is common to use
depth peeling and perform the ray casting in multiple passes
[PHF07, RBE08] or to do only certain chunks at one time
[BG06]. Methods where the ray casting occurs in a single pass normally require the volume datasets to be preprocessed such that they are registered and resampled to a single grid [BHWB07]. For our GPU accelerated multi-volume
rendering, we perform ray casting in a single pass by tracing
two simultaneous rays through the two volumetric domains,
maintaining a step correlation between the two, so that corresponding sample positions are colocated in world space.
Work has been undertaken to use MRI for the detection
of cancer, and there have been attempts at computer-aided
diagnosis (CAD) from the MR images [MSF∗ 06] and MRS
data [TMR07]. These works are focused on utilizing only
the 2D MRI slices, not in a 3D rendered environment, with
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

J. Marino & A. Kaufman / Prostate Cancer Visualization

1053

an outlook towards providing full CAD. For our work, we
present a method of scoring the volumes, but leave the task
of determining cancerous regions to the physician through a
visualization of the scored data in both 2D and 3D.
Methods for importance-driven rendering, allowing for
a region of interest to be preserved, have been proposed
[VKG04]. In that work, they perform composition in order
to present the important structures when they may otherwise
be obstructed. We expand on this to provide contextual feedback of overlapping regions. Since we are using multiple
score values at the same position which can have a relationship to each other, we introduce a tinting function to color
regions that overlap. This allows the user to further distinguish within the view whether the score of interest overlaps
another score, or whether it is simply occluded.
The ability of the user to interact with the underlying volume itself has also been explored. Earlier work on the editing of volumes has focused on various ways of displaying
the existing data, such as painting on surfaces and making
annotations, cutting windows within structures, or selecting
regions to render differently [BKW08]. In contrast to this,
instead of being able to edit the already existing data, we
allow the user to draw new structures on-the-fly within the
data which are then rendered as 3D objects in a desired color
along with the existing data.
3. Background Information
The prostate is divided into three zones: the peripheral zone
(PZ), transitional zone (TZ), and central zone (CZ). The
PZ is the largest of the three, accounting for approximately
70% of the prostate, and roughly 70% of CaP cases originate there [ZWZ06]. Being on the periphery of the prostate,
cancer from this region is more likely to spread beyond the
prostatic capsule. The TZ and CZ are often considered together as a single region, and as such are referred to as the
central gland (CG). Cancer from this area is less likely to
spread outside the prostate because it is generally bordered
by the PZ and the fibromuscular stroma. Located superior to
the prostate are the seminal vesicles (SVs), which are fluid
filled sacks. Invasion of the SVs by CaP is also of concern.
T2 -w images provide good image quality of the prostate,
allowing for a differentiation between the PZ and CG. Normal prostatic tissue in the PZ will have high intensity, while
cancerous tissue will generally show a decreased intensity.
In the CG, however, normal tissue already has a decreased
intensity. Due to this, and since the CG is of relatively low
importance compared to the PZ, we focus on detecting CaP
in the PZ, which agrees with typical MR examinations of
T2 -w data [WBC∗ 09]. The prostatic capsule surrounding the
gland appears with low intensity in T2 -w images.
Unlike T2 -w images, T1 -w images are of low image quality with respect to the prostate and cannot be used to identify
zonal anatomy. Cancerous regions and normal tissue both
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Figure 2: Natural alignment of three T2 -w MR slices, with
axial tinted red, sagittal blue, and coronal green. The prostatic capsule aligns well between slices (yellow circles).
appear as areas of low intensity, and thus cancerous regions
are not apparent. Rather, the T1 -w images are used to exclude
areas which may still contain blood from earlier biopsies.
Such post-biopsy hemorrhages will appear similar to cancer
in the PZ in T2 -w images. In T1 -w images, such regions will
have increased intensity from normal prostate tissue.
MRSI measures chemical spectra in large regions, each
covering many voxels. For CaP detection, there are three
chemicals of interest: choline, creatine, and citrate. Specifically, the ratios of choline to creatine and of choline plus
creatine to citrate appear elevated in cancerous regions
[WCQ∗ 08]. MRSI is not suitable for specific localization
due to its coarse resolution, but can be useful as a broad tool.
The surrounding anatomy can also be important in identifying CaP. Invasion of the SVs can be identified using the T2 w images. Normal SVs appear as regions of increased intensity surrounded by walls of decreased intensity. In SV invasion, the SVs will appear with decreased intensity throughout. An abnormal angle between the prostate and the rectum
can also be indicative of a problem, and thus it is important
to be able to view the location of the rectal wall.
4. Standard Patient Dataset
We have built our system around the use of five image sequences: three approximately orthogonal T2 -w sequences
(axial, sagittal, and coronal), one T1 -w axial sequence, and
one MRSI sequence. For the T2 -w sequences, the images are
focused on the region of the prostate. The T1 -w images, acquired with lower resolution, encompass the entire pelvic region. As these were acquired using an endorectal coil, artifacts from it affect areas near the rectum. To overcome this,
specialized software to negate this effect is provided with the
MR machine, and we utilize these post-processed images.
These scans were acquired during a single session, and as
such, are naturally registered in world space. We can use the
image position, orientation, and pixel spacing information
from the DICOM data to align the volumes properly with
respect to each other (see Figure 2). Due to this natural alignment, it is possible to calculate the corresponding positions

1054

J. Marino & A. Kaufman / Prostate Cancer Visualization

in each volume with respect to another volume. In general,
we have observed the alignment between orthogonal slices
to be within 0 - 1 mm of the correct position. Because of
this, we do not use any formal registration methods. In cases
where the datasets are not naturally aligned, MR registration
algorithms have been proposed [ZWZ06].
Segmentation of the prostate and surrounding anatomy is
necessary since nearby structures are often within a similar
range of values. Various methods have been proposed for the
segmentation of the prostate data [ZWZ06] as well as for the
pelvic anatomy [PLV∗ 07]. However, the focus of our efforts
is on scoring and visualization techniques for this data, and
thus segmentation is outside the scope of our work. For accuracy, the data has been manually segmented (considered
the current gold standard method) with guidance from an
experienced radiologist. For our system, we take label map
segmentations for each of the four image volumes. For the
three T2 -w volumes, the PZ, CG, and SVs are segmented.
For the T1 -w volume, the whole prostate gland, bladder, rectum, and bone are segmented.
Due to the large interslice gap, the four segmentation label maps are upsampled. In general, iterative dilations and
erosions are used to interpolate middle slices throughout the
volume, maintaining both individual segmentations (e.g., PZ
and CG), as well as the area of the entire gland. This interpolation is repeated until the interslice spacing is no worse
than twice the intraslice spacing. The three upsampled T2 -w
label maps can then be combined to form a composite label
map, which takes into account the segmentation information
from all three T2 -w volumes. Note that this upsampling is
only to maintain the shape of the segmentations, and thus no
upsampling is performed on the actual T2 -w or T1 -w data.
5. Score Volume
Our work in visualizing the prostate gland and suspicious
regions is based on creating a score volume, where every
voxel contains three values which are scores corresponding
to each of the three types of MR acquisitions. The T2 score is
based on detecting cancer from the T2 -w data. The T1 score is
based on detecting regions of post-biopsy hemorrhage from
the T1 -w data. The MRSI score is based on detecting areas of
increased chemical ratios indicating the possibility of cancer
existence. The T1 and MRSI scores are binary and the T2
score is quaternary. The inputs for the creation of the score
volume are the five image sequences, the four upsampled
segmentation label maps, and the composite label map.
5.1. Creation
Empirically determined thresholds are used to decide a score
for each of the modes. These thresholds were defined by using a group of three datasets and manually observing the typical signal intensities for regions believed to be normal and
abnormal in the PZ (decreased for T2 , increased for T1 , elevated spectra in MRSI). The pathology results were used to

(a) Axial

(b) Sagittal

Figure 3: Integrating the score volume with slice-based
viewing. The score information is overlaid on the MR slices,
with blue indicating T2 scores and red indicating T1 scores.
ensure that we were sampling from sextants known to contain either cancer or hemorrhage. The scores are created as
follows, with the default values being zero.
T2 Score (PZ): Decreased T2 -w intensity in the PZ is indicative of cancer, so voxels which are below the T2
threshold are of interest. Since there are three volumes of
T2 -w data, all of them are sampled to take advantage of
each volume’s high intraslice resolution. Each volume’s
score contributes one third towards the final score, which
can thus contain four values (0, 0.33, 0.67, and 1).
T1 Score (PZ): Increased T1 -w intensity in the prostate is
indicative of post-biopsy hemorrhage, so voxels which are
above the T1 threshold are of interest. The single T1 -w
volume contributes fully to the final score value.
MRSI Score (PZ and CG): An increase in one or both of
the spectroscopic ratios in the MRSI data is indicative of
prostate cancer. If either of the two ratios are above the
MRSI threshold, then the voxel is scored as being of interest. This scoring system, unlike for the T2 and T1 scores,
is applied to both the PZ and CG.
T2 Score (SVs): Similar to the T2 scoring for the PZ, decreased T2 -w image intensity in the SVs is indicative of
cancer. However, the SVs pose a hurdle in that their walls
(both interior and exterior) also appear with decreased T2 w intensity. To account for this, a three part scoring process is used. First, each T2 -w sequence (axial, sagittal, and
coronal) is scored individually. Their individual score volumes are then eroded by two voxels to remove thin boundaries. The final SV score is created with each of the individual scores contributing one third to the final score.
The neighboring regions of the PZ (prostatic capsule and
CG) are generally dark, and thus could yield false positive
results if included accidentally as part of the PZ. To account
for this, we do not score the border voxels. To ensure that
samples are from the correct region for each of the three T2 w volumes, we take into account the upsampled label maps
for each volume, and sample that volume only if its label
map indicates the region is correct. Likewise, the upsampled
label map of the T1 -w volume is provided to ensure samples are from within the prostate. Since areas immediately
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

1055

J. Marino & A. Kaufman / Prostate Cancer Visualization

(a)

(b)

(c)

Figure 4: Rendering examples of individual score values. (a) The T2 score values with blue indicating cancer. (b) The T1 score
values with red indicating hemorrhages. (c) The MRSI score values with purple indicating elevated ratios.
outside of the prostate are often of high intensity in T1 -w
data, they could be mistaken as indicators of a hemorrhage
if improperly sampled. Trilinear interpolation is used when
sampling from the upsampled label maps and tricubic interpolation is used when sampling from the original MR data.

Figure 5: Seminal vesicles indicating bilateral invasion.

5.2. 2D Slice-Based Visualization
only the prostate region is to be viewed, this multi-volume
rendering is not necessary.

The created score volume can be integrated into a 2D slicebased viewing system to provide guidance for the radiologist
in viewing the slices by presenting information from other
slices on the slice being viewed. For each voxel in a slice
being viewed, the score values from the score volume can be
found and overlaid on the grayscale image. Though the score
volume is aligned with the axial T2 -w image sequence, it can
be interpolated to obtain values for the corresponding pixels
in the other image sequences. Examples of this are shown in
Figure 3, where the T2 and T1 scores are shown as blue and
red overlays, respectively. The user can adjust the opacity of
the overlays as desired.

Two preprocessing operations are performed before rendering. The prostate region volumes are both trimmed so
that surrounding area is removed where no anatomy is labeled. This trimming is done such that a 3 mm border remains around the cuboid region of interest and will typically
reduce its size to 15% of the original. Since all of the data has
been based on binary segmentations with no smooth gradients between labeled and non-labeled regions, the score volume and both label map volumes are filtered with a 3 × 3 × 3
mean filter to improve the rendering results.

6. 3D Visualization

6.1. Standard Prostate Region

A 3D volume rendered view of medical imagery is an intuitive method of visualizing the data and obtaining a good
sense of the relationship between objects. Our system allows
the user to visualize the prostate region and the surrounding
anatomy of the pelvic region. For the prostate region, using the score volume allows the user to visualize tumor and
hemorrhage locations. The inputs for the volume rendering
framework are the following four volume files:

Visualization of the prostate region is based on using the
composite label map volume and the score volume. For rendering the interior areas of the gland and SVs, volume rendering is performed on the score volume. The score volume
contains three values per voxel, corresponding to the T2 -w
score, T1 -w score, and MRSI score. The user can view each
of the values individually, or combined as desired. For the
surface of the gland, we use semi-transparent isosurface rendering of the composite label map directly.

1.
2.
3.
4.

Score volume (prostate region)
Composite label map volume (prostate region)
Upsampled label map of T1 -w volume (pelvic region)
T1 -w pelvic MR volume (pelvic region)

The two prostate region volumes occupy the same volumetric space, and the two pelvic region volumes likewise occupy the same volumetric space. For rendering the surrounding anatomy, especially the bones, it is necessary to make
use of the pelvic region volumes, which encompass a much
greater area than the prostate region volumes. Since we do
not want to scale or resample the data, we perform multivolume rendering through these two volumetric spaces. If
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

We have developed the following color scheme for the
score values. For a high T1 score, indicating hemorrhage,
red is the obvious choice. For regions with a high T2 score,
blue is used to represent the location of suspect cancerous
areas. For the MRSI score, purple is used to indicate increased ratios. The prostate gland itself is rendered as a semitransparent tan color and the seminal vesicles as a semitransparent green color. The transfer functions controlling
the gland colors (prostate and SVs) are applied to the label
map volume, while the transfer functions for the score colors
are applied to the score volume. The T2 -w data itself is not

1056

J. Marino & A. Kaufman / Prostate Cancer Visualization

Figure 6: Rendering examples of the score values with various levels of transparency.

(a) Isosurfaces

(b) Visibility Persistence

(c) Transparency

Figure 7: Rendering example of T2 (blue) and T1 (red) scores with visibility persistence for the T2 score (green).
used in the volume rendering. We present the user with two
standard options for rendering the prostate score data:
Isosurface Score View: The solid isosurfaces of each of
the score values are viewed. This mode is typically done
with a single score value at a time. Examples of the three
scores rendered individually can be seen in Figure 4.
Since the T2 score is a quaternary value, the isosurface
is set so that a score ≥ 0.66 is required (i.e., at least two
of the T2 -w volumes indicated decreased signal).
Since only T2 scores exist within the seminal vesicles, its
coloring is tied to that of the T2 score for the prostate and
uses the same blue color. An example of the seminal vesicles with SV invasion indicated is shown in Figure 5.
Transparent Score View: When viewing multiple scores
together, user-defined transparency per score is typically
used. This is most useful if the user wants to see relationships between different scores (e.g., between a cancerous
T2 score and a hemorrhage T1 score). Examples of combinations of multiple score renderings with transparency
are shown in Figure 6.
6.2. Visibility Persistence
In addition to standard rendering of the prostate score volumes, we provide a score rendering method called visibility
persistence. This mode will assist in keeping a score of interest (i.e., the persistent score) visible when other scores
may occlude it. This mode will also indicate whether the occluded score is inside of the occluding score (i.e., they overlap). This is accomplished by tinting it green, a color which
is otherwise not used within the prostate.

The visibility persistence is accomplished using a modified compositing strategy. A second volume rendering integral is accumulated with reduced color and opacity values
for the non-persistent scores. The discretized volume rendering integral will then contain the standard front-to-back
compositing as such:
Cdst ← Csrc × (1 − αdst ) +Cdst
αdst ← αsrc × (1 − αdst ) + αdst
where
Csrc ← Cgland +CPersistentScore +COtherScores
αsrc ← αgland + αPersistentScore + αOtherScores
and will also contain:
Cdst2 ← Csrc2 × (1 − αdst2 ) +Cdst2
αdst2 ← αsrc2 × (1 − αdst2 ) + αdst2
αscore ← αPersistentScore × (1 − αscore ) + αscore
where
CTint ← Tinter(COtherScores )
CTint ← CPersistentScore +CTint × αPersistentScore
Csrc2 ← Cgland +CTint + 0.1 ×COtherScores
αsrc2 ← αgland + αPersistentScore + 0.1 × αOtherScores
The Tinter function accumulates the intensities of the
non-persistent score colors into the green channel of CTint ,
which is then modulated by αPersistentScore and added to
CPersistentScore . At the end of the volume rendering integral,
the final output color and opacity are composited as such:
Cdst ← Cdst2 × αscore +Cdst × (1 − αscore )
αdst ← αdst2 × αscore + αdst × (1 − αscore )
where the αscore value for blending is used to prevent a
jagged halo effect around the persistent score.
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

J. Marino & A. Kaufman / Prostate Cancer Visualization

1057

Figure 8: Viewing the angle between the prostate and the
rectum (endorectal coil), looking towards the patient’s head.
As shown in Figure 7, the spatial relationships of the
scores and gland are fully maintained by this method. In
contrast to making one score transparent to view another occluded behind it, this mode allows for an occluded score to
automatically be visible, while the other scores will maintain their full opacity unless they are occluding the score of
interest. This method also gives context by showing if one
score is inside of another, or simply behind it, by tinting the
persistent score green when the scores overlap.
6.3. Surrounding Anatomy
Single-pass multi-volume rendering is used when including
the surrounding anatomy. For each ray, its starting position
and direction are calculated for both the prostate region volume and the pelvic region volume. The steps along each ray
are adjusted to be the same length, such that steps along one
ray are colocated with steps along the other ray, and the number of steps to enter and exit each of the volumes is calculated. Since the pelvic region is larger and fully encompasses
the prostate region, it is guaranteed that a sample position
in the prostate region will also be within the pelvic region,
though most sample points within the pelvic region will not
be within the prostate region. Separately calculated for the
rays are the number of steps within the pelvic region before reaching the prostate region, the number of steps within
both, and the number of steps after the prostate region until exiting the pelvic region. Using these values, the rays are
cast through the volumes, and the prostate region is sampled
only when the current position is within the correct range.
The pelvis and other nearby bones account for the majority of the area in the pelvic region volumes. When the
bones are not being rendered, the minimum and maximum
extent of the remaining anatomy (bladder and rectum) are
calculated and the sampling rays are cast only through this
bounding box, reducing the amount of area being traversed
to approximately 10% of the full size. The prostate region is
between these two objects and thus will not be missed.
The rectum is rendered as an orange semi-transparent isosurface. The user is able to easily observe the angle between
the rectum and the prostate surface (see Figure 8). Similar
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Figure 9: Screenshot of the user interface with examples of
light blue user painted regions in both 3D and 2D views.
to the rectum, the bladder is rendered as a yellow semitransparent isosurface. The bones are rendered as slightly
off-white isosurfaces. The user is not able to modify the
translucency of these objects, though the visibility of each
of these three objects can be toggled on or off as desired.
Unlike for the prostate region, the transfer functions for
the pelvic region are applied to the T1 -w MR data, allowing
for a less precise segmentation. Due to this, these objects
can take on a stepped appearance in the superior-inferior direction because of the low interslice resolution. However,
the shape of these objects is not as important as that of the
prostate, which is fully smoothed due to the rendering of the
upsampled label map and score data directly.
6.4. Interactive Region Painting
We provide the ability for the user to manually denote regions of interest on the 2D slices, and these regions are then
updated in the 3D view. Within the user interface (Figure
9), the user can quickly switch between slice views and can
view a slice directly next to the 3D rendering. Demarcations
within one slice can be viewed on the other slices for correlation, and the user can modify as required by looking at
all views. The user is also able to select their own custom
colors when painting lines or filling regions so that separate
entities can be easily distinguished and correlated between
the 2D slice views and the 3D rendering view.
To accomplish this, a new paint volume based on the upsampled T1 -w label map is created with four channels to allow for various colors to be held. One difference between the
dimensions of this volume and that of the upsampled T1 label
map is that the paint volume has twice the resolution in the
z-dimension (0.75 mm) to allow for greater accuracy when
denoting areas on the T2 -w slices. Though coarser than the
T2 -w images, this resolution is sufficient for marking areas;
since the paint volume must cover the entire region (prostate
and pelvis), maintaining a higher resolution would require
more memory and processing power with little advantage.

1058

J. Marino & A. Kaufman / Prostate Cancer Visualization

(a) 35 fps

(b) 54 fps

(c) 38 fps

(d) 26 fps

(e) 20 fps

Figure 10: Performance examples for the five main types of rendering: (a) all objects in the scene, (b) all objects except for the
bones, (c) only the prostate region, (d) visibility persistence, and (e) with user painted custom regions.
Table 1: Typical dataset properties.
Dataset Volume
Volume Size (voxels) Voxel Spacing (mm)
Data Type
Channels
T2 -w Axial, Sagittal, Coronal
256 × 256 × 20-24 0.55 × 0.55 × 3.00 16-bit signed int
1
T1 -w Axial
256 × 256 × 34
0.93 × 0.93 × 6.00 16-bit signed int
1
MRSI
7 × 3 × 12
6.88 × 7.31 × 3.00
32-bit float
2
Score Volume, Composite Label Map
256 × 256 × 89
0.55 × 0.55 × 0.75 8-bit unsigned int
3
Trimmed Score Volume, Composite Label Map
115 × 89 × 78
0.55 × 0.55 × 0.75 8-bit unsigned int
3
Upsample T1 Label Map
256 × 256 × 133
0.94 × 0.94 × 1.50 8-bit unsigned int
4

When the user draws out a region, a custom color of
choice can be selected to be used as both the overlay in
the slice view and for the 3D rendering. As with the normal
score volume, these painted regions can be turned on, off, or
transparent as desired by the user. For rendering, the paint
volume is smoothed with a 3 × 3 × 3 mean filter to yield a
more natural look. The minimum and maximum extent of
the these regions are used in defining a bounding box for ray
casting so empty areas do not need to be traversed. No transfer function is used, as the color and opacity information is
supplied directly in the paint volume.
7. Experimental Details
We have developed our work using C++ with OpenGL and
Cg on a dual quad core Intel Xeon E5430 2.66 GHz machine
and an NVIDIA GTX 480 graphics card. The initial camera
orientation for the volume rendering is LPS (Left-PosteriorSuperior) orientation, which is standard for DICOM. Intuitive navigation around the scene uses arcball rotation based
at the center of the prostate region.
The data used in this work comes from the ACRIN 6659
study [WBC∗ 09] and we have built our system around their
standard clinical protocol for MR imaging of the prostate.
This ACRIN study was a large, multi-institutional study, and
one goal was to be able to establish a protocol for MR acquisition that would be followed at multiple hospitals in order
to obtain consistent data. The properties of a typical dataset,
including original and processed data, are shown in Table 1.
7.1. Performance
There are four basic computational processes in the pipeline.
First, the four label map segmentations are upsampled. Then,
the three upsampled T2 -w label maps are combined to form

a composite label map. Third, the score volume is created.
Finally, the score volume and composite label map volume
are trimmed and these two along with the upsampled T1 -w
label map are mean filtered to improve the rendering results.
The average running time for these steps is 14 seconds.
The performance of the volume rendering varies depending on what regions and objects are being viewed. All renderings maintain interactive performance. Figure 10 shows
the five basic types of rendering with differing performance
(all objects, without bone, prostate only, persistence, and
painted region), and their performance in frames per second
(fps). These have a render target of 512 × 512 pixels.
7.2. Score Evaluation
Although our focus is on developing the visualization techniques for a CaP detection system, we have evaluated our
scoring system by comparing against the results of the
ACRIN 6659 study. For this study, the MR acquisitions were
performed on patients 4-6 weeks after needle biopsy and before radical prostatectomy. The determinations of both radiologists and pathologists were denoted for each sextant
of the prostate. The six sextants are formed by splitting the
gland into left and right halves and further splitting them into
apex, midgland, and base sections from top to bottom. Since
the results from the MRSI are very broad and non-specific,
we consider only the T2 and T1 scores in our evaluation.
For each patient dataset, a total of eight radiologists reviewed the MR data and made determinations as to the presence of cancer and hemorrhage on a per-sextant basis. For
the cancer determinations, a ranking on a scale of one to five
was used, with one indicating definitely no cancer and five
indicating definitely cancer. To compare against our results,
we drop the minimum and maximum scores (to eliminate
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

1059

J. Marino & A. Kaufman / Prostate Cancer Visualization

Table 2: Sextant evaluation for cancer in the prostate.
Cancer
Diagnosis
cancer
no cancer

Pathology [GT]
(# Sextants)
15
3

T2 Score
(# Correct)
14
3

Radiologists
(# Correct)
7
2

Table 3: Seminal vesicle evaluation for cancer invasion.
Seminal Vesicle
Invasion
yes
no

Pathology [GT]
(# Cases)
2
1

T2 Score
(# Correct)
1
0

outliers), average the remaining six, and consider an average of three or greater to indicate cancer. For determining
hemorrhage, the radiologists’ results are taken as the ground
truth since this is not indicated from the pathology.
Given the excised prostate, a pathological analysis was
performed on it, and results were reported for cancer in the
prostate, again on a per-sextant basis. The pathology report
also indicates whether or not there was invasion of the seminal vesicles. The results from the pathology (both cancer
determination in the prostate and seminal vesicle invasion)
are taken as the ground truth in evaluating our system.
The results of testing our system on three datasets (different from those used in determining the thresholds) are summarized in Tables 2-4, where [GT] indicates the ground truth
column. For the determination of cancer in a sextant (Table 2), we note that the results from our system were better
than from the radiologists. However, further work is needed
to see how accurate the specific regions are (this information is not provided with the ACRIN data). Our method was
less successful for detecting SV invasion (Table 3), though
this problem is more difficult (the radiologists in the ACRIN
study were not asked to determine this). For the detection of
hemorrhages (Table 4), the simple threshold method proves
to be very effective, no doubt due to the large disparity between normal and hemorrhaged tissue.
We have also calculated the extent of consensus among
the radiologists when their average opinion was incorrect.
For this, the radiologists’ scores were ternarized into negative (1-2), undecided (3), and positive (4-5). First removing the undecided scores so as to focus on the deterministic scores, we calculated the percentage of the scores which
yielded the incorrect average opinion; a larger percentage indicates greater agreement amongst the radiologists. For the
nine incorrect sextants in Table 2, three had a consensus in
the range of 85% - 100%, three were in the range of 75% 84%, and the remaining were in the range of 60% - 74%.
7.3. Physician Evaluation
We have discussed and shown our system to a radiologist
and received positive feedback from him. He noted the possible utility of the system for surgery planning, and observed
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Table 4: Sextant evaluation for hemorrhage.
Post-Biopsy
Hemorrhage
hemorrhage
no hemorrhage

Radiologists [GT]
(# Sextants)
6
12

T1 Score
(# Correct)
6
12

the utility of being able to manually indicate regions and visualize shapes. Regarding the use of MRSI, he noted that it
was most often not of use, and was focused more on the T2 w and T1 -w data. It was also observed that the color scheme
chosen was intuitive and easy to understand.
8. Conclusion
The detection and treatment of CaP is a very important medical application. We have presented a framework for the visualization of the prostate, its surrounding anatomy, and indications for tumor and hemorrhage location within the gland.
To provide for this visualization, we introduce the idea of
a score volume for rendering the multi-modal data. A score
volume is first created for the gland and seminal vesicles
which takes into account three T2 -w datasets, a T1 -w dataset,
and an MRSI dataset. Based on thresholds, every voxel is
scored as to whether each MR mode indicates a point of
interest. We have also evaluated these scores against the
pathology and radiologists’ determinations.
The created score volume can be integrated into a slicebased viewing approach, or applied for 3D visualization of
the anatomy and scores in an interactive framework which
allows the user to adjust the content being viewed. Various
view modes of the score volume are possible so that the user
can focus on the desired results. We introduced the idea of
a visibility persistence mode, allowing one score to remain
visible when it would otherwise be occluded and indicating
overlaps. The use of a score volume for volume rendering
is generalizable to any CAD application, as the method of
determining the scores is separate from the rendering.
We are continuing to evaluate our system using further
datasets to refine our analysis and the visual presentation of
the analysis results. We are working with physicians to assess the utility of this tool and evaluate their specific needs.
We also hope to explore other types of MR acquisitions, such
as dynamic contrast-enhanced, diffusion-weighted, and perfusion imaging, and investigate how they can be incorporated into our analysis and visualization framework. Also of
interest is investigating the use of such a system for simulating treatment plans, such as ablation therapy.
Acknowledgments
This work has been supported by NIH grant R01EB7530 and
NSF grants IIS0916235, CCF0702699, and CNS0959979.
The MR datasets were acquired for the ACRIN 6659 study
and are courtesy of ACRIN. We thank Dr. Mark Wax for
reviewing the system and providing useful feedback.

1060

J. Marino & A. Kaufman / Prostate Cancer Visualization

References
[BG06] B RUCKNER S., G RÖLLER M. E.: Exploded views for
volume data. IEEE Trans. on Visualization and Computer Graphics 12, 5 (September 2006), 1077–1084. 2
[BHWB07] B EYER J., H ADWIGER M., W OLFSBERGER S.,
B ÜHLER K.: High-quality multimodal volume rendering for preoperative planning of neurosurgical interventions. IEEE Trans.
on Visualization and Computer Graphics 13, 6 (November 2007),
1696–1703. 2
[BKW08] B ÜRGER K., K RÜGER J., W ESTERMANN R.: Direct
volume editing. IEEE Trans. on Visualization and Computer
Graphics 14, 6 (Nov. 2008), 1388–1395. 3
[CM09] C ORREA C. D., M A K.-L.: The occlusion spectrum for
volume classification and visualization. IEEE Trans. on Visualization and Computer Graphics 15, 6 (November/December
2009), 1465–1472. 2
[CS99] C AI W., S AKAS G.: Data intermixing and multi-volume
rendering. Computer Graphics Forum 18, 3 (1999), 359–368. 2
[HKC04] H ERSH M. R., K NAPP E. L., C HOI J.: Newer imaging
modalities to assess tumor in the prostate. Cancer Control 11, 6
(Nov. 2004), 353–357. 1
[JJFP07] JANI A. B., J OHNSTONE P. A. S., F OX T., P ELIZZARI
C.: Optimization of opacity function for computed tomography volume rendered images of the prostate using magnetic resonance reference volumes. Intl. Journal of Computer Assisted
Radiology and Surgery 1, 5 (February 2007), 285–293. 2
[Loc07] L OCH T.: Urologic imaging for localized prostate cancer
in 2007. World Journal of Urology 25 (2007), 121–129. 1
[LSRM05] L EE Z., S ODEE D. B., R ESNICK M., M ACLENNAN
G. T.: Multimodal and three-dimensional imaging of prostate
cancer. Computerized Medical Imaging and Graphics 29 (2005),
477–486. 2
[MKM∗ 09] M AC M AHON P. J., K ENNEDY A.-M., M URPHY
D. T., M AHER M., M C N ICHOLAS M. M.: Modified prostate
volume algorithm improves transrectal US volume estimation in
men presenting for prostate brachytherapy. Radiology 250, 1
(January 2009), 273–280. 2
[MSF∗ 06] M ADABHUSHI A., S HI J., F ELDMAN M. D., ROSEN
M., T OMASZEWSKI J.: Comparing ensembles of learners: Detection prostate cancer from high resolution MRI. Proc. of Computer Vision Approaches to Medical Image Analysis (2006), 25–
26. 2
[PBFP05] PARKIN D. M., B RAY F., F ERLAY J., P ISANI P.:
Global cancer statistics, 2002. CA: A Cancer Journal for Clinicians 55, 2 (March/April 2005), 74–108. 1

[Rob02] ROBB R. A.: Three-dimensional visualization and analysis in prostate cancer. Drugs of Today 38, 3 (2002), 153–165.
2
[RWS∗ 10]

R IEDER C., W EIHUSEN A., S CHUMANN C., Z I S., P EITGEN H.-O.: Visual support for interactive
post-interventional assessment of radiofrequency ablation therapy. Computer Graphics Forum 29, 3 (2010), 1093–1102. 2
DOWITZ

[SHC∗ 09] S MELYANSKIY M., H OLMES D., C HHUGANI J.,
L ARSON A., C ARMEAN D. M., H ANSON D., D UBEY P., AU GUSTINE K., K IM D., K YKER A., L EE V. W., N GUYEN A. D.,
S EILER L., ROBB R.: Mapping high-fidelity volume rendering for medical imaging to cpu, gpu and many-core architectures. IEEE Trans. on Visualization and Computer Graphics 15,
6 (November/December 2009), 1563–1570. 2
[TMR07] T IWARI P., M ADABHUSHI A., ROSEN M.: A hierarchical unsupervised spectral clustering scheme for detection of
prostate cancer from magnetic resonance spectroscopy (MRS).
Proc. of International Conference on Medical Image Computing
and Computer-Assisted Intervention 10 (Pt 2) (2007), 278–286.
2
[VKG04] V IOLA I., K ANITSAR A., G RÖLLER M. E.:
Importance-driven volume rendering.
Proc. IEEE Visualization (2004), 139–145. 3
[WBC∗ 09] W EINREB J. C., B LUME J. D., C OAKLEY F. V.,
W HEELER T. M., C ORMACK J. B., S OTTO C. K., C HO H.,
K AWASHIMA A., T EMPANY-A FDHAL C. M., M ACURA K. J.,
ROSEN M., G ERST S. R., K URHANEWICZ J.: Sextant localization at MR imaging and MR spectroscopic imaging before
prostatectomy - results of ACRIN prospective multi-institutional
clinicopathologic study. Radiology 251, 1 (April 2009), 122–133.
3, 8
[WCQ∗ 08] W ESTPHALEN A. C., C OAKLEY F. V., Q AYYUM
A., S WANSON M., S IMKO J. P., L U Y., Z HAO S., C ARROLL
P. R., Y EH B. M., K URHANEWICZ J.: Peripheral zone prostate
cancer: Accuracy of different interpretative approaches with MR
and MR spectroscopic imaging. Radiology 246, 1 (January
2008), 177–184. 3
[WZL∗ 10] W U Y., Z HANG S.-X., L UO N., Q IU M.-G., TAN
L.-W., L I Q.-Y., L IU G.-J., L I K.: Creation of the digital
three-dimensional model of the prostate and its adjacent structures based on Chinese visible human. Surgical and Radiologic
Anatomy 32 (2010), 629–635. 2
[ZWZ06] Z HU Y., W ILLIAMS S., Z WIGGELAAR R.: Computer
technology in detection and staging of prostate carcinoma: A review. Medical Image Analysis 10, 2 (2006). 2, 3, 4

[PHF07] P LATE J., H OLTKAEMPER T., F ROEHLICH B.: A flexible multi-volume shader framework for arbitrarily intersecting
multi-resolution datasets. IEEE Trans. on Visualization and Computer Graphics 13, 6 (November 2007), 1584–1591. 2
[PLV∗ 07] PASQUIER D., L ACORNERIE T., V ERMANDEL M.,
ROUSSEAU J., L ARTIGAU E., B ETROUNI N.: Automatic segmentation of pelvic structures from magnetic resonance images
for prostate cancer radiotherapy. International Journal of Radiation Oncology, Biology, Physics 68, 2 (June 2007), 592–600. 4
[RBE08] RÖSSLER F., B OTCHEN R. P., E RTL T.: Dynamic
shader generation for GPU-based multi-volume ray casting.
IEEE Computer Graphics and Applications 28, 5 (September
2008), 66–77. 2
[RHR∗ 09] ROPINSKI T., H ERMANN S., R EICH R., S CHAFERS
M., H INRICHS K.: Multimodal vessel visualization of mouse
aorta PET/CT scans. IEEE Trans. on Visualization and Computer
Graphics 15, 6 (November/December 2009), 1515–1522. 2
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.


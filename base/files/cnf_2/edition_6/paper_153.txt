DOI: 10.1111/j.1467-8659.2010.01762.x
Eurographics Symposium on Geometry Processing 2010
Olga Sorkine and Bruno Lévy
(Guest Editors)

Volume 29 (2010), Number 5

Fuzzy Geodesics and Consistent Sparse Correspondences
For Deformable Shapes
Jian Sun and Xiaobai Chen and Thomas A. Funkhouser
Princeton University, Princeton NJ, 08544 USA

Abstract
A geodesic is a parameterized curve on a Riemannian manifold governed by a second order partial differential
equation. Geodesics are notoriously unstable: small perturbations of the underlying manifold may lead to dramatic changes of the course of a geodesic. Such instability makes it difficult to use geodesics in many applications,
in particular in the world of discrete geometry. In this paper, we consider a geodesic as the indicator function of
the set of the points on the geodesic. From this perspective, we present a new concept called fuzzy geodesics and
show that fuzzy geodesics are stable with respect to the Gromov-Hausdorff distance. Based on fuzzy geodesics, we
propose a new object called the intersection configuration for a set of points on a shape and demonstrate its effectiveness in the application of finding consistent correspondences between sparse sets of points on shapes differing
by extreme deformations.
Categories and Subject Descriptors (according to ACM CCS):
Generation—Line and curve generation

I.3.3 [Computer Graphics]: Picture/Image

1. Introduction
The shortest geodesic between two points on a complete Riemannian manifold is the path whose length is shortest. This
path conveys much richer information about the underlying
manifold than the geodesic distance itself. However, there
may exist multiple shortest geodesics between two points
on a manifold, which makes the shortest geodesic notoriously unstable. Small perturbations of the underlying manifold may lead to a dramatic change of the shortest geodesic,
and thus it is difficult to use geodesics in shape analysis applications.
To overcome this limitation, we propose a new concept
called fuzzy geodesics. The fuzzy geodesic for any two
points p and q is a function over the underlying manifold indicating for every point x how long is the shortest path from
p to q through x in comparison to the shortest geodesic from
p to q directly. The main value of this formulation is that
it provides a stable way to utilize geodesics in shape analysis applications. We prove that fuzzy geodesics are stable
with respect to perturbations as measured by the GromovHausdorff distance (Section 3).
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

Figure 1: The sum of the fuzzy geodesics between all pairs
of marked points.

Comparing to the geodesic distance which by definition
is stable with respect to the Gromov-Hausdorff distance,
fuzzy geodesics encode much richer geometric information.
In many applications, a set of feature points is often used
to represent a shape, where the spatial relationship between
these feature points is important, but difficult to express.
With the help of fuzzy geodesics which act like a set of
fuzzy ropes bounding the shape (Figure 1), we introduce
a new way to describe the spatial arrangement of a set of

1536

J. Sun & X. Chen & T. A. Funkhouser / Fuzzy Geodesics and Consistent Sparse Correspondences For Deformable Shapes

points on a manifold using the intersection pattern of pairwise fuzzy geodesics, which we call intersection configuration(Section 4). We find that differences in this intersection configuration are effective at distinguishing correct
point correspondences from incorrect ones during experiments with a variety of meshes differing by extreme deformations (Section 5).
2. Background and related work
A geodesic on a Riemmannian manifold M is a curve γ :
I → M such that the changing rate of the tangent vector of γ
(given by the covariant derivative) vanishes at any point on γ.
The geodesic is a classical concept in differential geometry
and has been studied extensively [dC92]. The geodesic distance between any two points p, q ∈ M, denoted as dM (x, y),
is the infimum of the lengths of all path joining p, q. If
the manifold M is complete, there must exist a minimizing geodesic joining p, q that attains the geodesic distance,
which we will call the geodesic between p, q for the remainder of the paper.
In the discrete setting, computing the geodesics has been
studied extensively [Pap85]. Mitchell et al. [MMP87] presented an algorithm to compute the shortest geodesic between any two points on a polygonal surface, and Surazhsky
et al. proposed a fast implementation [SSK∗ 05]. Dijkstra’s
algorithm can also be used to find approximate geodesics by
working with a graph formed by the mesh’s 1-skeleton.
The convergence of geodesics has also been studied [HPW06, DL09], where a discrete representation (e.g.,
polygonal surface or point set) is considered as an approximation of some smooth manifold. The convergence of
geodesics studies if a shortest path on the discrete representation converge to a geodesic on the smooth manifold when
the approximation error of the discrete representation to the
smooth manifold goes to zero. Hildebrandt et al [HPW06]
and Dey and Li [DL09] show the subsequence convergence
of geodesics from polygonal surfaces and point clouds respectively.
However, the convergence of geodesics does not imply it
is stable. In particular, geodesics are not stable at cut points.
A cut point of a geodesic γ issued from the point p is the
point where γ ceases to be minimizing. The cut locus of p
is all cut points on the geodesics issued from p. If there are
multiple geodesics between p, q, then p is on the cut locus
of q and vice verse. Therefore, if a geodesic passing through
two points that are close to each other’s cut locus, small perturbations may lead to dramatic change of that geodesic.
3. Fuzzy Geodesics
In this section, we define fuzzy geodesics, and show their
stability with respect to perturbations.
Definition: To define fuzzy geodesics, let us consider the

image of the geodesic γ on the manifold M, also denoted
as γ. The indicator function of γ, denoted as χγ , is defined
as follows: χγ (x) = 1 if x ∈ γ and 0 otherwise. The indicator function χγ is an equivalent representation of γ. The idea
of fuzzy geodesic is basically to obtain a smoothed indicator function. However, naively smoothing the indicator function will not make it stable due to the existence of multiple
minimizing geodesics between two points. To overcome this
problem, we introduce the fuzzy geodesic, which is defined
as follows.
Definition 3.1 Given a parameter σ > 0, the fuzzy geodesic
between any two points p and q on a Riemannian manifold
M is defined as a function G σp,q : M → R:
G σp,q (x) = exp −

|dM (x, p) + dM (x, q) − dM (p, q)|
. (1)
σ

Intuitively, the fuzzy geodesic G σp,q (x) indicates for every
point x how long is the shortest path from p to q through x
in comparison to the shortest geodesic from p to q directly.
It attains the maximum value of one at points on the shortest geodesic(s) between p and q and less values (between
zero and one) at other points (Figure 2). If there are multiple
shortest geodesics, G σp,q (x) reaches maximum on all of them.
The parameter σ controls the fuzziness. The bigger the σ
is, the fuzzier fuzzy geodesics are. In the extreme, when σ
goes to infinity, G σp,q becomes a constant function 1. When
σ goes to 0, G σp,q (x) becomes the indicator function of all
minimizing geodesics between p, q. In between, larger values of σ produce fuzzy geodesics with larger values at points
further from the shortest geodesics (Figure 2).
The time complexity of computing the fuzzy geodesic
between two points is the same as that of computing the
geodesic distance from two sources to all other points. In
particular, on a triangle mesh with n vertices, if we use Dijkstra’s algorithm to approximate geodesic distance over the
1-skeleton of the mesh, the complexity of computing fuzzy
geodesic between a pair of points is O(n log n).
It should be noted that the fuzzy geodesics definition is
very general (it depends only on a distance metric), and thus
fuzzy geodesics can be computed for a wide variety of input
types, including meshes, point clouds, graphs, etc., as long
as a distance between points can be defined.
Stability: To analyze the stability of fuzzy geodesics, we
consider how the fuzzy geodesic function changes in relation to the Gromov-Hausdorff distance as a shape deforms [Gro99]. The Gromov-Hausdorff distance is commonly used to measure shape deformations [MS05,SMC07],
and thus it provides a good measure for how similar two
shapes are. Our goal is to show that two shapes with a small
Gromov-Hausdorff distance provably have a small difference in their fuzzy geodesics.
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

J. Sun & X. Chen & T. A. Funkhouser / Fuzzy Geodesics and Consistent Sparse Correspondences For Deformable Shapes

X

1537

Y
f

x1

f (x1 )

x2

f (x2 )

g

Figure 3: Illustration of Theorem 3.2.

Theorem 3.2 For any two bounded metric spaces (X, dX )
and (Y, dY ), there exist the maps f : X → Y and g : Y → X
such that
1. for any two points x1 , x2 ∈ X,
Figure 2: Fuzzy geodesics between two fixed points with the
parameter σ equals 0.05%, 5%, 500% of the geodesic diameter respectively from left to right. Both front (top) and back
(bottom) are shown.
Formally, the Gromov-Hausdorff distance between two
metric spaces (X, dX ) and (Y, dY ), denoted dGH (X,Y ), is defined as
dGH (X,Y ) = inf

Z, f ,g

Z
dH
( f (X), g(Y ))

If X,Y are bounded, then we have the following equivalent
definition, see [MS05] and the references therein.
f ,g

(3)

where f : X → Y and g : Y → X are any function and
A( f ) =

sup |dX (x1 , x2 ) − dY ( f (x1 ), f (x2 ))| and

x1 ,x2 ∈X

B( f ) =

sup |dY (y1 , y2 ) − dX (g(y1 ), g(y2 ))| and

y1 ,y2 ∈Y

C( f , g) =

sup |dX (x, g(y)) − dY ( f (x), y)|.

∞

σ
Gx1,x2
◦ g − G σf (x1 ), f (x2 )

∞

4dGH (X,Y )
and
σ
4dGH (X,Y )
.
≤
σ
≤

2. for any two points y1 , y2 ∈ Y ,
σ
σ
Gy1,y2
◦ f − Gg(y
1 ),g(y2 )

∞

σ
σ
− Gg(y
◦g
Gy1,y2
1 ),g(y2 )

∞

4dGH (X,Y )
and
σ
4dGH (X,Y )
.
≤
σ
≤

(2)

where f : X → Z and g : Y → Z are isometric embeddings
Z
is the Hausdorff distance in
into the metric space Z and dH
the space Z. Note that the usual embedding of a surface into
R3 by inclusion is often not isometric as the geodesic distance between two points on the surface is different from
their Euclidean distance in R3 . Nevertheless, such a space Z
does always exist. For example, the product of X and Y with
the metric dX + dY is a possible choice of Z.

dGH (X,Y ) = inf max{A( f ), B(g),C( f , g)}

σ
Gx1,x2
− G σf (x1 ), f (x2 ) ◦ f

(4)

x∈X,y∈Y

As the definition of fuzzy geodesics only involves the distances, the stability of fuzzy geodesics follows from the definition of the Gromov-Hausdorff distance in a straightforward way. For the same reason, fuzzy geodesics can be extended and defined on any metric space and thus we state our
stability theorem in this more general setting.
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

Before proving it, some explanation of this theorem is in
order. Although the theorem holds for any two metric spaces,
to understand the theorem, one can think of Y as a small perturbation of X, see Figure 3. The map f , g are the maps that
almost retain the Gromov-Hausdorff distance, see Eqn(3).
When perturbation is small, f , g give the correspondence between X and its perturbed version Y . Now let us consider
the first two inequalities in the theorem. For any two points
x1 , x2 on X, we want to see how much the fuzzy geodesic
Gx1 ,x2 changes after perturbation. Since f (x1 ), f (x2 ) are the
corresponding points of x1 , x2 after perturbation, it is natural to compare Gx1 ,x2 with G f (x1 ), f (x2 ) . We can compare them
over the space X (given by the first inequality), or over the
perturbed space Y (given by the second inequality). The last
two inequalities in the theorem can be explained in a similar
way.
Proof We first prove the first inequality. Set ε = dGH (X,Y ).
If ε = 0, then X and Y are isometric to each other. Let f be an
isometric map from X to Y and g be its inverse. Obviously,
the inequality holds in this case. Now assume ε > 0. From
Eqn(3), for any η > 0, there exist the maps f : X → Y and
g : Y → X such that for any y ∈ Y , we have
|dX (x1 , x2 ) − dY ( f (x1 ), f (x2 ))| < ε + η and
|dX (g(y), x1 ) − dY (y, f (x1 ))| < ε + η and
|dX (g(y), x2 ) − dY (y, f (x2 ))| < ε + η.
σ
Note that both Gx1,x2
◦ g and G σf (x1 ), f (x2 ) are the functions

1538

J. Sun & X. Chen & T. A. Funkhouser / Fuzzy Geodesics and Consistent Sparse Correspondences For Deformable Shapes

4. Intersection Configuration

Figure 4: Changes of fuzzy geodesics due to the change of
topology.

over Y . For any point y ∈ Y we have
| (dX (g(y), x1 ) + dX (g(y), x2 )) − dX (x1, x2))
− (dY (y, f (x1 )) + dY (y, f (x2 )) − dY ( f (x1 ), f (x2 )))|
< 3(ε + η)
Hence
σ
|Gx1,x2
(g(y)) − G σf (x1 ), f (x2 ) (y)| < |1 − e−

3(ε+η)
σ

|<

3(ε + η)
(5)
σ

which shows the first inequality by choosing η = ε/3. The
other inequalities can be proved in a similar way. Note that
the map f , g can be chosen so that all four inequalities hold
for fixed f , g.
The Lipschitz constant is proportional to the reciprocal of
the parameter σ. This means σ controls the stability of the
fuzzy geodesics. Small σ makes fuzzy geodesics less stable
but more precise while big σ makes fuzzy geodesics more
stable but less precise. When the Gromov-Hausdorff distance between X,Y is small, we can afford to use small σ
to obtain both stable and precise fuzzy geodesics. However,
when the Gromov-Hausdorff distance between X,Y are big,
we have to use big σ to have stable fuzzy geodesics. Consequently fuzzy geodesics are becoming less precise.

In this section, we introduce a model for structural differences between point sets based on fuzzy geodesics. Intuitively, we note that the pairwise fuzzy geodesics within a
set of potential point correspondences form a set of “fuzzy
ropes” bounding the shape (Figure 1), and the crossing pattern of those “ropes” is indicative of the structural arrangement of the points. Therefore, we aim to represent a shape
by the pattern of fuzzy geodesic intersections, which we call
its intersection configuration.
Before defining the intersection configuration, we first define the intersection of two fuzzy geodesics, which is also a
function.
Definition 4.1 For any two pairs (p, q) and (u, v) on a Riemannian manifold M, the intersection of the fuzzy geodesics
u,v
G p,q and Gu,v , denoted I p,q , is their point-wise multiplicau,v
tion, namely I p,q : M → R:
u,v
(x) = G p,q (x) · Gu,v (x).
I p,q

(6)

It is obvious that the intersection of two fuzzy geodesics is
also stable with respect to the Gromov-Hausdorff distance,
but the error becomes quadratic in terms of the Gromovu,v
Hausdorff distance. The p-norm I p,q
p of the intersection function tells how much two fuzzy geodesics intersect,
which is a stable isometric invariant. In particular, for small
q,q
σ, Iq,q p with 1 ≤ p < ∞ contains the information of
Gauss curvature around q as the geodesic disk of a fixed radius has big area if the Gauss curvature is negative and small
area if it is positive.
Now we are ready to introduce our intersection configuration, which basically records how much each pair of fuzzy
geodesics intersects.
Definition 4.2 Given a set of points S = {si }m
i=1 in X, its
intersection configuration, denoted IC S , is a four dimensional square matrix of size m where the entry (i, j, k, l) is
the p-norm of the intersection of the fuzzy geodesics Gsi ,s j
and Gsk ,sl , namely IC S (i, j, k, l) = Issik,s,sjl p .

It is interesting to see the stability of Fuzzy geodesics under topological changes. As seen from Figure 4, when the
topological changes are local (e.g. middle picture in Figure 4), it does not change Fuzzy geodesics very much, while
those that short cut the different parts of the shape (e.g.
right picture in Figure 4) can change Fuzzy geodesics a lot,
which is predicted by the stability theorem as it changes the
Gromov-Hausdorff distance a lot. One way to make it stable
against those changes is to define fuzzy geodesics based on
diffusion distances, which we leave as future work.

For a set of m points, the complexity of intersection configuration is O(m4 ). Note the matrix IC S has three fold
symmetry as IC S (i, j, k, l) = IC S ( j, i, k, l), IC S (i, j, k, l) =
IC S (i, j, l, k) and IC S (i, j, k, l) = IC S (k, l, i, j). For a triangle mesh with n vertices, the complexity of computing all
pairwise fuzzy geodesics is O(mn log n + m2 n) and thus the
total complexity of computing the intersection configuration
of S is O(mn log n + m4 n), if we use Dijsktra algorithm to
approximate geodesic distances.

In what follows, to simplify the notation, when there is
no confusion, we will drop the parameter σ in our notations.
For example. G p,q denote the fuzzy geodesic between p, q
for some fixed σ.

Finally, we propose a new way to determine the compatibility of a set of point correspondence based on intersection configuration, which we call intersection configuration
distance. Specifically, given a correspondence from X to Y ,
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

J. Sun & X. Chen & T. A. Funkhouser / Fuzzy Geodesics and Consistent Sparse Correspondences For Deformable Shapes

namely a set of points S ∈ X and a map h : S → Y , we want to
measure how good the map h is. The intersection configuration distance evaluates the map h as the difference between
IC S and IC h(S) with the proper labeling reflecting the map
h. Formally,
Definition 4.3 Given a sparse correspondence h : S =
{si }m
i=1 → Y from X to Y , we define the intersection configuration distance as
ICD(h) =

∑

|IC S (si , s j , sk , sl ) − IC h(S) (h(si ), h(s j ), h(sk ), h(sl ))|

Model
Human
Hand
Ant
Octopus
Armadillo

n
10.1
8.0
7.5
8.8
21.1

m
5.0
6.0
9.0
8.0
18.6

FP (s)
15.1
14.1
10.3
13.6
33.8

1539

IC (s)
2.3
3.3
2.7
3.5
19.0

Table 1: Average complexity and timing statistics (averaged
per category). n: number of vertices in thousands of a model;
m: number of feature points; FP: time in seconds to compute
HKS function and extract feature points; IC: time in seconds
to compute intersection configuration;

i, j,k,l

where we abuse the notation and denote IC S (si , s j , sk , sl ) the
entry in IC S corresponding to the pairs (si , s j ), (sk , sl ).
The intersection configuration distance measures how
similar crossings of fuzzy geodesics are, and thus we expect it is low for corresponding point set within the same
semantic class, and high for other
5. Experiment: Finding Sparse Correspondences
In this section, we investigate how intersection configurations, in particular intersection configuration distances, can
be useful for detecting consistent correspondences between
sets of points on two shapes differing by a non-rigid deformation. This application is extremely important, as finding correspondences is at the core of many shape analysis
applications [vKZHCO10]. A common approach is to enumerate sets of candidate point correspondences and then
choose the sets that minimize an error function measuring dissimilarities in the spatial configurations of corresponding points. The challenge is to define a discriminating and stable error function. Several error functions have
been proposed [BBK06, BR07, ZSCO∗ 08, JZvK07, OSG08,
WGQ08,LF09], most of which are aimed at measuring deviations from a particular transformation space – e.g., isometries. Thus, they are suitable for applications where those
types of deformations are expected (e.g., tracking of timevarying cloth surfaces). However, they are often not adequate for modeling intra-class differences between shapes,
where shape variations retain the same structure (same parts
in the same arrangement), but are not well-described by a
single transformation (e.g., a giraffe versus an antelope).
Other methods have measured differences in skeletal graph
structures [HSKK01, ATCO∗ 10]. However, they are generally not stable – i.e., the skeletal graphs extracted for two
objects of the same class may not have the same topology,
which complicates the comparison of these skeletal graph
structures.
Our approach is to measure differences between candidate correspondences using the intersection configuration
distance (ICD) described in the previous section. We hypothesize that this approach will be effective, since the ICD
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

is both stable and descriptive of structural arrangements of
points. The remainder of this section, describes experiments
to test this hypothesis.
Data set: Our test meshes were chosen from the Watertight
Models Track of SHREC 2007 Benchmark [GBP07] (Watertight in short). We test every pair of meshes within the following categories: Human, Ant, Octopus, Hand, Armadillo
and Fourleg (these classes were chosen because they contain
deformable shapes). The meshes were used directly without
any preprocessing, such as smoothing or simplification .
Point feature detection: For each mesh in the data set, we
extract a sparse set of feature points from the surface. While
many methods are possible for this step, we provide one that
chooses points from the maxima of a function which is invariant under isometry (with the goal of finding points likely
to correspond within the same object class). The function
we use is the heat kernel signature (HKS) proposed by Sun
et. al [SOG09] at one large time scale (as we are looking
for global correspondences). This function can be computed
efficiently (empirically linear in the number of vertices in
the mesh) as only a few eigenfunctions are needed to estimate HKS for a large time scale. In addition, we use persistent homology to measure the persistence of each maximum [ELZ00] where the filtration is induced by the HKS
function, and then sort all the maxima in the decreasing order of their persistence. To avoid noisy maxima, we choose
the first m most persistent maxima as our sparse point set.
Intersection configuration computation: For each mesh in
the data set, we compute the intersection configuration of the
extracted m point features. In these computations, we fixed
the parameter σ to be 10% of the geodesic diameter which
is evaluated as the maximum over all geodesic distances between any pair of points in the chosen sparse point set. We
compute intersection configuration using 1-norm.
Correspondence search: Finally, for every pair of meshes
in the same object class, we consider combinations of point
correspondence sets and evaluate the ICD error measure for
each one. We log the ICD computed for correspondence sets
that are both correct and incorrect and then gather statistics
to analyze how well the ICD is able to discriminate between

J. Sun & X. Chen & T. A. Funkhouser / Fuzzy Geodesics and Consistent Sparse Correspondences For Deformable Shapes
Geodesic Distance
ICD

0.6
0.4
0.2
0

0.5
0.4
0.3
0.2
0.1
0

5

10

0.8
0.6
0.4
0.2
20

21

22

23

24

25

26

27

28

0.6
0.4
0.2

0

1

0.2

24 25 26 27 28 29 210 211 212 213 214 215

0.8
0.6
0.4
0.2
21

22

23

24

25

26

27

28

29

1

0.8
0.6
0.4
0.2
0

0

1

2

2

2

2

3

0.8
0.6
0.4
0.2
0

4

2

2

Proportion of mesh pairs

Proportion of mesh pairs

Proportion of mesh pairs

0.4

0

2

1

Human

0.6

1

0.8

0

29

0.8

0

15

1
Proportion of mesh pairs

Proportion of mesh pairs

Ant

1

0

0.6

0

20 21 22 23 24 25 26 27 28 29 210 211 212

Proportion of mesh pairs

0.7

0.8

Proportion of mesh pairs

Proportion of mesh pairs

Octopus

1

Proportion of mesh pairs

1540

0

1

0.8
0.6
0.4
0.2
0

2

0.5

1

2

2

3

2

4

2

2

0.5

0.3
0.2
0.1
0

20

21

22

23

24

25

26

27

28

29

Proportion of mesh pairs

Proportion of mesh pairs

Proportion of mesh pairs

Hand

0.8
0.4

0.6
0.4
0.2
0

(1)

0

1

0.4
0.3
0.2
0.1
00
2

(2)

21

22

23

24

25

26

27

28

29

(3)

Figure 5: intersection configuration distance vs. consistency of pairwise geodesic distance. The histograms of the following
three statistics over all pairs within the same category: (1): when the first correct permutation appears, (2): the number of
correct ones in the first k permutations where k is the the number of elements in the ground truth set, (3): when all correct
permutations are included.

them. We compare our results to ones computed using differences of pairwise geodesic distances between corresponding
feature points [BBK06].

Timing: Table 1 shows timing results collected on a PC with
Core2 Duo CPU 2.40GHz and 4GB of memory. For most
models tested, it takes around 10 seconds to detect a set of
feature points (FP) and compute their intersection configuration (IC). Computing the distance between two intersection
configurations is almost instantaneous.

5.1. Permutation results
Our first experiment investigates the effectiveness of the ICD
error measure when both the sparse point set S = {si }m
i=1 and
its image h(S) are given but the exact map between them
is unknown. There are totally m! possible permutations between S and h(S). We evaluate ICD for each permutation
h and check whether it discriminates good maps from bad
ones.
For this experiment, we limit the data set to the four categories for which our algorithm is able to extract point feac 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

J. Sun & X. Chen & T. A. Funkhouser / Fuzzy Geodesics and Consistent Sparse Correspondences For Deformable Shapes

R1

R2

1541

R3

R4

R0 = Id
Rot

R7

R6

R5

R1

R2

R3

R4

R0 = Id
Ref

R7

R6

Figure 7: The first two permutations for two pairs of humans
and two pairs of ants.
tersection configuration distance performs much better than
the difference of pairwise geodesic distances.

R5

Figure 6: The first 16 permutations of Octopus 122 and
Octopus 124 based on ICD, which form a group similar to
the dihedral group D8 . The top three rows show all rotations
Rot ◦ Ri and the bottom three rows show all reflections Re f ◦
Ri , where Rot preserves the orientation, Re f reverses the
orientation, and Ri ’s are self-rotation of Octopus 122.

tures consistently for all meshes in the same category: Human, Ant, Octopus, and Hand. For each category, we establish a ground truth set of correspondences and test to see how
well our methods recover them. Specifically, we sort all possible permutations in the increasing order of their error measure, and then search along this sorted list to see (1) when the
first correct permutation appears, (2) the number of correct
ones in the first k permutations where k is the the number of
elements in the ground truth set, (3) when all correct permutations are included. The histograms of these three statistics
for each category are shown in Figure 5, which shows the inc 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

For example, in the category of Octopus, each mesh has
self intrinsic symmetry group similar to dihedral group D8 ,
which has 16 elements. For each octopus (except Octopus
125 which only has four arms), our point selection algorithm
chooses 8 points on the tip of each arm. For each pair of
octopi, we measure the error of each permutation either by
its intersection configuration distance (green bars) or by the
differences of pairwise geodesic distances (red bars). As we
can see from Figure 5, the intersection configuration distance
performs very well: the first permutation is always correct
(1st column), and in more than 70% pairs, the first 16 permutations are all correct (2nd column). Figure 6 shows the
first 16 permutations between a pair of octopi, which forms
a group similar to D8 . In contrast, from Figure 5, the error
measure based on the difference of pairwise geodesic distances performs poorly: in about 40% pairs, there is no correct permutations in the first 16 ones (2nd column) and one
needs to retrieve about 215 = 32, 768 permutations in order
to find all 16 correct permutations (3rd column).
The statistics for the category of Human and Ant are also
shown in Figure 5, which shows that the IDC performs very
well: in almost all pairs of humans and ants, two correct permutations have the smallest intersection configuration distances. Note we exclude Human 16 and Human 18 as they
are topologically different from the others. Figure 7 shows
the first two permutations for two pairs of humans and two

1542

J. Sun & X. Chen & T. A. Funkhouser / Fuzzy Geodesics and Consistent Sparse Correspondences For Deformable Shapes
3

0.5

2.5
error

error

ICD

0.4

0.3

2

0.2

0.1

0

2

4
6
top matches

8

1.5

10

4
6
top matches

8

10

(a)

6.18

5

(b)

6.16

error

error

4
3

6.14

2

6.12

1

2

6.2

6

GDD

0

0

2

4
6
top matches

8

Human 1 and 10

10

6.1

Figure 9: Correspondences of hands. (a) the first permutation for each of two pairs of hands, (b) the first two permutations of a pair of hands.
0

2

4
6
top matches

8

10

Ant 81 and 82

Figure 8: ICD: the intersection configuration distances of
the first 10 permutations of a pair of ants and a pair of humans; GDD: the differences of pairwise geodesic distances
of the first 10 permutations of a pair of ants and a pair of
humans. Note there are only two correct permutations for a
pair of humans or ants.

pairs of ants. One permutation maps the left to the left and
the other maps the left to the right. From Figure 8, we can
see there is a gap in the ICDs between two consistent permutations and others. In fact, similar phenomena are observed
in almost all pairs of ants and all pairs of humans
For Human, it appears that the differences of pairwise
geodesic distances perform also well. However, further examination shows that the differences of pairwise geodesic
distances can hardly distinguish the two correct permutations from the following two: 1) switching the left hand with
the right one but keeping the feet unchanged, i.e., mapping
the left to the left foot and the right foot to the right, 2)
switching the left foot with the right one but keeping the
hands unchanged, see Figure 8. It is somehow a coincidence
that in about 90% pairs, the permutation with the smallest
difference of pairwise geodesic distances is correct (1st column). In fact, only in about 60% pairs, can the differences
of pairwise geodesic distances pick out both correct permutations (3rd column).
For the hand category, ICD again performs much better
than the differences of pairwise geodesics, see Figure 5.
However, notice that there are more mispredictions in the
category of hand than in other categories. Further examination shows that most of the top misprediction are like the
map shown in the top right cell in Figure 9, which swaps
thumb with little finger and index finger with ring finger, and
in some sense is still spatially consistent. In fact, in about
80% pairs, the first two permutations contains the correct
one (1st column and 3rd column in Figure 5). In Figure 9, its
first column shows the first permutation for each of two pairs
of hands, and its second column shows the first two permu-

tations of a different pair. Although the first one (top) is not
correct, it flips the hand in a consistent way as we explain
above.
5.2. Subset search results
In this section, we consider a harder problem: given a sparse
m′
point set SX = {xi }m
i=1 ∈ X and a point set SY = {yi }i=1 ∈ Y ,
assuming that h(SX ) is contained in SY for each consistent
correspondence h : SX → Y , find a consistent correspondence
h. This problem is more general in the sense that we lose the
assumption of h(SX ) = SY . Now, h(SX ) ⊂ SY , a more typical
search scenario.
In this setting, although m is small, m′ can be large
which prevents us from searching all possible maps from
SX into SY . Thus, some heuristic search strategy has to be
employed, such as branch-and-bound [GMGP05], prioritydriven search [FS06], or belief propagation [ASP∗ 04]. In
the paper, we use a simple heuristic searching algorithm
called beam search [Low76] mainly to show that even for a
very sparse point set, its intersection configuration conveys
enough geometric information to distinguish the good map
from bad ones.
Beam search uses breadth-first search to build its search
tree. Each node in the tree represents a map from a subset
of SX into SY . The tree starts with an empty root at level 0
and grows as follows. For each node at level i, generate m′
successors each of which adds one more pair from xi+1 to
one of points in SY . Update the ICD for the map represented
by each successor of any node at level i. Sort them in the
increasing order of their error measures and only keep part of
them with small error measures as the nodes at level (i + 1).
In our implementation, we do not perform pruning in the first
few levels. If we start to prune, we only keep the first 1/m′
of the total nodes on that level so that the number of nodes
on the afterward levels remains fixed.
We apply beam search to the shapes in the category of
Armadillo and Fourleg. Note that for each pair shown in the
following figures, we map the left one into the right one,
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

J. Sun & X. Chen & T. A. Funkhouser / Fuzzy Geodesics and Consistent Sparse Correspondences For Deformable Shapes

1543

Figure 10: Correspondences for category armadillo

Figure 11: Correspondences for category fourleg

meaning we choose less points from the left one than from
the right one as stated in our problem. For Armadillo, we set
m = 10 and m′ = 20 and we start to prune at level 5. For
Fourleg, we set m = 8 and m′ = 15 and we start to prune
at level 5. It is possible that some shapes do not have the
prescribed number of maxima.
Figure 10 and Figure 11 show the correspondence of the
smallest intersection configuration distance on the leaf level
for a few pairs of armadillos and fourleg animals. As we
can see, our intersection configuration distance can generally
find a spatially consistent correspondence. However, there
are some failure cases. For example, in the pair shown in the
bottom rightmost cell in Figure 10, the point on the left hand
(pink) maps to the left ear while the point on the left ear
(cyan) maps to the tip to the nose. Also, in the pair shown in
the bottom middle cell in Figure 11, a point on a leg (red) is
mapped to the bottom of the body. Nevertheless, in the above
two failed cases, further investigation shows that the correct
correspondences also have small intersection configuration
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

distances. We believe that combining intersection configuration with some local point signature like HKS can resolve
this ambiguity. However this is not the focus of the paper
and we leave it as future work.
Finally, Figure 12 shows the correspondence of the smallest intersection configuration distance for a couple pairs of
armadillos where some major parts of an armadillo are missing. When we map an armadillo with major parts missing
into a complete one, as required by our assumption, the beam
search can still find a reasonable correspondence.
6. Conclusion
In this paper, we have introduced a new concept, fuzzy
geodesics, based on which we define the intersection configuration associated with a set of points on a manifold, which
encodes the spatial relation between them. We demonstrate
its effectiveness in the application of finding consistent correspondences between sparse sets of points on shapes differ-

1544

J. Sun & X. Chen & T. A. Funkhouser / Fuzzy Geodesics and Consistent Sparse Correspondences For Deformable Shapes
shapes with priority-driven search. In Symposium on Geometry
Processing (2006).
[GBP07] G IORGI D., B IASOTTI S., PARABOSCHI L.:
SHREC:SHape REtrieval Contest: Watertight models track,
http://watertight.ge.imati.cnr.it/, 2007.
[GMGP05] G ELFAND N., M ITRA N. J., G UIBAS L. J.,
P OTTMANN H.: Robust global registration. In Symposium on
Geometry Processing (2005).
[Gro99] G ROMOV M.: Metric Structures for Riemannian and
Non-Riemannian Spaces. Birkhäuser, Boston, MA, USA, 1999.
[HPW06] H ILDEBRANDT K., P OLTHIER K., WARDETZKY M.:
On the convergence of metric and geometric properties of polyhedral surfaces. Geometriae Dedicata 123, 1 (December 2006),
89–112.
[HSKK01] H ILAGA M., S HINAGAWA Y., KOHMURA T., K UNII
T. L.: Topology matching for fully automatic similarity estimation of 3D shapes. In Proceedings of SIGGRAPH 2001 (August
2001), Computer Graphics Proceedings, Annual Conference Series, pp. 203–212.
[JZvK07] JAIN V., Z HANG H., VAN K AICK O.: Non-rigid spectral correspondence of triangle meshes. International Journal on
Shape Modeling 13, 1 (2007), 101–124.

Figure 12: Correspondences for two pairs of armadillos.
The armadillos on the left side have some major parts missing.

[LF09] L IPMAN Y., F UNKHOUSER T.: Mobius voting for surface
correspondence. ACM Transactions on Graphics (Proc. SIGGRAPH) 28, 3 (August 2009).
[Low76] L OWERRE B. T.: The harpy speech recognition system.
PhD thesis, Pittsburgh, PA, USA, 1976.

ing by extreme deformations. In the future, we would like to
investigate other theoretical properties of fuzzy geodesics, as
well as other applications.
References
[ASP∗ 04]

A NGUELOV D., S RINIVASAN P., PANG H., KOLLER
D., T HRUN S., DAVIS J.: The correlated correspondence algorithm for unsupervised registration of nonrigid surfaces. In NIPS
(2004), vol. 17, pp. 33–40.

[MMP87] M ITCHELL J. S. B., M OUNT D. M., PAPADIMITRIOU
C. H.: The discrete geodesic problem. SIAM J. Comput. 16, 4
(1987), 647–668.
[MS05] M ÉMOLI F., S APIRO G.: A theoretical and computational framework for isometry invariant recognition of point
cloud data. Found. Comput. Math. 5, 3 (2005), 313–347.
[OSG08] OVSJANIKOV M., S UN J., G UIBAS L.: Global intrinsic
symmetries of shapes. Computer Graphics Forum (Symposium
on Geometry Processing) 27, 5 (2008), 1341–1348.
[Pap85] PAPADIMITRIOU C.: An algorithm for shortest-path motion in three dimensions. IPL 20 (1985), 259–163.

[ATCO∗ 10] AU O. K.-C., TAI C.-L., C OHEN -O R D., Z HENG
Y., F U H.: Electors voting for fast automatic shape correspondence. In Computer Graphics Forum (In Proc. of Eurographics
2010) (2010), vol. 29, p. to appear.

[SMC07] S INGH G., M EMOLI F., C ARLSSON G.: Topological
Methods for the Analysis of High Dimensional Data Sets and 3D
Object Recognition. Botsch M., Pajarola R., Chen B., Zwicker
M., (Eds.), Eurographics Association, pp. 91–100.

[BBK06] B RONSTEIN A., B RONSTEIN M., K IMMEL R.: Generalized multidimensional scaling: A framework for isometryinvariant partial surface matching. Proceedings of the National
Academy of Science (2006), 1168–1172.

[SOG09] S UN J., OVSJANIKOV M., G UIBAS L. J.: A concise
and provably informative multi-scale signature based on heat diffusion. Comput. Graph. Forum 28, 5 (2009), 1383–1392.

[BR07] B ROWN B. J., RUSINKIEWICZ S.: Global non-rigid
alignment of 3-d scans. ACM Trans. Graph. 26, 3 (2007), 21.
[dC92] DO C ARMO M. P.: Riemannian Geometry. Birkhäuser,
Boston, MA, USA, 1992.
[DL09] D EY T. K., L I K.: Cut locus and topology from surface
point data. In SCG ’09: Proceedings of the 25th annual symposium on Computational geometry (New York, NY, USA, 2009),
ACM, pp. 125–134.
[ELZ00] E DELSBRUNNER H., L ETSCHER D., Z OMORODIAN
A.: Topological persistence and simplification. In FOCS ’00:
Proceedings of the 41st Annual Symposium on Foundations of
Computer Science (Washington, DC, USA, 2000), IEEE Computer Society, p. 454.
[FS06]

F UNKHOUSER T., S HILANE P.: Partial matching of 3d

[SSK∗ 05] S URAZHSKY V., S URAZHSKY T., K IRSANOV D.,
G ORTLER S. J., H OPPE H.: Fast exact and approximate
geodesics on meshes. ACM Trans. Graph. 24, 3 (2005), 553–
560.
[vKZHCO10] VAN K AICK O., Z HANG H., H AMARNEH G.,
C OHEN -O R D.: A survey on shape correspondence. In EUROGRAPHICS STAR Report (2010).
[WGQ08] WANG S., G U X., Q IN H.: Automatic non-rigid registration of 3d dynamic data for facial expression synthesis and
transfer. In Proceedings of the IEEE Computer Vision Pattern
Recognition 2008 (CVPR08) (Anchorage, Alaska, USA, June
2008).
[ZSCO∗ 08] Z HANG H., S HEFFER A., C OHEN -O R D., Z HOU
Q., VAN K AICK O., TAGLIASACCHI A.: Deformation-driven
shape correspondence. Comput. Graph. Forum 27, 5 (2008),
1431–1439.
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.


DOI: 10.1111/j.1467-8659.2010.01765.x
Eurographics Symposium on Geometry Processing 2010
Olga Sorkine and Bruno Lévy
(Guest Editors)

Volume 29 (2010), Number 5

Mixed Finite Elements for Variational Surface Modeling
Alec Jacobson1 , Elif Tosun1,2 , Olga Sorkine1 and Denis Zorin1
1 New

York University, USA

2 Solidworks,

USA

Abstract
Many problems in geometric modeling can be described using variational formulations that define the smoothness
of the shape and its behavior w.r.t. the posed modeling constraints. For example, high-quality C2 surfaces that obey
boundary conditions on positions, tangents and curvatures can be conveniently defined as solutions of high-order
geometric PDEs; the advantage of such a formulation is its conceptual representation-independence. In practice,
solving high-order problems efficiently and accurately for surfaces approximated by meshes is notoriously difficult.
For modeling applications, the preferred approach is to use discrete geometric schemes which are efficient and
robust, but their convergence properties are less well understood compared to higher-order FEM. In this paper,
we explore discretizations of common geometric PDEs on meshes using mixed finite elements, where additional
variables for the derivatives in the problem are introduced. Such formulations use first-order derivatives only,
allowing a discretization with simple linear elements. Various boundary conditions can be naturally discretized in
this setting. We formalize continuous region constraints commonly used in modeling applications, and show that
these seamlessly fit into the mixed framework. We demonstrate that some of the commonly used discrete geometric
discretizations can be regarded as a particular case of mixed finite elements. We study the convergence behavior
of our discretizations, and how they can be applied to implement common modeling tasks.
Categories and Subject Descriptors (according to ACM CCS): I.3.5 [Computer Graphics]: Computational Geometry
and Object Modeling—Geometric algorithms, languages, and systems

1. Introduction
A variety of geometric modeling problems are solved using
energy minimization or geometric PDEs: defining a smooth
surface interpolating fixed points or curves, filling holes and
connecting pieces of geometry, deformations, and cut-andpaste operations. Such energies and PDEs are defined in
terms of differential quantities such as tangents, curvatures
and curvature derivatives. Boundary conditions for these
problems play an important role, for instance ensuring that
surfaces are joined smoothly. Higher-order boundary conditions can only be imposed if the variational problems are of
high order: C1 and C2 conditions can be imposed for PDEs
of order at least four and six, respectively.
While the PDEs of interest have high order, they usually need to be solved for surfaces approximated by meshes,
and numerical schemes that produce mesh-independent solutions in the limit of fine meshes and remain efficient need
to be devised. Many reliable finite element discretizations
are available for fourth-order problems, yet all standard conforming and non-conforming elements require additional degrees of freedom associated with derivatives at vertices and
edge midpoints, increasing the overall number of variables
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

and complicating implementation. Furthermore, sixth-order
problems, which are highly important in geometric modeling
applications, rarely appear in finite-element literature.
A currently preferred alternative in many geometry processing applications is to formulate discrete analogs of variational problems using discrete-geometric operators, such as
discrete Laplacians. These approaches are simple, robust and
perform well in practice, but lack the mesh-independence
guarantees provided by the finite elements designed to be
convergent, although mesh-independent and convergent behavior was observed experimentally for biharmonic problems on a range of mesh types [GGRZ06]. An additional
important complication is a systematic treatment of boundary conditions: while satisfactory heuristics were designed
for a number of cases (most importantly, for region conditions, see Section 3), other types of conditions, such as direct
specification of tangents or curvature along a boundary, are
more difficult and typically require ad hoc mesh extension.
In this paper, we present a discretization for two common PDEs on meshes using mixed finite elements, a wellestablished finite-element technique. The main idea is to introduce additional variables for the derivatives in the prob-

1566

A. Jacobson, E. Tosun, O. Sorkine & D. Zorin / Mixed FEM for Variational Surface Modeling

lem, along with additional constraint equations relating these
variables to the original ones, thereby reducing a high-order
equation to a low-order system which can be discretized with
linear elements. We show that the intuitive and commonly
used discretization of biharmonic and triharmonic equations
introduced in [BK04] can be viewed as a transformation of a
mixed element discretization, and is directly related to the
Ciarlet-Raviart discretization of the biharmonic equation.
For the triharmonic equation, we show that a standard mixed
FEM discretization may lead to a singular system, but an alternative formulation with region constraints does not suffer
from this problem. We show how different types of boundary conditions commonly used for geometric problems can
be discretized with mixed elements. We formalize the notion of continuous region constraints, which are common in
geometric modeling but rarely considered in finite element
literature, and demonstrate that these also naturally fit into
the mixed framework.
We explore the convergence behavior of mixed discretizations for a variety of mesh types and evaluate the degree of
mesh dependence of the discretization. We demonstrate several applications of the mixed framework in geometric modeling, such as interactive shape editing, hole filling, blending, and surface patch construction from boundary curves.
2. Previous work
Many works in graphics and geometric modeling have considered surface design based on PDEs. In the following we
briefly describe the most relevant literature, classifying it by
the type of PDEs addressed, the employed discretization and
the possible boundary conditions.
In the special case of simple domains and analytically
specified boundary conditions, PDEs can be solved in closed
form without any discretization [BW90]. In more general
settings, the equations need to be discretized and solved numerically. Moreton and Séquin [MS92] model shapes that
minimize the curvature variation energy, where positions,
tangents and normal curvatures are specified along curves,
and Bézier patches are used to approximate the surface.
Welch and Witkin [WW94] also use curvature variation to
interpolate curve networks and points, but on general triangular meshes; they compute the required differential quantities with local quadratic fits and finite differences.
Local quadratic fits may suffer from instabilities, unless
sufficiently large number of vertices are used, which results
in lower performance. To gain speed and accuracy (by using much finer meshes) many recent approaches adopt discrete differential operators such as the discrete Laplacians.
Taubin [Tau95] used the uniform-weight discrete Laplacian
for fair surface design and proposed constraining point positions or discrete Laplacian values at vertices. Later works
use the more accurate discrete cotangent Laplacian [PP93],
closely related to FE discretization [WBH∗ 07, RBG∗ 09].
Mixed finite elements are based on factoring a higherorder problem into a system of lower-order problems. This
idea is also used in the context of discrete differential operators when boundary conditions allow this, e.g. Schneider and Kobbelt [SK00, SK01] factor the PDE ∆H = 0

into two second-order equations. In the F IBER M ESH system [NISA07], the same approach is used to construct fair
surfaces that interpolate a set of arbitrary curves, with no
tangents or curvatures fixed. A more complete survey of discrete variational techniques can be found in [BS08]. A priori, these approaches lack convergence guarantees for general meshes. In absence of convergence, the degree of mesh
dependence is hard to predict, and adaptive refinement techniques are hard to apply. In [GGRZ06], it is demonstrated
that the discretization of the Laplacian energy (equivalently,
the biharmonic equation) based on the cotangent weights
does not satisfy a version of the patch test (a standard test
used for verifying convergence of finite elements in engineering) yet empirically it exhibits convergent behavior.
Mixed-element point of view described in this paper provides a different approach for analysis of this discretization.
The closest work to ours is the method of Clarenz et
al. [CDD∗ 04] that applies the Willmore flow (fourth-order
geometric PDE) to fair surface design by using FEM with
auxiliary variables y = ∆x. Their formulation allows prescribing x values and co-normals on the boundary. We
demonstrate that this and other discrete approaches can be
viewed as an application of the mixed finite element discretization, and that a variety of discrete boundary conditions (region conditions) used in [BK04], [CDD∗ 04] and
[XPB06] can be derived from a continuous formulation.
Finite elements offer a consistent way of solving geometric PDEs and treating various boundary conditions; however, relatively complex higher-order elements are required
for conforming discretization of higher-order PDEs. Nonconforming elements such as DKT, are widely used in engineering for fourth-order problems but are difficult to extend to higher orders and require many additional derivativerelated degrees of freedom. Some of the early work applied
standard engineering elements to surface modeling [CG91],
yet most methods, especially for interactive applications,
used simpler discretizations for reasons of efficiency and implementation ease. Mixed finite elements for fourth-order
problems offer an alternative approach that allows using
piecewise linear basis functions. Although additional variables are introduced, they have a natural interpretation and in
most cases can be eliminated inexpensively. A mixed formulation was introduced for the biharmonic equation in [CR74]
and its variations are considered in [Fal78, Mon87, AD01]
and many other papers. Convergence of mixed discretization for linear elements was shown in [Sch78]. In contrast to
biharmonic equations, sixth-order equations (especially triharmonic) did not receive much attention, as few physical
problems result in such equations. One exception is [BF85],
deriving theoretical convergence estimates for a mixed formulation of polyharmonic equations. While piecewise-linear
discretizations extend naturally to the case of non-flat domains, convergence questions require special treatment; the
Laplace-Beltrami equation and Willmore flow discretizations were analyzed in [Dzi88, Dzi90, DD06].
3. Model problems
We consider two important examples: Laplacian and Laplacian gradient energies, leading to biharmonic and triharc 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

A. Jacobson, E. Tosun, O. Sorkine & D. Zorin / Mixed FEM for Variational Surface Modeling

biharmonic

triharmonic

considerations apply for weak formulations of high-order
PDEs in general. For the transformed problems, piecewiselinear elements can be used for all quantities, as it is commonly done for second-order problems. This idea is the
foundation of the mixed finite element discretizations (Section 4). The constraint-based formulation has an additional
significant advantage: it allows us to treat region boundary
conditions in a systematic way, as explained below.

reflection lines

total curvature
Figure 1: Blending two cylinders of different diameters using triharmonic and biharmonic equations.
monic equations (Fig. 1). We use the notation f , g X =
R
2
X f g dA for the L inner product of two functions on a domain X (an area or a curve in the plane or on a surface).
When the subscript is omitted, the domain Ω is implied. For
vector-valued functions, denoted by bold letters, the product
in the integral is replaced by dot product.
In the first problem we compute a deformation u of a planar sheet occupying an area Ω0 in the plane so that the Laplacian energy is minimized:
1
2

EB =

∆u, ∆u

→ min,

Ω0

(1)

where u : Ω0 → R3 is the deformation. The related EulerLagrange equation is the biharmonic equation ∆2 u = 0.
The second example is the Laplacian gradient energy
ET =

1
2

∇∆u, ∇∆u

Ω0

→ min

(2)

with boundary conditions on second derivatives, important for modeling curvature-continuous surfaces. The EulerLagrange equation for this problem is sixth order: ∆3 u = 0.
Low-order decomposition. A general systematic approach
to discretization of problems involving high-order derivatives is to convert an unconstrained optimization problem
like (1) into a lower-order constrained optimization problem with additional variables. Instead of the Euler-Lagrange
equations for (1), we solve the constrained problem
1
2

v, v

Ω0

→ min, s.t. ∆u = v.

(3)

Similarly, instead of minimizing energy ET , we solve
1
2

∇v, ∇v

Ω0

→ min, s.t. ∆u = v.

(4)

For the Laplacian gradient energy, we no longer need to discretize third derivatives. Furthermore, in both cases one can
also eliminate second derivatives by using Green’s identity:
LB =
1
2

v, v

Ω0

− λ, v

Ω0

1
2

v, v

+ λ,

Ω0

+ λ, ∆u − v

∂u
∂n ∂Ω0

− ∇λ, ∇u

1567

Ω0

=
(5)

Ω0

The partial derivative ∂/∂n is w.r.t. the normal of the boundary curve. A similar transformation yields a formulation with
first-order derivatives for the minimization of ET . Similar
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

Boundary condition types. We define various boundary
conditions in the continuous case. While for some applications (e.g., deformations of a fixed mesh) the problem can
be studied entirely in the discrete domain, we are concerned
with cases when a common reference point is needed for
meshes with different connectivity and resolution that approximate the same shape.
A boundary condition can be associated with subsets of
the domain Ω0 of different dimensions:
• region boundary conditions on open domains Ω f ⊂ Ω0 ;
• curve boundary conditions on curves C ⊂ Ω0 ;
• point boundary conditions on isolated points P ∈ Ω0 .
Fixed region boundary conditions require that, given a domain Ω f and a fixed function u f ,
u|Ω f = u f , and u is Ck on Ω, for some k ≤ 2.
These boundary conditions are illustrated in Fig. 2(left). This
type of conditions can be viewed as the continous analog of
conditions defined directly for meshes in [CDD∗ 04,XPB06].
Fixed curve boundary conditions are most commonly
considered in FE setting. On a curve C (typically a part of
∂Ω, but possibly in the interior of Ω0 ), we require that
∂i u
∂ni

= bi , i ≤ k for k ≤ 2.
C

Fig. 3(left) demonstrates the usage of this condition for explicit tangent control on a biharmonic surface. Triharmonic
surface allows to specify both tangents and curvature (second derivative) at the boundary, as shown in Fig. 3(right).
Free (natural) curve boundary conditions are naturally
obtained from energy-based problems; they are needed at
a boundary with no Dirichlet constraints in order for the
energy to be minimal. They can also be applied to PDEs
not originating from an energy, yielding similar boundary behavior. These conditions have more complex explicit
form involving high-order quantities, but no special effort is
needed to enforce them when the discretization is derived
from the energy, hence we do not consider them in detail.
Point boundary conditions are identical to region boundary conditions, except instead of a function defined on Ω f ,
we use a set of values defined at isolated points pi of Ω0 . An
example is shown in Fig. 2(right).
4. Mixed finite element discretization
In this section, we demonstrate, using two model examples
discussed in Section 3, how low-order decomposition can be
used to discretize such problems with piecewise-linear elements only, and how different types of boundary conditions
can be imposed.

1568

A. Jacobson, E. Tosun, O. Sorkine & D. Zorin / Mixed FEM for Variational Surface Modeling

Region condition: ∆2 u = 0

∆3 u = 0

Point condition: ∆2 u = 0

∆3 u = 0

Figure 2: Region and point boundary conditions. Left: the blue areas (Ω f ) are fixed and the yellow part (Ω) is solved for. The
circular region in the middle was lifted upwards. Solving ∆k u = 0 with region boundary conditions. Right: the point constraint
is highlighted by the green dot. In both examples, triharmonic surface is smoother around the boundary (C2 ).

prescribing tangents on boundary curve, ∆2 u = 0

prescribing second derivatives perp. to boundary, ∆3 u = 0

Figure 3: Prescribing curve boundary conditions. The leftmost image shows a biharmonic surface with ∂u/∂n = 0. Tangents
can be explicitly manipulated by the user (see also Fig. 4). The two rightmost images show a triharmonic surface with boundary
curvature manipulation via a Bézier control widget.
I
I
I
I
I

meshed domain

tangent constraints (see Fig. 3)

Figure 4: The mesh domain used in our examples for region
and curve boundary conditions. Tangent vectors can be explicitly manipulated by the user (see the green vectors in the
right two images); the rest of the tangents along the boundary are automatically interpolated (shown in light brown).
Our main focus is on the region boundary conditions
which lack a systematic treatment in finite element context. We demonstrate the relationship between the classical
Ciarlet-Raviart mixed-element discretization of the biharmonic equation [CR74], discrete-geometric discretization of
[BK04] and our region constraint formulation.
Notation. Please refer to Fig. 5. We assume that the domain
Ω0 has polygonal boundary and is meshed (the discretizations we describe, with some restrictions, are applicable to
domains with curved boundaries approximated by polygonal domains Ωh0 for each resolution). The parameter h denotes the average edge length of the mesh. The domain Ω is
defined as the subset of Ω0 excluding the union of Ω f with
constrained curves and points, and the complement of Ω in
Ω0 is denoted by Ωe .
The set of vertex indices in the interior of Ω is denoted by
IΩ , the set of vertex indices on the boundary of Ω is I0 , the
sets of indices in Ωe in two layers outside the boundary are
I1 and I2 . The set of all vertex indices in Ω0 is denoted by I,
and the set of vertices in Ωe is denoted by Ie . In a matrix S
with rows and columns corresponding to vertex indices, we
use subscripts Ω, 0, 1 2 and e, to define submatrices with

I

Figure 5: Notation for different areas of the mesh; for
fourth-order equations, we include I2 into Ie .
rows and columns coming from corresponding index sets.
¯ for
We also use subscripts like 01 to denote I1 ∪ I0 , and Ω
IΩ ∪ I0 , i.e., Ω with its boundary included.
4.1. Laplacian energy & biharmonic equation
We start with the very well studied example of Laplacian
energy (1), whose Euler-Lagrange equation is the biharmonic equation. It reveals the essential relations between
conventional mixed finite element discretizations, the region
constraint discretization that we propose, and the discretegeometric approach of [BK04].
Region conditions require an additional term in the Lagrangian, constraining the solution to coincide with a given
function on Ω f :
1
2

v, v

Ω0

− λ, v

+ µ, u f − u

Ω0

+ λ, ∂u
∂n

∂Ω −

∇λ, ∇u

Ω0

(6)

Ωf

where µ is the Lagrange multiplier function for the region
constraint. It is important to note that the first constraint,
∆u = v, is enforced over all of Ω0 , which ensures C1 continuity across the boundary of Ω.
A similar Lagrangian, with the first term replaced with
∇v, ∇v Ω0 is obtained for the problem (2):
1
2

∇v, ∇v

Ω0

+ µ, u f − u

− λ, v

Ω0

+ λ, ∂u
∂n

∂Ω −

∇λ, ∇u

Ω0

(7)

Ωf

c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

1569

A. Jacobson, E. Tosun, O. Sorkine & D. Zorin / Mixed FEM for Variational Surface Modeling

Discretization with piecewise linear elements. We use
piecewise-linear approximations for u, v, λ and µ, all of the
form ∑i∈I ai ϕi . For a quantity a, we denote the piecewise
linear approximation by ah .
Substituting these approximations into the Lagrangian,
and differentiating w.r.t. all free variables vi , ui , λi , µi , defined at vertices i ∈ I \ I∂Ω0 , we obtain the following system
of equations:

∑ (v j − λ j ) ϕi , ϕ j

=0

j∈I

− ∑ λ j ∇ϕi , ∇ϕ j − ∑ µ j ϕ j , ϕi
j∈I

Ωf

=0

j∈I

− ∑ u j∈I ∇ϕi , ∇ϕ j + ∑ v j ϕ j , ϕi = 0
j∈I

(8)

j

∑

f
(u j − u j )

ϕ j , ϕi

Ωf

=0

j∈I

The first equation allows us to eliminate λi immediately as
it has to coincide with vi , leaving variables u, v and µ. One
can observe that the coefficients of the system mostly come
from the discrete Laplacian matrix Li j = − ∇ϕi , ∇ϕ j , and
f ull
the mass matrix Mi j = ϕi , ϕ j .
Lumped mass matrices. The mass matrix M f ull is often
replaced by a lumped mass matrix, i.e. a diagonal matrix
M d . The lumping step is mathematically sound: replacing
T

T

vh , vh = vh Mvh with vh M d vh does not affect the convergence rate for the solution, if the quadrature rule has accuracy O(h), which is satisfied by using vertices as quadrature points [Cia78, BF91], which leads to a diagonal mass
matrix. From now on, we assume that the mass matrix in (8)
was replaced by a diagonal matrix M d whose diagonal entries are denoted by Di ; two approaches to computing Di are
briefly compared in Section 5. With a diagonal mass matrix,
the system reduces to

∑ v j Li j − Di µi = 0 if i ∈ Ie , ∑ v j Li j = 0 if i ∈ Ie ;
j∈I

j∈I

∑ Li j u j − Di vi = 0;

∑ u j − u j = 0 if i ∈ Ie .

j∈I

f

(9)

j∈I

As the values of the Lagrange multiplier µ are not of interest
to us, we can eliminate the first set of equations defining µi
in terms of vi , since µi are not present in other equations.
The last set of equations indicates that for i on I f , ui can be
f
replaced by the known values ui . Finally, we can compute
the values of vi for i ∈ Ie using ∑ j∈I Li j u j = Di vi , as for
entries away from the boundary, all u j with nonzero Li j are
f
fixed values u j .
Eliminating values of u j and v j in fixed regions from the
system after swapping equations and moving known quantities to the right-hand side, yields in matrix form:
−M d
LΩ,Ω¯

LΩ,Ω
¯
0

f
f
vΩ¯
−LΩ,0
¯ u0 − LΩ,1
¯ u1
=
.
uΩ
0

(10)

The system can be simplified even further, if we observe
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

that M d can be easily inverted, and vΩ¯ can be eliminated
from the system, yielding
d −1
LΩ,Ω¯ (M d )−1 LΩ,Ω
u01 ,
¯ (M ) LΩ,01
¯ uΩ = −LΩ,Ω
¯
f

(11)

leaving only uΩ as the unknown.
Observe that point conditions are enforced using the same
system of equations: for an isolated point constraint, assuming it is at a mesh vertex, I1 is empty, so the second term of
the right-hand side is absent.
Fixed curve conditions. Fixed-curve boundary conditions
of the form u = b0 and ∂u/∂n = b1 are commonly used in
mixed discretizations of the biharmonic equation; we refer
to [CR74, AD01] for details. An approach similar to the one
outlined above can be used, with the Lagrangian in (5) re¯ This yields the system of equations
stricted to Ω.
−M Ω
LΩ,Ω¯

LΩ,Ω
¯
0

Ω
∂Ω
−LΩ,0
vΩ¯
¯ b0 − NΩ,0
¯ b1 ,
=
uΩ
0

(12)

Ω
Ω
where the matrix Ni∂Ω
j = ϕ j , ϕi ∂Ω , and L and M are
the discrete Laplacian and mass matrices with integration
performed over Ω only, as · Ω = · Ω0 − · Ωe , LΩ = L −
LΩe . This is exactly the Ciarlet-Raviart discretization for
piecewise-linear elements with convergence established in
[Sch78].
Comparing (12) and (10), we observe two differences:
f
first, the right-hand side term LΩ,1
¯ u1 is replaced with
f

Ωe
∂Ω
−LΩ,1
¯ b1 ; second, the full mass matrix is retained
¯ u1 + NΩ,0
(in this case, lumped matrices are not required to eliminate
variables). A more detailed analysis presented in the appendix shows that the difference between the solutions of
the two systems converges to zero as h → 0. Replacing M Ω
with diagonal M Ω,d yields a system matrix similar to (10),
except the integration is over Ω only; the same elimination
procedure can be applied to obtain a system for u alone.
Our observations are summarized in Proposition 1:
Proposition 1 The systems (10) and (11) are equivalent
to the discretization presented in [BK04], and, up to a perturbation of the right-hand side and restricting mass-matrix
integration to Ω, to the Ciarlet-Raviart system (12).
We note that adjusting b1 offers a degree of control over
how smoothly the surface approaches the boundary, similar to the control offered by the λ parameter in [BK04] but
without modifying the system matrix (which leads to more
efficient computations) and with more direct interpretation.

Convergence. As we discuss in more detail in the appendix,
this connection between (10) and (12) can be used to apply
available theory for (10) and establish convergence. Note
that the cotangent formula discretization of the Laplacian
energy discussed in [GGRZ06] exactly matches (10). While
it fails the consistency part of the version of the patch test
discussed there, this, by itself, does not preclude convergence, which in the case of (10) is established by reduction
to Ciarlet-Raviart system.
We emphasize that using a conforming FE discretization in the case of constrained problems like (10) does not

1570

A. Jacobson, E. Tosun, O. Sorkine & D. Zorin / Mixed FEM for Variational Surface Modeling

guarantee convergence. In fact, the more general technique
for analysis of mixed elements based on the LBB condition [BF91] cannot be applied to any discretization of the
biharmonic equation. All known estimates are suboptimal,
in a sense that the rate of convergence of the solution is lower
than O(h2 ) approxmiation power of p.w. linear finite elements. The H 1 norm estimates in [Sch78] and [AD01], combined with Poincare-Friedrichs inequality lead to L2 norm
convergence rates h7/4 (log h)3/2 .
4.2. Laplacian gradient energy & triharmonic equation
The similarity between the Lagrangians (5) and (7) allows deriving a piecewise-linear discretization of the triharmonic system in a similar way: the main steps remain the
same, namely (i) use p.w. linear approximations for all functions; (ii) replace mass matrices with lumped mass matrices;
(iii) eliminate unneeded variables. An important distinction
is that the Lagrange multiplier λ can no longer be eliminated,
due to a more complex form of the equation obtained by differentiating with respect to vi . From direct examinaton of
the system one observes that the Lagrange multiplier λ corresponds to w in the low-order factorization of the triharmonic equation of the form ∆u = v, ∆v = w, ∆w = 0.
Because of the different form of the first equation, we no
longer can eliminate all variables corresponding to vertices
¯ and two rows are
outside the one-row neighborhood of Ω,
needed, as expected from the discrete-geometric discretizations of triharmonic equations. We obtain the following system in the end:
 


d 
−LΩ,1
¯ v1
0
−MΩ
LΩ¯ Ω¯
vΩ¯
¯Ω
¯

 0
0
0
LΩΩ¯  uΩ  = 
f
f
d
λ
u
−
L
u
−L
¯
−MΩ¯ Ω¯ LΩΩ
0
¯
¯
¯
Ω
Ω,0
Ω,1
0
1
(13)
where
f

f

f

v1 = −L1,0 u0 − L1,1 u1 − L1,2 u2 .

(14)

Again, as it was observed for the biharmonic equation, one
can also eliminate v and λ entirely by inverting the mass
matrices, and obtaining a system in terms of u alone, which
coincides with the system of [BK04].
Curve boundary conditions. For curve boundary conditions, the discretization can be obtained in a similar way,
however an important difference arises. In this case, the values vi are fixed for boundary vertices, unlike in the case of
the region boundary condition system (13), where these remain as free variables. This results in the system matrix


Ω,d
0
−MΩ
LΩΩ
¯
Ω

0
LΩΩ¯  .
(15)
 0
Ω,d
−MΩΩ
L
0
¯
¯
ΩΩ
Somewhat surprisingly, although the discretization follows
the same pattern as well-established discretizations for biharmonic equations, the resulting systems are often overdetermined and cannot be practically used. The following
proposition describes simple local mesh configurations leading to singularity, but one can observe more complex global
dependencies, resulting from the fact that there are “too

many” degrees of freedom fixed on the boundary, while the
equations corresponding to boundary vertices are retained.
Proposition 2 The system (15) is singular if two vertices in
I1 have exactly one edge-adjacent vertex in IΩ .
Indeed, observe that the
1
system with lumped mass
contains the equations of the
2
3
form L52 u2 = D5 v5 − L54 u4 −
L55 u5 − L56 u6 − L53 u3 , and
4
5
6
L52 u2 = D3 v3 − L55 u5 − L56 u6 −
L53 u3 + L51 u1 . Each equation has
exactly one variable u2 ; the remaining components of u
and v are on the boundary and are fixed. In general, these
equations are not compatible. Similar observation holds
for the full mass matrix, but a slightly larger neighborhood
needs to be considered.
Reduction of fixed curve boundary conditions. An alternative approach to discretizing curve boundary conditions is
to reduce them to the discretization of the type (13). This
is achieved by inferring the values of ui for i ∈ I−1 where
I−1 are the vertices in the interior of Ω, edge-adjacent to the
boundary, from the boundary values of ∂u/∂n = b1 .
For each triangle in Ω with 2 vertices on the boundary, the
value of the interior vertex can be easily determined independently, as the ∂u/∂n and the boundary values completely
specify the gradient of u. If several such triangles have a
common vertex v in the interior (the situation that leads to
overdetermined systems), we simply average all values obtained for v from these triangles, since the difference in these
values should decrease at least as O(h2 ) as the mesh is refined. Algebraically, this procedure eliminates a part of the
overdetermined system by exploiting the fact that the values
of u on I−1 can be solved for in least-squares sense, independently of the rest of the variables.
As a result, we obtain a discrete system of equations with
two rows of values of u fixed, and values of v on the boundary. The rest of the derivation proceeds as before, by substituting piecewise linear expressions for u (with two rows
fixed), v (with one row fixed) and λ (with no rows fixed). The
system matrix is identical to (13), if one row on the boundary is removed from Ω, and renamed I0 and I0 is renamed
I1 . The right-hand side has the same form, but instead of v1
given by (14), the boundary value of v1 appears directly.
Convergence. While many versions of theoretical analysis are available for the biharmonic and other fourth-order
problems, much less work was done on higher-order equations. Unfortunately, the triharmonic problem suffers from
the same diffuculty as biharmonic: general theorems based
on the LBB (inf-sup) condition do not apply for similar reasons. Mixed elements for polyharmonic problems are considered in [BF85]; however, error estimates are obtained under the assumption that the discretization in the domain Ω is
asymptotically finer than the discretization on the boundary.
5. Evaluation and Applications
Implementation. In our implementation, UMFPACK is
used to solve the system in all cases (note that a Cholesky
solver cannot be used unless the system is reduced to a single
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

1571

equilateral

mixed

half 4-8

region, reduced

A. Jacobson, E. Tosun, O. Sorkine & D. Zorin / Mixed FEM for Variational Surface Modeling

min angle 30 deg

1.E−5

1.E−5

1.E−6

1.E−6

half 3-12

Figure 6: Mesh connectivities used in tests, from [GGRZ06].
variable). We observe that the timings for solving the system
with auxiliary variables do not differ much from timings for
solving the reduced system: while the number of variables
is smaller, the system is much less sparse. As only the righthand side depends on the boundary conditions, the system
can be prefactored when these conditions are manipulated.
Convergence and mesh dependence. We start with a study
of the errors of the region and curve boundary conditions.
We characterize meshes by the average edge length h. We
have used several sequences of meshes from [GGRZ06]. We
also used several sets of randomized meshes, obtained by
perturbing the positions of points on a regular grid and running Delaunay triangulation on the resulting vertices, with
Steiner points added to satisfy a constraint on the minimal
angle. The errors are calculated by comparing our solution
with an analytic solution. We choose an arbitrary function ut
as the target analytic solution, sample boundary conditions
from this function and use the right-hand side g = ∆k ut for
k = 2 and k = 3. We have tried a number of test functions
with similar results.
Figs. 7 and 8 show how the L2 error changes with average edge length for randomized meshes with minimal angle
of 30 and 1 degrees, and Fig. 9 shows the same dependence
for the meshes from Fig. 6. We observe that the convergence
rate for the Laplacian energy (biharmonic equation) is consistent with the error estimate of [Sch78]. There is no significant difference between the behaviors of region and curve
boundary condition formulations, and there is good consistency between different connectivities with the same average
edge length. At the same time, more regular mesh patterns
result in greater dependence on connectivity (Fig. 9, left).
There is no significant difference in numerical solutions obtained from the reduced formulation (11) and the equivalent
two-variable formulations (10) and (12).
The behavior for the Laplacian gradient is quite different
(Figs. 8 and 9, right). The observed average convergence rate
is substantially slower for region conditions, and the deviation from the average error for a given mesh resolution is
higher. The most significant observed effect is that by using
curve conditions with explicitly defined second derivative,
we obtain substantially better results, both in terms of error magnitude and lesser mesh dependence. Reduced singlec 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

1.E−0.5

1.E−7
1.E−2.5

1.E−5

1.E−5

1.E−6

1.E−6

1.E−7
1.E−2.5

h

1.E−0.5

curve, full

polar distort.

h

region, full

1.E−7
1.E−2.5

aspect rat. 3

min angle 1 deg

1.E−7
1.E−2.5

1.E−5

1.E−5

1.E−6

1.E−6

1.E−7
1.E−2.5

h

1.E−0.5

1.E−7
1.E−2.5

h

1.E−0.5

h

1.E−0.5

h

1.E−0.5

Figure 7: Dependence of the error on average edge length
for the Laplacian energy, randomized meshes.
variable systems of the type (11) produce stronger mesh dependence and in some cases inferior convergence behavior
compared to the full mixed element system.
Mass matrix lumping. While the convergence rate and
mesh dependence are not strongly affected by the choice of
the mass matrix lumping strategy, there is a substantial difference in error magnitudes, which is consistent with the observations in the literature. Fig. 10 shows a comparison of
“barycentric” lumping, with each diagonal entry obtained as
1/3 of the sum of areas of triangles incident at the vertex, and
the “hybrid” approach, using Voronoi areas for non-obtuse
triangles [MDSB02].
Applications. Figs. 2, 3 show examples of interactive editing of biharmonic and triharmonic surfaces, with different
user-defined boundary conditions. The user is free to manipulate single points, curves or regions in the edited shape.
Tangents can be prescribed along curve boundaries for biharmonic surfaces; triharmonic surfaces additionally admit second derivative control along the direction perpendicular to
the boundary. Tangents are explicitly specified by the user at
a sparse set of points along the boundary curve using a simple vector widget, and the tangents at the remaining points
are computed by interpolation (Fig. 4). Second derivatives
are set using the Bézier widget (Figs. 3, 15): the control triangle of a quadratic Bézier curve whose derivatives are used
in the boundary conditions for ∂/∂n and ∂2 /∂n2 .
Smooth detail-preserving deformations (Fig. 15) are
achieved by solving the bi- or triharmonic equation for the
displacement function u. The user can interactively manip-

A. Jacobson, E. Tosun, O. Sorkine & D. Zorin / Mixed FEM for Variational Surface Modeling

min angle 30 deg

1.E−3

1.E−4
1.E−2

min angle 1 deg

1.E−3

h

1.E−1

1.E−4
1.E−2

biharmonic
area, reduced

region, reduced

1572

h

1.E-03

1.E-03
1.E-05

1.E-05

1.E-07
1.E-07

1.E-09

1.E-09
1.E-02

1.E−1

triharmonic
1.E-01

h

1.E-11
1.E-02

1.E-01

h

1.E-01

h

1.E-01

h

1.E-01

1.E−3

1.E−4
1.E−2

area, full

region, full

1.E-01
1.E-03

1.E−3

h

1.E−1

1.E−4
1.E−2

h

1.E-03
1.E-05

1.E-05

1.E-07

1.E-07

1.E-09

1.E-09
1.E-02

1.E−1

h

1.E-11
1.E-02

1.E-01

1.E-01

1.E−3

1.E−4
1.E−2

curve, full

curve, full

1.E-03

1.E−3

h

1.E−1

1.E−4
1.E−2

h

1.E−1

Figure 8: Dependence of the error on average edge length
for the Laplacian gradient energy, randomized meshes.
ulate the boundary conditions for the displacement field,
namely positions, first and second derivatives. A more complex approach involving rotations [BS08] can also be formulated in the mixed-element framework.
Another application of PDE-based surfaces is smooth
hole filling and blending between shapes. In hole filling,
a surface with a boundary loop (a hole) is given, whereas
blending implies two or more loops that need to be connected by a surface. One can use the region constraints to
ensure C1 or C2 continuity with the rest of the surface, or
curve boundary constraints to specify tangents and/or curvatures at the hole-border directly (Fig. 11). Blending between
two shapes using region boundary conditions is shown in
Fig. 12; the higher smoothness of the triharmonic surface is
evident from the reflection lines. Fig. 14 shows two curves
interpolated with a variational patch, with the shape of the
patch controlled by tangents and second derivatives specified along the curves (we map both curves to two opposite
boundaries of a rectangular area in the plane, and periodic
conditions are imposed at the other two boundaries).
6. Conclusions
The technique that we have presented allows one to discretize a broad variety of functionals and PDEs with different types of boundary conditions using only piecewise linear elements. The main components of the approach include
(1) factorization of the original equations into low-order
equations by introducing additional variables; (2) using constraints to impose region conditions; (3) lumping mass matrices to eliminate unneeded variables.

1.E-03
1.E-05

1.E-05

1.E-07

1.E-07

1.E-09

1.E-09
1.E-02

h

1.E-11
1.E-02

1.E-01

Figure 9: Dependence of the error on average edge length
for the Laplacian energy (left), and Laplacian gradient energy (right); test mesh connectivities shown in Fig. 6.
barycentric

hybrid

randomized meshes
barycentric
hybrid

h

h

h

Figure 10: Comparison of barycentric and hybrid
[MDSB02] lumped mass matrices.
While experimental evidence shows that the method is
converging for both forth- and sixth- order problems, convergence is significantly slower for the latter, and mesh dependence is stronger. We observe that using high-order interpolation to estimate the second-order boundary condition
somewhat improves the situation.
One potential direction for improvement is, instead of factoring this system into three second-order systems, to use a
fourth- and a second-order system, with quadratic elements
for the former (e.g., the ones used in [GGRZ06]).
In the simplest case (biharmonic equation) existing theory can be used to establish convergence guarantees; much
less is known for sixth-order systems, and the experimentally observed convergence rates are significantly lower. Another important direction for exploration is the effect of the
non-flat metric, which we did not consider in this paper; the
discretizations we describe should still apply with no significant changes.
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

1573

A. Jacobson, E. Tosun, O. Sorkine & D. Zorin / Mixed FEM for Variational Surface Modeling

original

∆2 , fixed region

∆2 , fixed tangents

∆3 , fixed region

∆3 , fixed ∂2 /∂n2

Figure 11: Hole filling: the half-sphere mesh was completed to close the “hole”. The left images show biharmonic reconstruction using region constraints and curve constraints with different prescribed tangents. The two rightmost images show the
triharmonic reconstruction using region constraints and curve constraints with user-prescribed curvatures.
zero
tangent

tangent control

reflection
lines

initial
curves

biharmonic

curvature
control

zero tangent
+ curvature

total
curvature
triharmonic

Figure 12: Blending between surfaces (cylinders with a
square and circular cross-sections) using bi- and triharmonic equations and region boundary conditions. Note the
smoother behavior of reflection lines in the triharmonic case.

Figure 13: Blending between two spherical caps, with controllable sharp features introduced using tangent conditions.
Acknowledgment
This work was supported in part by an NSF award IIS0905502.

Figure 14: Filling in a patch between surfaces. Tangents or
tangents+second derivatives can be specified at curves to
obtain the desired shape.
consideration, we assume that the solutions are classical solutions, i.e., u is four times differentiable in Ω. In this case,
solutions of continuous problems with curve boundary conditions and region boundary conditions are identical, as long
as the boundary conditions for the curve problem are sampled from u f for the region problem.
We consider a simplified situation with homogeneous
Dirichlet conditions, i.e., we assume that for (10), u f = 0,
and for (12), b0 = 0 (this is a standard reduction for Dirichlet conditions, using substitution u = uorig − uD where uD
satisfies the Dirichlet condition [Bra02]). This reduction requires introducing a right-hand side for the second equation
in the system: ∆u = v, ∆v = ∆2 uD = g.
The Ciarlet-Raviart system (12) with lumped mass matrix
with solution (v∗Ω¯ , u∗Ω ) can be rewritten in the form
−M d
LΩ,Ω¯

e

LΩ,Ω
¯
0

d,Ω ∗
∂Ω
v0
−NΩ,0
vΩ¯
¯ b1 − MΩ,0
¯
,
=
Ω
uΩ
g

(16)

e

Appendix A: Ciarlet-Raviart discretization and region
boundary conditions.
We outline the connection between solutions to the systems
(12) and (10) here; a full rigorous treatment would require
detailing assumptions on the smoothness spaces for boundary data and is beyond the scope of this paper. To simplify
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

d,Ω ∗
where we have subtracted MΩ,0
v0 from both sides, to ob¯

tain the same left-hand side as in (10), and gΩj = g, ϕ j Ω .
In comparison, the right-hand side of (10) is [0, gΩ0 ], with
h
gΩj 0 = g, ϕ j Ω0 . As shown in [Sch78], (v∗ ) converges
¯ It
to v in in L2 -norm, and v is at least continuous on Ω.
can be extended by zero to all of Ω0 , consistently with

1574

A. Jacobson, E. Tosun, O. Sorkine & D. Zorin / Mixed FEM for Variational Surface Modeling

Figure 15: Controlling deformations using tangents and
second derivatives. We solve the triharmonic equation
∆3 u = 0 for the displacement function (the edited surface is
then x + u). The Camel’s nose is lengthened and the mouth
opened by manipulating both the first and the second normal derivatives of the displacement field; the curvature of
the Max Planck’s nose is altered by interacting with the second derivatives via the Bézier widget.
∂Ω
∆u f . On the other hand, the j-th component of −NΩ,0
¯ b1 ,

− b1 , ϕ j ∂Ω = ∇u f , ∇ϕ j Ωe = − b, ϕ j ∂Ω = v, ϕ j Ωe .
h
Combining L2 convergence of solutions (v∗ ) of (10) to v,
e
d,Ω ∗
and the fact that components of MΩ,0
v0 are quadrature ap¯

proximations of v∗ , ϕ j Ωe , we observe that the r.h.s. of (16)
converge in L2 norm to the the r.h.s. of the system obtained
for the (12) formulation in L2 norm, so the difference in the
solutions also converges as shown in [BF91].
References
[AD01] A MARA M., DABAGHI F.: An optimal C0 finite element
algorithm for the 2D biharmonic problem: theoretical analysis
and numerical results. Numer. Math. 90, 1 (2001), 19–46.
[BF85] B RAMBLE J., FALK R.: A mixed-Lagrange multiplier finite element method for the polyharmonic equation. Mathematical Modelling and Numerical Analysis 19, 4 (1985), 519–557.
[BF91] B REZZI F., F ORTIN M.: Mixed and hybrid finite element
methods, volume 15 of Springer Series in Computational Mathematics. Springer-Verlag, New York 2, 5 (1991), 2.
[BK04] B OTSCH M., KOBBELT L.: An intuitive framework for
real-time freeform modeling. ACM Trans. Graph. 23, 3 (2004),
630–634.
[Bra02] B RAESS D.: Finite Elements: Theory, fast solvers and
applications in solid mechanics, 2nd edn, vol. 13. 2002.
[BS08] B OTSCH M., S ORKINE O.: On linear variational surface
deformation methods. IEEE Transactions on Visualization and
Computer Graphics 14, 1 (2008), 213–230.
[BW90] B LOOR M. I. G., W ILSON M. J.: Using partial differential equations to generate free-form surfaces. Computer Aided
Design 22, 4 (1990), 202–212.
[CDD∗ 04] C LARENZ U., D IEWALD U., D ZIUK G., RUMPF M.,
RUSU R.: A finite element method for surface restoration with
smooth boundary conditions. Comput. Aided Geom. Design 21,
5 (2004), 427–445.

[CG91] C ELNIKER G., G OSSARD D.: Deformable curve and surface finite-elements for free-form shape design. In Proceedings
of ACM SIGGRAPH (1991), pp. 257–266.
[Cia78] C IARLET P.: The finite element method for elliptic problems. North-Holland, 1978.
[CR74] C IARLET P. G., R AVIART P.-A.: A mixed finite element
method for the biharmonic equation. In Mathematical aspects of
finite elements in partial differential equations (Proc. Sympos.,
Math. Res. Center, Univ. Wisconsin, Madison, Wis., 1974). Math.
Res. Center, Univ. of Wisconsin-Madison, Academic Press, New
York, 1974, pp. 125–145. Publication No. 33.
[DD06] D ECKELNICK K., D ZIUK G.: Error analysis of a finite
element method for the Willmore flow of graphs. Interfaces and
free boundaries 8, 1 (2006), 21.
[Dzi88] D ZIUK G.: Finite elements for the Beltrami operator on
arbitrary surfaces. Partial differential equations and calculus of
variations (1988), 142–155.
[Dzi90] D ZIUK G.: An algorithm for evolutionary surfaces. Numerische Mathematik 58, 1 (1990), 603–611.
[Fal78] FALK R.: Approximation of the biharmonic equation by a
mixed finite element method. SIAM Journal on Numerical Analysis 15, 3 (1978), 556–567.
[GGRZ06] G RINSPUN E., G INGOLD Y., R EISMAN J., Z ORIN
D.: Computing discrete shape operators on general meshes. In
Computer Graphics Forum (2006), vol. 25, pp. 547–556.
[MDSB02] M EYER M., D ESBRUN M., S CHRÖDER P., BARR
A.: Discrete differential-geometry operators for triangulated 2manifolds. Visualization and mathematics 3 (2002), 35–57.
[Mon87] M ONK P.: A mixed finite element method for the biharmonic equation. SIAM Journal on Numerical Analysis 24, 4
(1987), 737–749.
[MS92] M ORETON H. P., S ÉQUIN C. H.: Functional optimization for fair surface design. In Proceedings of ACM SIGGRAPH
(1992), pp. 167–176.
[NISA07] N EALEN A., I GARASHI T., S ORKINE O., A LEXA M.:
FiberMesh: designing freeform surfaces with 3D curves. ACM
Trans. Graph. 26, 3 (2007), 41.
[PP93] P INKALL U., P OLTHIER K.: Computing discrete minimal
surfaces and their conjugates. Experiment. Math. 2, 1 (1993), 15–
36.
[RBG∗ 09] R EUTER M., B IASOTTI S., G IORGI D., PATAN Cˇ G.,
S PAGNUOLO M.: Discrete Laplace-Beltrami operators for shape
analysis and segmentation. Computers & Graphics 33, 3 (2009),
381–390.
[Sch78] S CHOLZ R.: A mixed method for 4th order problems
using linear finite elements. RAIRO Anal. Numér. 12, 1 (1978),
85–90, iii.
[SK00] S CHNEIDER R., KOBBELT L.: Generating fair meshes
with G1 boundary conditions. In Geometric Modeling and Processing Conference Proceedings (2000).
[SK01] S CHNEIDER R., KOBBELT L.: Geometric fairing of irregular meshes for free-form surface design. Computer Aided
Geometric Design 18, 4 (May 2001), 359–379.
[Tau95] TAUBIN G.: A signal processing approach to fair surface
design. In Proceedings of ACM SIGGRAPH (1995), pp. 351–
358.
[WBH∗ 07] WARDETZKY M., B ERGOU M., H ARMON D.,
Z ORIN D., G RINSPUN E.: Discrete quadratic curvature energies.
Computer Aided Geometric Design 24, 8-9 (2007), 499–518.
[WW94] W ELCH W., W ITKIN A.: Free-form shape design using triangulated surfaces. In Proceedings of ACM SIGGRAPH
(1994), pp. 247–256.
[XPB06] X U G., PAN Q., BAJAJ C. L.: Discrete surface modelling using partial differential equations. Comput. Aided Geom.
Design 23, 2 (2006), 125–145.

c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.


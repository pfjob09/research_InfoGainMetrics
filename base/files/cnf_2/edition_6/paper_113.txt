DOI: 10.1111/j.1467-8659.2009.01686.x
Eurographics/ IEEE-VGTC Symposium on Visualization 2010
G. Melançon, T. Munzner, and D. Weiskopf
(Guest Editors)

Volume 29 (2010), Number 3

Toward a Lagrangian Vector Field Topology
Raphael Fuchs1 , Jan Kemmler1 , Benjamin Schindler1 , Jürgen Waser2 , Filip Sadlo3 , Helwig Hauser4 and Ronald Peikert1
1 ETH

Zurich, Switzerland
Vienna, Austria
3 University Stuttgart, Germany
4 University Bergen, Norway
2 VRVis,

Abstract
In this paper we present an extended critical point concept which allows us to apply vector field topology in the
case of unsteady flow. We propose a measure for unsteadiness which describes the rate of change of the velocities in
a fluid element over time. This measure allows us to select particles for which topological properties remain intact
inside a finite spatio-temporal neighborhood. One benefit of this approach is that the classification of critical
points based on the eigenvalues of the Jacobian remains meaningful. In the steady case the proposed criterion
reduces to the classical definition of critical points. As a first step we show that finding an optimal Galilean frame
of reference can be obtained implicitly by analyzing the acceleration field. In a second step we show that this can
be extended by switching to the Lagrangian frame of reference. This way the criterion can detect critical points
moving along intricate trajectories. We analyze the behavior of the proposed criterion based on two analytical
vector fields for which a correct solution is defined by their inherent symmetries and present results for numerical
vector fields.
Categories and Subject Descriptors (according to ACM CCS): I.3.8 [Computer Graphics]: Applications; I.6.6 [Simulation and Modeling]: Simulation Output Analysis
Keywords: Flow visualization, unsteady flow, vector field topology, Lagrangian coherent structures.

1. Introduction

be defined as the positions where the vector field is zero. In
the unsteady case the critical points and separatrices have no
straightforward definition anymore, since the additional parameter of time allows the critical points to move in space.
Therefore they do not necessarily separate space into different regions of similar behavior. In Sections 3 and 4 we discuss alternative definitions of critical points in the unsteady
case.

Vector fields are a common data representation in scientific
computing. For example numerical solutions to differential
equations can be represented as vector fields. One important
tool to analyze the behavior of vector fields is Vector Field
Topology (VFT), since it provides a view on the geometric structure of the field. From the viewpoint of visualization
one of the most intriguing aspects of VFT is that it condenses
the flow into salient structures which can be simpler to understand than the original data.

One important field of application of topological methods
is fluid dynamics. In their seminal work Lighthill [Lig63]
and later Perry and Chong [PC87,PC94] applied topological
analysis to classify regions of turbulent flow, contributing to
a young field of research which is today known as topological fluid dynamics.

Based on the analysis of the Jacobian it is possible to select representative streamlines (or streamsurfaces in three
dimensions) which separate regions of the vector field of
similar behavior. The set of these representative streamlines
is called the topological skeleton. It consists of degenerate
streamlines (called critical points), streamlines that converge
to saddle points (called separatrices) and closed streamlines
(called closed orbits). In the steady case critical points can
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

VFT can handle both static vector fields and vector fields
that depend on a parameter. In the latter case, VFT is applied (conceptually) to the fields at fixed parameter values.
The results obtained for different parameter values can then

1163

1164

Fuchs et al. / Toward a Lagrangian Vector Field Topology

be connected in several ways. One way is through bifurcation theory, which VFT inherited from the underlying theory
of dynamical systems [AS92]. Bifurcations describe topological changes happening at some parameter values.
1.1. Time-dependent vector fields
The parameter of a vector field can also have the meaning
of time. The VFT-based visualization of a time-dependent
vector field is in general still valid. A restriction must be
made though if the vector field represents a velocity field.
In this case, VFT is able to show the evolution of the instantaneous velocity fields, but it fails to show the dynamics
of the unsteady flow described by the time-dependent velocity field. This happens for example, when a moving critical
point leaves a region of the flow before it can influence the
surrounding region. Since in many, if not most, applications
of VFT the vector field represents velocity, this limitation of
VFT must be addressed.
While for near-steady flow, VFT can provide good enough
approximations for a qualitative visualization, this is no
more true for strongly unsteady flow where the behavior of
particles has no relation to instantaneous streamlines anymore. The “double gyre” by Shadden et. al. [SLM05] and
the “Petri dish” dataset by Wiebel et. al [WCW∗ 09] showed
that VFT fails to produce meaningful results. Both examples
demonstrate that critical points, if they are moving too fast,
give unreliable information.
1.2. Changing the frame of reference
Changing the frame of reference is an obvious approach in
many cases, for example if a feature like a vortex is advected
with an underlying current [PT84] or to find a common
frame of reference to register multiple snapshots of weather
radar data [Mat01].
Perry and Tan [PT84] early pointed out the problem of
finding an adequate frame of reference to extract meaningful critical points. For unsteady flows there does not have
to be a single frame of reference which allows us to extract
all important topological features. In this paper we therefore
suggest to extend this approach to find an optimal change
of the reference frame locally. One question we deal with in
this paper is how such a frame can be selected.
A criterion for the validity of VFT in a given frame was
given in 1994 by Perry and Chong [PC94], who stated:
It is only when a Galilean frame of reference can
be found which gives an almost steady velocity
field that we have a velocity pattern with some useful physical meaning.
In other words a critical point is only good when the field
is more or less steady around it so that the critical point has
time to influence the flow. This criterion will be later used as
the basis of our approach.

When the motion of a critical point is known to be near
linear, changing to a Galilean frame of reference can be sufficient. In this case such a change would be preferred, since
this type of change has the implicit interpretation of a moving observer. In Section 3 we discuss an approach to find an
optimal Galilean frame, locally. On the other hand, there are
patterns, e.g., jets in cross-flow [Kel91] where there is no
single Galilean frame which can be chosen to extract all the
critical points at once. The eddies are accelerating and for a
given frame of reference the eddies can be extracted as foci
but only for a short time interval. This means a linear transformation is not always sufficient, as also demonstrated by
the “Petri Dish” and the “Double Gyre” example in Section
5.

1.3. Unsteady critical points should be particles
In the topological skeleton the separatrices enclose regions
of similar behavior and intersect at the saddle points. Therefore, we can interpret saddle points as positions where
regions of similar behavior connect. Conversely, particles
which belong to adjacent regions are expected to show dissimilar behavior otherwise the two regions should not be
separate. Therefore, we can expect a good definition of a
time-dependent topological separation to separate particles
which remain in a single region of similar behavior over
time. This requirements coincides with the property of a
material surface [Bat67] to separate the interior and exterior material. Therefore, we can require the boundaries of a
time-dependent topological skeleton to be material surfaces
and the unsteady critical points to be fluid particles. Similarly, a critical point that represents a sink (source) is expected to move like a single particle that acts as an attractor
(repeller). This realization is our motivation to switch to a
Lagrangian frame of reference to find critical points moving
on non-linear trajectories. Of course taking into account the
approximate nature of CFD data sets, we can also expect the
extracted critical points to fulfill this requirement approximately. This approach also has a disadvantage: if we locally
change to the frame of reference that has the same motion as
the particle, all particles are critical points (in its own frame
each particle has zero velocity). Therefore we need a criterion to select appropriate particles in the Lagrangian frame.
In Section 4 we show how the unsteadiness criterion can find
critical points in the Lagrangian frame of reference.
The contributions of our paper are as follows:
• A criterion to locate moving critical points.
• An unsteadiness criterion that allows us to measure the
spatio-temporal rate of change of the vector field at each
position.
• An algorithm to find critical points in an optimal Galilean
frame of reference.
• Our analysis gives an alternative understanding of a previous approach by Kasten et al. [KHNH09].
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

Fuchs et al. / Toward a Lagrangian Vector Field Topology

• We present a novel synthetic field which captures the behavior of the “Petri dish” data set [WCW∗ 09].
• A natural way to classify critical points in unsteady flow,
since the analysis of the Jacobian remains meaningful.

2. Related work
Topology-based flow visualization is an active research
topic. Lighthill [Lig63] and Perry and Chong [PC87] were
among the first to apply VFT to fluid flow. Helman and
Hesselink introduced these methods to the scientific visualization community for the visualization of velocity
fields [HH89, HH91]. Globus et al. applied these techniques to CFD data sets and showed their practical relevance [GLL91]. For a detailed overview we refer to Asimov’s excellent tutorial [Asi93] and a recent state-of-the-art
report by Laramee et al. [LHZP07].
Instantaneous topology extraction can be combined with
tracking of the critical points over time. Tricoche et
al. [TSH01, TWSH02] present a method for tracking the location of critical points and detecting local bifurcations such
as fold bifurcations and Hopf bifurcations. An extension to
3D has been presented by Garth et al. [GTS04] together with
a visualization of the critical points paths in space-time.
With the “double gyre” Shadden et al. [SLM05] gave an
example of an unsteady flow for which a saddle type critical point substantially deviates from the actual point of flow
separation. Recently, Wiebel et al. [WCW∗ 09] demonstrated
the failure of vector field topology to find moving attractors
in simulation data of a rotating liquid suspension. They suggested a procedural solution based on the evolution of density of virtual particles seeded in the flow.
The finite-time Lyapunov exponent (FTLE), by
some authors referred to as direct Lyapunov exponent
(DLE) [Hal01a], is a measure for the stretching of an
infinitesimal neighborhood along a finite segment of a flow
trajectory.
Originally, the finite-time variant was used [GSO87,
YN93] to quantify the predictability of dynamical systems, especially for atmospheric models. In a seminal paper [Hal01b], Haller applied FTLE to velocity fields of fluid
flow and revealed their relationship to the Lagrangian coherent structures (LCS), which can provide information on flow
separation similar to the separatrices of vector field topology
and often also correctly for strongly time-dependent flow as
well. Recently, Sadlo et al. [SW09] showed that LCS can
be obtained by generating streak manifolds along hyperbolic
trajectories, following a definition by Haller et al. [Hal00].
The idea in this approach is that in time-dependent 2D vector fields the role of saddle-type critical points is replaced
by hyperbolic trajectories, i.e. trajectories along which the
velocity gradient exhibits a negative determinant. Since this
work aims at the extraction of separating structures which
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

1165

could replace separatrices in the unsteady case, it has the potential of being combined with the work presented in this
paper using the novel critical points as seed points.
Comparisons of FTLE with other criteria in terms of suitability for visualization were made by several authors. Shadden et al. [SDM06] showed that FTLE is able to reveal the
fine lobes of a chaotic vortex ring while producing temporally more consistent results than an approach based on VFT.
In a study done by Sadlo et al. [SP07], FTLE was shown to
extract flow separation structures, but not the axes or centers
of rotating flow. In comparison with vector field topology,
this means that FTLE provides only partial information. In
the example of a spiral saddle critical point, where vector
field topology would give a 1D and a 2D invariant manifold
that can be interpreted as a vortex axis and a separation surface, only the latter is reliably detected by FTLE.
Cucitore et al.’s non-local vortex detector [CQB99] uses
a reference frame that moves with a particle. In this frame,
the path of a neighbor particle is calculated for a certain time
window. Then, the distance of the end point from the origin
is divided by the arc length of the path. Low values of this
ratio indicate a vortex center. Haller proposed another vortex detector Mz [Hal05] that is objective, i.e. invariant not
only under Galilean transforms, but also for rotating frames
of reference. Finally, any local vortex detector designed for
steady flow can be adapted to unsteady flow by applying Lagrangian smoothing, i.e. by computing a weighted average
of the quantity obtained for the same particle at several time
steps [FPS∗ 08].
Recently, several authors brought up the idea to adapt
the definitions underlying vector field topology for unsteady velocity fields. Theisel et al. [TWHS04] and Shi et
al. [STW∗ 06] analyzed the behavior of path lines and suggested a definition of time-dependent VFT for the special
case of periodic vector fields. Shi et al. [STW∗ 08] suggest
to analyze the Poincaré map of the velocity field, which allows to find critical points in time-periodic data sets such as
the Petri Dish and the Double Gyre example discussed later.
Kasten et al. [KHNH09] investigated Galilean-invariant
counterparts for critical points in time-dependent 2D vector
fields. They propose minima of the acceleration magnitude,
after a temporal smoothing in the Lagrangian frame, as a replacement for critical points in unsteady velocity fields. This
generalization of critical points is also subject to investigation in this work.
3. Motion compensated critical points
In this section we present a method to find an optimal
Galilean frame of reference and to relate the critical points
found in the new frame to the critical points in the original
field. The resulting criterion based on the acceleration of the
flow is also applied in the next section.
We analyze Galilean changes of the frame of reference,

1166

Fuchs et al. / Toward a Lagrangian Vector Field Topology

with the goal of finding critical points that do not move instantaneously. Intuitively it is clear that these are the zeros
of the acceleration field
(∇u)u +

∂u
.
∂t

(1)

If in a vector field u(x,t) the point x0 is a critical point at
time t0 , a first-order Taylor expansion of u(x,t) in both variables at (x0 ,t0 ) shows that the critical point moves with the
instantaneous velocity
−(∇u(x0 ,t0 ))−1

∂u
(x0 ,t0 ).
∂t

(2)

Assuming regularity of the Jacobian (i.e. a first-order critical
point), we can therefore say that the critical point stands still
if
∂u
(x0 ,t0 ) = 0.
∂t

(3)

Because we have also u(x0 ,t0 ) = 0, this is equivalent to the
condition that the acceleration field (1) has a zero at (x0 ,t0 ).
Now, since acceleration is a Galilean invariant quantity, its
zeros can be detected in any Galilean-transformed frame of
reference.
Therefore, the following algorithm can be used.
For each time step t0
1. Compute the acceleration field and find its zeros.
2. For each zero (x0 ,t0 ) compute the Galilean transform that
makes it also a zero of the velocity field (i.e., a critical point). This is simply a frame moving with velocity
u(x0 ,t0 ).
3. In this frame of reference, analyze the instantaneous velocity field for t = t0 :
a. compute eigenvalues and eigenvectors of the Jacobian
and determine the type of the critical point.
b. if it is a saddle point, compute tangents and optionally
separatrices.
c. use these for analyzing/visualizing the flow in a spatial
and temporal neighborhood of the critical point.
We call the points obtained by this procedure “motion compensated critical points”. For a static vector field, motion
compensated critical points are a superset of the critical
points, because here, zero velocity implies zero acceleration.

3.1. Relation to classical VFT
For a time-dependent vector field, there is so far no correspondence between the set of compensated critical points
and the set of critical points. But such a correspondence can
be established by creating a linear transition from the instantaneous flow to the unsteady flow (both at time t0 ). Let us
consider the 1-parameter family of fields
uk (x,t) = u(x,t0 + k(t − t0 ))

(4)

for 0 ≤ k ≤ 1. For k = 0 this is the instantaneous flow
u0 (x,t) = u(x,t0 ) and for k = 1 this is the unsteady flow
u1 (x,t) = u(x,t). By letting k vary from 0 to 1, acceleration
zeros of the fields uk either move continuously or they vanish at some point at domain boundaries or in bifurcations. By
only accepting acceleration zeros that can be tracked through
the entire range of 0 ≤ k ≤ 1, we obtain a set of critical points
each of which can be linked to a critical point in another
Galilean frame of reference having the additional property
that it stands still in that frame. The important point here is,
that we also obtain a connection of the corrected frame to
the critical points in the original frame. We can use this relation to restrict the set of motion compensated critical points
to those which also exist in the original frame of reference
in case the original frame has physical meaning for the application.
In Section 5 we analyze the behavior of the motion compensated critical points and show that the approach of motion compensated critical points is already sufficient to find
critical points in many cases.
3.2. Relation to the long-living features approach
The motion compensated critical points are a simple concept
by itself but they also give a new way to interpret the points
proposed by Kasten et al. [KHNH09]. We believe that their
suggestion to focus on long-living features is an important
step. They also show empirically that Lagrangian smoothing
greatly improves the feature extraction in unsteady flows.
The motion compensated critical points now give a physical interpretation for their approach, i.e., as critical points
which do not move instantaneously. The proposed point of
view also allows us to select the frame of reference which is
the appropriate one for topological analysis, i.e. in contrast
to Kasten et al. the approach of a motion compensated frame
gives a frame of reference which is the appropriate one for
further topological analysis. For example, since the correct
frame is known for the motion compensated critical points,
the topological information to show glyphs according to critical point classification is available. The link to the critical
points in the original frame is additional valuable information which was not available before.
4. Critical points in Lagrangian frames of minimal
unsteadiness
However, we observed that the approach of motion compensated critical points does not solve the “Petri dish” problem
which is not surprising as a linearly moving frame is obviously of no help here. We argue that the physically motivated
preference for Galilean transforms is not an absolute requirement for the problems in question. Firstly, the data to be analyzed can represent a non-physical vector field. Secondly,
the data are not necessarily given in an inertial frame of reference, and hence the appropriate frame could be a rotating
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

Fuchs et al. / Toward a Lagrangian Vector Field Topology

or a linearly accelerating one. In the “Petri dish” example,
a frame with its origin moving on a circle can be found that
makes the flow more steady and that produces a better topological result. It has to be emphasized that the goal of vector
field topology (and its targeted modifications) is structural,
not physical, information.
Instead of allowing now for translated, rotated, or otherwise transformed frames explicitly, we pursue the idea of
assuming a Lagrangian view. That is, we use a frame of reference that moves with a particle of the flow (sometimes
called a massless particle). Due to the aforementioned criterion of Perry and Chong, it is a reasonable objective to find,
for a given unsteady velocity field, a frame of reference that
makes it almost steady.

1167

where δ(x, t) is the path of the particle starting at (x, t), and
Ω is a neighborhood of the particle.
In the steady case critical points have velocity zero. In
this case also unsteadiness has a minimum, but not always
an absolute minimum. Therefore unsteadiness is consistent
with VFT in the steady case.
4.1. Measuring non-local unsteadiness

Now, of all particles in the flow the ones are chosen which
A are observing an almost steady velocity field and
B have small acceleration magnitude.
The first test assures that a spatial and temporal neighborhood behaves approximately like a steady flow if viewed
from an observer moving with the particle. Under this condition, the second test assures that the reference frame is
nearly Galilean as discussed in Section 3. Even though it is
not always possible to find a Galilean frame of reference, requirement B ensures that we find a Lagrangian frame which
is as Galilean as possible. The two tests can be combined
in a number of ways, which we will explore in this paper.
Also, both tests require a spatial and temporal neighborhood,
the sizes of which are additional parameters of the proposed
framework.
The rate of change of a single variable at a given point
is described by the magnitude of its derivative. In three dimensional space the spatial rate of change is described by
the magnitude of the Jacobian. The the infinitesimal unsteadiness at a given point is now the material derivative
D
( Dt
= (u·∇)+ ∂t∂ ) of the velocity gradient J(x,t) = ∇u(x,t)
which describes the relative velocities in a small neighborhood of the particles. The material derivative is also referred
to as the Lagrangian derivative, since it describes the rate of
change along the path of a particle. In the next section we describe how we compute unsteadiness by following the path
of a particle.
Formally, unsteadiness can be expressed by
unsteadinesslocal (x, t) =

D
J(x, t) .
Dt

(5)

This expression reveals the formal analogy to the acceleration magnitude, the measure for the motion compensated
D
critical points, Dt
u(x, t) .
The non-local unsteadiness is then defined as
unsteadinessnon−local (x, t) =
[t−T,t+T ] Ω

D
J(δ(x, τ), τ)) dωdτ
Dt

Figure 1: Computation of unsteadiness. The unsteadiness as
defined in Equation 6 can be computed by the combination
of a spatial and temporal filter.
We measure the non-local unsteadiness by spatial sampling of the velocity field. We have to estimate the material
derivative from data sampled as discrete timesteps. We can
compute the material derivative by integrating a particle path
and computing finite differences. Figure 1 shows an illustration of this approach. Practically, the velocity gradient is estimated by using a small uniform sampling grid centered at
the desired point. If a temporal filtering is also needed, this
is repeated for a number of samples along the trajectory and
an average of the obtained unsteadiness values is taken.
At any given position p where the unsteadiness has to be
estimated the following steps are performed:
1. Place a small grid around p and estimate the Jacobian on
each sampling position.
2. Convolve the magnitudes of the temporal derivatives of
the Jacobians.
3. Convolve resulting values along the particle paths
The size of the sampling grid and the number of samples
have to be chosen depending on the scale of the features the
user is interested in. For the datasets in this paper we used
9 × 9 sampling grids, but it remains numerically stable also
for smaller sampling grid sizes. We suggest to work with
the smallest spatial and temporal filtering radii for which the
extracted critical points do not change noticeable when increasing the radii.
4.2. Measuring critical point acceleration

(6)

c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

The position of candidate critical points following criterion
A are at the minima of particle unsteadiness. To match these

1168

Fuchs et al. / Toward a Lagrangian Vector Field Topology

positions with positions at the next time step we use a simple
gradient descent approach: given the position from the previous time step, we follow the direction where the unsteadiness decreases most until a minimum is reached. The critical point from the previous time step and the critical point
at the minimum are then marked as belonging to each other.
Based on the tracking information, the acceleration of a critical point can then be computed from positions at three consecutive time steps.
4.3. Classification
We aim at a topological analysis of the Lagrangian view of
the flow, i.e. at identifying material particles around which
the fluid behaves attracting, repelling or saddle-like. Since
we are identifying material particles which are critical points
this classification is straightforward. We can simply use the
eigenvalues of the Jacobian of the particle velocity. Depending on the type of flow this allows to extract critical points
classifications such as source, sink, saddle, focus and spiral
saddle in case of unsteady flow.

simple Lagrangian filtering of the velocity magnitude does
not produce relevant features. (d) As we can expect from the
discussion in Section 3 filtering acceleration magnitude already produces some interesting results. There are two minima at the top and at the bottom which are shifted from the
positions of the VFT in Figure 2. (e) The unsteadiness also
captures all four relevant positions and coincides with (d)
and (f) for the bottom critical point. (f) FTLE captures both
the bottom separation and the top separation well if we combine forward-time and backward-time FTLE. In Figure 4 we
can see that for the bottom critical point the four measures
behave essentially the same, whereas instantaneous methods
fail to produce the correct results.

(a) velocity magnitude

(b) acceleration magnitude

(c) velocity magnitude filtered

(d) accel. magnitude filtered

(e) unsteadiness

(f) FTLE

5. Results
5.1. “Double Gyre”

Figure 2: “Double gyre” field at t = 0 and t = 2.5.
This unsteady 2D vector field was used by Shadden [SLM05] to demonstrate that saddles of vector field
topology can deviate from the point of actual saddle behavior. The field is defined by
u(x, y,t) = −πA sin(π f (x,t)) cos(πy)
d
v(x, y,t) = πA cos(π f (x,t)) sin(πy) dx
f (x,t)

(7)

f (x,t) = ε sin(ωt)x2 + (1 − 2ε sin(ωt)) x

(8)

where

and A = 0.1, ω = π/10, ε = 0.25. Figure 2 shows this velocity field at two time steps. The important feature in this
example are two moving vortices in the center and two moving positions where the velocity is zero at the top and the
bottom of the image. As Shadden already noticed the position of zeros of velocity do not capture the positions of material separation. They suggested maxima of FTLE which
does capture the real position of flow separation at least for
the bottom critical point. In Figure 3 we compare the suggested quantities. In (a) and (b) we show velocity and acceleration magnitude for comparison. In (c) we can see that

Figure 3: Velocity magnitude (a) shows critical points in
blue. The one in the bottom center is the saddle point to
be studied. The minimum of acceleration magnitude (b) is
shifted to the right. The same quantities, but Gaussianfiltered over the time range [− 32 , 32 ] (c,d), show a minimum
somewhere in between. Unsteadiness (e) has a clear minimum and FTLE (f) a clear maximum at the same spot. The
transfer functions are chosen such that minima (blue) and
maxima (red) are clearly distinguishable.

5.2. “Petri Dish” example
Recently, Wiebel et al. [WCW∗ 09] presented a numerically
generated vector field which shows that VFT can fail not
only for saddle type critical points, but also for a sink. They
showed that the critical point deviates strongly from the
point where particles are actually attracted to. They found a
local FTLE maximum in the vicinity of this rotating attractor. They also suggested a method to locate this sink using a
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

1169

Fuchs et al. / Toward a Lagrangian Vector Field Topology

Without the factor 1 − x2 − y2 , this is a linear field having
a focus sink at the point (x, y) = (r cost, r sint). The eigenvalues of this critical points are −a ± iω. The critical point
rotates on a circle with radius r at an angular velocity of 1,
and the linear field moves accordingly. The role of the factor
1 − x2 − y2 is to cause the field to be zero on the unit circle.
It does not influence the position of the critical point.

Figure 4: Comparison of methods on the dynamic saddle point on the x-axis of the “double gyre”. The x coordinate is plotted against the time for a full period. All
methods based on a time window (solid lines) essentially
agree. The unsteadiness minimum (red) almost equals the
minimum of velocity magnitude (black), while the FTLE
maximum (green) and the minimum of acceleration magnitude (blue) have slight offsets. The instantaneous methods
(dashed lines) clearly deviate from these. The zero of the acceleration (blue) has mainly an amplitude error, while the
critical point (black) also has a phase error of about 0.8.

Figure 5: “Petri Dish” field at t = 0 and t = π/2.

convergence measure based on virtual particles. Their simulation data set describes the aggregation behavior of cells immersed in a nutrient solution, when the Petri dish is placed
at an appropriate radius onto a rotating disk. We present a
synthetic analogue of this data set which captures the same
essential behavior.
The vector field is defined on the unit disk as follows
2

2

(−ω (y − r sint) − a (x − r cost))

2

2

(ω (x − r cost) − a (y − r sint))

x = 1−x −y
y = 1−x −y

(9)

with the parameters chosen as r = 13 , ω = a = 1.
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

In our analytical example we confirm the results
from the numerically obtained vector field by Wiebel et
al. [WCW∗ 09] (see Figure 6), and we measured the errors
as a function of the temporal filter support T (see Figure 7).
Note that we have chosen the parameter T in the Figure such
that the resulting critical points do not change their position
for larger values of T anymore. Since the field is periodic in
time, the correct attractor can be computed as the fixed point
of the flow map corresponding to one period. It turns out
that it has a radius of 0.456 and a phase shift of -1.042 (or
59.7 degrees) as compared to the rotating critical point. Both
the FTLE maximum and the unsteadiness minimum tend toward the rotating attractor with growing T . The other two
of the examined quantities, acceleration magnitude and velocity magnitude, have no local extremum near the rotating
attractor. They have a local extremum near the critical point,
but only for smaller values of T .

(a)

(b)

(c)

(d)

(e)

(f)

(g)

(h)

Figure 6: Top row: extrema of FTLE (a), unsteadiness (b),
acceleration magnitude (c), and velocity magnitude (d) using a temporal filter with support [-1.5, 1.5]. Bottom row:
The same with temporal filter support [-5.0,5.0]. Now, (e)
and (f) almost coincide, while in (g) and (h) the extremum
has disappeared. Color maps are chosen to isolate the local
extremum.

5.3. Vortex street example
The example used here is a time-dependent 3D simulation
of a vortex street, from which the 2D field in the symmetry plane has been extracted. As is, the field does not have
any critical points. However, in this special case, after subtracting a constant horizontal velocity, the vortex centers appear as critical points. In this example we can therefore ex-

1170

Fuchs et al. / Toward a Lagrangian Vector Field Topology

(a) Acceleration magnitude
(a)

(b)

Figure 7: With increasing support length of the temporal
smoothing filter, the errors in radius (a) and phase (b) of the
FTLE maximum (solid line) and the unsteadiness minimum
(dashed line) w.r.t. the correct rotating attractor tend to zero.

(b) Unsteadiness

pect the motion-compensated critical points to perform optimally. The modified velocity field is shown in the background LIC image used in Figure 8. Of course, the LIC image is only valid for the critical points moving exactly at
the subtracted constant velocity, and also the critical points
depend on the subtracted velocity. The saddle type critical
points are affected much more than the vortex centers, where
it is mainly the y-coordinate that is affected. Since the vortices move with near constant velocity, it is not surprising
that the method of motion compensated critical points works
well here (Figure 8a). The unsteadiness method (Figure 8b)
works well, although the two methods deviate in the right
part of the images, where it is not absolutely clear which
constant horizontal velocity shift is valid. In this example,
temporally filtered velocity magnitude and also FTLE fail
completely.
The vortex street example shows clearly that both working methods have false positives, therefore it is important to
view the resulting points as feature candidates, not as features. Both the motion compensated critical points and the
points of minimal unsteadiness yield the information about
a frame in which a topological analysis can be performed.
Based on the eigenvalues of the critical point, a reduction of
the set of feature candidates could be done.
Table 1 summarizes our evaluation results as discussed in
this section.

vel. mag. filtered
FTLE
accel. mag. filtered
unsteadiness

“Double
Gyre”
−
+
+
+

“Petri
Dish”
−
+
−
+

Vortex
street
−
−
+
+

Table 1: Summary of the evaluation results.

(c) Velocity magnitude

(d) FTLE

Figure 8: By subtracting a constant (empirically found) velocity, the vortices appear in the background LIC images
used in (a)-(d). Minima of (temporally filtered) acceleration
magnitude and unsteadiness (b) are able to detect the vortex centers, in contrast to velocity magnitude (c) and FTLE
(d). The color maps have been chosen such that the local extrema become visible. In addition, the set of extrema (after
thresholding) is depicted by the white crosses.

6. Conclusions
In this paper we have proposed a definition for critical points
in unsteady flow fields. We examine previous approaches
and then combine them with a novel definition of unsteadiness. Our suggestion is to use a combination of the motion
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

Fuchs et al. / Toward a Lagrangian Vector Field Topology

1171

compensated particles and unsteadiness as discussed in Section 4. The proposed approach is based on the realization that
topological structures can be meaningful only when there
is a frame of reference in which the topology of the vector
field is stable over a finite amount of time. Another important point is the realization that since topological structures
should cover regions of particles which share common behavior the extracted critical points should behave like material elements. Therefore it is important that there is as little
flux over the defined topological structures as possible. The
proposed definition achieves this requirement naturally by
selecting particles directly.

Acknowledgments

In future work we would like to perform numerical studies
on additional numerical flow simulation results. The main
problem here is to find locations in real world data sets where
it is possible to establish some form of “ground truth” that
allows a valid comparison.

[Asi93] A SIMOV D.: Notes on the topology of vector fields
and flows. Tech. rep., NASA Ames Research Center,
1993. RNR-93-003. 3

A second open question is how we can improve the unsteadiness criterion in the case of large regions of very similar low unsteadiness values. In these cases additional criteria
for regions of low unsteadiness where no distinct minimum
exists would be beneficial.
Another open issue is a unified approach to select optimal
extends for temporal and spatial filtering. These are additional parameters inherent in most non-local feature extraction algorithms and it would increase the practical applicability of the presented approach if these parameters could be
specified automatically.
The computation cost of the unsteadiness values is dominated by the cost of the particle integration. In the current
implementation we use an adaptive Runge-Kutta-Fehlberg
implementation of fourth order. For long integration times
the integration takes more than 90% of the computation
time. New ideas to reduce the required amount of integration
steps, e.g. using a smart candidate pre-selection, therefore
could have strong impact on the required computation time.
Currently the computation of unsteadiness for a 256 × 128
structured grid over 100 timesteps requires almost 11 minutes on a single processor of a Core i7, 2.9 GHz CPU. Using the gradient descent approach discussed in Section 4.2
would allow to avoid recomputing the unsteadiness for the
whole field at all time steps.
The independence of unsteadiness values at each position
of the data set suggests a parallel implementation. Such an
implementation could, in principle, compute the unsteadiness for all voxels simultaneously. We would therefore expect a GPU implementation of the unsteadiness criterion to
run interactively. Even though the current implementation
focuses on the two dimensional case we do not expect conceptual difficulties in three dimensions. A more efficient,
GPU-accelerated implementation will be important to analyze the suggested approach also for three dimensional data
sets.
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

The authors would like the anonymous reviewers for their input. The project SemSeg acknowledges the financial support
of the Future and Emerging Technologies (FET) programme
within the Seventh Framework Programme for Research of
the European Commission, under FET-Open grant number
226042.
References
[AS92] A BRAHAM R. H., S HAW C. D.: Dynamics, the
Geometry of Behavior. 2nd ed. Addison-Wesley, 1992. 2

[Bat67] BATCHELOR G. K.: An Introduction to Fluid Mechanics. Cambridge University Press, 1967. 2
[CQB99] C UCITORE R., Q UADRIO M., BARON A.: On
the effectiveness and limitations of local criteria for the
identification of a vortex. European Journal of Mechanics
- B/Fluids 18, 2 (1999), 261 – 282. 3
[FPS∗ 08] F UCHS R., P EIKERT R., S ADLO F., A LSAL LAKH B., G RÖLLER M. E.: Delocalized unsteady vortex region detectors. In Proceedings VMV 2008 (2008),
pp. 81–90. 3
[GLL91] G LOBUS A., L EVIT C., L ASINSKI T.: A tool
for visualizing the topology of three-dimensional vector
fields. In Proc. of IEEE Visualization ’91 (1991), pp. 33–
40. 3
[GSO87] G OLDHIRSCH I., S ULEM P. L., O RSZAG S. A.:
Stability and Lyapunov stability of dynamical systems: A
differential approach and a numerical method. Physica D
27, 3 (aug 1987), 311–337. 3
[GTS04] G ARTH C., T RICOCHE X., S CHEUERMANN G.:
Tracking of vector field singularities in unstructured 3D
time-dependent datasets. In Proc. of IEEE Visualization
2004 (2004), pp. 329–336. 3
[Hal00] H ALLER G.: Finding finite-time invariant manifolds in two-dimensional velocity fields. Chaos 10, 1
(2000), 99–108. 3
[Hal01a] H ALLER G.: Distinguished material surfaces
and coherent structures in three-dimensional fluid flows.
Physica D 149 (2001), 248–277. 3
[Hal01b] H ALLER G.: Distinguished material surfaces
and coherent structures in three-dimensional fluid flows.
Physica D 149 (2001), 248–277. 3
[Hal05] H ALLER G.: An objective definition of a vortex.
Journal of Fluid Mechanics 525 (2005), 1–26. 3
[HH89] H ELMAN J., H ESSELINK L.: Representation and
display of vector field topology in fluid flow data sets.
Computer 22, 8 (1989), 27–36. 3

1172

Fuchs et al. / Toward a Lagrangian Vector Field Topology

[HH91] H ELMAN J., H ESSELINK L.: Visualizing vector
field topology in fluid flows. IEEE Computer Graphics
and Applications 11 (May 1991), 36–46. 3

Joint E UROGRAPHICS – IEEE VGTC Symp. on Visualization (EuroVis 2006), Santos, Ertl, Joy, (Eds.). A K Peters,
2006, pp. 139–146. 3

[Kel91] K ELSO R.: A study of free shear flows near rigid
boundaries. PhD thesis, University of Melbourne, 1991.
2

[STW∗ 08] S HI K., T HEISEL H., W EINKAUF T., H EGE
H.-C., S EIDEL H.-P.: Finite-time transport structures of
flow fields. In Proc. IEEE Pacific Visualization (2008). 3

[KHNH09] K ASTEN J., H OTZ I., N OACK B. R., H EGE
H.-C.: On the Extraction of Long-living Features in
Unsteady Fluid Flows. In Topological Data Analysis
and Visualization: Theory, Algorithms and Applications
(to appear), Pascucci, Tricoche, Hagen, Tierny, (Eds.).
Springer, 2009. 2, 3, 4

[SW09] S ADLO F., W EISKOPF D.: Time-Dependent Vector Field Topology: An Approach Inspired by Lagrangian
Coherent Structures. Computer Graphics Forum (to appear) (2009). 3

[LHZP07] L ARAMEE R., H AUSER H., Z HAO L., P OST
F.: Topology-based flow visualization, the state of the art.
In Topology-Based Methods in Visualization: Proc. of the
1st TopoInVis Workshop (TopoInVis 2005) (2007), Hauser,
Hagen, Theisel, (Eds.), pp. 1–20. 3

[TSH01] T RICOCHE X., S CHEUERMANN G., H AGEN
H.: Topology-based visualization of time-dependent 2D
vector fields. In Data Visualization 2001: Proc. of the
3rd Joint E UROGRAPHICS – IEEE TCVG Symp. on Visualization (VisSym 2001), Ebert, Favre, Peikert, (Eds.).
Springer, 2001, pp. 117–126. 3

[Lig63] L IGHTHILL M.: Attachment and Separation in
Three Dimensional Flow. Oxford University Press, 1963.
1, 3

[TWHS04] T HEISEL H., W EINKAUF T., H EGE H.-C.,
S EIDEL H.-P.: Stream line and path line oriented topology for 2D time-dependent vector fields. In Proc. of IEEE
Visualization 2004 (2004), pp. 321–328. 3

[Mat01] M ATEJKA T.:
Estimating the most steady
frame of reference from doppler radar data. Journal
of Atmospheric and Oceanic Technology 19(7) (2001),
˝
1035U1048.
2

[TWSH02] T RICOCHE X., W ISCHGOLL T., S CHEUER MANN G., H AGEN H.: Topology tracking for the visualization of time-dependent two-dimensional flows. Computers & Graphics 26 (2002), 249–257. 3

[PC87] P ERRY A., C HONG M.: A description of eddying
motions and flow patterns using critical point concepts.
Annual Review of Fluid Mechanics 19 (1987), 125–155.
1, 3
[PC94] P ERRY A., C HONG M.: Topology of Flow Patterns in Vortex Motions and Turbulence. Applied Scientific Research 53 (1994), 357–374. 1, 2
[PT84] P ERRY A. E., TAN D. K. M.: Simple threedimensional vortex motions in coflowing jets and wakes.
Journal of Fluid Mechanics 141 (1984), 197–231. 2

[WCW∗ 09] W IEBEL A., C HAN R., W OLF C., ROBITZKI
A., S TEVENS A., S CHEUERMANN G.: Topological
Flow Structures in a Mathematical Model for RotationMediated Cell Aggregation. In Topological Data Analysis
and Visualization: Theory, Algorithms and Applications
(to appear), Pascucci, Tricoche, Hagen, Tierny, (Eds.).
Springer, 2009. 2, 3, 6, 7
[YN93] YODEN S., N OMURA M.: Finite-time Lyapunov
stability analysis and its application to atmospheric dynamics. Journal of the Atmospheric Sciences 50, 11
(1993), 1531–1543. 3

[SDM06] S HADDEN S. C., DABIRI J. O., M ARSDEN
J. E.: Lagrangian analysis of fluid transport in empirical
vortex ring flows. Physics of Fluids 18, 4 (2006), 047105.
3
[SLM05] S HADDEN S., L EKIEN F., M ARSDEN J.: Definition and properties of Lagrangian coherent structures
from finite-time Lyapunov exponents in two-dimensional
aperiodic flows. Physica D Nonlinear Phenomena 212
(Dec. 2005), 271–304. 2, 3, 6
[SP07] S ADLO F., P EIKERT R.: Visualizing lagrangian
coherent structures: A comparison to vector field topology.
In Proc. of the 2nd TopoInVis Workshop
(TopoInVis 2007) (2007). 3
[STW∗ 06] S HI K., T HEISEL H., W EINKAUF T., ,
H AUSER H., H EGE H.-C., S EIDEL H.-P.: Path line
oriented topology for periodic 2d time-dependent vector fields. In Data Visualization 2006: Proc. of the 8th
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.


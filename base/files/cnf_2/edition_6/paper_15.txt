DOI: 10.1111/j.1467-8659.2009.01590.x

COMPUTER GRAPHICS

forum

Volume 29 (2010), number 1 pp. 191–201

Automatic Transfer Function Specification for Visual
Emphasis of Coronary Artery Plaque
S. Glaßer1 , S. Oeltze1 , A. Hennemuth2 , C. Kubisch1 , A. Mahnken3 , S. Wilhelmsen4 and B. Preim1
1 Department

of Simulation and Graphics, University of Magdeburg, Magdeburg, Germany
2 Fraunhofer MEVIS, Bremen, Germany
3 Department of Radiology, University Hospital, Magdeburg, Germany
4 Department of Radiology, University Hospital, Aachen, Germany

Abstract
Cardiovascular imaging with current multislice spiral computed tomography (MSCT) technology enables a noninvasive evaluation of the coronary arteries. Contrast-enhanced MSCT angiography with high spatial resolution
allows for a segmentation of the coronary artery tree. We present an automatically adapted transfer function (TF)
specification to highlight pathologic changes of the vessel wall based on the segmentation result of the coronary
artery tree. The TFs are combined with common visualization techniques, such as multiplanar reformation and
direct volume rendering for the evaluation of coronary arteries in MSCT image data. The presented TF-based
mapping of CT values in Hounsfield Units (HU) to color and opacity leads to a different color coding for different
plaque types. To account for varying HU values of the vessel lumen caused by the contrast medium, the TFs are
adapted to each dataset by local histogram analysis. We describe an informal evaluation with three board-certified
radiologists which indicates that the represented visualizations guide the user’s attention to pathologic changes of
the vessel wall as well as provide an overview about spatial variations.
Keywords: transfer function, volume rendering, vessel visualization
ACM CCS: I.3.3 [Computer Graphics]: Display algorithms

invasive identification, characterization, and quantification of
atherosclerotic CAD [HZZ∗ 07]. Atherosclerotic CAD is the
result of accumulations in the coronary artery wall, so-called
plaques. Plaque deposits are small structures with inhomogeneous densities inside the vessel wall. Due to varying HU
values and the non-uniform contrast agent accumulation, not
all plaques can be segmented directly in CTA data. A visual
emphasis of plaque should take the varying HU values into
account and has to be adapted to each dataset.

1. Introduction
Coronary artery disease (CAD) is the leading cause of death
in western nations [Ame07]. For CAD diagnosis, several
image modalities are applied, for example, conventional invasive X-ray angiography, computed tomography (CT) of
the heart and the coronary artery tree or optical coherence tomography for individual characterization of atherosclerotic
CAD [FDHL03]. Multislice spiral CT (MSCT) allows for a
high spatial resolution with short acquisition times. For enhancement of the blood, contrast agent is applied. With noninvasive contrast-enhanced CT coronary angiography (CTA),
CAD can be reliably excluded. Thus, especially for asymptomatic patients with a high CAD risk (due to increased blood
pressure, age, gender and stress), CTA is the image modality of choice. Since CTA allows for an assessment of the
vessel’s cross-sectional area, it has great potential for nonc 2010 The Authors
Journal compilation c 2010 The Eurographics Association and
Blackwell Publishing Ltd. Published by Blackwell Publishing,
9600 Garsington Road, Oxford OX4 2DQ, UK and 350 Main
Street, Malden, MA 02148, USA.

We present an automatically adapted transfer function (TF)
specification for the qualitative evaluation of CTA datasets.
Because the coronary artery vessel wall and its pathologic
changes have a small extent in comparison to the whole
CTA dataset, global histogram analysis is not sufficient for
the TF specification. Therefore, our approach is based on
a coarse segmentation of the coronary artery tree and local

191

192

S. Glaßer et al. / Automatic TF Specification for Visual Emphasis of Coronary Plaque

histogram analyses of the segmentation result. The adapted
TF allows for the visualization of the coronary vessel wall
and highlighting of plaques. Furthermore, the TF is combined
with common visualization techniques for CAD evaluation
in CTA data, that is maximum intensity projection (MIP),
multiplanar reformation (MPR), curved multiplanar reconstruction (CPR) [KFW∗ 02] for 2D views, and direct volume
rendering techniques (DVR) for 3D views.

2. Medical Background
In this section, we provide additional information about the
medical background of atherosclerotic plaque. Plaque deposits in the coronary artery vessel wall contain different
accumulations, i.e. lipid or fibrous tissue, and can be classified into soft, fibrous and hard plaques. The lipid-rich soft
plaques are prone to rupture and thus very dangerous for the
patient. For individual soft plaque characterization, imaging
modalities such as OCT can be employed. Fibrous plaques
and hard plaques consist of more dense accumulations and
are estimated to be more stable. In addition, hard plaque
deposits contain calcium accumulations and thus are also referred to as calcified plaques. The overall coronary calcium
acts as an indicator for the patient’s whole plaque burden.
For the detection and quantification of the coronary calcium,
non-enhanced MSCT is primarily employed. Quantification
is carried out by applying calcium scores to the data, e.g.
the Agatston score [AJH∗ 90]. The Agatston score defines a
threshold for hard plaques as the sum of the mean plus twice
the standard deviation of the non-enhanced blood intensity.
In CTA datasets, the contrast agent allows for a better
depiction of the blood. Thus, a detection of stenoses and corresponding plaque types is possible. A stenosis is a narrowing
of the lumen – the vessel’s inner open area. Since a reliable
exclusion of CAD based on CTA is possible, it has been established for asymptomatic patients, patients with abnormal
coronary spatial variation or ambiguous medical test results.
Furthermore, it is employed for the monitoring of coronary
stents. Stents are artificial support devices, for example stainless steel mesh tubes, that are placed in a coronary artery after
CAD treatment to keep the vessel open.
The early stages of atherosclerotic CAD do not necessarily
lead to significant stenoses, since they can be compensated
by a positive remodeling of the vessel wall, see Figure 1.
Therefore, the evaluation of the coronary artery lumen is
insufficient for the assessment of the patient’s plaque burden,
and the pathologic change of the vessel wall has to be taken
into account. Evaluation of the lumen and the vessel wall
is carried out in 2D MPR and CPR views. Oblique MPRs
enable a cross-sectional view of the coronary artery and its
wall along the vessel’s centerline, whereas CPRs provide
the vessel’s longitudinal view [KFW∗ 02]. DVR techniques
convey information on the complex anatomy of the entire
coronary tree. However, these visualizations provide only

Figure 1: Illustration of remodeling in cross-section views.
Left, a normal vessel wall (gray) is depicted. Early stages of
CAD are compensated by positive remodeling—an increasing wall thickness (center). Negative remodeling, caused by
progressive CAD, yields a stenosis (right).

limited information about pathologic vessel wall changes
and the coronary artery lumen.

3. Related Work
A large variety of techniques for the visualization of vasculature exists, which can be grouped into surface rendering (SR)
and DVR approaches. SR relies on the extraction of vascular structures, e.g. by thresholding or explicit segmentation,
which is followed by the conversion into a polygonal mesh,
see [PO07] for an overview. For the evaluation of CAD, we
consider that SR is not appropriate, since the vessel wall
and possible small inhomogeneous plaque deposits inside
are likely to be too small for reliable extraction. Therefore,
SR of CTA data would convey an accuracy, which does not
correspond to the underlying data. Furthermore, transitions
in the TF domain may not be represented with SR. Thus, we
chose DVR, as has been suggested in [vOvGR∗ 03].
With DVR, the indirect classification of surfaces of interest is carried out by employing TFs. Special approaches
exist to support the interactive TF definition for different applications [KKH02]. The drawback is the considerable interobserver variability, which affects the derived interpretation.
Rezk-Salama et al. [RSK06] employ a layer technique that
applies simple TFs to reveal inner structures. Hence, accuracy was less important than interactivity, which does not
hold for CAD diagnosis. We aim at an automatically defined TF as starting point for further exploration. In addition
to image data values, derived information such as gradient
magnitude [KKH02] or distance to some reference structure
[TPD06] can be employed yielding multidimensional TFs.
Gradient-based TFs can improve the boundary enhancement
between blood pool and surrounding tissue, but no improvement could be achieved for the visualization of the vessel
wall itself and its inner structures due to the small extents
and thus high sensitivity to noise and artefacts. Since the
remodeling of the vessel wall leads to varying lumen diameters, we do not employ distance-based TFs. Correa et al.
[CM08] applied scale fields for size-based TF generation
and Vega et al. [VST∗ 03, VST∗ 04] discussed the automatic
2D TF design to emphasize vascular structures based on intensity values and gradient magnitude. Another method was

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

193

S. Glaßer et al. / Automatic TF Specification for Visual Emphasis of Coronary Plaque
Approximation of Vessel Wall

Approximation of Blood Pool

IPV for si
Extraction of
centerline
+ tree graph

Extraction of
IPV for each
branch si

CTA
dataset

Search for vessel
wall intensities
in the IPV

Segmented
coronary
arteries

Calculation of μwalli
and σwalli based on
masked intensities

CTA
dataset

Selection of
best μwall
i
and σwalli

μwall

Local histogram
analysis for blood
density distribution approximation

μblood
σblood

Segmented
coronary arteries

σwall

TF Specification
Sample
points
Weighted mask for si

Figure 2: Schematic overview of automatic approximation of the parameters μblood , σblood , μwall and σwall for the TF
specification. The parameters of the blood are calculated by local histogram analysis of the segmented coronary artery tree (top
right). For the vessel wall intensity approximation, μwall and σwall are chosen from a set of μwalli and σwalli for all coronary
artery branches bi (left). First, the centerline of the coronary tree segmentation is extracted and branches are identified. Second,
for each branch bi an intensity profile volume (IPV) is extracted. Based on the IPV, a weighted mask for vessel wall intensities is
determined and applied to the IPV to obtain a sample set of vessel wall intensities, from which μwalli and σwalli can be extracted.
presented by Joshi et al. [JQD∗ 08]. They emphasize vasculature by employing a non-parametric vessel detection method,
which works well even at branchings. Although these approaches allow for highlighting of vasculature, they do not
emphasize abnormalities in the vessel wall. Our concept is
similar to [LLY05], who employ local histogram analyses to
differentiate between organ tissues.

of hard plaques and coronary stents. In contrast to conventional methods, we highlight the vessel wall instead of the
contrast-enhanced lumen of the coronary arteries, including
stenotic and non-stenotic plaques. The TF specification is
carried out by determining supporting points, which depend
on the mean intensity and standard deviation of the bloodpool
(μblood , σblood ) and the vessel wall (μwall , σwall ).

In general, different views are combined for CAD evaluation in CTA data, as presented in [KHB∗ 06] and [SCC∗ 04]. In
both approaches, DVR provide spatial information, whereas
the more detailed vessel evaluation is carried out in the 2D
CPR or MPR views. Other imaging methods for vascular
structures are maximum intensity projection (MIP), for example the MIP views of segmented objects [BA02], sliding thin-slab MIPs [NRJ93] and the novel maximum intensity difference accumulation (MIDA) approach, where shape
cues are provided [BG09].

Because the vessel wall and its pathologic changes cannot be discriminated in a global histogram, a segmentation
method has to be employed, on which further analysis steps
are based. We segment the coronary artery tree of a CTA
dataset with the method described in [HBF∗ 05]. The method
was successfully tested for 61 datasets that were acquired
with different CT scanners from healthy patients, patients
with CAD and with anatomical abnormalities. These datasets
also contained artefacts or inhomogeneous contrasts. During
the segmentation process, branches of the coronary tree that
were not detected in the initial segmentation can be interactively added by the user.

For the separation of calcified hard plaques, Isgum et al.
[IRvG07] introduced an approach for non-enhanced CT. For
CTA data, Hong et al. [HBS∗ 02] applied calcium scores,
yielding a threshold of 350 HU for hard plaque separation.
Wesarg et al. [WFKF06] detected hard plaques in CTA data
by analyzing the minimal diameter of the vessel lumen and
examining stenotic regions. Moreover, they presented a simultaneous mapping of the minimal lumen diameter to color
and to the diameter of a tube around the vessel for highlighting of stenoses. The automatic detection and separation of
soft and fibrous plaques is difficult because clinical studies
reveal different and sometimes overlapping HU intervals for
these plaque types in CTA data [PAM∗ 07].
4. Concept
We present an automatic TF specification for visual emphasis of soft and fibrous plaques and for a visual separation

In this section, the automatic parameter extraction, based
on the segmentation result, is described and followed by the
TF specification. In Figure 2, an overview of the different
steps is provided. At the end of this section, the volume
rendering method for the 3D image display is described.
4.1. Approximation of the blood intensity distribution
For the approximation of the blood intensity distribution and
thus the parameters μblood and σblood , a local histogram analysis is applied to the segmented coronary artery tree, since
the segmentation result mainly contains voxels representing
the contrast-enhanced blood. Due to other intensities originating from surrounding tissue or interpolation issues, the
parameters μblood and σblood cannot be directly derived from
the local histogram.

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

194

S. Glaßer et al. / Automatic TF Specification for Visual Emphasis of Coronary Plaque

CT data acquisition is known to be subject to noise with
a Gaussian distribution where the noise level depends primarily on the amount of ionizing radiation (higher radiation
leads to a better signal-to-noise ratio). Assuming a Gaussian
distribution of the intensity values, we estimate its parameters μ and σ by determining an optimal fit to the intensity
distribution to the local histogram of all segmented voxels.
The fit is carried out by employing a least square method
and binary search methods. Results for μblood and σblood indicate that the average intensity of the blood strongly differs for each tested dataset (i.e. μblood = 356H U ± 136H U
and σblood = 46H U ± 16H U for all tested datasets). Thus,
a static threshold for all datasets for the separation of hard
plaques, for example 350 HU suggested by Hong et al.
[HBS∗ 02], from contrast-enhanced blood is not applicable.
For hard plaque separation, we experienced an overestimation by applying a threshold as presented by Agatston
et al. [AJH∗ 90] for the computation of the Agatston score,
that is a threshold as the sum of the average plus twice the
standard deviation of the approximated blood intensity distribution. Overestimation may arise due to artefacts or contrast
medium accumulations in smaller branches.
To reduce overestimation, a higher threshold t, has to be
determined. In combination, t has to be as small as possible,
since even smaller hard plaques should be highlighted. We
employ the number of skeleton voxels, with intensities larger
than t as a criterion. Since hard plaques are contained in the
vessel wall and not in the lumen, we assume that as few as
possible centerline voxels should be masked by t. The factor
3 is the smallest whole-number multiple which allows for
hard plaque separation and masks no more than 5% of the
skeleton voxels. Therefore, we compute t as
t = μblood + 3σblood .

(1)

In Section 5.2, we will discuss how sensitive t is to small
changes.
Coronary stents, which are in general made of stainless steel mesh tubes, exhibit similar x-ray attenuation coefficients as hard plaques and will be highlighted in the same
manner.

4.2. Approximation of the vessel wall intensity
The described method for blood intensity approximation is
not applicable for the vessel wall, since the intensities of the
vessel wall can neither be separated in a local histogram nor
in a global histogram of the segmentation result due to the
small number of vessel wall voxels. Therefore, we employ
a local histogram analysis for each coronary artery branch
(see Figure 2). To identify these branches, the centerline of
the segmented coronary artery tree is generated. We employ
a successive erosion of border voxels, also taking anisotropic
voxel extents into account, to preserve the topology of the

Figure 3: Extraction of the IPV. For each voxel of the local
centerline of a coronary branch (left), n (e.g. 6) rays perpendicular to the centerline are casted (middle). Along the
rays, intensities are sampled and stored in a slice of the IPV
(right). Repeating this procedure for each centerline voxel of
the branch yields the complete IPV.
initial mask, as it was presented by Selle et al. [SPSP02].
The centerline is transferred into a primitive tree graph representation, where each branch consists of a list with the
corresponding centerline voxels and is linked to adjacent
branches.
The local histograms for the vessel intensity approximation are generated by the intensity profile volume (IPV) extraction for each branch of the centerline. For each centerline voxel of a given branch, n rays perpendicular to the
local centerline are cast and sampled in the CTA dataset.
The number n of rays can be manipulated, depending on the
voxel size and the diameter of coronary arteries, which tapers down from 5 mm to 1 mm. We empirically determine
an amount of 16 rays for each tested dataset (with voxel size
of ≈ 0.3 mm × 0.3 mm × 0.4 mm). A step size of half of the
smallest voxel extent is sufficient for sampling. The rays are
sampled for a certain distance. We recommend 3 mm to assure that the whole cross-section is sampled, since 2.5 mm
is the maximum radius of coronary arteries. The sampled
intensities are stored in a slice of the IPV (see Figure 3). By
repeating this procedure for all centerline voxels, an IPV with
a slice number that equals the number of centerline voxels is
created.
In the next step, we detect the vessel wall intensities in
the IPV. Since sampled intensities, which exhibit the same
distances to the centerline voxel will appear as verticals in
the IPV slice for this voxel, intensities representing the vessel
wall will also be arranged in a vertical order. Therefore, we
employ a slicewise search for vertical structures to the IPV.
These verticals can be heavily distorted due to the approximation of the branch’s real centerline with the branch of the
centerline of the segmentation result, coronary artery wall
remodeling, as well as artefacts arising from dense structures
such as hard plaques, see Figure 4.
Vertical structures can be enhanced by a slicewise convolution of the IPV with a Laplacian of Gaussian (LoG) filter.
Due to its small size, the partial volume effect has a strong
influence on the vessel wall. Therefore, the LoG filter with

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

195

S. Glaßer et al. / Automatic TF Specification for Visual Emphasis of Coronary Plaque
−3

x 10

weights

8

sample set of
branch b

6

i

4

G (μ
i

2

Figure 4: Schemes of cross-sectional vessel views. The casting of rays with the origin at the centerline in contrastenhanced lumen (white) across the vessel wall (light gray) to
surrounding tissue (dark gray) is illustrated. Ideally, circlelike cross-sections yield a vertical in the corresponding IPV
slice (left), whereas ellipsoidal cross-sections lead to distorted vertical structures (right).
kernel size 3 × 3 first smooths the data of the IPV slice and
then approximates the gradient magnitude. In the next step,
a slicewise normalization and thresholding removes intensities with small gradient magnitudes. We employ a threshold
of 0.5 for the normalized slices, which yields a binary mask
that marks all intensities with a higher gradient magnitude.
For taking also distorted vertical structures into account, we
apply a weight function fw to the voxels of each binary mask
slice:
⎧
column
⎪
⎪
⎪
⎨0
if
< 0.5
n
(2)
fw =
⎪
⎪
column
⎪
⎩
else
n
where n is the length of each column, that is the number of
rays that were casted, and column is the number of fields
with a normalized gradient magnitude > 0.5. Due to distorted
structures, it may occur that some slices of the weighted
binary mask do not contain any value >0 in special cases.
These slices will be balanced by other slices containing nonzero weights. The sample set of the vessel wall intensities is
obtained by employing the fw -weighted binary mask to the
original IPV yielding intensities di with weights wi . Thus,
wi is the sum of all weights assigned by fw to the density di .
For each branch bi of the coronary artery tree, we determine μwalli and σwalli as the weighted arithmetic mean
and the weighted arithmetic standard deviation of the remaining intensities of the sample set (see Figure 5). We
then consider the branch bi with the longest centerline and
the parameters μwalli and σwalli that fulfill the condition
μwalli < μblood − 2σblood , as best candidate for the global
vessel wall approximation. For all tested datasets, μwall was
in the interval [50H U , 270H U ]. The parameter extraction
took in average ≈ 4 min for each dataset and was carried out
on a 3.06 GHz processor with 3 GB of RAM.
Further analyses for other centerline branches reveal a
trade-off between variability and quality. On the one hand, the
variability of the spatial diffusion of the contrast agent causes

0
−100

0

100

200

300

400

,σ

)

i

i

wall

wall

500

600

densities [HU]

Figure 5: Sample set of an example branch bi and the approximated Gaussian distribution with μwalli and σwalli .

different average intensity values for the approximation of the
vessel wall, and thus local TFs should be generated. On the
other hand, smaller branches are very sensitive to the partial
volume effect. In addition, the centerline of the segmentation
may be slightly off-centre for smaller branches, and these
branches may exhibit too few voxels for a reliable estimation
of μwall and σwall from the IPV, which results in poor quality.
For example, the tested datasets exhibit strong differences
even for the first two longest branches, that is the average
difference of μwall ≈ 63 HU. In conclusion, no reliable visual
improvements could be achieved with the employment of
different local TFs, extracted with the proposed method.

4.3. TF specification
The automatic TF specification for the visualization of the
coronary tree is based on supporting points, which only depend on μwall , σwall , μblood and σblood . For each supporting
point, an opacity and a color value is assigned. Between
these supporting points, opacities and colors are linearly interpolated. Basically, all TFs which highlight the vessel wall
intensities and provide a visual separation of hard plaques
and thus intensities larger than t = μblood + 3σblood will be
considered as sufficient. Two more requirements should be
fulfilled. First, full transparency should be assigned to the
surrounding tissue and the contrast-enhanced blood. Second,
to reveal inner structures, the vessel wall’s intensities should
be visualized transparently.
Color assignment to the supporting points aims at visual
separation of hard plaques and stents and high contrasts for
the vessel wall visualization. Because hard plaques and stents
are very dense structures, they usually appear white or light
gray in conventional gray scale CTA views. Therefore, intuitive visual separation is achieved by employing colors
from beige to white in combination with high opacity values. For the vessel wall, a color scale from blue over red
to green should be applied, yielding high contrasts for the
visualization of different vessel wall intensities and thus different plaque deposits. Furthermore, low contrast between
the vessel’s outer boundary and surrounding tissue is necessary, since a reliable, precise segmentation of the whole

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

196

S. Glaßer et al. / Automatic TF Specification for Visual Emphasis of Coronary Plaque

Table 1: Supporting point calculation for TF 3D and TF 2D .S6 is the
supporting point for hard plaque separation and thus identical to
the threshold t, see Equation (1).

TF 3D
S0
S1
S2
S3
S4
S5
S6
S7
S8

−1024HU
S3 − σwall
S3 − 14 σwall
μwall
S3 + 14 σwall
μblood − 2σblood
μblood + 3σblood
S6 + σblood
3071HU

TF 2D
S0
S1
S2
S3
S4
S5
S6
S7
S8

−1024HU
S3 − 2σwall
S3 − σwall
μwall
1
2 (S3 + S5 )
μblood − 2σblood
μblood + 3σblood
S6 + σblood
3071HU

Figure 6: Graphs of the TF 3D (left) and TF 2D (right). Specification is carried out by calculation of μwall , σwall , μblood
and σblood and thus the supporting points S0 –S8 . Between
the points, optical properties are linearly interpolated. The
x-axis is not labeled, since the HU values differ from dataset
to dataset.
coronary artery vessel wall is absent due to its small extent.
A high contrast discontinuity in the TF would imply too much
accuracy on the exact location of the wall.
We define two TFs depending on the dimensionality of the
viewer: the TF 2D and the TF 3D . To avoid occlusions in the
3D case, we employ the interval size μwall ± σwall for the
TF 3D and μwall ± 2σwall for the TF 2D . We present one (of
potentially several) solutions to our requirements by defining
nine sample points S0 − S8 (see Table 1 and Figure 6).
The assignment of opacity values was compared to MIP
views and the MIDA approach, recently presented by Bruckner et al. [BG09]. There was no clear improvement of the
visualization of hidden structures with MIP or MIDA views,
since the higher transparency of the vessel wall reveals occluded hard plaques in the TF 3D -based views. Furthermore,
the low overall maximum opacity value, the small spatial
extent of hard plaques and the local opacity changes from
blood intensities to hard plaques and from surrounding tissue to the vessel wall, avoid the problem of an occlusion of
a local maximum opacity change as discussed in [BG09].
While in DVR visualization the TF 3D is solely applied, in
the 2D CPR and MPR views the TF 2D can be combined with
a standard gray scale visualization. As no occlusion occurs

Figure 7: Combination of the windowing TF and the TF 2D
by blending. On the left, the MPR view with a hard plaque
(white area) is visualized by employing windowing. In the
middle, the TF 2D was applied and on the right, the combination of TF 2D and windowing TF is presented.
in the 2D views, the TF 2D is overlaid by a conventional slice
view to highlight the vessel wall and to provide contextual
information of the unmasked data. The lookup table of the
windowing TF is therefore blended, that is linearly interpolated, with the lookup table of the TF 2D , and the opacity
value determines the influence of the TF 2D (see Figure 7).
The user can manipulate the windowing TF’s parameters and
thus directly influence brightness and contrast of the combined TF 2D .
The automatically adapted global TFs allow for a qualitative evaluation of the CTA datasets. To improve exploration,
the user can slightly change the automatically generated TFs.
Therefore, an offset for the visual separation of hard plaques,
that is S6 , and for average vessel wall intensity, that is S3 ,
can be manipulated, with the supporting points S2 , S4 and S7
being updated accordingly. Manipulation may be necessary
to cope with artefacts in smaller branches of selected datasets
and allows for quality judgment. The user manipulation and
thus the influence of the incrementally manipulated TFs is
discussed in Section 5.
4.4. Rendering of the 3D DVR view
The display of the volume data, employing the TF 3D ,
was realized via GPU-raycasting. For the implementation,
general setups and acceleration strategies, as described in
[SHN∗ 06] and [EKE01], were applied. Since the relevant
volume resolution in the clinical routine is typically below
512 × 512 × 512, the data easily fits in today’s consumer
graphics cards even with 16-bit float precision.
The renderer was implemented with the Luxinia 3D engine (www.luxinia.de), which is scriptable via Lua and uses
OpenGL and Cg as rendering backend. Seven seconds are
needed from application start to the first visible rendered
frame and the achieved frame rate is ≈ 50 Hz. High quality
shots with eight time finer ray steps are rendered when no
interactions are performed and take less than 0.1 seconds. To
raise the image quality with wider ray steps during interactive camera/object manipulation, we employ pre-integrated
volume rendering from [EKE01]. The application was run at
1024 × 768 on a GeForce 9600 GT 512 MB.

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

S. Glaßer et al. / Automatic TF Specification for Visual Emphasis of Coronary Plaque

197

Figure 8: Linked views provided by the prototype application. On the left, the DVR view can be examined by rotating and
zooming. The user can pick an arbitrary location, which is masked with a cyan sphere, and the corresponding CPR and oblique
MPR views are generated (right). At the bottom right MPR views orthogonal to the local vessel centerline, starting from the white
vertical in the CPR view are shown. The prototype enables the user to switch between the conventional gray scale visualization
and the TF 3D and TF 2D based visualizations.
5. Evaluation
We applied our techniques to 12 CTA datasets from a 64-slice
MSCT scanner (Siemens Sensation 64). The methods and visualizations were discussed with three board-certified radiologists within the scope of an informal evaluation. All datasets
were acquired from living persons. Since no tissue was removed, no histopathological reports were available. Therefore, we focused on the expert’s knowledge and the diagnostic evaluation of conventional gray scale views for informal
evaluation and discussion of the presented visualizations.
For each dataset, the TFs were extracted and a prototype was
developed with the MeVisLab platform (www.mevislab.de).
5.1. Visualization environment
The prototype allows for the investigation of the datasets, and
contains a DVR view with combined 2D views, consisting of
a CPR and an MPR view, see Figure 8. The CPR and MPR
view as well as the 3D visualization of the coronary artery
tree are linked with each other. On the one hand, the user can
traverse the CPR view with the corresponding MPR view
being updated. On the other hand, the user can choose an
arbitrary vessel segment in the 3D view with the 2D views
being generated accordingly.
The evaluation of our prototype included an examination
of the DVR views of the coronary artery tree. For comparison, conventional gray scale windowing views were provided. The DVR view allows for overview visualizations of
hard plaques and stents, including even smaller hard plaques,
see Figure 9. Furthermore, locations of possible stenoses or

pathologic changes of the vessel wall become visible, see
Figure 10. Although these changes should be evaluated in
more detail in the 2D views, the user can determine interesting coronary artery segments in the 3D view and thus
generate CPR and MPR views for the specific locations.
The 2D CPR and MPR views can be evaluated at the same
time. Similar to the DVR view, the overview visualization
in CPR views of hard plaques and stents were discussed, for
example see Figure 11. Again, the TF-based visualizations
reveal also smaller hard plaques in comparison to conventional gray scale views. Although stenoses are indicated by
the CPR view (see Figure 11), possible findings should be
double-checked due to projection-based distortions of the
CPR. As shown in Figure 12, the color coding of the vessel
wall provides additional information of different accumulations in MPR views. Hence, also hard plaques and stents are
highlighted. The presentation of the TF-based visualizations
was accompanied with discussions and questions.
5.2. Manipulation of automatically generated TFs
The initial TF 2D - and TF 3D -based visualizations can be interactively changed to allow for a better exploration of the
image data. The user can incrementally modify two offsets.
The first offset O1 defines the relative position of the hard
plaque separation, that is S6 and thus the threshold t, provided
in Equation 1. The second one, O2 , determines the average
vessel wall intensity and thus S3 .
The visualizations of major branches are not impaired,
even for strong changes of O1 , for example 60 HU, see

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

198

S. Glaßer et al. / Automatic TF Specification for Visual Emphasis of Coronary Plaque

Figure 9: DVR example views of three different datasets. On the left, the DVR view indicates a very low patient’s overall
plaque burden, since no hard plaques can be seen. The dataset in the middle exhibits three stents (arrowheads), whereas the
visualization on the right shows many hard plaques and thus indicates a high overall plaque burden. Even smaller hard plaques
are recognizable, see inlet.

Figure 11: CPR views of the left anterior descending artery
of two datasets. The first one (above) exhibits a high hard
plaque burden, whereas the second one (below) does not
show hard plaque occurrences.

Figure 10: Stenoses of coronary artery vessels in DVR
views. On the left, two coronary stents are depicted. The
left bottom picture reveals a stenosis (arrow) at the end of
the stent, whereas the left upper picture indicates no stenoses.
On the right, pathologic changes of the vessel wall lead to
positive and negative remodeling (arrowheads). The DVR
views provide starting points for further evaluation in 2D
views.

Figure 13. For smaller, peripheral branches, contrast agent
accumulations or partial volume effect harden the hard plaque
separation. In Figure 14, better visualization results can be
achieved with an increasing O1 . With incremental modification of O1 and extra knowledge about possible positions of
hard plaque deposits, that is in the vessel wall and not the
lumen, the clinical expert can cope with artefacts in smaller
branches.
The modification of O2 in Figure 15 does not lead to a
change in diagnostic evaluation. Larger values for O2 yield

Figure 12: MPR views provide the cross-sectional views of
the coronary arteries. The type of the non-calcified plaque
(arrowheads) may be inferred from the color coding: MPR
view without plaques (a), greenish colors indicate denser
structures (b) and pinkish colors indicate lipid accumulations
contained in soft plaques (c). In (c), two small hard plaques
are highlighted, whereas in (d) a coronary stent is presented.
less highlighting of surrounding tissue, smaller values highlight more of the vessel’s environment. However, the vessel’s
CPR and MPR views with modified TF can still indicate
plaque accumulations, see Figure 15.
For diagnostic assessment of plaques, the initial TFs are
very robust against changes. For smaller, peripheral branches,

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

S. Glaßer et al. / Automatic TF Specification for Visual Emphasis of Coronary Plaque

199

of even small hard plaques in 2D and 3D views, plaque
deposits could be analyzed in more detail. Some smaller
hard plaques, i.e. with a size of 3 voxels, were not detected
with conventional windowing but with a TF 2D based view.

Figure 13: Influence of O1 for a major branch (μblood =
492H U , σblood = 30H U ). In (b) the initial TF reveals some
bigger hard plaques (arrows). They are still highlighted, if
O1 is strongly modified, as presented in (a), (c) and (d).

Figure 14: Influence of O1 for smaller branches similar
to Figure 13. From top to bottom, O1 is assigned with values −30HU, 0HU, 30HU and 60HU. The initial TF (2nd
from top) indicate overestimation since it highlights accumulations in the vessel’s lumen. Smaller values for O1 worse
(top), larger values improve (bottom) the result. A small hard
plaque is highlighted all the time (arrow).

The color coding of the vessel wall allows for a qualitative
differentiation of vessel wall accumulations. Some cognitive effort was necessary to understand and remember the
employed color scale, whereas the assignment of white and
beige colors to dense structures like hard plaques and stents
was rated to be very intuitive. The opacity mapping of the
TF 3D provides insight into inner structures. While the 3D
view could direct the user’s attention to luminal changes,
all radiologists pointed out that the evaluation of stenoses
requires CPR and MPR views. In the 2D views, the highlighting of the vessel wall was rated high, since indications
of possible positive or negative remodeling are provided.
For further improvement, the radiologists claim the combination of our visualization techniques with additional segmentation results to include quantitative parameters, i.e. the
vessel lumen or the percent aged vessel lumen’s change, since
our methods only allow for a qualitative evaluation. A minor
drawback concerning the surrounding tissue of hard plaques
exists. The surrounding tissue is not highlighted, suggesting
the hard plaque is not contained in the vessel wall but in the
lumen. Hard plaques are very dense calcium deposits that are
surrounded by lipid, fibrous or necrotic accumulations with
different intensity values. The HU values of the whole plaque
decomposition range from values smaller than the contrastenhanced blood to values larger than the contrast-enhanced
blood. Inherent to 1D TFs, the intermediate intensity values
will not be highlighted.
In conclusion, the radiologists prefer the TF-based visualizations in comparison to gray scale views and rate
them as useful extension for the evaluation of CTA datasets.
The attention is directed to pathologic changes of the vessel
wall and thus, the presented techniques allow for a fast qualitative evaluation and detection of the suspicious changes.

Figure 15: Influence of O2 . A pathologic vessel wall change
(∗ ) as well as a small hard plaque (arrow) is indicated in all
visualizations.

However, for clinical decision-making, our approach must
be combined with semi-quantitative analyses, where the presented visualizations are combined with quantitative parameters, e.g. the diameter of the vessel’s lumen, or a quantitative
evaluation of laborious animal studies.

artefacts could be reduced with modifications of the automatically generated TFs.

6. Conclusions & Future Work

5.3. Feedback of clinical experts
In comparison to the conventional gray scale views with a
windowing TF, the clinical experts claim a faster overview of
the complex topology, the overall hard plaques and coronary
stents, by applying the DVR techniques with the TF 3D for the
segmented coronary artery tree. With the visual separation

We presented a method for the visual emphasis and qualitative evaluation of coronary artery plaque. We developed
automatically adjusted TFs based on the segmented coronary arteries in CTA image data. The proposed method is
also suitable for low quality segmentations, for example with
data artefacts or poor contrasts. The plaque deposits consist of different accumulations with different densities. Although an automatic segmentation of all plaque types is not

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

200

S. Glaßer et al. / Automatic TF Specification for Visual Emphasis of Coronary Plaque

possible, we present a method for highlighting hard plaques
and soft and fibrous plaques by color coding of the vessel
wall. Moreover, early stages of the CAD consisting of nonstenotic plaque deposits can be visualized.

[CM08] CORREA C. D., MA K.-L.: Size-based Transfer Functions: A New Volume Exploration Technique. IEEE Transactions on Visualization and Computer Graphics 14, 6
(2008), 1380–1387.

The adapted TFs were combined with common visualization techniques of CTA datasets. An informal evaluation
with three radiologists rates our methods as beneficial extensions for conventional CTA evaluation. Due to the locally
non-uniform spatial diffusion of the contrast medium the
presented approach could be the basis for a more sophisticated uncertainty visualization, as presented by [LLPY07].
In addition, size-based TFs as employed in [CM08] could be
applied and compared to the presented approach.

[EKE01] ENGEL K., KRAUS M., ERTL T.: High-quality preintegrated volume rendering using hardware-accelerated
pixel shading. In Proceedings of the ACM SIGGRAPH/EUROGRAPHICS Workshop on Graphics Hardware (New York, NY, USA, 2001), ACM, pp. 9–16.

Problems arose due to the non-uniform spatial variation of
the contrast medium that resulted in different contrast agent
accumulations. Because we experienced a loss of quality
for vessel wall intensity approximation for smaller branches
with too few voxels for a reliable local histogram analysis via
IPV extraction, we employed a global TF. A higher spatial
resolution of the image data would be required to enable a
successful local TF adaption.
Further improvements might also be possible with more
advanced segmentation methods. As an example, the approach developed by Friman et al. [FHP 08] is promising
since it provides subvoxel accuracy for centerline extraction
of segmented vessels. Considering the highlighting of coronary stents, the segmentation of stents during preprocessing
could improve the CTA visualization.

Acknowledgements
We thank Dr. S. Achenbach (University of ErlangenN¨urnberg) for providing the image data and Fraunhofer
MEVIS for advanced MeVisLab features.
References
[AJH∗ 90] AGATSTON A. S., JANOWITZ W. R., HILDNER F.,
ZUSMER N. R., VIAMONTE M. J., DETRANO R.: Quantification of coronary artery calcium using ultrafast computed
tomography. Journal of American College of Cardiology
15, 4 (1990), 827–832.
[Ame07] AMERICAN HEART ASSOCIATION: Heart Disease and
Stroke Statistics—2007 Upd. Circulation 115, (2007),
e69–171.
[BA02] BULLITT E., AYLWARD S. R.: Volume rendering of
segmented image objects. IEEE Transactions on Medical
Imaging 21, 8 (2002), 998–1002.
[BG09] BRUCKNER S., GRO¨ LLER M.: Instant Volume Visualization using Maximum Intensity Difference Accumulation. Computer Graphics Forum 28, 3 (2009), 775–882.

[FDHL03] FERCHER A. F., DREXLER W., HITZENBERGER C. K.,
LASSER T.: Optical Coherence Tomography—Principles
and Applications. Reports on Progess in Physics 66,
(2003), 239–303.
[FHP08] FRIMAN O., HINDENNACH M., PEITGEN H.-O.:
Template-based multiple hypotheses tracking of small
vessels. In Proceedings of IEEE 5th International Symposium on Biomedical Imaging (ISBl’08) (Paris, France,
2008), IEEE Computer Society, pp. 1047–1050.
[HBF∗ 05] HENNEMUTH A., BOSKAMP T., FRITZ D., K¨UHNEL C.,
BOCK S., RINCK D., et al.: One-click coronary tree segmentation in CT angiographic images. CARS’05: Computer
Assisted Radiology and Surgery 1281, (2005), 317–321.
[HBS∗ 02] HONG C., BECKER C. R., SCHOEPF U. J., et al.: Coronary Artery Calcium: Absolute Quantification in Nonenhanced and Contrastenhanced Multi-Detector Row CT
Studies. Radiology 223, (2002), 474–480.
[HZZ∗ 07] HERZOG C., ZANGOS S., ZWERNER P., COSTELLO P.,
VOGL T. J., SCHOEPF J. U.: CT of Coronary Artery Disease.
Journal of Thoracic Imaging 22, 1 (2007), 40–48.
[IRvG07] ISGUM A., RUTTEN A., vAN GINNEKEN B.: Detection of coronary calcifications from computed tomography scans for automatic risk assessment of coronary artery
disease. Medical Physics 34, 4 (2007), 1450–1461.
[JQD∗ 08] JOSHI A., QIAN X., DIONE D. P., BULSARA K. R.,
BREUER C. K., SINUSAS A. J., PAPADEMETRIS X.: Effective
visualization of complex vascular structures using a nonparametric vessel detection method. IEEE Transactions
on Visualization and Computer Graphics 14, 6 (2008),
1603–1610.
[KFW∗ 02] KANITSAR A., FLEISCHMANN D., WEGENKITTL R.,
FELKEL P., GRO¨ LLER M. E.: Cpr: curved planar reformation.
In VIS ’02: Proceedings of the Conference on Visualization ’02 (Washington, DC, USA, 2002), IEEE Computer
Society, pp. 37–44.
[KHB∗ 06] KUEHNEL C., HENNEMUTH A., BOCK S., OELTZE
S., BOSKAMP T., KRASS S., et al.: New Software Assistants for Cardiovascular Diagnosis. In In GI-Workshop
“Softwareassistenten—Computerunterst¨utzung f¨ur die

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

S. Glaßer et al. / Automatic TF Specification for Visual Emphasis of Coronary Plaque

201

medizinische Diagnose und Therapieplanung” within the
GI annual conference (2006), Gesellschaft f¨ur Informatik,
Bonn, Germany, pp. 491–498.

In Proceedings of VIS ’04: Proceedings of the Conference
on Visualization ’04 (Washington, DC, USA, 2004), IEEE
Computer Society, pp. 385–392.

[KKH02] KNISS J., KINDLMANN G., HANSEN C.: Multidimensional Transfer Functions for Interactive Volume
Rendering. IEEE Transactions on Visualization and Computer Graphics 8, 3 (2002), 270–285.

[SHN∗ 06] SCHARSACH H., HADWIGER M., NEUBAUER A.,
WOLFSBERGER S., B¨UHLER K.: Perspective Isosurface
and direct volume rendering for virtual endoscopy
applications. In EUROVIS—Eurographics/IEEE VGTC
Symposium on Visualization (Lisbon, Portugal, 2006), Eurographics Association, pp. 315–322.

[LLPY07] LUNDSTRO¨ M C., LJUNG P., PERSSON A., YNNERMAN
A.: Uncertainty visualization in medical volume rendering using probabilistic animation. IEEE Transactions
on Visualization and Computer Graphics 13, 6 (2007),
1648–1655.
[LLY05] LUNDSTRO¨ M C., LJUNG P., YNNERMAN A.: Extending
and simplifying transfer function design in medical volume rendering using local histograms. In EUROVIS 2005:
Eurographics/lEEE VGTC Symposium on Visualization
(Leeds, United Kingdom, 2005), Eurographics Association, pp. 263–270.

[SPSP02] SELLE D., PREIM B., SCHENK A., PEITGEN H.O.: Analysis of vasculature for liver surgical planning.
IEEE Transactions on Medical Imaging 21, 11 (2002),
1344–1357.
[TPD06] TAPPENBECK A., PREIM B., DICKEN V.: Distancebased transfer function design: specification methods and
applications. In Simulation und Visualisierung (2006),
SCS, Erlangen, Germany, pp. 259–274.

[NRJ93] NAPEL S., RUBIN G. D., JEFFREY R. B. J.: STSMIP: a new reconstruction technique for CT of the chest.
Journal of Computer Assisted Tomography 17, 5 (1993),
832–838.

[vOvGR∗ 03] vAN OOIJEN P. M. A., vAN GEUNS R. J. M.,
RENSING B. J. W. M., BONGAERTS A. H. H., et al.: Noninvasive coronary imaging using electron beam CT: surface rendering versus volume rendering. AJR 180 (2003),
223–226.

[PAM∗ 07] POHLE K., ACHENBACH S., MACNEILL B., ROPERS
D., FERENCIK M., et al.: Characterization of non-calcified
coronary atherosclerotic plaque by multi-detector row
CT: Comparison to IVUS. Atherosclerosis 190 (2007),
174–180.

[VST∗ 03] VEGA F., SAUBER N., TOMANDL B., NIMSKY C.,
GREINER G., HASTREITER P.: Enhanced 3D-Visualization
of intracranial aneurysms involving the skull base. In Proceedings of MICCAI (New York, NY, USA, 2003), vol.
2879, LNCS, Springer-Verlag, pp. 256–263.

[PO07] PREIM B., OELTZE S.: Visualization in medicine
and life sciences. 3D Visualization of Vasculature: An
Overview (New York, NY, USA, 2007), Springer-Verlag,
pp. 19–39.
[RSK06] REZK-SALAMA C., KOLB A.: Opacity Peeling for Direct Volume Rendering. IEEE/Eurographics Symposium
on Visualization 25, 3 (2006), 597–606.
[SCC∗ 04] STRAKA M., CERVENANSKY M., CRUZ A. L., KOCHL
A., SRAMEK M., GRO¨ LLER E., FLEISCHMANN D.: The VesselGlyph: Focus & context visualization in CT-angiography.

[VST∗ 04] VEGA HIGUERA F., SAUBER N., TOMANDL B., NIMSKY
C., et al.: Automatic adjustment of bidimensional transfer
functions for direct volume visualization of intracranial
aneurysms. In Proceedings of SPIE Conference on Medical Image Computing (2004), vol. 5367, SPIE The International Society for Optical Engineering, Bellingham,
USA, pp. 275–284.
[WFKF06] WESARG S., FAWAD KHAN M., FIRLE E.: Localizing calcifications in cardiac CT data sets using a new
vessel segmentation approach. Journal of Digit Imaging
19, 3 (2006), 249–257.

c 2010 The Authors
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.


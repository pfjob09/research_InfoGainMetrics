Volume 27 (2008), Number 2

EUROGRAPHICS 2008 / G. Drettakis and R. Scopigno
(Guest Editors)

An Adaptive Contact Model for the Robust Simulation of
Knots
Jonas Spillmann

Matthias Teschner

Computer Graphics, University of Freiburg, Germany

Abstract
In this paper, we present an adaptive model for dynamically deforming hyper-elastic rods. In contrast to existing
approaches, adaptively introduced control points are not governed by geometric subdivision rules. Instead, their
states are determined by employing a non-linear energy-minimization approach. Since valid control points are
computed instantaneously, post-stabilization schemes are avoided and the stability of the dynamic simulation is
improved.
Due to inherently complex contact configurations, the simulation of knot tying using rods is a challenging task.
In order to address this problem, we combine our adaptive model with a robust and accurate collision handling
method for elastic rods. By employing our scheme, complex knot configurations can be simulated in a physically
plausible way.
Categories and Subject Descriptors (according to ACM CCS): I.3.7 [Computer Graphics]: Three-Dimensional
Graphics and Realism: Animation
Keywords: Deformation Modeling, Elastic Rods, Adaptive Resolution, Contact Handling, Knot Simulation

1. Introduction
Physically-based simulation of one-dimensional elastic objects (rods) is a challenging problem in the area of computer
animation. Although elastic rods are related to deformable
solids and thin shells, rods in contact are particularly difficult to simulate due to their negligible volume and potentially complex contact geometries.
Real-world elastic rods are characterized by continuous mass distributions and displacement fields. In contrast,
spatially discretized models have a restricted number of
degrees-of-freedom (DOF). In order to achieve optimal simulation results with a limited computation power, the DOFs
should adapt to varying configurations. If e. g. rods are employed in knot-tying simulations, different parts of a rod undergo time-varying small and large deformations. Moreover,
segments can be collision free, or they can be involved in
settings with a large number of contacts.
Spatially adaptive discretizations can be realized in various ways. In case of a geometric adaptation, the DOFs are
arranged according to the geometric configuration of a rod.
DOFs are introduced in regions with high curvature and re-

c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

moved in regions with low curvature. This technique is employed in cloth simulation to avoid artifacts if cloth is draped
over sharp edges [BMF05]. As an alternative to geometric
adaptation, mechanical adaptation is governed by contacts
or other interactions [LGCM05, GLM06].
Main results: We propose an adaptive simulation of elastic rods in contact. Our approach works with any discrete
hyper-elastic deformation model, i. e. a deformation model
that defines a (necessarily convex) strain energy function
W from which a stress-strain relationship can be derived.
Our approach unifies contact handling with a dynamic multiresolution technique. However, we do not pre-compute different resolutions. Instead, DOFs are arranged based on geometric and mechanical adaptation criteria. Further, in contrast to previous work, we do not employ a virtual node technique [SSIF07], but refine the DOFs and adapt the governing differential equations. The approach faces the following
challenges:
• Elastic rods are characterized by stiff differential equations and large deformations that have to be handled.
Thus, it is generally not optimal to place a new control
point at the barycenter of a segment as proposed in pre-

498

Spillmann et al. / An Adaptive Contact Model for the Robust Simulation of Knots

Figure 1: In knot-tying simulations, large parts of the elastic rod are undeformed while a high mechanical accuracy is required
to simulate the knot, which calls for adaptive methods. Left: A network linked by Prusik knots carries a bar element. The delicate
equilibrium requires a robust collision handling method. Right: The double Fisherman’s knot is used to tie together two ropes
of unequal radii.

vious works (e. g. [TWS06]). In contrast, we propose to
determine the position of a new point as the root of a nonlinear system of equations in order to obtain a stable configuration. This novel technique could also be employed
for adaptive cloth and body simulation.
• Due to the negligible volume of elastic rods, the discretetime setting, and potentially complex contact configurations, penalty approaches and other local schemes are less
appropriate to handle contacts. Thus, inspired by previous work on rigid and cloth collision handling [MS01,
MHHR07], we propose an iterative scheme to solve a nonlinear system of non-penetration constraints.
• The dynamic refinement of the resolution causes discontinuous changes in the contact configuration. These discontinuities have to be considered by the contact handling
method to guarantee a robust processing of contacts.
The proposed approach provides a stable and efficient simulation of virtual rods in contact. In combination with the
CORDE deformation model [ST07], we show that complex
tangled rods and knots can be simulated in a physically plausible way.

2. Related work
Contact handling. Little work exists that focuses on collision handling of elastic rods. Previous work includes the
knot planning scheme of Saha et al. [SI06] and the dynamic
knot-tying simulation of Brown et al. [BLM04] that shifts
rope segments in a non-physical manner. Collisions occur
frequently in hair simulation. Amongst others, Choe et al.
[CCK05] and Bertails et al. [BKCN03, BAC∗ 06] compute
penalty forces based on interpenetrations. However, the volume of elastic rods is in general negligible compared to their
longitudinal extent. Thus, a collision immediately results in
an inconsistent state that comes along with the interpenetrations. In contrast to cloth collisions [BWK03, VMT06],
such inconsistent states cannot be easily detected and resolved. Instead, collisions have to be avoided. Further, complex knots are characterized by a large number of simultaneous collisions that should be handled by a global response
scheme. Such global schemes are widely used in rigid body
collision response and result in a system of equations.
Usually, the problem of finding feasible impulsive or non-

impulsive contact forces is formulated as a Linear Complementary Problem (LCP). Baraff published a variety of
articles on how to compute contact forces that incorporate
friction [Bar89, Bar91, Bar94]. LCP formulations have also
been employed to resolve collisions of deformable volumetric objects [DDKA06] and quasi-rigid point clouds [PPG04].
However, solving an LCP is expensive, and the resulting
solution is not necessarily more "correct" than other approaches, as pointed out by Kaufman et al. [KEP05]. They
proposed to compute impulses by solving two separable
Quadratic Programs (QP) per body. Non-penetration constraints can also be handled with Lagrange multipliers, as
e. g. proposed by Galoppo et al. [GOM∗ 06, GOT∗ 07] in
the context of deformable skin collision response. Other
efficient alternatives have been proposed by Redon et
al. [RKC02] and Bender et al. [BS06], where the latter proposes an iterative way to propagate impulses. The propagation of impulses can be accelerated by employing a contact
graph, as shown by Guendelman et al. [GBF03].
Elastic rods have some resemblance with articulated rigid
bodies [WTF06, GLM06], thin shells and cloth. In cloth
collision response, most approaches assume rigid impact
zones [Pro97] and solve for feasible velocities, either direct [HMB01] or in an iterative fashion [BFA02]. Similar to
these approaches, we also compute impact zones, but drop
the rigidity assumption since this would produce unrealistic
behavior of knots.
Our approach shares similarities with a class of schemes
that first compute feasible positions and then apply forces
such that these positions are met after integration. Volino
et al. [VMT00] employed a geometric scheme for computing positions, velocities and accelerations. Later, Milenkovic
and Schmidl proposed a physically-based method for computing optimal configurations of rigid bodies [MS01] by
solving a QP. And recently, Müller et al. presented a
position-based simulation where non-penetration constraints
are solved iteratively [MHHR07]. Our approach combines
the accurate method of [MS01] with an efficient iterative
scheme in the spirit of [GBF03] and [MHHR07] to compute
feasible positions. Further, we ensure temporal coherence of
the contact forces and consider that the mechanical adaptivity implies discontinuous changes in the contact state. In
combination with the adaptive model, this results in an el-

c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

Spillmann et al. / An Adaptive Contact Model for the Robust Simulation of Knots

egant and robust contact simulation of knotted threads and
ropes.
Adaptive methods. To improve the efficiency and accuracy of deformable object simulation, adaptive methods reduce the DOFs in regions where mechanical or numerical
accuracy is not mandatory. The refinement or reduction is
governed by an error criterion which measures the adequacy
of a given resolution. For three-dimensional meshes, this
implies that either meshes at different resolutions are precomputed, or that the domain is remeshed. Since the latter
is known to be a hard task, most works take the first approach. Debunne et al. [DDCB01] propose an adaptive simulation framework by employing finite element methods. At
the interface, they interpolate the physical properties linearly
between the nodes at different resolutions. By employing finite element methods, it is easier to guarantee that physical
properties do not vary along different resolutions, which is
in contrast to previous methods on adaptive mass-spring networks [HPH96]. Multi-resolution hexagonal grids allow for
an efficient representation with octrees [BPWG07], and precomputed tetrahedral meshes can be avoided [CGC∗ 02]. Recently, approaches that work with ’virtual particles’ in order
to adapt the resolution of a mesh gained increasing attention [EEHS00, SSIF07]. These approaches have proven to
work well in practice although a plausible binding between
virtual and real points can be difficult to realize.
For two-dimensional meshes that model e. g. thin
shells, there exists a well-established theory of subdivision [ZS∗ 99], which enables dynamic mesh refinement.
An implementation of the multigrid scheme for thin shells
is proposed by Green et al. [GTS02]. High-resolution
meshes are particularly important for simulating folds and
wrinkles in cloth. While geometric subdivision approaches
such as [BFA02] aim at increasing the visual quality,
Thomaszewski et al. [TWS06] propose a physically-based
simulation of cloth where the elements are refined by employing Loop’s scheme. Jain et al. [JKG∗ 05] employ a multiresolution algorithm to speed-up collision detection. A different way is proposed by Grinspun et al. [GKS02]. Instead of refining the elements, they enlarge the approximation space by refining the basis functions. As a consequence,
they avoid the compatibility problems at the interfaces between resolutions.
One-dimensional objects have an inherently simple topological structure that can be exploited by adaptive schemes.
Pai proposed a physically-based deformation model for elastic rods that is based on the Cosserat theory [Pai02]. The rod
is evolved by solving a boundary value problem. The step
size can be chosen based on an adaptation criterion. Further, this model has the advantage that the control points
are computed directly, analogous to a linear time dynamics
algorithm for articulated rigid bodies. An adaptive method
for snake-like articulated rigid bodies has been proposed by
Gayle et al. [GLM06]. They rigidify joints in regions without
collisions. And Bertails et al. [BKCN03] employed adaptivity in the context of hair clustering. They focus on control
structures that approximate the large-scale coherent motion.
In our work, we focus on the adaptive simulation of disc 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

499

crete one-dimensional elastic objects. We start with a predefined mesh whose control points constitute the DOFs of
the undeformed model. The mesh is then refined to meet the
required accuracy. Lenoir et al. proposed an adaptive simulation of mechanical B-splines [LGCM05], where new control
points are inserted based on geometric spline subdivision.
However, for general elastic rod deformation models, it is
not possible to compute the position of new control points
analytically. By introducing the new control points at the
barycenter of old control points, the potential energy is not
minimized. In turn, the simulation becomes inevitably instable. To fight this problem, Phillips et al. [PLK02] proposed
to add damping springs to the system after control point introduction. In contrast, we propose an adaptive simulation
scheme that guarantees temporal coherence of the rod without employing any stabilization method. We show that the
position of a refined node corresponds to the roots of a nonlinear system of equations.

3. Adaptive simulation overview
In this section, we briefly introduce the simulation loop for
the constrained dynamic evolution of elastic rods. The subsequent sections explain the steps in detail. We employ the following simulation framework that has been previously proposed by e. g. [WTF06, DDKA06].
Simulation loop(g0 : initial configuration)
repeat
deform: elastic forces of rod gt
predict: integration results in unconstrained rod g˜ t+h
collision detection: detect interferences of g˜ t+h
collision response: compute contact forces
correct: integration results in collision-free rod gt+h
adapt: (un)refine rod based on adaptation criteria
until stop;
The key idea is to predict the unconstrained state of the rod
at time t + h by integrating the equations of motion, thereby
neglecting contact forces. Then we detect interferences and
compute contact forces that, if applied to the rod at time t, result in a interference-free state at t + h. Thus, difficulties related to post-stabilization techniques are avoided [WTF06].
In Sec. 4, we briefly describe the deformation model. The
adaptive (un)refinement of the rod is discussed in Sec. 5.
Collision detection and contact force computation are explained in Sec. 6, and the paper is concluded by presenting
results in Sec. 7.

4. Deformation model
In this work, we assume that the deformation model for the
rod is hyper-elastic. That means, there exists a scalar-valued
strain energy density function W (g − gˆ ), where g(σ,t) :
Ω × R → RN is the configuration of the rod at time t defined
on a domain Ω ⊂ R, and gˆ is the stress free resting configuration of the rod. The static equilibrium configuration is then

500

Spillmann et al. / An Adaptive Contact Model for the Robust Simulation of Knots

(1)

related to cascaded refinements. Two elements are merged
if there has not been a contact for a user-defined time span
tmerge .

where F are generalized external forces. The dynamic equilibrium is obtained by considering the mass matrix and
dissipation potentials. We require W to be convex, with a
minimum at W (0). Examples for such deformation models include the deformation models introduced by Phillips
et al. [PLK02], Spillmann et al. [ST07], or Theetten et
al. [TGAB07].

We further define a geometric adaptation criterion that
considers the local curvature of the rod, i. e. we refine the rod
if the local curvature exceeds a user-defined threshold value.
Similar to [DDCB01, LGCM05], we use a smaller threshold
value to unrefine an element. In the experiments, we use a
threshold value of 0.6 to refine and a threshold value of 0.2
to unrefine elements.

characterized as a critical point of the functional
Ω

W (g(σ) − gˆ (σ))dσ −

g(σ)Fdσ
Ω

To numerically simulate the rod, a finite element method
usually solves the weak form of the governing differential
equation. The domain Ω is discretized into a disjoint union
of M − 1 elements. The nodes or control points gi ∈ RN then
comprise the DOFs of the elastic rod. For the CORDE deformation model, we e. g. have control points gi = (rTi , qTi )T ,
with spatial control points ri ∈ R3 and quaternions qi ∈ R4 .
We collect the control points gi in a control point vector
g = (gT1 · · · gTM )T ∈ RMN , replacing the previously defined
continuous configuration function g(σ). The resulting equations of motion are then
M¨g + d(˙g, g) + k(g) − F = 0

(2)

with mass-matrix M, dissipation function d and stiffness
function k.
5. Adaptive model
The simulation of knots requires a large number of DOFs
in a small spatial region in order to meet the necessary mechanical accuracy. Still, large parts of the elastic rod stay undeformed and can be represented by employing only a few
DOFs. That is why adaptivity is attractive in the simulation
of elastic rods.
In this section, we present a solution for the adaptive simulation of rods. We work in the element point of view, i. e. we
split or merge elements instead of basis functions [GKS02].
We first describe the adaptation criteria that govern the
(un)refinement of the elements before focusing on the problem of node insertion and removal.
5.1. Adaptation criteria
Most existing adaptive schemes define adaptation criteria (sometimes also denoted as quality criteria or error
criteria) solely on geometric properties, i. e. how well
the basis functions approximate the current deformation
state [DDCB01, CGC∗ 02]. In multigrid approaches, one
usually compares the solutions at different hierarchy levels [GTS02,OGRG07]. However, as Lenoir et al. [LGCM05]
recognized, a pure geometric criterion is not sufficient for
elastic rods. Instead, colliding elements have to be refined in
order to meet the required DOFs. While Lenoir et al. only
consider user interactions with the rod, we follow Gayle
et al. [GLM06] who incorporate the contact configuration.
More precisely, we bisect an element i if there is at least one
contact on the left and on the right subelement. With this
adaptation criterion, we can avoid the instabilities that are

5.2. Element refinement
If the adaptation criteria for an element i are met, the element
is bisected into two subelements i1 and i2 , and a new control point g+i is introduced. Likewise, the element domain Ωi
is partitioned into disjoint subelement domains Ωi1 and Ωi2
with Ωi = Ωi1 ∪ Ωi2 in order to preserve the resting length of
the rod. Previous approaches propose to place the introduced
control point g+i at the barycenter of the old control points
−
g−
i−1 and gi . However, since the curvature in the new control
+
point gi will be 0, the curvature energies are not distributed
uniformly over the elements, which in turn causes instabilities in the underlying differential equations. While previous
approaches recommend to add artificial damping springs to
stabilize the simulation over time [PLK02], we propose a
procedure that computes valid, i. e. energy-minimizing control points instantaneously.
Since a new control point cannot be inserted without either the stretch or the curvature varying discontinuously, the
left or the right control point has to be displaced accordingly.
For efficiency purposes, we always choose the neighboring
control point whose adjacent line segments are involved in
less collisions. The goal is to find new control point positions
g+i and g+i+1 such that the strain energy over the new elements
is minimized (see Fig. 2). More precisely, the new positions
g+i and g+i+1 constitute the solution of the non-linear constrained minimization problem
i+1

∑

j=i−1 Ω j

i+1

W (g − gˆ )dσ − ∑ gTj F j → min

(3)

j=i

subject to the holonomic boundary conditions
g+i−1 − g−
i−1 = 0
+

gi+2 − gi+1 = 0
−

(4)
(5)

where the F j are external forces such as gravity or contact
forces acting on the control points. The incorporation of contact forces is important since displacing control points eventually result in interferences (see Sec. 6.6 for details). Intuitively, we seek the control points g+i and g+i+1 that minimize
the strain energy while preserving all other control points in
+
the mesh (notice that g−
i+1 becomes gi+2 after refinement, as
indicated in Fig. 2). Since the lengths of the new elements
sum to the length of the old element, and since all other control points are fixed during refinement, both the current and
the resting length of the rod are preserved.
The solution of this system of equations is computed by
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

501

Spillmann et al. / An Adaptive Contact Model for the Robust Simulation of Knots
gi−
i−1

i
−
gi+1

−
gi−1

+
gi+1

gi+
i−1
+
gi−1

gi+
i
i+1

+
gi+2

i−1

i

+
gi+1

i+1

+
gi+2

+
gi−1

Figure 2: By placing the new control point g+i at the
−
barycenter of g−
i−1 and gi , the curvature changes discontinuously. In contrast, we compute energy-minimizing control
points g+i and g+i+1 .

a non-linear conjugate gradient (CG) method. The necessary analytic differentiation and integration of W is done
with a symbolic computer algebra software. Notice that the
gradient of W conforms to the restitution force vector. If
analytic integration is not possible, the expressions can be
obtained by a quadrature method. The step length for the
line search in the CG algorithm is determined by employing the Wolfe conditions [NW99], with the initial guess depending on the employed deformation model (see Appendix). The conjugate direction parameter is computed with the
Fletcher-Reeves formula. By only updating the coordinates
of the control points g+i and g+i+1 during minimization, we
enforce the boundary conditions. Since we restrict W to be
convex, the computed constrained minimum is guaranteed
to be global. The necessary number of iterations depends on
the deformation model. For moderately damped elastic rods
simulated with CORDE, usually 5 to 10 iterations suffice to
stabilize the simulation.
To preserve the dynamics of the rod, the mass-matrix M
in (2) has to be updated. For approaches that assume masslumping, this conforms to recomputing the point-masses,
which can be done efficiently. Further, the velocities of the
new control points are linearly interpolated from the old control points.
5.3. Element unrefinement
To unrefine the rod, two neighboring elements are merged
into one. Again, it is not possible to just remove a control
point g−
i . Instead, either the left or the right control point
has to be displaced to the energy-minimizing position. The
solution of this non-linear minimization problem is similar
to the refinement-case.
5.4. Remarks
The scheme in its present form always bisects elements in
the middle. It is, however, easy to extend the scheme to
general bisection rules. Moreover, since remeshing is trivial for one-dimensional structures, the scheme allows for
both structured and unstructured refinement. Depending on
the deformation model, it is necessary to enforce upper and
lower bounds on the domains Ωi , i. e. Ωi ∈ [Ωmin , Ωmax ]. A
mathematical analysis on these bounds is, however, beyond
the scope of this paper.
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

The rods are skinned with a spline-interpolated tubical
mesh. To avoid visible popping artifacts of the skin during
refinement, we smoothly blend the old skin with the new
skin. Thus, visual interferences might occur, especially in
coarsely sampled regions with high curvature. We underline
that this does not harm the mechanical accuracy since all
physical operations are performed on the simulated mesh g.
Still, skinning is part of ongoing work.

6. Contact handling
In this section, we propose a novel approach for robust
global contact handling of elastic rods. Together with the
adaptive model, the approach allows for the accurate simulation of knots. After an unconstrained temporal evolution
of the rods, we detect collisions in the (possibly) interfering
state. We employ hierarchies of axis-aligned bounding boxes
to detect collisions and self-collisions [TKH∗ 05]. Similar to
Müller [MHHR07], we impose non-penetration constraints
on the primitives. We then seek for the minimum displacements that satisfy the constraints. By applying constraint
forces, the rods meet the non-penetration constraints after
evolution. Notice that since collisions are detected at discrete times, collisions can be missed in case of large relative
velocities. However, this occurred very rarely in our experiments.

6.1. Constraint-based contact forces
In the following discussion, we assume that we can always
extract spatial coordinates ri ∈ R3 from the generalized coordinates gi . The pair Si = (ri , ri+1 ) constitutes a segment of
the rod. Let
md(i, j) = md(ri , ri+1 , r j , r j+1 ) > 0
be the minimum Euclidean distance between two rod segments Si and S j . Then the collision detection procedure provides a set of collisions (Si , S j ), i. e. segments Si and S j for
which md(i, j) < d. Here, d = ri + r j is the enforced minimum distance between the rod segments, with ri and r j the
radii of the rods. The penetration depth εi j > 0 of a collision
(Si , S j ) is then d − md(i, j).
We define the contact space of a collision (Si , S j ) to be
spanned by the minimum distance vector ni j between Si and
S j . We are looking for displacements ∆ri such that the coordinates ri + ∆ri define an interference-free configuration.
The displacement ∆ri is a linear combination
∆ri =

∑

n i j χi j

(6)

j∈C(i)

with C(i) the set of all pairs of interfering segments that ri is
adjacent to, and unknown scalars χi j . The non-interference
conditions for the set of collisions are written as
md(ri + ∆ri , ri+1 + ∆ri+1 , r j + ∆r j , r j+1 + ∆r j+1 ) ≥ d
md(rk + ∆rk , rk+1 + ∆rk+1 , rl + ∆rl , rl+1 + ∆rl+1 ) ≥ d
..
.
(7)

502

Spillmann et al. / An Adaptive Contact Model for the Robust Simulation of Knots

As a second condition, the momentum must be conserved,
i. e.

∑ ∆ri mi = 0

(8)

i

According to Gauss’ principle of least work (see
e. g. [RKC02]), we are looking for the minimum displacements that result in an interference-free configuration,
i. e. we require

∑

∆ri

2

→ min

(9)

i

Together, these equations define a non-linear optimization
problem. This formulation is similar to the optimizationbased algorithm in [MS01] with the difference that we explicitly enforce the conservation of momentum.

6.2. Iterative solution
Computing the exact solution of the system of equations
(7-9) is hardly feasible at interactive rates. Instead, we propose an iterative solution in the spirit of [GBF03, MHHR07]
to obtain interference-free positions. We first group interacting collisions to impact zones (according to the definition of Provot [Pro97]). In contrast to [HMB01, BFA02],
we do not treat these impact zones as rigid. We then solve
for feasible positions for each collision individually: Let
m j w j +m j+1 (1−w j )
ξ = m w +m (1−w
be the barycentrically
i i
i+1
i )+m j w j +m j+1 (1−w j )
weighted ratio of masses that accounts for conservation
of momentum of the collision (Si , S j ), with wi being the
barycentric coordinates of the contacts on the line segments.
Notice that ξ = 12 if all four points have same masses. Then
the collision displacements
∆ri
∆ri+1
∆r j
∆r j+1

=
=
=
=

ni j ξ(md(i, j) − d)wi
ni j ξ(md(i, j) − d)(1 − wi )
ni j (1 − ξ)(d − md(i, j))w j
ni j (1 − ξ)(d − md(i, j))(1 − w j )

(10)

effect that the penetration depth εi j for this collision is at
least halved, if the collision is considered in isolation. We account for spatial continuity by weighting the displacements
with the barycentric coordinates of the collision. By processing all collisions per impact zone in a sequential manner, and
summing the displacements per point ri , we obtain displacements that conserve the momentum (8). This process constitutes one step of the iterative scheme.
By repeating this process, displacements quickly propagate through the impact zone and secondary collisions are
resolved (impact zones are merged if segments from different impact zones become colliding). The iterative search is
stopped if εi j < εmax for all collisions (Si , S j ) in the impact
zone, where εmax is the error tolerance. Experiments indicate that the number of iterations depends linearly on the
number of contacts, as expected. The number of iterations
could be reduced by employing a contact graph, as proposed
in [GBF03]. However, building a contact graph for knots is
not straight-forward.

6.3. Friction
The incorporation of frictional forces complicates the problem. Still, friction is crucial for simulating knots. Analytical
solutions approximate the friction by a friction cone [Bar91,
DDKA06]. We propose a position-based approximative solution for frictional effects that is consistent with our iterative method. For each collision (Si , S j ), we compute a
Coulomb friction force component Ffric orthogonal to the
contact space. We then approximate the friction displacefric
fric
h2
ment ∆rfric
i for the point ri as ∆ri = F wi mi , where we
assumed that the mass mi is lumped in the points ri . Further, h is the time step. In each iteration and for each collision, we add the friction displacements to the collision displacements. We account for the exponential decrease of the
collision displacements in the course of the iterative computation by weighting the friction displacements ∆rfric
i with a
factor 2−iter , where iter denotes the current iteration. While
this approximative friction produces plausible results at minor computational overhead, more elaborated models could
eventually improve the accuracy and support perfect sticking.

6.4. Contact forces
Having computed the displacements ∆ri that yield feasible positions ri + ∆ri , we compute a contact force that
accelerates the mass points towards the feasible position.
More precisely, we look for contact forces Fi that, if timeintegrated numerically at time t, result in the feasible positions rt+h
= rti + ∆ri . Algebraic transformations lead to
i
1
Fi = h2 ∆ri mi . Similar formulations have been successfully
applied for geometric constraint maintenance [GBT06],
hair dynamics [CCK05] and deformable body collision response [SBT07]. Since this formulation considers the simulation time step, instabilities due to large contact forces are
largely inhibited [SBT07].
The computed displacements and corresponding contact
forces result in entirely inelastic collisions. This corresponds
nicely to the fact that the textile material of ropes and threads
is best modeled with inelastic collisions.

6.5. Contact handling in the element refinement
When the rod is refined, then control points g+i and g+i+1 are
displaced in order to minimize the elastic energy over the
new elements (see Sec. 5). The iterative displacement of the
control points in the CG method eventually results in secondary interferences, which in turn causes instabilities. We
avoid these interferences by detecting collisions of the bisected elements in each CG iteration (which can be done efficiently since the potentially colliding elements are already
known in advance). By considering the resulting contact
force in the static equilibrium functional (3), interferencefree control points are guaranteed.
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

Spillmann et al. / An Adaptive Contact Model for the Robust Simulation of Knots

503

7. Evaluation and applications
We have staged a series of experiments in order to evaluate
our adaptive rod simulation. We exemplify our method by
employing the CORDE deformation model [ST07]. We first
show that our adaptive scheme preserves the dynamic behavior of the rod. We then investigate into the characteristics of
the proposed collision response, and further present interactive applications. All experiments have been performed on
an Intel Xeon PC, 3.8Ghz.
Adaptive model. One of the main benefits of the proposed adaptive model is that it determines the exact control point positions instantaneously. It does not assume timecoherence, i. e. by damping the control points over time as
in previous approaches. Fig. 3 illustrates a collision of two
angular accelerated rods with a rigid bar. While one rod has
a fixed resolution, the other rod is refined to respond more
accurately to the collision. As the images illustrate, the dynamic behavior of the refined rod does not significantly differ from the dynamics of the unrefined rod. In average, 10-20
CG iterations are necessary to obtain stable control point positions. The average time to insert or remove a control point
is 1.5ms, which includes the time to update the data structures.
Elastic rods can be used to model threads or ropes in knot
simulations. Here, large parts of the thread are undeformed
while a high mechanical accuracy is required to represent the
knot, therefore making an adaptive model particularly attractive. Fig. 4 illustrates a simulation of the shoelace knot. As
the figure indicates, the sampling density in the knot and at
the contact points with the poles is higher than in the undeformed parts. Black bullets indicate original control points
while white bullets indicate dynamically inserted control
points. In this challenging simulation, the user can interact
with the thread. When the user unties the shoelace knot, the
thread slips down, illustrating the effect of Coulomb friction.
To investigate the gain in efficiency when employing an
adaptive model, we have simulated two ropes tied together
with the double Fisherman’s knot (see Fig. 5). We compare
the behavior of an adaptive rope versus a uniformly sampled high-resolution rope whose sampling density conforms
to the maximum resolution of the adaptive rod, and versus
a uniformly sampled low-resolution rope whose sampling
density conforms to the minimum resolution of the adaptive
rope. For the adaptive rope, the allowed minimum element
1 0
length is Ωmin
i = 4 Ωi for all elements i. As a consequence,
the maximum number of nodes for the adaptive rope (conforming to the number of nodes for the high-resolution rope)
is four times the number of nodes of the low-resolution rope.
As Tab. 1 indicates, simulating an adaptive rope is almost
twice as efficient as the high-resolution rope. The number
of collisions for both cases do not vary significantly, indicating that the adaptive rope does not result in a loss of accuracy. On the other hand, simulating the knot with a lowresolution rope results in physical and visual artifacts exhibited in Fig. 5. These artifacts are induced by the insufficient
control point sampling.
For these moderately damped ropes, 10 iterations are suf-

c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

Figure 5: Simulation of two ropes tied together with the double Fisherman’s knot. Top: A high-resolution rope with 252
nodes. Middle: An adaptive rope with 116 nodes and the
same maximum resolution as the high-resolution rope. Bottom: A low-resolution rope with 63 nodes.

ficient to stabilize the simulation. If fewer iterations are performed, then the simulation becomes instable. The average
time to (un-)refine the adaptive rope is 1.35ms. Still, since
the adaptation criteria are only met in about 5% of all simulation steps, only 0.41% of the total simulation time is spent
for node insertions and deletions.
Employing an adaptive model always pays off in interactive knot-tying simulation when the location of the knot is
not known in advance. Currently, the limiting factor for the
refinement is the enforced minimum element length Ωmin ,
which depends on the deformation model and on the simulation parameters. A worst-case scenario for an adaptive
rope is illustrated in Fig. 7, where most elements of the
rope are involved in collisions. Thus the number of nodes
of the adaptive rope conforms to the number of nodes of the
high-resolution rope. Still, the simulation step timings for
the adaptive and the high-resolution rope are about the same,
illustrating that the overhead of the adaptivity is negligible.
Contact handling. Our physically motivated collision resolving scheme iteratively computes feasible collision-free
positions of interfering rod elements. In each iteration, all
contacts are processed to determine the locally feasible positions. Since displacing one rod element produces secondary
collisions, the number of iterations depends linearly on the
number of colliding elements. As a consequence, the complexity of the scheme is in O(n2 ) with n the number of con-

504

Spillmann et al. / An Adaptive Contact Model for the Robust Simulation of Knots

Figure 3: Two rods with equal material properties are colliding with a rigid obstacle. One rod is dynamically refined while the
other rod has a fixed resolution. The four images illustrate that the dynamic behavior is not affected by the refinement.

Figure 4: Interactive simulation of adaptive knot-tying. A thread is tied around four poles, and a shoelace knot prevents it from
slipping down. As the user unties the knot, the pressure is reduced and the thread slips to the ground. This simulation illustrates
the effect of Coulomb friction.

Adaptive

Low res.

Nodes (Fig. 5)
Avg. collisions
Simulation step [ms]

252
70
13.3

(avg.) 116
69
7.3

63
22
2.6

Nodes (Fig. 7)
Avg. collisions
Simulation step [ms]

2K
10K
710

(avg.) 1.9K
9.7K
694

0.5K
2.6K
77

300
contact force comp. [ms]

High res.

250
200
150
100
50
0
0

Table 1: Statistics on the adaptive refinements. The upper
three rows show the measurements of the simulation of the
double Fisherman’s knot (Fig. 5). As the measurements indicate, simulating the knot with adaptive ropes is almost twice
as efficient and requires less than half the number of nodes
than uniformly sampled ropes at the same maximum resolution. Still, the number of collisions does not vary significantly, illustrating that the knot is simulated with similar accuracy. In contrast, the low-resolution ropes cannot reproduce the knot configuration accurately enough. The lower
three rows show the measurements of a worst-case scenario
for adaptive ropes (Fig. 7), illustrating that the overhead for
the adaptivity is negligible.

tacts. Still, since computing locally feasible positions is a
cheap operation, the running times are comparable to stateof-the-art response schemes. Fig. 6 relates the time to compute feasible positions to the number of contacts and underlines the theoretical result.
To show that we can resolve complex self-contact configurations, we ran a simulation of a falling coiled rope with 2K
control points, as depicted in Fig. 7. The simulation time step

1000

2000

3000

4000

5000

6000

7000

8000

9000

10000

# collisions

Figure 6: The complexity of our global response scheme
is in O(n2 ). However, usually fewer than n iterations are
necessary to resolve n collisions with sufficient accuracy.
In the experiment, we have considered an error tolerance
εmax = 10−3 r, with r the radius of the rod.

is 10−4 s. Collision detection of 10K collisions takes 355ms
and computing feasible positions takes 255ms. The average
initial penetration depth is ε = 1.8 · 10−3 r, with r the radius
of the rod. 34 iterations are necessary to reduce the penetration depth to ε < εmax = 10−3 r. Force computation and
integration takes 100ms, the simulation runs at 1.5 frames
per second.
8. Conclusion and future work
We have presented an adaptive model for hyper-elastic rods.
Since the refinement of the rod should be governed by the
contact configuration, our approach unifies adaptivity with
robust collision handling. We have recognized that the stiff
underlying differential equations do not allow to place new
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

Spillmann et al. / An Adaptive Contact Model for the Robust Simulation of Knots

505

[Bar91] BARAFF D.: Coping with friction for non-penetrating
rigid body simulation. In Proc. Computer Graphics and Interactive Techniques (1991), pp. 31–41.
[Bar94] BARAFF D.: Fast contact force computation for nonpenetrating rigid bodies. In Proc. Computer Graphics and Interactive
Techniques (1994), pp. 23–34.

Figure 7: Simulation of a coiled rope. The rope consists of
2K control points, with 10K collisions in average. This experiment illustrates global collision response in the context
of massive self-collisions. Since most elements are involved
in collisions, this simulation represents the worst-case scenario for adaptivity.

control points based solely on geometric rules, as in previous approaches for cloth [TWS06] and deformable bodies [DDCB01]. In contrast, the control points result from an
energy-minimization problem that is solved by employing a
non-linear conjugate gradient method. In return, valid control points positions are found instantaneously, and no artificial damping is necessary to stabilize the system after refinement. As a consequence, the dynamic behavior of the elastic rod is not affected by the refinement, and the stability of
the simulation is improved. The robust position-based contact handling method computes physically-plausible contact
forces. Challenging knot simulations illustrate the benefits
of the proposed method.
We detect and handle collisions and self-collisions at discrete time steps, which limits the allowed maximum relative
velocity between rods. If the relative velocity exceeds this
limit, then collisions can be missed. Currently, we are investigating into continuous collision handling methods. Moreover, since the collision handling is staged on a piecewise
linear contact hull, rods tend to rattle if they slide on each
other. Handling the collisions on a Cosserat contact hull
would require to know the analytical curve. Still, the linear
hull could be smoothed by employing e. g. spline curves.
Another issue that we have not convincingly solved is
the skinning of the rods. Instead of employing splineinterpolated tubes, a more accurate skinning technique
would be favorable. Moreover, a volume-preserving skin deformation [AS07] would further improve the realism.
References
[AS07] A NGELIDIS A., S INGH K.:
Kinodynamic skinning using volume-preserving deformations. In Proc. ACM
SIGGRAPH/Eurographics Symposium on Computer Animation
(2007), pp. 129–140.
[BAC∗ 06] B ERTAILS F., AUDOLY B., C ANI M.-P., Q UERLEUX
B., L EROY F., L ÉVÊQUE J.: Super-helices for predicting the
dynamics of natural hair. ACM Transactions on Graphics 25, 3
(2006), 1180–1187.
[Bar89] BARAFF D.: Analytical methods for dynamic simulation
of nonpenetrating rigid bodies. In Computer Graphics (Proc.
SIGGRAPH) (1989), vol. 23, pp. 223–232.
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

[BFA02] B RIDSON R., F EDKIW R., A NDERSON J.: Robust treatment of collisions, contact and friction for cloth animation. ACM
Transactions on Graphics (2002), 594–603.
[BKCN03] B ERTAILS F., K IM T.-Y., C ANI M.-P., N EUMANN
U.: Adaptive Wisp Tree: a multiresolution control structure for
simulating dynamic clustering in hair motion. In Proc. ACM
SIGGRAPH/Eurographics Symposium on Computer Animation
(2003), pp. 207–213.
[BLM04] B ROWN J., L ATOMBE J.-C., M ONTGOMERY K.:
Real-time knot tying simulation. The Visual Computer 20, 2–3
(2004), 165–179.
[BMF05] B RIDSON R., M ARINO S., F EDKIW R.: Simulation of
clothing with folds and wrinkles. In Proc. International Conference on Computer Graphics and Interactive Techniques (2005),
pp. 28–36.
[BPWG07] B OTSCH M., PAULY M., W ICKE M., G ROSS M.:
Adaptive space deformations based on rigid cells. Computer
Graphics Forum 26, 3 (2007), 339–347.
[BS06] B ENDER J., S CHMITT A.: Constraint-based collision and
contact handling using impulses. In Proc. Computer Animation
and Social Agents (2006), pp. 3–11.
[BWK03] BARAFF D., W ITKIN A., K ASS M.: Untangling cloth.
ACM Transactions on Graphics 22, 3 (2003), 862–870.
[CCK05] C HOE B., C HOI M., KO H.:
Simulating complex hair with robust collision handling.
In Proc. ACM
SIGGRAPH/Eurographics Symposium on Computer Animation
(2005), pp. 153–160.
[CGC∗ 02] C APELL S., G REEN S., C URLESS B., D UCHAMP T.,
P OPOVI C´ Z.: A multiresolution framework for dynamic deformations. In Proc. ACM SIGGRAPH/Eurographics Symposium on
Computer Animation (2002), pp. 41–47.
[DDCB01] D EBUNNE G., D ESBRUN M., C ANI M.-P., BARR
A. H.: Dynamic real-time deformations using space and time
adaptive sampling. In Proc. SIGGRAPH (2001), pp. 31–36.
[DDKA06] D URIEZ C., D UBOIS F., K HEDDAR A., A NDRIOT
C.: Realistic haptic rendering of interacting deformable objects
in virtual environments. IEEE Transactions on Visualization and
Computer Graphics 12, 1 (2006), 36–47.
[EEHS00] E TZMUSS O., E BERHARDT B., H AUTH M.,
S TRASSER W.: Collision adaptive particle systems. In Proc.
Pacific Graphics (2000), pp. 338–347.
[GBF03] G UENDELMAN E., B RIDSON R., F EDKIW R.: Nonconvex rigid bodies with stacking. ACM Transaction on Graphics
22, 3 (2003), 871–878.
[GBT06] G ISSLER M., B ECKER M., T ESCHNER M.: Local constraint methods for deformable objects. In Third Workshop in
Virtual Reality, Interactions and Physical Simulations (2006),
pp. 25–32.
[GKS02] G RINSPUN E., K RYSL P., S CHRÖDER P.: CHARMS:
a simple framework for adaptive simulation. ACM Transactions
on Graphics 21, 3 (2002), 281–290.
[GLM06] G AYLE R., L IN M., M ANOCHA D.: Adaptive dynamics with efficient contact handling for articulated robots. In Proc.
of Robotics: Science and Systems (2006).

506

Spillmann et al. / An Adaptive Contact Model for the Robust Simulation of Knots

[GOM∗ 06] G ALOPPO N., OTADUY M. A., M ECKLENBURG P.,
G ROSS M., L IN M. C.: Fast simulation of deformable models
in contact using dynamic deformation textures. In Proc. Eurographics/ACM SIGGRAPH Symposium on Computer Animation
(2006), pp. 73–82.
[GOT∗ 07] G ALOPPO N., OTADUY M. A., T EKIN S., G ROSS
M., L IN M. C.: Soft articulated characters with fast contact handling. Computer Graphics Forum 26, 3 (2007), 243–253.
[GTS02] G REEN S., T URKIYYAH G., S TORTI D.: Subdivisionbased multilevel methods for large scale engineering simulation
of thin shells. In Proc. ACM Symposium on Solid Modeling and
Applications (2002), pp. 265–272.
[HMB01] H UH S., M ETAXAS D., BADLER N.: Collision resolutions in cloth simulation. In Proc. Computer Animation (2001),
pp. 122–127.
[HPH96] H UTCHINSON D., P RESTON M., H EWITT T.: Adaptive
refinement for mass/spring simulations. In Proc. 7th Eurographics Workshop on Animation and Simulation (1996), pp. 31–45.
[JKG∗ 05] JAIN N., K ABUL I., G OVINDARAJU N., M ANOCHA
D., L IN M.: Multi-resolution collision handling for cloth-like
simulations. Computer Animation and Virtual Worlds (2005),
141–151.
[KEP05] K AUFMAN D. M., E DMUNDS T., PAI D. K.: Fast frictional dynamics for rigid bodies. ACM Transactions on Graphics
24, 3 (2005), 946–956.
[LGCM05] L ENOIR J., G RISONI L., C HAILLOU C., M ESEURE
P.: Adaptive resolution of 1D mechanical B-spline. In Proc.
Computer Graphics and Interactive Techniques in Australasia
and South East Asia (2005), pp. 395–403.
[MHHR07] M ÜLLER M., H EIDELBERGER B., H ENNIX M.,
R ATCLIFF J.: Position based dynamics. Journal of Visual Communication and Image Representation 18, 2 (2007), 109–118.
[MS01] M ILENKOVIC V., S CHMIDL H.: Optimization-based animation. In Proc. Computer graphics and Interactive Techniques
(2001), pp. 37–46.
[NW99] N OCEDAL J., W RIGHT S.: Numerical Optimization.
Springer Series in Operation Research, 1999.
[OGRG07] OTADUY M., G ERMANN D., R EDON S., G ROSS M.:
Adaptive deformations with fast tight bounds. In Proc. ACM
SIGGRAPH/Eurographics Symposium on Computer Animation
(2007), pp. 181–190.
[Pai02] PAI D.: STRANDS: Interactive Simulation of Thin Solids
using Cosserat Models. Computer Graphics Forum 21, 3 (2002),
347–352.
[PLK02] P HILLIPS J., L ADD A., K AVRAKI L. E.: Simulated
knot tying. In Proc. IEEE International Conference on Robotics
& Automation (2002), pp. 841–846.
[PPG04] PAULY M., PAI D. K., G UIBAS L. J.: Quasi-rigid objects in contact. In Proc. Eurographics/ACM SIGGRAPH Symposium on Computer Animation (2004), pp. 109–119.
[Pro97] P ROVOT X.: Collision and self-collision handling in
cloth model dedicated to design garments. Graphics Interface
97 (1997), 177–189.
[RKC02] R EDON S., K HEDDAR A., C OQUILLART S.:
Gauss’least constraints principle and rigid body simulations.
IEEE International Conference on Robotics and Automation 1
(2002), 517–522.

[SI06] S AHA M., I STO P.: Motion planning for robotic manipulation of deformable linear objects. Proc. IEEE International
Conference on Robotics and Automation 27 (2006), 21–30.
[SSIF07] S IFAKIS E., S HINAR T., I RVING G., F EDKIW R.:
Hybrid simulation of deformable solids.
In Proc. ACM
SIGGRAPH/Eurographics Symposium on Computer Animation
(2007), pp. 81–90.
[ST07] S PILLMANN J., T ESCHNER M.: CORDE: Cosserat rod
elements for the dynamic simulation of one-dimensional elastic
objects. In Proc. ACM SIGGRAPH/Eurographics Symposium on
Computer Animation (2007), pp. 63–72.
[TGAB07] T HEETTEN A., G RISONI L., A NDRIOT C., BARSKY
B.: Geometrically exact dynamic splines. Computer-Aided Design (2007). to appear.
[TKH∗ 05] T ESCHNER M., K IMMERLE S., H EIDELBERGER B.,
Z ACHMANN G., R AGHUPATHI L., F UHRMANN A., C ANI M.P., FAURE F., M AGNENAT-T HALMANN N., S TRASSER W.,
VOLINO P.: Collision Detection for Deformable Objects. Computer Graphics Forum 24, 1 (2005), 61–81.
[TWS06] T HOMASZEWSKI B., WACKER M., S TRASSER W.:
A consistent bending model for cloth simulation with corotational subdivision finite elements.
In Proc. ACM SIGGRAPH/Eurographics Symposium on Computer Animation
(2006), pp. 107–116.
[VMT00] VOLINO P., M AGNENAT-T HALMANN N.: Accurate
collision response on polygonal meshes. In Proc. Computer Animation (2000), pp. 154–163.
[VMT06] VOLINO P., M AGNENAT-T HALMANN N.: Resolving
surface collisions through intersection contour minimization. In
ACM SIGGRAPH Papers (2006), pp. 1154–1159.
[WTF06] W EINSTEIN R., T ERAN J., F EDKIW R.: Dynamic
simulation of articulated rigid bodies with contact and collision.
IEEE Transactions on Visualization and Computer Graphics 12,
3 (2006), 365–374.
[ZS∗ 99] Z ORIN D., S CHRÖDER P., ET AL .: Subdivision for modeling and animation. SIGGRAPH 99 Course Notes 2 (1999).

Appendix A: Finding energy-minimizing control points
for CORDE rods
The CORDE deformation model [ST07] employs quaternions qi to
relate the local frame of an element i to the reference frame. The potential energy W is W = Vs +Vb + E p , with Vs the stretching energy,
Vb the bending energy, and E p the constraint energy that aligns the
local frames qi with the tangent of the centerline. The initial configuration of the rods is user-defined, and the minimum element length
Ωmin depends on both the stiffness and the simulation time step.
Since the quaternion qi corresponds to the direction of the element i, the number of unknowns in (3) is 18, notably two positions
ri and ri+1 ∈ R3 , and three quaternions qi−1 , qi and qi+1 ∈ R4 .
−
+
The boundary conditions are r+i−1 − r−
i−1 = 0, ri+2 − ri+1 = 0,
−
+
=
0
and
q
−
q
=
0.
q+j−2 − q−
j−2
j+2
j+1
The initial guesses for the step sizes in the non-linear CG al(r)
(q)
gorithm are α0 = h2 m−1
for the mass-points ri and α0 =
i
h2 trace(I)−1 for the quaternions qi , with h the simulation time step,
and I the inertia tensor. Intuitively, these guesses guarantee convergence for the applied time step.

[SBT07] S PILLMANN J., B ECKER M., T ESCHNER M.: Noniterative computation of contact forces for deformable objects.
Journal of WSCG 15, 1-3 (2007), 33–40.
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.


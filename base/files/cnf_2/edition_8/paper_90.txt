Eurographics/ IEEE-VGTC Symposium on Visualization 2008
A. Vilanova, A. Telea, G. Scheuermann, and T. Möller
(Guest Editors)

Volume 27 (2008), Number 3

Geometry-driven Visualization of Microscopic
Structures in Biology
Kishore Mosaliganti, Raghu Machiraju, Kun Huang, and Gustavo Leone
The Ohio State University

Abstract
At a microscopic resolution, biological structures are composed of cells, red blood corpuscles (RBCs), cytoplasm
and other microstructural components. There is a natural pattern in terms of distribution, arrangement and packing density of these components in biological organization. In this work, we propose to use N-point correlation
functions to guide the analysis and exploration process in microscopic datasets. These functions provide useful
feature spaces to aid segmentation and visualization tasks. We show 3D visualizations of mouse placenta tissue
layers and mouse mammary ducts as well as 2D segmentation/tracking of clonal populations. Further confidence
in our results stems from validation studies that were performed with manual ground-truth for segmentation.
Categories and Subject Descriptors (according to ACM CCS): I.3.3 [Computer Graphics]: Picture/Image Generation
I.4.7 [Feature Measurement]: I.4.6 [Segmentation]: feature detection

datasets requires us to algorithmically determine the locations, trajectories and correspondence of structures across a
stack of images [FH02].

Figure 1: Component distributions: A 2D slice of a histology stained mouse placenta is shown. Tissue layers differ in
terms of characteristic microstructural component distributions.

It is quite easy for a trained pathologist to identify ducts,
vasculature, tissue areas and tumors in a microscopic slide.
The same rigorous thought-process cannot be easily encoded
as part of a visualization algorithm that uses rendering and
transfer functions alone to provide a comprehensive understanding of the underlying biology. This is because of the
scientific understanding of biology is more in terms of microstructural organization rather than on features in color
spaces. Using a set of examples, we now try to illustrate three
important percepts of biological organization

1. Introduction
Developments in optical microscopy imaging have generated large high-resolution datasets that have spurred medical researchers to conduct investigations into mechanisms
of disease, including cancer, at the organ, cellular and subcellular levels. Consequently, there is a compelling need to
integrate functional and anatomical information at multiple
scales. The need for general-purpose reconstruction and visualization algorithms cannot be overstated. In turn, it should
be noted that robust segmentation is key to extracting and visualizing structures. Visualization of 3D shapes allow biologists to see beyond the 2D image planes they are accustomed
to [OKF∗ 01]. Visualization of high-resolution microscopy
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

(a)

(b)

(c)

Figure 2: Component arrangements: (a) A histology section
of the mouse mammary gland showing several duct crosssections. (b) Ductal tissue has a concentric arrangement of
epithelial cells. (c) Color-mapped 2-pcf feature values.
Component distributions: Tissue structure may be de-

872

K. Mosaliganti et al./ Visualization of Microscopic Structures

scribed in terms of physical cellular matrices consisting of
a periodic and coherent collections of cells. In Figure 1,
we show a stained histology slice of a mouse placenta
with manually annotated tissue layers. A typical region consists of nuclei, red-blood cells (RBCs), cytoplasm and vacuous white space (fat) components. Component distributions
refers to the spatial distribution of the components relative
to each other. The tissue regions differ in terms of component distributions. The labyrinth layer(red-red) has large
nuclei and RBCs while they are relatively fewer in the spongiotrophoblast layer (red-green). The maternal layer (beyond
green) has punctuated vacuoles and no nuclei and RBCs either. Hence, we reason that understanding spatial component
distributions is key to obtaining tissue delineation.
Component arrangements: This refers to salient geometric shapes that components may form in the image. Figure 2 shows yet another histology image of a mouse mammary gland. Ductal structures which are prevalent in lesser
numbers are identified on each slide as a projection of a complex torturous 3D object. We zoom-in on a single duct that
consists of a concentrically arranged epithelial nuclei with
close packing. Hence, we note that by understanding packing arrangements of microstructural components, it is possible to obtain segmentations of certain tissue regions (ductal
tissue in this example).
Component densities: Figure 3 shows a clonogenic assay containing mutated cell colonies at three separate timepoints. A colony is defined by a dense packing of cells that is
physically separated from other colonies. In later frames, the
colonies merge and a delineation of the colony boundaries is
not determined. Hence, we note that by determining packing densities and tracking its growth temporally, a boundary
description of colony regions is possible.
The organization of components is related to the definition
of a material microstructure. Microstructure may be measured as a collection (ensemble) of points, lines, internal
surfaces, and volumes [Gok04]. Each microstructural feature is associated with size, shape, volume, surface area,
length and curvature attributes etc., morphological orientation, and location. Statistical distributions of such geometric attributes of ensembles collectively specify the geometric
state of a microstructure. Mathematically, these properties of
microstructure are formalized by the statistical N-point correlation functions (N-pcfs) [Tor04].
Contributions: In this work, we utilize the N-pcfs in
quantifying biological organization. The functions are used
to provide suitable feature spaces for exploration and realizing sophisticated analysis algorithms. The feature spaces
capture salient regions of component distributions, arrangements and packing densities. While most texture measures
features are only concerned with the luminance of the images, N-pcf features are able to leverage the knowledge of
the components and enforce spatial geometric constraints for
better characterization. Hence, we show better performance

than when using other texture measures. In particular, we use
the feature spaces to obtain tissue layer visualizations (via
scalar transfer functions) of the mouse placenta and reconstructions in ductal morphology. The ability of the functions
in performing segmentation tasks are validated in the case of
clonal colonies.

(a)

(b)

(c)

Figure 3: Component densities: Phase-contrast microscopy
images of mutated cell colonies that are rapidly proliferating
in culture. Each colony is marked by a dense packing of cells.

2. Related Work
Traditionally, histogram information from intensity and its
derivatives [KWTM03] have been used in the design and
specification of transfer functions (TF) for volume rendering. Figure 8(a) shows the rendering of a duct that we had to
manually extract from the raw dataset. The lack of structural
descriptions is evident in comparison to our automaticallydetected duct renderings in 8(b) and 8(c). In general, capturing this structure and organization seems intractable in the
color space owing to biological variations within and across
samples.
In order to explore such structures, we need to determine
spatial locations of structures and enhance their visibility
during scientific exploration. Spatial transfer functions available in the literature focus on structures that are in close
proximity to other landmarks/surfaces [KMM02, TPD06].
However, in biological data, salient structures are marked by
˝ which we cognitively capa change in spatial distributions U
ture and naturally construct these functions for exploration.
The quantitative characterization of spatial distributions
of finite-size objects or points in multidimensional spaces
has been studied in several disciplines such as spatial statistics [Tor04, SKM85], materials science [Gok04], signal processing, biology, physics and astronomy.
Mathematically, microstructure properties are formalized
by the statistical N-pcfs [SKM85]. There are fundamental geometric constraints that are enforced while realizing N-pcfs. A formal introduction to N-pcfs with applications in material characterization studies can be found in
Torquato [Tor04]. In practice, the 2-pcf is most useful for
microstructure representation [SGA04, SZ05].
The N-pcf features are similar to the co-occurrence matrices of [HSD73] in some sense. However, significant conceptual as well implementation differences exist. For example, the computation of the N-pcfs is randomized and does
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

K. Mosaliganti et al./ Visualization of Microscopic Structures

not exploit the pixel grid structure. These functions are used
to compute other physical properties of the tissue substrate
(such as porosity etc.). The functions capture both the geometry and statistical nature of textural regions.

(a)

(b)

(c)

Figure 4: (a) RGB histograms of the placenta section are
shown to be approximately having a normal distribution. (b)
Identified component labels of the placenta image shown in
Figure 1. (c) Individual cells identified in the clonal colony
images from Figure 3a.
Ridgway et al. [RIMH06] initially introduced the N-pcfs
for histology image segmentation in conjunction with a
HOSVD classifier. Some initial promising results were observed on individual 2D images. Janoos et al. [JIM∗ 07] extended the above approach to incorporate multi-resolution
scale-space strategies to improve computational performance. In this work, we explore the use of these functions in
providing feature spaces for 3D exploration, feature detection and visualization.
It should be noted that there exist other reported segmentation methods for histological images. In [TKM∗ 02]
a comprehensive image analysis system was developed
for prostate tissue analysis. Each material component was
treated separately along with a combination of various classifiers and segmenters. In [PKC∗ 04] microstructures were
segmented by a hybrid method that combines optimal adaptive thresholding with local morphological opening and closing operations. Similarly in [LCBRK05], a robust method
based on Markov random fields (MRF) was used towards
segmenting nuclei in confocal images of cervical tissue.
In [SRM∗ 07], the authors described a pipeline to visualize histological stacks derived from the mice placenta organ.
The emphasis was not on segmenting the tissue geometry.
Meanwhile, in [FDI∗ 04], similar work was reported. They
do not provide a comprehensive solution to the challenges
that we earlier motivated.
In the next section, we explain our strategy to extract material components followed by a description of the N-pcfs.
3. Component Segmentation Algorithm
To characterize microstructure, the microstructure components need (e.g. nuclei, cytoplasm, RBCs etc) to be determined first. The components are usually the most fundac 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

873

mental and repeating units in the microstructure. The combination of components make up a salient material phase
(or tissue type). In the case of the histology slices, we use
a standard Gaussian maximum-likelihood estimator (MLE)
classifier to label each pixel as belonging to one of the 4
classes, namely, (i) nuclei, (ii) RBC, (iii) extracellular material and (iv) white background [RIMH06]. The result of this
classification is a component labeled image that is shown in
Figure 4b. Figure 4c shows the output of a cell segmentation algorithm [MCM∗ 07] with each cell being identified in
phase-contrast images.
Our emphasis in this work is on the use of the N-pcfsin
measuring the relative packing and spatial distributions of
microstructure components. Using a sliding window, the Npcf measures are evaluated at every pixel location in the image to yield a tensor quantity for further analysis.

Figure 5: The figure shows four different microstructure ensembles composed of 2-phase components, namely, phase
0 (black) and phase 1 (white). A plot of the orientationk for varying k reveals different charaveraged function P00
acteristic signatures.

4. N-Point Correlation Functions
To simplify the presentation, assume the presence of only
two phases in the microstructure, namely, phase 0 and phase
1. Let p ∈ Ω be any point in the microstructure C : Ω →
{0, 1}. Further, let Ω p ⊂ Ω be a suitable neighborhood of
p. Consider placing a N-sided regular polyhedron with edge
length k and orientation (θ ,φ ) in Ω p . The probability that all
the N-vertices lie in phase 0 is defined as an N-point correlation function (N-pcf), Pik1 i2 ...iN (p, θ , φ ), where im = 0 for
m ∈ 1, 2, ..., N. The subscript im denotes the phase of the mth
polyhedron vertex. The N-pcf for a regular polyhedron of
edge length k depends on its orientation (θ , φ ) and location p
in the microstructure. In a similar manner, other forms of the
point correlation function (with auto and cross-correlation
phases at the vertices) may be defined. The orientation averaged N-pcf Pikj , which are of interest in this work, can be
computed from the corresponding direction-dependent functions P˜ikj (θ , φ ) as follows:

874

K. Mosaliganti et al./ Visualization of Microscopic Structures

< Pik1 i2 ...iN (p) >=

1
2π

π
2

2π
0

0

P˜ik1 i2 ...iN (p, θ , φ )d θ d φ (1)

We now provide some insight into the probability measures captured by these functions. Consider the simple case
of a 1-pcf, say P0 . It represents the probability that a point
p is in phase 0. This quantity measures the volume fraction
of phase 0 in the microstructure. Similarly, P1 is the volume
fraction of phase 1 and we have P0 + P1 = 1.
A 2-pcf is the probability of a straight line segment of
length k randomly placed in the microstructure such that one
end is in phase i1 ∈ {0, 1} and the other end is in phase i2 ∈
{0, 1}. For a 2-phase microstructure, there are four possible
k , Pk , Pk and Pk and:
2-pcf s namely P00
01 10
11
k
k
k
k
+ P01
+ P10
+ P11
=1
P00
k
P00

+

k
P01

= P0 ;

k
k
P01
= P10
;
k
k
P10
+ P11
= P1 (2)

Please refer to Figure 5 wherein four different microstructures composed of black (0) and white (1) phases are considered. Note that each individual texture class in the image
provides a unique or characteristic 2-pcf feature measure for
a certain value of the separation distance k. Figure 5(right),
a plot of the P11 measure for the four textures as a function of k is plotted. We observe that the four textures present
characteristic signatures that enable their identification. For
a given image, it is not known a priori what are the values of k. Hence, in practice, a range of values need to be
explored while estimating these functions or alternatively,
the given image needs to be inspected for suitable separation distances among components. In [MJI∗ 07], the authors
have tried to set values automatically by exploring a range of
possible k values and using HOSVD compression schemes
to eliminate those values that are not discriminating among
classes. Later in Section 5, depending the application study
and its objectives, we have described the selection of k values in our study. The set of possible integral values that k
may assume is represented by the discrete set K ⊂ Z. The
N-pcf feature descriptor for a tissue region represented by
N
(k)
Pi1 i2 ..iN ∈ ℜK×Q is an N + 1 mode tensor.
Essentially, a N-pcf is a multivariate distribution function.
To estimate this function, we resort to using Monte Carlo
sampling of the material components distribution using a
sliding window (Ω p ). Conceptually, for a given separation
length k, one needs to create auto- and cross-histograms at
every point p in the discrete image plane. To estimate the
functions at p, the number of samples (S) and window sizes
(Ω p ) need to be specified. The minimum window size is proportional to the maximum separation distance that the functions will be evaluated for. For larger windows, the region
characterization is similar to a smoothing operation since
components far away from a pixel may affect it. The multiscale properties of the N-pcf were investigated in [JIM∗ 07].

The sample size is chosen to ensure confidence in the measured result.
To evaluate the 2-pcf for separation distance k and phases
i, j in a region containing m-phases, we place a number of
randomly oriented and positioned lines. We then count the
fraction of line segments that have an end point in phase i
and the other in j to give an estimate of the 2-pcf Pikj .
5. Results
In this section, we describe our results from using the 2-pcfs
for segmentation and visualization. We applied our methods
on three different experimental studies on genetic phenotyping and drug discovery applications. In each experiment, we
show how the the 2-pcfs provides a feature space to visualize and infer. Validation using manual ground-truth was performed in two studies to compare the classification ability of
the 2-pcfs by comparing its performance with Gabor [?] and
Haralick [HSD73] texture measurements.
All our experiments were compiled and executed on an
Intel P4 3.2 GHz processor equipped with 1GB RAM. The
2-pcf algorithm was developed in C++ using the The Insight Segmentation and Registration Toolkit (ITK) libraries
[IS03]. Table 1 lists the dataset sizes, 2-pcf parameters and
the time consumed in minutes per frame for each of the three
datasets.
Parameters
Size
Ωp
S
K
Time (min)

Placenta
5K × 5K
30× 30
200
[5,25]
<18

Mammary
5K × 1.5K
50× 50
350
[30]
<6

Clonal
1K × 1K
30× 30
200
[15]
<4

Table 1: Values used in the ITK implementation.

5.1. Placenta tissue layer visualization
In this project, we are interested in visualizing the labyrinthspongiotrophoblast tissue interface in a mouse placenta. A
recent study has revealed that with the knockout of the
Rb gene, the surface interdigitation wildly increases and
clumps together with poor infiltration depth [WdS∗ 03].
Our biomedical collaborators are interested in visualizing
this phenotype difference [WWd∗ 07]. Two pairs of wildtype and mutant (Rb− ) placenta were prepared using a standard histological protocol. The image dimensions on average
were (15K × 15K) in RGB format. Each placenta data-set
produced approximately 600 − 800 images, ranging in size
from 300 GB to 500 GB. The images require preprocessing, down-sampling, image registration [MPS∗ 06] and tissue
segmentation [RIMH06] prior to the visualization stage.
Figure 6(a) shows a full 3D placenta rendered in RGB
from the original image stack. The placenta when cropped
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

875

K. Mosaliganti et al./ Visualization of Microscopic Structures

5.2. k-Nearest Neighbor classification

(a)

(b)

(c)
(a)

(d)

(e)

(f)

Figure 6: (a) A normal RGB rendering of a 3D placenta
dataset. (b) The dataset is cropped along two orthogonal
planes. Note that the tissue layers and the interface are hard
to distinguish. (c) A zoomed section at full resolution with
manually marked tissue layers. Visualizations showing the
tissue layer intermixing in the labyrinth-spongiotrophoblast
interface of (d) normal and (e) mutant mice placenta. (f)
Opacity and color transfer function applied on the probabilistic volume P to highlight the interface region. Note
the presence of bimodal peaks in the histogram from the
labyrinth and spongiotrophoblast layers.

along orthogonal planes reveal tissue layers that are hard
to distinguish. Figure 6(c) shows the a high-resolution RGB
rendering of a small physical volume. The subtle change in
microstructure is visible on either side of the interface. In
particular, there is an intense presence of dark nuclei and
RBCs on the labyrinth side. The spongiotrophoblast region
is accentuated with vacuoles and an absence of RBCs. After
preliminary investigations on sample images, we concluded
that using a 2-pcf with k ∈ [5,25] for vacuoles (phase 0),
nuclei (phase 1) and RBC components (phase 2) will welldifferentiate the tissue regions. The labyrinth region generated high values of P12 . Meanwhile, the spongiotrophoblast
region was marked by a moderate value in P01 and low values in P12 . These probabilities were linearly combined to
provide a scalar volume P = P12 + |P01 − 0.5| + |P12 − 0.5|
for rendering using a simple transfer function given in Figure 6(d) and (e).
Figure 6(f) shows our transfer function setting to highlight the interface between the two regions. The same function was used for both the normal and mutant placentae. The
bimodal histogram indicates the feature value distribution
of the labyrinth and spongiotrophoblast voxels. At the valley region, we spike the opacity function and reduce it elsewhere. It is easy to notice the genetic phenotyping difference
in the two placenta samples. The mutant shows a higher degree of intermixing as compared to the normal placenta.
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

(b)

Figure 7: (a) Cropped placenta image with the boundary between labyrinth and maternal layer outlined in
black, the interface between and labyrinth and spongiotropoblast marked as white, and glycogen demarcated by
gray. (b) Image classification of a single placenta image;
Red-spongiotrophoplast. Light gray-glycogen. Light bluebackground. Dark blue -labyrinth.

To test the classification ability of the 2-pcfs, experiments
were performed on an image randomly drawn from the stack,
as shown in Figure 7b. A total of 2200 image tiles (of 20×20
dimensions) were collected for validation. Of these, 800 tiles
for the labyrinth layer, 800 tiles for the spongiotrophoblast
layer, and 600 for background. A total of 200 tiles, 50 of
each class, were then used for training, with the rest saved
for testing purposes. The image tiles were evaluated using
the 2-pcf, Haralick and Gabor filters and classified using a
k-nearest neighbor (k-NN) algorithm into four classes.
The results of the experiments on a 2D placenta image
is shown in Table 2. We observe that the 2-pcfs identified
and labeled the labyrinth layer with a high level of accuracy (95.5%). The spongiotrophoblast was also accurately
classified with an accuracy ranging from 90.7%. Glycogen
was poorly identified with an accuracy ranging from 53.7%.
The background material was identified with an accuracy of
100%. Labyrinth false positives range from 7-19%, while the
spongiotrophoblast was falsely identified (false positives)
with a frequency of 7-12%.
For this particular image, the Haralick features fared relatively well on the labyrinth layer (95%) but did worse on
the spongiotrophoblast (89%) than the correlation functions.
The Gabor features performed poorly only delivering a classification accuracy of 53% for the labyrinth and 80% for the
spongiotrophoblast. The correlation functions also had the
lowest rate of false positives of all of the features. The better performance observed while using the material science
features is a result of the component hierarchy used in the
technique. While the Gabor and Haralick features are only

876

K. Mosaliganti et al./ Visualization of Microscopic Structures

Lab
ST
Glyc
BG
FP

Lab
6876 / 3843 / 6853
413 / 802 / 731
239 / 711 / 865
0 / 32 / 4
8.6 / 28.6 / 18.9%

ST
215 / 2878 / 189
6529 / 5822 / 6432
385 / 457 / 68
0 / 147 / 15
8.4 / 37.4 / 4.0%

Glyc
106 / 376 / 155
256 / 168 / 35
726 / 152 / 417
0 / 10 / 0
33.2 / 78.4 / 31.3%

BG
0/0/0
0/0/0
0/0/0
5396 / 5211 / 5377
0 / 9.4 / 0%

Acc
95.5 / 53.3/ 95.2%
90.7 / 80.8 / 89.3%
53.7 / 11.2 / 30.8%
100 / 96.5 / 99.6%

Table 2: Comparison of segmentation results using different texture measures and the same classifier, on a single placenta
image. The classification was done using k-NN with k = 5. Acc: Accuracy. FP: False positives. Lab: Labyrinth layer. ST:
Spongiotrophoblast. Glyc: Glycogen. BG: Background.

concerned with the luminance of the images, the newer features are able to leverage the knowledge of the components
and spatial distributions for better segmentations. The classification image using the 2-pcfs and k-NN classifier can be
seen in Figure 7b.
5.3. Mammary duct visualization

(a)

(b)

(c)

Figure 8: (a) Raw RGB data showing a duct that manually
assembled from 3D slices. (b) The same duct was automatically highlighted by using a transfer function. (c) The outer
iso-surface of the ductal tissue.
Mammary tumors often arise in ductal tissues. Earlier, we
had described the morphology of a duct as a concentric arrangement of epithelial cells embedded in extracellular material. The remainder of the tissue consists of fat cells with
sparse populations of the nuclei and little or no extracellular
material. Our collaborators are interested in capturing the
origins of the tumor leading to a breach of the ductal epithelium. Hence, 3D visualizations of the ductal tissue was
deemed necessary to further their goals.
From 2D images, we inferred that a 2-pcf for the background (phase 0), nuclei (phase 1) and extracellular material (phase 2) was sufficient to outline duct profiles. These
were the only microstructural constituents found in the images given the staining protocol adopted. For other forms of
staining, additional components might be present in the images.
The average separation (k) between nuclei was found to
be 30 pixel units. Clearly, the ductal tissues have closely
30
packed nuclei and present high values of the function P11

30 simultaneously. In contrast, other regions in the voland P12
30 or P30 but never simulume may have high values of P11
12
taneously. Similarly, the lumen region is trapped between
300 and
concentric nuclei and shows high feature values of P11
300 . Therefore, we once again linearly map pcfs to different
P12
30 P30 + 0.5 × P300 P300 .
values in the interval [0,1] as P = P12
11
12 11
The ductal tissue and lumen are mapped near 0.5 and 1 respectively. Non-duct associated regions automatically evaluate to 0 in both the cases. The new scalar volume is then
rendered using transfer functions that have opacity values
spiked around 0.5 and 1 with appropriate color schemes.
Figure 2(c) shows the generated feature values on the mammary slice in 2(b).

A stacking of the 2-pcf features computed on 2D images
provided the following visualizations in 3D. Figure 6(b) is an
axial section of the duct revealing the lumen that lies trapped
in the duct. Earlier, the lumen shared similar intensity values
with the extracellular matrix and hence its explicit extraction
using color transfer functions was not possible. Figure 8(c)
shows the wall of the epithelial cell lining that is akin to a
brick chimney wall.

5.4. Clonal colony segmentation
For this task, we are interested in temporally tracking the
evolution of clonal colonies rather than individual cells.
A segmentation of the individual cells is first achieved
in each frame by using standard algorithms from literature [MCM∗ 07]. We begin with a manual colony segmentation in the first frame. Based on the colony boundaries determined in the preceding frame, cells are grouped into colonies
using a distance metric. Consequently, all the cells belonging
to the same colony are grouped to obtain the current colony
boundary.
We now describe the distance metric that we compute
[MXM∗ 07]. Let 0 represents the background and 1 represents the nuclei phase. Within a colony region, P11 has a
high value (close to 1) and 0 in non-colony regions. The feature values taper down at colony boundaries especially while
merging into neighboring ones (Figure 10a). We introduce a
Riemannian distance metric G defined in terms of the 2-pcf
probability P11 (Figure 10b) to measure the proximity of two
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

877

K. Mosaliganti et al./ Visualization of Microscopic Structures

voxels as:
T
G = ∇P11 ∇P11

(3)

Infinitesimal distances under G are measured by:
dx

2
G

= dxT Gdx = (dxT ∇P11 )2

(4)

(a)

(b)

(c)

Figure 10: (a) 2-pcf evaluated on the first frame shown
in Figure 3a. (b) Voronoi segmentation on the 2-pcf manifold based on colony boundaries of the preceding frame. (c)
Colony segmentations.

Figure 9: Using our 2-pcf P11 based distance metric, the
distance along the red curve and yellow curve will be quite
different although the curves are of the same length in the image domain. Since the red curve lies within the same clonal
colony, the distance is relatively low. The yellow curve forms
a bridge between two different colonies and has to pass
through the background phase in between.
We reason that the performance of our algorithm depends
on the 2-pcf in effectively defining a colony region. In order
to validate our algorithm, consecutive frames were reviewed
and all pertinent colonies were delineated with boundaries.
We compared the algorithm-detected colony cells and the
ground-truth colony cells. The matched pairs were separated
and counted in 4 categories: (i) a - true-positives (ii) b - falsepositives (iii) c - false-negatives (iv) d - true-negatives. Thus,
a
d
one can define the sensitivity S = a+c
, specificity Sp = b+d
b+c
and error E = a+b+c+d . Our results are presented on five
datasets in Table 3. The first 3 entries are for the three frames
of a single dataset and the last entry averages the parameters
for the remaining four datasets.
Frame
Frame 1
Frame 2
Frame 3
Average

Cell Counts
378
610
794
-

S
0.9134
0.8407
0.7807
0.8417

Sp
0.8827
0.8222
0.8022
0.8322

E
0.0215
0.123
0.1733
0.1033

Table 3: Sensitivity/specificity values for colony tracking
We observe that the framework has a good sensitivity (>
0.84), specificity (> 0.83) and with a low error rate (< 0.15)
on average. It is easy to see that the performance of the algorithm is best in the earlier frames and relatively diminishes
in later frames. This is expected since the extensive clonal
growth creates merged boundaries. In turn, this leads to the
cells lying on the Voronoi boundaries to be easily affected.
We also observed in several instances that a single colony in
the starting frame emerged as two separate colonies in later
frames. As a result of which the tracking step combined the
two colonies into one of the same affiliation.
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

6. Summary and Future Work
In this paper, we employed neighborhood density estimators
to visualize biological structures at microscopic scales. We
estimate microstructure component distributions, arrangements and packing densities locally using the N-point correlation functions. These functions are realized using suitable windowing and sampling strategies to provide feature
space representations. We set simple transfer functions in the
feature space to obtain insightful visualizations in biological
datasets. In future, we would like to explore the use of these
functions in biological texture synthesis.
References
[FDI∗ 04] F ERNANDEZ -G ONZALEZ R., D ESCHAMPS T.,
I DICA A., M ALLADI R., DE S OLORZANO C.: Automatic
segmentation of histological structures in mammary gland
tissue sections. Biomedical Optics 9, 3 (2004), 444–453.
[FH02] F IALA J., H ARRIS K.: Computer-based alignment and reconstruction of serial sections. Microscopy
and Analysis 52 (2002), 5–7.
[Gok04] G OKHALE A.: Experimental measurements and
interpretation of microstructural n-point correlation functions. Microscopy and Microanalysis 10 (2004), 736–
737.
[HSD73] H ARALICK R., S HANMUGAM K., D INSTEIN
I.: Textural features for image classification. IEEE Transactions on Systems, Man and Cybernetics (1973), 610–
621.
[IS03] I BÁÑEZ L., S CHROEDER W.: The ITK Software
Guide. Kitware, Inc., 2003.
[JIM∗ 07] JANOOS F., I RFANOGLU O., M OSALIGANTI
K., M ACHIRAJU R., H UANG K., W ENZEL P., DE B RUIN
A., L EONE G.: Multi-resolution image segmentation using the 2-point correlation functions. In IEEE International Symposium of Biomedical Imaging (2007).
[KMM02] K ANDA K., M IZUTA S., M ATSUDA T.: Volume visualization using relative distance among voxels.
In SPIE Medical Imaging 2002: Visualization, ImageGuided Procedures and Display (2002), pp. 641–648.

878

K. Mosaliganti et al./ Visualization of Microscopic Structures

[KWTM03] K INDLMANN G., W HITAKER R., TASDIZEN
T., M ÖLLER T.: Curvature-based transfer functions for
direct volume rendering: Methods and applications. In
Proceedings of IEEE Visualization (2003), pp. 513–520.
[LCBRK05] L UCK B. L., C ARLSON K. D., B OVIK
A. C., R ICHARDS -KORTUM R. R.: An image model and
segmentation algorithm for reflectance confocal images
of in vivo cervical tissue. IEEE Transactions on Image
Processing 14, 9 (2005), 1265–1276.
[MCM∗ 07] M OSALIGANTI K., C OOPER L., M ACHI RAJU R., H UANG K., L EONE G.: Reconstruction of
cellular biological structures from optical microscopy
data. IEEE Transactions on Visualization and Computer
Graphics (in review) (2007).
[MJI∗ 07] M OSALIGANTI K., JANOOS F., I RFANOGLU
O., R IDGWAY R., M ACHIRAJU R., H UANG K., S ALTZ
J., L EONE G., O STROWSKI M.: Tensor classification of
n-point correlation function features for histology tissue
segmentation. Journal of Medical Image Analysis (Accepted) (2007).
[MPS∗ 06] M OSALIGANTI K., PAN T., S HARP R., R IDG WAY R., G ULACY A., I YENGAR S., W ENZEL P., DE B RUIN A., M ACHIRAJU R., H UANG K., L EONE G.,
S ALTZ J.: Registration and 3D visualization of large microscopy images. In SPIE Conference on Medical Imaging (2006), pp. 923–934.
[MXM∗ 07] M OSALIGANTI K., X U X., M ACHIRAJU R.,
H UANG K., X IA W.: Automated quantification of colony
growth in clonogenic assays. In MICCAI Workshop on
Medical Image Analysis with Applications in Biology
(2007).
[OKF∗ 01] O HTAKE T., K IMIJIMA I., F UKUSHIMA T.,
YASUDA H., S EKIKAWA M., TAKENOSHITA S., A BE
R.: Computer-assisted complete three-dimensional reconstruction of the mammary ductal/lobular systems. Cancer
91, 12 (2001), 2263–2314.
[PKC∗ 04] P ETUSHI S., K ATSINIS C., C OWARD C., T OZ EREN A., G ARCIA F.: Automated identification of microstructures on histology slides. In ISBI (2004), pp. 424–
427.

[SRM∗ 07] S HARP R., R IDGWAY R., M OSALIGANTI K.,
W ENZEL P., PAN T., B RUIN A., M ACHIRAJU R.,
H UANG K., L EONE G., S ALTZ J.: Volume rendering phenotype differences in mouse placenta microscopy
data. Special Issue on Anatomic Rendering and Visualization, Computing in Science and Engineering 9, 1 (2007),
38–47.
[SZ05] S UNDARARAGHAVAN V., Z ABARAS N.: Classification and reconstruction of threedimensional microstructures using support vector machines. Computational Materials Science 32 (2005), 223–239.
[TKM∗ 02]

T EVEROVSKIY M., K UMAR V., M A J., KOTA., V ERBELL D., TABESH A., PANG H.-Y.,
V ENGRENYUK Y., F OGARASI 1 S., S AIDI O.: Improved
prediction of prostate cancer recurrence based on an automaed tissue image analysis system. In International
Conference of Machine Learning Applications (2002),
pp. 257–260.
SIANTI

[Tor04] T ORQUATO S.: Random Heterogenous Material.
Springer Verlag, 2004.
[TPD06] TAPPENBECK A., P REIM B., D ICKEN V.:
Distance-based transfer function design: Specification
methods and applications. In 17th Conference on Simulation and Visualization (2006), pp. 259–274.
[WdS∗ 03] W U L., DE B RUIN A., S AAVEDRA H. I.,
S TAROVIC M., T RIMBOLI A., YANG Y., O PAVSKA J.,
W ILSON P., T HOMPSON J., O STROWSKI M., ROSOL T.,
W OOLLETT L., W EINSTEIN M., C ROSS J., ROBINSON
M., L EONE G.: Extra-embryonic function of Rb is essential for embryonic development and viability. Nature 421
(2003), 942–947.
[WWd∗ 07] W ENZEL P., W U L., DE B RUIN A., C HEN
W., D URESKA G., S ITES E., PAN T., S HARMA A.,
H UANG K., R IDGWAY R., M OSALIGANTI K., S HARP
R., M ACHIRAJU R., S ALTZ J., YAMAMOTO H., C ROSS
J., ROBINSON M., L EONE G.: Rb is critical in a mammalian tissue stem cell population. Genes and Development 21, 1 (2007), 85–97.

[RIMH06] R IDGWAY R., I RFANOGLU O., M ACHIRAJU
R., H UANG K.: Image segmentation with tensor-based
classification of N-point correlation functions. In MICCAI
Workshop on Medical Image Analysis with Applications
in Biology (2006).
[SGA04] S AHELI G., G ARMESTANI H., A DAMS B.: Microstructure design of a two phase composite using twopoint correlation functions. Computer-Aided Materials
Design 11, 2-3 (2004), 103–115.
[SKM85] S TOYAN D., K ENDALL S., M ECKE J.:
Stochastic geometry and its applications. John Wiley and
Sons, New York, 1985.
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.


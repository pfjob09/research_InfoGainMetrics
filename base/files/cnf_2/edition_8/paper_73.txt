Eurographics/ IEEE-VGTC Symposium on Visualization 2008
A. Vilanova, A. Telea, G. Scheuermann, and T. Möller
(Guest Editors)

Volume 27 (2008), Number 3

Extraction Of Feature Lines On Surface Meshes
Based On Discrete Morse Theory
J. Sahner and B. Weber and S. Prohaska and H. Lamecker, Zuse Institute, Berlin

Abstract
We present an approach for extracting extremal feature lines of scalar indicators on surface meshes, based on
discrete Morse Theory. By computing initial Morse-Smale complexes of the scalar indicators of the mesh, we
obtain a candidate set of extremal feature lines of the surface. A hierarchy of Morse-Smale complexes is computed
by prioritizing feature lines according to a novel criterion and applying a cancellation procedure that allows us to
select the most significant lines. Given the scalar indicators on the vertices of the mesh, the presented feature line
extraction scheme is interpolation free and needs no derivative estimates. The technique is insensitive to noise and
depends only on one parameter: the feature significance. We use the technique to extract surface features yielding
impressive, non photorealistic images.
Categories and Subject Descriptors (according to ACM CCS): I.3.3 [Computer Graphics]: Line and Curve Generation I.4.6 [Computer Graphics]: Feature Detection I.4.7 [Computer Graphics]: Feature Measurement

1. Introduction
The extraction of salient features is a crucial task in visualization, and surface meshes are a common digital representation of objects to be visualized. In non-photorealistic
rendering, for instance, the goal is to depict a surface with
a sparse set of characteristic features only. Another important example is the registration and fusion of a number of
shapes, e.g. for atlas generation in bio-medical applications,
such that common features are identified correctly.
Most commonly, feature lines are defined as ridges and
ravines of the surface, a notion of differential geometry including third orders of surface derivatives. Several highly
evolved algorithms exist to extract feature lines based on this
definition [Ebe96,OBS04,YBS05,YBYS07,HPW05,SF04].
As the stability of third derivatives is difficult to control,
those approaches require the adaptation of a number of parameters on a per surface basis. This is especially unsatisfactory in registration applications, where a large number of
surfaces has to be processed to establish an anatomic atlas.
In this paper we will undertake an alternative approach
based on Morse Smale (MS) theory [Mil63, Ban70, EHZ03,
Pas07,For98], which is an algebraic tool for measuring topological features of a function f : M ! R on a manifold M.
A simplification strategy can be used to obtain a hierarchy
of MS complexes giving rise to a natural discrimination of
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

feature scales. We will present a modification of the original
persistence simplification strategy that is capable of extracting extremal feature lines in the sense that the value of f is
significantly larger or smaller on the feature line than in its
vicinity. This extremality property is satisfied by the 1-cells
of the initial MS complex that contain the watersheds and
watercourses [Soi99] as special cases.
Our main contributions are:
We identify suitable feature indicator functions for extracting extremal feature lines (Sect. 3.1).
We show that persistence simplification is not useful for
extracting extremal feature lines (Sect. 3.3).
We introduce a novel simplification strategy that preserves
extremal feature lines (Sect. 3.4).
MS based feature detection necessarily produces connected lines, which is not generally desired. We propose a
method to alleviate this problem by discarding unwanted
lines in a post-processing step (Sect. 3.5).
The main benefits of our method are:
By using discrete Morse Theory, the extraction method
does not require any derivative estimates.
There is only one user-defined parameter in the method
defining the level of significance of the resulting features.
The method is insensitive to noise in the input fields
(Sect. 4.1).

736

J. Sahner & B. Weber / Discrete Extraction of Feature Lines

1.1. Previous Work
Edelsbrunner et al. [EHZ03, BEHP04, Pas07] and Forman [For98, For02, Lew05] have presented extensions of
classical Morse theory to triangulated surfaces. Those approaches have been used in various areas for as different tasks as function simplification that bundles topology
and geometry [BEHP04], molecular docking applications
[CCL03, NWB∗ 06], quadrangular surface remeshing using
natural harmonics [DBG∗ 06], and vortex and strain analysis of 3D flow fields [SWTH07]. A closely linked subject is
watershed segmentation, as the watersheds of a function are
contained in the Morse-Smale complex [Soi99]. Mangan et
al use [MW99] watershed segmentation on surface meshes
for surface patchification. Those approaches strive to generate good patch layouts of the surface rather than extract
feature lines. Recent advances introduce skeletons of a distance field function that is assembled of parts of the 1-cells
of the complex [GMDP∗ 07].
Several approaches for ridge line extraction on surfaces
exist. Ohtake et al [OBS04], Yoshizawa et al [YBS05,
YBYS07], Hildebrandt et al [HPW05] and Stylianou et al
[SF04] present different approaches for controlling the involved third derivatives of the surface. While all those approaches yield impressive results, they suffer from the fact
that a number of parameters has to be adjusted.
2. Hierarchical Morse-Smale Complex
A smooth function f on a smooth manifold surface M without boundary embedded in R3 is a Morse function if its Hessian has full rank at every critical point of f where its gradient vanishes [Mil63,Ban70,PM82,EHZ03]. Gradient curves
are maximal lines of f that are everywhere tangent to the
gradient. Gradient curves start and end at critical points c
of f . The stable and unstable manifolds S(c) and U(c) are
the collections of all points that are part of a gradient curve
ending at c or originating from c, respectively. The stable
and unstable manifolds of maxima and minima can be regarded as hills and valleys, respectively. Critical points that
have both a nontrivial stable and unstable manifold are saddles. Both the collection of stable manifolds and the collection of unstable manifolds partition the surface, see Fig. 1.
For Morse functions f , the intersection of both partitions is
the Morse-Smale complex of f . This complex subdivides the
domain into quads with alternating maximum, saddle, minimum, saddle, see Fig. 1d. The one dimensional arcs in the
decomposition link maxima, minima and saddles and are
called ascending (descending) 1-cells, if they connect saddles with maxima (minima). Descending (ascending) 1-cells
separate hills (valleys) and constitute their boundary.
2.1. Cancellation
Pairwise cancellation of saddle/minimum or saddle/maximum can be performed to coarsen the initial
complex, as long as the alternating quad property is maintained. A cancellation is called valid in this case. Fig. 1e

(a) Elevation profile.

(b) Hills and their borders.

(c) Valleys and their borders.

(d) Morse Smale complex.

(e) Maximum cancellation.

(f) Terminal maximum.

Figure 1: The elevation profile of a landscape as seen from
above. Lines depict the partition of the landscape into hills,
valleys and their intersection, the MS complex. Blue, red and
green dots represent minima, maxima and saddles. Bottom
row: simplifications of the MS complex by different types of
cancellations and their influence on vanishing 1-cells.
illustrates how a saddle/maximum cancellation usually
erases the descending 1-cell of the canceled saddle. The
ascending 1-cell stays in the complex, as it still divides the
unstable manifolds of the minima adjacent to the canceled
saddle. In the special case of a terminal minimum or
maximum, both the unstable and the stable manifolds of the
saddle vanish, see Fig. 1f. By providing a sequence of valid
cancellations, the complex can be coarsened, until no valid
cancellation is left. In practice this is done by quantifying
each saddle individually by a cancellation criterion. The
cancellations are then performed in increasing order of the
cancellation criterion.
2.2. Discrete Computation of the MS Complex
Based on Banchoff’s extension of classical Morse theory to
polyhedral surfaces [Ban70], Edelsbrunner et al [EHZ03]
construct the MS complex for piecewise linear functions.
The approach is refined by Bremer et al [BEHP04, Pas07].
Forman [For98, For02] generalizes Morse Theory to the
more general category of combinatorial complexes. This
generalization is a very strong theoretical foundation for
simple and intuitive algorithms. Therefore we base our algorithms on this theory.
A function f defined on the vertices of a triangular surface can be considered a Morse function if all vertex values
are different. Lewiner et al [LLT03b, LLT03a, CCL03] show
how to construct the discrete gradient vector field (also for
non-Morse functions) as a pair of interlaced primal and dual
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

J. Sahner & B. Weber / Discrete Extraction of Feature Lines

737

maximal along convex feature lines, κ2 is minimal along
concave feature lines. Curvedness, as introduced by Koen-

(a) Discrete gradient field

(b) Smooth gradient field

Figure 2: Forman’s discrete gradient vector field of the
height function of an elevation profile is shown with red maxima, green saddles and blue minima in (a). Red lines are
gradient curves ascending to maxima, blue lines are gradient curves descending to minima. In (b) its smooth analogue
is shown, being discontinuous and constant on triangles.
weighted spanning forests of the triangular surface that partition the surface into stable and unstable manifolds.
The weighted primal graph PG is the graph of vertices
and edges of the surface mesh. Edges are assigned the
mean value of the incident vertices.
The vertices and edges of the dual graph DG are the triangles and edges of the surface mesh, respectively. Triangles
are assigned the mean value of the incident vertices.
The maxima of the dual graph serve as roots for a spanning forest representing stable manifolds. Edges are added
in decreasing order. Similarly, minima of the primal graph
serve as roots for a spanning forest representing unstable
manifolds. Edges are added in increasing order, but only if
they are not contained in the dual spanning forest. The critical elements of f are the roots of the primal (minima) and
dual (maxima) graph and the edges that are not contained
in either spanning trees (saddles). Lewiner shows that the
extracted locations of critical points correlate with the locations Banchoff describes [Ban70]. The spanning forests can
be regarded as the union of all gradient curves on the mesh.
Descending gradient curves are traced as concatenated edges
in the primal spanning tree as paths to the root, ascending
gradient curves as triangle strips in the dual spanning tree.
See Fig. 2 for the discrete gradient vector field of the height
function of an elevation profile.
The computation of the 1-cells can now be performed as
in the smooth setting. For a saddle edge e = (v1 , v2 ) that is incident to the faces f1 , f2 , the stable manifolds are computed
as decreasing paths in the primal spanning tree starting with
v1 , v2 respectively until the roots m1 , m2 (that are minima)
are reached. Analogously, unstable manifolds are traced as
triangle strips in the dual spanning tree starting from f1 , f2
respectively, until the maxima M1 , M2 are reached.
3. Discrete Feature Line Extraction Method
3.1. Scalar Feature Indicators
On a smooth surface, the two principal curvatures κ1 κ2
measure the bent of the surface along the corresponding
curvature directions. Therefore, the principal curvatures are
indicators for surface specific feature lines. Whereas κ1 is
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

derink et al [KvD92], is defined by C = 12 (κ21 + κ22 ). This
measure is large whenever any principal curvature has a
large absolute value, and hence measures convex and concave regions simultaneously. It is maximal along both convex and concave feature lines.
On a triangulated surface, κ1 and κ2 , can be defined discretely for each vertex of the surface using the method described by Hildebrandt et al [HPW06].
3.2. Morse-Smale Complex and Feature Lines
Ascending 1-cells are maximal lines of scalar feature indicators, as they are lines of steepest ascent separating two
valleys if the 1-cell is a watershed, or one valley, if the 1cell is connected to a terminal maximum, see Fig. 1f, and
analogously for descending 1-cells. Depending on the scalar
feature indicator, just the ascending (κ1 , C), or descending
(κ2 ) 1-cells are of interest. Not all of these 1-cells are necessarily features. This is due to the fact that noise adds additional saddles of small difference in function value, an effect
known as oversegmentation in the field of watershed transformation [Soi99]. We aim at differentiating the 1-cells that
are salient features from noise by applying a cancellation criterion that favors the concentration of scalar indicator value
on 1-cells opposed to their vicinity.
3.3. Persistence Cancellation
The persistence [ELZ00] of a saddle s is the least difference
in function values compared to the cancellable extrema it is
linked to. Cancelling saddles by increasing persistence realizes topological simplification by means of the least geometric change, see Bremer et al [BEHP04].
Persistence cancellation does not preserve feature lines as
seen at the rocker arm surface in Fig. 3 and the ascending
1-cells of the initial MS complex of κ1 containing the convex feature lines of interest. Persistence cancellation initially
keeps this property in Fig. 3b. However, further cancellation destroys one of the most characteristic convex feature
lines, and a line traversing a concave region is preferred, see
Fig. 3c. The obvious reason for this is that the persistence
measure only considers the difference in function value between the minimum and the saddle, and hence regards only
the deepest point of the feature line.
3.4. Feature Line Preserving Cancellation
A feature line preserving cancellation criterion should quantify the whole feature line that is deleted by a cancellation.
We want to keep just salient 1-cells from the initial MS complex which means that the quantification of the feature line
should be compared to the vicinity of the line. The MS complex allows us both. An ascending 1-cell lies between two
valleys which we use as vicinity. In the following, I stands
for an arbitrary scalar feature indicator.

738

J. Sahner & B. Weber / Discrete Extraction of Feature Lines

(a) Initial κ1 MS complex.

(b) Persistence, step 3, 600.

(c) Persistence, step 3, 650.

(d) Our method, step 3, 550.

Figure 3: Ascending 1-cells of the initial MS complex of κ1 on the rocker arm are a candidate set of convex feature lines
in (a). 3, 600 persistence cancellations lead to the line set depicted in (b). Clearly, all feature lines are still contained. After
3, 650 cancellations, one of the main features is broken by persistence cancellation in (c). In contrast, feature line preserving
cancellation as proposed in this paper maintains the main features in (d).

U(m)

U(m)

r

r

(a) Salient ascending 1-cell.

(b) Shallow ascending 1-cell.

S(M1 )

S(M1 ) r
1

(c) Salient terminal 1-cell.

r1

(d) Shallow terminal 1-cell.

Figure 4: Quantification of 1-cell deletion: the average curvature on the 1-cell is compared to the average curvature on the
shaded area, and 1-cells with a larger difference are considered more salient, i.e., they are canceled later.
The proposed quantification σr (s, m) of a cancellation of
saddle s and minimum m deleting the ascending 1-cell r is
the difference of the average of I on the 1-cell and the average of I on the valley U(m) containing m:
σmax (r, m) =

1
area(r)

I−
r

1
area(U(m))

Γmax (ri , Mi )

(1)

U(m)

1
I−
length(v)
S(M)

I.

(2)

v

A line can not be regarded as a feature if the accumulated
I average does not differ significantly compared to both incident patches. Hence, the feature line significance σmax (r)
and σmin (v) is defined as the minimum of both values:
σmax (r) = min(σmax (r, m1 ), σmax (r, m2 )),

(3)

σmin (v) = min(σmin (v, M1 ), σmin (v, M2 )),

(4)

where r lies between the minima m1 , m2 , and v between the
maxima M1 , M2 . In words, a 1-cell is regarded as salient if
on the line more average I-value is accumulated than in the
patches that the 1-cell bounds.
Quantifying 1-cell cancellation as in (3), (4) preserves feature lines, but also, short offshoots of the feature lines are
kept that fork off orthogonally from the requested lines. To
punish such offshoots, σmax , σmin are adjusted at terminal 1cells only. These emanate from those saddles, where one of
the incident extrema is connected to just one saddle. For an
ascending 1-cell r with r1 , r2 being the part of the 1-cell ascending to the maxima M1 , M2 , and a minimal 1-cell v with

1
1
I − area(S(M
I
area(ri ) ri
i )) S(Mi )
1
1
I − length(v
I,
area(U(mi )) U(mi )
i ) vi

=

Γmin (vi , mi ) =
I,

see Fig. 4a-b and analogously for cancellations with a maximum M on the hill S(M) deleting the descending 1-cell v,
1
σmin (v, M) =
area(S(M))

v1 , v2 being the part of the 1-cell descending to the minima
m1 , m2 , respectively, the quantifications
(5)
(6)

see Fig. 4c-d are considered additionally by updating
σmax (r) and σmin (v)
σmax (r)

min(σmax (r), Γmax (r1 , M1 ), Γmax (r, M2 )), (7)

σmin (v)

min(σmin (v), Γmin (v, m1 ), Γmin (v, m2 )). (8)

In words, terminal feature lines that are not salient compared
to the patches they lie in, are discarded as well. See Fig. 5
for an example of a 1-cell forking off a feature line.
Only valid cancellations may be performed to keep the
alternating quad property of the MS complex. This means,
a saddle/maximum cancellation is allowed only if the saddle connects two different maxima. Therefore we define the
topological adaptations tmax (r) = σmax (r), if the 1-cell r
can be deleted by a valid cancellation, 1 otherwise, and
tmin (v) = σmin (v), if a valid cancellation exists, 1 otherwise.
The cancellation criterion t quantifying a saddle s by the
least significant cancellable 1-cell passing through the saddle
is then defined by
t(s) = min (tmax (r),tmin (v)) .

(9)

The reduction of lines in the initial complex now proceeds
by canceling saddles in increasing order of t. This ensures
that the lines with strongest feature line significance are kept.
The saddle is canceled with the extremum for which equality
is obtained in (9). See the result of using feature line significance as cancellation criterion in Fig. 3d. The deviation of
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

J. Sahner & B. Weber / Discrete Extraction of Feature Lines

739

from the saddle to the cancelled minimum. This results in
simple algorithms but affects the performance as for each
cancellation a number of edge flips have to be performed.

(a) Before cancellation.

(b) After cancellation.

Figure 5: Cancellation of a terminal 1-cell forking off the
outer ring feature of the rocker arm colored by κ1 . The 1cell emanating from the left saddle ends at the maximum on
the high curvature area, but only the part up to the branching
point is being deleted by the cancellation.
the 1-cell as for persistence cancellation does not occur here;
it stays on the feature line.
Two notes are important here:
1. Only one type of 1-cell is a meaningful feature line
for most scalar indicators. We handle both types of 1-cells
equally anyway for each quantity as this ensures a homogeneous cancellation of minima and maxima.
2. The 1-cell r used to evaluate (1) is restricted to the path
uniquely associated with the saddle under consideration.
Paths from different saddles can merge before reaching the
maximum as depicted in Fig. 5a. This is different from the
smooth setting where different 1-cells never meet. In Fig. 5b,
the left saddle was canceled with the terminal maximum.
Only the unique part of the 1-cell was removed. The remaining path to the maximum connects to other saddles and is
therefore retained. Hence, 1-cells are quantified up to the
first branching point only.
3.5. Discarding Topologically Forced Lines
1-cells r for which no valid cancellation exist might have
a smaller feature line significance than the last canceled 1cell. In this case, r is marked invisible and not displayed afterwards. Examples are the two concentric rings around the
hole of the rockerarm in Fig. 3d that are not connected as
forced by topology, and the cow’s head in Fig. 9b, where the
eye area is detached from all other lines.
3.6. Optional Line Smoothing
Our method results in lines that either consist of vertices or
triangle centers of the mesh. While this is topologically correct, it might not be visually appealing. We applied a simple
averaging with fixed filter length. The adapted Laplacian line
smoothing technique introduced by Hildebrandt et al [HP04]
gives appropriate guarantees when needed.
3.7. Implementational Issues
For the computation of the MS complex hierarchy we use the
approach introduced by Cazals et al [CCL03]. Instead of using the Union Find structure detailed there, we work directly
on the primal and dual spanning tree. A saddle / minimum
cancellation is performed by adding the saddle as edge into
the primal spanning tree and flipping all edges on the path
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

For computing feature line significance t (9), the involved
quantities are stored in the primal and dual spanning trees.
Each minimum and each maximum is being initialized with
the area of their unstable and stable manifolds respectively,
and with the integral of the scalar indicator over the manifold. Any saddle stores the integral and area of the stable
manifolds (triangle strips), and the integral and length of the
unstable manifolds (edge sequence) emanating from the saddle. Upon cancellation, those values are propagated from the
canceled extrema to its uncanceled analogon, so computation of feature line significance requires O(1) time.
All saddles are stored in an AVL tree that is used as priority queue. When a saddle is canceled, the saddles incident
to its incident extrema have to be reevaluated, as t can be
reduced by a cancellation. In theory, a single extremum can
be incident to a majority of the saddles in the complex which
means O(n log n) for a single update of the queue in the worst
case. In practice, t is designed to cancel minima and maxima
on the same priority, and hence our cancellation criterion is
not significantly slower than persistence cancellation.
4. Results
For all results, the used curvature estimates are computed
with the discrete method introduced by Hildebrandt et al
[HPW06], without smoothing. All feature lines are shown as
extracted by the method. We use red lines to display convex
features (maximal lines of κ1 ), blue lines for concave features (κ2 minimal), black lines for curvedness C. Smoothed
lines are displayed in the unshaded images only, all others
contain the unsmoothed originals.
Fig. 3 shows the rockerarm surface with 20K triangles.
The initial ascending 1-cells are shown together with the result of our method after 3, 550 (of total 3, 875) cancellations.
The extraction of the concave features is displayed analogously in Figure 6. Displaying both sets of feature lines in
Figure 6d represents the geometry of the rockerarm well.
Treating concave and convex features separately results in
two parameters. Curvedness allows us to reduce this to one
parameter, as the maximal structures of curvedness contain
both convex and concave features lines, as displayed in Fig.
7. The ascending 1-cells of the MS complex corresponding
to the optimal cancellation value 3, 388 (out of total 3, 777)
in Figures 7b-c represent the geometry of the surface, dependent on just one parameter. Due to this, curvedness is particularly suitable for our approach and we favor it over the
linked usage of κ1 and κ2 , unless either convex or concave
features are of particular interest for a specific surface, as
for the Stanford bunny with 280K triangles in Fig. 8, where
the concave features alone reflect the geometry well. In this
case, the initial descending 1-cells of κ2 are densely spread

740

J. Sahner & B. Weber / Discrete Extraction of Feature Lines

(a) Initial κ2 MS complex.

(b) Our method, step 4460.

(c) Concave and convex lines.

(d) Features plus silhouettes.

Figure 6: a) The initial MS complex of κ2 containing 4476 descending 1-cell is taken as a starting point. b) 4460 feature
preserving cancellations yield the visually best concave feature lines. c,d)) Feature lines plus silhouette represent the geometry.

(a) Initial Curvedness MS complex.

(b) Feature lines of curvedness.

(c) Features plus silhouettes.

Figure 7: The extraction of maximal features of the Curvedness indicator yields both convex and concave feature lines in one. It
depends on just one parameter, compared to two for the linked treatment of κ1 and κ2 and is therefore our preferred technique.
over the whole surface. The most significant concave feature lines are displayed in Figure 8d. In Fig. 9 the feature
lines on the cow’s head consisting of 93K triangles are displayed based on curvedness. Three different feature scales
corresponding to increasing cancellation values are being
displayed, ranging from fine scale in Figures 9a,b) to low
scale in Figure d). It is interesting to see that the head can
be recognized at quite coarse scale, and how the addition of
fine scale features adds expression to the cow’s face.
Fig. 9d shows another property of our approach: The terminal 1-cell building the cow’s brow is no watershed (as it
does not separate two regions) and could only be extracted,
as the whole MS complex is used for feature extraction.
The computational complexity of our approach is n log n
for the extraction of the initial MS complex (see [CCL03]),
where n is the number of vertices of the mesh. The current
implementation requires the 1-cells to be updated directly on
the graphs, which is of order n for a single cancellation in the
worst case. Table 1 gives timings of our method measured
on a workstation with an Intel Xeon CPU with 3.00GHz and
16 GB Ram without parallelization. We have not put much
emphasis on efficiency, and it can certainly be improved.
4.1. Insensitivity to Noise
Our method is insensitive to noise in the surface mesh. To
show this, we add Gaussian noise to the vertex positions of
the rockerarm mesh in direction to the mesh normal. We used
σ = 51 , σ = 12 , σ = 1 of the mean edge length. Those values correspond to the significant deformations seen in Fig.
10, but the extracted Curvedness feature lines are still visually close to the Curvedness feature lines extracted from the
undistorted mesh in Figure 7.

surface
rocker arm

bunny
cow
vase-lion

indicator
κ1
κ2
C
κ2
C
C

#cancels
3, 678
4, 476
3, 777
71, 577
13, 676
17, 613

tconstruct
0.21
0.23
0.20
3.8
1.2
2.6

tcancel
0.50
0.55
0.44
30
7.6
10.4

Table 1: Timings of our method for various datasets and
scalar feature indicators. In rows 3–5, the number of cancellations, the time in seconds to construct the initial MS
complex, and for performing all cancellations are shown.
4.2. User Guided Parameter Traversal
When using Curvedness as feature indicator, our method depends only on one parameter. This parameter is easy to control, as it allows for binary search. As the initial feature set
usually contains far too many lines, we proceed by performing two thirds of the remaining cancellations successively,
until visually too few feature lines are contained. In most
cases, the previous line set is then very close to the optimum.
At most log n values of the cancellation parameter have to be
tried, where n is the number of cancellations. An example
can be seen in Fig. 11 for the lion vase dataset consisting of
about 78K triangles allowing for 17, 613 cancellations.
4.3. Limitations
The proposed method has two limitations. Firstly, it results
in long connected lines. Whereas this is advantageous in
some settings, it is too rigid in others, as it is the case on
the rocker arm surface, where our technique fails to resolve
the “1-3”-Feature on the side of the rocker arm both in the
κ1 case (Fig. 3), and in the C case (Figure 7). Secondly, as
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

J. Sahner & B. Weber / Discrete Extraction of Feature Lines

(a) The Stanford bunny

(b) Initial κ2 MS complex.

(c) Step 71, 440.

741

(d) Features plus silhouettes.

Figure 8: Concave feature lines are extracted on the Stanford bunny with 280K triangles. The initial MS complex of κ2 consists
of 71, 577 cancellations, and its descending 1-cells are densely spread over the bunny. The kept concave features identify it.

(a) Fine scale features, shaded.

(b) Fine scale features.

(c) Middle scale features.

(d) Coarse scale features.

Figure 9: Feature lines on the cow at fine, medium and coarse scale after 12, 451, 13, 116 and 13, 491 cancellations respectively.
The coarse scale suffices to reflect the geometry, and fine scale features add more and more expression to the cow’s face.
mentioned in the last paragraph of Sect. 3.7, our cancellation
criterion t from (9) is not monotone, i.e., it can be smaller at
later cancellation stages. This makes it impossible to specify
a cancellation threshold rather than a cancellation count.
5. Conclusions
(a) Surface at σ = 15 .

(c) Surface at σ =

1
.
2

(e) Surface at σ = 1.

(b) Features at σ =

1
5

(d) Features at σ =

1
2

(f) Features at σ = 1

Figure 10: Adding Gaussian noise scales to the rockerarm
shows the stability of our method. The feature lines just appear disconnected due to occlusion by surface spikes.

c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

We showed how the Morse-Smale complex of scalar feature
indicators and an appropriately adapted cancellation criterion can be used to extract meaningful feature lines of surfaces in a stable way, dependent on just one parameter. In
this setting, we identified Curvedness as the most suitable
feature indicator for the extraction of surface features.
In the future we aim at comparing the feature lines of
our technique with ridge lines, both on a theoretical and
on a practical level. Further research directions are twofold:
an optional post-processing step seems appropriate in cases,
where long connected feature lines are not desired. Furthermore, after having reduced the number of necessary parameters for feature line extraction to one, parameter free feature
line extraction seems within reach, e.g. by examining cancellations statistics to provide the user with an initial guess
for an optimal cancellation parameter.
6. Acknowledgements
The rocker arm and the cow’s head are courtesy of INRIA,
the vase-lion of SenSable Technologies inc., provided by
Aim@Shape. The bunny is courtesy of the Stanford Scanning Repository.

742

J. Sahner & B. Weber / Discrete Extraction of Feature Lines

Figure 11: Feature lines on the lion vase. The one parameter our method depends on is traversed logarithmically. A user has
to decide for less lines until the coarse level of detail he is interested in is reached. One further step removes a detail regarded
as interesting. This way a good overview of the various level of details contained in the dataset is acquired in a few steps.
References
[Ban70] BANCHOFF T.: Critical points and curvature for embedded polyhedral surfaces. Am. Math. Monthly (1970), 475–485.
[BEHP04] B REMER P., E DELSBRUNNER H., H AMANN B.,
PASCUCCI V.: A topological hierarchy for functions on triangulated surfaces. IEEE TVCG 10, 4 (2004), 385–396.
[CCL03] C AZALS F., C HAZAL F., L EWINER T.: Molecular
shape analysis based upon the morse-smale complex and the connolly function. In SCG: Proc. of the 19. Ann. Symp. on Comp.
Geom. (2003), pp. 351–3605.
[DBG∗ 06]

D ONG S., B REMER P.-T., G ARLAND M., PASCUCCI
V., H ART J. C.: Spectral surface quadrangulation. In SIGGRAPH (2006), ACM Press, pp. 1057–1066.

[Ebe96] E BERLY D.: Ridges in Image and Data Analysis. Kluwer
Acadamic Publishers, Dordrecht, 1996.
[EHZ03] E DELSBRUNNER H., H ARER J., Z OMORODIAN A.:
Hierarchical morse-smale complexes for piecewise linear 2manifolds. In Disc. Comput. Geom. (2003), vol. 30, pp. 87–107.
[ELZ00] E DELSBRUNNER H., L ETSCHER D., Z OMORODIAN
A.: Topological persistence and simplification. In FOCS ’00:
Proc. of the 41st Ann. Symp. on Foundations of Computer Science
(Washington, DC, USA, 2000), IEEE Computer Society, p. 454.

[Lew05] L EWINER T.: Mesh Compression from Geometry. Thèse
de doctorat, Université Pierre et Marie Curie, France, 2005.
[LLT03a] L EWINER T., L OPES H., TAVARES G.: Optimal discrete morse functions for 2-manifolds. Comput. Geom. Theory
Appl. 26, 3 (2003), 221–233.
[LLT03b] L EWINER T., L OPES H., TAVARES G.: Visualizing
Forman’s discrete vector field. In Visualization and Mathematics III, Hege H.-C., Polthier K., (Eds.). "Springer-Verlag, Heidelberg, 2003, pp. 95–112.
[Mil63] M ILNOR J. W.: Morse Theory, vol. 51 of Annals of Mathematics Studies. Princeton, NJ, USA, 1963.
[MW99] M ANGAN A. P., W HITAKER R. T.: Partitioning 3d surface meshes using watershed segmentation. IEEE TVCG 5, 4
(1999), 308–321.
[NWB∗ 06] NATARAJAN V., WANG Y., B REMER P. T., PAS CUCCI V., H AMANN B.: Segmenting molecular surfaces. Computer Aided Geometric Design (special issue on Applications of
Geometric Modeling in the Life Sciences) 23, 6 (2006), 495–509.
[OBS04] O HTAKE Y., B ELYAEV A., S EIDEL H.-P.: Ridge-valley
lines on meshes via implicit surface fitting. In SIGGRAPH
(2004), pp. 609–612.

[For98] F ORMAN R.: Morse theory for cell complexes. Advances
in Mathematics 134 (1998), 90–145.

[Pas07] PASCUCCI P.-T. B. V.: A practical approach to twodimensional scalar topology. In Topology-based Methods in Visualization, Hauser H., Hagen H., Theisel H., (Eds.), Mathematics
and Visualization. Springer, 2007.

[For02] F ORMAN R.: A user’s guide to discrete morse theory.
Sémin.Lothringien de Combinatoire B48c (2002).

[PM82] PALIS J., M ELO W. D.: Geometric Theory of Dynamical
Systems: An Introduction. Springer-Verlag, 1982.

[GMDP∗ 07] G YULASSY A., M. D UCHAINEAU V. N., PAS CUCCI V., B RINGA P., H IGGINBOTHAM A., H AMANN B.:
Topologically clean distance fields. In Proc. IEEE Visualization
2007 (2007), pp. 1432–1439.

[SF04] S TYLIANOU G., FARIN G.: Crest lines for surface segmentation and flattening. IEEE Transactions on Visualization
and Computer Graphics 10, 5 (2004), 536–544.

[HP04] H ILDEBRANDT K., P OLTHIER K.: Anisotropic filtering of non-linear surface features. Comput. Graph. Forum 23,
3 (2004), 391–400.
[HPW05] H ILDEBRANDT K., P OLTHIER K., WARDETZKY M.:
Smooth feature lines on surface meshes. In 3rd Eurographics
Symp. on Geom. Proc. (2005), pp. 85–90.
[HPW06] H ILDEBRANDT K., P OLTHIER K., WARDETZKY M.:
On the convergence of metric and geometric properties of polyhedral surfaces. Geometria Dedicata 123 (2006), 89–112.
[KvD92] KOENDERINK J. J., VAN D OORN A. J.: Surface shape
and curvature scales. Image and Vision Computing 10, 8 (October
1992), 557–564.

[Soi99] S OILLE P.: Morphological Image Analysis. Springer,
Berlin, Heidelberg, New York, 1999.
[SWTH07] S AHNER J., W EINKAUF T., T EUBER N., H EGE H.C.: Vortex and strain skeletons in eulerian and lagrangian frames.
IEEE TVCG 13, 5 (2007), 980–990.
[YBS05] YOSHIZAWA S., B ELYAEV A., S EIDEL H.-P.: Fast and
robust detection of crest lines on meshes. In Proc. ACM SPM
(2005), pp. 227–232.
[YBYS07] YOSHIZAWA S., B ELYAEV A. G., YOKOTA H., S EI DEL H.-P.: Fast and faithful algorithm for detecting crest lines
on meshes. In Pacific Graph. (2007).

c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.


Volume 28 (2009), Number 2

EUROGRAPHICS 2009 / P. Dutré and M. Stamminger
(Guest Editors)

Spectral-Based Group Formation Control
Shigeo Takahashi1 , Kenichi Yoshida1 , Taesoo Kwon2 , Kang Hoon Lee3 , Jehee Lee2 , and Sung Yong Shin4
1 The

University of Tokyo, Japan
National University, Korea
3 Kwangwoon University, Korea
4 Korea Advanced Institute of Science and Technology, Korea
2 Seoul

Abstract
Given a pair of keyframe formations for a group consisting of multiple individuals, we present a spectral-based
approach to smoothly transforming a source group formation into a target formation while respecting the clusters
of the involved individuals. The proposed method provides an effective means for controlling the macroscopic
spatiotemporal arrangement of individuals for applications such as expressive formations in mass performances
and tactical formations in team sports. Our main idea is to formulate this problem as rotation interpolation
of the eigenbases for the Laplacian matrices, each of which represents how the individuals are clustered in a
given keyframe formation. A stream of time-varying formations is controlled by editing the underlying adjacency
relationships among individuals as well as their spatial positions at each keyframe, and interpolating the keyframe
formations while producing plausible collective behaviors over a period of time. An interactive system of editing
existing group behaviors in a hierarchical fashion has been implemented to provide flexible formation control of
large crowds.
Categories and Subject Descriptors (according to ACM CCS): I.3.7 [Computer Graphics]: Three-Dimensional
Graphics and Realism—Animation

1. Introduction
Many technical advancements have been made for intricate crowd control especially in the background scenes of
movies and video games. Nonetheless, the full control of
such crowds is still difficult because it requires appropriate
parameters that faithfully characterize the crowd behaviors.
On the other hand, in many cases, streams of crowd motions
exhibit some meaningful formations such as artistic layouts
in mass performances and tactical arrangements of players
in team sports. To achieve this, the individuals try to get to
their predefined positions at specific times while respecting
their underlying collective movements.
In mass performances, for example, each individual is requested to keep a similar relative position with his/her neighbors while making smooth transitions between formations at
predefined time steps. In this respect, the adjacency relationships should reflect the collective movement of the individuals, through which not only pleasing regular (but not random) patterns but also artistic expressiveness is exhibited to
the audience according to a scenario.
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

This paper presents a novel approach to group formation
control while maximally respecting the adjacency relationships among the involved individuals. Our main contribution
lies in the use of spectral analysis of such clusters of individuals for plausible interpolation of the predefined keyframe
formations.
A major advantage of our approach is the ability to control the adjacency relationship between any pair of individuals to maximally respect the underlying subgroups of individuals. Figure 9 shows that our approach achieves smooth
changes in the spatial arrangements of subgroups, while the
individuals in each subgroup are closely tied together during the motion. This advantage cannot be realized with geometric morphing techniques due to their limited capabilities
of preserving the adjacency relationships. It is also difficult,
if not impossible, with conventional rule-based approaches
(for example, see [Rey99]) or force-field-based approaches
(for example, see [HM95, GKM∗ 01]) since a large number
of parameters would have to be set properly to make these
approaches work as intended.

640

S. Takahashi, K. Yoshida, T. Kwon, K. H. Lee, J. Lee & S. Y. Shin / Spectral-Based Group Formation Control

⇓

⇓

⇓

⇓

formation copied
⇓

formation edited
⇓

formation edited
⇓

formation copied
⇓

keyframe formation
keyframe formation
keyframe formation
keyframe formation
← interpolated →
← interpolated →
← interpolated →

Figure 1: Group formations in a mass performance of a marching band: A new sequence of group formations (in the bottom
row) is generated from the video frames (in the top row) by extracting parts of the group formations (in the middle row), editing
representative keyframe formations, and interpolating the formations for intermediate frames while respecting their adjacency.

Another important advantage of our approach is that a
stream of novel formations can be synthesized efficiently
by minimally editing existing group formations, which can
be readily acquired from various sources such as captured
videos. Figure 1 illustrates the overview of this synthesis
process, where the extracted group motion is edited by modifying certain representative keyframe formations and interpolating the corresponding relative arrangements to compose a novel sequence of group formations. This keyframebased framework is suitable again in the design of mass performances, in which a scenario is usually provided beforehand by an artist so as to outline the sequence of representative formations with the underlying aggregate behaviors.
Our analysis for group formation is based on the spectral graph theory [Chu97], which allows us to partition a
weighted graph with the minimal cost of edge cuts for clustering purposes. Here, a weighted graph is defined over a
given group formation so that an edge weight represents the
stability of the spatial adjacency between a pair of individuals. Spatial adjacencies are then captured by a Laplacian
matrix to maximally respect the underlying local flocking
behaviors of individuals in the group. Smooth interpolation
over a sequence of given keyframe formations is achieved by
successively transforming the eigenstructures of the Laplacian matrices. Hierarchical editing enables efficient control
of a large crowd in our framework by recursively decomposing the crowd into several small subgroups of individuals. A
social force model [HM95] is also integrated into the present
approach in order to avoid collisions between the individuals
during the interpolation of group formations.

The remainder of this paper is organized as follows: Section 2 surveys previous work related to this paper. Section 3
presents a new spectral-based method for smoothly interpolating keyframe formations, while trying to respect the
underlying adjacency relationships among the individuals.
Section 4 describes several enhancements of the present approach for better control of group formations. After demonstrating crowd animation results together with the implementation of our prototype system in Section 5, Section 6
concludes this paper and refers to possible future extensions.
2. Related Work
Conventional methods for crowd behavioral control can be
roughly classified into microscopic and macroscopic approaches, where a microscopic approach describes the local
motion of each individual in a crowd while a macroscopic
approach tries to govern the global behavior of the crowd.
The most popular are rule-based approaches in which
microscopic rules are defined for autonomous agents.
Reynolds [Rey99] simulated flocks of birds and schools of
fishes using simple local behavioral rules, where the approach was equipped with a steering behavior to make the individuals reach their goals while avoiding obstacles and collisions with others. Rule-based models have been more sophisticated by accounting for motion dynamics [BH97], cognitive knowledge [FTT99], human psychology [SMK05],
pedestrian perception [ST05], and densely populated situations [PAB07].
On the other hand, different approaches have been introc 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

S. Takahashi, K. Yoshida, T. Kwon, K. H. Lee, J. Lee & S. Y. Shin / Spectral-Based Group Formation Control

duced to govern such behaviors of crowds with the help of
force-field formulations. Social forces introduced by Helbing
and Molnár [HM95] are an example of such physical forces,
and can systematically regulate mutual microscopic interactions between individuals in escape panic [BMdB03] and
pedestrian simulation [LKF05].
Different physical sophistication, originated from fluid dynamics, has then been invented to explore rather macroscopic behavior of crowds. This class of methods has enabled the global configuration of obstacles with vector
fields [GKM∗ 01], and pedestrian behavioral control with
continuous density fields [Hug03, TCP06]. An alternative
approach is presented to design a stationary flow field by
manually tiling small rectangular regions of velocity fields
over the environment [Che04].
Although these methods effectively simulate the realistic
behavior of crowds, they still incur unexpected artifacts in
the motion of each agent due to interactions with other moving agents. Example-based models solve this problem by referring to the existing motion data and synthesize naturallylooking crowd animations, including rhythmic motions such
as ballroom dancing and military marching [KPS03] and
composite motion of existing group behaviors using extended motion graphs [SKG05, LCF05]. Recently, several
methods have been proposed that directly use videos of real
crowds rather than motion capture data, where the existing
crowd motions are extracted manually [LCL07, PPD07] and
semi-automatically [LCHL07, CC07] from the videos.
Our approach can be categorized into a macroscopic approach, however, its goal is somewhat different from the conventional approaches of the same kind in that it explores
explicit control of spatial adjacencies between individuals
or their subgroups rather in unconstrained environments, in
order to generate meaningful spatiotemporal transitions as
exhibited in mass performances and tactical sports. Such
group formation control has been investigated in the field
of robotics [LT97, BA98, LC03], while the methods cannot provide smooth transitions of global group formations.
On the other hand, our approach employs spectral analysis
of adjacency relationships among individuals for sophisticated control of the underlying aggregate behaviors. This
spectral analysis technique is also closely related to graph
layout problems [Kor03], and thus can be extended to the
analysis of point sets such as clustering [SM00] and matching [CH03]. Furthermore, the spectral-based approach is
suitable for mesh manipulations such as smoothing [Tau95],
compression [KG00], and watermarking [OMT02]. A similar idea has been recently employed for the global deformation of group pathways while their details are maintained [KLLT08]. We refer the reader to the book [Chu97]
for more details.
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

641

3. Spectral Formation Control
This section explains fundamentals of our spectral-based approach to group formation control using adjacency relationships among individuals. Our strategy is to extract adjacency
relationships from coarse to fine frequencies, and interpolate
them for each frequency to preserve the collective behaviors
of individuals.
3.1. Formation analysis
First of all, we associate a graph with a group formation in
order to describe the adjacency relationships among individuals. Figure 2(a) shows an example of a graph that represents
the adjacency relationships among six individuals. A vertex
of the graph represents an individual. Let n be the number
of individuals in a group. Each edge connecting vertices i
and j, for 1 ≤ i, j ≤ n and i = j, has a positive weight wi j ,
where wi j = w ji . Basically, the weight value represents the
stability of the corresponding adjacency relationship during
the spatiotemporal transition of the group formation. Notice
that not every pair of vertices admits an edge. By default, we
use the Delaunay triangulation of the vertices as the graph,
and set each edge weight wi j to the inverse of the distance
between vertices i and j. However, the connectivity of the
graph and its associated edge weights can be modified arbitrarily in formation editing, regardless of their spatial arrangement. In order to extract the spectral-based structure of
a group formation, we analyze the n × n Laplacian matrix L
of the graph, which is defined as follows [Kor03]:
L = (Li j ) =

∑nm=1 wim
−wi j

i= j
,
i= j

i, j = 1, . . . , n.

Figure 2 (b) shows a Laplacian matrix, where all the edges of
the graph have a unit weight value for simplicity. Since L is
always a symmetric positive definite matrix, the eigenvalues
are all nonnegative and its corresponding unit eigenvectors
form an n-dimensional orthonormal basis called an eigenbasis. In particular, the minimum eigenvalue of L is always
0 and its corresponding eigenvector is (1, . . . , 1) since the
sum of the matrix entries in each row vanishes.
The eigenanalysis of L allows us to decompose the
graph structure into its frequency components [KG00]. Let
0 = λ1 ≤ λ2 ≤ · · · ≤ λn be the eigenvalues of L, and
e1 , e2 , . . ., and en their corresponding unit eigenvectors. Denoting the 2D coordinates of the individual k by (xk , yk ), k =
1, . . . , n, we define two column vectors of dimension n:
x = (x1 , . . . , xn )⊤ and y = (y1 , . . . , yn )⊤ , where ⊤ denotes
the transpose of a vector. These column vectors can be written as a weighted sum of the eigenvectors as:
x = α1 e1 + · · · + αn en

and y = β1 e1 + · · · + βn en . (1)

Here αk and βk are coefficients satisfying αk = x, ek and
βk = y, ek , respectively, where p, q is the inner product
of vectors p and q. Figure 2(c) illustrates such a frequencybased decomposition of the graph in Figure 2(a), where the

642

S. Takahashi, K. Yoshida, T. Kwon, K. H. Lee, J. Lee & S. Y. Shin / Spectral-Based Group Formation Control
#6

#1
#4

Reconstructed formation

#6

#4
#1
#5
#3
#2

#1
#5
#3
#2

3 −1 −1 −1 0 0
−1 2 −1 0 0 0 #1 #4 #6


−1 −1 4 −1 0 −1
L=

=
−1 0 −1 4 −1 −1
 0 0 −1 −1 3 −1
#2#3 #5
0 0 0 −1 −1 2
(a) graph



up to 2
⇑



(b) Laplacian matrix

connectivity
=
x
=
y

#1-6

+

#4

#1
#5
#3
#2

#3
#2

up to 3
⇑

#6

+

#1
#3
#4
#5

#2
#6

#6

#1

#4

#6

+

#4 #6

#3
#5

#1
#6

#3
#2
#5

#5

#2#3 #5

up to 5
⇑

up to 6
⇑

#2

up to 4
⇑
#4

#1

#4

+

#1
#5

#3
#4
#2
#6

+

α5 e5
β5 e5

+
+

#4
#2 #5
#1 #6
#3

(c) geometric decomposition
α1 e1
β1 e1

+
+

α2 e2
β2 e 2

+
+

α3 e3
β3 e3

+
+

α4 e4
β4 e 4

+
+

α6 e6
β6 e 6

Figure 2: Graph decomposition using spectral analysis: (a) original graph connectivity (center), (b) its corresponding Laplacian matrix (left), and (c) geometric decomposition (right). The eigenvector e1 relates to the barycenter of the graph, the eigenvectors e2 –e6 represent how the individuals can be clustered into subgroups from coarse to fine levels. The original formation
can be reconstructed by accumulating the components from coarse to fine frequencies, accordingly.

eigenvector ek gives rise to the arrangement of the individuals along the direction vector (αk , βk )⊤ . Moreover, the
eigenvector for a smaller eigenvalue controls larger clusters of individuals in the group formation, except that e1
just relates to the barycenter of the group because e1 =
⊤
1
n (1, . . . , 1) . For example, we can bisect the graph only
with 3 edge cuts with respect to (α2 , β2 )⊤ in this case as
indicated by red broken lines; otherwise we would need 4 or
more edge cuts.

3.2. Formation interpolation
Having extracted the Laplacian matrices for the source and
target keyframe formations, our task is to smoothly interpolate the two keyframe formations while achieving their plausible transition. We separately interpolate the eigenbases of
the Laplacian matrices and their associated coefficient vectors (See Eq. (1)), which correspond to the adjacency relationships among individuals and their geometric positions in
3D space, respectively, in a mathematical sense.
Given a pair of Laplacian matrices corresponding to the
source and target group formations, respectively, elementwise linear interpolations would not properly reflect the
given adjacency relationships of the group, unfortunately.
At every time step during a formation transition, the unit
eigenvectors of the Laplacian matrix form an orthonormal
basis because the Laplacian matrix is always a symmetric
positive definite matrix as described earlier. This observation inspires us to perform formation control by transforming the eigenvectors of the Laplacian matrix for the source
group formation into the target eigenvectors, while keeping
their orthonormality during the transformation. Rotation is
the transformation of our choice as it is the only transforma-

tion that satisfies this orthonormality condition while being
simple and natural.
Let λSk , k = 1, . . . , n be the eigenvalues of the Laplacian
matrix for the source group formation such that 0 = λS1 ≤
· · · ≤ λSn , and eSk be the corresponding eigenvectors. Similarly, we define the eigenvalues and eigenvectors of the target
formation as λTk and eTk , k = 1, . . . , n. Letting S = (eS1 , . . . , eSn )
and T = (eT1 , . . . , eTn ), we derive an n × n rotation matrix R
as follows:
R = T S−1 .

(2)

This formulation also takes into account the eigenvalues
(i.e., the frequency) of the Laplacian matrix by arranging
the eigenvectors in S and T according to the magnitudes of
the corresponding eigenvalues, respectively. Without loss of
generality suppose that det(S) = det(T ) = 1 and eSk , eTk ≥
0. These conditions can always be achieved by properly inverting the direction of eTk , k = 1, . . . , n, if needed. This arrangement of eigenvectors enables us to not only retain the
aggregation of individuals in the group formation, but also to
smoothly merge and split existing clusters by changing the
associated adjacencies.
Let us denote the n × n matrix of eigenvectors at the time t
by M(t) = (e1 (t), e2 (t), . . . , en (t)). For the actual formation
interpolation, the rotation matrix Rt , t ∈ [0, 1] gives us the
matrix M(t) as follows:
M(t) = Rt S.

(3)

A more sophisticated scheme for eigenvector ordering is to
be discussed in Section 4.2. The actual computation for the
exponential of the matrix R will be detailed in Section 5.
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

S. Takahashi, K. Yoshida, T. Kwon, K. H. Lee, J. Lee & S. Y. Shin / Spectral-Based Group Formation Control

(a)

(b)

Figure 3: Differences between (a) linear interpolation and
(b) polar interpolation where the associated relative arrangement remains the same.

(a)

643

(b)

Figure 5: Formation transitions obtained with (a) simple
polar interpolation, and (b) our spectral-based interpolation. The PCA-based adjustment is applied to both cases.

formulated as follows:
r (t) cos(θk (t))
r (t)=(1 − t)rkS + trkT
αk (t)
= k
, where k
,
βk (t)
rk (t) sin(θk (t))
θk (t)=(1 − t)θSk + tθTk
rkS=
(a)

(b)

Figure 4: Differences between formation transitions (a)
without the PCA-based adjustment and (b) with the PCAbased adjustment, where the associated relative arrangements in the source and target formations are not identical.
The green and cyan trajectories intersect without the PCAbased adjustment while the relative arrangement is maximally preserved with the PCA-based adjustment.

3.3. Geometric interpolation
On top of formation interpolation, we also perform geometric interpolation to fix the coefficient vectors at each time
step. Since Eq. (3) provides the eigenvectors e1 (t), . . . , en (t)
at the time t, we can determine the (x, y)-coordinates of
each individual using Eq. (1), given coefficients αk (t) and
βk (t), k = 1, . . . , n. We obtain these coefficients based on polar interpolation in 3D space over the time interval [0, 1].
Probably the simplest method to obtain the coefficients
may be linear interpolation between source coefficients
(αSk , βSk )⊤ and target coefficients (αTk , βTk )⊤ . Unfortunately,
such a method is not able to respect the adjacency relationships among individuals even when the two group formations share the same relative arrangement, as illustrated in
Figure 3(a). In this figure, a different color is assigned to
each individual in order to represent its own source position,
target position, and trajectory between them with a translucent disk, an opaque disk, and a curved line with increasing thickness, respectively. Note that the barycenter of the
formation remains fixed during the transformation in this
case. This observation motivates the use of polar interpolation in order to align the orientation of the source formation
with that of the target formation during the interpolation, as
shown in Figure 3(b). Our polar interpolation scheme can be
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

αSk
αTk
αSk
αTk
T
S
T
T , θk=atan S , and θk =atan T . (4)
S , rk =
βk
βk
βk
βk

Here, r = |(α, β)⊤ | represents the norm of the vector
(α, β)⊤ , and atan (α, β)⊤ denotes the angle between the
vectors (α, β)⊤ and (1, 0). Note that, for k = 0, we employ
linear interpolation because the corresponding coefficients
just represents the barycenters of the two formations.
This polar interpolation scheme is also advantageous even
if the two given formations are moderately different. In this
case, special care is needed to minimize the change in the
relative arrangement during the formation transition. Without loss of generality, suppose that the source and target formations are translated to share the barycenter. We first find
the principal axes of the two formations from their spatial arrangements using principal component analysis (PCA), and
then rotate the target formation until their principal axes are
aligned with those of the source formation. We call this the
PCA-based adjustment of group formations in this paper.
After this PCA-based adjustment, we carry out the polar
interpolation described above (See Eq. (4)). For each individual, there are two rotation directions, that is, clockwise
and counter-clockwise directions. We choose the direction
that yields the smallest rotation angle. Figure 4 shows how
the PCA-based adjustment maximally preserves the relative
positions of individuals during the interpolation, by switching the rotation directions of individuals in green and cyan.
Let us compare our spectral-based interpolation with simple polar interpolation where we directly interpolate the
positions of each individual using these polar coordinates,
without decomposing them into spectral coefficients as in
Eq. (1). Our spectral-based approach is more effective than
simple polar interpolation, since it maximally respects the
spatial adjacency among the individuals as shown in Figure 5. Note that with simple polar interpolation we can see
an unexpected winding path for the individual in magenta.
As described in Section 3.1, another advantage of our

644

S. Takahashi, K. Yoshida, T. Kwon, K. H. Lee, J. Lee & S. Y. Shin / Spectral-Based Group Formation Control
S

T

λ5
S
λS4
λ3

λT5
λ4
T

λT3
λT2
λ1
target

S
2
S
1

(a)

(b)

Figure 6: Formation transitions obtained with (a) adjacency relationships based on the spatial arrangement of individuals and (b) with adjacency relationships manually adjusted.

approach is the ability to control the stability of the adjacency relationships during the associated spatiotemporal
transition. Figure 6 shows comparison between two formation transitions with the edge weights derived from the
purely-geometric setting of the individuals (Figure 6(a)) and
with edge weights manually adjusted (Figure 6(b)). In Figure 6(b), we tightly control the relative positions of the four
moving individuals and the central one by manually increasing each of the corresponding edge weights by ten times,
compared to that in Figure 6(a).

λ
λ
source

S = (eS1 , eS2 , eS3 , eS4 , eS5 )
| | | | |
T = (eT1 , eT2 , eT3 , eT4 , eT5 )
(a)

S

In this section we describe several enhancements of the proposed framework for better control of formation transition,
to take full advantage of the fundamentals presented in the
previous section.

λT5
λ4
T
λ3

S

T

λ2
S
λ1
source

λT2
λ1
target

S = (eS1 , eS2 , eS3 , eS4 , eS5 )
| × | |
Tσ = (eT1 , eT3 , eT2 , eT4 , eT5 )
(b)

Figure 7: Reordering eigenvectors for fine adjustment of
source and target orthonormal bases: (a) transitions of
eigenvalues when the group formation has a small change
and (b) when the formation has a relatively large change.
The matrices of reordered eigenvectors for source and target formations are represented at the bottom.

(a)
4. Enhancement of Formation Control

T

λ5
S
λS4
λ3

(b)

Figure 8: Paths of the individuals without and with eigenvector reordering: (a) winding paths without eigenvector reordering and (b) smooth paths with eigenvector reordering.

ces will give us the following equation:
4.1. Interpolating multiple formations
Interpolating more than two keyframe formations is important in the present framework to allow users to insert new
intermediate keyframe formations. We solve the problem
by extending the Catmull-Rom spline formulation [CR74].
Provided with control points pn−1 , pn , pn+1 , and pn+2 , a
Catmull-Rom spline curve that begins at pn and ends at pn+1
is defined as:
p(t) = c−1 pn−1 + c0 pn + c1 pn+1 + c2 pn+2 , where
c−1 =τ(−t + 2t 2 − t 3 ), c0 =(1 − 3t 2 + 2t 3 ) + τ(t 2 − t 3 ) (5)
c1 =(3t 2 − 2t 3 ) + τ(t − 2t 2 + t 3 ), and c2 =τ(−t 2 + t 3 ).
Here, t ∈ [0, 1] and τ control the tension of the curve. In our
implementation, we set τ = 0.5 by default. In addition, when
pn (or pn+1 ) is an endpoint of the curve, or a point at which
the curve is set to be nonsmooth, pn (or pn+1 ) is duplicated.
For finding the temporal transition of the matrix of eigenvectors M(t) in Eq. (3), let R0 , R1 , and R2 be the three rotation matrices that successively transform the given keyframe
formation represented by the matrix of eigenvectors M 0 . Applying the spline formulation to the power of rotation matri-

M(t) = (R2 R1 R0 )c2 (R1 R0 )c1 (R0 )c0 (I)c−1 M 0
= (R2 R1 R0 )c2 (R1 R0 )c1 (R0 )c0 M 0 ,
where c−1 , c0 , c1 , and c2 are defined in Eq. (5), and I represents the identity matrix. This formulation enables smooth
interpolation of adjacency relationships among individuals
over the given multiple keyframe formations.
4.2. Eigenvector reordering
Ordering the eigenvectors of the Laplacian matrix according
to their corresponding eigenvalues yields a natural transition
between a pair of keyframe formations when the two formations share moderately similar spatial adjacencies among the
individuals. This follows from the fact that, in such a case,
the order of eigenvalues usually remains the same over the
period of time as shown in Figure 7(a), except for the first
eigenvalues representing the formation barycenter. Nonetheless, this scheme sometimes incurs unexpected path winding
for individuals, as shown in Figure 8(a), if the two given formations are relatively different in their adjacency relationships. This problem occurs when the associated order of the
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

S. Takahashi, K. Yoshida, T. Kwon, K. H. Lee, J. Lee & S. Y. Shin / Spectral-Based Group Formation Control

645

eigenvalues has changed during the transition as shown in
Figure 7(b).
In our approach, we alleviate this problem by reordering
the eigenvectors of the keyframe formations by greedy pairwise coupling. This reordering is accomplished, as shown in
Figure 7(b), by first fixing the order of source eigenvectors
(eS2 , . . . , eSn ), and then finding the new order of target eigenvectors (eTσ(2) , . . . , eTσ(n) ) such that the corresponding inner
product eSk , eTσ(k) is maximized. More precisely, for each
source eigenvector eSk , k = 2, . . . , n, eTσ(k) is chosen successively among the uncoupled target eigenvectors from k = 2
to n in a greedy manner. The resultant reordering of target
eigenvectors usually provides smoother paths because the
target orthonormal basis is now closely aligned to the source
orthonormal basis. Figure 8(b) shows an effect of this reordering where the undesirable path winding has been successfully eliminated. Our framework also provides an option
for further improving this alignment, by locally rearranging
the target eigenvectors in order to maximize the minimum
inner product (i.e., minimize the maximum angle between
the corresponding eigenvectors) over all the combinations
of corresponding source and target eigenvectors.
4.3. Collision avoidance
As described so far, our approach ignores potential collisions between individuals. A social force model [HM95]
is integrated into our approach for collision avoidance. We
first generate the trajectory of each individual using our
macroscopic spectral-based approach. We then locally adjust this trajectory by applying social forces such as driving
and repulsive forces to avoid collisions. We finally smooth
the trajectory while keeping a user-specified minimum interdistance for every pair of individuals. Figure 9 shows how
this process successfully generates collision-free trajectories
for interpolating group formations. The comparison with the
simple social force model reveals that our approach provides more plausible macroscopic transitions as initial trajectories and is also naturally compatible with existing microscopic path generation frameworks using social forces.
Note that this collision-avoidance scheme is similar to Perlin’s work [Per].
4.4. Hierarchical control
In order to handle a crowd consisting of a large number of
individuals, we take a divide-and-conquer strategy to decompose the crowd into subgroups of individuals, each of which
shares a common goal. This motivates the use of a hierarchical representation for crowd control [MT01], with which
we can recursively describe the behaviors of a large crowd
in terms of subgroups. In particular, the spectral-based approach is applied to the subgroups at each level from top to
bottom in a hierarchical fashion. The position of each subgroup is set to the barycenter of the individuals in the subc 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

(a)

(b)

Figure 9: Comparison between (a) linear and (b) spectralbased interpolation schemes. Original macroscopic trajectories as initial solutions (top) and those obtained by collision avoidance using social forces (bottom). Our spectralbased macroscopic interpolation maximally preserves the
underlying clusters of individuals, and is also compatible
with existing microscopic behavioral control of individuals.

group. The hierarchical control scheme facilitates a systematic way of handling meaningful crowd formations, such as
simulating a large crowd in specific formations (Figure 11).
4.5. Extension to 3D cases
Our approach can be extended to control 3D group formations such as flocks of birds and schools of fishes. We
straightforwardly adapt the two-step approach in 2D space
that consists of formation interpolation (Section 3.2) and
geometric interpolation (Section 3.3). For geometric interpolation, we employ a spherical linear interpolation technique [Sho85]. Figure 12 presents an airshow scene generated using our approach where airplanes exhibit acrobatic
changes of formations in 3D space.
5. Results
This section describes an implementation of our prototype
system for group formation control, and demonstrates several animation results generated by the system in order to
illustrate the capability of our approach. Discussions of the
advantages and limitations of the present approach are also
provided. See the accompanying video for details.
5.1. Editing interface
Our prototype system is implemented on a desktop PC with
an Intel Core 2 Duo E6600 CPU (2.4GHz, 4MB cache) and
3GB RAM. The prototype system allows the user to freely
edit keyframe formations to facilitate intended group formation control at an interactive rate. The interactive performance is accomplished by approximating the power of

646

S. Takahashi, K. Yoshida, T. Kwon, K. H. Lee, J. Lee & S. Y. Shin / Spectral-Based Group Formation Control

(a)

(b)

(c)

(d)

Figure 10: Tactical formations in a soccer game: (a) A keyframe when the offside trap is about to begin, (b) a keyframe when
the offside trap fails, (c) a new keyframe when the offside trap is about to begin, and (d) a new keyframe when the offside trap
is successful.

(a)

(b)

(c)

(d)

(e)

Figure 11: Artistic formations in the mass performance of a large crowd. Four keyframe formations are inserted to guide the
formation: (a) A circle, (b) a star, (c) a runner, (d) five small circles, and (e) a side view of the crowd.

matrices using the method for computing matrix square
roots [DB76]. The system also provides default setting of
the adjacency relationships based on the vertex connectivity
of the Delaunay triangulation, which will serve as a good
starting point for further editing the adjacency relationships
among individuals and their hierarchical representations.
5.2. Animation examples
We calculated the trajectory of each individual with the
present approach, and used an online locomotion synthesis
technique [KS07] as a postprocess to control human-like individuals in Figures 1, 10, and 11. Table 1 shows statistics
of group formations in the animation examples, where the
computation times were measured by conducting the above
postprocess for the final motion synthesis.
Mass performance of a marching band Figure 1 presents
how we can modify the existing motion in a mass performance done by a marching band. Here, we extracted the
group motion from a video clip (in the top row) [LCHL07].
We then inserted two intermediate formations as new
keyframes in addition to the first and last formations, intensified the adjacency relationships among individuals in each
subgroup, and finally generated a novel sequence of group
formations. A sequence of snapshots of the resulting animation is exhibited in the bottom two rows of Figure 1.
Soccer game Figure 10 demonstrates how to edit a tactical formation in a soccer game. In the original scene (Figure 10(b)), a defensive tactic called an offside trap is not

successful because the player in the defensive group is not
properly placed (Figure 10(a)) when the ball is passed. Note
that an offensive player commits an offside fault if the player
is behind the last defensive players (except the goalkeeper)
without keeping the ball. We can modify this scene to show
that the defensive group achieves the intended offside trap
(Figure 10(d)), by spatially aligning the last defenders on a
line in a keyframe formation (Figure 10(c)).
Large crowd in specific formations Figure 11 demonstrates that our approach is also feasible for controlling a
large number of individuals in a crowd. In this experiment,
we introduced three hierarchical levels for representing the
crowd, by recursively splitting it into disjoint subgroups and
controlling their formations and local behaviors. The number of hierarchical levels was manually designed in this case,
while the associated grouping could be conducted semiautomatically with the support of our system. We used four
keyframe formations as shown in Figures 11(a)-(d).
Acrobatic airshow In order to demonstrate the capability
of 3D group formation control, we show a synthetic animation of airplanes in Figure 12, successively exhibiting
six alphabet characters “T,” “H,” “E,” “E,” “N,” and “D.”
The airplanes move plausibly to interpolate these specified
keyframes while respecting their adjacency relationships in
3D space.
5.3. Discussions
Our approach aims at macroscopic control of group behaviors assuming that a group motion is prescribed as a series
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

647

S. Takahashi, K. Yoshida, T. Kwon, K. H. Lee, J. Lee & S. Y. Shin / Spectral-Based Group Formation Control

(a)

(b)

(c)

(d)

(e)

(f)

Figure 12: A sequence of acrobatic formations in an airshow: The letters (a) “T,” (b) “H,” (c) “E,” (d) “E,” (e) “N,” and (f)
“D,” which are given as keyframe formations.

of keyframe formations. In other words, our scheme is not
intended to generate group motions that mainly depend on
various microscopic interactions such as pedestrian behaviors and escape panic. To our knowledge, our approach is
the first scheme for macroscopic formation control, which
facilitates smooth transitions of keyframe formations and accurate spatiotemporal control of each individual at specific
keyframes. In order to keep interactivity of our system, we
limit the number of individuals up to 60 in a single subgroup;
otherwise, the computation time for eigenanalysis (see Section 3) would increase rapidly. Applying different interpolation schemes such as linear and spectral-based interpolations
and their blends to each pair of subgroups will enhance the
expressive power of the formation transitions to be designed.
Our system specifies motions of individuals only by their
time-parametrized trajectories. Thus, the control of local
speed and moving style (walking or running) of each individual for realistic behavior, highly relies on a trajectorydriven motion synthesis scheme used in a postprocessing
stage. However, the online locomotion synthesis employed
here [KS07] can produce a visually-plausible behavior for
each individual, provided that the temporal samples taken
from the corresponding trajectory are almost uniformly
spaced in 3D space, as demonstrated in Figures 1, 10, and
11. Although our approach focuses on formation control in
unconstrained environments, handling static obstacles, such
as houses and walls, also as graph vertices can allow us to
simulate the specific clearance between the obstacles and individuals together with the appropriate setting of associated
adjacency weights. More aggressive splitting and merging of
formation clusters will simulate more natural collective behaviors of individuals as seen in flocks of birds and schools
of fishes. This will be accomplished by appropriately controlling the adjacency weights between the subgroups at the
same depth in the hierarchical representation of the overall
formation.
6. Conclusion
This paper has presented an approach to group formation
control using the spectral graph theory, based on the intuition that the adjacency relationships among the individuals play a significant role in group formations as observed
in artistic formations of mass performances and the tactical
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

formations of team sports. The main idea behind this approach is to extract the spectral-based structures of group
formations, which is achieved through the Laplacian matrices of the graph associated with their adjacency relationships
among individuals. The interpolation between group formations is obtained by rotational transformations of eigenbases
for the Laplacian matrices in order to change the collective
behaviors of individuals smoothly over time. Our spectralbased approach can be enhanced with several extended features. Animation results are generated to demonstrate the capabilities of the present approach.
Our future extensions include semi-automatic individual
matching between multiple formations, which will be helpful for efficient design of group formation animation. It
would be interesting to apply this approach to other problems such as the control of satellite constellations and animation of time-varying relationships in the context of information visualization. Controlling formations in environments
with obstacles are also important potential applications of
this approach. We also leave it as future work to enhance our
framework by explicitly incorporating ideas from existing
approaches including rule-based and force-field-based models.

Acknowledgements
The video of the marching performance for Figure 1 is courtesy of Yutaka Midorikawa and Yuji Takahashi of Kashiwa
Municipal High School. We would like to thank Hisaki
Niikura for his help in developing the early version of
this work, and anonymous reviewers for valuable comments. This work was partially supported by Grants-in-Aid
for Scientific Research (B) (20300033) and Research Fellows (2010836) of Japan Society of the Promotion of Science (JSPS), Casio Science Promotion Foundation, the IT
R&D program of MKE/IITA (2008-F-033-01), the Korea
Research Foundation (KRF-2006-311-D00190), and the Research Grant of Kwangwoon University in 2008.

References
[BA98] BALCH T., A RKIN R. C.: Behavior-based formation control for multirobot teams. IEEE Trans. Robotics and Automation
14 (1998), 926–939.

648

S. Takahashi, K. Yoshida, T. Kwon, K. H. Lee, J. Lee & S. Y. Shin / Spectral-Based Group Formation Control

Table 1: Statistics of the group formations in the animation examples.

Marching band
Soccer
Human figures
Airshow

# of
levels
2
2
3
1

# of
individuals
25
14
1260
10

structure of
the entire formation
= 3 + 5 + 5 + 5 + 4 + 3 (6 groups)
= 6(offense) + 8(defense) (2 groups)
= 35(groups) × 6(subgroups) × 6(individuals)
= 10 (airplanes at one level)

[BH97] B ROGAN D. C., H ODGINS J. K.: Group behaviors for
systems with significant dynamics. Autonomous Robots 4 (1997),
137–153.
[BMdB03] B RAUN A., M USSE S. R., DE O LIVEIRA L. P. L.,
B ODMANN B. E. J.: Modeling individual behaviors in crowd
simulation. In Proc. Computer Animation and Social Agents
2003 (2003), pp. 143–148.

# of
frames
1211
238
991
540

computation times
(cf. [KS07])
11 seconds
14 seconds
445 seconds
NA (in real time)

[LCF05] L AI Y., C HENNEY S., FAN S.: Group motion graphs.
In Proc. Symp. Computer Animation 2005 (2005), pp. 281–290.
[LCHL07] L EE K. H., C HOI M. G., H ONG Q., L EE J.: Group
behavior from video: A data-driven approach to crowd simulation. In Proc. Symp. Computer Animation 2007 (2007), pp. 109–
118.

[CC07] C OURTY N., C ORPETTI T.: Crowd motion capture. Computer Animation and Virtual Worlds 18 (2007), 361–370.

[LCL07] L ERNER A., C HRYSANTHOU Y., L ISCHINSKI D.:
Crowds by example. Computer Graphics Forum 26 (2007), 655–
664.

[CH03] C ARCASSONI M., H ANCOCK E. R.: Spectral correspondence for point pattern matching. Pattern Recognition 36 (2003),
193–204.

[LKF05] L AKOBA T. I., K AUP D. J., F INKELSTEIN N. M.:
Modifications of the Helberg-Molnár-Farkas-Vicsek social force
model for pedestrian evolution. Simulation 81 (2005), 339–352.

[Che04] C HENNEY S.: Flow tiles. In Proc. Symp. Computer Animation 2004 (2004), pp. 233–242.

[LT97] L EWIS M. A., TAN K.-H.: High precision formation control of mobile robots using virtual structures. Autonomous Robots
4 (1997), 387–403.

[Chu97] C HUNG F. R. K.: Spectral Graph Theory. American
Mathematical Society, 1997.
[CR74] C ATMULL E., ROM R.: A class of local interpolating
splines. In Computer Aided Geometric Design, Barnhill R. E.,
Reisenfeld R. F., (Eds.). Academic Press, 1974, pp. 317–326.
[DB76] D ENMAN E. D., B EAVERS J R . A. N.: The matrix sign
function and computations in systems. Applied Mathematics and
Computations 2 (1976), 63–94.
[FTT99] F UNGE J., T U X., T ERZOPOULOS D.: Cognitive modeling: Knowledge, reasoning and planning for intelligent characters. In Proc. Siggraph ’99 (1999), pp. 29–38.
[GKM∗ 01] G OLDENSTEIN S., K ARAVELAS M., M ETAXAS D.,
G UIBAS L., A ARON E., G OSWAMI A.: Scalable nonlinear dynamical systems for agent steering and crowd simulation. Computers & Graphics 25 (2001), 983–998.
[HM95] H ELBING D., M OLNÁR P.: Social force model for
pedestrian dynamics. Pysical Review E 51 (1995), 4282–4286.
[Hug03] H UGHES R. L.: The flow of human crowds. Annual
Review of Fluid Mechanics 35 (2003), 169–182.
[KG00] K ARNI Z., G OTSMAN C.: Spectral compression of mesh
geometry. In Proc. Siggraph 2000 (2000), pp. 279–286.
[KLLT08] K WON T., L EE K. H., L EE J., TAKAHASHI S.: Group
motion editing. ACM Trans. Graphics 27 (2008). Article 80.
[Kor03] KOREN Y.: On spectral graph drawing. In Proc. Int’l
Computing and Combinatorics Conf. 2003 (LNCS 2697) (2003),
Springer-Verlag, pp. 496–508.
[KPS03] K IM T.-H., PARK S. I., S HIN S. Y.: Rhythmic-motion
synthesis based on motion-beat analysis. ACM Trans. Graphics
22 (2003), 392–401.
[KS07] K WON T., S HIN S. Y.: A steering model for on-line locomotion synthesis. Computer Animation and Virtual Worlds 18,
4-5 (2007), 463–472.
[LC03] L I T.-Y., C HOU H. C.: Motion planning for a crowd of
robots. In Proc. IEEE Int’l Conf. on Robotics and Automation
2003 (2003), pp. 4215–4221.

[MT01] M USSE S. R., T HALMANN D.: Hierarchical model for
real time simulation of virtual human crowds. IEEE Trans. Visualization and Computer Graphics 7 (2001), 152–164.
[OMT02] O HBUCHI R., M UKAIYAMA A., TAKAHASHI S.: A
frequency-domain approach to watermarking 3D shapes. Computer Graphics Forum 21 (2002), 373–382.
[PAB07] P ELECHANO N., A LLBECK J. M., BADLER N. I.: Controlling individual agents in high-density crowd simulation. In
Proc. Symp. Computer Animation 2007 (2007), pp. 99–108.
Adventures in robot path planning.
[Per] P ERLIN K.:
http://mrl.nyu.edu/ perlin/experiments/path/.
[PPD07] PARIS S., P ETTRE J., D ONIKIAN S.: Pedestrian reactive navigation for crowd simulation: a predictive approach.
Computer Graphics Forum 26 (2007), 665–675.
[Rey99] R EYNOLDS C. W.: Steering behaviors for autonomous
characters. In Proc. Game Developers Conf. ’99 (1999), pp. 763–
782.
[Sho85] S HOEMAKE K.: Animating rotation with quaternion
curves. In Proc. Siggraph ’85 (1985), pp. 245–254.
[SKG05] S UNG M., KOVAR L., G LEICHER M.: Fast and accurate goal-directed motion synthesis for crowds. In Proc. Symp.
Computer Animation 2005 (2005), pp. 291–300.
[SM00] S HI J., M ALIK J.: Normalized cuts and image segmentation. IEEE Trans. Pattern Analysis and Maching Intelligence 22
(2000), 888–905.
[SMK05] S AKUMA T., M UKAI T., K URIYAMA S.: Psychological model for animating crowded pedestrians. Computer Animation and Virtual Worlds 16 (2005), 343–351.
[ST05] S HAO W., T ERZOPOULOS D.: Autonomous pedestrians.
In Proc. Symp. Computer Animation 2005 (2005), pp. 19–28.
[Tau95] TAUBIN G.: A signal processing approach to fair surface
design. In Proc. Siggraph ’95 (1995), pp. 351–358.
[TCP06] T REUILLE A., C OOPER S., P OPOVI C´ Z.: Continuum
crowds. ACM Trans. Graphics 25 (2006), 1160–1168.

c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.


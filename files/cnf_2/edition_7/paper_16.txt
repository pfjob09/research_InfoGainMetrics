Volume 28 (2009), Number 2

EUROGRAPHICS 2009 / P. Dutré and M. Stamminger
(Guest Editors)

Temporal Glare: Real-Time Dynamic Simulation of the
Scattering in the Human Eye
T. Ritschel1

M. Ihrke2
1 MPI

3 Technical

J. R. Frisvad3

Informatik
University of Denmark

J. Coppens4

2 Bernstein

K. Myszkowski1

H.-P. Seidel1

Center for Computational Neuroscience, Göttingen
Institute for Neuroscience / KNAW

4 Netherlands

Abstract
Glare is a consequence of light scattered within the human eye when looking at bright light sources. This effect
can be exploited for tone mapping since adding glare to the depiction of high-dynamic range (HDR) imagery on
a low-dynamic range (LDR) medium can dramatically increase perceived contrast. Even though most, if not all,
subjects report perceiving glare as a bright pattern that fluctuates in time, up to now it has only been modeled
as a static phenomenon. We argue that the temporal properties of glare are a strong means to increase perceived
brightness and to produce realistic and attractive renderings of bright light sources. Based on the anatomy of the
human eye, we propose a model that enables real-time simulation of dynamic glare on a GPU. This allows an
improved depiction of HDR images on LDR media for interactive applications like games, feature films, or even
by adding movement to initially static HDR images. By conducting psychophysical studies, we validate that our
method improves perceived brightness and that dynamic glare-renderings are often perceived as more attractive
depending on the chosen scene.
Categories and Subject Descriptors (according to ACM CCS): COMPUTER GRAPHICS [I.3.7]: Three-Dimensional
Graphics and Realism—; COMPUTER GRAPHICS [I.3.3]: Color, Shading, Shadowing and Texture—

1. Introduction
Glare effects are typical in any optical system used for capturing an image with directly visible bright light sources,
caustics, or highlights. Glare is common in our everyday
observation of the real world because light scatters in the
human eye. Effectively, instead of having a crisp projected
image of bright objects on the retina, surrounding regions
are affected by scattered light. This leads, among other effects, to local contrast reduction (also called the veiling effect
or disability glare). While this is often an unwanted effect
in photography [RAWV08], we can exploit it for displaying HDR-content on LDR-devices. When a veiling pattern
is painted on the image (as a gradient surrounding the light
source), the corresponding retinal image is similar to the observation of a real bright object and is thus interpreted by the
human brain as brighter [YIMS08]. This effect has been used
by artists for centuries to improve apparent dynamic range
of their paintings, and it is just as attractive today in a digital
imaging context.
A typical glare pattern for a small light source as perceived
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

by most subjects with normal eyes is depicted in Fig. 1, but
the actual appearance of the glare varies with viewing conditions and observers. In general the effects of glare can be
divided into bloom, a general loss of contrast in the surroundings of the retinal image of the light-source (veil), and flare
which comprises the ciliary corona (the sharp needles) and
the lenticular halo surrounding the light [SSZG95]. Although
it cannot be reproduced in static images on paper, people
usually report that the glare pattern fluctuates in a fluid-like
motion when observed under real world conditions. Additionally, flickering of the fine needles forming the cilliary corona
is readily observable and many people perceive a pulsation
of the glare intensity. While these effects are striking, glare
has previously only been modeled as a static phenomenon.
The dynamics we discuss do not occur for cameras but only
for eyes. In traditional animation, dynamic glare effects are
used for artistic effect.
In this work we investigate temporal aspects of glare appearance and perform simulation of light scattering within the
eye based on Fourier optics for high fidelity glare rendering.

184

Ritschel et al. / Temporal Glare: Real-Time Dynamic Simulation of the Scattering in the Human Eye

image with relatively simple filters used in glare models
[SSZG95, Kaw05]. Precise information about the intensity
values of light sources and highlights represented by such pixels is immediately available in 3D image synthesis and HDR
photography [RWPD05]. For physically based rendering and
photometrically calibrated cameras, such pixel intensity can
even be properly scaled in cd/m2 units, which is important for
faithful modeling of light scattering in the eye.

Figure 1: Glare effect rendered for a point source using our
model. The colorful ring is called the lenticular halo; the fine
radiating needles constitute the ciliary corona.

Our goal is not only to render glare realistically with real-time
performance, but also to show that by better mimicking the
real world experience the image brightness impression and
overall perceived quality can be improved. Specific contributions of this work are as follows:
• We develop a model for light scattering in the human eye
based on wave-optics. This includes temporal characteristics of major anatomical structures contributing to glare
(Section 3).
• We efficiently map this model to current GPU architectures
and achieve real time performance (Section 5).
• We perform psychophysical studies to measure the perceived brightness and preference for static and dynamic
glare models (Section 6.1).
Following previous work in Section 2, we present our
eye model in Section 3, describe its scattering computation
in Section 4 and its GPU implementation in 5. We present
results in Section 6 before concluding in Section 7.
2. Previous Work
The modeling of glare effects has been used to improve image
realism and to convey an impression of high intensity of luminaires in the context of realistic rendering [SSZG95], driving simulation [NKON90], computer games [Kaw05], image
post-processing [Rok93], and tone mapping [LRP97, DD00].
A recent perceptual study [YIMS08] demonstrates that the
impression of displayed image brightness can be increased
by over 20% by convolving high intensity pixels in the

The majority of existing approaches to computer-generated
glare, while inspired by knowledge about human eye anatomy
and physiology, are based on phenomenological results rather
than explicit modeling of the underlying physical mechanisms. A common approach is to design convolution filters,
which reduce image contrast in the proximity of glare sources
up to full image saturation in the glare center. Nakamae et
al. [NKON90] derive such a filter to model the light diffraction on the eye pupil and eyelashes for various wavelengths.
Spencer et al. [SSZG95] base their filter on the point-spread
function (PSF) measured for the optics of the human eye.
Glare solutions used in tone mapping [LRP97, DD00] are
mostly based on Spencer et al.’s approach. A set of Gaussian
filters with different spatial extent, when skillfully applied,
may lead to very convincing visual results. This approach
is commonly used in computer games [Kaw05] and rendering post-production [RWPD05, Section 9.2.5]. Other glare
effects such as the ciliary corona and the lenticular halo are
often designed off-line, and placed in the location of the
brightest pixel for each glare source as a billboard (image
sprite) [Rok93, SSZG95]. In the designing of such billboards,
seminal opthalmology references are used such as [Sim53].
The resulting appearance is very realistic for small point-like
glare sources. However, using billboards, it is difficult to realistically render glare for glare sources of arbitrary shape and
non-negligible spatial extent.
Recently, there have been some successful attempts to
model glare based on the principles of wave optics. Kakimoto et al. [KMN∗ 04] propose a practical model to simulate
scattering from a single plane rigid aperture. Three diffractioncausing obstacles: the eyelashes, the eyelids, and the pupil
edge are placed in this plane. The Fraunhofer diffraction formula is then used to determine the diffraction pattern of the
obstacle-plane on the retina. This pattern is stored as a billboard, placed at high-intensity pixels and blended with the
rendered image. Similarly, van den Berg et al. [vdBHC05]
describe glare as diffraction by particles in the lens. By computing this pattern for multiple wavelengths, they achieve the
first physical simulation of the ciliary corona.
To our knowledge, the present work is the first to consider
a dynamic eye model that enables us to simulate the temporal
fluctuations of glare. Our model is also more complete with
respect to existing static models by considering all significant
contributions to light scattering in the eye. As an example,
we model light scattering on particles in the lens nucleus and
vitreous humor as well as the grating-like fiber structure in
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

185

Ritschel et al. / Temporal Glare: Real-Time Dynamic Simulation of the Scattering in the Human Eye

the lens cortex (cf. Fig. 2). These greatly contribute to the
ciliary corona and the lenticular halo (cf. Fig. 1), but they are
ignored by Kakimoto et al.
3. A Dynamic Human Eye Model for Glare
In this section we propose a time-dependent human eye model
that is suitable for real-time computation of plausible dynamic glare. We will outline anatomical and physiological
characteristics of all parts of the eye that contribute to the
light-scattering characteristics of glare. Furthermore, we discuss dynamics shown by these anatomical structures and
incorporate their characteristics in our model. Fig. 2 is a
schematic diagram of the human eye. From front to back the
optically important parts are the cornea, the aqueous humor,
the iris and pupil, the lens, the vitreous humor, and the retina.
Table 1 summarizes their contribution to scattering, whether
they show temporal fluctuations, and whether we include
them in our model or not. Multiple scattering is relatively
unimportant with respect to glare [vdB95], and, in single
scattering, only the light scattered in the forward direction
will reach the sensory system. We will therefore only consider forward scattering in the present work. There are large
differences between individual eyes and hence in how glare
is perceived by different subjects. In this work, we will use
data obtained from studies of the normal healthy eye to fit
our model.
✍✝✎ ✂☎✁✡☛
✏✡✠✁✂

✌☎✄☛ ✄✡☞✞☎✡☛
✌☎✄☛ ☞✁✂✎ ☎✓

✙✂✝☛
✗✘✡☎✁✡☛
✏✡✠✁✂

✔✝✕☎✂☛

✌✝✖ ✏✎

 ✁✂✄☎✆
✑☎✒ ✄✆

✌☎✄☛
 ✝✞✝✆✂✟
✠✡☛☞✞☎☛

Figure 2: Anatomy of the human eye. The upper-right inset
shows the lens structure.

3.1. The Cornea
The main part of the cornea is formed by collagen fibrils
which are densely packed, regularly arranged, cylindrically
shaped particles [FMF86]. This special arrangement of the fibrils ensures that they are almost transparent [Ben71]. Between
the fibrils there is a transparent ground substance, and a few
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

Eye part
Eyelashes [KMN∗ 04]
Cornea [VB63, BC64]
Aqueous humor [WS82]
Lens [YYG∗ 93]
Iris [vdBIdW91]
Pupil [Fry91]
Vitreous humor [KRFF95]
Retina [VB64]

Scatter
varies
25-30%
none
40%
≤1%
aperture
10%
20%

Dyn.
yes
no
no
yes
yes
yes
yes
no

Incl.
yes
yes
no
yes
no
yes
yes
yes

Table 1: An overview of the contribution from each part of
the eye to the glare phenomenon and to our model. From
left to right, the columns describe: the name of the structure,
its scattering (percentages refer to the fraction of the total
intraocular scattering); whether it is dynamic or not; and
whether it is included in our model or not.

flat cells are interspersed. These flat cells occupy 3–5% of the
corneal volume and they have a diameter of 15µm [FMF86].
The flat cells contribute to the glare pattern (25-30%, cf. Table 1), but the effect is static. We simulate this by having
large, sparsely distributed, static particles in our pupil plane.
3.2. The Iris and Pupil
A very small percentage (1% or less depending on eye color)
is scattered through the iris which is tinted due to absorption
[vdBIdW91]. We choose to ignore this faint straylight.
The pupil contributes important diffraction to the glare
pattern as it is the aperture of our model. The iris muscles
have the ability to control the size of the pupil. Exposition to
a glare source will typically give rise to the pupillary hippus,
an involuntary, periodic fluctuation of the pupil size. It is
presumably caused by opposing actions of the iris muscles
due to the vastly different lighting conditions of glare source
and background when attempting to adjust the pupil [MPC02].
Curves describing the pupil diameter as a function of time
for different glare source intensities have been measured by
Fry [Fry91]. We have found the following expression which
mimics these dynamics:
h(t, p) = p + noise

t
p

pmax
p

1−

p
,
pmax

(1)

where t is time (in seconds), p is the mean pupil diameter (in
mm) for a given glare source intensity, pmax is the maximum
pupil size (we use pmax = 9 mm), and noise(·) is a noise
function. It remains to map glare source intensity to the mean
pupil diameter p. We use the function proposed by Moon and
Spencer [MS44]:
p = 4.9 − 3 tanh 0.4 (log Lv + 1) ,

(2)

where Lv is the field luminance measured in cd/m2 .
The visual effect due to the pupillary hippus is a sort of
“pulsation” of the glare pattern. The effect is easily included in

186

Ritschel et al. / Temporal Glare: Real-Time Dynamic Simulation of the Scattering in the Human Eye

✞✟✠

the vitreous humor which is mostly inertia-driven. At first
we model the motion of lens particles and in the following
section we describe the vitreous particles in more detail.

✡✟✠
☛✟☛

  ✁✂✄ ☎✆✝

☞☛✟☛

Figure 3: Change of pupil size over time for 3 different adaption levels, which effectively depend on of the glare source
strength. Bright conditions result in stronger oscillations.

our glare model by changing the size of the aperture according
to Eqs. 1 and 2. In Eq. 1, value noise with three octaves
[EMP∗ 03] gave us plausible results. We use time-damped
average screen intensity to approximate the field luminance
[DD00].
3.3. The Lens
The lens is an important source of intraocular scattering as
it accounts for about 40% of the forward scattering (cf. Table 1). Close investigation of the refractive index of lens fiber
membranes [MvMVvdB02, MB06] has shown that they produce significant scattering, and that they are regularly spaced
in the lens cortex. This high spatial order of the lens fiber
lattice increases the transparency of the lens, but is also a
diffraction grating which produces the lenticular halo. The
refractive index of the fiber membranes decreases towards the
center of the lens. This is why the grating is only significant
in the lens cortex (as illustrated in the upper right corner of
Figure 2). Our wave optics model easily accounts for the light
diffraction on such a grating pattern.
Recently, the ciliary corona has been ascribed to randomly
distributed particles in the lens [vdBHC05]. Van den Berg et
al. explain the sharp needles to be the result of a seamless
alignment of scaled copies of the same diffraction pattern
originating from light of different wavelengths. However,
Hemenger [Hem92] provides some theoretical evidence that
the randomly distributed particles in the lens are too small
to produce the ciliary corona on their own. Originally, Simpson [Sim53] suggested that the ciliary corona is due to particles situated in the vitreous, whose size is comparable to the
larger particles in the lens nucleus [ASD∗ 01]. This strongly
suggests that the ciliary corona is produced by a combination
of the few larger particles of the lens nucleus together with
particles in the vitreous humor.
In this work we therefore consider both types of particles
and simulate their motion, which is argued to be the main
cause of temporal fluctuations observed in the ciliary corona.
The motion of the particles in the lens is caused by lens
deformations due to accommodative microfluctuations and
is quantitatively different from the motion of the particles in

The human lens has been extensively investigated by physiologists and recently, elaborate numerical finite-element models for the lens’ geometry were proposed [BJC02]. We use
a simplified two-dimensional deformation model, assuming
a radially symmetric lens with heuristic uniform deformation properties (spring stiffness) and a uniform discretization. We denote this deformation as f (x), a mapping from
two-dimensional coordinate x to deformed two-dimensional
coordinates. The deformation is first computed over a coarse
discrete grid using a mass-spring system (cf. Fig. 4) yielding
a discrete approximation f¯ to f . To apply f to a high number
of lens particles in the continuous three-dimensional domain
we use bi-linear interpolation from f¯. To this end, every particle stores a random x located inside the lens volume (using
rejection sampling) and a random φ, which is an angle around
the axis of symmetry. At runtime, we look up f (x) for every
particle at x in f¯ and map it from cylindrical to Cartesian
space.

Figure 4: Left: The lens deformation model simulating ciliary muscle contraction (green element, arrow). Right: Mapping of the coarse 2D deformation to smooth 3D deformation.

The accommodation system is known to exhibit temporal
variations even during fixation of a stationary stimulus which
are due to adaptations of the ciliary muscle [GWG93]. We
simulate these contractions of the ciliary muscle by moving a single element in f¯. The oscillations caused by this
reflex can be characterized by two principal components in
their power-spectrum, one low-frequency (< 0.6 Hz) and one
narrow high-frequency (between 1.3 and 2.1 Hz). Since the
low-frequency component is known to vary with pupil size
(more pronounced for larger size), we use the pupil size as
determined in Eq. 2 to set the mean power of a low-frequency
component generated with three-octave value noise according
to experimentally acquired data [GWG93]. In practice, we
use 17 × 17 elements for f¯, 750 particles of varying size, and
200 gratings.
3.4. The Vitreous Humor
The vitreous humor contributes relatively little to the glare
effect in terms of scattered light energy (cf. Table 1), and
for this reason it is often ignored in glare research. However,
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

187

Ritschel et al. / Temporal Glare: Real-Time Dynamic Simulation of the Scattering in the Human Eye

the contribution of scattering on particles in the vitreous
to the ciliary corona is clearly visible in less central (less
saturated) glare regions. This visibility is reinforced due to
temporal effects which are extremely strong attractors of
human attention especially in the visual periphery.
The vitreous humor is a slightly scattering viscoelastic
body [Zim80]. This means that external forces (head movements, saccades) act on the vitreous humor such that it accelerates, rotates and comes to rest by strong damping. We
model this behavior as a single rigid body with damped rotation dynamics, whose state is determined by angle and
angular velocity. We set the damping to approximate the measurements by Zimmermann [Zim80]. We generate damped
random forces to mimic saccades and integrate this system
using forward Euler integration. The final particles are embedded at random but fixed locations inside this rigid body and
do not move relatively to each other. Ansari et al. [ASD∗ 01]
have measured a three-dimensional map which describes the
spatial distribution of particle sizes in the bovine vitreous
which exhibits inhomogeneities similar to the human vitreous [Fan06]. The scatterers are thus modelled to have uniform
random distribution throughout the vitreous.

3.5. The Retina
There are convincing arguments that the retina contributes
to the intraocular scattering [VB64]. It is unfortunately difficult to model the retinal forward scattering directly using
a particle distribution because the particles are intermingled
with the receptor cells. To find out how the retinal scattering
affects the glare pattern, [Nav85, vdBHC05] fitted a model
to experimentally acquired glare functions [CIE99] which
measure the combined effect of all the intraocular scattering. It turned out that fewer and larger particles (compared
to measured particle sizes and frequencies) in the preretinal
parts of the eye are an excellent way to approximate the measured glare functions. For this reason, we use fewer and larger
particles in our model.

3.6. Eyelashes and Blinking
Eyelashes and blinking can result in long streaks in the glare
pattern. We model blinking in the same way as Kakimoto
et al. [KMN∗ 04] by using bitmaps of eyelids and eyelashes.
However, given our dynamic framework, we can produce
animated blinking by moving the eyelashes against the pupil.
In addition, we simulate squinting which is a normal reaction
to a strong, discomforting glare source. It decreases the retinal
illumination (and thus the discomfort) since the eyelids cut off
the aperture and the eyelashes scatter the incident illumination
[STH03]. Squinting is modeled by keeping the bitmaps closed
by a constant amount.
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

Figure 5: Schematic view of an optical system

4. Wave-Optics Simulation of Light-Scattering
To simulate the scattering at obstacles within the different
anatomical structures of the eye, we use an approach based
on wave-optics similar to [vdBHC05] and [KMN∗ 04]. Even
though the underlying theory is rather complicated, the implementation of scattering even on complex apertures is often
simple and generally boils down to taking the Fourier transform (FT) of an aperture function. Considering the human
eye as a simplified optical system (Fig. 5) with an aperture
(pupil) and a image plane (retina), we obtain the diffraction
pattern for particles and gratings within the lens and the
cornea as well as for the eyelashes by computing the incident
radiance following the Fresnel approximation to Huygen’s
principle [Goo05] given by
Li (xi , yi ) = K F {P(xp , yp )E(xp , yp )} p= xi ,q= yi
λd

2

(3)

λd

K = 1/(λd)2
π

2

2

E(xp , yp ) = ei λd (xp +yp )
for the coordinates (xi , yi ) at the retina assuming unitamplitude, homogeneous incident light. Here P(xp , yp ) is
the aperture function for the pupil, giving the opacity of each
point in the pupil (0 transparent, 1 opaque), λ is the wavelength of the light, d the distance between pupil and retina
and F denotes the Fourier transform that is evaluated at coorxi yi
dinates (p, q) = λd
, λd (for a derivation, see Appendix A).
In contrast to [KMN∗ 04] who use Fraunhofer diffraction,
we use the more general Fresnel equation which contains
Fraunhofer diffraction as a special case (we consider Fresnel
diffraction as more appropriate, due to the relatively short
distance between pupil and retina [Hec98]). In practice, the
aperture function is modified before the FT by complex multiplication with the exponential given in Eq. 3 which produced
more realistic results in our simulations (Fig. 6).
Simulating the scattering at particles in the vitreous is
more complicated because their distance to the retina varies
much more. A physically correct approach would be to compute separate Fresnel-diffraction patterns for each of these
particles (because they differ in their distance to the retina)
and add them up on an amplitude basis (J. Goodman, pers.
comm.). However, this would involve costly operations that
depend on the number of particles. Working towards a real-

188

Ritschel et al. / Temporal Glare: Real-Time Dynamic Simulation of the Scattering in the Human Eye

This helps suppressing aliasing in time and space which
would be exaggerated by the FFT. Fig. 9 shows partial PSFs
that include only subsets of our aperture model in order to
show how the individual parts contribute to the result.

Figure 6: Comparison of Fraunhofer and Fresnel diffraction
patterns. The Fresnel solution produces a more pronounced
PSF. The term E from Eq. 3 is shown in the upper right corner.

time technique, we therefore compared a single-plane (where
we project the particles in the vitreous directly into the pupilplane) with a more correct multiple-plane approach (where
we compute and add multiple diffraction patterns at different
distances). Fig. 7 gives an impression of the difference of
the two approaches. Judging the observable differences to be
negligible, we chose to implement a single-plane approach
to facilitate renderings that run in real-time even though this
constitutes a physically incorrect simplification.

Particles from the lens and the vitreous are projected orthogonally onto their aperture plane and drawn as 2D circles
of equal size and color. Our implementation uses two sets of
parameters. Static parameters encode subject-dependent variables: the number of particles, eye size and others. Dynamic
parameters are updated for every frame: the blink state, the
field luminance, the observer motion and others.
First, according to the blink state, we draw the eyelashes
and eyelids as textured quads. Next, the pupil (cf. Sec. 3.2)
is drawn as a 2D white circle on top of a black background.
The radius of this circle is computed by our hippus model
(cf. Eq. 1) using the field luminance. The next pass adds
the lens (cf. Sec. 3.3) particles. Then gratings (Sec. 3.2) are
drawn as lines of a few pixels thickness. Finally, the particles
of the vitreous humor are simulated (cf. Sec. 3.4) and drawn.
Fresnel Diffraction The Fresnel diffraction of an aperture
texture is computed in two steps. First, the aperture texture
is multiplied by the complex exponential E (from Eq. 3)
which we pre-compute and store in a static texture. Second,
a recent GPU FFT [MA03] is applied to the aperture texture
computing the F-term from Eq. 3. After final normalization
by K, the output is the monochromatic PSF Fλ .
Chromatic Blur The colorful appearance of glare can be
modeled in a simple and efficient way [vdBHC05]. We exploit, the fact that a monochromatic PSF Fλ2 at wavelength
λ2 equals another monochromatic PSF Fλ1 for wavelength λ1
whose argument is scaled by λλ1 (cf. Eqn. 3):
2

Fλ2 (x) = Fλ1
Figure 7: Single-plane (Left, 52.4 fps) and multiple-plane
diffraction (Right, 32.1 fps) are perceptually equivalent (the
difference is in the upper right corner). Using an individual
plane for every particle would require 8 s/frame.

5. Implementation
We implemented our model to run in real-time entirely on recent graphics hardware (GPUs). Despite the involved theory,
temporal glare is easily and efficiently implemented: Draw
a few basic drawing primitives, apply an FFT, and do a special kind of blur. This already constitutes a temporal glare
pipeline (cf. Fig. 8). The following paragraphs provide the
details.
Human Aperture Model We simulate the aperture of the
human pupil by drawing basic primitives into a texture. All
primitives are rendered using 2×2 or more super-sampling.

λ1
x .
λ2

This equation is only strictly true in the Fraunhofer approximation. In the more exact Fresnel approximation, we would
have to recompute the term E of Eq. 3, and thus also the
FFT, for each wavelength. To avoid an FFT per wavelength
and uphold real-time frame rates, we compute E for a single
wavelength λ1 = 575 nm (in the middle of the visual spectrum since the error is smaller the closer λ2 is to λ1 ) and
use this E for all wavelengths. The result is still a significant
improvement over Frauenhofer diffraction (which assumes
E = 1 for all λ).
We compute the spectral PSF Fs for a light with spectrum
s(λ) as a sum of n scaled copies of F575 nm as:
Fs (x) =

n−1
∑i=0 s(λi )F575 nm (xi )

nm
λi = 380 nm + i 770 nm−380
n

xi =

x

575 nm
λi

.

A fragment program computes Fs by summing n look-ups at
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

Ritschel et al. / Temporal Glare: Real-Time Dynamic Simulation of the Scattering in the Human Eye

189

Figure 8: The temporal glare pipeline. The blue arrows are GPU shaders that transform one or multiple input textures
(rectangles) into one or multiple output textures.

Figure 9: Adding scatterers from left to right. Vitreous and lens scattering looks similar, but have different dynamics.

different locations in the texture holding F575 nm . Each lookup is multiplied by the corresponding spectral value s(λi ).
We use bi-linear interpolation to read the discrete F575 nm at
continuous sample locations xi . We use XYZ color space to
represent s and Fs , and n = 32 resulted in the best tradeoff
between quality and speed. Fig. 1 shows a RGB PSF.
Convolution We convolve the output image with this RGB
PSF. This is different from previous methods, that only used
billboards composed onto single bright pixels. Using the FT
convolution theorem we compute the convolution as the multiplication of the FFT of the PSF and an FFT of the output
image. The computation is done for all RGB channels in
parallel using suitable internal texture formats. Applying a
final inverse FFT to all channels yields the HDR input image
“as seen” from our dynamic human eye model. Fig. 10 compares the convolution and billboard-based approaches. Note
that such distinct appearance of the ciliary corona needles
as shown in Figs. 1 and 10 (left) is typical for bright light
sources with angular extent below 20 minutes of arc (the
ray-formation angle [Sim53]). Larger light sources superimpose the fine diffraction patterns that constitute the needles
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

of the ciliary corona. This leads to a washing out of their
structure as shown in Fig. 10 (right). However, the temporal
glare effect is still visible because the superimposed needles
fluctuate incoherently in time.

Figure 10: PSF applied using (left, 52.4 fps) billboards and
(right, 30.2 fps) the convolution we propose. The results are
substantially different for this candle. Using convolution, the
horizontal needles of the ciliary corona blur out while the
vertical needles remain unaffected.

190

Ritschel et al. / Temporal Glare: Real-Time Dynamic Simulation of the Scattering in the Human Eye

One simple performance optimization is to pre-compute
an animation cycle of RGB PSFs or to omit the convolution
[KMN∗ 04]. Dynamic textures [SDW01] could be used to
generate a faithful billboard approximation to dynamic glare
with marginal overhead over static glare patterns e.g. for a
game. Nevertheless, we use convolution in all our results.
Final Display For final display we apply a gamma mapping (γ = 2.2). While more advanced tone mapping operators
could be used instead, we have choose this simple approach
because it gave us the most reliable and consistent results.
6. Results
Our method results in perceptual improvements as shown by
a user study (cf. Sec. 6.1) with stimuli running at real-time
frame rates (cf. Sec. 6.2).
6.1. Perceptual Study
To investigate the perceptual quality of our simulations, we
conducted a psychological study comparing the effect of
dynamic and static glare renderings in terms of realism, attractiveness and brightness. To provide a standardized setting
for the preference study, subjects were simultaneously presented with two images of the same scene where each of the
displays was either enhanced by application of dynamic or
static glare or not. All possible combinations were presented
for each scene. A range of different scenes representing divergent applications (natural images and computer-generated
scenes) was chosen to ensure external validity (cf. Fig. 11).
Subjects were asked to choose one of the two displays in a
classical two-alternative-forced-choice (2-AFC) task according to one of three instructions: they had to judge which of the
two images was brighter, more attractive or more realistic separately and in randomized order. The currently required task
was indicated above the display in each trial. 10 naïve and
paid subjects participated in the experiment and were seated
at distance of 1m from the display. Each image occupied a
visual angle of ≈ 10 vis. deg.
The study shows mixed results in terms of realism and
attractiveness (see Fig. 12). The ratings within the individual
observer were quite reliable (typically r = .8), but they show
a large inter-individual variance. This is well explained by the
fact that the glare phenomenon is a very personal experience
that differs vastly between subjects (due to varying anatomy).
This emphasizes, that a final glare rendering is never going
to be completely realistic for the whole audience and that
care should be taken to choose moderate parameter values
for optimal effects. Another moderating factor was the scene
to which the glare was applied. While the majority found
dynamic glare most attractive for “Gem” and “Trees”, it was
mostly disliked for “Park” and “Bridge” (see Fig. 11).
In the vast majority of trials, subjects reported to perceive
dynamic glare as brighter than static (χ2 = 72.2, p < .01)

and control (χ2 = 145.8, p < .01) in all scenes. Because
of the clear advantage of stronger perceived brightness for
dynamic glare-rendering that was established in our study
qualitatively, we additionally collected preliminary data from
4 subjects to quantify this effect. The psychophysical measurement of perceived glare brightness is methodologically
difficult and results in a large intra- and inter-subject variance. We therefore applied an optimized double-adjustment
method as previously proposed [YIMS08]. Subjects had to
adjust the brightness of two spots simultaneously to match
the perceived brightness of the centered target (which was
either without, with static, or with dynamic glare). The mean
value of both adjustments was used as the measured perceived
luminance of the target. Subjects performed this task for the
three different conditions (static, dynamic, control) and two
different intensities of the target glare-rendering. The results
are plotted in Fig. 12, and they show that both dynamic and
static glare produced a boost in increased brightness relative
to the control condition (F(2, 4) = 8.22, p < .05). The apparent advantage of the dynamical over the static glare rendering
is not significant due to missing statistical power.
✗✘

✙✗✗✘ ✗✘

✙✗✗✘

✢✗

 ✁✂✄☎✆
✝✞✟✆
✠✆✡
☛☞✌✍
 ✆✁✎✂✏
✑✞✁✒
✓✔✁✆✆✔
✕✁✆✆✖
✕☞✏✏✆✎

✚✣
✚✛

✜✛

Figure 12: Left: Relative frequency of decisions for dynamic
(green) and static (blue) glare. While dynamic glare is generally perceived as brighter, perceived attractiveness depends
strongly on the individual scenes. Right: Subjects were well
able to adjust the brightness to match control stimuli but
perceived a boost in brightness for static and dynamic glare.

6.2. Performance
Table 2 presents performance numbers for our technique on
an 2.4 GHz CPU with an NVIDIA GeForce 8800 GTX.
Size
256
512
1024

Aperture
5.2 ms
11.8 ms
36.5 ms

Diffraction
2.7 ms
4.8 ms
13.8 ms

Display
1.1 ms
1.8 ms
4.8 ms

Overall
9.0 ms
18.4 ms
55.1 ms

Table 2: Varying the PSF resolution and timing breakdown.
For these timings, we used 2 × 2 super-sampling of the aperture, 32 samples for the RGB PSF, and no convolution.

c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

Ritschel et al. / Temporal Glare: Real-Time Dynamic Simulation of the Scattering in the Human Eye

191

Figure 11: The nine stimuli used in the experiment. Please see the video for animated versions.

7. Conclusions
In this paper we proposed a model for the dynamics of the human eye and how they add temporal variation to the perceived
glare-pattern. The method has a solid basis in eye anatomy
and wave optics but remains practical as we demonstrate
by implementing it in real-time on recent GPU hardware. A
psychophysical study has shown that it improves perceived
brightness, suggesting its applicability in a tone-mapping
context. Since glare is a phenomenon intrinsic to the individual eye for which no ground truth can be obtained, its
validation remains a challenging task. We plan to conduct
a more detailed study, including more participants to better
understand in which conditions temporal glare is important
and where not and how individual components of our model
contribute to the final result. Future work could elaborate the
glare model, e.g. by including real-time subject information
like gaze direction.
Acknowledgements
We acknowledge the support of Thomas Van den Berg, Joseph W.
Goodman (communications), Matthias Hullin (proof reading), Rafał
Mantiuk (proof reading), Mateusz Malinowski (video textures), Tobias Penzkofer (literature), Ramesh Raskar (discussions), Thomas
Schultz (proof reading), Kaleigh Smith (proof reading) and flickr
users „kuyman” and „Face it” (images).

References
[ASD∗ 01] A NSARI R. R., S UH K. I., D UNKER S., K ITAYA N.,
S EBAG J.: Quantitative Molecular Characterization of Bovine
Vitreous and Lens with Non-invasive Dynamic Light Scattering.
Experimental Eye Research 73, 6 (2001), 859–866.
[BC64]

B OYNTON R. M., C LARKE F. J. J.: Sources of Entoptic

c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

Scatter in the Human Eye. Journal of the Optical Society of
America 54, 1 (January 1964), 110–119.
[Ben71] B ENEDEK G. B.: Theory of Transparency of the Eye.
Applied Optics 10, 3 (March 1971), 459–473.
[BJC02] B URD H., J UDGE S., C ROSS J.: Numerical modelling
of the accommodating lens. Vision Research 42, 18 (2002), 2235–
2251.
[CIE99] CIE: Collection 1999: Vision and Colour, Physical Measurement of Light and Radiation. Tech. Rep. 135–1999, Commission Internationale de l’Eclairage, 1999.
[DD00] D URAND F., D ORSEY J.: Interactive Tone Mapping. In
Proceedings of the Eurographics Workshop on Rendering Techniques 2000 (London, UK, 2000), Springer-Verlag, pp. 219–230.
[EMP∗ 03] E BERT D. S., M USGRAVE F. K., P EACHEY D., P ER LIN K., W ORLEY S.: Texturing & Modeling: A Procedural Approach, third ed. Morgan Kaufmann Publishers, 2003.
[Fan06] FANKHAUSER II F.: Dynamic Light Scattering in Ophthalmology: Results of In Vitro and In Vivo experiments. Technology
& Health Care 14, 6 (2006), 521–535.
[FMF86] F REUND D. E., M C C ALLY R. L., FARRELL R. A.:
Effects of Fibril Orientations on Light Scattering in the Cornea.
Journal of the Optical Society of America A 3, 11 (November
1986), 1970–1982.
[Fry91] F RY G. A.: The Relation of Pupil Constriction Experienced Under Discomfort Glare. In Proceedings of the First International Symposium on Glare (1991), Adrian W., (Ed.), Lighting
Research Institute, pp. 173–181.
[Goo05] G OODMAN J.: Introduction To Fourier Optics. Roberts
& Co, 2005.
[GWG93] G RAY L. S., W INN B., G ILMARTIN B.: Accommodative microfluctuations and pupil diameter. Vision Research 33, 15
(1993), 2083–2090.
[Hec98] H ECHT E.: Optics, 3rd edition ed. MA: Addison-Wesley
Publishing Company, 1998.
[Hem92] H EMENGER R.: Sources of Intraocular Light Scatter
from Inversion of an Empirical Glare Function. Applied Optics
31, 19 (July 1992), 3687–3693.

192

Ritschel et al. / Temporal Glare: Real-Time Dynamic Simulation of the Scattering in the Human Eye

[Kaw05] K AWASE M.: Practical Implementation of High Dynamic
Range Rendering. In Game Developers Conference (2005).
[KMN∗ 04] K AKIMOTO M., M ATSUOKA K., N ISHITA T., NAE MURA T., H ARASHIMA H.: Glare Generation Based on Wave
Optics. In PG ’04: Proceedings of the 12th Pacific Conference on
Computer Graphics and Applications (PG’04) (Washington, DC,
USA, 2004), IEEE Computer Society, pp. 133–142.
[KRFF95] K ÖNZ F., R ICKA J., F RENZ M., FANKHAUSER F.:
Dynamic Light Scattering in the Vitreous: Performance of the
Single-Mode Fiber Technique. Optical Engineering 34, 8 (August
1995), 2390–2395.
[LRP97] L ARSON G. W., RUSHMEIER H., P IATKO C.: A Visibility Matching Tone Reproduction Operator for High Dynamic
Range Scenes. IEEE Transactions on Visualization and Computer
Graphics 3 (1997), 291–306.
The FFT on a
[MA03] M ORELAND K., A NGEL E.:
GPU.
In HWWS ’03: Proceedings of the ACM SIGGRAPH/EUROGRAPHICS conference on Graphics hardware
(Aire-la-Ville, Switzerland, Switzerland, 2003), Eurographics Association, pp. 112–119.
[MB06] M ICHAEL R., BARRAQUER R. I.: Refractive Index of
Lens Fiber Membranes in Different Parts of the Crystalline Lens:
Impact on Lens Transparency. Nova Science Publishers, Inc.,
2006, ch. 7, pp. 167–181.
[MPC02] M URRAY I. J., P LAINIS S., C ARDEN D.: The Ocular
Stress Monitor: A New Device for Measuring Discomfort Glare.
Lighting Research & Technology 34, 3 (2002), 231–242.
[MS44] M OON P., S PENCER D. E.: On the Stiles-Crawford Effect.
Journal of the Optical Society of America 34, 6 (June 1944), 319–
329.
[MvMVvdB02] M ICHAEL R., VAN M ARLE J., V RENSEN G. F.,
VAN DEN B ERG T. J.: Refractive Index of Lens Fiber Membranes
in Different Parts of the Crystalline Lens. In Proceedings of SPIE
(June 2002), vol. 4611, pp. 159–164.
[Nav85] NAVARRO R.: Incorporation of Intraocular Scattering in
Schematic Eye Models. Journal of the Optical Society of America
A 2, 11 (1985), 1891–1894.
[NKON90] NAKAMAE E., K ANEDA K., O KAMOTO T., N ISHITA
T.: A Lighting Model Aiming at Drive Simulators. In SIGGRAPH
’90: Proceedings of the 17th annual conference on Computer
graphics and interactive techniques (New York, NY, USA, 1990),
ACM, pp. 395–404.
R ASKAR R., AGRAWAL A., W ILSON C. A., V EER ARAGHAVAN A.: Glare Aware Photography: 4D Ray Sampling

[RAWV08]

for Reducing Glare Effects of Camera Lenses. ACM Trans. Graph.
27, 3 (2008), 1–10.
[Rok93] ROKITA P.: A Model for Rendering High Intensity Lights.
Computers & Graphics 17, 4 (1993), 431–437.
[RWPD05] R EINHARD E., WARD G., PATTANAIK S., D EBEVEC
P.: High Dynamic Range Imaging: Acquisition, Display, and
Image-Based Lighting. Morgan Kaufmann Publishers Inc., San
Francisco, CA, USA, 2005.
[SDW01] S OATTO S., D ORETTO G., W U Y. N.: Dynamic textures. In International Journal of Computer Vision (2001), pp. 439–
446.
[Sim53] S IMPSON G.: Ocular Haloes and Coronas. Br. J. Ophthalmol. 37, 8 (1953), 450–486.
[SSZG95] S PENCER G., S HIRLEY P., Z IMMERMAN K., G REEN BERG D. P.: Physically-Based Glare Effects for Digital Images.
Computer Graphics 29, Annual Conference Series (1995), 325–
334.

[STH03] S HEEDY J. E., T RUONG S. D., H AYES J. R.: What
are the visual benefits of eyelid squinting? Optometry and Vision
Science 80, 11 (2003), 740–744.
[VB63] VOS J. J., B OOGAARD J.: Contribution of the Cornea to
Entoptic Scatter. Journal of the Optical Society of America 53, 7
(July 1963), 869–873.
[VB64] VOS J. J., B OUMAN M. A.: Contribution of the Retina to
Entoptic Scatter. Journal of the Optical Society of America 54, 1
(1964), 95–100.
[vdB95] VAN DEN B ERG T. J. T. P.: Analysis of intraocular
straylight, especially in relation to age. Optometry and Vision
Science 72, 2 (1995), 52–59.
[vdBHC05] VAN DEN B ERG T. J. T. P., H AGENOUW M. P. J.,
C OPPENS J. E.: The Ciliary Corona: Physical Model and Simulation of the Fine Needles Radiating from Point Light Sources.
Investigative Ophthalmology and Visual Science 46 (2005), 2627–
2632.
[vdBIdW91] VAN DEN B ERG T. J. T. P., IJ SPEERT J. K.,
DE WAARD P. W. T.: Dependence of Intraocular Straylight on
Pigmentation and Light Transmission Through the Ocular Wall.
Vision Research 31, 7-8 (1991), 1361–1367.
[WS82] W YSZECKI G., S TILES W. S.: Color Science: Concepts
and Methods, Quantitative Data and Formulae, second ed. John
Wiley & Sons, Inc., 1982.
[YIMS08] YOSHIDA A., I HRKE M., M ANTIUK R., S EIDEL H.P.: Brightness of Glare Illusion. In Proceedings of ACM Symposium on Applied Perception in Graphics and Visualization (Los
Angeles, CA, USA, 2008), ACM, pp. 83–90.
[YYG∗ 93] Y UAN R., YAGER D., G UETHLEIN M., O LIVER G.,
K APOOR N., Z HONG R.: Controlling Unwanted Sources of
Threshold Change in Disability Glare Studies: A Prototype Apparatus and Procedure. Optometry & Vision Science 70, 11 (1993),
976–981.
[Zim80] Z IMMERMAN R. L.: In Vivo Measurements of the Viscoelasticity of the Human Vitreous Humor. Biophysical Journal
29, 3 (March 1980), 539–544.

Appendix A: Derivation of the Fresnel Approximation
One way to derive the Fresnel approximation is using Huygen’s
principle, which states that a wavefront can be extended by assuming
an infinite number of wave-emitters along the wavefront. Assuming
the setup in Fig. 5, the intensity of the light in the image plane
ui (xi , yi ) is expressed as a double integral over the light incident on
the pupil u p (x p , y p ) where a new harmonic, spherical wave is emitted
at each point
d
exp (ikr)
up (xp , yp )
dxp dyp ,
iλ P
r2
where d is the distance between the pupil and image planes, r is the
distance to the source, P the pupil-area over which is integrated, and
k = 2π/λ is the wave number. The Fresnel approximation follows if
r is substituted by the first terms of its binomial expansion such that
the terms under the integral can be rearranged and expressed as the
Fourier transform (FT) of the product of the pupil function and the
complex exponential. Assuming unit-amplitude, homogeneous light,
we have:
ui (xi , yi ) =

ui (xi , yi ) = −

ik 2
(xi + y2i ))
i exp(ikd) exp( 2d

λd

F {P(xp , yp )E(xp , yp )}

Because we are interested in radiance Li (xi , yi ) = |ui (xi , yi )|2 , the
term in front of the FT becomes a constant, yielding Eq. 3.

c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.


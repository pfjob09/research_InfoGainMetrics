DOI: 10.1111/j.1467-8659.2010.01835.x

COMPUTER GRAPHICS

forum

Volume 30 (2011), number 1 pp. 113–125

CheckViz: Sanity Check and Topological Clues for Linear
and Non-Linear Mappings
Sylvain Lespinats1 and Micha¨el Aupetit2
1 CEA

INES, Solar Systems Laboratory (L2S), BP 332, 50 avenue du Lac L´eman, F-73377 Le-Bourget-du-lac, France
LIST, Information, Models and Machine Learning Laboratory (LIMA), F-91191 Gif-sur-Yvette, France
{sylvain.lespinats, michael.aupetit}@cea.fr

2 CEA

Abstract
Multidimensional scaling is a must-have tool for visual data miners, projecting multidimensional data onto a
two-dimensional plane. However, what we see is not necessarily what we think about. In many cases, end-users
do not take care of scaling the projection space with respect to the multidimensional space. Anyway, when using
non-linear mappings, scaling is not even possible. Yet, without scaling geometrical structures which might appear
do not make more sense than considering a random map. Without scaling, we shall not make inference from
the display back to the multidimensional space. No clusters, no trends, no outliers, there is nothing to infer
without first quantifying the mapping quality. Several methods to qualify mappings have been devised. Here, we
propose CheckViz, a new method belonging to the framework of Verity Visualization. We define a two-dimensional
perceptually uniform colour coding which allows visualizing tears and false neighbourhoods, the two elementary
and complementary types of geometrical mapping distortions, straight onto the map at the location where they
occur. As examples shall demonstrate, this visualization method is essential to help users make sense out of the
mappings and to prevent them from over interpretations. It could be applied to check other mappings as well.
Keywords: multidimensional data, non-linear mapping, multidimensional scaling, evaluation, quality visualization.
ACM CCS H.3.3 Information Search and Retrieval; H.3.4 Systems and Software, Performance evaluation (efficiency and effectiveness); I.4.7 Feature Measurement

Since Torgerson’s ‘embedding theorem’ [Tor52], distance
preservation is the objective of most of mapping methods.
Indeed, the goal of Principal Component Analysis (PCA)
[Jol02, Pea01] is equivalent to look for the linear projection that preserves Euclidean distances at best in terms of
the mean-square-error criterion. PCA belongs to the family
of linear projection techniques such as Projection Pursuit
[FT74] and the Grand Tour [Asi85]. The Togerson’s Classical MDS consists in mapping data points from a distance
matrix. Both the PCA of a set of normalized vector items,
and the Classical MDS of the Euclidean distance matrix of
these same items, provide the same set of data points up to
an isometry [Gow66].

1. Introduction
1.1. Multidimensional scaling
Mapping methods are generally designed to display data from
a high-dimensional original space into a low-dimensional
projection space. Such methods reduce the data dimensionality, and can be used to visualize the spatial organization of
the data set, as a pre-processing to escape from the curse of
dimensionality phenomenon [Don00, AHK01] or to embed
data from a metric space to a Euclidean vector space. Mapping methods can be used to unfold the data set’s underlying
manifold. In the sequel, ‘items’ denote original data and ‘data
points’ denote their mapping into the projection space.

c 2010 The Authors
Computer Graphics Forum c 2010 The Eurographics
Association and Blackwell Publishing Ltd. Published by
Blackwell Publishing, 9600 Garsington Road, Oxford OX4
2DQ, UK and 350 Main Street, Malden, MA 02148, USA.

113

114

S. Lespinats & M. Aupetit / CheckViz: Sanity Check and Topological Clues for Linear and Non-Linear Mappings

In that framework, many methods have been designed to
especially account for small distances, leading to non-linear
mappings. There are a large number of such methods known
as non-linear multidimensional scaling (NL-MDS).
In this work, we focus on some typical NL-MDS methods which are prone to exhibit specific types of mapping
distortions, providing various enough examples to demonstrate our claims. Sammon’s Non Linear Mapping (NLM)
[Sam69] and Demartines et al.’s Curvilinear Component
Analysis (CCA) [DH97] minimize the difference between
distances in the input and projection spaces, weighted by a
decreasing function of the input or projection distances, respectively. Lespinats et al.’s Data Driven High-Dimensional
Scaling (DD-HDS) [LVG∗ 07] makes a combination of both
NLM and CCA weighting functions. Tenenbaum et al.’s
ISOMAP [TSL00] computes the geodesic distance matrix
of the data estimated by the length of shortest paths [Dij59]
in the K-nearest neighbour graph of the items, and uses Classical MDS to map this distance matrix. Notice that NLM,
CCA and DD-HDS mapping results depend on the initial
position of the data points often set randomly, whereas PCA
and ISOMAP provide a unique mapping solution.
1.2. Mapping distortions
Several recent papers [Aup07, LVG∗ 07, VK06] highlight two
types of distortions which may occur when mapping items.
A ‘false neighbourhood’ occurs when a large distance in the
original space becomes a small distance in the projection
space (data points are neighbours whereas respective items
are not). Reciprocally, a ‘tear’ occurs when a small distance in
the original space becomes a large distance in the projection
space (true neighbours are mapped far apart). Tears and false
neighbourhoods define two elementary and complementary
Original data

types of distortions formally distinguished by the sign of the
difference between the items’ pair-wise original distance and
their respective data points’ projection distance. Both these
types are sufficient to describe the full spectrum of possible
distortions involved by the difference between two distances.
However, a single data point having several neighbours defined up to some scaling parameter, may involve both types
of distortions simultaneously (Figure 1C).

1.3. Why visualizing distortions is necessary
In general, mapping distortions cannot be avoided because
the topological structure of the items does not match necessarily the topology of the projection space, for example
mapping a sphere onto a plane. Eventually, the mapping
method itself is not a good one, or gets stuck into a local optimum of the stress function it attempts to optimize. So tears
and false neighbourhoods are likely to be present without
being noticed as shown in the Figure 2. The main problem is
that false neighbourhoods tend to collapse actually distinct
structures whereas tears tend to separate actually connected
structures, introducing mapping discontinuities. Therefore,
when such distortions occur, unveiling distorted areas should
be a primary goal to avoid over-interpretation and wrong
inference about the original items’ structure.
Indeed, a way to give a global ‘scale’, that is a meaningful
link to known information, to the data points’ relative positions, is to project into the same space the unit vectors of
the original space, but this is only possible for items given
as elements of a vector space. Even in such a case, as far
as the projection is non-linear, the axes of the projection
space have no meaning, no straightforward relationship with
the original vector space because a unit item vector in the

Map A
Tear

Map B
False neighborhood

Map C
False neighborhood
& Tear

Figure 1: Examples of the different types of distortions relative to the item marked as a star, whose original true neighbours
are depicted as triangles. The large circle corresponds to the range of influence of the star item (see Section 3.1 for more
details). The original data (top left) mapped with a tear (original neighbours mapped far apart) (A), with a false neighbourhood
(mapping neighbours originally far apart) (B) and with both types of distortions at the same place (C).
c 2010 The Authors
Computer Graphics Forum c 2010 The Eurographics Association and Blackwell Publishing Ltd.

115

S. Lespinats & M. Aupetit / CheckViz: Sanity Check and Topological Clues for Linear and Non-Linear Mappings
5

PCA

Isomap

5

5

5

5

NLM

DD-HDS

CCA

Figure 2: Several 2-dimensional mappings of the same originally 3-dimensional data not displayed on purpose. What really
can we infer about the original structure of the items based solely upon these single mappings?
original space projects in a visually unpredictable manner
onto the map depending on its original location.
However, as in Figure 2, many users do not take care
about ‘scaling’ the projection space even when they can. As
a consequence, when clusters of data points eventually appear, their existence in the original space is taken for granted
without measuring how much their cause is distributed
throughout the original item structure which is intended
to be discovered, and the mapping itself which is prone to
distortions.
Linking the views is not a relevant way out because as far
as no scale is provided, there is no more sense in a map obtained with any state-of-the-art non-linear mapping method
than in a map obtained using random scattering of the data
points. One would not consider useful linking a random scatter plot to another one nor to any insightful scaled projection,
in an attempt to extract new information. So is the case with
non-linear mappings. To make this issue even more conspicuous, we invite the reader to convince himself/herself that
the naked scatter plot itself he/she is used to looking at, bears
objectively no more information about the original items’
structures than a random projection despite whatever point
patterns his/her eyes is prone to see.
Here we make this issue more formal. A mapping transforms the original (N,N) distance matrix D into an estimate
D∗ of it under topological constraints (connectedness and dimensionality) driven by the projection space. The projection
space displays D∗ without distortion (up to the rendering and
perceptual distortions which may occur beyond that stage in
the visualization pipeline) as a scatter plot of N data points.
Thus, visually inferring some information about D from this
scatter plot showing D∗ is idle if any minimal information
about D, like the estimation error matrix (D−D∗ ) is not provided too. But displaying the elements of this error matrix
where they should be so, that is together with the elements
of D∗ onto the map itself, is still a big visualization challenge. Indeed, as pointed out by one of the authors [Aup07],
there is N(N−1)/2 error values to display in the vicinity of
N data points only, a setting which has not been discussed
by Wittenbrink et al. [WPL95] when they defined the Verity

Visualization framework. The visualization methods which
belong to this framework visualize together in the same space
both the data and their uncertainty, providing a consistent and
self-contained view of the data. In this work, the uncertainty
does not deal with the absolute position of each single data
point but with the relative distance between each pair of data
points.
This work is an attempt to take up this challenge. We
describe CheckViz: a new method to check visually the local
quality of mappings and to characterize distortions when
they exist. In this way, the mapping becomes usable as it
makes inference possible from the projection space about
the original structure in areas where the mapping is shown to
be clear from any distortions.
1.4. Paper outline and contribution
In Section 2, we review the state of the art methods to visualize mapping distortions. In Section 3, we present the CheckViz method. We compare the CCA and NLM methods, both
of which map data points onto a plane while attempting to
preserve their relative distances. We derive two criteria to
measure the tears and false neighbourhoods local mapping
distortions from their respective stress functions. Then we
propose CheckViz as a visualization technique to display
these criteria straight onto the map, exactly where they must
be shown to make the map usable and useful for making inference about the original items’ structures. We also provide
two additional inference rules to help the user to read this
representation. At last, in Section 4, we apply this method on
synthetic and real data sets to demonstrate our claims.
Our visualization method is the combination of four components:
• we propose to show the local mapping distortion onto the
map itself;
• we propose to use the pair of complementary indicators
based on the NLM and CCA stress functions presented
in [LA09], to characterize for each data point local false
neighbourhoods and tears, respectively;

c 2010 The Authors
Computer Graphics Forum c 2010 The Eurographics Association and Blackwell Publishing Ltd.

116

S. Lespinats & M. Aupetit / CheckViz: Sanity Check and Topological Clues for Linear and Non-Linear Mappings

• we propose to use a single two-dimensional colour
map sliced in the perceptually uniform CIELab threedimensional colour space to show the pair of distortion
values simultaneously. The colour of some region around
each data point location is given by the position in this
colour map of a point having as coordinates the local
false neighbourhoods and tears criteria of this data point;
• and following many authors [Aup07, BD05, NSB04,
RMC04, PFM∗ 06], we use the Voronoi cell of each data
point as the region to colour to make visible the values
of the local distortions.
This whole combination is our original contribution both
in terms of the informational and graphical parts. On the
informational side, this work is the first one to propose to
display simultaneously the local pair of complementary distortion indicators at each data point onto the map itself. On
the graphical side, both indicators of a data point are mapped
to a bicolour table and the resulting colour is set to its Voronoi
cell. As a by-product, this work makes the MDS maps fitting
within the framework of Verity Visualization.
2. Related work
2.1. A practical point of view
In practice, as data miners using non-linear multidimensional
scaling methods and aware of their potential mapping distortions, we must answer two major questions:
• Which mapping method displays the best map of our data?
• In which part and how much can we trust the resulting
map?

The former question deals with global mappings quality
evaluation, the latter with local evaluation. In this section,
we display in Figure 3 some of the state of the art evaluation
methods based on the CCA and NLM mappings of the same
data as in Figure 2.
2.2. Global quality assessment
Many methods like in [Sam69, DH97, LVG∗ 07, VK06] attempt to find the position of data points in the mapping
to optimize some stress function. The optimal stress value
reached can be used to evaluate the global mapping quality and to compare several mappings obtained optimising
the same stress function. However, it is unfair to compare
two different methods based on the stress function of one of
them, so more general criteria have been devised to tackle
this problem. For instance, Venna and Kaski [VK01] propose
the trustworthiness and continuity rank-based criteria to measure global mapping distortions, but many other criteria have
been devised too (see [Ven07] for a survey). However, the
stress value or such general criteria are single or pairs of
numbers which summarize very crudely all the mapping distortions contained in the (D−D∗ ) matrix, and do not answer
the where and how much questions. In the sequel, we focus
on evaluation methods based on visualization.
The Shepard diagram [Kru64, DH97] is such a modelfree summary, which allows visual comparison of mappings.
Each pair of items is displayed as a single point in a twodimensional scatter plot, where the x-axis shows the pairwise distance in the original space and the y-axis the pairwise distance in the projection space. All the points lying
on the diagonal show a perfect mapping, whereas points
below and above the diagonal show false-neighbourhoods

Unknown original data ?
3
3

ECCA
ENLM

Shepard
diagram
original distance

original distance

ECCA
ENLM

Dimensionality
reduction

CCA and NLM pressures

CCA

3
3

Shepard diagram

NLM
CCA and NLM pressures

5

Output distance
Output distance

5

Links in
geodesic distance lattice

Proximity measure
visualization

Links in
geodesic distance lattice

Proximity measure
visualization

Figure 3: Four quality assessment methods tested on projections by CCA [DH97] and Sammon’s mapping [Sam69]). The lower
the distortions, the less the stress values (ECCA and ENLM ), the closer to the diagonal of the Shepard diagram [Kru64, DH97],
the brighter the CCA and NLM pressures [LA09], the more disentangle the geodesic links, and the smoother the proximity
mosaic [Aup07].
c 2010 The Authors
Computer Graphics Forum c 2010 The Eurographics Association and Blackwell Publishing Ltd.

S. Lespinats & M. Aupetit / CheckViz: Sanity Check and Topological Clues for Linear and Non-Linear Mappings

and tears, respectively. The number of points to display being
proportional to the square of the number of items, Lespinats
et al. [LVG∗ 07] propose to use a density plot as shown in
Figure 3, when this number is too large.
The Shepard diagram displays all the possible pairs of
items so it shows all the possible mapping distortions (D−D∗ )
at once. However, it shows the distortions in a separate view
which makes it difficult to link these distortions with the
evaluated mapping, because it displays N(N−1)/2 points,
one for each pair of items, while the mapping displays N
points, one for each single item. Thus, it cannot tell where
and which mapping distortions occur straight onto the map,
making the map still difficult to interpret.
2.3. Local quality assessment
In practice, the local quality of non-linear mappings can
be very heterogeneous. However, few methods have been
proposed to visualize this local quality exactly where it makes
sense, that is straight onto the map.
When using projection methods which build a graph to
estimate geodesic distances, for example ISOMAP [TSL00]
or Curvilinear Distance Analysis [LLV04], it is usual to draw
in the projection space the links which connect neighbouring
items in the original space. It is applied for Self-Organizing
Maps as well by Tasdemir and Mer´enyi in [TM09]. The links
connecting data points far apart show tears, whereas those
entangled in a small map area show false neighbourhoods.
However, these methods are prone to the ‘hairy ball’ problem frequently occurring in dense graph drawing: too many
‘tears’ links hiding areas with no distortions, and too many
‘false neighbourhoods’ links being difficult to disentangle to
make clear at first glance which data are really neighbours in
the original space and which are not.
Another method called proximity measure is proposed
by Aupetit in [Aup07]. It consists in showing the original
neighbourhood of an item whose data point is selected by
the user. The Voronoi cell of each data point is coloured
with respect to the original distance between its respective
item and the selected one. This method shows the original
neighbourhood of an item as an image made of a grey-scale
mosaic of Voronoi cells, rather than as a set of links. It conveys a continuous distance-based measure of neighbourliness
instead of the above discrete graph-based one, and makes
clear at first glance all tears and false neighbourhoods involving the selected data point. However, it focuses on a
single data point at a time, so the user has to explore the
neighbourhood of each of the N items by selecting each data
point one by one. Colouring Voronoi cells is proposed by
many authors [Aup07, BD05, NSB04, RMC04, PFM∗ 06]
and alternative representations like heat maps are discussed
in [SLB10] and [SSK10]. Aupetit also suggests in [Aup07],
a global view to help focusing on the data points gathering
most of the distortions, by colouring Voronoi cells with a

117

grey-level proportional to the accumulated tears and false
neighbourhoods of each data point. Hermann et al. [HGK09]
propose to display distortions measured through the Kruskal
stress with a colour coding of the data points. The Kruskal
stress essentially emphasizes false neighbourhoods. Similar
proposals are studied in [SLB10] and [SSK10] with other
stress functions. Anyway, these four approaches which display a single value for each data point cannot show when
both tears and false neighbourhoods occur simultaneously
at the same place. Finally, Lespinats and Aupetit propose
in [LA09] two separate views of the mapping distortions,
one for the tears and another one for the false neighbourhoods measured with criteria based on CCA and NLM stress
functions, respectively. However, these two separate views
do not allow seeing at a single glance all the distortions.
Some work exists to visualize SOM distortions, which might
be applied to continuous non-linear mappings as well. Kaski
et al. [KVK00] propose a similarity colouring to display with
perceptually similar colours neurons of the map, which are
neighbours in the original space. This is intended to provide
a global view of the tears and false neighbourhoods, but the
colouring is obtained by unfolding the SOM in an auxiliary
perceptually uniform two-dimensional colour space, making
the colouring itself prone to mapping distortions. Davidson
et al. [DWB01] propose to analyse the stability of clusters
obtained through mappings initialized at random. The only
way to make sense out of this analysis is to link the views
to check whether a cluster in one view exists or not in the
others. Thus, a single view is not self-content, as it must be
linked to others to make eventually the truth coming out.
This process is misleading as not a single view makes sense
for itself, and as stated earlier, linking views without scale
is unlikely to produce meaningful conclusions. Correa et al.
[CCM09] propose to visualize uncertainties using sensitivity
analysis, but problems come with the amount of perturbation
to use and the difficulty to apply this method to non-linear
mappings such as ISOMAP, NLM, CCA or DD-HDS which
do not provide an explicit continuous function from the original space to the projection space as PCA does. Warnking
et al. [WGD∗ 00] compare the original and projection areas
of triangles resulting from a Delaunay triangulation of the
data points. This distortion measure is difficult to handle because triangles with very different shapes may still have the
same area. Many works have been done in the cartographic
visualization community (see references in Brainerd et al.
[BP98]) such as the one of Brainerd et al. themselves who
propose to visualize mapping distortions by displaying how
a circle lying in the sphere is distorted while being mapped
onto the plane. The projected circle can be moved across
the map to show how the distortions evolve from place to
place. However, these approaches are specific to the projection of a sphere onto a plane, so the extension to original
spaces with intrinsic dimension higher than 2 and no analytical expression of their topological structure is not straightforward. They are also difficult to apply when projection is
defined as the solution of an optimization problem where no

c 2010 The Authors
Computer Graphics Forum c 2010 The Eurographics Association and Blackwell Publishing Ltd.

118

S. Lespinats & M. Aupetit / CheckViz: Sanity Check and Topological Clues for Linear and Non-Linear Mappings

continuous mapping is defined between original and projection spaces.
In this work, we use the idea of colouring Voronoi cells and
we put in a single view both tears and false neighbourhoods’
views proposed in [LA09], by designing a two-dimensional
perceptually uniform colour map.

3. A colour table to exhibit mapping distortions
3.1. A pair of criteria based on NLM and CCA
The purpose of NLM is to find the positions for data points
in the projection space, which minimize the following stress
function:
dij − dij∗ × F (dij ) ,

ENLM =
i,j

where dij and dij∗ represent the original distance (matrix D)
between items i and j and the Euclidean distance (matrix
D∗ ) between data points i and j in the projection space respectively, and F is a monotonically decreasing weighting
function designed to emphasize small original distances. Although NLM fairly penalizes tears, it lightly penalizes false
neighbourhoods. Indeed, let us suppose that dij is large but
dij∗ is small, so i and j are false neighbours, then F (dij ) is low
and the difference between dij and dij∗ does not give much
weight to ENLM . Thus, as noticed by Sammon [Sam69], NLM
is prone to false neighbourhoods.
The CCA [DH97] stress function is close to the NLM one
but the weighting function F relies on the distance in the
projection space rather than in the original space:
dij − dij∗

ECCA =

2

× F dij∗

.

i,j

Now false neighbourhoods are fairly penalized, but tears
can easily occur: if F (dij ) is low and dij∗ is high, FCCA (dij∗ ) is
low. As noticed in [DH97], CCA is prone to tears.
We proposed in [LA07] to define the pressure at data point
i as the part of the stress function which involves only this
data point:
PNLM (i) =

dij − dij∗

2

dij − dij∗

2

× F dij

,

× F dij∗

.

j

PCCA (i) =
j

The stress is the sum of the local pressures. The more there
are false neighbourhoods or tears, the larger are the value of
PCCA or PNLM , respectively. So we propose to use the pair
of indices (PCCA , PNLM ) to quantify locally both mapping
distortions.

We propose to use for F a Heaviside step function with the
parameter σ : Fσ (x) = 1 if x < σ and Fσ (x) = 0 otherwise.
Notice that PNLM is similar to PCCA , up to an interchange
between original and projection distances as input to the F
function. If original and output distances are similar, which
the mapping enforces, the two indices have a low value and
the same order of magnitude, and otherwise at least one of
these two indices has a high value, which is a clue that the
mapping failed.
3.2. A two-dimensional perceptually uniform colour
table
Colouring data points to display local information on the
mapping is not new. See, for example [PFM∗ 06]. This is
easy to set up when dealing with a one-dimensional index
using for example a grey-scale. However, in our setting, we
consider a pair of indices (PCCA , PNLM ): the first one accounts
for false neighbourhood and the second one for tears. We
want to display both indices simultaneously to render the
fact that both distortions may occur at the same place as
shown in Figure 1, so we project the data points onto a twodimensional colour map using this pair of indices.
Some rules to select good colour maps are given
in [Rhe99]. It appears that perceptually uniform twodimensional colour map is suitable to recover the pair of
parameters from the colour they encode. A perceptually uniform colour space as defined in [CIE86] is such that if the pair
of criteria Pi = (PCCA (i), PNLM (i)) is twice as close to Pj as to
Pk , then the data point’s colour ci is perceived twice as much
closer to cj as to ck . The data provided by Hoffmann [Hof09]
shows perceptually uniform colour maps. We slice a square
coloured with white and black at two opposite corners, and
being oriented in the three-dimensional CIELab colour space
to get a set of opposite hues on both the other corners. We use
the transformations between RGB and CIELab colour spaces
based on [ITU90] using the D65 white point reference which
was implemented as a matlab code by Ruzon [Ruz09]. The
square in the three-dimensional CIELab colour space has corners with the following coordinates: (100, 0, 0) for ‘white’;
(65, −30, 20) for ‘green’; (30, 0, 0) for ‘dark grey’ and (65,
30, −20) for ‘purple’. A slice with yellow-blue opposite hues
instead of green-purple can be used as well to comply with
colour blindness.
This two-dimensional colour map is shown in Figure 4.
In this colour coding, pure false neighbourhood areas appear
as purple and pure tear areas as green. A white area means
an area ‘clear’ from any distortion, and a black area means a
‘dark’ area where no structure is faithful.
3.3. Colouring Voronoi cells
As proposed in several works [Aup07, BD05, NSB04,
RMC04, PFM∗ 06], we choose to colour Voronoi cells rather
than data points themselves for the following reasons:

c 2010 The Authors
Computer Graphics Forum c 2010 The Eurographics Association and Blackwell Publishing Ltd.

119

S. Lespinats & M. Aupetit / CheckViz: Sanity Check and Topological Clues for Linear and Non-Linear Mappings

However, Voronoi cells could also lead to visualization
bias. The size of cells depending on the density of data points,
the attention of the analyst might be attracted towards data
points with larger cells. But the data points being displayed
at the foreground also create patterns, which seem to catch
the visual attention at first. In our previous work [LA09] we
only coloured the data points themselves and felt the result
less effective at catching the amount of local distortions at a
glance (Figure 3).

Color-code
PNLM

Shuffled

Tear

No
distortion

False
Neighborrhood

0

PCCA

Figure 4: The two-dimensional colour scale. Each data is
related to a colour according to PCCA and PNLM .

• The background is visually expected to bear contextual
information about the foreground. So Voronoi cells cover
the plane without overlapping and fill the whole background of the data points with colour encoding the faithfulness of the foreground scatter plot.
• According to the Gestalt theory [War04], colouring the
data points’ markers would induce similarity relation between points with similar colour while these points are
not necessarily close with respect to their original distance. Using different graphical supports (Markers’ relative position and Voronoi cells’ colour) for different variables (estimated position and distortion, respectively) is
likely to avoid this mismatch. Moreover, it allows releasing the colour variable of the data points’ markers, which
then can be used to encode a more familiar variable like
the class label of the data point.
• Each data point is the perceptually nearest one among
all the data points, to any point of its Voronoi cell. So
anywhere we look at, the colour we see is the one of
the closest data point, that is the data point to which we
would have ‘naturally’ assigned the colour of the point
of focus.
• Voronoi cells adapt their size to the local data points’ density, avoiding the clutter problem of fixed-size markers.

Another issue concerns the nearest-neighbour interpolation visually induced by the use of Voronoi cells. Here
the vacuum between the data points is more than twodimensional, that is the value which is displayed at any
point in the projection space is potentially the one to give to
the whole multidimensional subspace of the original space
which would be mapped at that point. So we must emphasize that the Voronoi cells are not meant to infer the distortion level in vacuum areas through interpolation but as
a mean to make visible this distortion level by spreading
its respective colour ‘perceptually at best’ around each data
point.
At last, there is still a possibility for ‘light contrast illusion’ [CSS89] because no reference colour is provided between the cells, but it is probably not an issue here because
the colouring is used to guide the analyst during his exploration rather than to provide very precise distortion level
at each location. The overall visualization process is given
in Figure 5.

3.4. Inferring from coloured maps
The colouring makes the map distortions visible. It also
allows inferring structures of original data from the map.
Indeed, a bright background in some area reveals that the
observed structures in this area can be trusted. A green background reveals that the structure has been torn and a purple
background reveals that some distinct structures have been
overlapped at the same place. Both types of distortion happen
simultaneously in dark background areas.
color-code

PNLM

max

Tear

Shuffled

High-dimensional
input data
0

Isomap

(A)

No
distortion

Color coding

Voronoï cells
coloring

dimensionality
reduction

(B)

F-N
max

PCCA

(C)

Figure 5: The distortions visualized straight onto the map. Data are mapped into a two-dimensional space using ISOMAP (A).
Voronoi cells are subsequently coloured (B) according to a colour-code displaying PCCA and PNLM (C).
c 2010 The Authors
Computer Graphics Forum c 2010 The Eurographics Association and Blackwell Publishing Ltd.

120

S. Lespinats & M. Aupetit / CheckViz: Sanity Check and Topological Clues for Linear and Non-Linear Mappings

masking any global overall distance stretching or compression. Here we use a ‘rule of thumb’ setting the σ value to
the average distance between each item and its fifth nearest
neighbour in the original space. Experiments about how this
parameter affects the results are provided in Section 4.2.

Figure 6: Some structures that can be inferred despite the
distortions. Left panel: a true separation; right panel: a true
overlapping of two groups (blue circles and orange triangles).
Despite that structures observed in dark areas are not faithful; some conclusions can be drawn from green and purple
areas:
• True Separation Rule: If several purple structures are disjoint on the map, then up to the scale σ , the gap between
them is true in the original distance matrix D and so
is the observed partition (see left insert in Figure 6).
Otherwise, it would correspond to a tear and associated
cells would be green or dark. Nevertheless, each of the
observed structures within purple areas artificially connects originally distinct ones or is denser than the original
ones.
• True Overlap Rule: If several green structures are placed
side by side or overlap, then up to the scale σ , the side by
side location or the overlap is real in the original distance
matrix (see right insert in Figure 6). Nevertheless, the
observed structures within green areas are part of an
original one artificially disconnected or are less dense
than the original ones.
It must be emphasized that the term ‘structure’ refers to
the value of the σ parameter which defines the radius of
the ball centred at an item and its respective data point, in
which both original and projected neighbours, respectively,
are considered.
3.5. Setting the scaling parameter
The parameter σ is the most important to be set. It provides
the scale at which the data points and items are considered
to form a structure. Parameters with the same meaning are
used in many non-linear MDS methods (see, e.g. [DH97],
[VK06]) so it is quite natural to tune σ to the same value as
the one used within the mapping method itself. Otherwise,
the value of σ can be based on some criterion derived from
the distribution of all the distances in the original space or
can be set interactively by the analyst. Normalization of the
distances in original and projection spaces could also be applied enforcing the σ scale to be similar in both spaces but

The maximum value for the colour scale can also be set to
a limit to prevent some outliers from masking less important
but still existing mapping distortions in other areas. But in any
case, a similar maximum colour key value must be chosen
for PCCA and PNLM .

4. Experiments
4.1. Data sets and experimental setup
The proposed mapping quality visualization is tested on three
data sets. The first one is our guiding example: a unit empty
cubic box with one face missing sampled with a regular grid
of 193 items in the three-dimensional real space. The second
one is the ‘Oil Flow’ synthetic data set [Sve99] obtained from
a physical simulation of oil flow in a pipeline. It is a set of
1000 items in the 12-dimensional real space, partitioned into
three classes (in this case, we use a subset of 500 randomly
drawn data). The third one is a real data set called ‘Optical
Recognition of Handwritten Digits’ obtained from the UCI
Machine Learning Repository database [AN07], containing
5264 items in the 64 dimensional pixel space of the 0–9 digits
(in this case, we use a subset of 200 data equally distributed
between the classes).
The local quality is observed through the pair (PCCA ,
PNLM ). We use the PCA, NLM, CCA, ISOMAP and DDHDS mapping methods with defaults parameters provided
in the original publications. For ISOMAP, we build the five
nearest neighbours graph. For CCA and NLM stresses and
pressures, the function F is given at the end of Section 3.1
and distances are Euclidean. The default value for σ is set to
2.5, 0.5 and 35 for the guiding example, the Oil Flow and the
Digit data, respectively, it is the same value as the one which
was used to optimize the stress function of NLM, CCA and
DD-HDS to get the maps shown in this work.
The first experiment based on the guiding example data
set, is intended to show the influence of the parameter σ
and the basic properties of the colour coding we propose.
The second and third experiments present our method facing
multidimensional synthetic and real data. Both of them are
intended to demonstrate that our method is really necessary
to make sense out of the mapping.
We emphasize that we do not intend to show whether
one mapping method is worse or better than another one,
but rather to show that without displaying distortions, the
mappings cannot be trusted, they are not usable for inference,
whereas using the CheckViz method they become usable and
so may be useful.

c 2010 The Authors
Computer Graphics Forum c 2010 The Eurographics Association and Blackwell Publishing Ltd.

121

S. Lespinats & M. Aupetit / CheckViz: Sanity Check and Topological Clues for Linear and Non-Linear Mappings

in the NLM map whereas PCA and ISOMAP show the cubic
box projected along an axis orthogonal to its bottom face.

Open side

The values for PNLM and PCCA depend on the value of the
parameter σ : the lower the value, the smaller the considered
neighbourhood. If σ is lower than the smallest distance, each
pressure is null and no distortion can be detected. Conversely
if σ is greater than the largest distance, every pressure is
maximal. In Figure 8, we set σ similarly for the mappings
and the evaluation of their distortions (σ = 2.5); in Figure
9, two other values are tested. When σ = 1.5 (lower than
the default value), colours are brighter and some distortions
are understated, such as at the border of torn corners of
the bottom side in the CCA map. When σ = 3.5 (higher
than the default value), colours are darker and distortions
are reported even in fair areas close to distorted ones: false
neighbourhoods are detected in the centre of the bottom face
in the PCA map and green colour floods the central area in
the CCA map.

Figure 7: The guideline example data set revealed. It is a
sample of items laying in the faces of a cubic open box.

4.2. The cubic open box guiding example
Items lie onto the faces of a three-dimensional open box
(Figure 7). Despite the fact that these data lie onto a twodimension manifold, there is no way to project them onto a
plane preserving all the distances. This example allows us to
show the main distortions of mapping methods. As expected,
CCA generate only tears, PCA, ISOMAP and NLM generate
only false neighbourhoods, and DD-HDS provides the most
faithful map of these data.

In the sequel we set sigma to a value which makes visible
both types of distortions.

The DD-HDS mapping provides a faithful map of the
original structure because every Voronoi cells are almost
white. Data points within the shape shown by CCA mapping
are brighter while its borders are clearly torn: two lateral
faces of the cubic box have been ripped out of each other
through the mapping. Two opposite faces of the box overlap

4.3. The Oil Flow data
Three classes correspond to three different relative positions
of oil, water and gas in pipes: green squares for ‘stratified’,
200

PNLM

5

Tear

Shuffled

150
100
50

PCA

0

Isomap

No
distortion

F-N

5

5

5

5

NLM

50

CCA

DD-HDS

100

150

200

PCCA

Figure 8: Local evaluation of mappings presented in Figure 2. Here, σ is set to 2.5. Notice the different scale of each map.
200

PNLM

5

Tea r

Shuffled

150
100
50

5

5

PCA

Isomap

5

5

NLM

0

No
distortion
50

150

200

PCCA

CCA

DD-HDS

F-N

100

(a)
200

PNLM

5

Tea r

Shuffled

150
100
50

5

PCA

0

Isomap

No
distortion

F-N

5

5

5

NLM

DD-HDS

CCA

50

100

150

200

PCCA

(b)
Figure 9: Same analysis as in Figure 7, with σ = 1.5 (a) and σ = 3.5 (b). Notice the different scale of each map.
c 2010 The Authors
Computer Graphics Forum c 2010 The Eurographics Association and Blackwell Publishing Ltd.

122

S. Lespinats & M. Aupetit / CheckViz: Sanity Check and Topological Clues for Linear and Non-Linear Mappings
2
2

2
2
2

PCA

Isomap

NLM

CCA

DD-HDS

2

PNLM

2
2

Te ar

Shuffled

1.5
1

No
distortion

0.5

2
2

0

2

0.5

F-N

1

1.5

2

PCCA

Figure 10: Five mappings of Oil flow data set without (top) and with (bottom) local evaluation.
blue circles for ‘annular’ and red triangles for ‘homogeneous’.

green data because they belong to white areas in these maps.
Moreover, the contact between some green and blue points
is faithful (True Overlap Rule) in CCA.

Looking at the maps without colouring (top of Fig 10),
the red class seems to be disconnected but it is not clear in
how many parts, and green and blue classes seem to overlap
(PCA and NLM) or to be disconnected (DD-HDS and CCA)
except onto the ISOMAP projection, so where is the truth?

We obtain similar conclusions about the data structure as
the one provided in [GAG08] using a topological analysis
based on a statistical generative model.
4.4. The handwritten digits data

When adding the colouring (bottom of Figure 10), the
PCA insures that some points of the red class are really separated from the remaining points (True Separation Rule).
Conversely, ISOMAP shows an interesting clue despite the
large amount of distortions: blue and green data are separated by a bright area. Moreover, blue and green data are not
involved in tears because they lie in a purple area. Therefore,
blue and green data are separated in the original space (True
Overlap Rule). CCA and DD-HDS allow observing that red
data are faithfully spread over nine clusters around blue and

50

Although the maps without colouring (top of Figure 11) lead
us to think that each set of digit forms a distinct cluster
structure in the original space, the decorated maps enjoin us
not to be so affirmative.
Indeed, few can be said here from PCA, ISOMAP and
NLM. However, several bright areas in CCA and DD-HDS
maps show that the digits 0, 2, 6 and 7 form distinct clusters
in the original space. The CCA also tells us (True Overlap

50

50

50

0

1

2

3

4

5

6

7

8

9

50

Isomap

NLM
50

CCA

DD-HDS

50

50

PNLM

PCA

10 3
x10

7.5

Tear

Shuffled

3

x10

5

3

x10

50
50

2.5 3
x10

No
distortion

0

2.5 3
x10

5

F-N
3

x10

7.5 3
x10

10 3
x10

PCCA

Figure 11: Five mappings of digit data set without (top) and with (bottom) local evaluation.
c 2010 The Authors
Computer Graphics Forum c 2010 The Eurographics Association and Blackwell Publishing Ltd.

123

S. Lespinats & M. Aupetit / CheckViz: Sanity Check and Topological Clues for Linear and Non-Linear Mappings

Isomap

0

No
default
50

50

F-N
100

PCCA

150

200

0

Tea r

Shuffled

150

50

50

F-N
100

150

200

Tea r

Shuffled

150
100

100

No
default

200

No
default

0

PCCA

50

50

F-N
100

150

200

PCCA

0

PNLM

Shuffled

100

100
50

Tea r
150

DD-HDS

200

200

PNLM

Shuffled

PNLM

PNLM

Tea r
150

CCA

NLM

200

PNLM

PCA
200

Tea r

Shuffled

150
100

No
default
50

50

F-N
100

PCCA

150

200

0

No
default
50

F-N
100

150

200

PCCA

Figure 12: Distribution of the items in the two-dimensional colour table for the five open box mappings presented in Figures 2
and 7 (σ is set to 2.5).
Rule) that the contact between digits 3 and 5, and 5, 8 and
9 are faithful. But it is still difficult to conclude about the
original structure of the other classes.

ing techniques and other projection-based approaches widely
used in the Information Visualization domain.

Acknowledgments
5. Conclusion
Maps are used to show multidimensional patterns or to drill
down into multidimensional data sets. However, there is no
visible difference between a totally random map and a one
which minimizes some distortion measure. Moreover, nonspecialists tend to believe whatever pattern they see with the
only principle in mind that MDS or others maps are faithful
black-boxes provided by their Computer Science Department. Here we claim that the quality of the map must be
checked thoroughly before it can be used safely or not used
at all.
We proposed the CheckViz method to evaluate the mapping quality at one single glance. The CheckViz method
acts as a sanity check to display as bright areas the location
where inference can be made safely, and as a tool to infer
some topological properties of the original structures using
the True Separation and True Overlap rules. We showed on
toys and real data that without this kind of quality visualization, maps cannot be trust; they are not usable for inferring
the original items’ structures. As a by-product, the CheckViz
method makes the MDS maps fitting within the framework
of Verity Visualization [WPL95].
We think it could be useful to draw in the two-dimensional
colour map the points used to give a colour to the data points,
showing at a glance the overall distribution of the mapping
distortions (as presented in Figure 12 with the open box
data set). We also think about applying CheckViz to other
information mappings, such as tree-maps [JS91], and in fact
CheckViz applies whenever original multidimensional data
are displayed as point clouds as far as some similarity matrix
can be computed in both original and projection spaces. It
applies to Self-Organizing Maps [Koh88] as well considering
nodes as data points.
CheckViz paves the way for a renewed viewpoint on exploratory data analysis based on Multi-Dimensional Scal-

We are very grateful to the anonymous reviewers for their
truly helpful comments, which allowed us to improve the
quality of this work.
References
[AHK01] AGGARWAL C. C., HINNEBURG A., KEIM D. A.: On the
surprising behavior of distance metrics in high dimensional space. In Lecture Notes in Computer Science, ser,
1973. J. V. Bussche and V. Vianu (Eds.). Springer-Verlag,
Berlin, Germany (2001), pp. 420–434.
[AN07] ASUNCION A., NEWMAN D. J.: UCI Machine Learning
Repository Irvine. University of California, School
of Information and Computer Science, CA, 2007,
http://www.ics.uci.edu/∼mlearn/MLRepository.html.
Accessed on 16 November 2010.
[Asi85] ASIMOV D.: The grand tour: A tool for viewing multidimensional data. SIAM Journal on Scientific and Statistical 6, 1 (1985), 128–143.
[Aup07] AUPETIT M.: Visualizing distortions and recovering
topology in continuous projection techniques. Neurocomputing 10, 7–9 (2007), 1304–1330.
[BD05] BALZER M., DEUSSEN O.: Voronoi treemaps. In Proceedings of the IEEE Symposium on Information Visualization. INFOVIS 05 (Minneapolis, Oct. 2005), p. 7.
[BP98] BRAINERD J., PANG A.: Floating ring: A new tool for
visualizing distortion in map projections. In Proceedings
of the Computer Graphics International (Hannover, June
1998), pp. 466–481.
[CCM09] CORREA C. D., CHAN Y. H., MA K. L.: A framework
for uncertainty-aware visual analytics. In Proceedings of
IEEE VAST, (Atlantic City, Oct. 2009).

c 2010 The Authors
Computer Graphics Forum c 2010 The Eurographics Association and Blackwell Publishing Ltd.

124

S. Lespinats & M. Aupetit / CheckViz: Sanity Check and Topological Clues for Linear and Non-Linear Mappings

[CIE86] Publication CIE No. 15.2, Colorimetry, 2nd edition. Central Bureau of the Commission Internationale de
´
L’Eclairage,
Vienna, Austria, 1986.
[CSS89] CHUBB C., SPERLING F., SOLOMON J. A.: Texture interactions determine perceived contrast. Proceedings of
the National Academy of Sciences of the United States of
America 89 (1989), 9631–9635.
[DWB01] DAVIDSON G. S., WYLIE B. N., BOYACK K. W.: Cluster
stability and the use of noise in interpretation of clustering. In Proceedings of IEEE Information Visualization
(InfoVis’Ol) (San Diego, Oct. 2001), pp. 23–30.
[DH97] DEMARTINES P., H´ERAULT J.: Curvilinear component
analysis: A self-organizing neural network for nonlinear
mapping of data sets. The IEEE Transactions on Neural
Networks 8, 1 (Jan 1997), 148–154.
[Dij59] DIJKSTRA E. W.: A note on two problems in connection
with graphs. Numerisch Mathematik 1 (1959), 269–271.
[Don00] DONOHO D. L.: High-Dimensional Data Analysis.
The Curses and Blessings of Dimensionality, American Mathematical Society, Los Angeles, CA, 2000. Lecture: Math challenges of the 21st century, http://wwwstat.stanford.edu/∼donoho/.
[FT74] FRIEDMAN J. H., TUKEY J. W.: A projection pursuit algorithm for exploratory data analysis. IEEE Transactions
on Computer C-23, 9 (1974), 881–890.
[Gow66] GOWER J. C.: Some distance properties of latent
root and vector methods used in multivariate analysis.
Biometrika 53 (1966), 325–338.
[GAG08] GAILLARD P., AUPETIT M., GOVAERT G.: Learning topology of a labeled data set with the supervised
generative Gaussian graph. Neurocomputing 71 (2008),
1283–1299.
[HGK09] HERMANN M.,GRESS A., KLEIN R.: Interactive exploration of large event datasets in high energy physics.
Journal of WSCG 17, 1 (Feb. 2009), 41–48.
[Hof09] http://www.fho-emden.de/∼hoffmann/munsell
15052009.pdf. Accessed on 16 November 2010.
[ITU90] Recommendation ITU-R BT.709: Basic Parameter
Values for the HDTV Standard for the Studio and for
International Programme Exchange. Geneva, 1990.
[Jol02] JOLLIFFE I.: Principal Component Analysis. SpringerVerlag, New York, 2002.
[JS91] JOHNSON, B., SHNEIDERMAN, B.: Tree-maps: A spacefilling approach to the visualization of hierarchical information structures. In Proceedings of the IEEE Vi-

sualization’91 (IEEE, Piscataway, NJ, 1991), pp. 284–
291.
[Koh88] KOHONEN T.: Self-Organization and Associative
Memory Formation. Springer, Berlin, 1988.
[KVK00] KASKI S., VENNA J., KOHONEN T.: Coloring that reveals cluster structures in multivariate data. Australian
Journal of Intelligent Information Processing Systems 6
(2000), 82–88.
[Kru64] KRUSKAL J. B.: Multidimensional scaling by optimizing goodness of fit to a nonmetric hypothesis. Psychometrika 29 (1964), 1–27.
[LA09] LESPINATS S., AUPETIT M.: False neighborhoods and
tears are the main mapping defaults. How to avoid it?
How to exhibit remaining ones? Quality issues, measures
of interestingness and evaluation of data mining models.
In Proceedings of the QIMIE 2009 (Bangkok, Thailand,
Apr. 2009), pp. 55–65.
[LLV04] LEE J. A., LENDASSE A., VERLEYSEN, M.: Nonlinear projection with curvilinear distances: Isomap versus
curvilinear distance analysis. Neurocomputing 57 (2004),
49–76 (New York, Elsevier).
[LVG*07] LESPINATS S., VERLEYSEN M., GIRON A., FERTIL B.:
DD-HDS: A tool for visualization and exploration of high
dimensional data. The IEEE Transactions on Neural Networks 18, 5 (2007), 1265–1279.
[NSB04] NOCKE T., SCHUMANN H., B¨OHM U.: Methods for
the visualization of clustered climate data. Computational
Statistics 19, 1 (2004), 75–94.
[Pea01] PEARSON K.: On lines and planes of closest fit to
systems of points in space. Philosophical Magazine no. 2,
6 (Taylor & Francis, London, 1901), 559–572.
[PFM*06] PINHO R., FERREIRA DE OLIVEIRA M. C., MINGHIM
R., ANDRADE M. G.: Voromap: A Voronoi-based tool for
visual exploration of multi-dimensional data. In Proceedings of the Information Visualization (IV’06) (London,
July 2006), pp. 36–44.
[Rhe99] RHEINGANS P.: Task-based Color Scale design. In
Proceedings of Applied Image and Pattern Recognition’99
(Baltimore, Oct. 1999), SPIE Baltimore, pp. 35–43.
[RMC04] ROSS G., MORRISON G., CHALMERS M.: Coordinating views for data visualisation and algorithmic profiling.
In CMV ’04: Proceedings of the 2nd International Conference on Coordinated & Multiple Views in Exploratory
Visualization (CMV’04), Washington, D.C., USA (IEEE
Computer Society, 2004), pp. 3–14.
[Ruz09] RUZON M. A.: http://ai.stanford.edu/∼ruzon/software/
rgblab.html. Accessed on 16 November 2010.

c 2010 The Authors
Computer Graphics Forum c 2010 The Eurographics Association and Blackwell Publishing Ltd.

S. Lespinats & M. Aupetit / CheckViz: Sanity Check and Topological Clues for Linear and Non-Linear Mappings

[Sam69] SAMMON J. W.: A nonlinear mapping for data structure analysis. IEEE Transactions on Computer C-18, 5
(May 1969), 401–409.
[SLB10] SCHRECK T., VON LANDESBERGER T., BREMM S.: Techniques for precision-based visual analysis of projected
data. In Proceedings of the IS&T/SPIE Conference on
Visualization and Data Analysis (VDA 2010) (San Jose,
California, 2010).
[SSK10] SEIFERT C., SABOL V., KIENREICH W.: Stress Maps:
Analysing Local Phenomena in Dimensionality Reduction Based Visualizations Proceedings of the 1st European
Symposium Visual Analytics Science and Technology (EuroVAST’10) (Bordeaux, France, 2010).
[Sve99] SVENSE´ N M.: Generative Topographic Map homepage. http://www.ncrg.aston.ac.uk/GTM/index.html. Accessed on 16 November 2010.
[TM09] TASDEMIR K., MERE´ NYI E.: Exploiting data topology
in visualization and clustering of Self-Organizing Maps,
IEEE Transactions on Neural Networks 20, 4 (2009),
549–562.
[TSL00] TENENBAUM J. B., DE SILVA V., LANGFORD J. C.: A
global geometric framework for nonlinear dimensionality
reduction. Science 290 (2000), 2319–2323.
[Tor52] TORGERSON W. S.: Multidimensional scaling: 1. Theory and method. Psychometrik 17 (1952), pp. 401–419.

125

[Ven07] VENNA J.: Dimensionality reduction for visual exploration of similarity structures. Dissertations in Computer and Information Science. Helsinki, University of
Technology, Report D20, Espoo (2007).
[VK01] VENNA J., KASKI S.: Neighborhood preservation in
nonlinear projection methods: An experimental study, In
G. Dor_ner, H. Bischof and K. Hornik, editors, Proceedings of ICANN 2001, International Conference on
Artificial Neural Networks (Springer, Berlin, 2001), pp.
485–491.
[VK06] VENNA J., KASKI S.: Local multidimensional scaling. Neural Networks 19, 6–7 (2006), pp. 889–
899.
[War04] WARE C.: Information Visualization – Perception for
Design, 2nd edition, Morgan Kaufmann Publishers Inc.,
2004, p. 486.
[WGD*00] WARNKING J., GUERIN-DUGUET A., CHEHIKIAN
A., OLYMPIEFF S., DOJAT M., SEGEBARTH C.: Retinotopical mapping of visual areas using fMRI and a fast
cortical flattening algorithm. Neuroimage 11, 5 (2000),
S646.
[WPL95] WITTENBRINK C. M., PANG A. T., LODHA S.: Verity visualization: Visual mappings. Technical Report
UCSC-CRL-95-48, University of California, Santa Cruz,
1995.

c 2010 The Authors
Computer Graphics Forum c 2010 The Eurographics Association and Blackwell Publishing Ltd.


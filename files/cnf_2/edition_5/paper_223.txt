DOI: 10.1111/j.1467-8659.2011.02035.x

COMPUTER GRAPHICS

forum

Volume 30 (2011), number 8 pp. 2288–2300

Perceptually Based Appearance Modification for Compliant
Appearance Editing
Alvin J. Law1 , Daniel G. Aliaga1 , Behzad Sajadi2 , Aditi Majumder2 and Zygmunt Pizlo3
1 Department

of Computer Science, Purdue University, IN, USA
{ajlaw, aliaga}@cs.purdue.edu
2 Department of Computer Science, University of California, Irvine, CA, USA
{bsajadi, majumder}@ics.uci.edu
3 Department of Psychological Sciences, Purdue University, IN, USA
pizlo@psych.purdue.edu

Abstract
Projection-based appearances are used in a variety of computer graphics applications to impart different appearances onto physical surfaces using digitally controlled projector light. To achieve a compliant appearance,
all points on the physical surface must be altered to the colours of the desired target appearance; otherwise, an
incompliant appearance results in a misleading visualization. Previous systems typically assume to operate with
compliant appearances or restrict themselves to the simpler case of white surfaces. To achieve compliancy, one
may change the physical surface’s albedo, increase the amount of projector light radiance available or modify the
target appearance’s colours. This paper presents an approach to modify a target appearance to achieve compliant
appearance editing without altering the physical surface or the projector setup. Our system minimally alters the
target appearance’s colours while maintaining cues important for perceptual similarity (e.g. colour constancy).
First, we discuss how to measure colour compliancy. Next, we describe our approach to partition the physical
surface into patches based on the surface’s colours and the target appearance’s colours. Finally, we describe
our appearance optimization process, which computes a compliant appearance that is as perceptually similar as
possible to the target appearance’s colours. We perform several real-world projection-based appearances and
compare our results to na¨ıve approaches, which either ignore compliancy or simply reduce the appearance’s
overall brightness.
Keywords: projector-camera system, augmented reality, appearance editing, radiometric calibration
ACM CCS: I.3.7 [Computer Graphics]: Three-Dimensional Graphics and Realism, Virtual Reality, Color, Shading, Shadowing, and Texture; I.3.3 [Computer Graphics]: Picture/Image Generation

1. Introduction
Projection-based appearances are important for many
computer graphics applications. Altering the appearance of
a physical scene with controlled digital projector light, or
appearance editing (AE), offers a unique capacity to modify
the visual appearance of objects outside a monitor’s confines, allowing multiple simultaneous observers to enjoy the
intuitive benefits of their human visual systems (e.g. depth
perception, parallax, physical inspection). Previous AE sysc 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics
Association and Blackwell Publishing Ltd. Published by
Blackwell Publishing, 9600 Garsington Road, Oxford OX4
2DQ, UK and 350 Main Street, Malden, MA 02148, USA.

tems have virtually painted content onto objects [BRF01],
have virtually restored cultural heritage [ALY08], and have
increased the dynamic range of printed material to improve
visualizations [BI08]. Other AE applications are discussed
in Ref. [BIW08].
Achieving an AE requires that a physical surface (the
scene) is capable of being visually modified to the colours
of the desired target appearance (e.g. the ideal appearance
sought by the observer). This means that a sufficient amount

2288

A. J. Law et al. / Perceptually Based Appearance Modification for Compliant Appearance Editing

of light radiance from the projectors must be available to
produce the target colour at each surface point in the scene.
A compliant target appearance (or compliant appearance) is
defined as an appearance whose colours can be achieved. In
contrast, an incompliant appearance is an appearance that
cannot be achieved due to colour and albedo constraints of
the surface and projector light limitations. For example, a
pure red surface albedo colour will have difficulty being
edited to a pure blue target colour due to a lack of energy
underneath the red colour’s spectral response curve. In such a
case, failing to produce the target colour may result in a misleading visualization. Short of altering the physical surface
albedo or hardware setup, an incompliant appearance can
only be made compliant by altering the target appearance.
However, analysing the compliancy of a target appearance
and minimally modifying it to be compliant has not been addressed in previous works. Rather, the target appearance has
either been assumed to be compliant (e.g. [BRF01, RWLB01,
JF07, BI08, OOD09]) or the target appearance’s colours were
na¨ıvely enforced to be darker than the surface albedo’s colour
(e.g. [ALY08]), sacrificing brightness and possibly introducing unwanted colour changes due to gamut constraints. In
general, the compliancy of a target appearance is dependent
on the appearance’s colours, the physical surface’s albedo,
and the amount of projector light radiance available from the
setup.
1.1. Key observations
We make two key observations, which enable us to alter the
initial target appearance to a perceptually similar compliant
appearance (Figure 1). First, we decouple colour into its luminance and chrominance components and consider both
components when modifying the target appearance. This
allows our resulting compliant appearances to be brighter
when compared to achieving compliancy only by reducing

2289

the target appearance’s luminance (e.g. [ALY08]) and to be
more chromatically accurate when compared to appearances
generated by na¨ıvely clamping the appearance’s colours to
the RGB range of the projectors. Although several colour
spaces exist, we use CIELAB colour space (or, informally,
Lab space) where L∗ represents a colour’s lightness (a value
related to relative luminance) and (a ∗ , b∗ ) represent a colour’s
chrominance. Lab space was chosen for its ability to measure
perceptual differences between colours with delta E ( E),
which is identical to computing the Euclidean distance in
a Cartesian coordinate system (in the 1976 definition; later
definitions adjust the measurement to what is essentially a
weighted Euclidean distance).
Secondly, because AE typically occurs in a dark room, no
environment light exists to illuminate the scene’s surrounding environment. Thus, in the absence of a reference colour
from the environment, we exploit colour constancy [Wan95]
to further maintain perceptual similarity. Colour constancy
states that the perceived colour of an object remains constant
despite changes in the spectrum of the illuminating light
which in turn changes the spectrum of the light reflected
from the object. Specifically, colour constancy is achieved
when ρ2 = Rρ1 , where R is a diagonal matrix describing
colour ratios [Lan77] for all surface colours, and ρ1 and ρ2
are vectors containing the response of the three types of cones
in our eyes under a first and a second illuminant. Colour constancy provides a stricter constraint than just luminance and
chrominance similarity. In fact, preserving colour constancy
suggests that the actual perceptual change may be smaller
than the computed E.
1.2. Method overview
In a typical AE system, a three-dimensional (3D) model of
the scene is first acquired and the projectors and camera are

Figure 1: Compliant appearance editing. (a) Photo of physical object. (b) Incompliant target appearance (synthetic). (c) Photo
of new appearance using our compliant target appearance. (d) Photo when na¨ıvely applying the original target appearance. (e)
Photo when reducing the original target appearance luminance until compliancy. (f–i) Close ups. Na¨ıvely using the original
target appearance produces unexpected colour shifts. Reducing luminance obtains correct colours but a very dim look. Our
approach yields the most perceptually similar appearance possible to the original target appearance.
c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

2290

A. J. Law et al. / Perceptually Based Appearance Modification for Compliant Appearance Editing

Figure 2: Modified appearance editing pipeline. Our method adds a step to a traditional appearance editing pipeline.
calibrated. Then, the projector-to-camera light transport is
modelled. Finally, compensation images for each projector
are generated which, when illuminating the scene, yield the
target appearance. We add an appearance modification step
to the pipeline (Figure 2), which seeks to minimally alter
the target albedo colours and, as an approximation to colour
constancy, to maintain their relative colour ratios.
The input to our method is a scene of one or more objects,
the scene’s physical surface albedo image As (pi ), and a target
appearance T(pi ) = At (pi )S(pi ). As and T are defined for all
surface points pi visible from an observer’s viewpoint (typically a camera). As and At are flat coloured albedo images;
As contains each surface point’s surface albedo under maximal projector illumination, and At contains the target colours
with no shading effects. S is the target appearance-shading
model (e.g. diffuse, specular). The output of our method is a
compliant target appearance Tc (pi ) = Ac (pi )S(pi ) where Ac is
a modified compliant albedo image and S is the same target
shading model.
Our appearance modification method first partitions the
scene’s surfaces into appearance editing patches which are
used to organize contiguous surface points with nearly the
same colour in both As and At . Patch creation is motivated
by the fact that all points in a patch require the same change
in colour during appearance optimization. Our appearance
optimization minimally alters the patches’ albedo colours At
and produces the compliant albedo colours Ac and thus the
compliant appearance Tc . When altering At ’s colours, we balance the preservation of three cues critical to perceptual similarity. First, maintaining the chrominance of At ’s colours is
important because uncontrolled chrominance change breaks
colour constancy and results in a dissimilar compliant appearance. Secondly, although luminance is invariably lost in
At to achieve compliancy, the loss should be kept small. Finally, maintaining the ratios of At ’s colours preserves colour
constancy thus further reducing the perceived difference between T and the modified Tc .
We have implemented a prototype AE system, which supports imparting new compliant appearances onto arbitrary
objects. We assume our objects contain diffuse surfaces
with no indirect illumination from projector light (e.g. interreflections). Further, although the imparted appearances can
have colour gradients due to shading and illumination, we
assume that both As and At consist of patches of nearly constant colour. Intuitively, this means that under ambient light,
the physical object and the target appearance should each
consist of contiguous regions of similarly coloured points.

Such an assumption is well suited for many man-made and
painted objects. In our results, we compare our compliant
appearances to the original, incompliant target appearances
ignoring compliancy issues as well as to appearances achieving compliancy by only reducing the appearance’s luminance. E is used to measure perceptual similarity. In all
cases, our method shows improved visual quality and perceptual similarity.
2. Previous Work
Most research in appearance editing has assumed the use of
compliant target appearances (e.g. [RWLB01, BRF01, BI08,
OOD09]) and has instead focused on computing compensation images to achieve the desired appearance. Some of these
works mitigate the appearance compliancy issue by dealing
strictly with white or near-white surfaces, which maximize
the gamut of compliant colours possible (e.g. [RWLB01,
BRF01, OOD09]). However, there is no guarantee that an
appearance is compliant.
Radiometric calibration is used in AE as a means to increase the accuracy of reproducing colours (e.g. [NPGB03,
GPNB04, WB07, GB08, SLM10]). However, radiometric
calibration cannot compensate for strong colour changes
where an insufficient amount of projector light radiance
makes achieving a target colour fundamentally impossible.
As a result, these incompliant colours are clipped in colour
space, resulting in undesirable and clearly visible colour
shifts. In this situation, one can increase the available projector light radiance at hard-to-edit areas by placing the projectors more head-on to these areas (e.g. [LAM10]), but there
is still no guarantee that a sufficient amount of light radiance
will be available to achieve the desired AE. The only way
to guarantee adequate projector light radiance is by adding
additional projectors to the AE setup. Because additional
projectors may not always be practical, we instead opt to
modify the target appearance to achieve a compliant AE.
Aliaga et al. [ALY08] consider an appearance’s compliancy by preferring target point colours to be darker than
surface albedo colours. Only considering luminance fails to
consider the full spectral reflectance of the surface. Suppose
a physical surface with a spectral reflectance curve containing high values near the red frequencies is to be edited to
a colour with high values in the blue frequencies, but lower
luminance. Although the luminance is reduced in this colour
change (and thus the change is luminance compliant), the
colour change is not possible due to a lack of energy in the
blue wavelengths of the surface’s spectral reflectance curve.

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

A. J. Law et al. / Perceptually Based Appearance Modification for Compliant Appearance Editing

Thus, although the compliancy of the appearance may be
improved, it is not guaranteed.
Achieving accurate colours has been addressed for
multi-projector display systems. Because a projector’s colour
properties change over space (due to overlapping projectors,
vignetting and intra-image variations due to projector hardware), a target image may look different than expected or
show noticeable seams. To achieve a smooth appearance
across the projected imagery, the projected images are modified (e.g., altering the brightness [MS05] or the colour gamut
[SLMG09]). Sajadi et al. [SLMG09] assure a smoothly
changing colour gamut between projected imagery. However, the projected imagery is not guaranteed to be compliant. Instead, the projections appear on standard white or
back-projection screens to minimize the chance and impact
of incompliancy. Further, the difference of the desired appearance and the projected appearance is not minimized. Thus,
the final colours obtained may be needlessly different from
the target colours.
Our work is also related to content-dependent gamut mapping. Such methods consider an image’s colour data (e.g.
[Bra99, HOK99, BF99]) and account for the spatial relationship between an image’s colours (e.g. [BDEW01, KSES05,
ZS07]) to map out-of-gamut image colours to in-gamut
display device colours, often assuming the gamuts are relatively similar. We consider both an appearance’s colours
and the spatial relationship between the colours to map a set
of incompliant colours to a set of compliant colours. Three
factors unique to our AE objectives differentiate our work
from typical gamut mapping methods: (i) each surface albedo
patch colour defines a target gamut of appearance compliant
colours based on its colour, geometry, and the available projector light radiance; (ii) target colours which span multiple
surface albedo colours must remain constant across multiple
appearance editing patches despite differences in the underlying surface albedo and while constraining the direction of
colour shifts of the target colours to the compliant target
gamut and (iii) the balance of maintaining the spatial ratios
of the target colours with minimizing the change to the target
colours further constrains the direction of the colour shifts of
the target colours to the compliant target gamut.

3. Colour Compliancy
A key concept in our appearance modification method is
ensuring the target appearance is compliant. Thus, we begin
the description of our approach by presenting a definition of
colour compliancy and describing a technique for measuring
it first in RGB space and then in Lab space.

2291

for a given surface albedo colour at a particular surface point.
Previous AE systems work with colour as a point in RGB
space (e.g. [RWLB01, GPNB04, ALY08, GB08]) where each
colour channel encapsulates both perceived chrominance and
perceived luminance. Thus, luminance increases monotonically within each RGB channel, and a simple approximation
to ensuring compliancy is to alter each target colour channel
so that each channel value is less than the amount of available projector light radiance. However, because chrominance
is not constant when varying any of the RGB colour channels,
achieving compliancy using this na¨ıve methodology implies
an obfuscated mix of changing perceived chrominance and
perceived luminance.
We define colours in Lab space to decouple a colour’s luminance and chrominance to separately and minimally alter
these components. Thus, achieving compliancy is no longer
verifying that each target colour’s channels are less than
the available projector light radiance. Instead, a new chrominance to luminance mapping must be created for each surface
point pi to determine whether or not a particular target colour
is compliant. To create this mapping, we use the compliancy
definition in RGB space (Section 3.2) as a building block for
the more accurate definition in Lab space (Section 3.3).

3.2. Light availability and compliancy in RGB space
In RGB space, the total amount of radiance available L in
a given M projector setup at a particular surface point pi is
defined by the 3D vector
M

L(pi ) = ba + Ag (pi )

bj +
i

Lmax (ni − lj )
,
dIj 2

(1)

where (ni − lj ) represents the angular attenuation due to
the projector-surface point orientation (assuming a diffuse
surface, lj is the directional vector to projector j and Lmax is
the maximum luminance available from a projector), 1/d2ij is
the distance attenuation from projector j to surface point pi ,
ba is a vector corresponding to ambient black-level lighting
and bj is a vector of the black-level colour of projector j.
For simplicity, we approximate L by assuming the values
for ba and all bj ’s are small and thus negligible; radiometric
calibration should compensate for their contributions as well
(unless the target colour is dimmer than the black level lighting, making it fundamentally impossible to achieve). Thus,
the approximate amount of radiance available L at pi is given
by the RGB vector
M

L(pi ) = As (pi )
i

Lmax (ni − lj )
.
dij 2

(2)

3.1. Definition
A target colour is compliant if the amount of projector light
radiance available is sufficient to produce the target colour

A target appearance is compliant if the amount of available projector light radiance is greater than or equal to each

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

2292

A. J. Law et al. / Perceptually Based Appearance Modification for Compliant Appearance Editing

channel of the target colour T(pi ) in each RGB channel:
L(pi ) ≥ At (pi )S(pi ).

(3)

Because our colour optimization—described in Section
5—modifies target albedo colours in At , we isolate At (pi )
by dividing by the scalar S(pi ) to yield an equivalent vector of inequalities which expresses per-RGB channel colour
compliancy. Along with expanding L, this yields
As (pi ) ×

1
S(pi )

M

j

Lmax (ni − lj )
≥ At (pi ).
dij 2

(4)

attenuation

For the case when S(pi ) = 0 (e.g. a point back-facing the
projectors), the attenuation is irrelevant because the point
will always be compliant (i.e. assuming no ambient blacklevel light, perfect black is always achievable).

field, and a denser sampling of a∗ and b∗ makes computing the
heightfield functions (Section 3.3.2) less efficient. For each
(a∗ , b∗ ) sample, the maximum value for Ln is found such
that the corresponding RGB vector is compliant given the
corresponding surface albedo colour As (pi ). This maximum
luminance value is computed by initializing Ln to 100 (the
maximum L∗ value) and iteratively decreasing Ln until compliancy is attained. Compliancy is determined by converting
(Ln , a∗ , b∗ ) to RGB space and ensuring that the resulting
RGB colour is compliant. Now, Hi satisfies As (pi ) ≥ At (pi ).
To account for attenuation due to the projector-object relationship and S, we scale each Ln by the attenuation factor in
Equation (4) to achieve the final heightfield Hi . The heightfield surface now represents a compliancy threshold with Lab
space colours below the surface being compliant and colours
above the surface being incompliant.

3.3.2. Compliancy heightfield functions
3.3. Light availability and compliancy in lab space
Our solution for creating the chrominance to luminance mapping in Lab space is a compliancy heightfield Hi specific to
each surface point pi , its albedo, and its amount of available
projector light radiance (Figure 3; the b∗ axis is omitted for
simplicity in the figure). This heightfield Ln =Hi (a∗ , b∗ ) takes
pi ’s surface albedo into account to describe the amount of
luminance available at pi for a desired target colour chrominance given the current projector setup. In other words, Ln
defines the maximum lightness for a given target colour’s
chrominance (a∗ , b∗ ) which can be achieved at pi in the current AE setup [i.e. the left-hand side of Equation 4 for a
chrominance (a∗ , b∗ )].

3.3.1. Compliancy heightfield construction
The heightfield Hi for a point pi is constructed by sampling
the a∗ and b∗ axes and computing Ln for each sampled (a∗ ,
b∗ ). Both a∗ and b∗ are sampled in their full ranges [−128,
128], each at sh unit intervals. In practice, we found sh =4 to
balance computational efficiency and modelling accuracy. A
sparser sampling of a∗ and b∗ produces a less accurate height-

Next, we describe two compliancy functions Ci (ti ) and Di (ti )
to extract information about a target colour T(pi ) using pi ’s
compliancy heightfield Hi . Because S(pi ) is incorporated
in Hi , both compliancy functions use ti = At (pi ), the target
albedo colour, as the colour input.
Ci (ti ) measures the compliancy of target colour T(pi ) at
surface point pi with compliancy heightfield Hi and is defined
as
Ci (ti ) = Hi (ti [a∗ ], ti [b∗ ]) − ti [L∗ ].

(5)

This function yields a scalar value where Ci ’s sign indicates compliancy or incompliancy and Ci ’s magnitude represents the degree of compliancy or incompliancy. To compute
Ci (ti ), the distance in L∗ between ti and Hi is measured. Intuitively, if ti [L∗ ] > Hi (ti [a∗ ], ti [b∗ ]) (i.e., comparing the luminance of ti and Hi (ti [a∗ ], ti [b∗ ])), then the target colour is
incompliant and Ci (ti ) < 0, else it is compliant and Ci (ti ) ≥ 0
(Figure 3).
Di (ti ) measures the perceptual distance between a target colour and its closest compliant colour. This function
also yields a scalar value, which is the minimum perceptual

Figure 3: Compliancy heightfield. The compliancy heightfield Hi , defined in Lab colour space, indicates the maximum luminance
∗
∗
for any desired chrominance at surface point pi . (Note: the heightfield is a 2D manifold but here only L and a axes are shown.)
Incompliant colours are above the heightfield surface with ci < 0, and compliant colours are beneath.
c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

A. J. Law et al. / Perceptually Based Appearance Modification for Compliant Appearance Editing

distance for an incompliant colour to become compliant. To
compute Di , a weighted distance from ti to the closest colour
on the compliancy threshold of Hi is used (Figure 3). The
weights (wL∗ , wa∗ , wb∗ ) enable different importance to be
given to luminance and to each of the chrominance axes (e.g.,
if wL∗ wa∗ , wb∗ , the L∗ axis is the most important to preserve,
and changes in luminance are penalized, which is conmensurate with human perception properties) and are used to
control the appearance optimization process. Although the
above is conceptually clear, in our implementation, we use
the weights to scale each component of ti as well as all sampled points on Hi , yielding values ti‘ and Hi‘ . Then, Di is
defined as a standard Euclidean distance between ti‘ and the
nearest surface point on Hi‘ .
4. Appearance Editing Patches
The next step is to create AE patches over the scene’s surfaces to succinctly formulate compliancy equations. Given
a scene’s surface albedo image and target albedo image,
patches are created by dividing the scene’s surfaces into regions containing a nearly constant surface albedo and a nearly
constant target albedo (Figure 4). With a per-projector pixel
radiometrically calibrated system, the albedos need not be exactly constant but only sufficiently similar so that all points
within a patch can be assumed to be changeable in a similar
manner. Overall, our partitioning strategy helps reduce and
avoid introducing unwanted sharp colour boundaries within
each patch.

2293

(e.g. mean shift segmentation [CM02]) on a photograph of
the scene under ambient light (in practice, a photo editing
tool is used afterwards to handle poorly segmented areas). At
is designed with constant colour patches for simplicity. Each
scene pixel is thus part of a single surface patch and is also
part of a single target patch. AE patches are then formed by
grouping contiguous pixels sharing the same surface patch
and target patch.
4.2. Selecting a representative patch point
For each AE patch k ∈ [1, p], a single representative surface
point rk is identified to characterize the patch in a formulation of compliancy for the entire scene. Because the captured model has a very large number of (scanned) surface
points, using all points when formulating patch compliancy
equations is prohibitive. By using a single surface point to
represent a patch’s compliancy across its surface, careful selection of rk is crucial for a robust appearance optimization
process. Na¨ıvely, one may wish to represent an entire patch
with a geometric averaging of the patch’s surface points (e.g.
average the positions and normals of the patch). Although
such a virtual point may seem to be a reasonable estimation
of a patch’s physical properties, it does not reflect the compliancy of any actual point on the patch. Further, it could
misrepresent compliancy and hence skew the colour optimization. Instead, we analyse the degree of compliancy [as
measured by C(pi )] of many points pi in patch k and choose
as rk a point whose compliancy is near the mean C(pi ) value
of the patch. An analysis of the impact of selecting different
points for rk ’s is presented in the results (Section 6).

4.1. Surface partitioning
The scene’s surfaces are partitioned into patches by grouping contiguous pixels sharing a similar surface albedo colour
and the same target albedo colour. Using the surface albedo
image As and the target albedo image At , pixels in each of
As and At are grouped into sets of contiguous similar-colour
patches, called surface patches and target patches, respectively. Colours in As are computed with colour segmentation

Figure 4: Appearance editing patches. (a) Using the surface
albedo, surface patches are created. (b) Similarly, using the
target albedo, target patches are created. (c) The appearance
editing patches used during appearance optimization group
contiguous pixels with the same surface patch colour and
same target patch colour.

5. Appearance Optimization
Appearance optimization uses all patches to iteratively alter
the target albedo colours At (rk ) to produce a set of compliant
albedo colours Ac (rk ) (and thus Tc ). The overall relationship
between a change in colour, a change in the colour ratio
between patches, and a change in compliancy is non-linear.
Our methodology uses a gradient descent based optimization
to iteratively find a colour-compliant solution that balances
colour changes and colour ratio changes. During each iteration, a set of linear equations is used to balance several
heuristics described in this section, and a small colour shift
is computed in the direction of steepest descent (over Dk )
towards compliancy for each patch. The patch colours are
changed until each rk lies below Hk ’s surface (or a maximum
number of iterations is reached).
5.1. Colour shifting methodology
We first define some notation: (i) ckm refers to the current
target colour of patch k during iteration m (i.e., ck 0 =At (rk )
is the initial target colour and ckm =Ac (rk ) for some, value of
m); (ii) tkm refers to the desired more compliant patch colour

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

2294

A. J. Law et al. / Perceptually Based Appearance Modification for Compliant Appearance Editing

during iteration m and (iii) skm = {Skml∗ , Skma∗ , Skmb∗ } refers
to the colour shift for patch k during iteration m, computed
via an optimization. If the amount of change in patch colours
and in patch colour ratios is ignored, compliant colours can
be calculated for each tkm in one iteration using the trivial
equations
skm = tkm − ckm ,

(6)

ck(m+1) = ckm + skm .

(7)

However, to reach a compliant appearance perceptually
similar to At , the simultaneous effect of all colour shifts are
considered in a linear optimization. Thus, several iterations
are needed to converge to a balanced solution.
The gradient gkm of each Dk (ckm ) is computed using finite
differences, and the next iteration’s target patch colours are
defined as
tkm =

ckm − dgkm if patch k is incompliant,
ckm + dgkm if patch k is barely compliant,

(8)

where d is a user-selected value (e.g. 0.05) controlling the rate
of change of ckm . For incompliant patches [Ck (ckm ) < 0], tkm
is moved towards compliancy. For barely compliant patches
(0 ≤ Ck (ckm ) ≤ τc , tkm is moved away from Hk ’s compliancy threshold towards a more compliant colour. Moving
barely compliant patches reduces patches from oscillating in
and out of compliancy provided that dgkm <τc . Colour constancy is preserved by allowing more compliant patch colours
(ck (ckm ) > τc ) to move freely because they are not at risk of
becoming incompliant in a single iteration. During each iteration, the set of incompliant and barely compliant patches
is updated, and colour shifts skm are computed via the linear
optimization.

closest compliant colour relative to a weighted importance
metric.

5.5.2. Patch ratio equations
Patch pair equations ensure colour constancy in the modified appearance by requiring that the colour ratio between
two AE patches remains similar to the original target appearance colour ratios. For all pairs of patches k1 and k2 ,
Rk1 k2 = ck1 0 /ck2 0 is computed as the original per-channel
colour ratio in Lab space. Then, during an iteration m, the
colour ratio of patch k1 to k2 is constrained to remain the
same after a colour shift by sk1 m and sk2 m ; namely,
ck1 m + sk1 m = Rk1 k2 (ck2 m + sk2 m ).

(9)

Perceptually, the importance amongst different patch pair
ratio equations is also dependent on the physical distance
between the two patches. Thus, a multiplicative weight wk1 k2
is added to each patch pair equation. Further, because a∗
and b∗ range from [−128, 128], their values are shifted to
[0, 256] when calculating the ratios. After some algebraic
rearrangement, the patch ratio equations become
wk1 k2 (sk1m − Rk1 k1 sk1 m ) = wk1 k2 (Rk1 k2 Ck2 m − ck1 m ), (10)
where wk1 k2 = dk1 k2 /dmax , dk1 k2 is the distance between
patches k1 and k2 , and dmax is the maximum distance between any two patches.
The number of patch ratio equations gets quite large for
scenes with complex surface albedos and target appearances. Hence, patch pairs where dk1 k2 ≥ d¯ kl kj + nd σd are ignored, where d¯kl kj is the average patch pair distance, σd is
the standard deviation of patch pair distances, and nd is a
user-defined threshold defining the magnitude of patch pair
distances to ignore.

5.2. Patch equations

5.3. Iterative optimization

To simultaneously solve for all skm ’s during an iteration of
the colour shifting process, a linear system consisting of
two types of equations is optimized. The equations aim to
have each ckm reach tkm while encouraging a desired balanced
change in colour and change in colour ratios.

5.2.1. Patch colour equations

Using these equations, a solution to the over-constrained
linear system is computed using linear least squares. For
further control, a weight α ∈ [0, 1] is provided to balance the
importance of patch colour equations to patch pair equations.
Given Pc patch colour equations, Pp patch pair equations and
a total of Pt =Pc +Pp equations, this results in the weights
α(pc /pt ) and (1 − α)(pp /pt ) to be multiplied into Equations
(6) and (10), respectively.

Patch colour equations focus on finding the most perceptually
similar appearance compliant colour for each AE patch. For
a patch k during iteration m, three straightforward linear
equations are defined by using Equation (6) for each colour
channel of incompliant and barely compliant patches. By
using equations for all three Lab channels and the weights
(wL∗ , wa∗ , wb∗ ) within Dk , the colour shifts are steered to the

The iterative optimization is terminated when: (i) all AE
patch colours result in a compliant target appearance; (ii) the
magnitude of the colour shift is underneath a threshold τp ; in
theory a E ≈ 2.3 is considered a just noticeable difference
[Sha03], however this value is derived from an unscaled Labspace; because our domain is scaled by (wL∗ , wa∗ , wb∗ ) small
iterative steps still may add up to a noticeable colour shift,

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

A. J. Law et al. / Perceptually Based Appearance Modification for Compliant Appearance Editing

thus we choose the conservative value of τp = 0.02 or (iii) a
maximum number of iterations is reached.

6. Results and Discussion
Our system acquires a model, calibrates the projectors and
camera, and captures projector-to-camera light transport similar to [ALY08]. Radiometric calibration is performed using
[SLM10] or [ALY08]. Then, a compliant appearance Ac is
computed for a given target appearance. For simple scenes,
Ac is computed in a few minutes using all patch ratio equations (nd = ∞). For complex scenes, we set nd = −1 to limit
computation time to about an hour. Weights for Di are set
to wL∗ = 5, wa∗ = 2 and wb∗ = 1 to discourage reducing luminance and encourage shifting in b∗ rather than a∗ . Shifting along the blue-yellow opponent channel was preferred
because the human visual system is believed to be less sensitive to shifts along this axis [LPA07]—because the sun
is yellow/white and the sky is blue. Hence, a shift in b∗ is
likely to be interpreted as a change in the illuminant (conveying colour constancy) whereas a shift in a∗ is likely to
be perceived as a change in the surface. The flexibility in
choosing weights enables our framework to be used in other
applications where shifts in other channels may be preferred.
Table 1 summarizes our experimental scenes and shows
the benefit of using our method’s compliant appearances as
compared to using na¨ıve appearances generated by reducing
the original target appearance’s luminance until compliancy
is attained. For each scene, the two resulting appearances’
average lightness (average L∗ value) and average E (1976
definition, when compared against the original target appearance) over the entire AE were computed. Our method’s
appearances yield a higher average L∗ and a lower average
E. This shows that considering both chrominance and luminance together can produce compliant appearances which
are both brighter and more perceptually similar to the target appearance when compared to appearances generated by

Table 1: Scene E. Average perceptual differences measured
by E across each scene. We compare the target appearance against
both our method’s compliant appearance and another compliant appearance na¨ıvely generated by only reducing the appearance’s luminance until compliancy is achieved. For all scenes, our compliant
appearance is brighter and more perceptually similar to the target

Our method
Scene
Ped-checker (Fig 5)
Ped argyle (Fig 8)
Pumpkin (Fig 1)
House (Fig 10)
Vases (Fig 9)

L∗
24.283
14.818
32.556
15.878
23.735

Lum reduction
E

30.123
3.970
18.471
43.348
18.403

L∗
9.144
14.319
11.693
2.933
16.484

E
47.497
24.533
38.071
51.143
25.939

2295

only considering luminance. The absolute E values shown
are not very relevant because the intensity level of the (synthetic) original target appearance is arbitrary—a very bright
original target appearance may fundamentally require a drastic change given a limited amount of projector light radiance.
Instead, the relative change in E is more important because
it indicates the amount of perceptual change required by
each approach to reach compliancy. Moreover, because our
method attempts to preserve colour constancy, our resulting
appearances may be even more perceptually similar than the
calculated E values. Hence, although our method reports
relatively large E values, the perceptual error might be significantly less during an observation. Regardless, although
some resulting modified appearances may not seem perceptually equivalent (and numerically such due to some relatively
large E values), the modified appearances nonetheless are
generally perceptually similar enough to convey the same
information of the original target appearances.
Figure 5 contains an exemplary appearance edit and some
comparisons. The physical object and incompliant target appearance are shown in Figures 5a and b, and photos of the new
appearances are shown in Figures 5c and e. As demonstrated
by Figures 5f and g, a na¨ıve use of the target appearance
using a system similar to [ALY08] and no appearance modification results in large changes in colour—a colour shift
occurred. Figures 5h and i show that reducing the target
appearance’s luminance achieves compliancy but an overall
dim look. These visualizations are computed using a perpixel E strictly over the chrominance and luminance aspects of the colours, respectively. Our appearance balances
this trade-off. Close-ups are provided in Figures 5j–m.
In Figure 6, we analyse the effect of α which controls the
importance between individual patch colours and patch-topatch colour ratios. Figure 6(a) shows a portion of a target
appearance, and Figure 6(b) shows a photograph sequence
of compliant AEs using α values in the range [0,1] (the
full appearance is shown in Figure 1). Appearances using
low α show reduced luminance. In contrast, appearances
using high α appear brighter but with obvious chromatic
errors: colour details are washed out in the bottom half of
the shown appearance, and there is inappropriate relative
brighting of the petal near the middle of the image. Figure
6(c) shows a quantitative comparison. E represents colour
difference using a scalar; however, the particular selection of
weights for the luminance and chrominance components can
significantly alter the resulting value. Thus, we decompose
E into a normalized luminance error and a normalized
chrominance error. The red curve shows the luminance error;
conmensurate with the images, the brighter appearances at
larger α values have a smaller error. The blue curve shows
the chrominance error with a clear U-shape curve having a
minimum near α = 0.66. We typically use α ∈ [0.5, 0.66].
Figure 7 demonstrates the effect of selecting different
representative patch points rk to achieve the appearance in

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

2296

A. J. Law et al. / Perceptually Based Appearance Modification for Compliant Appearance Editing

Figure 5: Example pipeline. (a) Photo of physical object. (b) Image of incompliant target appearance. (c) Photo of AE using
our compliant appearance image. (d) Photo of AE na¨ıvely using target appearance. (e) Photo of AE when reducing luminance
until compliancy. (f and g) Colourmap showing chromatic difference of (b) against (c) and (d) where blue-cyan-green-yellow-red
maps to increasing difference. (h–i) Colourmap showing luminance difference of (b) against (c) and (e). Results in (f) and (h)
indicate better perceived similarity of our solution to the target. (j–m) Close-up views.

Figure 6: Analysis of colour change vs. patch-ratio change. (a) Image of target appearance. (b) Photos of a compliant AE using
various α values. (c) Graph showing the normalized luminance and chrominance components of E for the shown images.
Low α values produce dim appearances but have reasonable chromatic accuracy. High α values produce brighter appearances
but have noticeable chromatic errors.
Figure 1. For a patch k, we calculate the mean patch compliancy value C¯k and its standard deviation σCk over all patch
points and select τk based on these values. Selecting a point
with an initial compliancy value less than C¯ k (e.g. C¯ k − σCk

or C¯ k − 2σCk ) encourages an aggressive colour shift towards
compliant colours at the expense of luminance (Figure 7a and
b). In contrast, selecting a point with an initial compliancy
value greater than C¯ (e.g. C¯ k + σCk or C¯ k + σCk ) encourages

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

A. J. Law et al. / Perceptually Based Appearance Modification for Compliant Appearance Editing

2297

Figure 7: Analysis of selecting representative patch point. (a) Image of the target appearance. (b) Photos a compliant AEs
with varying values for x during AE patch creation. Selecting a representative patch point rk with a compliancy of C¯ k + xσck for
x < 0 yields very compliant colours at the expense of luminance. Ark near C¯ k + xσck for x > 0 yields a brighter appearance but
incorrect chromatic behavior (b).

Figure 8: Complex albedo object. Photos of an AE on an object with a complex albedo. (a) Photo of the physical object. (b)
Image of incompliant target appearance. (c) Our method produces a bright compliant AE. (d) AE na¨ıvely using At results in the
surface albedo bleeding through. (e) Only reducing luminance to achieve compliancy results in a dim look.
a brighter solution, but because more patches will be seen as
compliant prior to appearance optimization, a fewer number
of incompliant patches steer the colour optimization, potentially resulting in unappealing colours and colour ratios. We
choose a point with a compliancy value near C¯ k to obtain
a reasonable balance—this corresponds to the intersection
of the normalized luminance and chrominance error components in Figure 7(c).
In Figure 8, we physically change the surface albedo of
the object used in Figure 5 to a more complex albedo pattern
to demonstrate non-additive appearance changes (Figure 8a).
The argyle pattern shown in Figure 8(b) is then imparted onto
the object. Figures 8(c)–(e) contain photos of the resulting
AEs. Na¨ıvely using the incompliant target appearance results
in the surface albedo’s colour bleeding through and causing
‘ghosting’ patterns mostly on the bottom half of the object,
achieving compliancy by only reducing the luminance of

the appearance results in an overly dim look, and using our
method results in a brighter, more perceptually similar compliant appearance. The small amount of ‘ghosting’, which
remains is due to inaccuracies in the radiometric calibration
rather than the compensation compliancy of the modified
appearance.
Figure 9 shows the interdependency between patches on
different objects. Compliancy is easy to achieve for the top
half of both objects but not for the bottom halves. The compliant appearance obtained by reducing the luminance of the
target image (Figure 9a) results in a dim look for the bottom
of the left object (Figure 9c) when compared to our compliant solution (Figure 9b). A na¨ıve AE using the original target
appearance results in a colour shift to the bottom halves of
both objects: the new appearance of the bottom of the left
object is more beige and that of the bottom of the right
object is more blue (Figure 9d). Our method balances the

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

2298

A. J. Law et al. / Perceptually Based Appearance Modification for Compliant Appearance Editing

Figure 9: Two-object scene. (a) Incompliant target appearance (synthetic). (b) Photo of AE using our compliant appearance.
(c) Photo of AE when reducing luminance until compliancy. (d) Photo of AE na¨ıvely using target appearance. (e) Photo of the
physical objects. This example shows the interdependency between patches of different objects. Although (c) maintains colours,
it results in a dim look for some parts of the scene. In contrast, (d) is overall bright but has uncontrolled colour shifts. Our
solution in (b) achieves a controlled balance.

Figure 10: Extreme case. (a) Photo of physical object and computed surface albedo. (b) Incompliant target appearance and
target albedo (both synthetic). (c) Our resulting appearance and albedo. d) Photo of AE na¨ıvely using target appearance. (e)
Photo of AE using our appearance. The strong colour change of the target appearance is severely limited by the underlying
surface albedo. A na¨ıve AE results in the surface colours bleeding through and in the relative colours of the target appearance
not being achieved. Our appearance reduces colour bleeding and maintain the relative ratios (e.g. of hue, saturation, and
contrast) of the appearance, however some ‘ghosting’ of the underlying surface albedo remains.
opposing chrominance and luminance requirements. Although a mild colour shift is present, patch colour ratios
are mostly maintained.
Figure 10 demonstrates an AE of an object with a complex surface albedo needing an extreme amount of colour
modification due to the large amount of light required to

achieve the desired colours. The various albedos used are
shown in Figures 10(a)–(c). Figure 10(d) shows a photo of a
clearly incompliant AE produced by na¨ıvely using the target
appearance. Our resulting AE is shown in Figure 10(e). In
this example, our resulting appearance significantly reduces
the ‘ghosting’ of the underlying surface albedo shown in
Figure 10(d) and better maintains the colour ratio of the

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

A. J. Law et al. / Perceptually Based Appearance Modification for Compliant Appearance Editing

top, middle and bottom bands of the object. However some
‘ghosting’ remains despite the appearance undergoing significant colour change. As discussed in Figure 7, selecting
different rk ’s with compliancy values less than C¯ k would
produce a dimmer, more likely to be fully compliant appearance. Improved radiometric calibration which models colour
mixing would help as well.
7. Conclusions
We have presented a novel method to achieve compliant AEs
of physical objects using digital projectors. Our work addresses an area mostly overlooked by previous AE systems.
Ignoring the compliancy of a target appearance might cause
the produced appearance to significantly differ from what
is expected, even with accurate geometric and radiometric
calibration. Prior systems use white surfaces or assume a
compliant target appearance. Our work considers both the
chrominance and luminance components of the target appearance, encodes human perception cues into equations, and
performs an appearance optimization to yield a perceptually
similar, but compliant, appearance.
7. Limitations and Future Work
The main limitations of our method include the assumption that the scene is diffuse and the supposition that the
object surfaces can be divided into patches of nearly constant colour. Although the first limitation can be addressed
with improved acquisition and radiometric calibration, the
latter poses more challenges. Using a different definition for
patches (e.g. patches with chromatic patterns or a chromatic
gradient) is an area of future work. Exploring the use of multiple surface points to represent a patch may also provide a
more accurate representation of the object’s surface, possibly improving the resulting compliant appearance. We would
also like to support dynamically changing appearances. This
would require accelerating the appearance modification compute time and incorporating temporal coherence to reduce
unexpected colour shifts over time. We would like to explore
AE in brightly lit rooms. AE is currently supported only in
dark rooms. Non-trivial ambient light reduces the available
range of colours, making dark colours impossible to achieve
for a physically light surface patch. Finally, we would also
like to conduct user studies to further evaluate our appearance modification method and to better understand the value
of preserving colour constancy though changing absolute
colour values.

2299

variations. Journal of Imaging Science and Technology,
45, (2001), 436–482.
[BRF01] BANDYOPADHYAY D., RASKAR R., FUCHS H.: Dynamic shader lamps: Painting on movable objects. In
Proceedings of IEEE/ACM International Symposium on
Augmented Reality (New York, NY, USA, 2001), IEEE
Computer Society, 207–216.
[BI08] BIMBER O. and IWAI D.: Superimposing dynamic
range. ACM Transactions on Graphics, 27, 5 (2008).
[BIW08] BIMBER O., IWAI D., WETZSTEIN G., GRUNDHOEFER
A.: The visual computing of projector-camera systems. Computer Graphics Forum, 27, 8 (2008), 2219–
2245.
[Bra99] BRAUN G.: A Paradigm for Color Gamut Mapping
of Pictorial Images. Ph.D. thesis, Rochester Institute of
Technology, 1999.
[BF99] BRAUN G., FAIRCHILD M.D.: General-purpose gamut
mapping algorithms: evaluation of contrast-preserving
rescaling functions for color gamut mapping. Journal of
Imaging Science and Technology (2000), 343–350.
[CM02] COMANICIU D., MEER P.: Mean shift: A robust approach toward feature space analysis. IEEE Transactions
on Pattern Analysis and Machine Intelligence, 24, (2002),
603–619.
[GB08] GRUNDHO¨ FER A., BIMBER O.: Real-time adaptive radiometric compensation. IEEE Transactions on Visualization and Computer Graphics, 14, 1 (2008), 97–108.
[GPNB04] GROSSBERG M. D., PERI H., NAYAR S. K.,
BELHUMEUR P. N.: Making one object look like another:
controlling appearance using a projector-camera system.
In Proceedings of IEEE Conference on Computer Vision
and Pattern Recognition, 1 (Washington, DC, USA, 2004),
IEEE Computer Society, 452–459.
[HOK99] HUNG-SHING C., OMAMIUDA M., KOTERA H.:
Adaptive gamut mapping method based on image-todevice. Proceedings of IS&Ts NIP 15, International
Conference on Digital Printing Technologies (Orlando,
FL, USA, 1999), Society for Imaging Science and Technology, 346–349.

[ALY08] ALIAGA D., LAW A., YEUNG Y.: A virtual restoration stage for real-world objects. ACM Transactions on
Graphics, 27, 5 (2008).

[JF07] JOHNSON T., FUCHS H.: A unified multi-surface, multiresolution workspace with camera-based scanning and
projector-based illumination. In Proceedings of Eurographics Symposium on Virtual Environments-Immersive
Projection Technology Workshop (Weimar, Germany,
2007), Eurographics Association.

[BDEW01] BALASUBRAMANIAN R., DEQUEIROZ R., ESCHBACH
R., WU W.: Gamut mapping to preserve spatial luminance

[KSES05] KIMMEL R., SHAKED D., ELAD M., and SOBEL
I.: Space-dependent color gamut mapping: A variational

References

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.

2300

A. J. Law et al. / Perceptually Based Appearance Modification for Compliant Appearance Editing

approach. IEEE Transactions on Image Processing, 14, 6
(2005), 796–803.
[Lan77] LAND E. H.: The Retinex theory of color vision.
Scientific American, 237, (1977), 108–128.

[RWLB01] RASKAR R., WELCH G., LOW K. L.,
BANDYOPADHYAY D.: Shader lamps: Animating real
objects with image-based illumination. In Proceedings
of Eurographics Workshop on Rendering Techniques
(London, UK, 2001), Springer, 89–102.

[LAM10] LAW A., ALIAGA D., MAJUMDER A.: Projector
placement planning for high quality visualizations on realworld colored objects, IEEE Transactions on Visualization
and Computer Graphics, 16, 6 (2010), 1633–1641.

[SLM10] SAJADI B., LAZAROV M., MAJUMDER A.: ADICT:
Accurate direct and inverse color transformation. In Proceedings of European Conference of Computer Vision
(Crete, Greece, 2010), Springer.

[LPA07] LEE B. S., PIZLO Z., ALLEBACH J. P.: Characterization
of red-green and blue-yellow opponent channels, Journal
of Imaging Science and Technology, 51, 1 (2007), 23–33.

[SLMG09] SAJADI B., LAZAROV M., MAJUMDER A., GOPI M.:
Color seamlessness in multi-projector displays using constrained gamut morphing, IEEE Transactions on Visualization and Computer Graphics, 15, 6 (2009).

[MS05] MAJUMDER A., STEVENS R.: Perceptual photometric seamlessness in tiled projection-based displays. ACM
Transactions on Graphics, 24, 1 (2005).
[NPGB03] NAYAR S. K., PERI H., GROSSBERG M. D.,
BELHUMEUR P.N.: A projection system with radiometric
compensation for screen imperfections. In Proceedings
of ICCV Workshop on Projector-Camera Systems (Nice,
France, 2003), IEEE Computer Society.
[OOD09] OKAZAKI T., OKATANI T., DEGUCHI K.: Shape reconstruction by combination of structured-light projection
and photometric stereo using a projector-camera system.
In Proceedings of Pacific Rim Symposium on Advances
in Image and Video Technology (Tokyo, Japan, 2009),
Springer, 410–422.

[Sha03] SHARMA G.: Digital Color Imaging Handbook (1.7.2
ed.). CRC Press, (2003).
[Wan95] WANDELL B. A.: Foundations of Vision. Sinauer
Associates, Inc., (1995).
[WB07] WETZSTEIN G. and BIMBER O.: Radiometric compensation through inverse light transport. In Proceedings
of Pacific Graphics, (Canmore, Alberta, Canada, 2003),
IEEE Computer Society, 391–399.
[ZS07] ZOLLIKER P. and SIMON K.: Retaining local image information in gamut mapping algorithms. IEEE
Transaction on Image Processing, 16, 3 (2007), 664–
672.

c 2011 The Authors
Computer Graphics Forum c 2011 The Eurographics Association and Blackwell Publishing Ltd.


DOI: 10.1111/j.1467-8659.2011.01932.x
Eurographics / IEEE Symposium on Visualization 2011 (EuroVis 2011)
H. Hauser, H. Pfister, and J. J. van Wijk
(Guest Editors)

Volume 30 (2011), Number 3

Complete Tensor Field Topology on 2D Triangulated
Manifolds embedded in 3D
C. Auer†1 and I. Hotz‡1
1 Zuse

Institut Berlin, Germany

Abstract
This paper is concerned with the extraction of the surface topology of tensor fields on 2D triangulated manifolds
embedded in 3D. In scientific visualization topology is a meaningful instrument to get a hold on the structure of a
given dataset. Due to the discontinuity of tensor fields on a piecewise planar domain, standard topology extraction
methods result in an incomplete topological skeleton. In particular with regard to the high computational costs of
the extraction this is not satisfactory. This paper provides a method for topology extraction of tensor fields that
leads to complete results. The core idea is to include the locations of discontinuity into the topological analysis.
For this purpose the model of continuous transition bridges is introduced, which allows to capture the entire
topology on the discontinuous field. The proposed method is applied to piecewise linear three-dimensional tensor
fields defined on the vertices of the triangulation and for piecewise constant two or three-dimensional tensor fields
given per triangle, e.g. rate of strain tensors of piecewise linear flow fields.
Categories and Subject Descriptors (according to ACM CCS):
Generation—Tensorfield visualization, surface topology

1. Introduction
Visualization and data analysis are tasks that often go hand
in hand. The application of topological methods has the benefit that it accounts for both. They identify essential structures in a given field and serve as visualization as well. However the extraction of the complete topology of a dataset
given on a piecewise planar domain can be a challenging
problem. For instance, given an explorative framework for
volumetric 3D tensor fields [KMH11] it is highly desirable
to provide an investigation of planar or manifold cuts of the
entire field with distinctive properties and at reduced complexity. These cuts or also geometries in flow fields are often given as 2D triangulations embedded in 3D. Commonly
the intrinsic properties of such datasets are investigated on
the projected data [Tel08]. On piecewise planar domains
this yields piecewise continuous datasets. To analyze these
datasets by extracting the entire topology, in terms of surface
topology, special attention has to be given to the locations
of discontinuity on those triangulations – namely edges and

† auer@zib.de
‡ hotz@zib.de
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

I.3.3 [Computer Graphics]: Picture/Image

vertices. Many achievements have been made on the topic
of surface topology for vector and tensor fields, however the
fact that topological features are also located in discontinuous locations is mostly out of focus. If their investigation is
omitted the extracted surface topology is obviously not complete. A simple but evidentiary example is that of a piecewise
constant tensor field defined on a cuboid. On the faces of the
cuboid the tensor fields are constant. Approaches only investigating the faces would fail to detect a degeneracy on
the cuboid, although the Poincare-Hopf theorem states that
no closed surface with a non-constant field defined on it can
be without a critical point (Fig. 1(a)).
This paper provides a simple model to treat discontinuous fields defined on 2D triangulations embedded in 3D.
Thereby we focus on the topology of symmetric tensor fields
of second order, while many ideas are more general and
could also be applied to vector fields. We consider two applications. First, continuous 3D tensor fields projected onto
a surface, which are of interest when analyzing stress tensor
fields on distinguished geometries. The projected tensor field
expresses intrinsic properties to the given surface. Second,
piecewise constant 2D tensor fields are considered defined
per triangle. Such tensor fields naturally arise when consid-

832

C. Auer & I. Hotz / Complete Tensor Field Topology on 2D Triangulated Manifolds embedded in 3D

ering derivatives of piecewise linear vector fields, e.g. a wall
shear flow field of a body embedded in a flow.
The model of transition bridges is introduced (Sect. 4) that
allows to compute topological features in the locations of
discontinuity (Sect. 5). The topology of the tensor fields is
computed locally in two-dimensional space. Our approach
is an extension of the work of Sreevalsan et al. [SNAHH11],
who compute the topology on planar triangulations.

2. Related Work
Tensor fields have very application specific characteristics,
for which a variety of visualization methods have been developed. Most efforts have been put into tensors from diffusion tensor imaging (DTI) and mechanical engineering applications, which is the main application area for our work.
Existing visualization and analysis methods can roughly be
classified into glyph-, texture- and topology-based methods.
A complete review of these methods is beyond the scope
of this paper. A collection with related papers can be found
in [WH05, LW09]. Here, we focus on topological analysis
of tensor fields and related work for vector fields on triangulated surfaces.
There has been a lot of recent research in extraction,
simplification and visualization of tensor field topology, on
which this work builds. The idea of using topological methods to analyze the structures of 2D tensor fields goes back
to Delmarcelle [DH94, Del94] and Lavin et al. [LBHL97].
They have introduced the topological skeleton consisting of
degenerate points and connecting tensor lines as central features. Tricoche et al. [TSHC01] improved these ideas for applications of complex 2D tensor fields, by developing algorithms to simplify the tensor field topology and to track it
over time. Zheng et al. [ZP04] picked up the work in 3D
tensor topology initiated by Hesselink et al. [HLL97]. Their
analysis shows that in three dimensions degenerate elements
form one-dimensional structures. A reformulation by Tricoche et al. [TKW08] leads to a definition of these degenerate lines as crease lines of a tensor invariant. This allows
the adaptation of methods from scalar field analysis for degenerated elements extraction. Tensor field analysis is also
becoming more and more interesting in context with flow
analysis. The tensor of interest is the gradient of the vector
field, which is not symmetric. Zheng et al. [ZP05] extend
the topological analysis to 2D general (asymmetric) second
order tensor fields. Zhang et al. [ZYLL09] continued this approach. At the core of their analysis is a reparameterization
of the tensor space, which allows to understand the topology
of tensor fields by studying the manifolds of eigenvalues and
eigenvectors.
Tensor field topology as means for a structural segmentation of 2D tensor fields is provided by Sreevalsan-Nair
et al. [SNAHH11]. They consider the integral topological
skeleton using both major and minor eigenvector fields. This

results in curvilinear cells bounded by tensor lines and delineates regions of equivalent eigenvector behavior. Traditionally the component-wise linear interpolation has been used
in context with tensor field topology. An eigenvector-based
interpolation as basis for the topology extraction is proposed
in [HSNHH10].

There has not been much work on the extraction of tensor field topology on piecewise planar surfaces. However a
few publications deal with the related problem for vector
fields, which is often referred to as 2.5 dimensional topology. Already Helman and Hesselink recognized the importance of surface topology [HH90]. While focusing on the
related flow phenomena they are not concerned with issues
arising for piecewise planar surface representations. Kenwright [KHL99] proposed to investigate the wall shear stress
vector field, which is a tangential vector field, to find separation and attachment lines in a flow around an embedded
object. This idea has been further followed by Tricoche et
al. [TGS05] who also recognize the problem of discontinuities of the tangent vector field on piecewise planar surfaces. They propose a solution for a consistent integration of
streamlines is discussed. Li at al. [LV∗ 06] model arbitrary
higher order singularities represented at vertices on simplicial surfaces. The focus lies on the introduction of an appropriate vector interpolation schema on the mesh. Central to
this interpolation is an integer called the period jump, which
is associated to each dual edge of the triangulation. The primary goal of this method is to find a good discrete approximation for continuously given vector fields and not the analysis of a given field. The detection of the complete set of
singularities is not guaranteed. Another approach is followed
by Zhang et al. [ZMT06] with the purpose of vector field design for texture synthesis. To create continuous vector fields
on curved surfaces represented as meshes, they use geodesic
polar maps and parallel transport to interpolate vector values defined at the vertices of the mesh. This yields a nonlinear vector field inside each triangle, loosing the simplicity of linearity. Later this work has been extended to tensor
fields [ZHT07]. Garth et al. [GLT∗ 07] extract the boundary
topology of engine simulation data. In their work they hint
at the necessity of integrating so-called ‘singular edges’ into
the topological analysis. In context with vector field singularity tracking on curved surfaces Wiebel et al. [WTS∗ 07]
observe singularities disappearing in vector field discontinuities. They propose to tackle this problem by parameterizing
the mesh such that further computation can be carried out
in the plane. The singularities are then mapped back onto
the triangle mesh. They avoid to compute a global parameterization of the whole surface restricting the analysis to
subregions of the triangle mesh, which are homeomorphic
to a disc and without sharp edges. However these parameterizations have to be computed involving a distortion of the
triangles. A further overview of topology-based methods in
flow visualization can be found in [LHZP07].
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

C. Auer & I. Hotz / Complete Tensor Field Topology on 2D Triangulated Manifolds embedded in 3D

(a)

(b)

(c)

Figure 1: (a) Cuboid with piecewise constant tensor field
(red tensor lines). All degenerate points fall into vertices.
Result for analytic datasets (b) trisector degenerate point (c)
wedge degenerate point, both found in virtual vertex cells.
Degenerate points depicted as spheres, separatrices as red
and blue lines.

3. Basics and Notation
This sections surveys the necessary basics and notations underlying the approach of complete topology extraction. Note
that in the following all 3D entities are denoted using boldface letters, while for 2D entities regular letters are used.
3.1. Tensors
Tensors are multilinear functions that encode anisotropic
properties which vary in dependence of direction. Using
tensors and the underlying mathematics, physical phenomena can be formulated and analyzed. Tensors allow to describe entities that scalars and vectors cannot describe sufficiently (e.g., the stress at a point in a continuous medium
under load). Physical phenomena can naturally be described
by tensors independently of a frame of reference. For an
extensive introduction on tensors please refer to [AMR88]
or [Dan97].
Tensor fields we are interested in are defined by symmetric,
second order tensors D(r), r ∈ Rn with n = 2, 3. Represented
in a fixed coordinate basis such tensors can be described by
a symmetric (n × n) square matrix. The eigenanalysis on a
tensor delivers its eigenvectors vi , i = 1, .., n, and associated
eigenvalues λi , i = 1, .., n, which in turn uniquely characterize the tensor. The eigenvectors associated with the smallest
or the largest eigenvalue respectively are discerned by minor and major eigenvector. This leads to a major and minor
eigenvector field and also major and minor eigenvalue fields.

833

tors are undefined. These points are the equivalent to critical points in vector field topology. Mostly they occur as
isolated degenerate points, however depending on the interpolation degenerate lines and triangles may also play a
substantial role. For linear fields the only types of degenerate points are wedge points and trisector points, for example
see Figures 1(b),(c). Separatrices, connecting the degenerate
points, partition the tensor field into regions of qualitatively
homogeneous eigenvector behavior. They are specific tensor lines, which are integral lines everywhere tangential to
the eigenvector fields. In contrast to the standard approach
and according to Sreevalsan et al. [SNAHH11], we combine
the topology of both major and minor eigenvector fields.
This delivers a topological graph, the integral topological
graph [ASNZH11], which also constitutes a segmentation
of the tensor field into curvilinear cells.
3.3. Tensor Field on Polyhedron Structure
Input for our topology extraction is a tensor field given on
an orientable 2D embedded manifold, which is triangulated.
To store the manifold we use the CGAL polyhedron structure [CGA]. It provides a structure for geometric meshes
with vertices, halfedges and facets with their incidences. In
our case the facet shape is restricted to triangles. The CGAL
polyhedron structure holds vertices per triangle in counterclockwise order with respect to the oriented surface normal
n. This facilitates global orientation consistency, when oriented angles are calculated across locations of discontinuity.
Each triangle has its own local 2D coordinate system, explained in Subsection 3.4. This paper treats two cases: in the
first case 3D tensors D are given at the triangle vertices and
will be projected onto the surface (Sect. 3.4). This yields in
different tensor values in the vertex for each adjacent triangle, causing discontinuities in the surface tensor field. In the
second case piecewise constant 2D tensors D per triangle are
given. The projected 2D tensors are stored locally for each
triangle in the vertices and the constant 2D tensors for each
triangle. If not stated differently vertex points of triangles
are denoted by Pi , i = 1,2,3 and a halfedge ei denotes the
halfedge opposite to Pi . For technical issues about the polyhedron structure we will refer to facets, for details on the
semantic model, i.e. interpolation we refer to triangles.
3.4. Local Coordinate System and Projection Matrix

3.2. Surface Topology – Integral Topological Graph
Since we restrict the topological analysis to the projection
of the tensor field onto two-dimensional sub-manifolds we
only consider two-dimensional tensors in the following. The
surface topology of a tensor field is given by a topological graph. This topological graph consists of two main elements: degenerate points and its edges, the separatrices.
Comprehensive introductions into this field can be found
in [Del94, Tri02]. Degenerate points are locations in the tensor field where eigenvalues are equal, λ1 = λ2 and eigenvecc 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Every triangle T of the polyhedron structure has its own
Cartesian 2D coordinate system and 2D tensor(s). The local coordinate system is defined by the origin O = (0, 0) and
two basis vectors x = (1,0), y = (0,1). Its 3D counterpart is
denoted by boldface letters with origin O and basis vectors
x, y ∈ R3 and is also stored for each triangle. O is a randomly
chosen vertex of the triangle T , x is parallel to a halfedge
starting from the origin vertex and y = x×n is right-handed
orthogonal to x with respect to the surface normal n of T
(Fig. 2(b)). The projection matrix P: R3→R2 into the local

834

C. Auer & I. Hotz / Complete Tensor Field Topology on 2D Triangulated Manifolds embedded in 3D

basis systems is defined as P = (x y). The 3D tensors in vertices are projected onto the triangles with D = PT · D · P. Locally all necessary operations can be performed in 2D and
the basic concepts of [SNAHH11] can be applied for the
topology extraction, see Section 5.
3.5. Interpolation Model
An important concept introduced in [SNAHH11,
HSNHH10] is that of eigenvector-based linear interpolation for 2D tensor fields. In contrast to component-wise
interpolation it decouples shape and direction, represented
by eigenvalues respective eigenvectors. To assure that the
eigenvector interpolation is well defined additional vertices
are inserted in degenerate points, which are assigned
zero eigenvectors. The problem of eigenvector direction
indeterminacy is resolved by introducing edge labels. They
encode the relative orientation of the calculated eigenvectors
in adjacent vertices of a triangle, see also Equation 2.
After computing these edge labels once, simple vector
interpolation is performed inside the triangles.
In this work the eigenvector-based interpolation model is
employed with only a slight difference: due to the discontinuities in the tensor and thus eigenvector field, edge labels
may differ for adjacent triangles. Therefore edge labels are
assigned to halfedges and stored in their associated triangle.
Given a halfedge ei with vertex points P j , Pk and their associated 2D eigenvectors v j ,vk of the projected tensors the
label is calculated as follows:

if v j · vk > 0
 1
−1 if v j · vk < 0
(1)
l(ei ) =

0
if v j · vk = 0
Using these labels piecewise linear interpolation can be defined on the manifold. Let Pi , i=1,2,3, be the vertex points
of a triangle and vi , wi major and minor eigenvectors in Pi .
such that vi , wi always form a right-handed system. Further
λi , µi are the major and minor eigenvalues in Pi and βi the
barycentric coordinates of the point to be interpolated.
v(β1 , β2 , β3 )
w(β1 , β2 , β3 )

=
=

β1 v1 + β2 l(e3 )v2 + β3 l(e2 )v3 ,
β1 w1 + β2 l(e3 )w2 + β3 l(e2 )w3

λ(β1 , β2 , β3 ) = ∑ βi λi ,

µ(β1 , β2 , β3 ) = ∑ βi µi

connecting transition bridge can be flattened without distortion (Fig. 2(b)). The flattened bridges serve as planar virtual
edge cells on which a continuous interpolation is defined and
2D methods can be applied. Similarly virtual vertex cells are
defined as cells bounded by the adjacent virtual edge cells
(Fig. 2(c)). There is no need for an explicit definition of the
virtual vertex cells and an interpolation in their interior. It
is only important that tensor behavior along the boundaries
can be reconstructed continuously. The boundary of virtual
edge cells and virtual vertex cells are homeomorphic to a
piecewise smooth, simple and closed curve defining a Jordan curve. This allows to calculate the tensor index [Del94]
in the locations of discontinuity for the detection of degeneracies (Sect. 5). The Jordan Curve of the virtual cells is depicted as red lines in Figures 2(a)-(c).
4.2. Interpolation in Virtual Edge Cells
Let e be a normalized vector parallel to the edge constituting
the virtual edge cell. Further let T , T be the adjacent triangles with normals n , n . The tensor field inside a virtual
edge cell is defined by interpolating the 2D tensors Di and
Di , i = 1, 2 of the adjacent triangles. To do this in a consistent way these tensors need to be represented in matching
frames of reference. In analogy to the definition of the local
basis in Section 3.4 we define (Fig. 2):
• O = O = P0
• x =x =e
• y = e×n , y = e×n
The frames of reference smoothly transform into each other
across the transition bridge. By flattening the bridge the
frames of reference become equal without distortion.
Please note that the transformation of the original values into
matching frames of reference is a costly operation, be it for
computation time or storage. Additionally every newly reprojected tensor requires an eigenanalysis. In our approach
we will avoid this costly step, whenever possible.
4.3. Rotation of Eigenvectors across Transition Bridges

(2)
(3)

4. Continuous Model
4.1. Virtual Edge and Vertex Cells – Bridging the Gap
This section introduces the concept of continuous transition
bridges. They are models for a curved surface connecting
two triangles at their common edge imagined as a piece of
cylinder. The normal on this surface smoothly varies from
one triangle normal to the other triangle normal (Fig. 2(a)).
This in turn provides a continuous transition of the tensors
between both triangles. As Gaussian curvature on a cylinder is zero, the ensemble of two adjacent triangles with their

The computation of the topology in Section 5 requires
the calculation of signed rotation angles of eigenvectors
for the transition bridges. To sidestep the costly common
parametrization the signed rotation angle ∆α is composed
by two partial angles ∆α , ∆α in 3D. Again let e be a normalized vector parallel to the connecting edge, P a point on
the edge with eigenvectors v , v in T , T respectively and
surface normals n , n . The partial angles ∆α , ∆α are defined as the signed angles of the eigenvectors v , v and e
with respect to the surface normals n and n (Fig. 3(a)).
The vectors v and v must always be oriented, such that
|∆α| ≤ π/2. The entire rotation angle ∆α is given as
∠(v , v )
∆α
∆α

=
=
=

∆α = ∆α − ∆α
sign(n · (e × v )) arccos(v · e)
sign(n · (e × v )) arccos(v · e)

(4)

c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

C. Auer & I. Hotz / Complete Tensor Field Topology on 2D Triangulated Manifolds embedded in 3D

835

Figure 2: Model for transition bridges: (a) the triangle normals transform along the bridge into each other, (b) transition
bridge flattened, choice of local coordinate system for common parametrization of tensors, (c) virtual vertex cell defined as cell
bounded by adjacent virtual edge cells. (a,b,c) Jordan curves are colored in red. Different colors of Di , i = 1, .., n emphasize
different tensors for same vertex point but different triangles.

Please note that the vectors v , v are only the 3D representations of v , v not the eigenvectors of the original 3D tensors.
5. Topology Extraction
Due to the non-smooth manifold, special attention has to
be given to achieve a complete extraction of the topological graph. The presented method adopts the basic concepts
of the work of Sreevalsan et al. [SNAHH11], which computes an integral topological graph of a planar 2D tensor
field. In general all analysis operations carry over to the interior of triangles of the embedded manifold. To achieve a
complete topological graph this section provides extensions
for the extraction of degeneracies (Sect. 5.1) and separatrices
(Sect. 5.2) at locations of discontinuity – triangle edges and
vertices, facilitating the ideas described in Section 4. In Section 5.3 the topology extraction of piecewise constant tensor
fields is treated as special case of this approach.
5.1. Degenerate Points – Structural and Virtual
Degenerate points that are detected within triangles of the
manifold are called structural degenerate points, because
they are inserted as new vertices into the triangulation structure. Those that are found on the transition bridges are
called virtual degenerate points. The determination of degenerate points involves their detection and precise location (Section 5.1.1), the tensor definition (Section 5.1.2) in
these points and insertion into the polyhedron structure (Section 5.1.3). First the field is evaluated for structural degenerate points. Then virtual edges and finally virtual vertices are
examined for virtual degenerate points. Only virtual edges
and vertices that do not yet contain any degenerate point are
considered.
5.1.1. Detection and Location
Structural degenerate points:
The identification of isolated degenerate points inside triangles is carried out as in [HSNHH10]. The exact computation is a modular operation and not essential for the understanding of our approach. As an extensive recapitulation is
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

beyond the scope of this paper, we shortly summarize the
central properties: the process is purely based on the eigenvector behavior in a triangle. The formation of a triangle’s
edge labels efficiently indicates the existence of a degenerate
point. The exact location of a degenerate point in a triangle
is well-defined by the eigenvector orientation in the vertex
points. Degenerate points can occur inside a triangle, on its
edges and on its vertex points.
Virtual degenerate points:
In either case, in virtual edge cells and in virtual vertex
cells, the decision if a degenerate point exists is done
by calculating the tensor index IT according to [Del94].
Whilst the location of a degenerate point in a virtual vertex
cell obviously is the vertex itself, for virtual edge cells the
precise location of the degenerate points has to be calculated.
Virtual degenerate points – existence:
The tensor index is the number of counterclockwise revolutions made by the eigenvectors traversing an enclosing
Jordan curve L in counterclockwise direction. L has to be
homeomorphic to a circle. In our case L is a piecewise linear,
simple, closed curve, which is provided by the transition
bridges and triangle edges (see Sec. 4 and Fig. 2(a)-(c))
L = ∑i li . To determine the index we integrate the change
of eigenvector directions ∆α along L in terms of signed
rotation angles ∆αi of the eigenvectors vi , vi+1 at the end
points Pi , Pi+1 of each line segment li . If the endpoints of li
belong to the same triangle signed angles can be computed
straightforward. In case li is across a transition bridge ∆αi
is computed according to Equation 4. For all segments li
the vectors vi , vi+1 have to be oriented correctly, such that
|∆α| ≤ π/2. Due to the surface curvature we have to add the
angle defect Θ encountered by the traversal of L for virtual
vertex cells. It is defined by 2π − ∑i Θi , where Θi are the
apex angles of the surrounding triangles. For IT = ±1/2 · n,
n ∈ N\{0}, a degenerate point exists, otherwise IT = 0.
IT

=

(∑i ∆αi + Θ)/2π,

(5)

where ∆αi are the signed rotation angles per line segment li
of L.

836

C. Auer & I. Hotz / Complete Tensor Field Topology on 2D Triangulated Manifolds embedded in 3D

5.1.3. Insertion of Degenerate Points into Polyhedron
Structure

(a)

(b)

Figure 3: Calculation of tensor index around (a) edge with
wedge (b) vertex with trisector. Separatrices depicted in red
and blue lines. (a) below: determination of rotation angle
across transition bridge.

Structural degenerate points: a degenerate point found inside a triangle T is inserted as new vertex into the polyhedron structure to assure consistent eigenvector-based interpolation. T is divided in three new triangles, which share the
degenerate tensor in the new vertex. If a structural degenerate point is located on an edge, the new vertex also affects
the adjacent triangle, which is also split into two new triangles. However, the degenerate tensor is not assigned to the
new vertex point in this triangle. Instead the tensor is linearly interpolated using the tensors given in this triangle. If
a new structural degenerate point lies at a vertex, the polyhedron structure is unchanged, and only the vertex point in T
is assigned the degenerate tensor. Virtual degenerate points:
the polyhedron structure remains unchanged.
5.2. Separatrix Computation and Classification

Tensor index for virtual edge cell – details: The boundary of the virtual edge cell ev constituting the Jordan curve
L consists of two bridge segments and two triangle edges.
Since ev is equivalent to a planar cell no angle defect occurs
(Fig. 3(a)).
Tensor index of virtual vertex cell – details: Let T i , i = 1..n,
be the n triangles surrounding vertex point P. The Jordan
curve L enclosing a virtual vertex cell only consists of bridge
segments li , connecting the triangles Ti , Ti+1 (Fig. 3(b)).
Here the angle defect Θ is in general not equal to 0.
Virtual degenerate points – exact location on edge:
To calculate the exact location of a virtual degenerate point
in a virtual edge cell, we take the model of the planar transition bridge; for calculation purposes set its spatial extent to that of a unit square. The bridge is subdivided in
two triangles. Within these virtual triangles the computation of degenerate points is done as for structural degenerate
points. As the virtual triangles have no spatial extent the detected degenerate points are projected orthogonally onto the
halfedges constituting the bridge. It can easily be shown that
the actual choice of the spatial extent for the stretched planar
bridge has no effect on the location of the degenerate points.
5.1.2. Tensor Definition in Degenerate Points
Structural degenerate points: The eigenvectors of degenerate points are set to zero. Eigenvalues λ, µ are interpolated
according to the barycentric coordinates βi , i =1,2,3 of the
degenerate point’s position in the triangle:
λ(β1 , β2 , β3 ) = µ(β1 , β2 , β3 ) = ∑ βi ∗ (λi + µi )/2

(6)

with λi , µi major and minor eigenvalues in the vertex points.
Virtual degenerate points: Tensors for virtual degenerate
points are not defined as the tensor values themselves have
no relevance for the topological structure.

The integral topological graph renders separatrices for both
major and minor eigenvector fields. Thus the following concepts have to be applied to both eigenvector fields respectively. First start directions of the separatrices are determined by finding radial tensor lines emerging from degenerate points. Then the separatrices are computed as tensor
lines, integrated along the eigenvector field until one of the
termination conditions presented below applies. The determination of start directions differs for structural and virtual
degenerate points.
Radial directions from structural degenerate points:
Radial tensor lines in the interior of the triangles are calculated as in [SNAHH11]. For each edge ei , i =1,2,3 opposite
of the degenerate vertex point P, we check if there is a location Pe with eigenvector ve that fulfills the following condition ve × (Pe − P) = 0. In this case the start direction is
→

determined by PPe .
Radial directions from virtual degenerate points:
Since virtual edges and vertices have no spatial extent the
start direction of separatrices in their interior are irrelevant.
Separatrices starting in virtual degenerate points enter adjacent triangles at the projected degenerate point independently from the explicit start direction. As these entering
points are no degenerate points separatrices can be computed
by simply starting the integration in these locations (Fig. 3
(a),(b)).
Radial directions in virtual edges:
For both structural and virtual degenerate points radial directions can also emerge in the virtual edges. If the directed
angles ∆α1 , ∆α2 of eigenvectors v1 , v2 on a common edge e
(Equation 4) occur with different sign, the radial direction is
in the virtual edge cell. See Separatrix S1 in Figure 3(b).
Integration of separatrices:
Within a triangle Ts separtrices are computed by applying a
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

C. Auer & I. Hotz / Complete Tensor Field Topology on 2D Triangulated Manifolds embedded in 3D

Runge Kutta of 4th order scheme. Eigenvectors are bidirectional, within triangles the consistent interpolation is steered
by the edge labels as described in Equation 2 and performed
in 2D. If the integration of a separatrix passes a triangle
boundary, the separatrix is cut at the intersection point Ps of
the separatrix with one of the triangle edges. Starting from
this point the integration has to be continued in the adjacent cell, which also can be a virtual cell. The obvious task
is to determine the correct follow up cell T f and to choose
the correct integration direction of the bidirectional eigenvectors. Three cases can be discerned: the separatrix leaves
the triangle through an edge, it leaves through a vertex, or it
converges into an edge.
Case 1: A separatrix intersects the interior of an edge e in
point Ps and eigenvector vs . The adjacent triangle T f and its
entering point Pf with eigenvector v f is determined by taking the opposite halfedge of e and its associated facet. If the
directed angles ∆αs , ∆α f of eigenvectors vs , vf with common edge e (Equation 4) have the same sign the integration
is continued in triangle T f . The integration follows v f pointing inside the triangle.
Case 2: The separatrix leaves through a vertex P. Then all
triangles Ti sharing the vertex P are potential follow up triangles. If the vertex contains a degenerate point the separatrix
is terminated. If it is a regular vertex the triangle containing
the "straightest" continuation of the separatrix is chosen. Let
vi be the correctly oriented eigenvector at vertex P of candidate follow up triangle Ti = ∆(P, Pik , Pil ) and vsi the projection of vs onto Ti . Ti is determined to be follow up triangle
T f if the following conditions apply:
(a)

∃λ > 0, µ ∈ [0; 1] : P + λv f = Pfk + µ(Pfl − Pfk )

(b)

T f = arg min(|vsi · vi |)
Ti

Condition (a) checks whether the eigenvector points into the
interior of the triangle and if the integration would be continued at all in triangle Ti . Condition (b) chooses the triangle
T f with the "straightest" continuation of the separatrix.
Case 3: There is a special case for both edges and vertices.
This is if eigenvector behavior symmetrically converges towards an edge (Fig. 4). Looking at the transition bridges
the interpolation therein suggests integration parallel to the
concerned edge. Technically this case is detected by comparing the directed angles of the edge and the eigenvectors
on the respective triangles in the point of intersection Ps
(Equation 4). For different signs of the directed angle we
can directly integrate the separatrix along the edge. The vertex point of the halfedge performing the smaller angle to the
eigenvectors is chosen as next point of the separatrix.
Termination conditions are equal to [SNAHH11]. A separatrix is terminated if it fulfills one of the following conditions:
1. leaves the domain. 2. gets close to a degenerate point, line
or triangle (based on a distance threshold). 3. describes a circle or spiral and passes itself closely in parallel integration
direction.
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

837

Figure 4: Separatrix S converges into edge e due to different
signs of angles ∆α1 and ∆α2 .

5.3. Piecewise Constant Tensor Fields
Piecewise constant tensor fields commonly occur if tensors
are only given per triangle. Another example is a tensor field
derived from a piecewise linear vector field with vectors
defined on the vertices of the manifold. The topology
extraction for piecewise constant tensor fields can be
regarded as a special case of the approach proposed above
and derived in a straightforward manner.
Degenerate points – The calculation of degenerate points is
naturally reduced to virtual vertex cells and edge cells. This
is done analogically to Section 5.1, only that eigenvectors vi
are defined per Triangle Ti and rotation angles ∆αi only have
to be calculated across edges. This implies that degenerate
points in virtual edge cells are only found if eigenvectors
vi , v j of adjacent triangles Ti , T j are orthogonal, vi · v j = 0.
In this case, the entire edge is degenerate.
Separatrices – Separatrix computation is also done as
in Section 5.2 for separatrices from virtual degenerate
points: integration of the separatrices starts in the location
of the virtual degenerate point. Radial start directions can
be found in the interior of the surrounding triangles and
in the virtual edge cells applying the same conditions as
given in Section 5.2. The integration within a triangle
can be performed in one step, the expense of a Runge
Kutta integration scheme can be omitted. Again tensor
lines can converge into virtual edge cells if the eigenvector
behavior of adjacent triangles is symmetric to the edge. The
termination conditions for separatrices are also equal.
6. Results
6.1. Topology on Piecewise Continuous Tensor Fields
This section demonstrates how the complete topology is extracted – degenerate points are also found in the discontinuous locations and necessary separatrices are found in the
virtual edge cells. First the results are exposed for piecewise
linear tensor fields, then for piecewise constant tensor fields.
Degenerate points are depicted as spheres and separatrices
of the major eigenvector field as red lines, separatrices of the
minor eigenvector field as blue lines. For a better evaluation

838

C. Auer & I. Hotz / Complete Tensor Field Topology on 2D Triangulated Manifolds embedded in 3D

6.1.2. Simulated Two Point Load Cut with Sphere

(a)

(b)

(c)

Figure 5: Analytic one point load dataset cut with sphere
given as piecewise linear tensor field, (c) is a schematic illustration of the dataset. Figure(a) renders the topological
graph without, Figure(b) with additional consideration of
locations of discontinuity. In Figure(b) the additional degenerate point is indicated as large sphere and only its separatrices as thick lines.

The second example is again a cut of a sphere and a simulated dataset on which two forces act, one is pulling, one
pushing – the two point load (Fig. 6). Again for better clarity, topological elements from structural degenerate points
are drawn smaller. Virtual degenerate points are shown as
large spheres and associated separatrices as thick lines. As
the two point load is a simulated dataset it has a more complex topological structure. Point P0 is a virtual degenerate
point found in a virtual vertex cell, P1 , P2 and P3 are found
in a virtual edge cell. All of them are wedge points. The
blue separatrices below P1 demonstrate how our approach
correctly integrates tensor lines along the edges: due to symmetric eigenvector behavior in the adjacent triangles the tensor lines converge in the edge (Sect. 5.2, Case3).

the major eigenvectors are indicated by short red lines in the
triangles. However they are not shown, if the image would
be overloaded and cluttered.

6.1.1. Analytic One Point Load Cut with Sphere
The first example is the cut of a sphere with an analytic
dataset that models a solid block on which one pushing force
acts, commonly known as one point load [SD03] (Fig. 5(c)).
The dataset is sampled at the vertices of the sphere and projected onto the triangles. This dataset serves as a simple but
clarifying example why locations of discontinuity have to
be examined for degeneracies. Figure 5(a) shows the result
of the topology extraction without and 5(b) with additional
examination of the locations of discontinuity. The topological graph in Figure 5(a) is incomplete and the red separatrix in the middle seems to perform an unmotivated turn.
Figure 5(b) exhibits the missing virtual degenerate point,
found in the virtual vertex cell in the center. For a clearer
arrangement in Figure 5(b) the additional virtual degenerate point is depicted larger and only separatrices emerging
from the virtual degenerate point are drawn as fat lines. Separatrices from structural degenerate points are drawn as thin
lines. Separatrices S2 , S4 are found in the virtual edge cells.
Comparing the separatrices and the major eigenvector field
illustrated by the short red lines, it can be seen that starting the integration of tensor lines in the location of a virtual
degenerate point delivers radial start directions (Sect. 5.2).
Thus the integrated separatrices partition the domain into
qualitatively homogeneous regions. S2 , S3 , S4 are separatrices that could omitted, as they show radial behavior within
the bounding separatrices S1 , S5 and don’t contribute to the
structural partition the topological graph renders. They can
be identified by classification analog to [SNAHH11]. Please
note that separatrices are stopped if they describe a spiral
and pass themselves closely in parallel integration direction.

Figure 6: Simulated two point load cut with a sphere,
schematic illustration in top right corner. Virtual degenerate
points are depicted as larger spheres and associated separatrices as thick lines.

6.2. Topology on Piecewise Constant Tensor Fields
6.2.1. Analytic Trisector and Wedge Datasets
Figure 1(b),(c) show two analytic datasets and present how
the topology extraction also works for constant tensor fields.
Figure 1(b) has a degenerate point in the center virtual vertex
cell, which is a trisector. Due to the piecewise constant tensor field the separatrices appear rather jagged, but correct.
Separatrices S4 , S6 are found by starting the integration in
the adjacent triangles. The separatrices S1 , S2 , S3 , S5 found
in the virtual vertex cells are necessary to complete the topological graph. Figure 1(c) shows a wedge degenerate point.
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

C. Auer & I. Hotz / Complete Tensor Field Topology on 2D Triangulated Manifolds embedded in 3D

Separatrices S1 , S2 , S4 , S6 are found in the virtual edge cells,
S3 , S5 by integration in the triangles. Again the tensor lines
S3 , S4 , S5 could be omitted as they are radial tensor lines.
6.3. Rate of Strain Tensor Field on Aneurysm Dataset
In the area of flow analysis and visualization an increasing
interest in the rate of strain tensor can be observed. For
piecewise linear flow fields this results in piecewise constant
tensor fields, which are based on the derivative of the flow
field. This motivated the next example, which investigates
blood flow inside a cerebral aneurysm. The dataset is the
result of a CFD simulation performed on a tetrahedral
mesh. For the rupture risk analysis it is assumed that the
wall shear vector field is of special relevance [BRM∗ 08].
This example exposes the topology extraction on the rate
of strain tensor field. A three-dimensional vector field is
initially given on the surface vertices, which are projected
onto the triangles. The constant rate of strain tensor is
derived locally per triangle. Let u = (u1 , u2 ) ∈ R2 be vector
in the local coordinate system. The components of the rate
of strain tensor are given as:

T11 =

δu1
δu
1
, T22 = 2 , T12 = T21 =
δx
δy
2

δu1 δu2
+
δy
δx

(7)

Figure 7: Derived rate of strain tensor field on an aneurysm
dataset. Top right corner: the streamlines on the surface render the initial velocity gradient vector field.
In Figure 7, top right corner, the original vector field is illustrated by streamlines [RPP∗ 09] on the surface. For better
orientation the streamlines are repeated in the central image,
which renders the surface topology of the rate of strain tensor field. In flow visualization the divergence of a flow is
one of the interesting quantities. Evaluating the rate of strain
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

839

tensor by means of scalar quantities, like the major eigenvalue, determinant or trace of the tensor gives insight on the
strength of the divergence in a field. The topological graph
of such a field additionally renders the directionality of the
divergence. The major and minor tensor lines indicate directions of strongest divergence respective convergence. This
allows to distinguish regions where major flow separation
occurs along or across streamlines.
Further we can observe areas with accumulations of degenerate points with a very complex topological structure. In
these regions the visualization might profit from simplification strategies as proposed by Trichoche [TSHC01].

7. Conclusion
We presented an approach to extract the complete surface
topology on piecewise continuous and piecewise constant
2D tensor fields on 2D triangulations embedded in 3D.
The method is based on the model of continuous transition
bridges that close the discontinuous gaps of the tensor field
in the edges and vertices of the triangulation. The strength of
this work lies in its simplicity compared to previous work.
Degenerate points and separatrices hidden in the edges and
vertices are extracted and a complete surface topology is
achieved. The existence of hidden degenerate points is detected in an efficient and correct way by computing the tensor index. While the position of degenerate points in vertices
is clear, the precise location for degenerate points in edges
can be computed. This is done by the model of the flattened
continuous transition bridges. The values of the tensor index computation are integral multiples of 1/2 independently
from the curvature of the manifold. Thus no thresholding has
to be applied for the detection of degenerate points. Please
note, we propose a numerical method with inherent precision
problems, such as rounding errors. Thus we cannot guarantee that the entire surface topology is consistent in total. For
example the separatrix integration is performed by a RungeKutta of 4th order scheme; the result will always be affected
by the chosen integration step width for example.
This work also proposes results for piecewise constant rate
of strain tensor fields, which are of high interest in flow visualization. The directionality of flow divergence and convergence can strongly support the analysis of complex flows.
The surface topology of the rate of strain tensor field yields
a skeleton were all such directional characteristics are illustrated.
The model of continuous transition bridges can be extended
to the extraction of the surface topology of vector fields as
well. We hope that this paper enriches work in that research
area, as well.

Acknowledgments
This work was supported by the German Research Foundation (DFG) through the Emmy Noether Program.

840

C. Auer & I. Hotz / Complete Tensor Field Topology on 2D Triangulated Manifolds embedded in 3D

References
[AMR88] A BRAHAM R., M ARSDEN J., R ATIU T.: Manifolds,
tensor analysis, and applications: 2nd edition. Springer-Verlag
New York, 1988. 3
[ASNZH11] AUER C., S REEVALSAN -NAIR J., Z OBEL V.,
H OTZ I.: 2d tensor field segmentation. In Scientific Visualization:
Interactions, Features, Metaphors, Hagen H., (Ed.), vol. 2 of
Dagstuhl Follow-Ups. Schloss Dagstuhl–Leibniz-Zentrum fuer
Informatik, to appear 2011. 3
[BRM∗ 08] B OUSSEL L., R AYZ V., M C C ULLOCH C., M AR TIN A., ACEVEDO -B OLTON G., L AWTON M., H IGASHIDA R.,
S MITH W., YOUNG W., S ALONER D.: Aneurysm growth occurs
at region of low wall shear stress: patient-specific correlation of
hemodynamics and growth in a longitudinal study. PubMed Stroke 39 (2008), 2997–3002. 9
[CGA] C GAL, Computational Geometry Algorithms Library.
http://www.cgal.org. 3
[Dan97] DANIELSON D.: Vectors and Tensors in Engineering and
Physics, 2nd ed. Addison-Wesley Publishing Company, 1997. 3
[Del94] D ELMARCELLE T.: The Visualization of Second-order
Tensor Fields. PhD thesis, Stanford University, 1994. 2, 3, 4, 5
[DH94] D ELMARCELLE T., H ESSELINK L.: The topology of
second-order tensor fields. In VIS ’94: Proceedings of the conference on Visualization (1994), Bergeron R. D., Kaufman A. E.,
(Eds.), IEEE Computer Society Press, pp. 140–148. 2
[GLT∗ 07] G ARTH C., L ARAMEE R. S., T RICOCHE X.,
S CHNEIDER J., H AGEN H.: Extraction and visualization of swirl
and tumble motion from engine simulation dataset. In Topological Methods in Visualization (TopoInVis’07). Springer, 2007,
pp. 121–135. 2
[HH90] H ELMAN J. L., H ESSELINK L.: Surface representations of two- and three-dimensional fluid flow topology. In VIS
’90: Proceedings of the conference on Visualization (1990), IEEE
Computer Society Press, pp. 6–13. 2
[HLL97] H ESSELINK L., L EVY Y., L AVIN Y.: The topology of
symmetric, second-order 3D tensor fields. IEEE Transactions on
Visualization and Computer Graphics 3, 1 (1997), 1–11. 2
[HSNHH10] H OTZ I., S REEVALSAN -NAIR J., H AGEN H.,
H AMANN B.: Tensor field reconstruction based on eigenvector and eigenvalue interpolation. In Scientific Visualization: Advanced Concepts, Hagen H., (Ed.), vol. 1 of Dagstuhl FollowUps. Schloss Dagstuhl–Leibniz-Zentrum fuer Informatik, 2010,
pp. 110–123. 2, 4, 5
[KHL99] K ENWRIGHT D. N., H ENZE C., L EVIT C.: Feature
extraction of separation and attachment lines. IEEE Transactions
on Visualization and Computer Graphics 5, 2 (1999), 135–144.
2
[KMH11] K RATZ A., M EYER B., H OTZ I.: A visual approach to
analysis of stress tensor fields. In Scientific Visualization: Interactions, Features, Metaphors, Hagen H., (Ed.), vol. 2 of Dagstuhl
Follow-Ups. Schloss Dagstuhl–Leibniz-Zentrum fuer Informatik,
to appear 2011. 1

[LV∗ 06] L I W.-C., , VALLET B., R AY N., L EVY B.: Representing higher-order singularities in vector fields on piecewise linear surfaces. IEEE Transactions on Visualization and Computer
Graphics 12 (2006), 1315–1322. 2
[LW09] L AIDLAW D. H., W EICKERT J.: Visualization and Processing of Tensor Fields: Advances and Perspectives. Mathematics and Visualization. Springer, 2009. 2
[RPP∗ 09] ROSANWO O., P ETZ C., P ROHASKA S., H OTZ I.,
H EGE H.-C.: Dual streamline seeding. In Proceedings of the
IEEE Pacific Visualization Symposium (2009), Eades P., Ertl T.,
Shen H.-W., (Eds.), pp. 9–16. 9
[SD03] S OM N. N., DAS S. C.: Theory And Practice Of Foundation Design. Prentice-Hall, India, 2003. 8
[SNAHH11] S REEVALSAN -NAIR J., AUER C., H AMANN B.,
H OTZ I.: Eigenvector-based interpolation and segmentation of
2d tensor fields. In Topological Methods in Data Analysis and
Visualization. Springer, 2011, pp. 139–150. 2, 3, 4, 5, 6, 7, 8
[Tel08] T ELEA A. C.: Data Visualization: Principles and Practice. A K Peters, Ltd., Wellesley, MA, USA, 2008. 1
[TGS05] T RICOCHE X., G ARTH C., S CHEUERMANN G.: A fast
and robust method for visualizing separation line features. In
Scientific Visualization: The Visual Extraction of Knowledge from
Data, Bonneau G., Ertl T., Nielson G., (Eds.). Springer Berlin,
2005, pp. 249–264. 2
[TKW08] T RICOCHE X., K INDLMAN G., W ESTIN C.-F.: Invariant crease lines for topological and structural analysis of tensor fields. IEEE Transactions on Computer Graphics and Visualization 14, 6 (2008), 1627–1634. 2
[Tri02] T RICOCHE X.: Vector and Tensor Field Topology Simplification, Tracking and Visualization. PhD thesis, University of
Kaiserslautern, 2002. 3
[TSHC01] T RICOCHE X., S CHEUERMANN G., H AGEN H.,
C LAUSS S.: Vector and tensor field topology simplification on
irregular grids. In VisSym ’01: Proceedings of the symposium on
Data Visualization 2001 (2001), Ebert D., Favre J. M., Peikert R.,
(Eds.), Springer-Verlag, pp. 107–116. 2, 9
[WH05] W EICKERT J., H AGEN H.: Visualization and Processing
of Tensor Fields. Mathematics and Visualization. Springer, 2005.
2
[WTS∗ 07] W IEBEL A., T RICOCHE X., S CHNEIDER D.,
J ÄNICKE H., S CHEUERMANN G.: Generalized streak lines:
Analysis and visualization of boundary induced vortices. IEEE
Transactions on Visualization and Computer Graphics 13, 6
(2007), 735–1742. 2
[ZHT07] Z HANG E., H AYS J., T URK G.: Interactive tensor field
design and visualization on surfaces. IEEE Transactions on Visualization and Computer Graphics 13, 1 (2007), 94–107. 2
[ZMT06] Z HANG E., M ISCHAIKOW K., T URK G.: Vector field
design on surfaces. ACM Trans. Graph. 25, 4 (2006), 1294–1326.
2
[ZP04] Z HENG X., PANG A.: Topological lines in 3d tensor
fields. In VIS ’04: Proceedings of the conference on Visualization
(2004), IEEE Computer Society Press. 2

[LBHL97] L AVIN Y., BATRA R., H ESSELINK L., L EVY Y.: The
topology of symmetric tensor fields. AIAA 13th Computational
Fluid Dynamics Conference, (1997), 2084. 2

[ZP05] Z HENG X., PANG A.: 2d asymmetric tensor analysis. In
VIS ’05: Proceedings of the conference on Visualization (2005),
pp. 3–10. 2

[LHZP07] L ARAMEE R. S., H AUSER H., Z HAO L., P OST F. H.:
Topology-based flow visualization, the state of the art. In
Topology-based Methods in Visualization. (TopoInVis’05), Helwig Hauser H. H., Theisel H., (Eds.), Mathematics and Visualization. Springer Berlin Heidelberg, 2007, pp. 1–19. 2

[ZYLL09] Z HANG E., Y EH H., L IN Z., L AMAREE R.: Asymmetric tensor analysis for flow visualizations. IEEE Transactions
on Visualization and Computer Graphics 15, 1 (2009), 106–122.
2

c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.


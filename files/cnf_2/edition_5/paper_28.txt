DOI: 10.1111/j.1467-8659.2011.01857.x
EUROGRAPHICS 2011 / M. Chen and O. Deussen
(Guest Editors)

Volume 30 (2011), Number 2

Fruit Senescence and Decay Simulation
Joseph T. Kider Jr., Samantha Raja, and Norman I. Badler
University of Pennsylvania

Abstract
Aging and imperfections provide important visual cues for realism. We present a novel physically-based approach
for simulating the biological aging and decay process in fruits. This method simulates interactions between multiple processes. Our biologically-derived, reaction-diffusion model generates growth patterns for areas of fungal
and bacterial infection. Fungal colony spread and propagation is affected by both bacterial growth and nutrient
depletion. This process changes the physical properties of the surface of the fruit as well as its internal volume
substrate. The fruit is physically simulated with parameters such as skin thickness and porosity, water content,
flesh rigidity, ambient temperature, humidity, and proximity to other surfaces. Our model produces a simulation
that closely mirrors the progression of decay in real fruits under similar parameterized conditions. Additionally,
we provide a tool that allows artists to customize the input of the program to produce generalized fruit simulations.
Categories and Subject Descriptors (according to ACM CCS): I.3.7 [Computer Graphics]: Three-Dimensional
Graphics and Realism—
Keywords: Appearance Modeling, Natural Phenomena, Physical Simulation, Senescence

1. Introduction
As objects age, their appearance changes over time. These
shifts in appearance give important visual age cues that can
enhance the realism of a synthetic scene. We attempt to address the rather unexplored area of organic decomposition,
a fundamental step in a fruit’s life-cycle. The visual simulation of the fruit aging process requires attention not only
to aesthetic changes, but also to the underlying biology of
senescence and decay. While artists can add visual imperfections to their models and environments through traditional
texture mapping and physics-based modeling methods, these
may be based on observation, intuition, and artistic skill.
Parameterized procedural decay methods built on scientific
principles could be useful to make artistic rendering more
precise. Several surveys [DRS07, MG08] summarize aging
and weathering phenomena in computer graphics. However,
these methods neither directly include, nor can they be readily extended to, the complex biological processes associated
with decomposition.
While there has been some significant work in the animation industry revolving around the creation of realistic computer generated food, there has been little emphasis on the
reproduction of natural decay processes. Traditional surface
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

texture imperfection and aging techniques are visually satisfying, but they do not take into account the effect of mold
and other microorganisms on environments in a way that is
biologically accurate.

Figure 1: An illustration of a simulated tomato decaying.
Here multiple mold and rot processes affect the fruit.
We present a novel, parameterized method to simulate
fruit senescence and decay that is grounded in scientific research. As real fruits age, their physical structures become
compromised and vulnerable to attack by infectious agents.
Our model replicates these interactions between multiple biological processes. We generate growth patterns for areas

258

J.T.Kider Jr. & S. Raja & N.I.Badler / Fruit Senescence and Decay Simulation

of fungal and bacterial infection with a reaction-diffusion
model. As nutrients deplete, the fungal colony spread decreases. Additionally, the internal fruit substrate is affected
by soft bacterial rot and the volume decreases over time to
reflect water loss due to transpiration. Our work is one of the
first simulations to link rot growth and transpiration in one
model.
Our model changes both the overall shape and the appearance properties of the fruit’s anatomy. First, the fungus and
bacteria are grown on the fruit’s exocarp, or outer skin. This
process is directly affected by moisture, temperature, and
nutrient concentration at each point on the surface. Second,
we address the gradual collapse and shrinking of the internal structure. Because water accounts for a large percentage
of a fruit’s mesocarp (interior), water transpiration is a primary factor in the way a fruit decays and loses internal mass.
Additionally, rot makes areas of the substrate soft and more
prone to collapse.
The simulation is based on user-defined parameters for
skin thickness and porosity, water content, flesh rigidity, ambient temperature, humidity, and proximity to other surfaces.
These parameters allow direct control of the simulation and
a broad range of results. We demonstrate visually accurate
simulations on three fruits: a tomato, apple and orange. We
provide a variety of fruit presets and parameters to automatically produce proper fungal growth and rot for the selected
fruit. Additionally, we provide a tool that allows an artist to
direct the simulation. This generalizes our simulation to a
variety of fruits, real or imaginary, and even other geometry,
allowing artists to produce decay simulations based on their
production requirements. To the best of our knowledge, this
is the first paper to describe a visual simulation of fruit decay.
1.1. Related Work
Early work on creating imperfections focused on procedural texture synthesis [BB90, WNH97]. This work manipulated surface features to simulate blemishes. These methods
used simple distribution models. γ-ton tracing [CXW∗ 05]
is a recent rule-based approach to simulate weathering.
Rather than a probabilistic approach, we use a reactiondiffusion system to produce decay phenomena on multiple
texture and mesh layers. As nutrients diminish, mold growth
stops. This would be difficult to recreate with γ-ton tracing.
Turk [Tur91] and Witkin and Kass [WK91] proposed using
reaction-diffusion for texture synthesis. Reaction-diffusion
textures come from a biochemically inspired set of partial
differential equations. This non-linear interaction process
creates natural patterns, such as stripes and spots. In our approach, we also use a reaction-diffusion model, but apply
this mathematical approach to complex biological processes,
such as growth of fungus and bacteria, colony formation,
and soft rot. Fungal colonies diffuse radially, interacting with
each other and the nutrients on the fruit surface. The decay

affects both the surface and internal substrate of the fruit.
Our model parameters for decaying fruit are biologicallyderived and present a novel visual simulation method that
has not been covered in previous approaches.
Several researchers have attempted physically-based simulation methods to automate the creation of realistic aging
and imperfections. Dorsey and Hanrahan [DH96] modeled
and rendered a metallic patina. This work showed the patination process heavily depends on environmental factors.
They integrated these parameters into their phenomenological model to produce a variety of results. Several other corrosion models have been proposed that extend this work to
more general conditions [CS00, MDG01]. Hsu and Wong
[HW95] integrated surface properties such as inclination and
stickiness to simulate dust accumulation. Paquette and Drettakis [PPD02] simulated paint cracking and peeling and surface aging by impacts [PPD01]. Bosch and his colleagues
[BPMG04] simulated the formation of scratches and rendered their visual behavior. Cracks and fractures play an
important role in aging solid structures [DGA05, GC01].
Other researchers proposed methods to simulate appearancechanging flows [DPH96], to weathered stone [DEJ∗ 99], and
to perform multiple weathering effects on fur [JW09].
Data-driven simulation techniques rely on carefully captured images and measurements to produce time-varying
surface imperfections. Wang et al. [WTL∗ 06] use a single image to construct an appearance manifold and Xue et
al. [XWT∗ 08] improve the transfer of weathering from the
manifold between images. Our work differs from the appearance manifold approach since fruit decays in complex
stages. One image will not capture the dynamics of the entire decay. Our technique models multiple types of appearance change on the surface and alters the underlying geometry. Lu et al. [LGG∗ 07] captured and transferred weathering
effects from real to synthetic shapes using a context aware
texturing approach. Gu et al. [GTR∗ 06] acquired a database
of time-varying images using a multi-camera/light device.
Their work looked at apples and banana skin captures. However, their approach simulates only the visual effect of the
fruits’ aging over time and not the biological factors behind
the process. In addition, a data-driven approach for simulating decay is not practical given the numerous significant
parameters (including the geometric context), and the challenges and time investment in acquiring the data. Fruit decays over the course of multiple weeks.
Biologically-inspired techniques attempt to simulate natural scenery. Yin and his colleagues [YFCT08] proposed
a model for wood aging based on biological deterioration.
Boissieux et al. [BKMTK00] simulated skin aging and wrinkles based on insight from cosmetics. Also, lichen [DGA04]
and moss [OMC03] growth create realistic outdoor worlds.
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

259

J.T.Kider Jr. & S. Raja & N.I.Badler / Fruit Senescence and Decay Simulation

Figure 2: Photographs of real fruit decay. (a) Penicillium digitatum formation on an orange. (b) Neofabraea formation on an
apple. (c) Rhizopus formation on a tomato. (d)-(f) Time lapse of fungal growth on the bottom point of contact between a tomato
and a glass platform.

1.2. Overview
The remainder of the paper is organized as follows: First, we
describe the biological basis of fruit senescence and decay.
Second, we describe our fruit decay pipeline and provide details for the mathematical model for our simulation. Finally,
we present our results and describe how our method can be
generalized by our user interface.
2. Biological Background of Fruit Decay
Decay is an essential step in the reproductive process of
fruiting plants - the decomposition of flesh frees and feeds
the seeds of the fruit to grow into a new plant. While disease
can strike a fruit at any stage of life, fruit naturally becomes
more vulnerable to disease over time. We exclusively investigate post-harvest rot in a typical home environment. Food
scientists and biologists recognize fruit decay as a serious
problem in the shipping and storage of produce. The short
ripening and post-harvest life-cycle of fruit influences their
value.
Prasanna et al. [PPT07] and Pech et al. [PBL08] studied
factors in the fruit ripening process. Numerical approaches
were developed to predict morphological patterns of bacterial colonies [MM93, OMM92]. Post-harvest disease is typically initiated when a point on the fruit’s surface is compromised, either due to injury or structural vulnerabilities.
One major wound is the stem puncture where the fruit was
picked. Once an initial infectious agent like bacteria has attacked, it further weakens the surface and leaves it susceptible to infection by other organisms. This is the reason that
mold often forms in areas already infiltrated by bacteria. The
soft rot serves as an entry point for fungal spores.
Fungal Growth. Various reaction-diffusion processes have
been proposed to better predict fungal growth based on a variety of parameters [MGL93, ESRA10, IM09]. Bacteria and
fungi thrive on the nutrient-rich surface of a ripened fruit.
However, nutrient levels deplete over time as colonies use up
resources, slowing down the growth process. Environmental factors such as temperature and humidity greatly affect
mold and bacterial growth [Blo53]. Warmer temperatures
lead to more rapid proliferation, while colder temperatures
retard growth. Our model incorporates the interaction between these different factors to determine the concentration
of bacteria and fungi at each point on the fruit surface.
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

Mold. Various types of mold affect fruit. Andersen and
Frisvad [AF04] showed Penicillium and Rhizopus were two
species present in moldy tomatoes. Rhizopus is a white
thread-like Mucoralean mold that infects tomatoes. Erwinia
carotovora is a type of soft rot that affects the internal substrate, making the fruit collapse in the infected regions. The
species of mold that most commonly attacks apples is Penicillium expansum. Apples are also often infected by the organism Neofabraea, which causes a soft spot. This infected
region appears as a growing and darkening brown spot on
the surface. Penicillium digitatum primarily affects oranges.
These colonies have a gray-blue center and are white along
the edges.
Figure 2 provides three photographed examples of Penicillium digitatum, Penicillium expansum, and Rhizopus mold
on an orange, apple and tomato. Additionally, Figure 2
shows three time lapse images of a tomato photographed
from the bottom through a piece of glass. Mold starts to form
at the points of contact with the glass. This occurs because
the flesh weakens under the pressure of the weight of the
fruit, providing entry points for pathological agents.
Fruit
Apple
Orange
Peach
Pear
Tomato

Food
Weight (g)
138
140
87
166
123

Water
Weight (g)
116
122
76
139
115

% Water

K

84
87
88
84
94

0.17
8.48
14.1
0.68
0.9

Table 1: This table provides the weight, water content,
and the transpiration coefficient rates (K) for several fruits.
[BH94, CRBG88].
Transpiration. Fruits have high water content in proportion
to their weight [BH94, HD97, PUTV04]. Table 1 relates the
weight of the fruit to the water content. Moisture loss due
to transpiration is a major factor in fruit decay and is one
of the main factors that drive changes in the internal structure [CG85,SB83,CRBG88,LBG00]. As water continuously
transpires from a fruit, it loses mass and shrinks. The rate of
this process largely depends on the structure and the properties of the fruit skin. Certain fruit skins are porous, while
others are less permeable. A fruit exhibits a hydrostatic pres-

260

J.T.Kider Jr. & S. Raja & N.I.Badler / Fruit Senescence and Decay Simulation
Choose
internal volume mesh
User Parameters

Deformable body
simulation
Reaction-diffusion
growth model

Choose
external skin mesh

Change maps

Render

Cloth simulation

Figure 3: The system framework highlighting the important steps in our fruit decay pipeline. The user provides the input mesh
and parameters to the system. Our model calculates the growth and decay and then renders the final image.

sure as it sits. Transpiration also depends on the physical environment. Temperature and water vapor pressure, as well as
the size and shape of the fruit, are accounted for when calculating transpiration rate. Our model utilizes transpiration as
the main factor for internal volume loss.
Factors not discussed. Fruit decay is a complex natural phenomenon that is driven by innumerable conditions in addition to those we have discussed. We do not consider elements
such as nutrient deficiency or poor fertilization while growing. Our mathematical model can be generalized to different
types of fruits and infectious agents based on the input parameterization.
3. Fruit Senescence and Decay Pipeline
In this section, we provide details about our model structure
and a set of parameters to generalize the decay process. Figure 3 shows the pipeline of our simulation using the plug-in
tool we created. First, the user sets both the skin and internal substrate meshes. Next, the user either selects fruit, mold,
and environmental presets, or sets custom values for each parameter. These input parameters drive the reaction-diffusion
and transpiration mathematical models described in detail
below. We use a cloth-like simulation as the external skin
model. Then, the user selects contact points, which will serve
as initial seed points for the bacterial soft rot map. Finally,
the user runs the simulation. The program output includes
a series of maps representing distributions of fungus, bacteria, and nutrients for each frame of the simulation. It also
includes a vertex cache which is automatically applied to the
internal substrate mesh. The alpha maps shade the different
layers of the fruit-fresh surface, bacterial soft rot, and mold.
We will describe our particular rendering approach later.
3.1. Maps
The results of the reaction diffusion processes that drive the
surface component of our simulation are visualized as a sequence of time-varying maps. Our maps range X between [0
... 1], with white representing a maximum density of 1, and
black representing a density of 0. We use three different map
sequences: the nutrient map, the fungal map, and the soft rot
map. The nutrient map represents the distribution of nutrients over the surface of the fruit, and serves as a distribution
map for fungal growth. We show in Figure 4 (a) how the nutrients deplete over time as the active fungus grows. Next,

the fungal maps track the areas of fungal colony formation.
These grow over time based on our reaction-diffusion model.
The soft rot map represents the areas of bacterial growth that
form on fruit. This map serves as a probability map for the
propagation of new fungal colonies. Mold grows primarily
on areas that have already been infected by the bacteria. A
new set of maps is generated and stored at each frame. For
our implementation, the maps were sized at 512 × 512 pixels.
3.2. Internal Volume
The volume of the fruit is modeled as a deformable object.
The shape and volume of this mesocarp changes based on the
forces of rot and transpiration derived from our mathematical model. We use a mass-spring system that utilizes a set of
point masses connected by elastic links. Each mass node corresponds to a specific vertex of the object. Initial spring constants are determined by the user-defined firmness parameter (Ks = f irmness), which varies across different fruits. For
example, tomatoes have high water content and are softer
than apples. The spring constants and resting lengths (rLen)
are governed by a pressure map, which may change at every
time-step.
As the soft rot map changes the outer appearance from
the reaction-diffusion growth, springs at the same locations
in the pressure map decrease in stiffness and length, affecting the internal volume. This represents areas of soft bacterial rot where the fruit is softer. Therefore certain areas may
collapse faster based on the level of infection. At each time
step of the simulation, spring constants and resting lengths
are decreased at a rate proportional to water content and the
calculated transpiration rate.
Transpiration coefficients for various common fruit types,
including those that we used in our simulation, are given
in Table 1. The volume is proportional to the cube of the
spring resting lengths. Since we know the proportion of the
fruit’s volume, which is water (waterContent), and the rate
at which water volume is lost (tRate), the percent total volume we would want the fruit to lose at each time-step is:
tRate · waterContent · volume. Therefore, change in resting length at each time step is given in equation 1:
√
3
(1)
∆rLen = −c · rLen · tRate · waterContent
Where c is a weighting factor. In addition, we wanted the
springs to lose tightness over time to reflect the softening that
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

261

J.T.Kider Jr. & S. Raja & N.I.Badler / Fruit Senescence and Decay Simulation

100

200

300

400

500

Final Render (d)

Soft Rot Map (c)

Fungal Map (b)

Nutrient Map (a)

0

Figure 4: Results of the final maps: Values range between {0 ... 1} for the phenomenon concentration values. These processes
change the physical properties of the surface and internal volume substrate. (a) Shows nutrient depletion, (b) Fungal colony
growth, (c) Soft rot spread, (d) Final rendered frames.

occurs due to water loss and decrease in structural integrity
of the internal fibers. The change in Ks at each time-step is
given by: ∆ks = c · waterContent · tRate · Ks , where c is a
weighting factor.
3.3. External Skin
We found that the dynamic properties of fruit skin can be
modeled in much the same way as cloth. First, we bound the
skin to the internal volume mesh with point constraints. As
the internal mesh started to collapse, it naturally produced
the effects that occur during decay, such as wrinkling and
shriveling. The simulation parameters of the cloth were determined by user-defined thickness (St ). See Table 2 for our
settings. The fruit skin layer was simulated using the nCloth
cloth solver in Maya.
3.4. Presets and Parameters
We provide a set of fruit, mold, and environmental presets
and parameters to effect the decay of fruit in our simulation.
Fruit presets include tomato, orange and apple. Environment
presets include tropical, cold desert, hot desert, and temperate climates.
To generalize the simulation, our custom parameters allow a variety of effects to be created. Surface parameters
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

Porosity
Thickness (St )
Firmness
Growth Rate
Propagation rate

Apple
25
30
80
20
5

Orange
60
60
40
50
3

Tomato
40
20
50
75
1

Table 2: This table provides the input parameters for the
different fruits in our results. The temperature was set to 72
degrees and humidity to 50%.

include the thickness and porosity of the exocarp. Internal
parameters include water content, transpiration coefficient
and firmness. Table 1 provided values for only fruit types
found in our examples. Many researchers have conducted
studies to accurately determine these values for other types
of fruit [BH94, CRBG88]. Mold parameters, such as growth
rate, propagation rate, and color allow for different mold
growth patterns. Table 3 provides our preset parameters. Ito
and Mizuno [IM09] specify other growth settings for more
mold types. Environmental factors, such as temperature and
humidity, also influence the simulation. Lastly, we allow the
user to specify initial areas of rot by selecting vertices on the
input mesh. By default, the simulation begins to rot at the
points of contact with other surfaces and at the stem. How-

262

J.T.Kider Jr. & S. Raja & N.I.Badler / Fruit Senescence and Decay Simulation

ever, a user can specify new wound points on the pressure
map as desired, to get "directable" simulations.

location within some radius r with a probability given by
1/(10 − propagationRate), with propagationRate’s range
between [0 ... 9].
Step 2. We form additional new colonies in the fungal map
in areas of the surface affected by bacterial soft rot. The soft
rot map serves as a probability map, with more concentrated
areas of bacteria containing higher probabilities of spawning
a new colony.

Figure 5: A composite image of a cross-section view of our
fruit’s anatomy. (Right) shows a final rendered frame. (Left)
shows the skin and deformable body of our substrate.
3.5. Rendering
In order to give our fruits a realistic look and feel, we modeled and rendered our results in Autodesk Maya 2010. The
color and polygonal structure of each fruit were empirically
derived by observing and photographing real fruit (Figure 2).
However, a more complex capture process [GTR∗ 06] can
also be used. We used sub-surface scattering shaders to create the effect of translucency in the fruit flesh, and modified
specularity and color to match the captured image data. We
used a layered shading system, applying the map sequence
acquired from our simulation as alpha maps for the decay
layers. The fruit color changes based on the maps. We colored the soft rot layer brown and decreased specularity, and
used the fungal map as a length and baldness map for Maya
Fur to simulate hair-like mold fibers. Our results were rendered with Mental Ray for Maya.
4. Simulation Framework
We simulate both fungal colony and mold growth on the exocarp, and soft rot formation and transpiration on the mesocarp. We present mathematical models that tie together these
time-varying biological processes on the multiple layers.
4.1. Implementation Overview
We utilize numerical reaction-diffusion equations to form
fungal and bacterial colonies, and a transpiration model to
drive the volume collapse. These calculations affect the underlying maps and substrate meshes as the fruit decays.
Since the soft rot, nutrient, and fungal maps interact, we simulate all three processes, the internal deformable body, skin,
and output the maps simultaneously.
The following actions are performed at each time step:
Step 1. We spawn new colonies in the fungal and soft
rot maps to simulate the effect of individual cells spreading from the existing mold or bacterial colonies and taking
root in nearby areas of the fruit’s surface. For each existing colony, we create a seed point in a randomly selected

Step 3. We calculate the reaction diffusion step. The fungal and bacterial maps follow similar reaction diffusion processes, with differences in equation parameters, while the
nutrient map undergoes a separate nutrient diffusion process.
a) The fungal and bacterial concentrations at each cell
(corresponding to a pixel on the map) are calculated from
known concentrations at the previous time step and based on
Equation 2, where u is the active fungal density at the cell in
the previous time step.
b) The diffusion term is determined as an average of the
immediate neighboring cells, each with a contribution given
by Equation 4 and offset by a stochastic element determined
by Equation 5 to represent random movement.
c) The reaction term is computed in Equation 7 based on
density at the corresponding cell in the nutrient map during
the previous time step.
d) We calculate the nutrient reaction-diffusion process,
which is defined in Equation 9.
e) We update the maps by writing the new concentration
values at each fungal, rot, and nutrient cells.
Step 4. We integrate the deformable body at each time step
using the explicit fourth order Runge-Kutta scheme. A time
step size of 6 milliseconds was found to be sufficiently small
to guarantee numerical stability, although for more complex
polygonal meshes, an implicit scheme may be preferred.
4.2. Algorithm Details
Fungal and Bacterial Growth. Multiple researchers have
modeled fungal proliferation and morphological colony formation based on a non-linear reaction-diffusion process
[MGL93, ESRA10, IM09]. In our model, the fungus is separates into two states, active and inactive. As active fungi
grow and proliferate, they deplete the underlying nutrient
concentration defined in our nutrient map. As values in the
nutrient map approach 0, the fungi at that point become inactive and cease to spread. We calculate the concentration
of both active and inactive fungi by the following reactiondiffusion equations describing the fungal movement:
δu
= ∇ · (Dc ∇u) + θ f (u, n) − a(u, n)u
δt

(2)

δv
= a(u, n)u
δt

(3)

c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

J.T.Kider Jr. & S. Raja & N.I.Badler / Fruit Senescence and Decay Simulation

Equation 2 provides the diffusion term which governs the
non-linear growth at time t. Equation 3 is the reaction term
which depends on the nutrient concentration n, fungal density, and environment parameters. (u + v) is the total density
of the active u and inactive v fungus. The motility of active
fungus is expressed by the diffusion coefficient Dc , which is
defined by the logistic Equation 4. d1 , d2 > 0 are model parameters and σ1 is a scaling parameter. An additional scaling
parameter s = porosity + temp + humidity + waterContent
produces the growth rate difference between the soft rot and
fungal colonies, and between different species of fungus.
This parameter is determined by the user through the interface tool. A stochastic element, σ′1 , adds random movement
to the diffusion coefficient in Equation 5.
Dc = s · σ′1 · d1 u 1 −
σ′1 = σ1 (1 + δ),

u
d2

·n

−0.5 < δ < 0.5

(4)

(5)

Fungal growth depends heavily on the physical environment.
Relative humidity φ and temperature T dampen Ddamp =
norm(T + phi) the diffusion coefficient Dc expressed in
Equation 6.
Dc(u,n,T,φ) = Dc · Ddamp

(6)

We then use a Michaelis-Menten kinetic function (Equation 7) to model the reaction kinetics of enzymes. In Equation 2, f (n, u) describes the consumption of nutrients by the
active fungus u. Here θ is the constant rate in which fungal proliferation connects to nutrient consumption. f1 , f2 are
model parameters and σ2 is a scaling parameter.
f (u, n) = σ2

f1 n
1 + f2 n

·u

(7)

Equation 2 transforms active fungus u to inactive fungus v.
Here we used Mimura’s formula (Equation 8). Active fungus
normally diffuses along the border while inactive fungus resides in the center. Once again, a1 , a2 are model parameters
and σ3 is a scaling parameter.
a(u, n) = σ3 ·

1
1 + au1 · 1 + an2

(8)

δn
= Dn ∇2 n − f (u, n)
δt

263
(9)

Table 3 provides the initial model parameters of our simulation. These parameters change the growth rate and nutrient depletion. This process is further affected by water
vapor pressure, humidity and temperature. Our system provides default parameters for the most popular types of mold
growth. However, our simulation method below can generalize to different mold types by manipulating the input parameters.
σ1 = 0.01,
σ2 = 5.0,
σ3 = 5.0,
u0 = 1.0,

Model Parameters
d1 = d2 = 0.01, n0 = 1.0
f1 = f2 = 1.0,
θ = 0.05
a1 = 1/2400,
a2 = 1/120
v0 = 0.0,
Dn = 0.000001

Table 3: This table provides the biologically inspired parameters [IM09] for our reaction-diffusion mathematical model.
Transpiration. The transpiration rate of fruit plays a considerable role in the water balance and weight during decay.
Equation 10 expresses the typical transpiration rate m. Here
K is the overall mass transfer coefficient. Table 1 provided
values for the various fruit types found in our examples. (Depending on various characteristics of each individual fruit,
this coefficient varies slightly sample by sample.) A is the
surface area of the fruit. Ps is the water vapor pressure at the
evaporating area surface. Pa is the water vapor pressure of
the surrounding atmosphere.
m = KA(Ps − Pa )

(10)

The water vapor pressure Ps is calculated by Vp · Psat (Ts )
[CG85]. Here Psat is the saturation vapor pressure of water,
Ts is the surface temperature and Vp is the vapor pressure set
as either 0.98 or 0.99. T is the atmospheric temperature. Ps
is Psat ’s steam point pressure. A good estimate of the saturation of water vapor pressure at a given temperature can be
acquired using the Goff-Gratch equation.
log Psat

=
+
−
+
+

−7.90298 · (Ts /T − 1)
5.03808 · log(Ts /T )
1.3816 · 10−7 · (1011.344(1−T /Ts ) − 1)
0.0081328 · (10−3.49(Ts /T −1) − 1)
logPs
(11)

We model the spread of bacterial colonies using the same
formula. The bacterial soft rot map guides the propagation of
fungal colonies. The fungi cannot propagate into areas unaffected by bacteria, thus reflecting the notion that the growth
of certain organisms on the surface depends on existing infection.

5. Results

Nutrients exist in a non-uniform random distribution on the
surface and substrate of the fruit. This is the main factor for
fungal growth in our model. Nutrients deplete and do not
allow fungus to remain active indefinitely. Nutrient transport
is defined by Equation 9. The nutrients are diffused by the
term Dn ∇2 n and consumed by f (u, n). Dn is the nutrient
diffusion coefficient.

We simulated our results on a 3.2GHz quad core Xeon processor with 4 GB of memory. The deformable body and fungal growth codes were written in C++. Each time-step averaged around 10 seconds to compute the reaction-diffusion,
transpiration, and deformable collapse, and to write the texture maps. Applying the vertex cache data generated by the
deformable body simulation to the user-defined mesh took

c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

264

J.T.Kider Jr. & S. Raja & N.I.Badler / Fruit Senescence and Decay Simulation

fungus to begin to grow and the fruit to begin collapse on
directed input.
5.2. True Life Comparison
In Figure 6 we compare our final rendered frames to real
photographs. We demonstrate that our method produces similar effects. A key feature of our system is that the biologically derived models simulate perceptually equivalent and
indistinguishable results. Every individual piece of fruit has
its own unique decay since it will have some random variation and growth. However, our simulation produces similar
decay patterns to the real data.
Figure 6: A comparison of real photographs (right), and our
simulation results (left) of a tomato and orange.
1.5 seconds per frame. Rendering time was approximately
10 minutes per frame with our scene lighting.
In this paper, we have provided final renders for three
types of fruit: an apple, an orange, and a tomato. We demonstrate that we can simulate a variety of fruits and fungi.
Figure 9 shows a final rendered sequence of an orange and
tomato. Figure 4 displays the apple sequence.
Figure 8: Here we simulate a group of fruit. Mold begins
to form at the main contact areas where the oranges are
grouped.

5.3. Multiple Fruit

Figure 7: A screen shot of our user interface tool in Autodesk’s Maya. Our plug-in tool allows users to choose presets and parameterize the simulation to generalize output.
The user imported her own geometry and is currently displaying the nutrient map on the object.

We have demonstrated our simulation on a group of oranges.
Figure 8 shows a final rendered result. In this example, there
are more contact points between the multiple pieces of fruit.
These contact points provide more pressure to the fruit skin
causing wounds and locally high humidity. When a fruit becomes damaged, fungus begins to appear at these locations
due to the increase in nutrient concentration. Since our simulation is parameterized on pressure points, it was straightforward to show the results of mutual contacts among the
grouped fruits, demonstrating the full power of our method.
6. Conclusions

5.1. User Interface Tool
We have designed and developed an authoring tool that integrates our simulation into a plug-in to Autodesk Maya 2010.
Our user-interface is scripted in MEL and uses the Maya
plug-in API to develop features to allow the user to create
and parameterize our simulation. Figure 7 shows the various features our tool provides the user. The designer selects
meshes to use, and customizes the simulation. The user may
also visualize the various fungal, soft rot, and nutrient maps
on the mesh using the button on the top of the tool. Additionally, the user may select pressure points that allow new

We describe a system for simulating fruit senescence and
decay. Our approach is perceptually similar to real photographs and time-lapse videos. The system takes advantage
of a biologically-derived reaction-diffusion model to create
growth patterns for areas of fungal and bacterial infection.
We simulate interactions between multiple phenomena acting on both the surface and internal substrate. Additionally,
we provide presets and parameters that allow a user to simulate a variety of novel effects. We demonstrate our method
on three fruits: an apple, orange, and tomato. To demonstrate
our method’s generalization to any user-defined object, we
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

J.T.Kider Jr. & S. Raja & N.I.Badler / Fruit Senescence and Decay Simulation

imported a unique mesh into our user interface and simulated the decay processes based on user parameterization.
Our model simulates a complex class of time-varying aging
effects. In utilizing common production tools to render our
images, we show that our final product has straightforward
industry applications in movie and production pipelines that
require images or animations of decomposing fruit.
Though our model attempts to create a wide range of effects, it still does not demonstrate every single process. We
do not consider factors such as calcium deficiency, infection
while on the vine, and poor fertilization. Nor do we consider
if the fruit was sliced, and we also do not take into account
any liquid phase losses from the fruit. Certain fruits, when
wounded, tend to leak volume from a tear in the surface as
they decay. Lastly, we do not consider the effects of macroscopic organisms such as worms or flies.

265

Transpiration coefficients for certain fruits and vegetables. Transactions of American Society of Heating, Refrigerating and AirConditioning Engineers 94 (1988), 1553 – 1559.
[CS00] C HANG Y.-X., S HIH Z.-C.: Physically-based patination for underground objects. Computer Graphics Forum 19, 3
(2000).
[CXW∗ 05] C HEN Y., X IA L., W ONG T.-T., T ONG X., BAO H.,
G UO B., S HUM H.-Y.: Visual simulation of weathering by γ-ton
tracing. In SIGGRAPH (2005), pp. 1127–1133.
[DEJ∗ 99] D ORSEY J., E DELMAN A., J ENSEN H. W., L EGAKIS
J., P EDERSEN H. K.: Modeling and rendering of weathered
stone. In SIGGRAPH (1999), ACM Press/Addison-Wesley Publishing Co., pp. 225–234.
[DGA04] D ESBENOIT B., G ALIN E., A KKOUCHE S.: Simulating and modeling lichen growth. Computer Graphics Forum 23,
3 (2004), 341–350.
[DGA05] D ESBENOIT B., G ALIN E., A KKOUCHE S.: Modeling
cracks and fractures. The Visual Computer 21, 8-10 (2005), 717–
726.

In the future, we wish to extend our model to other
growth and decay time-varying phenomena. Adding even
more complex wrinkling and color changes are easy extensions to our model. Additionally, we wish to look at ways to
develop our simulation to cooking and roasting food. Another possible extension would be to use real input photographs and movies to seed the simulation.

[DPH96] D ORSEY J., P EDERSEN H. K., H ANRAHAN P.: Flow
and changes in appearance. In SIGGRAPH (1996), pp. 411–420.

7. Acknowledgments

[ESRA10] E L -S AYED A. M. A., R IDA S. Z., A RAFA A. A. M.:
On the solutions of the generalized reaction-diffusion model for
bacterial colony. Acta Applicandae Mathematicae 110 (2010),
1501–1511.

The authors would like to thank NVIDIA for the donation
of the graphics hardware, and Autodesk for their donation
of Maya. The authors wish to acknowledge Michelle Chen’s
preliminary artistic studies on this topic, and Alla Safonova
for all our helpful discussions.

[DH96] D ORSEY J., H ANRAHAN P.: Modeling and rendering of
metallic patinas. In SIGGRAPH (1996), pp. 387–396.

[DRS07] D ORSEY J., RUSHMEIER H., S ILLION F.: Digital Modeling of Material Appearance. Morgan Kaufmann Publishers
Inc., San Francisco, CA, USA, 2007.

[GC01] G OBRON S., C HIBA N.: Crack pattern simulation based
on 3d surface cellular automata. The Visual Computer 17 (2001),
287–309.

References

[GTR∗ 06] G U J., T U C.-I., R AMAMOORTHI R., B ELHUMEUR
P., M ATUSIK W., NAYAR S.: Time-varying surface appearance:
acquisition, modeling and rendering. In SIGGRAPH (2006),
pp. 762–771.

[AF04] A NDERSEN B., F RISVAD J. C.: Natural occurrence of
fungi and fungal metabolites in moldy tomatoes. Journal of Agricultural and Food Chemistry 52, 25 (2004), 7507–7513. PMID:
15675796.

[HD97] H ALOUAT A. E., D EBEVERE J. M.: Effect of water activity, modified atmosphere packaging and storage temperature
on spore germination of moulds isolated from prunes. International Journal of Food Microbiology 35, 1 (1997), 41 – 48.

[BB90] B ECKET W., BADLER N. I.: Imperfection for realistic
image synthesis. In Journal of Visualization and Computer Animation (Aug 1990), pp. 26–32.

[HW95] H SU S.- C ., W ONG T.- T.: Simulating dust accumulation.
IEEE Computer Graphics $ Applications 15, 1 (1995), 18–22.

[BH94] BASTIN S., H ENKEN K.: Water content of fruits and vegetables. http://www.ca.uky.edu/enri/pubs/enri129.pdf (1994).
[BKMTK00] B OISSIEUX L., K ISS G., M AGNENAT-T HALMANN
N., K ALRA P.: Simulation of skin aging and wrinkles with cosmetics insight. Computer Animation and Simulation (2000), 15–
27.
[Blo53] B LOCK S.: Humidity requirements for mold growth. Applied and Environmental Microbiology 6 (1953), 287–293.
B OSCH C., P UEYO X., M ÉRILLOU S., G HAZAN D.: A physically-based model for rendering realistic
scratches. Computer Graphics Forum 23, 3 (Sept. 2004), 361–
370.

[BPMG04]

FARPOUR

[CG85] C HAU K., G AFFNEY J.: A mathematical model for the
transpiration for fruits and vegetables. American Society of Agricultural Engineers No. 85-6005 (1985).
[CRBG88]

C HAU K., ROMERO R., BAIRD C., G AFFNEY J.:

c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

[IM09] I TO K., M IZUNO Y.: Numerical morphological analysis
of fungal growth based on a reaction diffusion model. Biocontrol
Science 14, 1 (2009), 21–30.
[JW09] J IAO S., W U E.: Simulation of weathering fur. In 8th
International Conference on Virtual Reality Continuum and its
Applications in Industry (2009), pp. 35–40.
[LBG00] L EONARDI C., BAILLE A., G UICHARD S.: Predicting transpiration of shaded and non-shaded tomato fruits under
greenhouse environments. Scientia Horticulturae 84, 3-4 (2000),
297 – 307.
[LGG∗ 07] L U J., G EORGHIADES A. S., G LASER A., W U H.,
W EI L.-Y., G UO B., D ORSEY J., RUSHMEIER H.: Contextaware textures. ACM Transactions on Graphics 26 (January
2007).
[MDG01] M ERILLOU S., D ISCHLER J.-M., G HAZANFARPOUR
D.: Corrosion: simulating and rendering. In Graphics Interface (Toronto, Ont., Canada, Canada, 2001), Canadian Information Processing Society, pp. 167–174.

266

J.T.Kider Jr. & S. Raja & N.I.Badler / Fruit Senescence and Decay Simulation

100

200

300

400

500

Simulation (c)

Simulation (b)

Simulation (a)

Tomato

0

Figure 9: Simulation results of a tomato and an orange under three different parameter settings set by three users from our
user interface. Simulation (a) and (b) set two different pressure points and produce different results. (c) changes parameters in
the mold growth to simulate different growth rates.

[MG08] M ÉRILLOU S., G HAZANFARPOUR D.: Technical section: A survey of aging and weathering phenomena in computer
graphics. Computer & Graphics 32 (April 2008), 159–174.
[MGL93] M OLIN P., G ERVAIS P., L EMIERE J. P.: A computer
model based on reaction-diffusion equations for the growth of
filamentous fungi on solid substrate. Biotechnology Progress 9,
4 (1993), 385–393.
[MM93] M ATSUYAMA T., M ATSUSHITA M.: Fractal morphogenesis by a bacterial cell population. Critical Reviews in Microbiology 19, 2 (1993), 117–135.

Fruit ripening phenomena-an overview. Critical Reviews in Food
Science and Nutrition 47, 1 (2007), 1–19.
[PUTV04] P LAZA P., U SALL J., T EIXIDÓ N., V IÑAS I.: Effect of water activity and temperature on competing abilities of
common postharvest citrus fungi. International Journal of Food
Microbiology 90, 1 (2004), 75 – 82.
[SB83] S ASTRY S., B UFFINGTON D.: Transpiration rates of
stored perishable commodities: a mathematical model and experiments on tomatoes. International Journal of Refrigeration 6, 2
(1983), 84 – 96.
[Tur91] T URK G.: Generating textures on arbitrary surfaces using
reaction-diffusion. In SIGGRAPH (1991), pp. 289–298.

[OMC03] O GASAWARA Y., M URAOKA K., C HIBA N.: Visual
simulation of moss taking into account local environment on temperature and humidity. The Journal of the Society for Art and
Science 2 (2003), 31–39.

[WK91] W ITKIN A., K ASS M.: Reaction-diffusion textures.
SIGGRAPH 25, 3 (1991), 299–308.

[OMM92] O HGIWARI M., M ATSUSHITA M., M ATSUYAMA T.:
Morphological changes in growth phenomena of bacterial colony
patterns. Journal of the Physical Society of Japan 61, 3 (1992),
816–822.

[WNH97] W ONG T.-T., N G W.-Y., H ENG P.-A.: A geometry
dependent texture generation framework for simulating surface
imperfections. In Eurographics Workshop on Rendering Techniques ’97 (London, UK, 1997), Springer-Verlag, pp. 139–150.

[PBL08] P ECH J., B OUZAYEN M., L ATCHÉ A.: Climacteric
fruit ripening: Ethylene-dependent and independent regulation of
ripening pathways in melon fruit. Plant Science 175, 1-2 (2008),
114 – 120.

[WTL∗ 06] WANG J., T ONG X., L IN S., PAN M., WANG C.,
BAO H., G UO B., S HUM H.-Y.: Appearance manifolds for modeling time-variant appearance of materials. ACM Transactions on
Graphics 25, 3 (2006), 754–761.

[PPD01] PAQUETTE E., P OULIN P., D RETTAKIS G.: Surface aging by impacts. In Graphics Interface (2001), Canadian Information Processing Society, pp. 175–182.

[XWT∗ 08] X UE S., WANG J., T ONG X., DAI Q., G UO B.:
Image-based material weathering. Computer Graphics Forum
(April 2008), 617–626.

[PPD02] PAQUETTE E., P OULIN P., D RETTAKIS G.: The simulation of paint cracking and peeling. In Graphics Interface
(2002), Canadian Information Processing Society, pp. 59–68.

[YFCT08] Y IN X., F UJIMOTO T., C HIBA N., TANAKA H. T.:
Modeling of wood aging caused by biological deterioration.
JACIII 12, 2 (2008), 125–131.

[PPT07]

P RASANNA V., P RABHA T. N., T HARANATHAN R. N.:
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.


DOI: 10.1111/j.1467-8659.2011.01944.x
Eurographics / IEEE Symposium on Visualization 2011 (EuroVis 2011)
H. Hauser, H. Pfister, and J. J. van Wijk
(Guest Editors)

Volume 30 (2011), Number 3

Visualizing the Positional and Geometrical Variability
of Isosurfaces in Uncertain Scalar Fields
Tobias Pfaffelmoser, Matthias Reitinger and Rüdiger Westermann
Computer Graphics and Visualization Group, Technische Universität München, Germany

Abstract
We present a novel approach for visualizing the positional and geometrical variability of isosurfaces in uncertain
3D scalar fields. Our approach extends recent work by Pöthkow and Hege [PH10] in that it accounts for correlations in the data to determine more reliable isosurface crossing probabilities. We introduce an incremental updatescheme that allows integrating the probability computation into front-to-back volume ray-casting efficiently. Our
method accounts for homogeneous and anisotropic correlations, and it determines for each sampling interval
along a ray the probability of crossing an isosurface for the first time. To visualize the positional and geometrical
uncertainty even under viewing directions parallel to the surface normal, we propose a new color mapping scheme
based on the approximate spatial deviation of possible surface points from the mean surface. The additional use of
saturation enables to distinguish between areas of high and low statistical dependence. Experimental results confirm the effectiveness of our approach for the visualization of uncertainty related to position and shape of convex
and concave isosurface structures.
Categories and Subject Descriptors (according to ACM CCS):
Generation—Display algorithms, Viewing algorithms

1. Introduction
Numerical data that is produced by measurements or numerical simulations is always affected by uncertainties due
to errors in the acquisition process, the underlying physical model, or the used computational method. One has to
be aware that the information contained in this data is never
exact, and that analyzing the data while ignoring local or
global uncertainties can result in misclassifications, misinterpretations, and false assumptions. This uncertainty cannot
be eliminated, but it can be provided to the user as possible
variations of relevant features.
Although uncertainty visualization is regarded one of the
grand challenges in visual data exploration [Joh04], it is
fair to say that standardized procedures for modeling and
visualizing the effect of uncertainty on features in multidimensional data are rare. The most recent approach by
Pöthkow and Hege [PH10] suggests to model the uncertainty
stochastically, and to derive probability distributions for particular events that correspond to relevant features, e.g., the
crossing of isosurfaces in volume ray-casting. This allows
quantifying the spatial distribution of uncertain features, enc 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

I.3.3 [Computer Graphics]: Picture/Image

abling a statistical analysis of the effect of uncertainties in
the input data on the uncertainty of these features.
Inspired by [PH10], the motivation behind our work is
twofold: Firstly, we are aiming for the integration of data
correlations into the stochastic uncertainty model to enable
a more reliable computation of isosurface crossing probabilities along the view rays. When ignoring sample correlations,
a zero correlation between very close samples is assumed.
This contradicts the assumption of local data continuity and
results in vastly overestimated probabilities. This effect is
demonstrated in Figure 1, where the uncertainty is modeled
as a multi-dimensional Gaussian random function. Since its
density function depends on pair-wise sample correlations,
the probabilities of crossing a surface along the view rays
under the assumption of distance-based correlation (a) are
significantly different to the probabilities when constant correlation is assumed (b).
Our second goal is to develop new strategies for mapping uncertainty to optical properties in a way that allows
visualizing the positional and geometrical variability independently of the viewing direction. In this way we are ad-

952

Pfaffelmoser et al. / Positional and Geometrical Isosurface Uncertainty Visualization

Figure 1: Volume visualization of isosurface crossing probabilities in uncertain 3D scalar fields (absorption is proportional to
probability, distance to mean-surface is color-coded from green (low) to red (high)). (a) Our approach with sample correlations
incorporated. (b) Probabilities are vastly overestimated when correlations are not considered. (c) Our approach supports viewindependent uncertainty perception by using color to indicate spatial distance. (d) Color mapping based on stochastic distance.

dressing the problem that positional uncertainties of isosurfaces can often be revealed only in 2D cross-sections or if
the viewer is not looking along the surface normal direction. If the isosurface position varies along this direction, it
can be perceived clearly only when viewing is orthogonal to
the normal. To overcome this limitation we propose an Euclidean distance measure that assigns to each possible isosurface position the spatial deviation from the mean surface.
This measure is used in a novel color mapping scheme to
assess the uncertainty that is related to the shape of an isosurface even under viewing directions parallel to the surface
normal. In Figure 1, the effect of this visual encoding (c) is
compared to an encoding that only considers the deviation
in probability space (d).
The remainder of this paper is as follows: In the next section we review previous work that is related to ours. Then we
briefly describe the basic concepts underlying the stochastic
modeling of uncertainty that is used in our work. In section
4 we present a novel algorithm for estimating the positional
probability density of the isosurface occurrence in a 3D uncertain scalar field along view rays. A new approach for visualizing the variability of isosurfaces by taking into account
their deviation from a mean surface is proposed in 5. Different mappings of the isosurface variability to optical properties are discussed in section 6. Results and an assessment
of the practical relevance of the proposed uncertainty visualization techniques is given in section 7. In section 8 we
provide implementation details, and we conclude the paper
with some ideas on future challenges in the field.

Major efforts have been put on the visualization of the
variability of isosurfaces in uncertain scalar fields. [PWL97,
JS03] proposed to augment a mean surface by additional surfaces that enclose areas of high confidence. The use of opacity to show spatial contiguity and isosurface confidence regions was demonstrated in [ZWK10]. Flowlines were introduced in [KWTM03] to visualize the uncertainty of material
boundaries. In [GR04] an isosurface was modeled as a point
set, and points were displaced from their original position by
an amount proportional to the local uncertainty. The animation of possible isosurface positions over time was demonstrated in [Bro04]. [RLBS03] indicate data uncertainty by
mapping color and texture on isosurfaces. Recently, [PH10]
presented a method for visualizing the positional variability around a mean isosurface using direct volume rendering.
Based on probability theory, they introduced mathematical
formulations for the positional uncertainty of isosurfaces and
employed the concept of numerical condition for visually
presenting how errors in the input data are amplified in isosurface extraction.
The visualization of uncertainty as a secondary data
source using icons and glyphs has been considered in
[WPL02, SZD∗ 10]. [LLPY07] applied animations to vary
the appearance for uncertain regions in medical datasets.
In [DKLP02], opacity deviations and noise effects were used
to provide qualitative measures for the uncertainty in volume rendering. [OGHT10] extended the concept of vector
field topology to uncertain vector fields by introducing density distribution functions. Uncertainty in classification and
segmentation was addressed in [KVUS∗ 05].

2. Related Work
In scientific visualization, the indication of accuracy in the
displayed results has been mainly restricted to particular domains such as geographical information systems [MRH∗ 05],
seismology [BAF08] and astrophysics [LFLH07]. For an
overview and taxonomy of uncertainty visualization let us
refer to [JS03, THM∗ 05, GS06]. [SZD∗ 10] pursued a case
study to analyze the effectiveness of uncertainty visualization techniques for 1D and 2D datasets.

3. Stochastic Modeling of Uncertainties
In the context of 3D scalar datasets, by uncertainty we understand the mean deviation of the data samples from a true
or assumed value without precise knowledge of the magnitudes of these deviations. We assume the data samples to be
attributed by parameterized uncertainty, which will be considered in the visualization of the positional and geometrical
variability of isosurfaces in the data.
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

953

Pfaffelmoser et al. / Positional and Geometrical Isosurface Uncertainty Visualization

3.1. Uncertainty Representation
The 3D scalar field is assumed a discrete sampling of a
mapping from the continuous spatial domain S ⊆ R3 into
R. The sampling is represented by a finite set of n spatial
points Sn = {xi : xi ∈ S, i ∈ {1, 2, ..., n}} ⊂ S. The mapping and its uncertainty is modeled as a random function
Y : Sn → R, x → Y (x), where for each spatial point xi the
mapping Y (xi ) is considered a random variable.
The random function is characterized by a n-dimensional
probability density function f (y1 , y2 , ..., yn ), where yi is a
realization or observed value of the random variable Yi :=
Y (xi ). Throughout this work, f is assumed a multivariate
normal probability density function (MNPDF). MNPDFs
are commonly used for modeling probability densities since
they have often shown to adequately represent random fluctuations in measured values of deterministic quantities. In
order to fully characterize f , for every sample point the mean
value µi := µ(Yi ) and the standard deviation σi := σ(Yi ) have
to be known, and pair-wise correlations ρi j := ρ(Yi ,Y j ) are
required to build the covariance matrix of a MNPDF.

There are many ways to understand the meaning and effect
of correlation [RN88]. We will interpret it as a measure for
stochastic dependence and as a modeling tool for smoothness and continuity. For MNPDFs, correlation is specified
in the form of a symmetric correlation matrix, which contains correlation coefficients −1 ≤ ρ(Yi ,Y j ) ≤ 1 between
two components of the multidimensional random function
Y . These coefficients are a direct measure of the stochastic
dependence of two components of Y . If Yi deviates positively
from µi by the magnitude ∆µ, a large correlation value indicates that Y j also deviates positively (ρi j ≈ 1) or negatively
σ
(ρi j ≈ −1) around ∆µ · σij from µ j . For ρi j ≈ 0 the realizations of Y j are considered uncorrelated from Yi .
Discrete samplings of a continuous mapping usually assume a certain local smoothness and at least local continuity
of the sampled quantity. To achieve this, random function
correlation is described by spatial distance dependent correlation functions [Tar05]. In the case of a MNPDF one typically uses the exponential correlation function (ECF)
(1)

which assigns higher correlations to random variables of
points with smaller Euclidean distance. If the correlation
strength τ is defined locally for each point in Sn , the ECF
becomes
ρ(Yi ,Y j ) = exp(−0.5(τ(xi ) + τ(x j )) xi − x j ).

τ1 (xi )(xh1 − xi1 )2 + τ2 (xi )(xh2 − xi2 )2 + τ3 (xi )(xh3 − xi3 )2 =
= − log(|ρ(Yi ,Yh )|) xh − xi

, h ∈ {k, l, m}

(3)

for at least three neighboring points xk , xl , and xm of xi and
correlation values ρ(Yi ,Yk ), ρ(Yi ,Yl ) and ρ(Yi ,Ym ) usually
given by the data as correlation matrix. In this formulation,
xis denotes the s-th component of vector xi . For a homogeneous correlation model, τ(xi ) can be defined as the mean of
τ1 (xi ), τ2 (xi ), and τ3 (xi ). Note, that only the magnitude of
the local correlation is modeled by the ECF. The sign can be
stored as binary value for each spatial direction at point xi .
3.3. Stochastic Distance Function
To relate the possible occurrence of an isosurface to the local
uncertainty, the stochastic distance function (SDF)

3.2. Correlation

ρ(Yi ,Y j ) = exp(−τ xi − x j ) , xi , x j ∈ Sn ,

the anisotropy. This tensor can either be derived from the
correlations in the data samples, or it can be specified based
on a priori knowledge. If one assumes at every point xi different parameters τ1 (xi ), τ2 (xi ), and τ3 (xi ) along the three
major spatial directions, the tensor coefficients are given as
Tkl = 0 for k = l and Tkk = τk . The parameters τk can be
computed by solving the linear equation system

(2)

To model anisotropic correlations, the parameter τ can be
made dependent on a specific direction. For a unit vector r,
the parameter τ at point xi in direction r is then given by
τ(xi , r) = rT T(xi )r, where T is a rank-2 tensor that models
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Ψθ (xi ) :=

µi − θ
max(σi , σmin )

xi ∈ Sn , θ ∈ R,

(4)

is often used. Here, θ refers to a specified isovalue, and a
minimum standard deviation σmin is assumed to avoid numerical problems.
The SDF corresponds to the 1-dimensional formulation
of the Mahalanobis distance [Mah36, DMJRM00], and it indicates at point xi the distance of the mean value µi to the
isovalue in number of σi . SDF fields are often used to depict
the confidence volume containing the level-θ isosurface with
a certain probability [ZWK10], or the SDF values are used
for color coding uncertain isosurfaces as in [PH10]. Our algorithm computes the SDF for all grid vertices on-the-fly
and uses these values either for computing isosurface crossing probabilities as discussed in section 4 or for determining
probability gradients as described in section 5.
4. Probabilistic Isosurface Extraction
We now describe our approach for computing positional
probabilities of isosurfaces in uncertain 3D scalar fields via
volume ray-casting. We assume a 3D grid structure, attributed by a mean µi and a standard deviation σi at every grid vertex xi . For a given isovalue this allows computing per-vertex SDF values as described in 3.3. In addition, for every cell a rank-2 tensor is stored according to the
ECF model as discussed in 3.2. The 6 distinct tensor values are stored as per-cell attributes. The grid is supposed to
be equipped with a local cell-wise interpolation scheme to
reconstruct SDF values at any point in the 3D domain.
Isosurface ray-casing is performed by sampling the scalar

954

Pfaffelmoser et al. / Positional and Geometrical Isosurface Uncertainty Visualization

field along the view rays in front-to-back order. Our approach for uncertainty visualization computes along each
ray and in each sampling interval the probability of crossing the isosurface for the first time. The technique is intertwined with the front-to-back traversal in that it provides an
incremental update-scheme for determining these probabilities solely based on local evaluations.

(MNCDF) of dimension i + 1 for each interval Ii . Since
this is by far too costly, we propose an efficient method
for incrementally updating P(Ci+ ) with a minimum of
additional operations per interval. Furthermore, we will
show that it is possible to compute P(Ci+ ) using at most 2dimensional MNCDFs and, thus, to avoid costly evaluations
of high-dimensional MNCDFs.

4.1. Isosurface Crossing Probability

By using the theory of conditional probability, we can
rewrite P(Ci+ ) in the following way:

The volume is sampled along each ray at equidistant discrete linear ordered sample points {s1 , s2 , ..., sn } ⊂ S. At
each point si a SDF value ψi is obtained via interpolation,
and for two consecutive sample points si and si+1 a correlation value ρi := ρ(Y (si ),Y (si+1 )) is computed as described
in 3.2. From this data the probability pi for crossing the isosurface in the sampling interval Ii = [si , si+1 ] is calculated.
Notably the probability pi cannot be computed by only
considering the current interval. In this case, the probability
pi + pi+1 also considers the event of crossing the surface
in Ii and Ii+1 . However, to guarantee a reliable positional
probability estimation, the event of crossing the isosurface
either in Ii or in Ii+1 has to be considered, i.e., based on a
XOR combination of disjoint crossing events. Therefore, we
introduce the events
Yi+ : = (Y (si ) ≥ θ)
Yi−

: = (Y (si ) < θ),

(5)
(6)

which compare the value of the random variable Y at the
sample points to the isovalue. By using these events, the positive first crossing event
+
Ci+ := Y1− ∩Y2− ∩ ... ∩Yi− ∩Yi+1

(7)

can be defined; it describes the incident that the isosurface
is crossed (from lower to higher values) in interval Ii for the
first time. The negative crossing event Ci− is defined respectively. For simplicity, in the following we will only investigate C+ — all results apply in the same way for C− .
The proposed event formulation guarantees that Ci+ and
C+
j for i = j are disjoint events that cannot be both true at
the same time, i.e., XOR combinations of crossing events
are considered. With a probability measure P, the total positive isosurface crossing probability along a ray can then be
computed as ∑ P(Ci+ ). P(Ci+ ), and respectively P(Ci− ), provide an indication of the positional variability around the
most likely position of the isosurface. In our algorithm we
set pi := P(Ci+ ) + P(Ci− ) to account for positive and negative first crossing events. Here we exploit the fact that Ci+
and Ci− are also disjoint events.
For computing P(Ci+ ) = P(Y (s1 ) < θ,Y (s2 ) <
θ, ...,Y (si ) < θ,Y (si+1 ) ≥ θ) efficiently, we employ
the fact that the probability density function f is assumed
to be of MNPDF type (cf. 3.1). In general, one can evaluate
the multivariate normal cumulative distribution function

+
P(Ci+ ) = P(Y1− ∩Yi+1
|Y2− ∩ ... ∩Yi− )P(Y2− ∩ ... ∩Yi− ) (8)

We also know that for a MNPDF with the special requirement ρ(A,C) = ρ(A, B)ρ(B,C) on the correlation coefficients the following rule applies:
P(A ∩C|B) = P(A|B) P(C|B)

(9)

Since we use an ECF (cf. 3.2) for the modeling of correlations, pair-wise correlations can be written as
i+m−1

ρ(Y (si ),Y (si+m )) =

∏

ρ(Y (s j ),Y (s j+1 )).

(10)

j=i

This means that the aforementioned requirement is met and
(9) can be applied several times to (8) to arrive at the following equation for P(Ci+ ):
P(Ci+ ) = P(Y1− )

+ i−1 P(Y − ∩Y − )
)
P(Yi− ∩Yi+1
j
j+1

P(Yi− )

∏

j=1

P(Y j− )

(11)

The high-dimensional MNCDF value P(Ci+ ) can be expressed solely by 1- and 2-dimensional MNCDFs of random variables of consecutive sample points. Thus, P(Ci+ )
can be computed incrementally by considering only consecutive sample points along a view ray. We will subsequently
call this incremental algorithm the isosurface-first-crossingprobability (IFCP) algorithm.
By introducing the negative no-crossing event Ni− :=
following rule

Y1− ∩Y2− ∩ ... ∩Yi− , we can now propose the
for updating P(Ci+ ) in interval Ii along a ray:
P(Ci+ ) = P(Ni− )
−
) = P(Ni− )
P(Ni+1

+
)
P(Yi− ∩Yi+1

P(Yi− )
−
)
P(Yi− ∩Yi+1

P(Yi− )

(12)
(13)

Here, P(Ni− ) can be computed in-place and P(N1− ) =
+
P(Y1− ) applies. Keeping in mind that P(Yi− ∩ Yi+1
) =
−
−
−
P(Yi ) − P(Yi ∩Yi+1 ), it is sufficient to compute the proba−
) for each interval Ii . This is
bilities P(Yi− ) and P(Yi− ∩Yi+1
done using the SDF values ψi and ψi+1 , the correlation ρi in
interval Ii , as well as the univariate (Φ1 ) and bivariate (Φ2 )
standard normal cumulative distribution functions:
P(Yi− ) = Φ1 (−ψi )
−
P(Yi− ∩Yi+1
) = Φ2 (−ψi , −ψi+1 ; ρi )

(14)
(15)

c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Pfaffelmoser et al. / Positional and Geometrical Isosurface Uncertainty Visualization

4.2. Probability Mapping
The isosurface first crossing probability pi is then mapped
to opacity according to the following considerations. In volume rendering an optical emission-absorption model for accumulating color and opacity information along each ray of
sight is employed. The overall opacity along a single ray is
written as α = 1 − exp(−λ), where λ can be interpreted as
the number of small opaque particles the ray hits on its way
through the volume. For each ray through the volume an interactively specified maximum number of particles λmax is
distributed among the sample intervals Ii according to their
probabilities pi . This results in the local and global opacities:
α(Ii ) = 1 − exp(−λmax pi )
n−1

assumption of maximum correlation. It can be seen clearly
that the IFCP values for the second crossing are significantly
lower if there is a high PO for the first crossing and vice
versa. Secondly, the PPs for each crossing do almost not
change. The illustration also reveals the importance of incorporating correlation information in the computation of probabilities for obtaining correct PP and PO values.

(16)

n−1

Ii

α

955

= 1 − exp −λmax

i=1

∑ pi

,

(17)

i=1

where the global opacity represents the overall probability
that the ray hits an isosurface along its way through the volume. While special attention has been put on the fact that
only a linear relation between pi and λi = λmax pi is feasible. A linear relation between pi and αi is not possible as the
probabilities are accumulated in an additive manner whereas
opacities are updated multiplicatively along the ray.
4.3. Probability Types
An open question is whether the IFCP algorithm can also
be applied when the ray hits two isosurfaces that have no
stochastic dependence (e.g. because they are too far away
from each other). Let us assume that the ray hits an isosurface with a significant probability (e.g. 0.5) in the sample
interval I = [si , si+u ] and also in interval J = [s j , s j+v ] with
i+u
j and ρ(Y (si+u ),Y (s j )) ≈ 0. The probabilities that
are computed for all subintervals in J are all conditioned
under the same assumption that there was no crossing in I.
Thus, relative to each other, all sub-probabilities for J describe the positional variability in J. Furthermore, all values
grow by the same factor if the true crossing probability for I
approaches 0.
We will call the overall probabilities ∑i+u−1
pk and
k=i
for regions with low correlation between each
other probabilities of occurrence (PO). The sub-probabilities
within regions of high correlation (e.g. around the maximum
likelihood position in I and respectively in J) will be called
probabilities of position (PP). The IFCP algorithm has the
nice property that while computing the PPs, it simultaneously combines the POs in the correct visibility order. It further guarantees that the overall crossing probability along
the entire ray never exceeds 1.
j+v−1
∑k= j pk

Figure 2 illustrates the concept described above for two
correlation assumptions. If independence is assumed (ρi =
0), the ray crosses the isosurface with much higher probability for the first time at an earlier stage compared to the
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Figure 2: The sampling along a ray (black) on a 2D slicing
plane in a 3D dataset is shown. Negative values (red) are
separated from positive values (green) by an 0-isosurface
(blue). Its uncertainty is indicated by the blue area, representing the isosurface positions for up to ±σ. The lower
illustration shows the positive first crossing probabilities
P(Ci+ ) as computed by our IFCP algorithm for each interval and under the assumption of zero (green) and maximum
(blue) correlation between consecutive sample points.

5. Geometric Variability
A major problem in visualizing isosurface variability is that
the effectiveness of the visual perception of the variability
depends on the viewing direction. If the uncertainty only reflects in the opacity variation, possible isosurface displacements, in general, can be only visualized if the viewing direction is nearly orthogonal to the surface normal. Similarly,
since the SDF does not contain any information on the spatial distance variability, for a normal-parallel view the accumulation of colors that are mapped from SDF values cannot
reveal the spatial isosurface variation in viewing direction.
Thus, a method is required that preserves the positional
uncertainty information independently of the viewing direction. To achieve this, we propose a measure of the spatial
isosurface variation due to the uncertainty. This measure is
then used for assigning colors that emphasis the geometric
surface variability.
5.1. SDF Surfaces
To reveal the uncertainty that is related to the shape of an
isosurface, we incorporate shading effects into uncertainty
volume rendering. Therefore, the vector pointing towards the

956

Pfaffelmoser et al. / Positional and Geometrical Isosurface Uncertainty Visualization

direction of maximum increase in isosurface crossing probability is used. Except for the sign, this vector is equivalent
to the gradient ∇Ψθ (xi ) of the stochastic distance function.
Setting t = Ψθ (xi ), this gradient is located orthogonal to the
set
ϑθ (t) := {x ∈ S : Ψθ (x) = t},

(18)

which contains all points having the same SDF value and,
thus, the same stochastic distance from the isovalue. This set
is commonly referred to as SDF surface.
SDF surface rendering is a common approach for visualizing positional isosurface uncertainty. For instance, in
[ZWK10] ϑθ (1) and ϑθ (−1) were used to indicate the spatial region that contains the isosurface with a probability of
0.68. In our algorithm the gradient ∇Ψθ is computed onthe-fly from the SDF values at the grid points, and it is then
used for revealing the geometric variability of isosurfaces
via shading effects and for estimating Euclidean distances
between the mean surface and possible isosurface positions.
5.2. Spatial Distance Estimation
The positional uncertainty can be perceived in normalorthogonal viewing direction because the opacity decreases
with increasing spatial distance from the mean surface
ϑθ (0). This distance mainly varies orthogonal to the ray
direction. In normal-parallel direction, however, the spatial
distance varies in viewing direction, requiring to use an additional visual representation to show this variation.
To visually encode the spatial distance of a point on a SDF
surface ϑθ (t) to the mean surface ϑθ (0), we first have to
derive a measure that estimates this distance. Therefore, we
define so called SDF normal curves γxθ : R → S for a point
x ∈ S using the following differential equation:
dγxθ
(t) = ∇Ψθ (γxθ (t)) , γxθ (0) = x
dt

(19)

Each normal curve crosses all SDF surfaces orthogonal. The
magnitude of its derivative describes the amount of change
in SDF value for an infinitesimal change in the spatial domain. The distance d(x) of point x ∈ ϑθ (t) for t = 0 from
the mean surface is now defined as the length of the normal
curve γxθ between x and its intersection point with ϑθ (0) in
3D space (see Figure 3 for an illustration of this concept in
2D).
The "length" of the curve in SDF space is actually the
SDF difference |Ψθ (x)| between ϑθ (x) and ϑθ (0). Thus, we
obtain the equation
d(x)
0

∇Ψθ (γxθ (t)) dt = |Ψθ (x)| .

(20)

For simplicity we assume that ∇Ψθ is constant along
the considered curve segment, which means a linear increase/decrease in isosurface crossing probability along the

Figure 3: This illustration shows the mean isosurface
(green) of a 2D dataset, as well as three positive SDF surfaces. SDF normal curves (blue) are displayed for several
points on the ϑθ (3) surface. Points on the SDF surfaces are
color coded with respect to the length of their normal curve
to the intersection point with ϑθ (0) - from green (small distance) to red (large distance). The magnitude of the numbers
on the axes and on the color bar are related to Euclidean
distances in the 2D domain.

SDF normal curve. Even though this assumption could be violated for large values of |Ψθ (x)|, it should be quite reasonable for SDF surfaces close to the respective mean surface.
Finally, the distance can be estimated as
d(x) =

|Ψθ (x)|
,
∇Ψθ (x)

(21)

which provides a good indication of how strong a point x is
deviated from the mean surface ϑθ (0).
6. Visualization
For visualizing the positional and geometrical variability of
a particular isosurface in an uncertain 3D scalar field, we
use front-to-back volume ray-casting and compute the opacity according to the IFCP approach, in which the isovalue
is interactively specified by the user using a slider. At each
sample point si , the spatial distance estimate d(si ) is mapped
to a HSV color value, with the distance being encoded into
the hue channel. Based on a user-defined maximum distance
dmax , the range [0, dmax ] is linearly mapped to the color map
[green → yellow → red], and values greater than dmax are
clamped to dmax . To integrate shading effects and, thus, to
highlight the shape of the SDF surface, the cosine between
the ray direction and the SDF gradient ∇Ψθ is used to modulate the value of the HSV color sample. Here we allow a
value reduction of at most 50%.
Color coding the spatial distance from the mean surface
along the SDF normal curves allows for an intuitive perception of the isosurface variability in normal-parallel viewing
direction. However, this approach has a drawback when the
isosurface is cut by a slicing plane. In this case the color distribution is somewhat misleading since "color isocontours"
do not necessarily represent a single SDF value. Therefore,
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Pfaffelmoser et al. / Positional and Geometrical Isosurface Uncertainty Visualization

on slicing planes a color scheme based on SDF related measures, e.g., as proposed in [PH10], gives a better impression
of the spatial variability.
In order to overcome this limitation we use SDF isocontours on slicing planes, indicating its intersection with the
SDF surfaces ϑ(0), ϑ(±1), ϑ(±2), etc. with a ±0.1 tolerance. The SDF magnitude is coded into the blue channel using the LCP value introduced in [PH10]. As illustrated in
Figure 4, this gives a clear impression of the relation between SDF values and spatial distances on slicing planes.

Figure 4: An uncertain 3D signed distance field to a 2D
topographic height map is shown. Multiple instances to a
randomly displaced height map were generated, and the
mean and standard deviations where computed from these
instances. SDF isocontours on slicing planes indicate the
set ϑθ (0) (blue) and the sets ϑθ (±i) with decreasing opacity and saturation. Note the relation between converging isocontours and low spatial distance (green) in (1) and between
diverging contours and high spatial distance (red) in (2)
In section 4.3 we have discussed the concept of probabilities of occasion and position. In order to integrate this
concept into the visualization we desaturate areas with high
PO but low correlation to the mean surface. For each sample point the spatial distance d(si ) is used for computing a
correlation coefficient in ∇Ψθ direction using the ECF. This
coefficient is linearly mapped to saturation. Thus, areas with
a high spatial distance and a low correlation to values on the
mean surface receive a lower saturation, indicating their independence and significance as PO area. In this way the user
can visually differentiate between possible isosurface positions with high positional distribution on the one hand, and
regions which might contain an isosurface but are stochastically independent from those PP areas on the other hand.
In addition, SDF surfaces can be rendered as add-on to the
IFCP approach. A SDF value can be specified interactively
by the user and the visualized surface can help to analyze
stochastic geometrical and topological changes or to visually link stochastic and spatial distances. Further interaction
mechanisms include the specification of the maximum opacity by controlling the respective number of particles λmax
(cf. 4.1) as well as the range [0, dmax ] of the spatial distance,
which is mapped to the given color map.
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

957

7. Results and Analysis
To validate the effectiveness of the proposed uncertainty visualization techniques we have conducted experiments on
uncertain 3D scalar fields given on tetrahedral grids. The following datasets were used:
• The GEO dataset was generated by seismic tomography, where recorded seismic waves were used for inferring structures in the earth’s mantle below the IndoAustralian Plate. The scalar values represent the magnitudes of seismic wave velocities, enabling to separate subsurface structures with high and low velocities. As the
computations were performed on incomplete and noisy
data, the position of separating surfaces is highly affected
by uncertainty [Käu10].
• The ATMOS dataset shows a 3D temperature field in the
exosphere above Europe and the North Atlantic Ocean.
It contains the mean values of multiple fields that were
simulated by the European Centre for Medium-Range
Weather Forecasts using different input parameters [Eur].
In Figure 1 (a) the GEO dataset is visualized using the
IFCP algorithm (with distance dependent correlations incorporated) in combination with distance based coloring. In
(b) the data is visualized using the same sampling distance
along the view rays as in (a), but uncorrelated data samples
were assumed (ρi = 0). Since the local data continuity and,
thus, the stochastic dependency between nearby data samples was not considered, the isosurface crossing probabilities
are strongly overestimated. This results in artificial bridging
structures and a misleading probability visualization.
Figure 1 (d) shows a visualization of an uncertain isosurface in the ATMOS dataset using the IFCP algorithm.
SDF values were linearly mapped to color. In (c) the same
approach was used, but SDF values were mapped to color
based on their spatial deviation from the mean surface along
normal curves. By visualizing SDF isocontours on a slicing
plane, the positional variability of the isosurface can be revealed locally in either case. Globally, and where the viewing direction is parallel to the normal of the isosurface, our
approach (c) emphasizes the strength of the spatial deviation
from the mean surface in convex and concave regions. Since
SDF values do not contain any spatial distance information,
the visualization in (d) fails in depicting the uncertainty with
respect to the shape of the mean surface.
The potential of the proposed uncertainty visualization
techniques for analyzing the effect of uncertainty on specific data features is demonstrated in Figure 5. In (a), the
surface to a given isovalue is shown. In (b), the IFCP algorithm and spatial distance coloring were used under the
assumption of homogeneous correlation (ρi = 1). The confidence volume containing the isosurface with a certain probability is enclosed by two stochastic distance surfaces in (c).
The uncertainty visualization highlights the region where the
simulated temperature field is rather sensitive to the input
parameters of the simulation, indicating that the forecast for

958

Pfaffelmoser et al. / Positional and Geometrical Isosurface Uncertainty Visualization

Figure 5: (a) The mean surface for a temperature isovalue in the ATMOS dataset. (b) The IFCP algorithm in combination with
distance dependent color mapping. (c) SDF surfaces ϑ(±2) emphasize the uncertainty in isosurface shape.

this region is not reliable. This information suggests to improve either on the physical forecast model, the used initial
conditions, or the employed computational scheme to obtain
a less sensitive and, thus, more reliable result.

tween regions with high correlation and, therefore, high positional uncertainty, and areas with high stochastic independence and, therefore, high occurrence uncertainty.

An example which demonstrates the suitability of our approach for detecting possible topology changes due to uncertainty is shown in the visualization of the GEO dataset in
Figure 6. In (a), the mean isosurface separating subsurface
structures with high and low seismic wave velocities in the
earth mantle below Australia is visualized. If the geometric variability of the separating surface due to uncertainty
(constant correlation of ρi = 1) is visualized (b), additional
"bridging" structures occur with a certain probability (1).
Notably these structures and their geometrical appearance
cannot be detected if uncertainty is ignored or only used to
color the mean surface. To facilitate an improved assessment
of the uncertainty related to the shape of an isosurface, and to
employ the possibilities of a surface structure for integrating
shading effects, the SDF surfaces ϑ(±2) are incorporated
into the visualization in (c).

8. Implementation and Performance Details

In (d), with respect to (b) an anisotropic correlation decrease is assumed. The result is a significantly higher surface
crossing probability along the view rays in area (2). In this
example, saturation was chosen as an indication of high distance from the mean surface and low correlation. Thus, the
specific color coding reveals high local stochastic independence rather than high local positional surface variability as
major cause of the crossing probability in (2).
This information is important for analyzing the relationship between uncertainty parameters, like standard deviations and correlation structures. Especially in seismic tomography, high correlations are assigned to areas with high
uncertainty for regularization purposes, and these correlations are then incorporated into a prior stochastic model. In
this way areas with high PO concurrency, like in (d), can
be avoided and uncertainty datasets obtained, clearly showing the positional variability like in (b). The visual analysis of the effect of such prior stochastic models is of great
importance for steering the tomography process towards reduced uncertainty. The visual integration of the PO/PP concept, as discussed in 4.3, is another new strong benefit of
our proposed methods, since it enables differentiating be-

All of our results were rendered into a 1K × 768 viewport using volume ray-casting on the GPU as proposed in
[Wei05]. Tetrahedral elements — represented by four indices to their vertices — were stored in an element buffer.
Each element was accompanied by a correlation tensor and
four additional links to their neighboring elements. Shared
vertex buffers were used to store the vertex coordinates as
well as the mean values and standard deviations. View rays
were traversed with a given sampling distance by subsequently computing ray-cell intersections and following the
respective link to the next element. Barycentric interpolation
was used to reconstruct a continuous field, and early-ray termination was performed at an optical attenuation above 0.95.
When executing the IFCP algorithm, the update operations (12) are performed at every sample interval along the
view rays. This requires evaluating and interpolating pervertex SDF values, and evaluating the probabilities P(Yi− )
−
) as stated in (14). To reduce the comand P(Yi− ∩ Yi+1
putations required for evaluating the distribution functions
Φ1 and Φ2 , and to avoid precision problems caused by
real number divisions in (12), function values Φ[a, b, ρ] =
Φ2 (a, b; ρ)/Φ1 (a) were pre-computed, e.g., as described in
[AS64, DW90], and stored in a 2563 texture map with a, b ∈
[−5.08, 5.08] and ρ ∈ [0, 1]. This texture map is used at runtime as a lookup table, resulting in an approximation error
below floating point precision.
On our target architecture, a 2.83 GHz Core 2 Quad processor equipped with a NVIDIA Quadro FX5800, the IFCP
algorithm roughly doubles the visualization time per frame
compared to isosurface ray-casting. For instance, the visualization of the isosurface in the GEO dataset (3.3 million
tetrahedral elements) shown in Figure 6 (a) requires 85 milliseconds (ms), while the IFCP algorithm takes about 150
ms. 80 MBytes are required to store the mean values, the
standard deviations, and the correlation tensors, plus additional 65 MBytes consumed by the pre-computed 3D lookup table. The loss of performance in the IFCP algorithm is
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

Pfaffelmoser et al. / Positional and Geometrical Isosurface Uncertainty Visualization

959

Figure 6: (a) A separating isosurface in a seismic tomography dataset is shown. (b) The IFCP algorithm in combination with
distance dependent color mapping (homogeneous correlation of ρi = 1) reveals a possible topological link in (1). (c) SDF
surfaces ϑ(±2) emphasis the isosurface uncertainty with respect to shape. (d) An anisotropic correlation decrease is assumed.
Compared to (b), higher crossing probabilities are determined in (2), but correlation based saturation reveals high stochastic
independence rather than high local positional isosurface variability as major cause.

mainly due to the enlarged memory footprint for computing
and interpolating SDF values and gradients on the fly, and
for accessing the pre-computed distribution functions.
9. Conclusion
We have presented a novel approach for computing reliable probabilities of position and occurrence for isosurface
crossings in uncertain 3D scalar fields. We have achieved
this by incorporating distance dependent correlations into
our approach. An efficient update-scheme allows integrating the proposed algorithm into front-to-back ray-casting. A
new measure for estimating the distance between possible
isosurface variations and the mean surface has been developed. This measure is used as input for a color mapping
scheme, which allows for an effective visualization of isosurface variability independent of the viewing direction. We
have demonstrated that our approach results in an intuitive
understanding of the effect of uncertainty on isosurfaces in
3D scalar fields.
c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.

In the future, we will pursue further research to provide
deeper insights into 3D correlation structures and to investigate the sensitivity of the probability to these structures. We
will also analyze the approximation error that is inherent to
the proposed computation of the spatial distance measure,
and we will investigate the effect of this error on the visualization. Finally, we will consider the integration of sample
based probability distributions, like in Monte Carlo simulations, and multimodal density models into our approach.

Acknowledgments
We would like to thank the European Centre for MediumRange Weather Forecasts for providing the ATMOS dataset,
and Paul Käufl from the Geophysics Group at LMU
München for providing the GEO dataset. The work was
funded by the Munich Centre for Advanced Computing and
the International Graduate School of Science and Engineering (IGSSE) at the Technische Universität München.

960

Pfaffelmoser et al. / Positional and Geometrical Isosurface Uncertainty Visualization

References
[AS64] A BRAMOWITZ M., S TEGUN I.: Handbook of mathematical functions with formulas, graphs, and mathematical tables.
Dover publications, 1964. 8
[BAF08] B OSTROM A., A NSELIN L., FARRIS J.: Visualizing
Seismic Risk and Uncertainty. Annals of the New York Academy
of Sciences 1128, 1 (2008), 29–40. 2

[OGHT10] OTTO M., G ERMER T., H EGE H., T HEISEL H.: Uncertain 2d vector field topology. In Computer Graphics Forum
(2010), vol. 29, Wiley Online Library, pp. 347–356. 2
[PH10] P ÖTHKOW K., H EGE H.-C.: Positional uncertainty
of isocontours: Condition analysis and probabilistic measures.
IEEE Transactions on Visualization and Computer Graphics 99,
PrePrints (2010). 1, 2, 3, 7

[Bro04] B ROWN R.: Animated visual vibrations as an uncertainty
visualisation technique. In GRAPHITE (2004), ACM, pp. 84–89.
2

[PWL97] PANG A., W ITTENBRINK C., L ODHA S.: Approaches
to uncertainty visualization. The Visual Computer 13, 8 (1997),
370–390. 2

[DKLP02] D JURCILOV S., K IM K., L ERMUSIAUX P., PANG A.:
Visualizing scalar volumetric data with uncertainty. Computers
& Graphics 26, 2 (2002), 239–248. 2

[RLBS03] R HODES P., L ARAMEE R., B ERGERON R., S PARR
T.: Uncertainty visualization methods in isosurface rendering.
In Eurographics (2003), Citeseer, pp. 83–88. 2

[DMJRM00] D E M AESSCHALCK R., J OUAN -R IMBAUD D.,
M ASSART D.: The mahalanobis distance. Chemometrics and
Intelligent Laboratory Systems 50, 1 (2000), 1–18. 3

[RN88] RODGERS J., N ICEWANDER W.: Thirteen ways to look
at the correlation coefficient. American Statistician 42, 1 (1988),
59–66. 3

[DW90] D REZNER Z., W ESOLOWSKY G.: On the computation
of the bivariate normal integral. Journal of Statistical Computation and Simulation 35, 1 (1990), 101–107. 8

[SZD∗ 10] S ANYAL J., Z HANG S., DYER J., M ERCER A., A M BURN P., M OORHEAD R.: Noodles: A Tool for Visualization of
Numerical Weather Model Ensemble Uncertainty. IEEE Transactions on Visualization and Computer Graphics (2010). 2

[Eur] E UROPEAN C ENTRE FOR M EDIUM -R ANGE W EATHER
F ORECASTS: Demeter temperature ensemble. Available online
at http://www.ecmwf.int. 7
[GR04] G RIGORYAN G., R HEINGANS P.: Point-based probabilistic surfaces to show surface uncertainty. Visualization and
Computer Graphics, IEEE Transactions on 10, 5 (2004), 564–
573. 2

[Tar05] TARANTOLA A.: Inverse problem theory and methods for
model parameter estimation. Society for Industrial Mathematics,
2005. 3
[THM∗ 05]

T HOMSON J., H ETZLER E., M AC E ACHREN A., G A M., PAVEL M.: A typology for visualizing uncertainty.
In Proc. SPIE (2005), vol. 5669, Citeseer, pp. 146–157. 2
HEGAN

[GS06] G RIETHE H., S CHUMANN H.: The visualization of uncertain data: Methods and problems. In Proceedings of SimVis
2006 (2006), pp. 143–156. 2

[Wei05] W EILER M.: Hardware-beschleunigte Volumenvisualisierung auf adaptiven Datenstrukturen. PhD thesis, Universitätsbibliothek der Universität Stuttgart, 2005. 8

[Joh04] J OHNSON C.: Top scientific visualization research problems. Computer graphics and applications, IEEE 24, 4 (2004),
13–17. 1

[WPL02] W ITTENBRINK C., PANG A., L ODHA S.: Glyphs for
visualizing uncertainty in vector fields. Visualization and Computer Graphics, IEEE Transactions on 2, 3 (2002), 266–279. 2

[JS03] J OHNSON C., S ANDERSON A.: A next step: Visualizing
errors and uncertainty. Computer Graphics and Applications,
IEEE 23, 5 (2003), 6–10. 2

[ZWK10] Z EHNER B., WATANABE N., KOLDITZ O.: Visualization of gridded scalar data with uncertainty in geosciences.
Computers & Geosciences (2010). 2, 3, 6

[Käu10] K ÄUFL P.: Object-based Probabilistic Full Waveform
Tomography. Master’s thesis, Geophysics, LMU München, 2010.
7
[KVUS∗ 05] K NISS J., VAN U ITERT R., S TEPHENS A., L I G.,
TASDIZEN T., H ANSEN C.: Statistically quantitative volume visualization. 2
[KWTM03] K INDLMANN G., W HITAKER R., TASDIZEN T.,
M OLLER T.: Curvature-based transfer functions for direct volume rendering: Methods and applications. In Visualization, 2003.
VIS 2003. IEEE (2003), IEEE, pp. 513–520. 2
[LFLH07] L I H., F U C., L I Y., H ANSON A.: Visualizing largescale uncertainty in astrophysical data. Visualization and Computer Graphics, IEEE Transactions on 13, 6 (2007), 1640–1647.
2
[LLPY07] L UNDSTROM C., L JUNG P., P ERSSON A., Y NNER MAN A.: Uncertainty visualization in medical volume rendering using probabilistic animation. Visualization and Computer
Graphics, IEEE Transactions on 13, 6 (2007), 1648–1655. 2
[Mah36] M AHALANOBIS P.: On the generalized distance in
statistics. In Proceedings of the National Institute of Science,
Calcutta (1936), vol. 12, p. 49. 3
[MRH∗ 05] M AC E ACHREN A., ROBINSON A., H OPPER S.,
G ARDNER S., M URRAY R., G AHEGAN M., H ETZLER E.: Visualizing Geospatial Information Uncertainty: What We Know and
What We Need to Know. Cartography and Geographic Information Science 32, 3 (2005), 139–161. 2

c 2011 The Author(s)
Journal compilation c 2011 The Eurographics Association and Blackwell Publishing Ltd.


Volume 27 (2008), Number 2

EUROGRAPHICS 2008 / G. Drettakis and R. Scopigno
(Guest Editors)

Visualizing Underwater Ocean Optics
Diego Gutierrez, Francisco J. Seron, Adolfo Munoz and Oscar Anson
University of Zaragoza, Spain

Abstract
Simulating the in-water ocean light field is a daunting task. Ocean waters are one of the richest participating media, where light interacts not only with water molecules, but with suspended particles and organic matter as well.
The concentration of each constituent greatly affects these interactions, resulting in very different hues. Inelastic
scattering events such as fluorescence or Raman scattering imply energy transfers that are usually neglected in the
simulations. Our contributions in this paper are a bio-optical model of ocean waters suitable for computer graphics simulations, along with an improved method to obtain an accurate solution of the in-water light field based
on radiative transfer theory. The method provides a link between the inherent optical properties that define the
medium and its apparent optical properties, which describe how it looks. The bio-optical model of the ocean uses
published data from oceanography studies. For inelastic scattering we compute all frequency changes at higher
and lower energy values, based on the spectral quantum efficiency function of the medium. The results shown
prove the usability of the system as a predictive rendering algorithm. Areas of application for this research span
from underwater imagery to remote sensing; the resolution method is general enough to be usable in any type of
participating medium simulation.
Categories and Subject Descriptors (according to ACM CCS): I.3.7 [Computer Graphics]: Three-Dimensional
Graphics and Realism

1. Introduction
Ocean water is arguably the richest participating medium in
terms of optical thickness and the number and type of interactions that occur in it. This paper deals with the physicallybased rendering of underwater scenes by simulating the inwater light field, based on a compact bio-optical model that
takes into account the dissolved and particulate matter, optically influential constituents of the water. To ensure accuracy, we use published data obtained from a wide range of
literature in the field of oceanography. Our model is not restricted to just the visible spectrum and can be adapted to
any type of known ocean water in particular, or to any kind
of participating medium in general.
Scattering in water is caused by interactions of light at
molecular level and with particles [Mob94]. It can be classified in two broad categories: elastic or inelastic scattering, depending on whether the scattered photon maintains
or changes its energy in the process. The inelastic scattering
events can be further subclassified according to the nature of
the energy transfer: Stokes scattering, when a molecule of the
medium absorbs the photon and re-emits it with a lower enc 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

ergy, and anti-Stokes scattering, when the re-emitted photon
has a higher energy. Both cases are covered by our model.
The process implies an energy transfer from wavelength λ′
to λ, with λ′ being the excitation wavelength and λ the reemitted wavelength. The former case implies a shift towards
longer wavelengths, whereas in the latter the scattered photon has a shorter wavelength. Major forms of elastic events
in water include Einstein-Smoluchowski scattering (see Section 3.2), whereas for inelastic events, Raman scattering and
fluorescence are the two most prominent (see Section 3.3).
The presence and concentrations of the constituents in the
water determine its optical properties. These optical properties are divided in two classes: inherent and apparent. The
inherent optical properties (IOP) only depend on the constituents of the water, whereas the apparent optical properties (AOP) are not properties of the aquatic medium itself, although they do depend on its characteristics. Typical IOP are the absorption coefficient, the scattering coefficient or the scattering phase function. Some of the AOP
include irradiance reflectance, attenuation coefficients or the
average cosines [Pre76]. To obtain the in-water light field,

548

Diego Gutierrez et al. / Visualizing Underwater Ocean Optics

we rely on the physically based theory of radiative transfer [Cha60], which relates the IOP and AOP. More precisely,
the link is provided through the Radiative Transfer Equation
(RTE) [SCP94], which takes into account emission, absorption and elastic scattering. Unfortunately this equation can
not account for the phenomenon known as inelastic scattering described previously, which is of significant importance in ocean waters. We consequently expand the RTE
by adding an extra term, thus obtaining the Full Radiative
Transfer Equation (FRTE) [Gla95] and solving it by using
an extended version of the method presented by Gutierrez et
al. [GMAS05]:
∂L(λ, ωo )
= α(λ) Le (λ, ωo ) − κ(λ) L(λ, ωo )
∂x

+ σ(λ)
+

Ω W

Ω

p(λ, ωi , ωo ) L(λ, ωi ) dωi

σ(λ′ , λ) p(λ′ , λ, ωi , ωo ) L(λ′ , ωi ) dλ′ dωi

(1)

where L is the radiance and ωi and ωo are, respectively, the
incoming and outgoing directions of that radiance. α, σ and
κ are the absorption, scattering and extinction coefficients
respectively. We assume Le (λ, ωo ) to be zero, thus making
the medium non-emissive. Note that the last term models the
inelastic scattering events and is expressed as a double integral over the domains of the solid angle Ω and wavelength
W . Here p(λ′ , λ, ωi , ωo ) is the phase function for inelastic
events and σ(λ′ , λ) is the inelastic scattering function for
the energy exchange between λ′ and λ. For simplicity, when
considering elastic interactions (λ = λ′ ) parameters λ, λ′ are
simplified to a single parameter λ. For processes such as fluorescence, where the photons are inelastic scattered to longer
wavelengths, the function σ(λ′ , λ) is usually expressed as:
σ(λ′ , λ) = α(λ′ ) f (λ′ , λ)

(2)

where α(λ′ ) is the inelastic absorption coefficient and
f (λ′ , λ) is the wavelength redistribution function, which
governs the efficiency of the energy transfer between wavelengths. It is defined as the probability of a photon of λ′ that
inelastically scatters being re-emitted at λ. Therefore, (2) expresses the inelastic scattering as a percentage of the inelastic absorption coefficient. Section 3.3 gives more details on
how to model this redistribution function f (λ′ , λ).
Our research on water simulation encompasses the fields
of both computer graphics and oceanography, and it is free
from the restrictions of previous works. The main contributions of this paper are:
• A compact, parameterized bio-optical model of ocean waters which can be used in computer graphics applications.
• A resolution method based on the theory of radiative
transfer, which solves the FRTE by handling all kinds of
inelastic scattering events and modeling both absorption
and elastic scattering accurately. This method is based on
photon mapping [Jen01].

• A link between the IOP of water and the resulting light
field, which in turn defines its AOP, based on radiative
transfer theory.
The remainder of this paper is organized as follows: Section 2 presents previous work on the simulation of light
transport in water bodies. In Section 3 a comprehensive biooptical model is developed, whilst section 4 presents our
simulation method. The paper ends with the results and conclusions.
2. Related work
The simulation of light transport in participating media
usually either relies on Monte-Carlo techniques for ray
tracing (Rushmeier and Torrance [RT87]; Nakamae et al.
[NKON90]; Tadamura and Nakamae [TN95]) or attempts to
solve the RTE, such as the method proposed by Kaneda et
al. [KYNN91]. Nishita et al. [NSTN93] display water from
outer space modifying this method, but both works only take
into account single scattering. In the work of Premoze and
Ashikhmin [PA01], no radiance due to scattering is calculated at all, using empirical equations based on experimental
data instead. Mobley [Mob94] developed a method to solve
the RTE analytically, but it cannot be extended to take into
account inelastic scattering. Recently, the Lorenz-Mie theory has been generalized and applied to rendering natural
waters by Frisvad, Christensen and Jensen [FCJ07], also neglecting the effects of inelastic scattering. Cerezo and Seron
[CS04] also develop a bio-optical model. Whilst the goal of
their work is closely related to ours, we overcome here significant shortcomings:
• They use a discrete ordinate method, which requires an
angular and spatial discretization of the volume to be rendered. This imposes high memory requirements which seriously limit the complexity of the scenes that can be reproduced.
• In their work, inelastic scattering simulations are limited
to fixed re-emissions in the 680 nm. wavelength..
• They cannot provide a full solution to the light transport
problem.
Gutierrez et al. [GMAS05] present a method that deals
with participating media in which the index of refraction is
not homogeneous, while also taking into account the simulation of some inelastic scattering events. They apply their
method to the simulation of underwater imagery using a simplified, four-parameter model of ocean waters. In this regard,
our paper offers improvement in the following ways:
• Our bio-optical model of ocean waters is more complete,
thus making the simulations more accurate.
• They also fail to develop a complete description for the
complex inelastic scattering events that occur underwater,
and the method is limited to re-emissions at lower energy
levels and at fixed wavelengths. In this paper all inelastic
scattering events can be modeled, including Anti Stokes
scattering events like Raman scattering (see Section 3.3).
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

Diego Gutierrez et al. / Visualizing Underwater Ocean Optics

• We additionally offer simulations using real data from different seas as a means of visual validation.
3. The Bio-Optical Model
The various constituents of ocean water have a great influence in its optical properties. In order to solve the forward
problem in ocean optics, the IOP have to be modeled and
used in the FRTE. The values of these IOP can be obtained as
the sum of the contributions of pure water and the dissolved
particles and particulate matter present in the water, as proposed in [Mob94]. Optically pure water is devoid of any dissolved or suspended matter, and thus there is no scattering
or absorption owed to particles or organic material [Mor74].
For saline pure water the salt concentration (35 to 39 parts
per thousand) does influence the scattering and absorption
functions. In particular it absorbs most wavelengths except
for blue, with the absorption coefficient peaking at 760 nm,
and reaching a minimum at 430 nm.
We develop our bio-optical model from three main IOP,
with others like the extinction coefficient or the albedo derived from those three. These IOP are the absorption coefficient (3), the scattering coefficient (4) and the phase function
(5), which for the elastic case can be written as (see Table 4
for a more detailed description of the functions used, including both the elastic and inelastic cases):
α(λ) = αw (λ) + ∑ αi (λ)

(3)

σ(λ) = σw (λ) + ∑ σi (λ)

(4)

i

i

p(λ, θ) =

σ (λ)
σw (λ)
pi (λ, θ)
pw (λ, θ) + ∑ i
σ(λ)
i σ(λ)

(5)

where θ is the angle between the incoming ωi and outgoing
ωo directions, the subscript w stands for the contribution of
the pure water (fresh or salty) and the subscript i stands for
the constituents in the water body such as biological particles
or dissolved substances. We include three types of such constituents in our model, namely CDOM (Colored Dissolved
Organic Matter, also know as yellow matter, present mainly
in shallow ocean waters and harbors), phytoplankton (microscopic plants rich in chlorophyll) and minerals and organic
detritus. The rest of this section will characterize the three
main IOP (with elastic and inelastic scattering treated separately) for pure water and the three constituents. The next
section will show how radiative transfer theory is applied to
simulate the light field (which define the AOP) and render
the final images.
3.1. Modeling Absorption
For the spectral absorption function of pure water αw (λ)
we rely on the work of Smith and Baker [SB81], whose
tabulated values are well known in oceanography studies
(shown in Table 1). Following further studies by Pope and
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

549

Fry [PF97], we use those values as an upper bound, to account for the fact that the true absorption can be, in fact,
lower. The function shows that absorption is more prominent
both in the UV and red ends of the spectrum. [PF97] also
shows that absorption by salt in oceanic water is negligible.
Based on the data by Bricaud, Morel and Prieur [BMP81],
we model absorption by CDOM by fitting an exponential
curve of the form:
αy (λ) = αy (λ0 ) e−Sy (λ−λ0 )

(6)

where the subscript y denotes the constituent CDOM. λ0 is a
reference wavelength, often chosen to be 440 nm for yellow
matter, and Sy is the slope of the semilogarithmic absorption curve [Kir94]. Sy is usually taken to be constant, with
a value of 0.014 nm−1 , but has been found to vary both geographically and temporally, and is also dependent on the
wavelength range over which it is calculated [BMP81]. The
values of absorption αy (λ0 ) at reference wavelengths also
vary in a range between 0.01 m−1 to 20 m−1 , as a function
of turbidity [Kir94].
Phytoplankton absorbs a great amount of visible light,
due to its chlorophyll pigment. The absorption function for
chlorophyll peaks strongly at 430 nm and 670 nm, being
very weak in the mid range of the visible spectrum (thus the
more phytoplankton the greener the hue of the water). The
concentration of the chlorophyll in the water usually ranges
from 0.01 mg/m3 for open waters to 100 mg/m3 . The spectral absorption coefficient of the phytoplankton is usually expressed as a function of this concentration C as:
α p (λ) = C α∗p (λ)

(7)

where C can be defined as the concentration of the main
pigment chlorophyll-a (Chla ) or as the sum of the concentrations of Chla and its degradation products, the pheopigments. α∗p is the specific spectral absorption coefficient (the
absorption per unit of concentration) for a particular species
of phytoplankton, given in m2 /mg. Typical values for specific absorptions of different species of phytoplankton can
be found in the work of Sathyendranath, Lazzara and Prieur
[SLP87] (see Table 1). A rough correspondence between
chlorophyll concentrations and several oceanic water types
is given by Morel [Mor88]. The absorption owed to organic
detritus and minerals can be approximated by an exponential
function, according to Roesler, Perry and Carder [RPC89]:
αd (λ) = αd (λ0 ) e−Sd (λ−λ0 )

(8)

Here the reference wavelength 400 nm is selected for λ0 and
typical values for the exponent coefficient Sd will be in the
range between 0.006 nm−1 to 0.014 nm−1 , although 0.011
nm−1 is the most common value [RPC89]. Further studies
confirm that the absorption spectra of minerals and detritus
is well described by an exponential function with an average
slope Sd of 0.0123 nm−1 , with slightly lower values than
predicted at wavelengths below 440 nm [BSF∗ 03].

550

Diego Gutierrez et al. / Visualizing Underwater Ocean Optics

Table 1: Absorption coefficient for a clear water body αw (after Smith and Baker [SB81]) and specific absorption coefficient
for phytoplankton α∗p (after Sathyendranath, Lazzara and Prieur [SLP87]).
λ
αw
α∗p

[nm]
[cm−1 ]
[m2 · mg−1 ]

380
0.00022
0.025

440
0.000145
0.035

500
0.000257
0.02

3.2. Modeling Elastic Scattering
For the pure water term we use the volume scattering function defined by the Einstein-Smoluchowski theory [Maz02],
which models scattering at molecular level as small-scale
fluctuations. Whilst usually Rayleigh’s scattering is used instead, Einstein-Smoluchowski provides more accurate results, is well defined and imposes no overheads in the simulations. Its scattering coefficient and phase function are given
by:
4.32
λ0
(9)
σw (λ) = 16.06 βw (λ0 , 90◦ )
λ

pw (θ) = 0.06225 1 + 0.835 cos2 θ

(10)

Typical values for βw (λ0 , 90◦ ) for both fresh and saline
pure water are given in [Mor74]. These values range from
14.1 · 10−4 m−1 to 134.5 · 10−4 m−1 . All the scattering produced by CDOM has inelastic nature and thus will be described in next section.
Gordon and Morel [GM83] found that phytoplankton,
even in small concentrations, also contribute to the total elastic scattering in the water. Its contribution is given by:
σ p (λ) =

550
0.30C0.62
λ

(11)

where the constant 0.30 is selected to fit the data collected
from many types of waters. The actual upper bound for this
constant has a value of 0.45 [GM83]. The phase function
due to phytoplankton is given by an isotropic function (p p =
1/π).
The elastic scattering caused by organic detritus and minerals can be modeled based on Mie theory [GSO03]. The
Henyey-Greenstein phase function models forward scattering fairly well but fails to reproduce backscattering with the
same precision. We found that we can achieve a better fit
by using a Two-Terms Henyey-Greenstein phase function
(TTHG) [HG41]:
pd (θ, ζ, g f , gb ) = ζ pHG (θ, g f ) + (1 − ζ) pHG (θ, gb )

(12)

where ζ is a weighting function between zero and one. This
common way of utilizing this combination defines a forward
scattering lobe (first term), plus a backscattering lobe (second term), with g f ∈ [0..1] and gb ∈ [−1..0]. pHG represents
a simple Henyey-Greenstein phase function (HG):
pHG (θ, g) =

1 − g2
(1 + g2 − 2g cos θ)3/2

(13)

550
0.000638
0.01

610
0.00289
0.007

670
0.0043
0.015

720
0.01169
0.001

780
0.0236
0.0001

The TTHG function not only models backscattering more
precisely, but it can describe more complex particle scattering models, improving the fit at large and small angles as
well. The shape of each of the two HG functions can be approximated by an ellipsoid, avoiding the relatively expensive
exponent in its evaluation. The observation was first introduced by Schlick [BLSS93]. Due to the great variety of particulate matter, the scattering coefficient σd can adopt a wide
range of values. Table 2 shows typical values of this function
(data after Stramski et al. [SBM01]).
3.3. Modeling Inelastic Scattering
For inelastic scattering, we need to model the possibility of
an absorbed photon being re-emitted at a different wavelength. (2) includes a term f (λ′ , λ) known as wavelength
redistribution function, which represents the efficiency of
the energy transfer between wavelengths. It is defined as
the quotient between the energy of the emitted wavelength
and the energy of the absorbed excitation wavelength, per
wavelength unit. Reformulating in terms of photons instead
of energy we have the spectral quantum efficiency function
η(λ′ , λ), defined as the ratio between the number of photons
emitted at λ per wavelength unit, and the number of absorbed
photons at λ′ . Both functions are dimensional (nm−1 ), and
are related as follows:
f (λ′ , λ) = η(λ′ , λ)

λ′
λ

(14)

The wavelength redistribution function f , and therefore
its associated spectral quantum efficiency function η, can be
seen as a re-radiation matrix. A related dimensionless function that describes inelastic scattering is the quantum yield
Γ(λ′ ), defined as the total number of photons emitted at all
wavelengths divided by the number of photons absorbed at
excitation wavelength λ′ . It is related to the spectral quantum
efficiency function by:
Γ(λ′ ) =

η(λ′ , λ) dλ

(15)

W

The three functions Γ(λ′ ), f (λ′ , λ) and η(λ′ , λ), depend
on both the medium and the type of inelastic event. The two
inelastic events with more influence in the in-water light field
are fluorescence and Raman scattering. Phytoplankton and
CDOM are important fluorescence sources, whilst Raman
scattering is produced by pure water; minerals and detritus,
on the other hand, do not produce any inelastic event.
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

551

Diego Gutierrez et al. / Visualizing Underwater Ocean Optics

Table 2: Scattering coefficient for detritus σdt and minerals σm (After Stramski et al. [SBM01]).
detritus
minerals
total

λ
σdt
σm
σd

[nm]
[m−1 ]
[m−1 ]
[m−1 ]

380
0.045
0.0675
0.1125

440
0.0375
0.0525
0.09

3.3.1. Fluorescence

It is very common in ocean waters to see a color shift ranging from greenish to very bright green, or even yellowish.
These hue shifts are mainly due to the variation in the concentration and type of the suspended microorganisms, specially phytoplankton and its related chlorophyll concentration, which presents an absorption function peaking at 350
nm and rapidly decaying to almost zero beyond 500 nm.
Only wavelengths between 370 and 690 nm can trigger fluorescence due to phytoplankton. This can be modeled as a
dimensionless function g p (λ′ ) so that:
1
0

if 370 ≤ λ′ ≤ 690 nm
otherwise

(16)

The wavelength-independent quantum yield for phytoplankton Γ p (λ′ ) ranges from 0.01 to 0.1. Using (14) and
(16), the relationship between the wavelength redistribution
function f p (λ′ , λ) and the spectral quantum efficiency function η p (λ′ , λ) is:
f p (λ′ , λ) = η p (λ′ , λ)

λ′
λ′
≡ Γ p g p (λ′ ) h p (λ)
λ
λ

(17)

where h p (λ) is the fluorescence emission function per
unit wavelength, and can be approximated by a gaussian
[Mob94]:
h p (λ) = √

550
0.03
0.045
0.075

610
0.0285
0.04
0.0685

670
0.0275
0.036
0.0635

720
0.027
0.034
0.061

780
0.027
0.032
0.059

Table 3: Water constituents and interactions

Fluorescence occurs when a molecule absorbs a photon of
wavelength λ′ , and re-emits it at a longer wavelength λ according to the fluorescence efficiency function ηF (λ′ , λ). For
the two main sources of fluorescence (phytoplankton and
CDOM), re-emission follows an isotropic phase function.
For phytoplankton, the wavelength of the re-emitted photons is independent of the excitation wavelength, although
the intensity does show wavelength dependency [Mob94].

g p (λ′ ) ≡

500
0.0325
0.05
0.0825

(λ − λ0 )2
1
exp −
2π λσ
2 (λσ )2

(18)

λ0 = 685 nm is the wavelength of maximum emission and
λσ = 10.6 nm represents the standard deviation. Using (7)
and (17) we can now compute the inelastic scattering coefficient owed to phytoplankton σ p (λ′ , λ) following (2).
The other important source of fluorescence in water is
CDOM. For relatively high concentrations of CDOM, its
quantum yield Γy (λ′ ) varies between 0.005 and 0.025. Following the work of Hawes [Haw92] we use the following
formula to describe its spectral fluorescence quantum efficiency function:
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

Constituent
Pure water (w)
Minerals, detritus (d)
Phytoplankton (p)
CDOM (y)

Absorption
Yes
Yes
Yes
Yes

Elastic Scat.
Yes
Yes
Yes
No

Inelastic Scat.
Raman Scattering
No
Fluorescence
Fluorescence

 
2 
1
 λ′

− Aλ′1 − B1
λ

fy (λ , λ) = A0 (λ ) exp − 
A
 λ

0.6 ′2 + B2
′

′

(19)

λ

where A0 , A1 , A2 , B1 and B2 are empirical parameters whose
values depend on the specific composition of the CDOM and
can be found in [Mob94] (see Table 5). A1 and A2 are dimensionless, whereas the rest are given in nm−1 . Like fluorescence due to phytoplankton, we can use (6) and (19) to
compute the inelastic scattering coefficient σy (λ′ , λ) following (2).
Our model can be easily extended to account for phosphorescence phenomena, which are intrinsically similar to
fluorescence and are governed by the phosphorescence efficiency function. The only difference is that the re-emitted
energy declines with time according to a function d(t).
3.3.2. Raman scattering
Raman scattering influences the in-water light field, specially at great depths where sun irradiance becomes zero and
only Raman radiance remains. It occurs when vibration and
rotation in water molecules exchange energy with incoming photons, re-emitting them with approximately the same
wavelength, but allowing for small shifts towards longer or
shorter wavelengths. It can also be considered a spontaneous
process. To isolate Raman inelastic events from fluorescence
and other scattering events, it is usually studied in pure water, filtered several times, so that the second term in (4) becomes zero.
The Raman wavelength redistribution function fw (λ′ , λ)
is usually described in terms of a sum of four Gaussian functions [Mob94]:

fw (λ′ , λ) =

107

λ′ 2

∑4j=1 Ai ∆˜1νi exp −
π
4 ln 2

107

1
λ′

− λ1 −˜νi

2

∆˜νi 2

∑4j=1 A j

(20)

where ν˜ is the wavenumber (ν˜ = 107 /λ) given in cm−1 . Typical parameter values Ai , ν˜ i and ∆ν˜ i for the Raman redistribution function are given by Walrafen [Wal69] and are

552

Diego Gutierrez et al. / Visualizing Underwater Ocean Optics

shown in Table 5. The inelastic scattering coefficient can
now be obtained using αw and fw in (2).

specifically, those included in tables 1 and 2). The first three
correspond to the parameters analyzed in Figure 2.

4. The simulation method

Once we have formalized the model into a set of equations, we rely on radiative transfer theory to obtain a solution for the in-water light field. We solve the Full Radiative Transfer Equation (1) by extending the traditional photon mapping algorithm [Jen01] by taking into account all ten
different events specified in Table 3, while allowing for both
Stokes or anti-Stokes inelastic scattering. This enhancement
is done in both stages: photon tracing and radiance estimation.

Having so far developed our bio-optical model, we can now
formalize it into a set of parameters and equations to fully
simulate the in-water light field. To summarize, the four constituents of the model and their interactions with light are
given in Table 3. Table 4 shows how the main functions that
define the model are derived from IOP and related functions
at constituent level.
Table 4: The main functions of the model
Equations
α(λ)
σ(λ)

= αd (λ)+α p (λ) + αw (λ) + αy (λ)
= σw (λ) + σd (λ) + σ p (λ)

p(λ, θ)
κ(λ)
αI (λ′ )

p
d
d
= w w
σ(λ)
= α(λ) + σ(λ)
= α p (λ′ ) + αw (λ′ ) + αy (λ′ )

pI (λ′ , λ, θ)

=

fI (λ′ , λ)

=

σ (λ)p (λ,θ)+σ (λ)p (λ,θ)+σ (λ)p p (λ,θ)

α p (λ′ )p p (λ′ ,λ,θ)+αw (λ′ )pw (λ′ ,λ,θ)+αy (λ′ )py (λ′ ,λ,θ)
αI (λ′ )
α p (λ′ ) f p (λ′ ,λ)+αw (λ′ ) fw (λ′ ,λ)+αy (λ′ ) fy (λ′ ,λ)
αI (λ′ )

Table 5: Parameters of the model
Parameter
C
αd (400)
αy (440)
Sy
Sd
A0
A1
A2
B0
B1
Γp
Γy
Ai , i = 1..4
νi , i = 1..4
∆νi , i = 1..4

Equations
(7) (11)
(8)
(6)
(6)
(8)
(19)
(19)
(19)
(19)
(19)
(17)
(19)
(20)
(20)
(20)

Simulated values
[0..1.0]
[0..0.1]
[0..0.1]
0.014
0.011
150
700

4
4

1
450·10−7
1
650·10−7

0.1
0.025
0.41, 0.39, 0.10, 0.10
3250, 3425, 3530, 3625
210, 175, 140, 140

Units
mg
m3
m−1

m−1
nm−1
nm−1
nm−1
nm−1
nm−1
-

The model allows for easy adjusting of its parameters
to simulate different types of water and thus obtain different in-water light fields. As well as minerals and detritus,
other particulate components of water can be added from
oceanographic studies (although minerals and detritus have
the greatest influence in the final appearance of water). Mie
theory can again be used to model the scattering by these
new particles, and the phase function can be approximated
by using a Two Terms Henyey-Greenstein phase function
(12). An overview of the most significant parameters of the
model, the equations in which they can be found and the corresponding values used for the simulations in this paper can
be found in Table 5. Note that for simplicity we have not included the values that are already specified throughout the
text during the explanation of the bio-optical model (more

During the photon tracing stage in the original photon
mapping method [Jen01], a Russian roulette algorithm is
triggered at each interaction with the medium, deciding
whether the photon is scattered or absorbed. In [GMAS05]
the authors add a second Russian roulette which separates
absorption from inelastic scattering; in the latter case, a new
photon is generated at a different wavelength, but the algorithm considers just a single type of inelastic event with
Stokes behavior. No anti-Stokes events are simulated. In
contrast, our method uses just a single Russian roulette to
choose between ten different kinds of interactions (including three types of inelastic events where the photons may
gain or lose energy), and can be easily extended to handle
an arbitrary number of different interactions. Finally, we improve the radiance estimation stage over previous methods
by adding a term to take into account the contributions from
the inelastic scattering events. The next subsections present
the algorithm in more detail.
4.1. Stage 1: Photon tracing
We shoot photons from the light sources and let them interact
with the geometry and the medium according to its optical
distance, which is a function of the extinction coefficient (as
in the original photon mapping method). We statistically decide at each interaction which type of event occurs (refer to
Table 3) with just a single Russian roulette. At the interactions, photons are stored in a kd-tree as in traditional photon
mapping.
The wavelength spectrum is box sampled into Nλ samples,
so absorption (α(λ)) and scattering coefficients (σ(λ)) are
implemented as Nλ -dimensional arrays while wavelength redistribution functions ( f (λ′ , λ)) are implemented as Nλ × Nλ
square matrices. Each of the photons carries information
about a portion of flux (∆Φ) at a certain sampled wavelength
(λ′ ). Importance sampling is used for computing the optical
distance, so ∆Φ does not change along the photon tracing
stage, while λ′ changes for inelastic scattering events.
In order to apply the Russian roulette algorithm, we will
define an albedo Λ j (λ) for each interaction j as follows:
• If interaction j represents an elastic scattering event, then
σ j (λ)
Λ j (λ) = κ(λ)
• If j represents an absorption interaction that does not
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

553

Diego Gutierrez et al. / Visualizing Underwater Ocean Optics

show inelastic scattering (detritus and minerals, basiα j (λ)
cally), then Λ j (λ) = κ(λ)
• For each absorption interaction that could generate inelastic scattering (pure water, phytoplankton and CDOM) we
define its inelastic probability (χ j ), the probability that an
absorption event generates an inelastic scattering event:

χ j (λ′ ) =

λb
λa

fI (λ′ , λ)dλ ≈

Nλ

∑ fI (λ′ , λi )

wavelengths suffers a second inelastic scattering event that
brings it back to the visible light range. Given the low probability of this chain of events and our computer graphics approach, we assume that a photon beyond the visible spectrum
is definitely absorbed. Figure 1 shows a global overview of
the algorithm during the photon tracing stage.

(21)

Photon

i=1

where λa and λb are the lower and upper limits of the
simulated wavelengths, and i ∈ [1..Nλ ] refer to samples in
wavelength domain:

Russian
Roulette

– If interaction j represents the effective inelastic scattering event within the absorption interaction: Λ j (λ) =

Absorption

α j (λ)
χ (λ)
κ(λ) j

Elastic
scattering

Inelastic
scattering

Wavelength sampling

– If interaction j represents the pure absorption event
(no inelastic scattering happening at all): Λ j (λ) =
α j (λ)
(1 − χ j (λ))
κ(λ)

Thus, at each interaction a random number ξ between 0
and 1 is generated resulting in (between parenthesis, example values of Λ j at λ = 500nm that determine the size of the
corresponding interval are included):
• ξε[0, ξ1 ) → absorption by pure water (2.51 · 10 ).
• ξε[ξ1 , ξ2 ) → Raman scattering, inelastic scattering by
pure water (1.21 · 10−9 ).
• ξε[ξ2 , ξ3 ) → absorption by minerals and detritus (7.12 ·
10−2 ).
• ξε[ξ3 , ξ4 ) → absorption by phytoplankton (4.90 · 10−3 ).
• ξε[ξ4 , ξ5 ) → inelastic scattering by phytoplankton (2.18 ·
10−3 ).
• ξε[ξ5 , ξ6 ) → absorption by CDOM (7.83 · 10−2 ).
• ξε[ξ6 , ξ7 ) → inelastic scattering by CDOM (1.21 · 10−2 ).
• ξε[ξ7 , ξ8 ) → elastic scattering by pure water (7.44 · 10−3 )
• ξε[ξ8 , ξ9 ) → elastic scattering by minerals and detritus
(2.94 · 10−1 ).
• ξε[ξ9 , 1] → elastic scattering by phytoplankton (2.79 ·
10−1 ).
−1

where ξi (λ) is given by ξi (λ) = ∑ij=1 Λ j (λ)
To compute the new re-emitted wavelength after a inelastic scattering event i, the normalized wavelength redistribuf (λ′ ,λ)
tion function χi (λ′ ) is treated as a probability distribution
i

function (PDF) given the excitation wavelength λ′ . To sample it efficiently we first build its normalized cumulative distribution function (CDF) and then inverse importance sample this CDF. Greater values of the PDF for a given wavelength will translate to steeper areas of the CDF, thus increasing the probability of a re-emission at such wavelength.
Note that the definition of fi (λ′ , λ) is not limited to the visible spectrum, which might result in re-emissions happening at wavelengths beyond the visible spectrum. However,
as χi (λ′ ) is limited to the simulated (visible) spectrum, only
inelastic interactions within this spectrum are considered. It
could happen that a photon inelastically scattered at such
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

Figure 1: Photon tracing algorithm. Inelastic scattering
events generate a photon with a different associated wavelength according to the wavelength redistribution function.
4.2. Stage 2: radiance estimate
To estimate radiance we adopt a tradeoff between speed and
memory requirements similar to the proposed by Jensen and
Christensen [JC98]: we only store photons in the photon map
if they have been reflected or transmitted from surfaces, or if
they have already been scattered at least once. Thus, we can
compute single scattering more efficiently by ray marching
through the medium and sampling the light sources by casting shadow rays. Taking into account the wavelength redistribution function for inelastic scattering, a new addend will
be added at each step of the ray marching process:
N Nλ

∑∑

Ll λ′i , wl pI λ′i , λ, wl , wo αI λ′i fI λ′i , λ ∆x

(22)

l=1 i=1

where i ∈ [1..Nλ ] and l ∈ [1..N] refer to samples in the wavelength and light source domain respectively, wl is the direction to the light with an incoming radiance Ll and ∆x represent the ray marching steps.
Multiple scattering will be computed from the photon
map, finding in the kd-tree the n photons which are closest
to the estimation point by using the typical nearest neighbours algorithm. To account for multiple inelastic scattering
we modify the radiance estimate expression of [JC98] by including a new term:
n

∑
k=1

pI λ′k , λ, wk , wo fI λ′k , λ

∆Φk
π r2

4
3

(23)

where r is the radius of the sphere that contains the n closest
photons, and k represents each of the stored photons.
5. Results
We have used the values from Table 5 for our simulations.
In the images produced we only vary the chlorophyll concentration C, minerals and detritus turbidity αd (400) and

554

Diego Gutierrez et al. / Visualizing Underwater Ocean Optics

(a) C = 0, αd = 0, αy = 0

(b) C = 0.01, αd = 0, αy = 0

(c) C = 0.1, αd = 0, αy = 0

(d) C = 1, αd = 0, αy = 0

(e) C = 0, αd = 0.1, αy = 0

(f) C = 0.01, αd = 0.1, αy = 0

(g) C = 0.1, αd = 0.1, αy = 0

(h) C = 1, αd = 0.1, αy = 0

(i) C = 0, αd = 0, αy = 0.1

(j) C = 0.01, αd = 0, αy = 0.1

(k) C = 0.1, αd = 0, αy = 0.1

(l) C = 1, αd = 0, αy = 0.1

Figure 2: Resulting pictures varying the chlorophyll concentration C, the minerals and detritus turbidity αd at 400nm and the
CDOM turbidity αy at 440nm.
CDOM turbidity αy (440). The choice of those three parameters to reduce the dimensionality of the model was based
on their greater overall influence on the resulting light field.
The photon map contains 400000 photons, with 250 used in
the estimation of radiance. Ray-marching depth is set at 200
steps. Each of the images has been rendered in a Dual Xeon
Pentium 4 at 2.8GHz with 2GB RAM at 512 × 384 resolution, casting one ray per pixel, and took approximately 20
minutes to render. This time is roughly independent of the
number of parameters of the bio-optical model. In order to
reduce these computation times, several optimization techniques could be adopted, like using adaptive ray-marching
or radiance caching strategies [JDZJ08]. Additionally, perceptual issues could be taken into account, using just an approximate solution in areas of the image where the error is
known to be perceptually negligible [SGA∗ 07].
Energy balances show that on average almost 99% of the
energy emitted by the light sources is absorbed after just a
few interactions of the photons, with very incremental variation after the fourth interaction and negligible contribution after the fifth. This relatively fast convergence is due
to the strong absorption in water. We have therefore limited the number of interactions per photon to five, in order
to speed up the simulations. Variations of the parameters
C, αd (400) and αy (440) yield different probabilities for absorption, elastic and inelastic scattering events, which in turn

affect the in-water light field. The results can be seen in Figure 2, with each of the varying parameters influencing the
final light field as follows:
• Chlorophyll concentration (C) affects mainly both elastic
and inelastic scattering. The effects of inelastic scattering
are mostly masked by the more predominant elastic scattering and absorption, which increases slowly. The third
column in Figure 2 shows brighter images than the previous two due to in-scattering. For higher values (fourth
column), out-scattering prevails and the images become
darker.
• Minerals and detritus turbidity (αd (400)) increases absorption at lower wavelengths, thus reducing the brightness of the scene and the overall blue hue. Scattering is
also increased, making the images appear murkier. Figure
2 shows variations of the minerals and detritus turbidity
between the first and second rows for direct comparison.
• CDOM turbidity (αy (440)) slightly increases absorption (darker images) and introduces inelastic scattering
(change in hue). This can be seen by comparing the first
and third rows in Figure 2.
We have undergone a visual validation of our model by
rendering different natural waters. Figure 3 shows the resulting underwater images for Atlantic, Mediterranean, Baltic,
North Sea and shallow coastal waters rich in CDOM respectively. All the images have been simulated at the same depth
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

Diego Gutierrez et al. / Visualizing Underwater Ocean Optics

Figure 3: Rendered images of different waters. From left to
right: Atlantic, Mediterranean, Baltic, North Sea and shallow coastal waters rich in CDOM. Smaller patches below for
comparison purposes by Frisvad et al. [FCJ07] (used with
permission).
and are illuminated by the same isotropic point light source.
The changes in color are clearly noticeable, from a darker
blue in the case of Atlantic water, to the greener hue in the
image of the North Sea. The smaller patches below the first
four images correspond to the simulations by Frisvad et al.
[FCJ07] for the same types of water, and are shown for comparison purposes. Our simulations based on radiative transfer approximately match their simulations based on LorenzMie theory. The differences are mainly owed to two factors:
on the one hand, the overall darker tone in our images is due
to in-water absorption, whereas [FCJ07] renders the surface
of the water body; on the other hand, the absence of inelastic scattering effects in [FCJ07] can have a visible influence
the final appearance of water, as shown in Figure 4 for the
Baltic case. The properties of the water have been adjusted
according to measurements found in [BSF∗ 03] [Mob94] for
our bio-optical model and [BSF∗ 03] in the model by Frisvad
et al. In both cases, it is only the changes in the constituents
of the waters which yield the different colors. We have additionally performed a numerical analysis of the in-water radiance field, to quantify the influence of each constituent. The
results can be seen in Figure 5.

555

is usually less than 2% (see Figure 5), this relatively small
percentage does have a clear influence on the apparent optical properties, as Figure 4 shows. We thus argue that
these events, usually overlooked in computer graphics literature, are qualitatively important for underwater imagery and
should be included in a complete simulation. Other types
of inelastic scattering such as Compton, Bragg or Brillouin
could also be added, although their influence is more incremental. Other particulate elements could be easily added as
well just by including their corresponding absorption and
scattering coefficients in the model; however, the three constituents treated here (phytoplankton, minerals and detritus
and CDOM) have the most influence in the final radiance
field.
The results show how the model developed can easily
be used for physically-based simulations of underwater imagery. We believe this work can be of interest not only in
the computer graphics community, but in remote sense or
oceanographic studies as well.

Figure 4: The influence of inelastic scattering in the apparent optical properties of water (Baltic sea): Left, no inelastic
scattering. Center, just chlorophyll inelastic scattering (as
in [GMAS05]). Right, all inelastic scattering events included
in the simulation.

6. Conclusion
We have presented a complete bio-optical model of ocean
water based on parameterizing its intrinsic optical properties. Relying on radiative transfer theory, we obtain the resulting in-water light field by extending the rendering algorithm presented in [GMAS05]. The extension can now handle more complex interactions between light and water, including inelastic scattering with anti-Stokes behavior, where
the scattered photon absorbs energy from the medium and is
re-emitted at higher energies. We have additionally studied
the influence of the parameters in the apparent optical properties of water in the scene, which are defined by the light
field obtained. We have performed an energy-balance analysis, and visual validation of the method has been provided
by direct comparison with images by Frisvad et al. [FCJ07],
rendering different types of waters based on published constituent data.
We have included Raman scattering by pure water and
fluorescence by phytoplankton and CDOM as inelastic scattering events with energy transfers. Even though their combined quantitative contribution to the overall radiance field
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

Figure 5: Radiance distribution of the resulting in-water
light field per type of event (Baltic Sea).
Acknowledgments
We thank the anonymous reviewers for their valuable comments. This research was partly done under the sponsorship
of the Spanish Ministry of Education and Research through
the projects TIN2004-07672-C03-03 and TIN2007-63025.
References
[BLSS93] B LASI P., L E S AEC B., S CHLICK C.: A rendering algorithm for discrete volume density objects. Computer Graphics
Forum (Eurographics 93) 12, 3 (1993), 201–210. 4

556

Diego Gutierrez et al. / Visualizing Underwater Ocean Optics

[BMP81] B RICAUD A., M OREL A., P RIEUR L.: Absorption by
dissolved organic matter of the sea (yellow substance) in the uv
and visible domains. Limnol. Oceanogr. 26, 1 (1981), 43–53. 3
[BSF∗ 03] BABIN M., S TRAMSKI D., F ERRARI G. M., C LAUS TRE H., B RICAUD A., O BOLENSKY G., H OEPFFNER N.: Variations in the light absorption coefficients of phytoplankton, nonalgal particles, and dissolved organic matter in coastal waters
around europe. J. Geophys. Res. 108(C7), 3211 (2003). 3, 9

don Street, Oxford, 2002, ch. Einstein-Smoluchowski Theory,
pp. 46–62. 4
[Mob94] M OBLEY C. D.: Light and Water: Radiative Transfer in
Natural Waters. Academic Press, Inc., San Diego, 1994. 1, 2, 3,
5, 9
[Mor74] M OREL A.: Optical Aspects of Oceanography. Academic Press, New York, 1974. 3, 4

[Cha60] C HANDRASEKHAR S.: Radiative Transfer. Dover Publications, Inc., 1960. 2

[Mor88] M OREL A.: Optical modeling of the upper ocean in relation to its biogenous matter content (case i waters). Journal of
Geophysical Research 93, C9 (1988), 10749–10768. 3

[CS04] C EREZO E., S ERON F. J.: Rendering natural waters taking fluorescence into account: Research articles. Comput. Animat. Virtual Worlds 15, 5 (2004), 471–484. 2

[NKON90] NAKAMAE E., K ANEDA K., O KAMOTO T.,
N ISHITA T.: A lighting model aiming at drive simulators.
Computer Graphics 24, 4 (Aug. 1990), 395–404. 2

[FCJ07] F RISVAD J. R., C HRISTENSEN N. J., J ENSEN H. W.:
Computing the scattering properties of participating media using
Lorenz-Mie theory. ACM Trans. Graph. 26, 3 (2007), 60. 2, 9

[NSTN93] N ISHITA T., S HIRAI T., TADAMURA K., NAKAMAE
E.: Display of the earth taking into account atmosphere scattering. In Computer Graphics (SIGGRAPH ’93 Proceedings)
(1993), vol. 24, pp. 175–182. 2

[Gla95] G LASSNER A. S.: Principles of Digital Image Synthesis. Morgan Kaufmann Publishers Inc., San Francisco, CA, USA,
1995. 2
[GM83] G ORDON H. R., M OREL A.: Remote Assessment of
Ocean Color for Interpretation of Satellite Visible Imagery: A
Review, vol. 4 of Lecture Notes on Coastal and Estuarine Studies. Springer-Verlag, New York, 1983. 4
[GMAS05] G UTIERREZ D., M UNOZ A., A NSON O., S ERÓN
F. J.: Non-linear volume photon mapping. In Proc. of the Eurographics Symposium on Rendering Techniques, Konstanz, Germany, June 29 - July 1, 2005 (2005), pp. 291–300. 2, 6, 9
[GSO03] G REEN R. E., S OSIK H. M., O LSON R. J.: Contributions of phytoplankton and other particles to inherent optical properties in new england continental shelf waters. Limnol.
Oceanogr. 48, 6 (2003), 2377–2391. 4
[Haw92] H AWES S.: Quantum fluorescence efficiencies of marine
fulvic and humid acids. PhD thesis, Dept. of Marince Science,
Univ. of South Florida, 1992. 5
[HG41] H ENYEY L., G REENSTEIN J.: Diffuse radiation in the
galaxy. Astrophysics Journal 93 (1941), 70–83. 4
[JC98] J ENSEN H. W., C HRISTENSEN P. H.: Efficient simulation
of light transport in scenes with participating media using photon maps. In SIGGRAPH 98 Conference Proceedings (jul 1998),
Cohen M., (Ed.), Annual Conference Series, ACM SIGGRAPH,
Addison Wesley, pp. 311–320. 7
[JDZJ08] JAROSZ W., D ONNER C., Z WICKER M., J ENSEN
H. W.: Radiance caching for participating media. To appear
in ACM Transactions on Graphics (2008). 8
[Jen01] J ENSEN H. W.: Realistic image synthesis using photon
mapping. A.K. Peters, Natick, Massachussets, 2001. 2, 6

[PA01] P REMOZE S., A SHIKHMIN M.: Rendering natural waters.
Comput. Graph. Forum 20, 4 (2001), 189–199. 2
[PF97] P OPE R. M., F RY E. S.: Absorption spectrum (380–700
nm) of pure water. ii. integrating cavity measurements. Applied
Optics 36, 33 (1997), 8710–8723. 3
[Pre76] P REISENDORFER R. W.: Introduction, vol. 1 of Hydrologic Optics. National Technical Information Service, Springfield, IL, 1976. 1
[RPC89] ROESLER C. S., P ERRY M. J., C ARDER K. L.: Modeling in situ phytoplankton absorption from total absorption spectra in productive inland marine waters. Limnol. Oceanogr. 34, 8
(1989), 1510–1523. 3
[RT87] RUSHMEIER H. E., T ORRANCE K. E.: The zonal method
for calculating light intensities in the presence of a participating
medium. Computer Graphics 21, 4 (July 1987), 293–302. 2
[SB81] S MITH R. C., BAKER K. S.: Optical properties of the
clearest natural waters (200–800 nm). Appl. Opt. 20 (1981), 177–
184. 3, 4
[SBM01] S TRAMSKI D., B RICAUD A., M OREL A.: Modeling
the inherent optical properties of the ocean based on the detailed
composition of planktonic community. Applied Optics 40 (2001),
2929–2945. 4, 5
[SCP94] S PINRAD R. W., C ARDER K. L., P ERRY M. J. (Eds.):
Ocean Optics. No. 25 in Oxford Monographs on Geology and
Geophysics. Oxford University Press, 1994. 2
[SGA∗ 07] S UNDSTEDT V., G UTIERREZ D., A NSON O., BAN TERLE F., C HALMERS A.: Perceptual rendering of participating
media. ACM Transactions of Applied Perception 4, 3 (2007). 8

[Kir94] K IRK J. T.: Light and photosynthesis in aquatic ecosystems. Cambridge University Press, New York, 1994. 3

[SLP87] S ATHYENDRANATH S., L AZZARA L., P RIEUR L.:
Variations in the spectral values of specific absorption of phytoplankton. Limnol. Oceanogr. 32, 2 (1987), 403–415. 3, 4

[KYNN91] K ANEDA K., Y UAN G., NAKAMAE E., N ISHITA T.:
Realistic visual simulation of water surfaces taking into account
radiative transfer. In Proc. of CAD/Graphics 91 (1991), pp. 25–
30. 2

[TN95] TADAMURA K., NAKAMAE E.: Computer Graphics:
Developments in Virtual Environments. Academic Press, 1995,
ch. Modeling the colour of Water in Lightning Design, pp. 97–
114. 2

[Maz02] M AZO R. M.: Brownian Motion: Fluctuations, Dynamics and Applications, vol. 112 of International Series of Monographs on Physics. Oxford University Press Inc., Great Claren-

[Wal69] WALRAFEN G. E.: Continuum model of water–an erroneous interpretation. Journal of Chemical Physics 50, 1 (January
1969), 567–569. 5

c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.


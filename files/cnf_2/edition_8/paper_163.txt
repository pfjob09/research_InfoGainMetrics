Eurographics Symposium on Geometry Processing 2008
Pierre Alliez and Szymon Rusinkiewicz
(Guest Editors)

Volume 27 (2008), Number 5

Maximum Entropy Coordinates for Arbitrary Polytopes
K. Hormann1 and N. Sukumar2
1 Department
2 Department

of Informatics, Clausthal University of Technology, Germany
of Civil & Environmental Engineering, University of California, Davis, USA

Abstract
Barycentric coordinates can be used to express any point inside a triangle as a unique convex combination of the
triangle’s vertices, and they provide a convenient way to linearly interpolate data that is given at the vertices of
a triangle. In recent years, the ideas of barycentric coordinates and barycentric interpolation have been extended
to arbitrary polygons in the plane and general polytopes in higher dimensions, which in turn has led to novel
solutions in applications like mesh parameterization, image warping, and mesh deformation. In this paper we
introduce a new generalization of barycentric coordinates that stems from the maximum entropy principle. The
coordinates are guaranteed to be positive inside any planar polygon, can be evaluated efficiently by solving a
convex optimization problem with Newton’s method, and experimental evidence indicates that they are smooth
inside the domain. Moreover, the construction of these coordinates can be extended to arbitrary polyhedra and
higher-dimensional polytopes.
Categories and Subject Descriptors (according to ACM CCS): G.1.1 [Numerical Analysis]: Interpolation formulas
G.1.6 [Numerical Analysis]: Constrained optimization I.3.5 [Computer Graphics]: Geometric algorithms

1. Introduction
Barycentric coordinates were first introduced by Möbius as
a special kind of homogeneous coordinates with respect
to the vertices of a simplex [Möb27]. While unique for
simplices, they can be generalized in several ways to arbitrary polygons [Wac75, Flo03, MLD05, FHK06], polyhedra [FKR05, JSW05, LBS06], higher dimensional polytopes
[War96, JLW07], and even curves [Bel06, SJW07, DF08].
Let Ω ⊂ Rd be an arbitrary polytope (e.g., a polygon in R2
or a polyhedron in R3 ), with vertices v1 , . . ., vn . The functions bi : Ω → R, i = 1, . . ., n are called barycentric coordinates with respect to Ω if they form a partition of unity,
n

∑ bi (v) = 1,

(1)

i=1

allow to write any point v ∈ Ω as an affine combination of
the vertices,
n

∑ bi (v)vi = v,

(2)

f (v) =

n

∑ bi (v) fi

and satisfy the Lagrange property
(3)

c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

(4)

i=1

interpolates the data fi at the vertices vi for i = 1, . . ., n,
and properties (1) and (2) further guarantee the reproduction of affine functions by barycentric interpolation. Obviously, the interpolant f inherits the smoothness from the
functions bi and if the bi can be evaluated efficiently, then
so can f . Barycentric interpolation has many useful applications, ranging from Gouraud and Phong shading, rendering
of quadrilaterals [HT04], image warping [HF06, WSHD07],
and mesh deformation [JSW05, LKCOL07, JMD∗ 07, LS08]
to generalized Bézier surfaces [LD89, LS07] and finite element applications [AO06, SM06, WBG07, MP07, TS08].
Many of these applications require or at least benefit from
the barycentric coordinates being non-negative,
bi (v) ≥ 0,

i=1

bi (v j ) = δi j .

Due to the property in (3), barycentric coordinates can be
used as basis functions for barycentric interpolation: indeed,
it is clear that the function

(5)

so that (2) and (4) become convex combinations and so f (v)
is guaranteed to lie inside the convex hull of the data fi .

K. Hormann & N. Sukumar / Maximum Entropy Coordinates for Arbitrary Polytopes

1514
MVC

PMVC

HC

MEC-1

MEC-2

Figure 1: Barycentric coordinates for the green (top row) and the red vertex (bottom row) of an L-shaped polygon. Note that
the MVC for the green vertex is negative inside the grey region of the polygon and that the PMVC for that vertex is constant
zero there. Moreover, PMVC are only C0 along the dashed lines and C1 along the dotted lines.

1.1. Related Work
If Ω is a simplex (e.g., a triangle in R or a tetrahedron
in R3 ), then the barycentric coordinates are uniquely determined by conditions (1) and (2), and they automatically
satisfy properties (3) and (5). For general polytopes, this
uniqueness breaks down and the non-negativity is not always
guaranteed by the several constructions that have been proposed in the past.
2

Wachspress [Wac75] was the first to come up with
a generalization of barycentric coordinates for finite element applications. These Wachspress coordinates as well as
their higher-dimensional extensions [War96, WSHD07] satisfy (5) as long as Ω is convex and can further be evaluated efficiently [MLBD02]. For planar polygons, alternative
generalizations are the discrete harmonic coordinates [PP93,
EDD∗ 95] and the metric coordinates [MLD05, SM06], but
they both can be negative even inside a convex polygon.
A major breakthrough came with the advent of mean
value coordinates (MVC) that were discovered by Floater
[Flo03] in the context of mesh parameterization and later
generalized to polyhedra [FKR05, JSW05, LBS07]. In contrast to Wachspress coordinates, they are well-defined even
if Ω is non-convex [HF06], but they can take on negative
values then (see Figure 1).
By modifying the transfinite description of mean value coordinates [JSW05, Bel06], Lipman et al. [LKCOL07] were
able to overcome this drawback, which significantly improves the results in applications like mesh deformation.
Their positive mean value coordinates (PMVC) no longer
have a simple closed form, but they can still be evaluated efficiently with the GPU. However, these coordinates are only
piecewise smooth (see Figure 1).
Up to now, the only known barycentric coordinates that
are smooth and non-negative for arbitrary polytopes are the
harmonic coordinates (HC), which have first been mentioned by Floater et al. [FHK06] and later realized by Joshi
et al. [JMD∗ 07] for animating characters. The drawback of
harmonic coordinates is that they are rather costly to evaluate because they require to compute the solution of Laplace’s
equation subject to suitable Dirichlet boundary conditions.

Another approach for constructing generalized barycentric coordinates that has been suggested independently by
Sukumar [Suk04] and Arroyo and Ortiz [AO06] is based
on Jaynes’s principle of maximum entropy [Jay57]. By construction, these coordinates are non-negative and always satisfy conditions (1) and (2), but the Lagrange property (3)
holds only if Ω is strictly convex (see Figure 2).
1.2. Contribution
In this paper we show how to adapt the maximum entropy
approach in order to get non-negative barycentric coordinates for arbitrary polygons that also satisfy the Lagrange
property and can thus be used for barycentric interpolation.
In contrast to PMVC, these new coordinates are smooth and
unlike HC, they can be evaluated directly.
After a brief introduction to informational entropic measures and the maximum entropy formalism (Section 2), we
review how to derive barycentric coordinates from prior estimates by maximizing the Shannon-Jaynes entropy with respect to linear constraints (Section 3). We then present two
choices of appropriate prior functions (Section 4) that yield
maximum entropy coordinates (MEC) with all the desired
properties for arbitrary polygons (see Figure 1) and explain
how to extend the construction to higher dimensions. We
further describe how Newton’s method can be used to efficiently evaluate these coordinates (Section 5). Finally, we
compare MEC with previous constructions (MVC, PMVC,
and HC) by studying some application examples (Section 6)
and discuss their limitations as well as interesting open questions for future research (Section 7).

2. Principle of Maximum Entropy
Shannon [Sha48] introduced the concept of entropy as a
measure of uncertainty in information theory, with an eye
on its applications in communication theory. The Shannon
entropy of a discrete probability distribution is
n

H(p) = < − ln p > = − ∑ pi ln pi ,

(6)

i=1

c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

K. Hormann & N. Sukumar / Maximum Entropy Coordinates for Arbitrary Polytopes

MVC / PMVC

HC

MEC-1

MEC-2

1515

MEC-constant

MEC-Gaussian

Figure 2: Barycentric coordinates for the rightmost vertex of this convex polygon. For convex polygons, MVC and PMVC are
the same, and the maximum entropy coordinates based on constant [Suk04] and Gaussian priors [AO06] (with β = 5 in this
example) satisfy the Lagrange property. Note that the coordinate derived from constant priors is very steep near the vertex and
would lose the Lagrange property if the polygon was weakly convex and the vertex and its neighbours were collinear.

where < · > is the expectation operator, pi = p(xi ) is the
.
probability of the occurrence of the event xi , and pi ln pi = 0
if pi = 0. Note that the above form of H satisfies the axiomatic requirements of an uncertainty measure [Khi57].
As a means for least-biased statistical inference in the
presence of testable (known) constraints, Jaynes used the
Shannon entropy to propose the principle of maximum entropy [Jay57]. While Jaynes’s initial emphasis was on applications in statistical mechanics, the principle has broader
appeal and can be applied to any ill-posed problem that requires inductive inference [Jay03]. In a nutshell, maximizing
entropy provides the least-biased statistical inference solution when insufficient information is available.
To illustrate this statement, consider a coin toss experiment and let pH and pT be the unknown probabilities of
heads and tails, respectively. Here, the only known constraint
is pH + pT = 1, which involves two unknowns but only one
equation. But if we regularize the problem by maximizing
the Shannon entropy (6) subject to this constraint, then the
unique maximum entropy solution is pH = pT = 1/2, which
is consistent with our expectations for an unbiased coin.
It was later recognized that for H to be invariant under
invertible mappings of the continuous random variable x, the
general form of the continuous entropy should be
H(p, m) = −

Z

p(x) ln

pi
H(p, m) = − ∑ pi ln
m
i
i=1

.

Historically, discrete probability measures have been seen as
weights and hence their association with the construction of
barycentric coordinates is natural. As in condition (1), discrete probability measures sum to one, and condition (2) is
the counterpart of the expectation value of the first moment
(or mean) of a discrete probability distribution being known.
Sukumar [Suk04] adopted the Shannon entropy (6) to
construct non-negative barycentric coordinates for strictly
convex polygons, whereas Arroyo and Ortiz [AO06] used
a modified entropy functional in the variational principle to
derive basis functions for meshfree methods. The modified
entropy chosen in [AO06] is a linear combination of Rajan’s
functional [Raj94] and the Shannon entropy, and the solution of the variational problem provides a smooth transition
from Delaunay interpolation as a limiting case at one end to
global maximum entropy approximation at the other end of
the spectrum.
Sukumar and Wright [SW07b] later realized that both
constructions can be described in a unifying framework that
uses the Shannon-Jaynes entropy functional with a prior (7).
The variational formulation for maximum entropy coordinates in general then is: find b = (b1 , . . ., bn ) : Ω → Rn+ as
the solution of the constrained optimization problem
n

p(x)
dx,
m(x)

max n H(b, m),

b(v)∈R+

where m is called a p-estimate or prior distribution [KL51,
Jay63, SJ80]. In this paper we use the discrete version of the
Shannon-Jaynes entropy functional:
n

3. Maximum Entropy Coordinates

(7)

In the literature, the quantity D(p m) = −H(p, m) is known
as the Kullback-Leibler (KL) distance. If the KL-distance is
adopted as the objective functional, the variational principle is known as the principle of minimum relative entropy
[SJ80]. Obviously, maximizing the Shannon-Jaynes entropy
functional H(p, m) is equivalent to minimizing the relative
entropy functional D(p m).
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

H(b, m) = − ∑ bi (v) ln
i=1

bi (v)
mi (v)

(8a)

subject to the linear precision conditions
n

∑ bi (v) = 1,

(8b)

∑ bi (v)(vi − v) = 0

(8c)

i=1
n

i=1

for any v ∈ Ω. In (8a), Rn+ is the non-negative orthant and
mi : Ω → R+ is a prior estimate for bi . Note that if Ω is
a simplex in Rd , then n = d + 1 and the linear constraints
yield a unique solution for the bi . For n > d + 1, which is the
case of interest in this paper, the linear constraints form an
under-determined system.

K. Hormann & N. Sukumar / Maximum Entropy Coordinates for Arbitrary Polytopes

1516

MVC

PMVC

HC

MEC-1

MEC-1 prior

Figure 3: Barycentric coordinates for the lower left vertex of this non-convex polygon and prior estimate of MEC-1. In this
example, all functions are between zero and one. Note that PMVC is constant zero over the region shaded in red and also attains
a local maximum just above the vertex in the centre.

In the present context, the prior functions can be seen
as weight functions associated with each vertex vi , and the
variational principle provides a correction that modifies the
weight functions mi in a minimal (i.e., least-biased) way to
form coordinates bi that satisfy the constant and linear precision conditions. For non-negative mi , the objective functional H(b, m) is strictly concave, and therefore the problem
posed in (8) admits a unique non-negative solution for bi .
Note that this construction of barycentric coordinates is also
valid for points v inside the convex hull Ωc = [v1 , . . ., vn ] of
the polytope as long as the priors are well-defined over Ωc .
It now turns out that the coordinates of Sukumar [Suk04]
are the solutions of (8) for constant priors mi (v) ≡ 1 and that
Gaussian prior functions mi (v) = exp(−β vi − v 2 ) result in
the coordinates proposed by Arroyo and Ortiz [AO06] (see
Figure 2). We further note that one obtains bi (v) = mi (v)
for i = 1, . . ., n if the priors mi a priori satisfy the linear constraints. Moreover, if we omit the linear precision
condition (8c) and use just the constant precision condition (8b) as a constraint, then the solution of (8) is
bi (v) = mi (v)/ ∑nj=1 m j (v), which we recognize as having
the same form as the Shepard function [She68].
The key ingredient in the maximum entropy formulation
is the selection of the prior functions mi , and this flexibility
presents the possibility of designing tailored barycentric coordinates. The next section describes the specific choices for
prior functions that we make to construct non-negative barycentric coordinates for arbitrary polygons and polyhedra.
4. Prior Functions
To obtain non-negative barycentric coordinates for an arbitrary polygon Ω, we first construct non-negative priors mi
that possess the desired boundary properties. We then use
these within the entropy formulation to obtain functions bi
that are non-negative, interpolate on the boundary of Ω, and
are linearly precise.
To this end, let ei be the edge of the polygon between vi
and vi+1 and consider the edge weight function
ρi (v) = v − vi + v − vi+1 − vi+1 − vi

(9)

that vanishes along ei and is positive elsewhere, by virtue
of the triangle inequality. Note that ρi is also used in the
construction of metric coordinates [MLD05, SM06]. It then
follows that the product

∏

πi (v) =

ρ j (v)

j=i−1,i

is non-negative and vanishes on all edges that are not adjacent to vertex vi . The same clearly holds for the prior functions mi that we derive from the πi through normalization,
mi (v) =

πi (v)
.
∑nj=1 π j (v)

Note that after dividing both the numerator and the denominator by the product of all ρ j , we get the equivalent form
mi (v) =

π˜ i (v)
∑nj=1 π˜ j (v)

with

π˜ i (v) =

1
, (10)
ρi−1 (v)ρi (v)

which renders it amenable to stable numerical computations.
Now solving the optimization problem (8) with these mi
as input yields functions bi with all the desired properties.
Due to the linear constraints (8b) and (8c), the bi clearly satisfy conditions (1) and (2) and as the mi are non-negative,
then so are the bi . It remains to be shown that the bi inherit the Lagrange property from the prior functions mi . If
mi (v∗ ) = 0 for some i ∈ {1, . . ., n} and v∗ ∈ Ω, then solving (8) gives bi (v∗ ) = 0 because
lim bi (v) ln

v→v∗

bi (v)
mi (v)

is zero if bi (v∗ ) = 0 and diverges otherwise. Therefore, the
functions bi have the same zero sets as their prior estimates
mi , and the only function that does not vanish at vertex vi
is bi . The Lagrange property (3) now follows because of (1)
and we similarly conclude that the bi are linear on the edges
of Ω. Hence, the functions bi are non-negative barycentric
coordinates. We call them “MEC-1” and Figure 3 shows an
example of such a function bi and its prior estimate mi .
We would like to point out that this construction of
barycentric coordinates is rather general and also works for
any other choice of edge weight functions as long as ρi is
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

K. Hormann & N. Sukumar / Maximum Entropy Coordinates for Arbitrary Polytopes

source image

MVC

PMVC

HC

MEC-1

1517

MEC-2

Figure 4: Image warping using different barycentric coordinates and backward mapping (cf. [HF06]). The bottom row shows
a close-up of the region around the concave vertex of the target polygon. Note that the result using PMVC is only C0 .

non-negative and vanishes along ei . For example, using the
alternative edge weight functions
ρi (v) = v − vi · v − vi+1 + (v − vi ) · (v − vi+1 )
in (10) gives the barycentric coordinates that we refer to as
“MEC-2” in our examples.
Moreover, the construction can be extended to higher dimensions. For example, if Ω is a polyhedron in R3 with convex planar faces, then we first define for each face fi a function ρi that vanishes on fi and is positive elsewhere. If fi has
k vertices vi1 , . . ., vik , then the analogue of the edge weight
function (9) is the face weight function
ρi (v) =

k

∑ A(vi , vi
j

j+1

, v) − A(vi1 , . . ., vik ),

j=1

where A(v1 , . . ., vm ) denotes the area of the polygon with
vertices v1 , . . ., vm . The prior function mi for any vertex vi
of Ω is then computed as in (10) with the product in the denominator of π˜ i ranging over all faces adjacent to vi .

where v˜i = vi − v. On setting the first variation of L to zero,
namely δL(b; λ0 , λ) = 0, we obtain
−1 − ln

bi (v)
mi (v)

− λ0 − λ · v˜i δbi (v) = 0

for i = 1, . . ., n, and since the variation δbi (v) is arbitrary, the
term within the bracket must be identically equal to zero:
−1 − ln

bi (v)
mi (v)

− λ0 − λ · v˜i = 0.

Therefore,
bi (v) =

mi (v) exp(−λ · v˜i )
,
Z

where the substitution ln Z = 1 + λ0 has been made (Z is
known as the partition function in statistical mechanics).
Now, on using condition (8b), we obtain [SW07b]
bi (v) =

Zi (λ)
,
Z(λ)

Zi (λ) = mi (v) exp(−λ · v˜i ),
5. Numerical Algorithm
In order to use the proposed maximum entropy coordinates
for practical applications, it is essential to be able to efficiently solve the constrained optimization problem in (8).
We resort to the method of Lagrange multipliers to first convert (8) into an unconstrained problem and then use Newton’s method to solve it.
Let λ0 ∈ R be the Lagrange multiplier for the constraint (8b) and λ ∈ Rd be the Lagrange multipliers for the d
constraints (8c). Then the Lagrangian for problem (8) is
n

L(b; λ0 , λ) = ∑ −bi (v) ln
i=1

−λ·

n

bi (v)
mi (v)

∑ bi (v)v˜i

− λ0

n

∑ bi (v) − 1

i=1

,

i=1

c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

Z(λ) =

(11)

n

∑ Z j (λ).

j=1

Note that λ, Zi (λ), and Z(λ) implicitly depend on v and that
once the Lagrange multipliers λ = (λ1 , . . ., λd ) are determined, then bi (v) can be obtained from (11). To compute λ
we note that the bi (v) in (11) must satisfy (8c), which leads
to the d non-linear equations
1 n
∑ Zi (λ)v˜i = 0
Z(λ) i=1

(12)

in the d unknowns λ1 , . . ., λd . The solution of (12) is equivalent to solving the dual unconstrained optimization problem [BV04]
λ∗ = argmin F(λ),

F(λ) = ln Z(λ),

1518

K. Hormann & N. Sukumar / Maximum Entropy Coordinates for Arbitrary Polytopes

source mesh

MVC

PMVC

HC

MEC

Figure 5: Mesh deformation using different barycentric coordinates and a control polyhedron with triangular faces. The results
for MVC, PMVC, and HC are taken from [LKCOL07].

where λ∗ is the optimal solution. Since F is strictly convex
in Ω, Newton’s method is the natural choice. The steps in
the Newton algorithm to compute the maximum entropy coordinates bi (v) of any v ∈ Ω are as follows:
1. For given v, compute and store v˜i = vi − v; also functions
to compute the prior functions mi (v) are available;
2. Start with iteration counter k = 0, the initial guess λ0 = 0,
and let ε be the convergence tolerance. The convergence
tolerance dictates to what accuracy the linear precision
conditions are satisfied. A value of ε in the range 10−3 to
10−10 is suitable;
3. Compute gk = ∇λ F(λk ) and H k = ∇λ ∇λ F(λk ), which
are the gradient and Hessian of F, respectively;
−1 k
g ;
4. Determine Newton search direction ∆λk = − H k
k+1
k
k
= λ + α∆λ , where α is the step size. For
5. Update: λ
Newton’s method (damped or guarded), a line search algorithm [BF04] is used to determine α if the error is
greater than 10−4 , otherwise α is set to unity;
6. Check convergence: if gk+1 > ε, then increment the
iteration counter k and goto 3, else continue;
7. Set λ∗ = λk+1 and compute bi (v) from Equation (11).
Due to the quadratic convergence of Newton’s method, only
3 to 7 iterations are needed to obtain an accuracy of 10−10 .
6. Results and Discussion
The advantages of MEC over previous barycentric coordinates are threefold and we present several examples to illustrate them.
Firstly, MEC are non-negative for arbitrary polytopes,
which is important as it guarantees the convex hull property
of the barycentric interpolation (4). PMVC and HC share
this property with MEC, but MVC can be negative inside
a non-convex domain (see Figure 1). In some applications,
this can lead to undesired results: for example, the interpolation of colour values can yield values outside the valid
range [HF06] and it can lead to severe artefacts in mesh deformation in some extreme cases [LKCOL07]. However, in
many situations, the influence of negative weights is not noticeable (see Figure 4).
Secondly, like MVC and HC, MEC are smooth inside
the domain, which in turn leads to well-behaved results in

m

MVC

PMVC

HC

50 K
100 K
200 K
400 K

0.07
0.15
0.32
0.59

0.33
0.67
1.42
2.61

2.44
6.75
17.3
195

MEC
ε = 10−5
ε = 10−10
4.52
5.09
8.99
10.5
18.7
24.3
34.6
39.7

Table 1: Timings (in sec.) for evaluating the barycentric interpolant at m points inside the L-shaped polygon with n = 6
vertices from Figure 1.
applications that build on barycentric interpolation. PMVC,
however, are only piecewise smooth and have discontinuous
derivatives along certain lines inside a non-convex polygon
(see Figure 1), and similarly inside non-convex polyhedra. In
particular, this happens along the lines defined by a concave
vertex and its two neighbours and can lead to visible “kinks”
if used for image warping (for example, see Figure 4).
Thirdly, MEC can be evaluated locally at any point v ∈ Ω,
though not as efficiently as MVC or PMVC, and the cost
scales reasonably with the desired accuracy. In contrast, the
evaluation of HC requires the solution of a global approximation problem, and the computational cost substantially
increases if high accuracy is desired.
For planar polygons, we implemented all methods considered in this paper in the following way. For MVC, we use the
pseudo code suggested in [HF06], and for PMVC we first determine the segments of Ω that are “visible” from some point
v ∈ Ω and then use the MVC formulas, restricted to these
segments. In order to evaluate HC, we use triangle [She02]
to triangulate Ω with m vertices and TAUCS [Tol03] to solve
the linear system arising from the piecewise linear finite element discretization of the Laplacian. The details of our MEC
implementation are described in Section 5.
The timings in Table 1 were measured on a 2 GHz Intel
Pentium M with 1 GB of RAM and confirm that the cost for
computing MVC, PMVC, and MEC at m points grows linearly with m and slightly worse for HC, because the latter
requires to solve a linear system with a sparse system matrix
of size m × m. The significantly larger constant of proportionality for HC in the last row is due to the fact that the
linear system solver required more memory than available
as RAM and thus started swapping data to the hard disk.
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

K. Hormann & N. Sukumar / Maximum Entropy Coordinates for Arbitrary Polytopes

1519

can be used as a weight function ρi . Due to the close connection between distance fields and level set functions, we
believe that it is worth investigating the possible use of level
sets for the design of prior functions in future work.

source mesh

MEC

Figure 6: Mesh deformation using a control polyhedron with
quadrilateral faces.

However, we point out that HC can be computed more
efficiently by using boundary element methods [Rus08],
which requires solving a linear system with a dense k × k
system matrix (with n < k m, where n and m are the numbers of polygon vertices and interior points, respectively).
The timings also show that it is not very costly to increase
the accuracy of MEC due to the quadratic convergence rate
of Newton’s method.
We also implemented MEC for polyhedra in R3 and Figures 5 and 6 show the results of using them for mesh deformation. It took about 100 sec. to compute the n = 51 MEC
of the m = 48485 vertices of the horse, and about 140 sec.
for the n = 218 MEC of the m = 15002 vertices of the armadillo, confirming again that the evaluation cost depends
linearly both on n and m. Note that MEC can also be used
if the control polyhedron consists of quadrilateral faces, as
shown in Figure 6. Moreover, the mesh to be deformed is
not required to be inside the control polyhedron but only inside its convex hull (see Section 3), which is the case in this
example.
7. Conclusions
Maximum entropy coordinates offer a new way of generalizing barycentric coordinates to arbitrary polytopes. By construction, MEC are non-negative and have affine precision,
and we have shown that they also satisfy the Lagrange property as long as the corresponding prior functions have the
correct zero set. Due to this flexibility, there is a lot of room
for improvement in designing “good” prior functions. For
example, it might be possible to manipulate the derivative
of the barycentric coordinates in a prescribed way by modifying the priors so as to allow for Hermite interpolation as
in [LS08].
A good prior will probably need to account for the local
geometry of the polytope, and it should also have local support. The construction in (10) seems to be a good recipe for
constructing priors and in essence, any function that measures the distance to an edge (or a face in R3 ) in some way
c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.

Although confirmed by the many numerical results that
we ran, it also remains to prove the smoothness of MEC. For
the MEC, based on Gaussian prior functions, Arroyo and
Ortiz [AO06] could prove smoothness, and it is generally
assumed that the MEC are as smooth as the prior functions.
A first step towards a proof has been taken by Sukumar and
Wets [SW07a] who established C0 -continuity of MEC for
any set of Ck prior functions, k ≥ 0.
We would finally like to mention again that MEC are only
defined inside the convex hull of the polytope Ω and not
everywhere in Rd like MVC and HC (see [Rus08]), because
the optimization problem (8) does not have a feasible nonnegative solution at points outside the convex hull.
Acknowledgements
The authors would like to thank Johannes Kopf for kindly
providing us with the MVC, PMVC, and HC data for the
example in Figure 5. This work was partially supported by
the US NSF through contract grant CMMI-0626481.
References
[AO06] A RROYO M., O RTIZ M.: Local maximum-entropy approximation schemes: a seamless bridge between finite elements
and meshfree methods. Int. J. Numer. Methods Eng. 65, 13 (Mar.
2006), 2167–2202.
[Bel06] B ELYAEV A.: On transfinite barycentric coordinates.
In Geometry Processing (2006), Eurographics Symposium Proceedings, Eurographics Association, pp. 89–99.
[BF04] B URDEN R. L., FAIRES J. D.: Numerical Analysis,
eighth ed. Brooks/Cole, Belmont, CA, 2004.
[BV04] B OYD S., VANDENBERGHE L.: Convex Optimization.
Cambridge University Press, Cambridge, UK, 2004.
[DF08] DYKEN C., F LOATER M. S.: Transfinite mean value interpolation. Comput. Aided Geom. Des. (2008). To appear.
[EDD∗ 95] E CK M., D E R OSE T., D UCHAMP T., H OPPE H.,
L OUNSBERY M., S TUETZLE W.: Multiresolution analysis of arbitrary meshes. In Proceedings of SIGGRAPH 95 (1995), ACM
Press, pp. 173–182.
[FHK06] F LOATER M. S., H ORMANN K., K ÓS G.: A general
construction of barycentric coordinates over convex polygons.
Adv. Comput. Math. 24, 1–4 (Jan. 2006), 311–331.
[FKR05] F LOATER M. S., K ÓS G., R EIMERS M.: Mean value
coordinates in 3D. Comput. Aided Geom. Des. 22, 7 (Oct. 2005),
623–631.
[Flo03] F LOATER M. S.: Mean value coordinates. Comput. Aided
Geom. Des. 20, 1 (Mar. 2003), 19–27.
[HF06] H ORMANN K., F LOATER M. S.: Mean value coordinates
for arbitrary planar polygons. ACM Trans. Graph. 25, 4 (Oct.
2006), 1424–1441.

1520

K. Hormann & N. Sukumar / Maximum Entropy Coordinates for Arbitrary Polytopes

[HT04] H ORMANN K., TARINI M.: A quadrilateral rendering
primitive. In Graphics Hardware (2004), Eurographics Symposium Proceedings, Eurographics Association, pp. 7–14.
[Jay57] JAYNES E. T.: Information theory and statistical mechanics. Phys. Rev. 106, 4 (May 1957), 620–630.
[Jay63] JAYNES E. T.: Information theory and statistical mechanics. In Statistical Physics, Ford K. W., (Ed.), vol. 3 of 1962 Brandeis Lectures in Theoretical Physics. W. A. Benjamin, New York,
1963, pp. 181–218.

[Möb27] M ÖBIUS A. F.: Der barycentrische Calcul. Johann Ambrosius Barth, Leipzig, 1827.
[MP07] M ILBRADT P., P ICK T.: Polytope finite elements. Int. J.
Numer. Methods Eng. 73, 12 (July 2007), 1811–1835.
[PP93] P INKALL U., P OLTHIER K.: Computing discrete minimal
surfaces and their conjugates. Exp. Math. 2, 1 (1993), 15–36.
[Raj94] R AJAN V. T.: Optimality by the Delaunay triangulation
in Rd . Discrete Comput. Geom. 12, 1 (Dec. 1994), 189–202.

[Jay03] JAYNES E. T.: Probability Theory: The Logic of Science.
Cambridge University Press, Cambridge, UK, 2003.

[Rus08] R USTAMOV R. M.: Boundary Element Formulation of
Harmonic Coordinates. Tech. rep., Department of Mathematics,
Purdue University, 2008.

[JLW07] J U T., L IEPA P., WARREN J.: A general geometric construction of coordinates in a convex simplicial polytope. Comput.
Aided Geom. Des. 24, 3 (Apr. 2007), 161–178.

[Sha48] S HANNON C. E.: A mathematical theory of communication. Bell Systems Technical Journal 27 (July, Oct. 1948), 379–
423, 623–656.

[JMD∗ 07] J OSHI P., M EYER M., D E R OSE T., G REEN B.,
S ANOCKI T.: Harmonic coordinates for character articulation.
ACM Trans. Graph. 26, 3 (July 2007), 71/1–71/9. Proceedings
of ACM SIGGRAPH 2007.

[She68] S HEPARD D.: A two-dimensional interpolation function
for irregularly-spaced data. In Proceedings of the 23rd ACM National Conference (1968), ACM Press, pp. 517–524.

[JSW05] J U T., S CHAEFER S., WARREN J.: Mean value coordinates for closed triangular meshes. ACM Trans. Graph. 24, 3
(July 2005), 561–566. Proceedings of ACM SIGGRAPH 2005.
[Khi57] K HINCHIN A.: Mathematical Foundations of Information Theory. Dover, New York, NY, 1957.
[KL51] K ULLBACK S., L EIBLER R. A.: On information and sufficiency. Ann. Math. Statist. 22, 1 (Mar. 1951), 79–86.
[LBS06] L ANGER T., B ELYAEV A., S EIDEL H.-P.: Spherical
barycentric coordinates. In Geometry Processing (2006), Eurographics Symposium Proceedings, Eurographics Association,
pp. 81–88.
[LBS07] L ANGER T., B ELYAEV A., S EIDEL H.-P.: Mean value
coordinates for arbitrary spherical polygons and polyhedra in R3 .
In Curve and Surface Design: Avignon 2006, Chenin P., Lyche T.,
Schumaker L. L., (Eds.), Modern Methods in Applied Mathematics. Nashboro Press, Brentwood, TN, 2007, pp. 193–202.
[LD89] L OOP C. T., D E R OSE T. D.: A multisided generalization
of Bézier surfaces. ACM Trans. Graph. 8, 3 (July 1989), 204–
234.
[LKCOL07] L IPMAN Y., K OPF J., C OHEN -O R D., L EVIN D.:
GPU-assisted positive mean value coordinates for mesh deformations. In Geometry Processing (2007), Eurographics Symposium
Proceedings, Eurographics Association, pp. 117–123.
[LS07] L ANGER T., S EIDEL H.-P.: Mean value Bézier surfaces.
In Mathematics of Surfaces XII, Martin R., Sabin M., Winkler J.,
(Eds.), vol. 4647 of Lecture Notes in Computer Science. Springer,
2007, pp. 263–274. Proceedings of the 12th IMA International
Conference.

[She02] S HEWCHUK J. R.: Delaunay refinement algorithms for
triangular mesh generation. Comput. Geom. 22, 1–3 (May 2002),
21–74.
[SJ80] S HORE J. E., J OHNSON R. W.: Axiomatic derivation of
the principle of maximum entropy and the principle of minimum
cross-entropy. IEEE Trans. Inf. Theory 26, 1 (Jan. 1980), 26–37.
[SJW07] S CHAEFER S., J U T., WARREN J.: A unified, integral
construction for coordinates over closed curves. Comput. Aided
Geom. Des. 24, 8–9 (Nov. & Dec. 2007), 481–493.
[SM06] S UKUMAR N., M ALSCH E. A.: Recent advances in the
construction of polygonal finite element interpolants. Arch. Comput. Methods Eng. 13, 1 (Mar. 2006), 129–163.
[Suk04] S UKUMAR N.: Construction of polygonal interpolants: a
maximum entropy approach. Int. J. Numer. Methods Eng. 61, 12
(Nov. 2004), 2159–2181.
[SW07a] S UKUMAR N., W ETS R. J-B: Deriving the continuity of maximum-entropy basis functions via variational analysis.
SIAM J. Optim. 18, 3 (2007), 914–925.
[SW07b] S UKUMAR N., W RIGHT R. W.: Overview and construction of meshfree basis functions: from moving least squares
to entropy approximants. Int. J. Numer. Methods Eng. 70, 2 (Apr.
2007), 181–205.
[Tol03] T OLEDO S.: TAUCS: A library of sparse linear solvers.
http://www.tau.ac.il/~stoledo/taucs/, 2003.
[TS08] TABARRAEI A., S UKUMAR N.: Extended finite element
method on polygonal and quadtree meshes. Comput. Meth. Appl.
Mech. Eng. 197, 5 (Jan. 2008), 425–438.
[Wac75] WACHSPRESS E. L.: A Rational Finite Element Basis,
vol. 114 of Mathematics in Science and Engineering. Academic
Press, 1975.

[LS08] L ANGER T., S EIDEL H.-P.: Higher order barycentric coordinates. Comput. Graph. Forum 27, 2 (Apr. 2008), 459–466.
Proceedings of Eurographics 2008.

[War96] WARREN J.: Barycentric coordinates for convex polytopes. Adv. Comput. Math. 6, 2 (1996), 97–108.

[MLBD02] M EYER M., L EE H., B ARR A., D ESBRUN M.: Generalized barycentric coordinates on irregular polygons. J. Graph.
Tools 7, 1 (2002), 13–22.

[WBG07] W ICKE M., B OTSCH M., G ROSS M.: A finite element
method on convex polyhedra. Comput. Graph. Forum 26, 3 (Sept.
2007), 355–364. Proceedings of Eurographics 2007.

[MLD05] M ALSCH E. A., L IN J. J., D ASGUPTA G.: Smooth
two dimensional interpolants: a recipe for all polygons. J. Graph.
Tools 10, 2 (2005), 27–39.

[WSHD07] WARREN J., S CHAEFER S., H IRANI A. N., D ES BRUN M.: Barycentric coordinates for convex sets. Adv. Comput.
Math. 27, 3 (Oct. 2007), 319–338.

c 2008 The Author(s)
Journal compilation c 2008 The Eurographics Association and Blackwell Publishing Ltd.


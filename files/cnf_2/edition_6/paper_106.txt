DOI: 10.1111/j.1467-8659.2009.01665.x
Eurographics/ IEEE-VGTC Symposium on Visualization 2010
G. Melançon, T. Munzner, and D. Weiskopf
(Guest Editors)

Volume 29 (2010), Number 3

Visual Support for Interactive Post-Interventional
Assessment of Radiofrequency Ablation Therapy
Christian Rieder† , Andreas Weihusen, Christian Schumann, Stephan Zidowitz and Heinz-Otto Peitgen
Fraunhofer MEVIS, Institute for Medical Image Computing, Bremen, Germany

Teaser Figure: A volume rendering with the corresponding tumor map, a pseudo-cylindrical mapping of the tumor surface.
Abstract
Percutaneous radiofrequency (RF) ablation is a minimally invasive, image-guided therapy for the treatment of
liver tumors. The assessment of the ablation area (coagulation) is performed to verify the treatment success as an
essential part of the therapy. Traditionally, pre- and post-interventional CT images are used to visually compare
the shape, size, and position of tumor and coagulation.
In this work, we present a novel visualization as well as a navigation tool, the so-called tumor map. The tumor
map is a pseudo-cylindrical mapping of the tumor surface onto a 2D image. It is used for a combined visualization
of all ablation zones of the tumor to allow a reliable therapy assessment. Additionally, the tumor map serves as
an interactive tool for intuitive navigation within the 3D volume rendering of the tumor vicinity as well as with
familiar 2D viewers.
Categories and Subject Descriptors (according to ACM CCS): I.3.6 [Computer Graphics]: Methodology and
Techniques—Interaction techniques; I.3.8 [Computer Graphics]: Applications—; J.3 [Life And Medical Sciences]: Health—

1. Introduction

resistive heating of the tissue. RF ablation therapy has become one of the most important methods in cases for which
surgical resections are contraindicated. To assess therapeutic success of such methods, pre- and post-interventional CT
images of the area around the tumor are typically evaluated.
A complete tumor destruction is assumed, if the tumor area
is completely enclosed by the coagulation (ablation area).
Generally, a minimal distance between the tumor surface and

Percutaneous radiofrequency (RF) ablation is a minimally
invasive, image-guided therapy for the treatment of primary
and secondary liver tumors. Electric energy is locally induced via electrodes; the tumor cells are destroyed by a local
† christian.rieder@mevis.fraunhofer.de
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.
Published by Blackwell Publishing, 9600 Garsington Road, Oxford OX4 2DQ, UK and
350 Main Street, Malden, MA 02148, USA.

1093

1094

Rieder et al. / Visual Support for Interactive Post-Interventional Assessment of Radiofrequency Ablation Therapy

coagulation surface is required to avoid residual tumor cells.
The ablation has failed if residual tumor tissue is detected
outside the thermal necrosis. As a standard clinical assessment procedure, pre- and post-interventional CT images are
used to visually compare the shape, size, and position of tumor and coagulation. The interpretation of the visual context and the respective treatment result depends on the examiner’s experience.
To ease this evaluation, we present the tumor map as a
fast visualization technique for a reliable therapy assessment. Based on robust segmentations of the tumor and coagulation areas and a suitable registration of pre- and postinterventional data, a traffic light color-coding scheme is
used for a fast and accurate visualization of the ablation
state. Additionally, the tumor map serves as an interactive
tool for intuitive navigation within the 3D volume rendering
of the tumor vicinity as well as with familiar 2D viewers.
Contributions of our work are:
• Utilizing a traffic light color scheme, the ablation state
can be accurately visualized in 2D slice views as an addition to the visual comparison procedure of pre- and postinterventional CT images.
• In the 3D volume rendering, the color scheme is mapped
onto the tumor’s surface, and the coagulation is visualized
in a transparent fashion to avoid occlusions. To supply the
physician with spatial hints, the surrounding anatomy, including vessels, is visualized using an automatically determined transfer function.
• We introduce the tumor map with the applied color
scheme, which allows for immediate visualization of the
complete tumor’s surface. Thus, residual tumor tissue can
be detected as fast as possible by the physician without
the need for any interaction.
• Furthermore, we use the tumor map as a novel navigation
tool to manipulate the view of the 3D volume rendering
as well as the slice in the 2D viewers.
• Finally, the tumor map is used as an interactive, bidirectional synchronization tool of the 2D viewers (selection
of current surface point) with the 3D volume rendering
(determination of view to current surface point).
The outline of this paper is as follows: in Section 2, we
discuss related work in the fields of assessment of radio frequency ablation, direct volume rendering, and map projections. Section 3 explains the pre-processing required for our
visualization methods. In Section 4, we illustrate the ablation color scheme and the corresponding visualization implemented in 2D and 3D. In Section 5, we present the tumor
map and explain the technical realization. In this section, we
also discuss different mapping layouts as well as interaction
methods. Results of our work are presented in Section 6, and
we conclude with a discussion of our methods in Section 7.

2. Related Work
The size and shape of post-interventional RFA lesions have
been examined by several research groups with different intentions. Bangard et al. [BWR∗ 09] compare a 3D volume of
a RFA coagulation in CT data with the largest 3D sphere that
fits into this volume to examine the discrepancy between the
expected and the achieved coagulation sizes. Stippel et al.
also use volumetric reconstructions of RFA coagulations to
perform a correlation between the recurrency rate and the
initial tumor diameter [SBA∗ 04]. Both papers seek better
knowledge about the achievable ablation area for intervention planning purposes.
Lazebnik et al. [LBLW04] describe a geometric 3Ddeformable lesion model for segmentation and visualization of RFA lesions in post-interventional MR data. The
methodology is oriented to a treatment assessment based on
volumetry. A comparison to pre-interventional data is not
performed. Bricault et al. [BKv∗ 04] describe a computer–
aided diagnosis tool that provides an early detection of local recurrences based on a comparison of the 3D shapes
of RFA coagulations in consecutive follow up CT scans.
The outcome of the procedure has been evaluated in a
clinical study [BKM∗ 06]. The concept of immediate postinterventional therapy assessment, based on the comparison
of the tumor- and coagulation areas, is not mentioned.
Weihusen et al. [WRK∗ 07] describe a visual comparison
of pre- and post-interventional RFA data as a part of a software application to support RFA therapy. The comparison
uses a color coding scheme within a 3D rendering. However,
no further interaction elements are described.
In [RSW∗ 09], an adapted volume rendering with automatic specification of the appropriate transfer function is
used to supply the physician with anatomical structures, such
as important risk structures, without the need for substantial interaction. We make use of this method in our volume
rendering. Other works focus on automatic view point selection for volumetric data [CQWZ06, BS05], or on the synchronization of DVR and 2D reformatted views. Kohlmann
et al. [KBGK07] present a new concept to synchronize 2D
slice views and volumetric views of medical data sets. They
utilize intuitive picking actions on the slice to provide expressive result images in the DVR. The synchronization
from DVR to 2D slice view via volume picking is presented in [KBKG09]. They extract contextual meta information from the DICOM images and analyze the ray profile for
structures which are similar to predefined ray segments of a
knowledge database.
In the context of image-based diagnosis, the spatial distribution of function and morphology is of major interest.
Due to the complexity of organs such as the brain and blood
vessels, flattening approaches have been presented to reduce the exploration space from R3 to R2 . In the field of
neuro visualialization, the folds and fissures of the brain prohibit the combined display of such complex geometry. To
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

1095

Rieder et al. / Visual Support for Interactive Post-Interventional Assessment of Radiofrequency Ablation Therapy

overcome this issue, Hurdal et al. [HKB01] present cortical maps to facilitate a view of the entire surface of the human brain. Interaction between 3D surface and map is required to understand the map distortions, to mark regions of
interest, and to be able to compare differences between individuals. Neugebauer et al. [NGB∗ 09] present an approach
for the intuitive and interactive overview visualization of
flow data that is mapped onto the surface of a 3D model
of a cerebral aneurysm. They utilize a cube-map-based approach to project the surface data of the aneurysm onto an
overview visualization. In the field of virtual colonoscopy,
Bartoli [BWK∗ 01] introduce virtual colon mapping. Hong
et al. [HGQ∗ 06] present a colon-flattening algorithm to allow rapid searching the whole colon wall for polyps. Therefore, the three-dimensional colon surface is extracted from a
CT data set. Subsequently, the surface is conformal mapped
to a two-dimensional rectangle. In the area of vascular visualization, traditional volume visualization techniques are
insufficient to provide complete morphological information.
Kanitsar et al. present in [KWFG03] a new technique to visualize the interior of a vessel in a single image based on the
automatic estimation of the vessel centerline. A linked multiview system is presented by Ropinski et al. in [RHR∗ 09] to
allow interactive exploration of PET/CT scans of mouse aortas. Therefore, a specialized multipath curved planar reformation, a multimodal vessel flattening technique and a 3D
view are integrated and linked in the visualization system.
Another system which combines projected views together
with a 3D view is presented in by Lampe et al. [LCMH09].
In cartography, many different projections exist, such as
the Mercator projection [Sny87], which preserves distances
on the parallels of latitude. Klein et al. [KHL∗ 08] use a Mollweide projection of the prostate surface to visualize the spatial distribution of segmentation errors. For evaluation, they
compute Euclidean distances between the manual and automatic segmentation boundaries and project the values onto
the Mollweide map.

multiple segmentation masks can be created, corresponding lesions are connected to unique tumor–coagulation pairs,
which are assessed consecutively.
3.2. Registration
The subsequent preprocessing step is a manual rigid registration (translation and rotation) of pre- and post-interventional
data to match the spatial positions of tumor and coagulation for the final assessment step. The rigid registration is
performed in a ROI of both lesions’ vicinities. Heizmann et
al. [HZB∗ 10] describe in their study that a rigid alignment
of the preoperative data can give satisfactory accuracy in a
ROI due to the observed isotropic deformation of the liver
parenchyma. Thus, this procedure is sufficient for our purpose. Typical tumor candidates for RFA have a maximum
diameter of less than 35 mm [Per07]. However, in case of
larger lesions special care has to be taken. Moreover, the
rigid registration allows for a simple user interaction with
six degrees of freedom and facilitates a correct quantification of the data sets.
The registration process is initialized by an automatic position matching of the centers of gravity of the lesions. Afterwards, the post-interventional image is shown in the ROI as
a colored overlay onto the pre-interventional image and can
be moved by mouse interactions to achieve a good correlation of both images. Finally, the resulting registration matrix
is applied to the coagulation mask.
4. Ablation Color Scheme
During the intervention, RF-applicators are placed in the tumor so that all cancer cells as well as a safety margin of
approximately 1 cm around the tumor can be ablated. The
purpose of this margin is to handle uncertainties and microscopic clusters of cancer cells around the visible tumor tissue. The local recurrence rates after RFA for tumors with
an intentional margin of 0 cm, 0.5 cm, and 1 cm are 14.5%,
16.4%, and 6.5%, respectively [MNF∗ 07].

3. Preprocessing
Goal of RFA: destruction of all tumor cells

The ablation assessment is based on a comparison of the preinterventional tumor area with the post-interventional coagulation area in a region of interest (ROI). Therefore, both areas must be segmented within the corresponding image data.
Due to the varying acquisition times and accordingly different coordinate systems of the pre- and post-interventional
images, a local registration is required to allow a fused visualization as well as a quantification of the segmented areas.
3.1. Lesion Segmentation
The initial preprocessing step is the segmentation of the tumor and coagulation masks. We use a semi-automatic, morphologically based region-growing algorithm [MBK∗ 09]
that has proven to be robust and of good performance. Since
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

RF applicator

affected area

tumor

safety margin

RFA Assessment: evaluation of result

tumor

ablation

safety margin

coagulation

Figure 1: The goal of radio frequency ablation: destruction
of all tumor cells. Assessment: evaluation of ablation result.
The goal of post-interventional assessment is to evaluate
the ablation result, i.e., to verify whether the aspired region
has been destructed (see Figure 1). Again, a safety margin
has to be taken into account. However, in this case, we use an
inverse margin with respect to the coagulation instead of the
margin of the tumor, as discussed in the following sections.

1096

Rieder et al. / Visual Support for Interactive Post-Interventional Assessment of Radiofrequency Ablation Therapy

4.1. Color Scheme of Coagulation Zones
For the assessment of the ablation result, we determine three
coagulation zones in the spatial extent of the tumor (see Figure 2) and use a traffic light color scheme to emphasize the
ablation state:
1. The zone of complete cell destruction is marked with
green. This zone is the optimal ablation result inside the intentional safety margin.
2. The zone of cell destruction outside of the safety margin is marked with yellow. This zone is critical because the
safety margin is not large enough, leading to potential cancer
recurrence.
3. The zone of tumor cells which could not be ablated is the
worst case and marked with red, an established signal color
in medical applications. In this zone, the ablation strategy
has failed and a re-ablation of the tumor is probably unavoidable.

(a)

(b)

Figure 3: Visualization of the ablation zones in 2D, (a)
with the pre-interventinal image and (b) the registered postinterventional image.

green. To emphasize the boundaries of the three zones, silhouettes are also drawn (see Figure 3).
4.3. Visualization in 3D

not ablated tumor tissue
tissue outside of margin
tissue inside of margin

coagulation

tumor

safety margin

Figure 2: The color scheme of the coagulation zones. Red:
not ablated tumor tissue, yellow: tissue outside of margin,
green: tissue inside of margin.

4.2. Visualization in 2D
In the 2D viewers, we visualize the tumor segmentation
mask and the coagulation together with the original CTimage data. The coagulation is displayed as a blue silhouette,
the tumor mask is displayed using the color scheme.
To achieve that, we apply the color scheme to a twodimensional rendering of the tumor segmentation mask. The
respective zones are computed by means of an inverse Euclidean distance transform of the coagulation segmentation
mask. The result of the distance transform is a volumetric
image for which the Euclidean distance to the coagulation
surface is saved as an intensity value for each voxel inside of
the coagulation mask. This distance volume is also loaded
into the volume rendering. Subsequently, the shader applies
the color red to every voxel of the tumor mask located outside of the distance volume, i.e., the value zero in the distance volume. The green and yellow zones are calculated using the safety margin threshold defined by the physician. If
the distance value of a current tumor voxel is below the distance threshold, the color yellow is applied above the color

in addition to the two-dimensional rendering, we use a
three-dimensional volume rendering to supply the physician
with a spatial representation of the ablation result, including
anatomical structures such as vessels and bones. The rendered volume is a region of interest (ROI) around the selected tumor with a fixed margin of 5 cm. The tumor is visualized in an opaque fashion, whereas the coagulation is
visualized in a transparent fashion. To allow high-quality
visualizations, we use shaded volume rendering with preintegrated [EKE01] transfer functions for both objects. Furthermore, the distance volume is loaded into the volume renderer to map the color scheme at the tumor’s surface. The
color scheme is calculated in the shader in the same way as in
the 2D rendering shader. Local anatomical structures, such
as liver vessels, pulmonary structures, and bones, are emphasized using an automatically determined appropriate transfer
function utilizing the fuzzy c-means algorithm [RSW∗ 09].
To preserve an occlusion of the tumor by anatomical structures, we added a distance-based clipping plane [WEE03],
which is smoothed to avoid hard clipping edges (see Figure 4).
5. Tumor Map
To reduce the high amount of interaction needed to observe
the complete surface of the tumor, the 3D surface of the tumor is represented in a 2D map. This can be done using a
spherical parameterization of the surface [SM04] and subsequently flattening into a 2D map. However, the drawback of
this method is the high computational effort for solving the
required linear systems.
Because liver tumors selected for RFA have generally a
spherical shape on a macroscopic level, we assume the set
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

1097

Rieder et al. / Visual Support for Interactive Post-Interventional Assessment of Radiofrequency Ablation Therapy

The longitude–latitude mapping is a cylindrical mapping
that considers longitude and latitude as a simple rectangular coordinate system:
x = λ − λ0

(1)

y=φ

(2)

where φ is the latitude, λ is the longitude, and λ0 is the central meridian (see Figure 5). This projection is neither conformal nor equal-area and distances along latitudes are distorted which is increasing toward the poles.
180°

90°

270°

0° LONG

90°

180°

90°

270°

Figure 4: The volume rendering of the ROI. Anatomical
structures such as vessels and spinal cord are clearly visible but do not occlude the tumor with color scheme and
coagulation.

180°

90°

cylindrical
mapping
0° LAT

0° LAT, 0° LONG

-90°

-90°

Figure 5: The used longitude–latitude cylindrical mapping.
of all surface points of the tumor are a star-convex set and
chose a simple but fast flattening technique. Thus, we introduce a cylindrical mapping that transforms the surface points
of the tumor into a two-dimensional texture, the tumor map.
This map allows the physician to recognize the complete
color-coded surface of the tumor in a single view without the
need for any interaction. Consequently, critical areas such as
zones of residual tumor cells, can be recognized immediately. In the case of non-convex tumors, an representation of
all surface points in the map is not possible.
5.1. Map Projection of the Tumor Surface
A map projection is a method of representing the surface of
a shape on a plane. Projections can be classified according
to properties of the model they preserve, e.g.:
• Conformal map projections preserve angles locally
• Equal-area map projections preserve area
• Equidistant map projections preserve distance from some
standard point or line
We use a two-step approach for the generation of suitable
visualizations. First, we render a rectangular map by means
of cylindrical mapping (see section 5.2). Since this mapping
is neither conformal nor equalareal but equidistant only with
respect to the latitude, we apply a second (optional) step.
The rectangular map is deformed to representations that are
commonly known from cartography that fulfill several of the
above criteria (see section 5.3).
5.2. Cylindrical Mapping of the Tumor Surface
For the generation of the initial map, we use a longitude–
latitude mapping, which is an (equi-)rectangular projection.
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

Technically, the cylindrical map is created in following
steps:
1. Rendering arbitrary number of horizontal tiles of the tumor surface
2. Compositing of tiles into 2D texture
3. Vertical deskewing
4. Application of color scheme
1. The first step is to render an arbitrary number of horizontal tiles of the tumor surface. To do so, we set up a volume
rendering with the tumor mask and the distance volume including the Euclidean distance transform from coagulation
surface to center of gravity. The view point is set to the tumor center and 60 horizontal tiles are rendered using a perspective camera (with a horizontal field of view of 6 degree
and a vertical field of view of 179 degree), which is rotated
stepwise by 6 degrees per tile (see Figure 6). In the volume
rendering, rays are cast until they hit the tumor’s surface.
The current value of the distance transformation dcoagulation
as well as the current distance from center to surface voxel
dcenter are stored in the target image.
2. In the second step, the rendered tiles are composed into a
2D texture of size 512x256, which has to be mirrored in the
horizontal direction due to the rendering from inside to outside. Thus, every pixel in the texture map represents an area
of the tumor surface with saved distance to the coagulation
as well as distance to the tumor’s center of gravity.
3. The resulting rectangular map contains vertical distortions (see Figure 7), which are a result of the perspective
rendering of the tiles. To compensate for the distortion, we

1098

Rieder et al. / Visual Support for Interactive Post-Interventional Assessment of Radiofrequency Ablation Therapy

map projection for which the length of each parallel is proportional to the cosine of the latitude:

dcoagulation

dcenter

field of view

distance field
of coagulation

center of gravity

Figure 6: Illustration of the rendering of the rectangular
map. The values dcoagulation and dcenter are stored in the
map.

x = (λ − λ0 ) cos φ

(4)

y=φ

(5)

Interestingly, the shape of this map is similar to projections
of the earth used in geographic atlases. Another map projection of the earth used quite often in atlases is the Mollweide
projection. It is also a pseudo-cylindrical, equal-area map
projection:
√
2 2
x=
λ cos θ
(6)
π
√
y = 2 sin θ
(7)
where θ is defined by:
2θ + sin 2θ = π sin φ

apply a vertical deskew on the map:
yout = 0.5 +

tan((y[0..1] − 0.5)FOV[0..π] )
2 tan(FOV[0..π] 0.5)

(3)

where y[0..1] is the vertical input position, yout the new vertical position, and FOV0..π the vertical field of view. The horizontal distortion can be neglected for large numbers of horizontal tiles, because in this case, one tile only covers a few
degrees. We denote this projected texture the distance map.

Technically, we precompute texture coordinate maps of both
the sinusoidal and the Mollweide projection layouts (see Firgure 8). The texture coordinates are used to compose the
deformed rectangular projection with stored distance values according to the custom projection layout. Moreover, using predefined texture coordinate maps, any map projection
known in cartography can be used as a tumor map.

(a)
(a)

(b)

Figure 7: The distortion in the map increases in vertical
direction (a). After compensation for the distortions, the
checker board is regularly spaced (b).

4. Finally, the color scheme is applied to the distance values
of the coagulation surface stored in the distance map using
a transfer function according to the safety margin defined by
the user. The distance values from the center of gravity to
the tumor surface are not visualized in the tumor map (see
Section 5.4).

(8)

(b)

Figure 8: The sinusoidal projection (a) and the Mollweide
projection (b) with color-coded texture coordinates (x = red
channel, y = green channel).
To support the interpretation of the tumor map, we add
labels to the corresponding mapping layout. The labels show
bold isolines of λ = -90, 0, and 90 degree as well as φ =
0 degree. Thin isolines are drawn between the bold lines.
We also include the letters A, L, P, R, H, and F (anterior,
left, posterior, right, head, and foot respectively), which are
common orientation directions in medical workstations (see
Figure 9).
5.4. Interaction with the Tumor Map

5.3. Tumor Map Layout
To further reduce the distortions of the longitude–latitude
mapping, additional map projections can be applied. One
major disadvantage is the strong distortion of the area increasing toward the poles. Because regions at the poles are
stretched in the x-dimension, the areas of different regions
can not be compared. Thus, we additionally included the sinusoidal projection, which is a pseudo-cylindrical equal-area

In the introduced tumor map, surface voxels of the tumor
mask are represented in a color-coded 2D image. Hence, all
critical areas can immediately be recognized without requiring any interaction. However, the assessment of the ablation
result itself can not be performed accurately using the tumor map alone due to the missing contextual information.
On the one hand, the location of an specific area (e.g., a red
coagulation zone) can be perceived on the map, but on the
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

Rieder et al. / Visual Support for Interactive Post-Interventional Assessment of Radiofrequency Ablation Therapy

(a)

(b)

1099

(c)

Figure 9: The images above show the corresponding tumor maps of the volume rendering in figure 4. The equirectangular
longitude–latitude mapping layout with high horizontal distortions at the poles (a). The tumor map with sinusoidal mapping
layout (b) is equal-area, as is the Mollweide projection (c).

other hand, the anatomical vicinity remains unclear. Hence,
for every pixel in the tumor map, a visualization of the corresponding position in the 3D volume rendering as well as
in the 2D slice view is needed.
To synchronize the different viewers used for assessment
with the tumor map, the mapping from R2 to R3 has to be
calculated. The user is able to mark any point on the tumor
map using the mouse, and the map position of the used projection layout is captured. Subsequently, a lookup using the
rectangular map is performed using the texture coordinate
map of the layout projection. Furthermore, the corresponding distance value d (distance from tumor surface to center
of gravity) stored in the rectangular map is fetched. Using
this distance value and the position of the center of gravity
ptumor , the corresponding world position can be calculated
immediately. The longitude λ, defined from 0 to 2π, and the
latitude φ, defined from 0 to π, can be calculated:
λ[0..2π] = 2πposx size−1
x

(9)

φ[0..π] = πposy size−1
y

(10)

where posx,y is the position in the map texture and sizex,y
is the size of the map. The following formula calculates
the corresponding world position p world for the given geographic coordinates λ and φ:
p world = (sin λ sin φ, cos λ sin φ, − cos φ)d + ptumor

(11)

where ptumor is the center of gravity of the tumor. Subsequently, the resulting world position is used to draw a cursor at the voxel position in the pre-interventional viewer as
well as to automatically adjust the displayed slice stack. The
post-interventional viewer is also adjusted using the registration matrix. If the user drags the mouse along a longitudinal direction from left to right, an interactive, counterclockwise movement of the cursor at the tumor’s outline can
be observed in the axial view. Analogously, a top-to-bottom
mouse movement along the latitudinal direction causes the
cursor to follow the tumor’s outine in pole direction and
causes the slice stack to change.
In the 3D volume rendering, an interactive adaptation of
the view position is calculated to allow an observation of the
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

point of interest marked in the tumor map instead of drawing
a 3D cursor. Using the longitude λ and latitude φ from equations (9) and (10), we compose the rotation vector R (vv, α)
from following two rotations:
Rφ ((− cos λ, sin λ, 0), φ)
R (vv, α) = R λ ((0, 0, 1), λ)R

(12)

The rotation matrix MR is then composed from the rotation R (vv, α) and the center point ptumor . Finally, the rotation matrix is applied to the volume rendering. Upon mouse
movement in the longitudinal direction, the volume rendering rotates around the z axis; for latitudinal direction, the
volume rendering rotates around the x and y axes. Consequently, the view point is always oriented to the currently selected surface point of the tumor. Moreover, using the equations given above, the inverse mapping from world position,
marked by the user in the 2D viewer, onto the tumor map
can be calculated.
6. Results
The proposed traffic light color scheme is an intuitive
method to enhance the visualization of critical ablation areas
for RFA assessment. The color scheme is used in the familiar 2D slice visualizations as well as in the 3D volume rendering of a region of interest around the tumor. The volume
rendering enables the immediate recognition of the spatial
relation of the lesion within anatomical structures such as
vessels. However, we are aware that the traffic color scheme
is not suitable for people with color vision deficiencies such
as color blindness. Thus, alternative color schemes should
be investigated instead of the traffic color scheme.
We developed the tumor map as a novel visualization and
interaction tool. It allows for a visualization of the colorcoded ablation result using a cylindrical mapping of the tumor surface into a 2D map texture. Critical zones, such as
the zone of incomplete cell destruction, can be recognized
immediately. Moreover, the tumor map is an intuitive navigation tool. The user is able to navigate in the map using
mouse interaction. Subsequently, the mapped world position
is highlighted in the 2D viewer, and the slice stack is adjusted

Rieder et al. / Visual Support for Interactive Post-Interventional Assessment of Radiofrequency Ablation Therapy

20
15

20

10
5
Mollweide

Equirectangular

(a)

6.2. Evaluation
The advantage of the tumor map is that the entire surface of
the ablated tumor can be immediately explored without the
need for any interaction. We believe that an evaluation of this
obvious fact is not necessary. Thus, we focused on whether
interaction with the tumor map is faster and more accurate
that the rotation of a 3D scene with the widely used virtual
trackball metaphor. Furthermore, we evaluated the occurrence of significant changes of performing navigation with
the Mollweide and equirectangular projections. To answer
these questions, we set up a user study with 15 subjects, including scientists, computer scientists, and medical experts.
20 data sets, each with real lesion and artificial coagulation,
were combined. Each subject had to rotate the tumor object
to a given orientation (presented in a separate viewer) in random order. The subjects had to repeat the procedure using
the tumor map with Mollweide and equirectangular layouts,
respectively. We defined 3 circular cone sectors with 5, 10,
and 15 degree opening angles from the reference orientation
vector. If the user’s orientation vector hits one sector (and
does not leave it afterwards) we measured the required time
in milliseconds. Additionally, we measured the elapsed time
until the user accepts his orientation and the accuracy in degree.
We analyzed the stored times of the study and performed
an analysis of variance (ANOVA). We could observe significant (p < 0.05) changes in the mean of the needed time
to enter the 15 degree sector. The measured times with the
equirectangular layout are the smallest (x¯ = 5,96 sec), followed by the Mollweide map (x¯ = 7,91 sec) and the virtual

Case 19 - without features

Case 13 - with features

15

The compositing of the tumor map takes approximately one
second (2x2.66 GHz Xeon, ATI RadeonX 1900) and has to
be performed once after applying the registration result. It
is a minor performance bottleneck compared with reformation of the registered data set. However, after generation of
the tumor map, the security margin can be changed interactively, since we perform a texture lookup using the computed
distance map. Also, the visualization of the color scheme in
2D and 3D changes interactively, because only the distance
threshold is changed for comparison with the fetched value
of the loaded distance volume. Finally, the calculation of the
corresponding world position from the current tumor map
position is performed on the fly.

10

6.1. Performance

trackball metaphor (x¯ = 8,46 sec)). Despite the high distortions of the simple longitude–latitude mapping, the subjects
could better navigate, because longitudes and latitudes are
mapped onto a rectangular grid. In contrast, for a vertical
rotation in the Mollweide map, the subjects had to follow
the curved longitudinal lines, which was not easy to achieve.
The other two sector times (10 and 5 degree) are generally not significantly different for all three modalities. Because many subjects had greater angles than 10 degree we
ignored those sectors in this evaluation. However, we observed differences in the influence of the chosen cases. Navigation with the tumor map was particularly faster if expressive color or shape features were visible on the tumor. Without features, no significant changes could be measured.

5

automatically so that the corresponding slice is visible. Additionally, the volume rendering view is adapted in such a
way that the point of interest is always visible. Distancebased clipping prevents occlusion of the lesions by anatomical structures. The proposed methods are integrated in a software assistant (see Figure 11), designed for assessment of
radiofrequency ablations [WRK∗ 07].

0

1100

Rotation

Mollweide

Equirectangular

Rotation

(b)

Figure 10: Boxplot (a) shows significantly lower times and
variance with expressive features and no significant differences without features (b).
Supplementary results of our study are that there is no statistically significant differences in the achieved orientations
with all three modalities (Trackball: x¯ = 3,93◦ , equirectangular: x¯ = 3,53◦ , Mollweide: x¯ = 3,66◦ ). Furthermore, a significant deviation in the elapsed time could not be measured. All
subjects tried to achieve maximum accuracy and required on
average an equal amount of time with all methods, because
of the pixel-wise fine tuning of the rotation. We conclude,
that using the tumor map (with the equirectangular layout),
the subjects were able to navigate significantly faster close
to the target orientation, but needed an equal amount of time
for all modalities for accurate adjustment of the final orientation.
In addition, the software assistant was presented to five
physicians with high expertise. We conducted an informal
evaluation with actual radiofrequency cases. The medical experts regarded the color scheme as a very helpful method to
adequately visualize the ablation result. Furthermore, they
described the tumor map as a helpful tool for an initial observation of the ablation zones. They used the tumor map
to mark suspicious areas of interest as a starting point for
further detailed exploration. Subsequently, they simultaneously explored the ablated tumor in the 2D and 3D viewers.
However, we are aware that the clinical value can not be determined in an informal evaluation. For that reason, a retrospective clinical study is part of our ongoing research. In this
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

Rieder et al. / Visual Support for Interactive Post-Interventional Assessment of Radiofrequency Ablation Therapy

(a)

1101

(b)

Figure 11: Integrated tumor map and visualization of tumor and coagulation with color scheme in our clinical software assistant. Case (a) with necrosis at the liver’s capsule (Mollweide projection), case (b) with successfully ablated tumor (equirectangular projection). The plot above the tumor map displays relative distances from tumor to coagulation stored in the map.

study, experienced physicians have to verify the ablation result (whereas the ground truth is not known to them) with our
prototype as well as with the traditional clinical procedure.
7. Discussion and Conclusion
In this paper, we described novel visualization and interaction techniques for software-based support of assessment
of post-interventional coagulation areas resulting from radiofrequency ablation. We combine familiar methods of
medical workstations, 2D slicing, and anatomical 3D volume rendering, with new approaches, such as the colorcoding scheme and the tumor map. Interactive view selection
and automatic determination of transfer function for volume
rendering substantially reduce the required interaction time.
The main contribution of our work is the immediate detection of residual tumor tissue in the tumor map by the physician without the need for any interaction. However, a drawback of the chosen cylindrical mapping is that tumors which
are concave and not star-convex (a ray from center to surface
has multiple exit points) can not be accurately mapped into a
2D texture. This issue can be solved by adapting the rendering of the rectangular map. Instead of storing the distance
at the first exit point, the distance has to be stored at the
last exit point, i.e., rendering the convex hull of the tumor.
Despite not all surface points are mapped into the resulting
map, the missing points are implicitly represented as voxels
inside of the tumor. From a medical point of view, this issue
can be neglected, because residual tumor tissue can generally be expected at the tumor’s rim.
An additional advantage of the proposed method is the
possibility to mark suspicious regions in the tumor map
c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.

which are immediately visible in the 2D viewers and in the
volume rendering. For this task, the Mollweide map is the
preferred layout because of the intuitive, well-known shape
and the less distortion. The evaluation shows that rotating the
tumor object using the tumor map with the rectangular layout is significantly faster than rotating with the virtual trackball metaphor. Thus, navigation with the equirectangular tumor map is an intuitive alternative to common techniques
for interactive exploration of tumors. Hence, in our software
assistant, the user is able to switch between the tumor map
layouts. Due to the synchronization of the 2D and 3D viewers, we believe that the tumor map used as navigation tool
could lead to a higher acceptance of the volume rendering in
a medical workstation.
In conclusion, the presented methods support the physician in interactively achieving a reliable therapy assessment.
However, the accuracy of the ablation verification depends
heavily on the robustness of the segmentation and the precision of the registration of pre- and post-interventional image data. Moreover, the results generally depend on the resolution of the CT image data. Voxel sizes of less than 1.0
mm in-plane and less than 3 mm in scan direction are recommended for a good verification of the treatment success.
Suitable interactive segmentation as well as automatic registration algorithms are subjects of ongoing research.
Acknowledgements
This work was funded by the Federal Ministry of Education
and Research (SOMIT-FUSION project FKZ 01IBE03L).
We would like to thank the people at Fraunhofer MEVIS
as well as our clinical partners for their contribution to our
work.

1102

Rieder et al. / Visual Support for Interactive Post-Interventional Assessment of Radiofrequency Ablation Therapy

References
[BKM∗ 06]

B RICAULT I., K IKINIS R., M ORRISON P. R., VAN SONNENBERG E., T UNCALI K., S ILVERMAN S. G.: Liver
metastases: 3D shape-based analysis of CT scans for detection
of local recurrence after radiofrequency ablation. Radiology 241,
1 (Oct 2006), 243–50.

[BKv∗ 04] B RICAULT I., K IKINIS R., VAN S ONNENBERG E.,
T UNCALI K., S ILVERMAN S.: 3D Analysis of RadiofrequencyAblated Tumors in Liver: A Computer-Aided Diagnosis Tool for
Early Detection of Local Recurrences. MICCAI - LNCS 3217
(2004), 1042–1043.
[BS05] B ORDOLOI U., S HEN H.: View Selection for Volume
Rendering. Visualization, 2005. VIS 05. IEEE (2005), 487–494.
[BWK∗ 01] BARTROLI A. V., W EGENKITTL R., K ÖNIG A.,
G RÖLLER E., S ORANTIN E.: Virtual Colon Flattening. VisSym
’01 Joint Eurographics - IEEE TCVG Symposium on Visualization (2001), 127–136.
[BWR∗ 09] BANGARD C., W IEMKER R., RÖSGEN S., WAHBA
R., H ELLMICH M., F ISCHER J., S TIPPEL D. L., L ACKNER K.:
Optimal visualization and 3D-asphericity quantification for postoperative result assessment of hepatic radiofrequency ablations.
Journal of Computer Assisted Radiology and Surgery 4, Supplement 1 (2009), 59–70.
[CQWZ06] C HAN M., Q U H., W U Y., Z HOU H.: Viewpoint
selection for angiographic volume. Proceedings of International
Symposium on Visual Computing 4291 (2006), 528.
[EKE01] E NGEL K., K RAUS M., E RTL T.:
High-Quality
Pre-Integrated
Volume
Rendering
Using
HardwareAccelerated Pixel Shading. Proceedings of the ACM SIGGRAPH/EUROGRAPHICS workshop on Graphics hardware
(2001), 9–16.
[HGQ∗ 06] H ONG W., G U X., Q IU F., J IN M., K AUFMAN A.:
Conformal Virtual Colon Flattening. Proceedings of the 2006
ACM symposium on Solid and physical modeling (2006), 85–93.
[HKB01] H URDAL M., K URTZ K., BANKS D.: Case Study: Interacting with Cortical Flat Maps of the Human Brain. Visualization, 2001. VIS ’01. IEEE (2001), 469–591.
[HZB∗ 10]

H EIZMANN O., Z IDOWITZ S., B OURQUAIN H., P OTS., P EITGEN H.-O., O ERTLI D.: Assessment of intraoperative liver deformation: Prospective clinical Study. World
Journal of Surgery (2010), (in print).
THAST

[KBGK07] KOHLMANN P., B RUCKNER S., G ROLLER M. E.,
K ANITSAR A.: LiveSync: Deformed Viewing Spheres for
Knowledge-Based Navigation. Visualization and Computer
Graphics, IEEE Transactions on 13, 6 (2007), 1544–1551.
[KBKG09] KOHLMANN P., B RUCKNER S., K ANITSAR A.,
G ROLLER M.: Contextual Picking of Volumetric Sructures.
IEEE Pacific Visualization Symposium (2009), 185–192.
[KHL∗ 08] K LEIN S., H EIDE U. A. V. D., L IPS I. M., V ULPEN
M. V., S TARING M., P LUIM J. P. W.: Automatic segmentation
of the prostate in 3D MR images by atlas matching using localized mutual information. Med. Phys. 35, 4 (Jan 2008), 1407.

[LCMH09] L AMPE D., C ORREA C., M A K., H AUSER H.:
Curve-Centric Volume Reformation for Comparative Visualization. Visualization And Computer Graphics, IEEE Transactions
On 15, 6 (2009), 1235–1242.
[MBK∗ 09] M OLTZ J., B ORNEMANN L., K UHNIGK J.-M.,
D ICKEN V., P EITGEN E., M EIER S., B OLTE H., FABEL M.,
BAUKNECHT H.-C., H ITTINGER M., K IESSLING A., P USKEN
M., P EITGEN H.-O.: Advanced Segmentation Techniques for
Lung Nodules, Liver Metastases, and Enlarged Lymph Nodes in
CT Scans. Selected Topics in Signal Processing, IEEE Journal of
3, 1 (2009), 122–134.
[MNF∗ 07] M ULIER S., N I Y., F RICH L., B URDIO F., D ENYS
A. L., W ISPELAERE J.-F. D., D UPAS B., H ABIB N., H OEY
M., JANSEN M. C., L ACROSSE M., L EVEILLEE R., M IAO
Y., M ULIER P., M UTTER D., N G K. K., S ANTAMBROGIO R.,
S TIPPEL D., TAMAKI K., VAN G ULIK T. M., M ARCHAL G.,
M ICHEL L.: Experimental and Clinical Radiofrequency Ablation: Proposal for Standardized Description of Coagulation Size
and Geometry. Ann Surg Oncol 14, 4 (Apr 2007), 1381–96.
[NGB∗ 09] N EUGEBAUER M., G ASTEIGER R., B EUING O.,
D IEHL V., S KALEJ M., P REIM B.: Map Displays for the Analysis of Scalar Data on Cerebral Aneurysm Surfaces. Eurographics/ IEEE-VGTC Symposium on Visualization 28, 3 (Jan 2009),
895–902.
[Per07] P EREIRA P. L.: Actual role of radiofrequency ablation of
liver metastases. Eur Radiol 17, 8 (Aug 2007), 2062–70.
[RHR∗ 09] ROPINSKI T., H ERMANN S., R EICH R., S CHAFERS
M., H INRICHS K.: Multimodal Vessel Visualization of Mouse
Aorta PET/CT Scans. Visualization And Computer Graphics,
IEEE Transactions On 15, 6 (2009), 1515–1522.
[RSW∗ 09] R IEDER C., S CHWIER M., W EIHUSEN A., Z ID OWITZ S., P EITGEN H.-O.: Visualization of Risk Structures for
Interactive Planning of Image Guided Radiofrequency Ablation
of Liver Tumors. Proceedings of SPIE Medical Imaging (Jan
2009).
[SBA∗ 04] S TIPPEL D. L., B ROCHHAGEN H. G., A RENJA M.,
H UNKEMÖLLER J., H ÖLSCHER A. H., B ECKURTS K. T. E.:
Variability of Size and Shape of Necrosis Induced by Radiofrequency Ablation in Human Livers: A Volumetric Evaluation. Ann
Surg Oncol 11, 4 (Apr 2004), 420–5.
[SM04] S HEN L., M AKEDON F.: Spherical Parameterization for
3D Surface Analysis in Volumetric Images. ITCC ’04: Proceedings of the International Conference on Information Technology:
Coding and Computing 2 (Jul 2004), 643.
[Sny87] S NYDER J. P.: Map Projections - A Working Manual.
1987.
[WEE03] W EISKOPF D., E NGEL K., E RTL T.: Interactive Clipping Techniques for Texture-Based Volume Visualization and
Volume Shading. Visualization and Computer Graphics, IEEE
Transactions on 9, 3 (2003), 298– 312.
[WRK∗ 07] W EIHUSEN A., R ITTER F., K RÖGER T., P REUSSER
T., Z IDOWITZ S., P EITGEN H.-O.: Workflow oriented software
support for image guided radiofrequency ablation of focal liver
malignancies. Proceedings of SPIE (Jan 2007).

[KWFG03] K ANITSAR A., W EGENKITTL R., F LEISCHMANN
D., G ROLLER M.: Advanced Curved Planar Reformation: Flattening of Vascular Structures. Visualization, 2003. VIS 2003.
IEEE (2003), 43–50.
[LBLW04] L AZEBNIK R., B REEN M., L EWIN J., W ILSON D.:
Automatic Model-Based Evaluation of Magnetic ResonanceGuided Radio Frequency Ablation Lesions with Histological
Correlation. Journal of Magnetic Resonance Imaging 19, 2
(2004), 245–254.

c 2010 The Author(s)
Journal compilation c 2010 The Eurographics Association and Blackwell Publishing Ltd.


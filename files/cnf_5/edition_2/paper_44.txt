2009 Sixth International Conference on Computer Graphics, Imaging and Visualization

Fast Recursive Algorithm for a New Model of Triangular Surfaces
Wittaya Unjai, Natasha Dejdumrong
Department of Computer Engineering
King Mongkut’s University of Technology Thonburi
Bangkok, 10140, Thailand
Email: unjai_cpe@hotmail.com, natasha@cpe.kmutt.ac.th

Abstract --- A new model of bivariate bases on triangular
patches is proposed by applying the univariate bases
proposed by Dejdumrong [4]. In this paper, some geometric
properties and its efficient recursive formulae are provided.
Its fast recursive evaluation algorithm is also obtained in
terms of a quadratic time complexity. Thus, it is shown that
this type of surfaces is obviously more efficient than the
traditional triangular Bézier surfaces or other kinds of
triangular patches. In addition, it is also practical for
interactive geometric modeling.

proposed by Dejdumrong seem to be an appropriate
model because it is linear computations and the curve is
closer to the control points than Wang-Ball and Said-Ball
curves. [4]
After studying the relationships between curves and
surfaces, the interpolation algorithms for curves and
surfaces have some procedures in common. In other
words, the interpolations in each rectangular or triangular
surface relate to its own curves. For examples, Bézier
triangular surface is prevalent to model the triangular
surface because of the ease of its basis functions. It is
also related to the number of interpolations. Bézier curve
will interpolate every control point as well as Bézier
rectangular or triangular surfaces will also interpolate
every rectangular (or triangular, respectively) control
points. According to the notion of Bézier interpolations,
a new basis for the proposed triangular surface came
from the idea of interpolations of Dejdumrong’s
algorithm. This curve interpolates three times for the
degree n is odd and two times for n is even. Therefore, a
new proposed triangular surface will interpolate three
times when the number of triangles in the current level is
odd and two interpolations when the level number is
even.

Keywords--- Triangular Surfaces.

I.

INTRODUCTION

In the field of geometric modeling, there exist several
attempts to make the use of curves and surfaces.
Particularly, there are two types of surfaces: Rectangular
and Triangular surfaces. Rectangular surfaces are easy to
use in generating and evaluating surfaces while
triangular ones are more complicated. Thus, triangular
surfaces are less popular than the former ones. Moreover,
the recursive formulae in evaluating the triangular
surfaces are both difficult for programming as well as the
inefficient computational complexity, i.e., O(n3). In fact,
the advantage of triangular patches over rectangular ones
is in their use for constructing composite patches. It is
totally feasible to triangulate a geometric object, but it is
not always possible to form a rectangular grid on an
object. For this reason, there is an idea to propose a new
model of triangular patches to overcome these problems.

In this work, a new proposed triangular surface is
more advantageous than Bézier, Wang-Ball, Said-Ball,
and DP Triangular surfaces [3, 6, 8, 10]. This surface can
be quickly evaluated because of the quadratic time
complexity (O(n2)). However, the complexity for any
triangular surfaces are O(n3). This paper presents new
bivariate basis functions for triangular surface,
recurrence formulae, recursive algorithm. Moreover,
several important geometric properties are investigated,
i.e. convex hull property.

Constructing a triangular model on the barycentric
coordinates, it is important to discover the curve
characteristics such as linear interpolation, recursive
subdivision and general forms of the formulae.
Moreover, the pros and cons of all candidate curves are
needed to be compared. The evaluation time for plotting
a Bézier curve is the longest especially when the degree
is high [12]. The algorithm complexity for Said-Ball
model is quadratic which is the same as of the de
Casteljau algorithm. [13] A Wang-Ball curve is drawn
the farthest from its control points compared to the
others. [9, 14] A DP curve is normalized totally positive,
i.e., shape preserving, but in fact, the shape of the curves
is influenced by one or two middle points. [5] The curves
978-0-7695-3789-4/09 $25.00 © 2009 IEEE
DOI 10.1109/CGIV.2009.92

264

II.

A NEW CURVE REPRESENTATION

III.
A NEW SYSTEM OF B IVARIATE
POLYNOMIALS AND ITS INTERPOLATION
TECHNIQUE

A new curve representation of degree n with n+1
n

control points, denoted by {d i }i =0 , can be explicitly
defined as

Employing the intuitive idea in [1], a number of
interpolations of triangles can be represented in the
following figures, where the black central point in the
middle of triangle means the interpolation symbol.

n

D(t ) = ∑ D(t ) ⋅d i

;0 ≤ t ≤ 1

i =0

where

the

blending

functions,

denoted

by

When n = 1, 2 and 3, the interpolations are the same
as for the first degree Bézier triangular surface.

{Din (t )}in=0 , can be recursively defined by

Din (t ) =

(3t ) i ⋅ (1 − t ) i +3

n
;0 ≤ i <   − 1
2

(3t ) i ⋅ (1 − t ) n−i

n
;i =   − 1
2

Dnn−i (1 − t )

n
;  +1 ≤ i ≤ n
2

Specifically, if n is even, then

D (t ) = 2 ⋅ 3
n
n
2

n
−1
2

n
2

n
2

⋅ (1 − t ) ⋅ t .

Considering this new curve in non-rational form, a
diagram shown the relationship between the number of
degrees and the number of interpolations can be
illustrated as followings. Figure 7 shows the
interpolations for this curve when n is 7.

N = 7:

d0

N=6:

d1

d0

N=5:

d2

d1
d0

N=4:

d3

d2

d3

d1
d0

N=3:

d2
d1

d0

N=2:

N=0:

d4

d2

d0

d5

d3

d1

N=1:

d4

d3

d1
d0

d5
d4

d2

d6

Figure 2. The interpolations for triangular patches
when n is 1, 2, and 3, respectively.

When n = 4, it is adopted the notion of the curve. If
the number of triangles in each level is even, then there
are two interpolations, else if the number is odd, there
are three interpolations. In this case, the number of
triangles in this level is even, there are two
interpolations. (Fig. 3)

d7

d6
d5

d4
d3

d2
d1
Figure 3. The interpolations for triangular patches when n is 4.

d0

If n = 5, the number of interpolations in each level is
odd, there are 3 interpolations. (Fig. 4)

Figure 1. The interpolation diagram for this proposed curve when n is
7

If n is odd, there is 3 interpolations, otherwise there
are 2 interpolations. When performing the calculation
manually, it is more convenient to write down the
coefficients in a triangle scheme as
265

There are n + 1 control points on each side of the
triangle and because of the way the point are arranged
there is a total number of 1 ( n + 1)(n + 2) control point.
2

IV.

RECURSIVE ALGORITHM

From the previous section, the interpolations can be
represented in the recursive form as follows.
Figure 4: The interpolations for triangular patches
when n is 5.

Algorithm

This triangular patch is based on the control points,
denoted by Di, j,k , arranged in a triangle-like shape. Each

Assume D(u,v,w) =

control point is located in three-dimensions and is
assigned to three indices i, j, k
such that

0

For D0,0,0 (N = 0) to

0 ≤ i, j, k ≤ n and i + j + k = n . The value n can be
selected by the user depending upon how large and
complex the patch should be and how many points are
given. Generally, a large n allows for finer control of
surface details but involves with more computations. The
following convention is used here. The first index, i,
corresponds to the left-handed side of the triangle, the
second index, j, corresponds to the base and the third
index, k, corresponds to the right side, where u, v, w ≥ 0
and u + v + w = 1. The indexing convention for n = 1, 2,
3 and 4 can be shown as followings.
D1,0,0
D0,1,0

If

D1,1,0
D0,2,0

Din, −j,1k (N = n - 1) Do

n ≤ 2,
Din, j,k = uDin+1, j,k + vDin, j +1,k + kDin, j,k +1 ,

If

n ≥ 3 and n = i ,
Din, j,k = uDin++11, j,k ,

If

n ≥ 3 and n ≠ i ,
Din, j,k = uDin+1, j,k + vDin, j +1,k + kDin, j,k +1

D2,0,0

D0,0,1

D0,0,0 and start this algorithm with

D0,1,1

,

 n − i − 1
 n − i + 1
where 
≤k≤


 2 
 2 

D1,0,1
D0,0,2

Otherwise

D2,1,0

j > i, k ; Din, j,k = uDin, +j +11,k

If

D3,0,0

k > i, j ; Din, j,k = uDin, +j,1k +1

D2,0,1

End.
D1,2,0
D0,3,0

D1,1,1 D1,0,2

D0,2,

D0,1,2

D0,0,3

For above algorithm, it was shown as example below.
Considering when n = 4,

D4,0,0
D3,1,0
D2,2,0
D1,3,0
D0,4,0

D0,3,1

D3,0,1

D2,1,1

D1,2,1

We can start with n = 0,

D 00,0,0 = uD11,0,0 + vD 01,1,0 + kD 01,0,1
D2,0,2

D1,1,2

D0,2,2

If

D11,0,0 = uD22,0,0 + vD12,1,0 + kD12,0,1

D1,0,3

D0,1,3

n≤2

D01,1,0 = uD12,1,0 + vD02,2,0 + kD02,1,1

D0,0,4

Figure 5. The indexing convention for n = 1, 2, 3 and 4 respectively.

D01,0,1 = uD12,0,1 + vD02,1,1 + kD02,0,2
266

D22,0,0 = uD33,0,0 + vD23,1,0 + kD23,0,1

Hence, when n = 4, the triangular surface formula can
be obtained as

D12,1,0 = uD23,1,0 + vD13,2,0 + kD13,1,1

D00,0,0 (u, v, w) =
u 3 D44,0,0 + 3u 3 vD34,1,0 + 3u 3 wD34,0,1 + 3u 2 v 2 D24, 2,0

D12,0,1 = uD23,0,1 + vD13,1,1 + kD13,0,2

+ 6u 2 vwD24,1,1 + 6u 2 w 2 D24,0, 2 + 3uv 3 D14,3,0

+ 12 uv 2 wD 14, 2 ,1 + 12 uvw 2 D14,1, 2 + 3uw 3 D14, 0 , 3

D02,2,0 = uD13,2,0 + vD03,3,0 + kD03,2,1
D

2
0,1,1

= uD

3
1,1,1

+ vD

3
0, 2,1

+ kD

+ v 3 D 04, 3, 0 + 3v 3 wD 04, 3,1 + 6 v 2 w 2 D 04, 2 , 2 + 3vw 3 D 04,1, 3
3
0,1, 2

+ w 3 D 04, 0 , 4

D02,0,2 = uD13,0,2 + vD03,1,2 + kD03,0,3
u

n ≥ 3 and n = i : (n = 3) ≥ 3
n
n +1
and 3 = 3 : Di, j ,k = uDi +1, j,k
If

v

w
u2

D33,0,0 = uD44,0,0

2uw

2uv

n ≥ 3 and n ≠ i :
 3 − 2 − 1
 3 − 2 + 1
≤k≤


 =0 ≤ k ≤ 1
2
2




3
4
4
D2,1,0 = uD3,1,0 + vD2,2,0 + kD24,1,1

If

v2

u3
3u2w

3u2v

D

3
2,0,1

= uD

4
3,0,1

+ vD

4
2,1,1

+ kD

w2

2vw

4
2,0, 2

n ≥ 3 and n ≠ i :
 3 − 1 − 1
 3 − 1 + 1
 2  ≤ k ≤  2 = 0 ≤ k ≤ 2





v3

If

3uw2

6uvw

3uv2

w3

3vw2 3vw2
u3

D13,2,0 = uD24,2,0 + vD14,3,0 + kD14,2,1

3u2w

3u2v
6uvw

D13,1,1 = uD24,1,1 + vD14,2,1 + kD14,1,2

6u2v2

D13,0,2 = uD24,0,2 + vD14,1,2 + kD14,0,3

3uv2

12uv2w 12uvw2

v3

n ≥ 3 and n ≠ i :
 3 − 0 − 1
 3 − 0 + 1
= 1≤ k ≤ 2
 2 ≤k≤
2 




If

6u2w2

2

3v w

6v2w2

3uw2
w3
2

3vw

Figure 6. Constructions of triangular bases of degree 1, 2, 3 and 4
respectively.

D03,2,1 = uD14,2,1 + vD04,3,1 + kD04,2,2
D03,1,2 = uD14,1,2 + vD04,2,2 + kD04,1,3
If

V.

j > i, k ; Din, j,k = uDin, +j +11,k

The relationship between the number of degrees and
the number of interpolations can be shown as

D03,3,0 = vD04,4,0
If

COMPUTATIONAL COMPLEXITY

k > i, j ; Din, j,k = uDin, +j,1k +1
D03,0,3 = kD04,0,4
267

•
The Number of
Interpolations

Figure 7. The Relationship between the number of degrees and the
number of interpolations.

It can be noticed that the values in the second level are
repeated with only the values 3 or 2, respectively. For the
sake of simplicity, the equation can be formulated in
terms of the value 3.

After that, using mathematics to find the equation of
above series the difference between the degree n+1 and n
can be found. It can be then found that the same results
(3) can be obtained in the second loop of the
computations. Thus, the general quadratic equation can
be derived by

REFERENCES
[1]

Ball A.A., Consurf Part 1: Introduction of conic lofting
title, Computer Aided Design 7 (1975), pp. 243–249.
[2] Böehm W, Farin G E, Kahmann J. A survey of curve and
surface methods in CAGD. Computer Aided Geometric
Design, 1984, 1: 1–60.
[3] Chen J. and Wang G-J, Construction of triangular DP
surface and its application, Journal of Computational and
Applied Mathematics, 219(1), 2008, 312-326.
[4] Dejdumrong N., Efficient Algorithms for Non-Rational
and Rational Bézier Curves, The 5th International
Conference on Computer Graphics, Imaging and
Visualization (CGIV'08), Penang, Malaysia, 109-114,
2008.
[5] Delgado J. and J. M. Peña. A Shape Preserving
Representation with an Evaluation Algorithm of Linear
Complexity. Computer Aided Geometric Design,
20(1):1-20, March 2003.
[6] Farin G E. Triangular Bernstein-Bézier patches.
Computer Aided Geometric Design, 1985, 2: 83–127.
[7] Goodman, T.N.T. and Said, H.B., Properties of
generalized Ball curves and surfaces. Computer Aided
Design. v23 i8, 1989. 554-560.
[8] Goodman T. N. T., Said H. B., Shape preserving
properties of the generalised Ball basis, Computer Aided
Geometric Design, v.8 n.2, p.115-121, May 1991
[9] Hu S. M., Wang G Z, Jin T G. Properties of two types of
generalized Ball curves.Computer Aided Design, 1996,
28(3): 125–133.
[10] Hu, S.M., Wang, G.J. and Sun, J.G., A Type of triangular
Ball surface and its properties. J. Comput. Sci. Technol.
v13 i1, 1998. 63-72.
[11] Jiang S-R and Wang G-J., Conversion and evaluation for
two types of parametric surfaces constructed by NTP
bases, Computers and Mathematics with Applications.
49(2-3):321-329 (2005)

an = An2+Bn+C
The coefficients A, B and C can then be computed by
a1 = A +B + C = 1
a2 = 4A +2B + C = 4
a2 = 4A +2B + C = 10
Solving above equation, then A =

3
3
B= −
and
2
2

C = 1. Hence,
an =

3 2 3
n - n+1
2 2

Thus, this new triangular model can be generated within
the quadratic complexity, or O(n2).
PROPERTIES OF NEW TRIANGULAR
SURFACES

u + v + w = 1 and u, v, w ≥ 0

Since the triangular Ball basis functions, denoted
by Di, j ,k (u, v, w)(i + j + k = n ) ,
the
following
properties are satisfied
Positivity

CONCLUSION

In this paper, a new model of bivariate bases is
constructed into triangular patches. It is possible that this
new triangular surfaces will have a great future in several
applications of computer aided geometric design because
it spends time to in drawing a triangular surfaces less
than any other algorithms. In other words, it can be
summarized that this new surface is more efficient than
the Bézier triangular patch when the surface needs to be
evaluated interactively because the complexity of this
surface is only O(n2) compared to that of Bézier surface,
which is O(n3).

Figure 8. The Relationship between the number of degrees and the
number of interpolations.

•

Di , j , k (u , v, w) = 1

Convexity It can be concluded that the
triangular Ball surface, denoted by D(u, v, w) is
a convex combination of its control points,
hence the surface lies in the convex hull of its
control net.
VII.

The Number of
Interpolations

From

∑
i+ j +k =n

•

VI.

Normality

Di , j ,k (u , v, w) > 0
268

[12] Phien H.N. and Dejdumrong N., Efficient algorithms for
Bézier curves, Computer Aided Geometric Design 17
(2000), pp. 247–250.
[13] Said H.B., Generalized Ball curve and its recursive
algorithm, ACM. Tran. on Graphics 8 (1989), pp. 360–
371.
[14] Wang G J. Ball curve of high degree and its geometric
properties (in Chinese).Applied Mathematics: A Journal
of Chinese Universities, 1987, 2: 126–140.
[15] Wang G.J. and Cheng M., New algorithms for evaluating
parametric surface, Progress in Natural Science 11
(2001), pp. 142–148.

269


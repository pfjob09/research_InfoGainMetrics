2009 Sixth International Conference on Computer Graphics, Imaging and Visualization

Wang-Ball Triangular Patch and Its Properties
Supareuk Sukjaitham, Natasha Dejdumrong
Department of Computer Engineering
King Mongkut’s University of Technology Thonburi
Bangkok, 10140, Thailand
Email: supareuk.suk@kmutt.ac.th, natasha@cpe.kmutt.ac.th

is quadratic computation.

Abstract—A new model of triangular Ball surface is proposed with its quadratic complexity. It can be constructed
from the idea of Wang-Ball univaritate functions and Wang
algorithm. The new bivariate basis functions look analogous
to the Wang-Ball polynomials. Evaluating points on a curve
can be calculated from the new recursive algorithm that is
proved to be quadratic, O(n2 ). Thus, the calculation time is
less than any other triangular curves. Finally several important
geometric properties for these surfaces are also identiﬁed such
as normality, convexity and symmetry.

[A30 (u), A31 (u), A32 (u), A33 (u)] =
[(1 − u)2 , 2u(1 − u)2 , 2u2 , (1 − u), u2 ]

and control points are Wi (i = 0, 1, 2, 3) can be represented
3
as W (u) = i=0 A3i Wi , 0 ≤ u ≤ 1.[7][8][9]
In 1987, the Wang-Ball basis was generalized Ball curve
of high degree and its geometric properties by Wang. In
Wang’s paper, basis functions were deﬁned as follows [10]:
• if n is an even number
⎧
n
2 i
⎪ (1 − u) w , for 0 ≤ i ≤ 2 − 1,
⎪
⎪
⎨
n
w2
, for i = n2 ,
Ani (u) =
⎪
⎪
⎪
⎩ 2 n−1
, for n2 + 1 ≤ i ≤ n.
u w
• if n is an odd number
⎧
(1 − u)2 wi
, for 0 ≤ i ≤ n−3
⎪
2 ,
⎪
⎪
⎪
⎪
⎪
n−1
⎪
⎪
, for i = n−1
⎨ (1 − u)2 w 2
2 ,
n
Ai (u) =
⎪
n−1
⎪
⎪
, for i = n+1
uw 2
⎪
2 ,
⎪
⎪
⎪
⎪
⎩ 2 n−1
u w
, for n+3
2 ≤ i ≤ n.
(2)
where w = 2u(1 − u), 0 ≤ u ≤ 1. A parametric curve
of degree n, called a Wang-Ball curve, was represented as
n
An (u) = i=0 Wi Ani (u), 0 ≤ u ≤ 1.
However, this basis function can be aggregated by using
ﬂoor and ceiling function. Let Ani (u) (i = 0...n) are the
Wang-Ball basis functions and its can be deﬁned for both
and even values of n as follows:
⎧
2ui (1 − u)i+2
, for 0 ≤ i ≤ n2 − 1,
⎪
⎪
⎪
⎪
⎪
⎪
n
n
⎪
⎪
, for i = n2 ,
⎨ 2u 2 (1 − u) 2
n
Ai (u) =
⎪
n
n
⎪
⎪
, for i = n2 ,
(2(i − u)) 2 u 2
⎪
⎪
⎪
⎪
⎪
⎩ n−1
Bn (1 − u)
, for n2 ≤ i ≤ n.
(3)
where the ﬂoor − and ceiling − functions are deﬁned
for all real x (Graham et al., 1998) as
x = the greatest integer less than or equal to x; and

Keywords-Triangular Ball Surfaces, Recursive algorithms.

I. I NTRODUCTION
Nowadays, interactive aspects are broadly employed in
several kinds of software applications, especially in computer graphics, CAD/CAM and geometric design. Interactive
geometric modeling is a contemporary ﬁeld concerned with
the fast and efﬁcient computations for curves, surfaces and
solids. In curve modeling, there have been several genres
for curves in terms of different univariate basis polynomials,
e.g., Bernstein, Ball, Said-Ball, Wang-Ball, DP and B-Spline
polynomials. All of them can be readily extended into their
rectangular surface modeling [1][2][3][4]. On the contrary,
some triangular patch models were established using their
own bivariate polynomials, for examples, Bernstein [1] and
Said-Ball [5]. However, other triangular patch models cannot
be easily obtained because they have to deal with the new
bivariate polynomials that must be related to or utilized the
notions of the traditional univariate models.
Recently, some researchers have put many efforts on the
establishments of new triangular bases [3][6]. In 1998, Hu
introduced a new model of Ball triangular surfaces based
on the idea of Wang interpolation algorithm in the work
by Wang (1987). In this work, a new type of bivariate
generalized Ball basis polynomials was proposed without the
general basis formulae. However, the recurrence formulation
for curve construction has been provided with cubic computational complexity. Nevertheless, this evaluation algorithm
is still not more efﬁcient than that of the B?zier triangles.
None of them are closed to the appropriate results.
In order to overcome this signiﬁcant weakness, a new
fast recursive algorithm is initiated with some illustrations
(Triangles with dots representing the interpolations). This
work is also provided the proof that its evaluation algorithm
978-0-7695-3789-4/09 $25.00 © 2009 IEEE
DOI 10.1109/CGIV.2009.73

(1)

241

Figure 1.

(Left) The Geometric interpretation diagram of Wang-Ball curve.(Right) The triangular basis constructions of degree 3 and 4.

x = the least integer greater than or equal to x;
Afterwards, a type of triangular ball surface and its
properties have been extensively investigated by Hu S.,
Wang G. and Sun J. in 1998. Their basis functions reduce
to the univariant Wang-Ball basis functions on each side of
the triangular. However, its recursive algorithm is required
O(n3 ) calculations for evaluating a degree n surface. In this
work, a new model of triangular ball surface representation
is introduced with interpolation matrices used to generate the
triangular surface. Its computational complexities are O(n2 ).
The paper is organized as follows. Section 2 gives the
new model triangular Ball recurrence basis functions and
their properties. Some properties and including recursive
evaluation of a new model triangular of Wang-Ball surfaces
are given in section 3. At last, section 4 gives a summary
conclusion of new model

•

•

⎧
n
Wi+r,j+r,k+r
(u, v, w) ,
⎪
⎪
⎪
⎪
⎪
⎪
⎪
n
⎪
(u, v, w) ,
⎨ Wi+r,j+r,k+r
⎪
n
⎪
Wi+r,j+r,k+r
(u, v, w) ,
⎪
⎪
⎪
⎪
⎪
⎪
⎩ Wn
i+r,j+r,k+r (u, v, w) ,

n
2

for 0 ≤ i ≤
for i =

n
2

,

for i =

n
2

,

for

n
2

− 1,

≤ i ≤ n.
(5)

A basis function (2) can be deﬁnes a new model surface
of degree n with control net Pi,j,k where i + j + k is equal
to degree n. It can be modify the surface by adjusting the
control points shown in Figure 2.
The comparison of basis can be represented by polynomials of degree 6 that shown below between a new model
and a triangular-ball surface which proposed in 1998 by Hu,
respectively.

II. R ECURRENCE OF N EW T RIANGULAR BALL BASIS
In this section, we can construct the Wang-Ball basis functions on a triangle by control nets. The nets are represented
as Pi,j,k where i + j + k is equal to degree n. Then we use
n
(u, v, w) for deﬁned the new model
Wang-Ball basis Wi,j,k
follow by:
n
(u, v, w)
P (u, v, w) = i,j,k=n Pi,j,k Wi,j,k
u, v, w ≥ 0, u + v + w = 0

i + j + k ≤ n−3r
−1
2
(n−1)
n
(u, v, w) = uWi+r,j+r,k+r (u, v, w)
Wi+r,j+r,k+r
(n−1)
+vWi+r,j+r,k+r (u, v, w)
(n−1)
+wWi+r,j+r,k+r (u, v, w)
otherwise
n
(u, v, w) =
Wi+r,j+r,k+r

u2 +2u3 v +v 2 +4u4 v 2 +2uv 3 +8u3 v 3 +4u2 v 4 +2u3 w +
10u4 vw + 38u3 v 2 w + 2v 3 w + 38u2 v 3 w + 10uv 4 w + w2 +
4u4 w2 +38u3 vw2 +72u2 v 2 w2 +38uv 3 w2 +4v 4 w2 +2uw3 +
8u3 w3 + 2vw3 + 38u2 vw3 + 38uv 2 w3 + 8v 3 w3 + 4u2 w4 +
10uvw4 + 4v 2 w4

(4)

If three parameters u, v or w is equal to zero then the
basis functions reduce to the Wang-Ball curve. So we can
n
(u, v, w) ≥ 0
construct the Wang-Ball basis such that Wi,j,k
n
and i+j+k=n Wi,j,k (u, v, w) = 1. The calculation method
for calculate the interpolation point on this surface is
a kind of corner cutting algorithms. For each step of
interpolations, those intermediate computed points are
closer to the point on the surface which follows by
Wang-Ball basis. The evaluation of a point on a surface
can be computed by using the following recurrence of basis.

u2 +2u3 v +v 2 +4u4 v 2 +2uv 3 +8u3 v 3 +4u2 v 4 +2u3 w +
10u3 vw + 28u3 v 2 w + 2v 3 w + 10uv 3 w + 28u2 v 3 w + w2 +
4u4 w2 +28u3 vw2 +72u2 v 2 w2 +28uv 3 w2 +4v 4 w2 +2uw3 +
8u3 w3 + 2vw3 + 10uvw3 + 28u2 vw3 + 28uv 2 w3 + 8v 3 w3 +
4u2 w4 + 4v 2 w4
The contradiction between this model and a triangular-ball
surface which proposed in 1998 is deﬁne by interpolation
techniques (see Figure 2). A new model basis function has
the following properties:

1
1
(u, v, w)=u, W010
(u, v, w)=v,
Let W100
1
W001 (u, v, w) = w and r=0
For (i + j + k = n − 3r) and (i = 0 or j = 0 or k = 0)

•

242

Partition of unity:

Figure 2.

•
•

•

(Left) Triangular patches for degree 10. (Right) The contradiction between (a) a triangular-ball surface in 1998 and (b) a new model.

n
0 ≤ Wi,j,k
(u, v, w) ≤ 1
Non-negativity:
n
i+j+k=n Wi,j,k (u, v, w) = 1
Linear independence:
n
(u, v, w) = 0 for any
If sumi+j+k=n Pi,j,k Wi,j,k
(u,v,w) then Pi,j,k = 0 for i + j + k equal to n.
Symmetry:
n
n
(u, v, w) = Wi,k,j
(u, w, v)
Wi,j,k
n
= Wj,i,k (v, u, w)
n
(v, w, u)
= Wj,k,i
n
(w, u, v)
= Wk,i,j
n
(w, v, u)
= Wk,j,i

C. The interpolation matrices
The ﬁgure 3 shows the construction the interpolation
matrix. The number of columns is equal to number of small
triangle picture and the number of rows is equal to points
in picture. For example, a surface of degree 3 has 6 picture
and 10 points, thus the number of column and row are 6
and 10 respectively.
The elements of matrix can be representing by interpolation point. It equals to 1 for non-interpolate point and equal
to the parameter u,v and w for interpolate points. At last, the
number of zero-element can be found when equal to n − 1.
D. Recursive Evaluation

III. P ROPERTIES OF A N EW M ODEL BALL S URFACES

Form these relations of interpolation matrices, it easily to
derive the recursive algorithm of triangular.
Algorithm
(n)
Step1. Let Pi,j,k
Step2. For m = n − 1, n − 2, ..., 1, 0
Let r = 0
For (i + j + k = n − 3r)
and (i = 0 or j = 0 or k = 0)
- If i, j, k ≤ m−3r
2
(m)
(m+1)
Pi+r,j+r,k+r = uPi+r+1,j+r,k+r
(m+1)
(m+1)
+ vPi+r,j+r+1,k+r + wPi+r,j+r,k+r+1
Otherwise
(m)
Pi+r,j+r,k+r =
⎧
(m)
m−3r
⎪
⎪
2
⎪ uPi+r+1,j+r,k+r , for i =
⎪
⎪
⎨
(m)
(6)
vPi+r,j+r+1,k+r , for j = m−3r
2
⎪
⎪
⎪
⎪
⎪
⎩ wP (m)
.
, for j = m−3r
i+r,j+r,k+r+1
2

Many of the properties in this section are similar to the
properties of a triangular surface of Hu. The new model
representation has some important properties that make it
well suited for CAD.
A. Normality
If Pi,j,k = A for i + j + k = n
n
(u, v, w)
P(u, v, w) = i+j+k=n AWi,j,k
n
= A i+j+k=n Wi,j,k (u, v, w) = A
Conversely, if P(u, v, w) = A, we have
n
(u, v, w)
P(u, v, w) − A= i+j+k=n Pi,j,k Wi,j,k
n
− i+j+k=n AWi,j,k (u, v, w)
n
(u, v, w)
P(u, v, w) − A= i+j+k=n (Pi,j,k − A)Wi,j,k
It follows from the linear independence of the basis
functions that Pi,j,k = A for i + j + k = n. So we conclude
that, Pi,j,k where i + j + k = n degenerate to a point A if
and only if P(u, v, w) degenerates to a point A.
B. Convex Hull Property

- r=r − 1
(0)
Step3. Let P (u, v, w) = P000

Another property that geometric modelers may rely on is
that a new model surface never wonders outside its convex
hull. This follows,
Ani,j,k (u, v, w) ≥ 0 and i+j+k=n Ani,j,k (u, v, w) = 1.
Thus, every point on the curve is a convex combination
of its control nets, so it must lie within the convex hull of
the control nets.

We can evaluate the matrices in a sub-triangle. It is a dot
sequences for show every step of the interpolation. Figure
5 shows a dot in a sub-triangle indicates that a new point
uP+vQ+wR is calculated, where P, Q and R are the vertices
of smallest sub-triangle which contains the dot.
243

Figure 3.

(Left) The construction of triangular basis degree 3 from interpolation matrices. (Right) Recursive evaluation of a 6th degree surface.

Compare with the triangular ball representations in 1998
deﬁned by the same control nets. For the number of computations to calculate uP+vQ+wR for evaluating a triangular
surfcae of degree n is

Ball surfaces proposed by Hu S. M., Wang G. and Sun J. in
1998.

if n is an even number, the computations to calculate
a surface is
n
.( n +1)
( n )2 +5. n
+ 2 2 2
1 + 3 + 3 + 7 + ... + 2 22

This work was supported by the laboratory of CAGD
and Animation (CADLAB), the department of computer
engineering, KMUTT.

•

n

•

n

ACKNOWLEDGMENT

2

k(k+1)
k +5k
2
2
= k=1
+ k=1
2
2
1
3
= 4 n(n + 1)+ 8 n(n + 2)
1 3
= 24
n + O(n2 )
if n is an odd number, the computations to calculate a
surface is
n+1 n+1
( n−1 )2 +5.( n−1
(
+1)
2 )
+ 2 22
1 + 3 + 3 + 7 + 6 + ... + 2
2
1 3
= 24
n + O(n2 )

R EFERENCES
[1] F. Gerald., Curves and Surfaces for Computer Aided Geometric
Design Practical Guide, 5th edition, San Francisco: Mogan
Kaufmann Publishers, 2002.
[2] H. L. Tien., Further Development on Ball Curves and Surfaces,
Ph.D. Dissertation, Asian Institute of Technology, 1997.
[3] J. Chen., G. J. Wang. Construction of triangular DP surface
and its application. Journal of Computational and Applied
Mathematics 219: 312 - 326, 2008.

The recursive algorithm in this paper,
•

if n is an even number, the computations to calculate
a surface is
n
.( n +1)
( n )2 +5. n
+ 2 2 2
1 + 3 + 3 + 7 + ... + 2 22
n

•

[4] G. J. Wang, M. Cheng. New Algorithms for Evaluating Parametric Surface. Progress in Natural Science, Vol. 11, No. 2,
2001.

n

k(k+1)
k+5k
2
2
= k=1
+ k=1
2
2
= 18 n(n + 1)+ 38 n(n + 3)
= O(n2 )
if n is an odd number, the computations to calculate a
surface is
n+1 n+1
( n−1 )+5.( n−1 )
(
+1)
1 + 3 + 3 + 7 + ... + 2 2 2 + 2 22
= O(n2 )

[5] T. N. T. Goodman, H. B. Said. Shape-preserving properties of
the generalized Ball basis. Computer Aided Geometric Design,
8: 115-121, 1991.
[6] S. M. Hu, G. J. Wang and J. Sun. A type of triangular ball
surface and its properites. Journal of Comput. Sci.&Technol,
13(1): 63-72, 1998.
[7] A. A. Ball. Consurf I: Introduction of the conic lofting tile.
Computer Aided Design, 6(4):243-249, 1974.

The recursive algorithm of a new model surfaces is more
efﬁcient than the algorithm for triangular Ball surfaces by
Hu S., Wang G. and Sun J. Though O(n3 ) calculations are
required for evaluating a degree n surface in Hu S., forms,
but a new model surfaces requires only about quadratic
complexity of the computation of the recursive algorithm.

[8] A. A. Ball. Consurf II: Description of the algorithms. Computer
Aided Design, 7(4):237-242, 1975.
[9] A. A. Ball. Consurf III: How the program is used. Computer
Aided Design, 9: 9-12, 1977.

IV. C ONCLUSION

[10] G. J. Wang. Ball curve of high degree and its geometric
properties (in Chinese). Applied Mathematics:A Journal of
Chinese Universities, 2: 126-140, 1987.

In this paper, we propose a new type of bivariate basis on
a triangle. On each side of the triangle, these basis functions
reduce to the univariate Wang-Ball basis. We also present a
recursive algorithm for evaluation and its properties. The
recursive algorithm for evaluation presented in this paper is
more efﬁcient than the algorithm for evaluating triangular
244


A Novel Adaptive Sampling by Tsallis Entropy
Qing Xu
School of Computer Science and Technology
Tianjin University, Tianjin 300072, China
qingxu@tju.edu.cn
Lianping Xing
School of Computer Science and Technology
Tianjin University, Tianjin 300072, China
lp xing@yahoo.com.cn

Mateu Sbert
Institute of Information and Applications
University of Girona, Girona 17003, Spain
mateu@ima.udg.es
Jianfeng Zhang
School of Computer Science and Technology
Tianjin University, Tianjin 300072, China
zhangjianfeng.1@163.com

Contact author:Qing Xu
address:School of Computer Science and Technology
Tianjin University, Tianjin 300072,China
Abstract
Monte Carlo is the only choice of physically correct
method to compute the problem of global illumination in
the field of realistic image synthesis. Adaptive sampling
is an appealing tool to eliminate noise, which is one of
the main problems of Monte Carlo based global illumination algorithms. In this paper, we investigate the use of
entropy in the domain of information theory to measure
pixel quality and to do adaptive sampling. Especially we
explore the nonextensive Tsallis entropy, in which a real
number q is introduced as the entropic index that presents
the degree of nonextensivity, to evaluate pixel quality. By
utilizing the least-squares design, an entropic index q can
be obtained systematically to run adaptive sampling effectively. Implementation results show that the Tsallis entropy
driven adaptive sampling significantly outperforms the existing methods.
Keywords—Adaptive sampling ; Monte Carlo ; Tsallis entropy ; global illumination

1

Introduction

Global illumination plays an important role in realistic image synthesis, and Monte Carlo based algorithms are
the unique choice of physically correct methods to compute the problem of global illumination [10]. The general Monte Carlo global illumination methods, including
both the view dependent solutions and the final gathering
schemes involved in Photon Mapping [11] , usually employ
the baseline Monte Carlo ray tracing (MCRT) [12] to produce the synthetic images pixel by pixel. MCRT uses sample paths through a pixel to calculate the pixel value by av-

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007

eraging the sample values, namely the light transport contributions of sample paths. Generally, MCRT gives very
noisy images when inadequate samples are used because of
the slow convergence of the Monte Carlo techniques. Taking a large enough number of samples for each pixel can
render images without noise, but it is too time consuming.
Adaptive sampling, which is an interesting tool to lower
the global noise level of the synthesized image without using a fixed number of samples per pixel, means to use more
samples for the high noisy pixels discovered by some refinement criterion. That is, a few samples are taken at first
for a pixel, and then the dedicated refinement criterion or
the pixel quality is derived from these samples to determine
whether super sampling is needed or not. The pixel quality
estimated from the pixel’s sample values is the point to do
adaptive sampling. Actually, homogeneity of the pixel’s
sample values is the key to feature the pixel quality, due
to the stochastic nature of the Monte Carlo estimation of
sample values. Inhomogeneity or variability should lead to
further sampling. In fact, the difficulty with adaptive sampling is how to locate all of the pixels where more samples
are needed because the uniformity or homogeneity found
by the pixel’s sample values could not tell us the exact situation with certainty. Since entropy is a good measure of
uncertainty, disorder, dispersion and variation [6], it is instinctive for us to resort to the use of entropy based pixel
quality measurement and adaptive sampling. In particular,
some certain correlation among a pixel’s samples, which
can be well handled by Tsallis’ nonextensivity [1], prompts
us to take advantage of Tsallis entropy [26, 27] to develop
an innovative approach. The entropic index characterizes

the nonextensive degree of Tsallis entropy. A least-squares
design is employed to estimate an entropic index to do
Tsallis entropy driven pixel quality evaluation and adaptive
sampling. Experimental results show that our new method
can perform much better than the existing approaches.
The remainder of this paper is organized as follows. In
section 2, previous work on adaptive sampling is described.
In section 3, a novel pixel quality measurement method
directed by Tsallis entropy is developed and detailed. A
least-squares design to get an entropic index of Tsallis entropy is depicted in section 4. In section 5, the procedure of
adaptive sampling by using Tsallis entropy is outlined. Implementation and some results are demonstrated in section
6. Finally, conclusion and some future work are presented.

2

Related work

Adaptive sampling can be traced back to the research on
anti-aliasing in ray tracing [29], for example, Painter and
Sloan [17] presented adaptively progressive refinement on
the entire image plane to locate image features and place
more samples along edges. Here we are going to focus
on the pixel based approach in the context of Monte Carlo
global illumination. Based on the root mean square signal to noise ratio (RMS SNR), Dippe and Wold [7] proposed an error estimate of the mean to do adaptive sampling. Lee et al. [15] sampled the pixel adaptively based
on the variance of sample values. Purgathofer [19] used
the confidence interval for adaptive sampling. Kirk and
Arvo demonstrated a correction scheme to avoid the bias
of variance based approaches. Rigau et al. [20, 21, 22] introduced the Shannon entropy and also the f-divergences as
the measure to conduct adaptive sampling. Mitchell [16],
and later Simmons and Sequin [23] utilized the contrast to
do adaptive sampling. Tamstorf and Jensen [25] refined
Purgathofer’s approach to propose the tone operated confidence interval. Bolin and Meyer [5] developed a vision
model based approach.

3
3.1

Tsallis entropy driven pixel quality
Correlation among pixel’s samples and Tsallis’ nonextensivity

A pixel’s taken samples, which are used for estimating the pixel quality, are the basic elements to do adaptive sampling. The pixel quality evaluation is not so easy
because the sample values are taken independently and calculated stochastically by Monte Carlo. And consequently,
the pixel quality measurement is of great uncertainty. Entropy, which is defined in information theory to score the
uncertainty [6], can be made use of to give a good pixel
quality estimate. Entropy is more powerful to characterize
the variation than some intuitive measures, such as variance and contrast. In fact, entropy not only can depict
the variability of samples very well, but also can charac-

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007

terize the complex interaction of samples [9]. For example, the classic Shannon entropy has been demonstrated
to do adaptive sampling successfully [20, 21], since the
application of Shannon entropy in computer graphics for
Monte Carlo radiosity [8]. Note that the taken samples
within a pixel behave themselves with strong correlation
due to the similarity of the light transport paths assigned
for these samples. As a matter of fact, the pixel samples
are originally traced from the same object probably, and
the corresponding similar light transport paths are used
to calculate the sample values. These sample values exhibit strong correlation in radiance levels. The correlation
among the pixel’s samples are always present. Therefore,
an appropriate pixel quality measure should quantify the
homogeneity of sample values with the consideration of
the correlation among sample values. Fortunately,Tsallis
entropy, which is capable of coping with correlation [1],
is our suitable choice to do pixel quality evaluation. Actually, nonextensivity is the distinct feature of Tsallis entropy
[2, 3, 18], when compared with various other entropy definitions [13]. Correlation is directly managed and induced
by Tsallis’ nonextensivity [1]. It is the capability of handling correlation that makes Tsallis entropy as the reasonable selection to execute pixel quality evaluation and adaptive sampling. In addition, we refer ourselves to Tsallis
entropy since it is widely used in many practical applications. For example, Tsallis himself maintains quite a lot of
references, which succeed to make use of Tsallis entropy
in numerous professional domains Let X = {x1 , . . . , xn }
be a discrete random variable with n different values, and
let P = {p1 , . . . , pn } be the probability distribution, and
n = |X|. Tsallis entropy, which conveys the uncertainty
or the average probabilistic likelihood of the distribution,
is defined as [26]:
n

HqT (X) =

1
(1 −
pqi )
q−1
i=1

(1)

where q is called as entropic index, q = 1. When q → 1,
Tsallis entropy tends towards Shannon entropy. HqT (X) is
a concave function of p for q > 0, and it takes its maxiT
= logq n. Here
mum value for the equiprobability Hq,max
1
1−q
− 1)(x > 0) is the q-logarithmic
logq x = 1−q (x
function tending to the ordinary logarithmic function in the
limit q → 1. The correlation, induced by the nonadditivity (nonextensivity) of Tsallis statistics, is always existing
[1, 2, 3]. The nonextensivity or composability, which is
satisfied by the Tsallis entropy, is exemplified with a bipartite system (A, B) as follows [3]:
HqT (A, B) = HqT (A)+HqT (B|A)+(1−q)HqT (A)HqT (B|A)
(2)
where HqT (B|A) is the conditional Tsallis entropy [28].
The entropic index q gives the degree of Tsallis’ nonexten-

sivity. Owing to the nonextensivity, it appears that correlation is always present. The q is an indicator of the amount
of correlation that can be introduced into the entropy measure.

3.2

Tsallis entropy based pixel quality

We take advantage of Tsallis entropy to measure the homogeneity of the information provided by the set of path
samples passing through a pixel. We use luminance to describe sample and pixel value. The pixel Tsallis entropy is
defined:
n
1
(1 −
pqj )
(3)
HqT =
q−1
j=1
T
Hq,max
=

1
(n1−q − 1)
1−q

(4)

adaptive sampling. But the q selection, which is usually
done heuristically by experiments, is still an open problem
for the Tsallis entropy’s applications [24, 4]. In this paper, we develop an effective method, which is embedded
seamlessly in the procedure of adaptive sampling, to compute a proper entropic index by a least-squares estimation.
By the minimization of the error between two entropies for
the two halves of samples within a pixel, we get the Tsallis
entropic index.

4.1

n

sj
n
j=1 sj

QTq

4

HqT
= T
=
Hq,max

n
q
j=1 pj −
n1−q − 1

i=1
n

1

(6)

i=1

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007

(7)

HqT
HqT 2
−
]
T
T
Hq,max
Hq,max

In order to do the minimization of E(q) easier, the secondn
order Taylor-Series approximations of j=1 pqj and n1−q .
T
, HqT and
So we get the approximated HqT , Hq,max
T
Hq,max
:
HˆqT = −[

n/2

q−1
2!

pj ln pj +
j=1

n/2

pj (ln pj )2 ]

(8)

j=1

1−q
Tˆ
(ln (n/2))2
= ln (n/2) +
Hq,max
2!

(9)

ni

HˆqT = −[

pj ln pj

(10)

j=(n/2+1)

+

q−1
2!

ni

pi,j (ln pj )2 ]

j=(n/2+1)

Tˆ
Tˆ
Hq,max
= Hq,max

(11)

Finally E(q) is approximated by
ˆ =
E(q)

n

[
i=1

HˆqT
H Tˆ

−

q,max

HˆqT
H Tˆ

]2

(12)

q,max

ˆ with respect to q, and set
We take the derivative of E(q)
this term equal to zero and solve for q. Finally, we obtain
an entropic index:

A least-squares design for the entropic index

In practice, the Tsallis entropic index q, which is problem dependent, plays an important role to make the Tsallis entropy based solutions usable. It is essential to get an
appropriately single q to do pixel quality evaluation and

[

=

(5)

sj is the luminance value of the jth sample path. Since pj
is the proportion between an individual sample value and
the sum of all the sample values, the average probabilistic
likelihood given by HqT represents the homogeneity of the
pixel’s sample values, or the pixel quality. The more probability the HqT gives, the more homogeneous the samples
are and the bigger the pixel quality is. The pixel Tsallis
entropy achieves the maximum when all the samples take
the same value. Furthermore, the pixel Tsallis entropy’s
nonextensivity, which is characterized by the entropic index q, makes HqT depict the correlation among the pixel
samples very well. The bigger the difference between q
and 1 is, the more correlation HqT contains. This can be
easily obtained by the analysis of Equation 2. Furthermore, if the q is set to be larger than 1 then the Tsallis
entropy driven pixel quality measure to be more discriminating, and vice versa. Because pixel value may be estimated from any number of passing paths, the pixel value
entropy should be normalized with its maximum for the
sake of scoring the pixel quality correctly. So, the pixel
Tsallis quality for each spectral channel is:

[QTq − QTq ]2

E(q) =

where n is the number of sample paths through the pixel.
Here pj refers to the fraction of a path with respect to the
sum of all the values :
pj =

Least-squares design

The entropic index is derived by minimizing the total
squared error between QTq and QTq , which refer to the two
entropies for the two halves of samples within a pixel. The
total squared error is given by

q =1−

n
i=1 XY
n
2
i=1 Y

+ log (n/2)X
+ log (n/2)X

(13)

where
n/2

X=

n

pj logpj −
j=1

pj logpj
j=(n/2+1)

(14)

n/2

pj (logpj )2 −

Y =
j=1

n

pj (logpj )2

(15)

j=(n/2+1)

To generate images with adaptive sampling we always
need a batch of initial samples to do the beginning pixel
quality evaluation. A few of these initial samples are also
be used in the least-squares estimation to compute the Tsallis index q. The n, which appears in the above Equations 715, is actually the number of samples used for q evaluation.
In this way, we obtain an systematical approach to choose
an appropriate entropic index to Tsallis entropy, and to perform pixel quality measurement and adaptive sampling.

5

Adaptive sampling by using Tsallis entropy

The pixel quality measure and the least-squares estimation of index q described above are all incorporated into the
Monte Carlo Global Illumination based adaptive sampling.
This is, a first batch of pilot samples is used for each pixel
to estimate the Tsallis entropic index and to compute the
pixel quality. More batches are employed if the pixel quality is not larger than the predefined threshold, and these
successive batches will improve the pixel quality. The applied adaptive super sampling procedure is outlined as follows: ST EP 1. Stochastically distributed n samples at a
pixel are taken. The sample values Li (1 ≤ i ≤ n) are
evaluated to estimate the Tsallis entropic index q (see the
Equations 13-15, here n = 32).
ST EP 2. NInit − n stochastically distributed samples at
a pixel are taken and evaluated. The values Li (1 ≤ i ≤
NInit ) of the initial batch of NInit samples are used to
compute the pixel quality Q (see the Equations 3-6, here
the number of pixel’s samples n = NInit ).
ST EP 3. The conditional test
Q > T hreshold

(16)

which is used for the refinement decision, is operated.
Where T hreshold is the predefined threshold, which is
used to control whether the super sampling is terminated
or not.
ST EP 4. Consecutive batches of NAdd additional samples are introduced until the conditional test is valid. The
number of samples is changed by
n = n + NAdd

(17)

whenever a batch of NAdd additional samples is used.

6

Implementation and results

We have implemented the new adaptive sampling
scheme based on MCRT. We compare our method with
other existing approaches: the contrast [23, 16], the variance [19, 25], the pixel color Shannon entropy [20, 21]

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007

and the f-divergences [22] based methods. Although there
are several f-divergences used in [22], we only use the
square root of Hellinger distance, which behaves the best
in all of the f-divergences by a lot of our experiments, to
demonstrate the results of the f-divergence method. Two
test scenes, Conference-room and Sponza are used for the
comparisons. The reference images of the two test scenes,
which are generated by MCRT using 10000 and 40000
samples per pixel, are used to judge the quantitative magnitude of errors for the images created by different algorithms. The quantitative error metric is the root mean
square (RMS). The values of Tsallis index q, which are
systematically obtained and used in our Tsallis adaptive
sampling for the two test scenes, are 3.11 and 2.95 respectively. In all the algorithms, 32 initial sample paths are cast
in a stochastic way at each pixel to compute the pixel qualities for the refinement decision, and 8 and 15 additional
samples for the two scenes are successively added until the
conditional test is fulfilled.
The images with 300 × 180pixels for the test scene
Conference-room created by different algorithms are
demonstrated in Figure 1. An overall superior image quality resulted from the new method is evident.
The images with 250 × 250 pixels for the Sponza scene
created by 5 algorithms with average 300 samples per pixel
are demonstrated in Figure 2. The new scheme gives far
smoother images than the other methods. Our method exhibits the best image quality in all the complex parts of the
scene. For example, the noise reductions attained at the
roof, the floor, the low wall, the indirectly illuminated pillars and the shadow regions are apparent.
Table 1 presents the RMS errors of the resulting images,
shown in Figure 1 and Figure 2 respective to the reference
images for two scenes. All of our visual results are consistent with the quantitative RMS analysis: our novel approach acts much better than others. From the above quantitative comparisons and visual impressions, we can speak
that our novel approach performs large better than other
existing algorithms.

7

Conclusions and future work

We have presented a new adaptive sampling scheme
based on Tsallis entropy with the systematically selected
entropic index. The pixel quality measured by Tsallis entropy is sensitive and discriminating. The results obtained
by our method show a quite large improvement on error reduction over the existing approaches. Our new approach is
biased, as most of the current adaptive sampling methods
[14]. We will investigate the bias estimation in the context
of entropy in the near future.

Tsallis

reference

contrast

variance

Shannon

f-divergence

Figure 1: Resulting images for the Conference-room scene. 10000 samples per pixel are used for MCRT to produce the
reference image. An average of 100 samples per pixel are used for the adaptive based images.
Table 1: The average RMS reductions by the novel method over the other approaches for the two scenes
Scene
RMS reduction over
Shannon contrast variance f-divergence
Conference-room
80.28% 82.80% 79.92%
75.34%
57.26% 57.82% 57.04%
54.89%
Sponza

8 ACKNOWLEDGEMENT
This work has been supported by the Scientific Research Foundation for the Returned Overseas Chinese
Scholars, State Education Ministry grant D4200407, Tianjin Natural Science Foundation grant 06YFJMJC00400,
National Natural Science Foundation of China grant
60572169 and Tianjin Natural Science Foundation grant
05YFJMJC09200. Mateu Sbert is supported by grant number TIN2004-07451-C03-01 from Spanish government.

References

[6] Thomas M. Cover and Joy A. Thomas. Elements of
Information Theory. Wiley, 1991.
[7] Mark A. Z. Dippe and E. H. Wold. Antialiasing
through stochastic sampling. 19(3):69–78, July 1985.
[8] Miquel Feixas, Esteve Acebo, Philippe Bekaert, and
Mateu Sbert. An information theory framework for
the analysis of scene complexity. Computer Graphics Forum, 18(3):95–106, 1999.

[1] S. Abe. Correlation induced by tsallis’ nonextensivity. Physica A, 269:403–409, 1999.

[9] D. P. Feldman and J. P. Crutchfield. Statistical measures of complexity: Why?
Physics Letters A,
238(4/5):244–252, 1998.

[2] S. Abe. Tsallis entropy: how unique? Continuum Mechanics and Thermodynamics, 16(3):237–
244, Mar 2003.

[10] Donald P. Greenberg. A framework for realistic image synthesis. Communications of the ACM, 42(8),
Aug 1999.

[3] S. Abe. Axioms and uniqueness theorem for tsallis
entropy. Physica Letters A, 271:74–79, 2004.

[11] H. W. Jensen. Realistic Image Synthesis Using Photon Mapping. A. K. Peters, 2001.

[4] M. P. Albuquerque, I. A. Esquef, A. R. G. Mello, and
M. P. Albuquerque. Image thresholding using tsallis entropy. Pattern Recognition Letters, 25(9):1059–
1065, July 2004.

[12] J. T. Kajiya. The rendering equation. Computer
Graphics, 20(4):143–150, 1986.

[5] Mark R. Bolin and Gary W. Meyer. A perceptually
based adaptive sampling algorithm. Proceedings of
SIGGRAPH’98, pages 299–309, July 1998.

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007

[13] J.N. Kapur and H.K. Kesavan. Entropy Optimization
Principles with Applications. Academic Press, 1992.
[14] David Kirk and James Arvo. Unbiased variance
reduction for global illumination. Proceedings of

Tsallis

reference

contrast

Shannon

variance

f-divergence

Figure 2: Resulting images for the sponza scene. 40000 samples per pixel are used for MCRT to produce the reference
image. An average of 300 samples per pixel are used for the adaptive based images.
the 2nd Eurographics Workshop on Rendering, May
1991.
[15] Mark E. Lee, Richard A. Redner, and Samuel P. Uselton. Statistically optimized sampling for distributed
ray tracing. In SIGGRAPH ’85: Proceedings of the
12th annual conference on Computer graphics and
interactive techniques, pages 61–68, 1985.
[16] D. P. Mitchell. Generating antialiased images at low
sampling densities. 21(4):65–72, 1987.
[17] J. Painter and K. Sloan. Antialiased ray tracing
by adaptive progressive refinement. 23(3):281–288,
1989.
[18] A. Plastino. Why tsallis’ statistics?
344:608–613, 2004.

Physica A,

[19] W. Purgathofer. A statistical method for adaptive
stochastic sampling. 11(2):157–162, 1987.
[20] Jaume Rigau, Miquel Feixas, and Mateu Sbert. New
contrast measures for pixel supersampling. Proceedings of CGI’02, pages 439–451, July 2002.

[23] Maryann Simmons and Carlo Sequin. Tapestry: A
dynamic mesh based display representation for interactive rendering. Proceedings of the 11th Eurographics Workshop on Rendering, 2000.
[24] R. Smolikova, M. P. Wachowiak, and M. Zurada.
An information-theoretic approach to estimating ultrasound backscatter characteristics. Computers in
Biology and Medicine, 34:355–370, 2004.
[25] R. Tamstorf and H. W. Jensen. Adaptive sampling
and bias estimation in path tracing. (Proc. of Eurographics Workshop on Rendering ’97), pages 285–
295, 1997.
[26] C. Tsallis. Possible generalization of boltzmanngibbs statistics.
Journal of Statistical Physics,
52:479–487, 1988.
[27] C. Tsallis and E. Brigatti. Nonextensive statistical
mechanics: A brief introduction. Continuum Mechanics and Thermodynamics, 16(3):223–235, Mar
2004.

[21] Jaume Rigau, Miquel Feixas, and Mateu Sbert.
Entropy-based adaptive sampling. Proceedings of
GI’03, June 2003.

[28] C. Tsallis, R.S. Mendes, and A.R. Plastino. The role
of constraints within generalized nonextensive statistics. Physica A, 261:534–554, 1998.

[22] Jaume Rigau, Miquel Feixas, and Mateu Sbert. Refinement criteria based on f-divergences. Proceedings
of Eurographics Symposium on Rendering 2003, June
2003.

[29] T. Whitted. An improved illumination model for
shaded display. (Communications of the ACM),
32(6):343–349, 1980.

Computer Graphics, Imaging and Visualisation (CGIV 2007)
0-7695-2928-3/07 $25.00 © 2007


Detecting Microcalcification Clusters in Digital Mammograms Using Combination of
Wavelet and Neural Network
*

Gholamali Rezai-rad, **Sepehr Jamarani
Associated professor,**Graduate student in Biomedical Eng.
Islamic Azad University Technical Research & Development Dept.
rezai@iust.ac.ir jamarani@shemroon.com
*

this reason, a reliable automated computer-aided diagnosis
system (CAD) could be very useful, providing a valuable
‘‘second opinion’’ to a radiologist, especially to a nonexpert one [9,10]. Nevertheless, the application of CAD
systems in clinical use should be done after extensively
high assessments of their effectiveness in terms of
sensitivity and reduction of false positive rate.
In the literature, several techniques have been proposed
to detect the presence of microcalcifications using various
methodologies. Concerning image segmentation and
specification of regions of interest (ROIs), several methods
have been proposed such as classical image filtering and
local thresholding [11,12,13], techniques based on
mathematical morphology [14,15], stochastic fractal models
[16,17], wavelet analysis [18,19,20,21] and multiscale
analysis based on a specialized Gaussian and eitgen [22].
Furthermore, various classification methodolo-gies have
been reported for the characterization of ROI such as, rulebased systems [11,12], fuzzy logic systems [23], statistical
methods based on Markov random fields [24] and support
vector machines [25]. Nevertheless, the most work reported
in the literature employs neural networks for cluster
characterization [26,27,28]. Typically, a neural network
accepts as input features computed for a specific region of
interest and provides as output a charac-terrizeation of the
region as true microcalcification cluster or not. Recently,
neural networks have also been used to characterize a
microcalcification as malignant or benign [6,29,30].
In this study, we present an system for the identification
of microcalcification clusters in digitized Mammographic
images. As the microcalcifications correspond to highfrequency components of the image spectrum, detection of
microcalcifications is achieved by decomposing the mammograms into different frequency subbands, suppress-ing the
low-frequency subband,a and finally , reconstructing the
mammogram from the subbands containing only high
frequencies. We use these results as an input of neural
network for classification. The neural network contains one
input, two hidden and one output layers. Layers have 30, 45,
20, and 1 neurons respectively. A neural network is a set of
connected input/output units where each connection has a
weight associated with it. During the learning phase, the
network learns by adjusting the weights so as to be able to
predict the correct class of the input samples. The back
propagation algorithm performs learning on a multilayer
feed-forward neural network.

ABSTRACT
This paper presents an approach for detecting
microcalcification in digital mammograms employing
combination of artificial neural networks (ANN) and
wavelet-based subband image decomposition. The
microcalcifications
correspond
to
high-frequency
components of the image spectrum, detection of
microcalcifications is achieved by decomposing the
mammograms into different frequency subbands,
suppressing the low-frequency subband, a and finally,
reconstructing the mammogram from the subbands
containing only high frequencies. We use these results as
an input of neural network for classification. The neural
network contains one input, two hidden and one output
layers. Layers have 30, 45, 20, and 1 neurons respectively
The proposed methodology is tested using the Nijmegen
and the Mammogr-aphic Image Analysis Society (MIAS)
Mammographic databases. Results are presented as the
receiver operating characteristic (ROC) performance and
are quantified by the area under the ROC curve (Az)
Key words: Breast cancer, neural networks, diagnosis,
wavelet, microcalcification

1. Introduction
Breast cancer is currently one of the leading causes of
death among women worldwide. Regular Mammographic
screening programs for women of certain age or high-risk
groups are taking place in a number of countries on a
nationwide basis or as projects organized from several
institutes [1,2,3,4]. Although some researchers doubt about
the real effectiveness of population screening programs [5]
the majority of them contribute to the mortality reduction
[6,7]. Early detection is the key for improving breast cancer
prognosis. Mammography is the most common procedure
for detecting non-palpable cancers. It is an inexpensive
practice being highly effective even when the size of the
breast abnormality is minimal [8]. One of the early signs of
breast cancer is the presence of microcalcification clusters
at the mammogram of asymptomatic women. However, a
number of such findings especially the microcalcifications
that have small size and low contrast could be missed or
misinterpreted by doctors. Thus, the task of the radiologist
is tedious in the case where a significant number of
mammograms require fast and accurate interpretation. For

1

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

filter bank, instead of O ( N 2 ) operations, which follows
from equation (2).

2. Material and methods
2.1. Wavelet
Among other linear transforms, wavelets have a number
of useful properties: they can successfully represent smooth
functions, as well as singularities; expansion functions are
local - so the algorithms based on wavelet coefficients are
adaptive to inhomogeneities; wavelets are computationally
inexpensive and near optimal for statistical estimation,
signal recovery and data compression.
Discrete time wavelet transform expands analyzed signals
into components with different shifts and scales, where
scales are usually chosen from a dyadic set:

H(z2), H(z4), H(z8), ... can be easily realized by inserting
zeros between samples of h(k) in the time domain
("Algorithm á trous"). Most of numerical simulation
software tools spend processor's time even for
multiplications by zero, so we rather use recursive
subsampling-upsampling structure illustrated in the
Following figure:

(1)
Hence, \ mn are shifted, expanded or shrank versions of a
mother wavelet ҠҏMother wavelet function ҏis typically
chosen to achieve desired localization properties in time
and frequency domain. There are many choices of wavelets
that lead to orthogonal or biorthogonal expansions, some of
them realizable by FIR perfect reconstruction wavelet filter
banks. The number of calculated wavelet coefficients
decreases with enlarged scale, which corresponds to
decimation in wavelet filter banks

The last branch filters in recursion structure are H(z),
applied to l-times decimated input. In the linear phase
case, symmetry of coefficients can be used to reduce the
number of multiplications (by factor of 2 or 4, for 1-D or 2D case, respectively).Shift-invariant wavelet expansion can
be easily extended to the two-dimensional (2-D) case:
The single level expansion results in 3 "details" images:dHH,
dHL, and dLH, (shorter: HH, HL, LH) covering Independent
bands in the frequency domain. The "approximation" aLL
(or LL) is a low-pass component, which is passed to the
next level of decomposition.

H and L filters are related to mother wavelet ҏand its
associated scaling function ҏrespectively, while "detail"
coefficients d1, d2, dn, ... correspond to the wavelet
coefficients in different scales (m=0, 1, ...). The set of
wavelet coefficients for orthogonal or biorthogonal
decompositions is minimum size, equal to the length of
analyzed signal x. The number of necessary calculations is
O(N), which is computationally very inexpensive when
compared to other linear transforms. On the other hand,
such wavelet coefficients are shift dependent, in the sense
that time shifts of the original signal result in different sets
of wavelet coefficients, with different statistical properties.
That fact has been noticed as a significant drawback,
Especially in detection problems, as well as in de-noising
and compression applications. All-shifts DWT expansion is
redundant, but shift-invariant in the previously mentioned
sense:
(2)
By calculating all shifts, orthogonal expansions turn to
frames, withholding reconstruction properties. Frames (due
to their redundancy) bring numerical robustness
[Daubechies, 1992], which will show its value in nonlinear
wavelet coefficient processing. [Beylkin, 1992] has shown
that the order of computation can be reduced to O (N log N)
operations using corresponding non-decimated wavelet

2

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

Among the algorithms used to design the MLPs, the back
propagation algorithm is the most popular one. There are
two different phases, the forward phase and the backward
phase in to back propagation algorithm. In the forward
phase, the input signals are computed and passed through
the neural network layer by layer. Then the neurons in
output layer products the output signals of the neural
network. In this time, the error signals can be generated by
comparing the output response of the neural network with
the desired response. In the backward phase of the back
propagation algorithm, some free parameters are able to be
adjusted referring the error signals. This work can be used
to minimize the distortion of the MLP. In this work, the
back propagation learning algorithm is iteratively executed
for the training set and then products the synaptic weight
vectors.

3. Database
We used a mammogram database developed by N.
Karssemeijer in the University Hospital Nijmegen, the
Netherlands Mammographic Image Analysis Society
(MIAS). The mammograms were recorded with a Kodak
MIN-R/SO 177 screen/(lm combination. An Eikonix 1412
CCD camera was used to digitize the images. The spatial
resolution was set to be 2048 by 2048 pixels per image with
a gray-level resolution of 12 bits per pixel. There are 66
mammograms in the database taken from 32 different
patients there are a total of 196 microcalcification clusters,
63 benign and 133 malignant cases, in the database with
varying sizes and visibility. Containing microcalcification
clusters with different visibility, this database is a good
representative of clinical cases.

2.2. Preprocessing and segmentation module
In a typical mammogram several different areas are
present such as the image background, the tissue area, and
informative marks. At the beginning of preprocessing it is
necessary to locate the breast region. For this reason we
apply a skin-line segmentation procedure by setting equal
to zero the image pixels with intensity less than 20 (for 0–
255 Gray levels). Most of those pixels belong to the
background area, although a small
Number exists belonging to the tissue area close to the
breast surface. The results are shown in figure 6.

4. ROC curves
The ROC receiver operating characteristic curve is a
plot of the sensitivity against one minus the specificity for
different values of the threshold. Comparison is usually in
terms of the area under the curve, which gives a summary
of performance over the whole range of values and is
independent of the prevalence of the condition unlike the
accuracy, which weights the sensitivity and specificity in
proportion to their prevalence. It measures the probability
that for any pair of patients, one of whom with an event and
one without, the patient for whom the event has occurred
will have a higher predicted probability of the event than
the other.

(a)
(b)
(c)
(d)
Figure6. (a)(c) The original mammograms (b)(d) localized breast border

5. Classification module

2.3. Multilayer perceptron(MLP)

In order to specify the features that will be used as
inputs to the classification system, at first 62 features are
identified and computed characterizing either an individual
microcalcification (object) or a group of them in a specific
ROI. Those features fall into three categories related with
the intensity, shape and texture properties of each object
The selection of the five largest microcalcifications is made
since a very small microcalcification does not have enough
pixels for reliable feature value computation [4].

A MLP model contains one or more hidden layers and
the function of neurons on the hidden layer is to arbitrate
between the input and the output of neural network. The
input feature vector is fed into the source nodes in the input
layer of the neural network at first. The neurons of the input
layer constitute the input signals applied to the neurons of
the hidden layer. The output signals of the hidden layer can
be used as inputs to the next hidden layer or the output
layer. Finally , the output layer products the output results
and terminates the neural computing process.

3

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

Figure8. Microcalcification detection system

(b)

(b)

(c)

(d)

Figure10.(a) is the ROC curve for biorthogonal wavelet .(b) is the
ROC curve for coifletl wavelet (c) is the ROC curve for daubichies
wavelet (d) is the ROC curve for symlet wavelet

Since the number of the computed features is quite
large and their discriminative power varies, a feature
validation together with feature selection procedure is
applied. The receiver operating characteristic (ROC) curve
is plotted for each feature and the area Az under the ROC
curve is computed.

(a)

(a)

6. Conclusion
A intelligent system has been developed for the
identification of microcalcification clusters in digitized
mammograms. The method employs wavelet and neural
network. We tested our system in the Nijmegen and the
MIAS Mammographic databases with satisfactory results.
The achieved classification specificity is 1.76 and 1.12 false
positive clusters per image, for the Nijmegen and MIAS
dataset, respectively, at the sensitivity level of about 0.94.
Although the achieved performance is satisfactory further
studies should be done in the elimination of falsely detected
objects with line structure that are in most cases not
originating from parenchymal microcalcifications. Further
testing has to be performed concerning the use of other
databases as well as of original mammograms obtained
from the clinical routine of the collaborating hospitals or
screening population projects. Finally, future work will also
be directed towards the construction of a classification
system that will perform discrimination between benign and
malignant microcalcification clusters.

(c)

(d)
(e)
Figure 9. (a) the original mammogram with micro calcification(b) Result
from using daubichies wavelet (c) Result using symlet wavelet(d)using
biorthogonal wavelet(e) using coiflet wavelet

References
[1] Alexander FE, Anderson TJ, Brown HK, Forrest AP, Hepburn
W, Kirkpatrick AE, et al. Fourteen years of follow-up from the
Edinburgh randomised trial of breast-cancer screening. Lancet
1999; 353:1093–108.
[2] Fracheboud J, de Koning HJ, Beemsterboer PM, Boer R,
Hendriks JH, Verbeek AL, et al. Nation-wide breast cancer
screening in the Netherlands: results of initial and subsequent
screening 1990–1995. Int J Cancer 1998;75:694–8.
[3] Miller AB, Baines CJ, To T, Wall C. Canadian national breast
screening study. 1. Breast cancer detection and death rates among
women aged 40–49 years. Can Med Assoc J 1992;147:1459–76.
[4] Miller AB, Baines CJ, To T, Wall C. Canadian national breast
screening study. 2. Breast cancer detection and death rates among
women aged 50 to 59 years. Can Med Assoc J 1992;147:1477–88.
[5] Gotzsche PC, Olsen O. Is screening for breast cancer with
mammography justifiable? Lancet 2000;355:129–34.
[6] Quinn M, Allen E. Changes in incidence of and mortality from
breast cancer in England and Wales since introduction of
screening. Br M J 1995;311:1391–5.
[7]Van den Akker-van Marle E, de Koning H, Boer R, van der
Maas P. Reduction in breast cancer mortality due to the
introduction of mass screening in The Netherlands: comparison
with the United Kingdom. J Med Screen 1999;6:30–4.
[8] Schmidt RA, Nishikawa RM. Digital screening mammography.
Principles Practice Oncol 1994;8:1–16.
[9] Nishikawa RM, Schmidt RA, Papaioannou J, Onsis R,
Haldemann Heusler RA, Giger ML, et al. Performance of a

It must be noted that most of the selected features
correspond to the Mammographic characteristics that
radiologists examine during a diagnostic procedure such as
shape, density, size, distribution of the examined group or
individual objects. In the next step of the classification
module the selected features are fed into a neural network
classification system. The neural network that is used for
characterisation is a feed forward neural network with
sigmoid hidden nodes (Multiplayer Perceptron—MLP). In
order to select an appropriate architecture (number of
hidden layers and hidden nodes per layer) several networks
were tested with one or two hidden layers and different
number of hidden nodes [36].

4

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

[28] Nigel RH, Nishikawa RM, Papaioannou J, Doi K. Analysis of
methods for reducing false positives in the automated detection of
clustered microcalcifications in mammograms. Med Phys
1998;25(8):1502–6.
[29] Lee SK, Lo CS, Wang CM, Chung PC, Chang CI, Yang CW,
et al. A computer-aided design mammography screening system
for detection and classification of microcalcifications. Int J Med
Inform 2000;60:29–57.
[30] Veldkamp W, Karssemeijer N, Otten JDM, Hendriks JHCL.
Automated classification of clusteredmicrocalcifications into
malignant and benign. Med Phys 2000;27(11):2600–8.
[31] Betal D, Roberts N, Whitehouse GH. Segmentation and
numeral analysis of microcalcifications on mammograms using
mathematical morphology. Br J Radiol 1997;70(9):903–17.
[32] Papadopoulos A, Fotiadis DI, Likas A. A hybrid neural
method for microcalcification cluster detection in mammography.
In: The Proceedings of 4th International Conference on Neural
Networks and Expert Systems in Medicine and Healthcare, Milos
Island, Greece, 20–22 June 2001. p. 90–6.

prototype clinical intelligent mammography workstation, ’96. In:
Doi K, Giger ML, Nishikawa RM, Schmith RA, editors. Digital
mammography. Amsterdam: Elsevier, 1996. p. 93–6.
[10] Roehrig J, Doi T, Hasegawa A, Hunt B, Marshall J,
Romsdahl H, et al. Clinical results with R2 ImageChecker system,
Digital mammography. In: Karssemeijer N, Thijssen M, Hendriks
J, van Erning L, editors. Dordrecht: Kluwer academic Publishers;
1998. p. 395–400.
[11] Chan HP, Doi K, Galhotra S, Vyborny CJ, MacMahon H,
Jokich PM. Image feature analysis and computer aided diagnosis
in digital radiography. 1. Automated detection of
microcalcifications in mammography. Med Phys 1987;14:538–48.
[12] Davies DH, Dance DR. Automated computer detection of
clustered calcifications in digital mammogram Phys Med and Biol
1990;35(8):1111–8.
[13] Qian W, Clarke LP, Kallergi M, Li H, Velthuizen R, Clark
RA, et al. Tree-structured nonlinear filter and wavelet transform
for microcalcification segmentation in mammography. SPIE
Biomed Image Process Biomed Visual 1993;12(4):634–42.
[14] Dengler J, Behrens S, Desage JF. Segmentation of
microcalcifications in mammograms. IEEE Trans Med
Imag 1993;12:634–42.
[15] Zhao D. Rule-based morphological feature extraction of
microcalcifications in mammograms. SPIE Med Imag
1993;1095:702–15.
[16] Lefebvre F, Benali H, Gilles R, Kahn E, Di Paola R. A fractal
approach to the segmentation of microcalcifications in digital
mammograms. Med Phys 1995;22(4):381–90.
[17] Li H, Liu KJR, Lo SCB. Fractal modelling and segmentation
for the enhancement of microcalcifications in digital
mammograms. IEEE Trans Med Imag 1997;16(6):785–98.
[18] Strickland RN, Hahn HI. Wavelet transforms for detecting
microcalcifications in mammography. IEEE Trans Med Imag
1996;15(2):218–28.
[19] Wang TC, Karayiannis NB. Detection of microcalcifications
in digital mammograms using wavelets. IEEE Trans Med Imag
1998;17(4):498–509.
[20] Yoshida H, Doi K, Nishikawa RM. Automated detection of
clustered microcalcifications in digital mammograms using
wavelet transform techniques. SPIE Image Processing
1994;2167:868–86.
[21] Yoshida H, Doi K, Nishikawa RM, Giger ML, Schmidt RA.
An improved CAD scheme using wavelet transform for detection
of clustered microcalcifications in digital mammograms. Acad
Radiol 1996;3:621–7.
[22] Netsch T, Peitgen HO. Scale-space signatures for the
detection of clustered microcalcifications in digital mammograms.
IEEE Trans Med Imag 1999;18(9):774–86.
[23] Cheng H, Lui YM, Feiimanis RI. A novel approach to
microcalcification detection using fuzzy logic techniques. IEEE
Trans Med Imag 1998;17(6):442–50.
[24] Kassemeijer N. Adaptive noise equalization and recognition
of microcalcifications in mammography. Inter J Pattern Recog
Artif Intel 1993;7:1357–76.
[25] Bazzani A, Bevilacqua A, Bollini D, Brancaccio R,
Campanini R, Lanconelli N, et al. Automated detection of
clustered microcalcifications in digital mammograms using an
SVM classifier. In: Proceedings of the European Symposium on
Artificial Neural Networks, 2000;195–200.
[26] Chan HP, Lo SCB, Sahiner B, Lam KL, Helvie MA.
Computer-aided detection of Mammographic microcalcifications:
pattern recognition with an artificial neural network. Med Phys
1995;22(10):1555–67.
[27] Lo SC, Chan HP, Lin JS, Li H, Freedman MT, Mun SK.
Artificial convolution neural network for medical
image pattern recognition. Neural Networks 1995;8(7/8):1201–14.

5

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE


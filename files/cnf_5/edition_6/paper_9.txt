An edge based segmentation algorithm for rock fracture tracing
Weixing Wang
Department of Computer Science & Technology, Chongqing University of Posts &
Telecommunications, Post code: 400065, China
znn525d@yahoo.com, or wangwx@cqupt.edu.cn

Abstract
Rock fractures mapping is very important in many
rock engineering applications. To successfully
applying automatic image processing techniques for
the problem of automatic rock fracture detection and
description, the hardest task is the automatic
detection of fractures robustly in images. A so-called
valley-edge detection algorithm (“ valley” or
(“ ridge” ) means here finding locally dark (or bright)
line-like features) is one-pass line detection
algorithm (without thresholding step). The developed
fracture detection algorithm is the robust for ridge
edge detection and fracture tracing, but for the rough
surface with thick cracks or fractures, using multiscale technology can alleviate producing noise
fractures.
The algorithm has been tested for
detecting fractures. Results indicate that this
approach is useful in this domain of images.
Keywords--- Rock fra ctures, Edge detection, Ridge
detection, Multiple scales

1. Introduction
In the context of nuclear waste repositories, an
important approach to understanding brittle rock
mass behavior to integrate new and powerful
observational and numerical methods with multifunctional 3-D imaging and visualization techniques.
In 1994, Swedish Nuclear Fuel and Waste
Management Company (SKB) identified the need for
a better understanding of radionuclide transport and
retention processes in fractured crystalline rock.
Firstly, TRUE recognize that transport is not confined
to a single feature, rather a network of features.
Question persisted regarding the effects of a fractures
network and its components on transport and

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

retention. TRUE from a single rock fracture expands
to multiple fractures of network and their intersection
properties. In 2000, SKB reported that image
techniques have been used for analysis of pore space
and fracture aperture both from Royal Institute of
Technology in Sweden, and other researchers in
Canada. The measurement scale was down to micrometers. That is more or less in one dimension
measurement. The similar measurement and analysis
work have been carried out in Department of
chemistry, University of Helsinki, Finland (2003).
Digital image analysis started by dividing the autoradiograph into area units called Pixels. In this study,
the 400 dpi (dots per inch) resolution used in the
quantitative analysis resulted in a pixel size of
(42.5x42.5) µ m 2. Essentially, all the intensities of
the sub domains were converted into corresponding
optical densities, and these were in turn converted
into levels of activity with the help of the calibration
curves measured for each exposure. In 2002’s
technical report (Final report of the TRUE Block
Scale project: 1. Characterization and model
development), Background fracturing measurement
work have been performed as (1) Fracture intensity;
(2) Fracture orientation; (3) Transmissivity of
fractures; (4) Size distribution; (5) Spatial pattern;
and (6) Spatial model analysis. All the measurement
and analysis were carried on the borehole logs; the
fractures are well visible without microscope. In 2003,
the technical report (Final report of the TRUE Block
Scale project: 4. Synthesis of flow, transport and
retention in the block scale) points out that using 3D
modeling: (a) Stochastic Continuum (SC); (b)
Discrete Feature Network (DFN) or (c) Channel
Network (DFN/CN), mainly depends on the problem
at hand and heterogeneity seen in the rock which are
related to fracture properties. The two of the three
basic questions are concerned to rock fractures: the
one of them is what are the properties of rock fracture

and fracture zones that control transport and retention
in rock fractures? The answers are: (a) “ Fracture
intersections have distinctive properties and have a
measurable influence on transport in fracture/feature
networks. These distinctive properties may make the
intersection a preferential conductor, a barrier, or a
combination of both!” ; (b) “ In-plane heterogeneity
and anisotropy have a measurable influence on
transport of solutes in a block scale fracture
network!” . Another question is what the difference
between single fractures is and fracture network
affecting absorb tracer? The answer is: “It is not
possible to discriminate between breakthrough curves
of absorbing tracers in a single fracture from those
obtained in a network of fractures!”
Based on the 10 years’ research work and reports,
the common agreement is that the rock fractures or
fracture
networks
controlling
the
nuclei
transportation and retention. To understand they how
to affect the nuclei transportation and retention, the
first basic work is to measure the fractures, in which,
the optical image techniques have been used for
measuring fracture apertures and facture zone
parameters. In microscope scale (down to micro
meters), several research groups or persons have
mainly studied the rock fracture aperture analysis.
Some of the image processing, segmentation and
analysis work have been done in Universities, such as
least cost fracture tracing, and the computation of the
angles and deeps of fractures in a borehole etc. The
techniques were recognized to be potential useful in
the continuation of TRUE project. Therefore, we
started to test whole research procedure or
methodology for image analysis of rock fractures in
ASPO laboratory since 2004. In this paper, we just
present our new algorithm for rock fracture tracing or
mapping.
To process and analyze rock fractures by image
techniques , we have reviewed current literatures. A
huge number of literatures have stated that
researchers used image analysis tools to analyze a
single fracture orientation and apertures, and analyze
multiple fractures which are oriented in one or two
directions, which are corresponding to the traditional
manual measurement parameters. A few of
researchers also analyze the porosity and density of
rock samples for multiple and randomly oriented
fracture. There is no standard method for analysis of
a fracture network in image analysis.
Let us now turn to image processing and
measurements of rock fractures. Johansson [2]
presented three different algorithms for single rock
fracture or crack detection. For multiple fractures on
an image, Raymond Reid [3] presented a semiautomatic method for the detection of discontinuity

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

traces in digital images of rock mass exposures. Feng
[4] presented the BIP system for acquiring borehole
images, and studied the measurement of the
orientation of a single joint in a borehole, and other
fracture properties. Iwano [5] reviewed the research
history of hydro -mechanical characteristics of a
single rock joint, and studied a series of lab test and
theatrical analysis. For the single joint measurement
by using image technique, Hakami [6] presented a
method to measure aperture and roughness, and
analyzed the relationship between aperture (and
roughness) and hydro-mechanical characteristics.
Similar work have been done by Kemeny [7], Lee &
Kim [8], Lyman [9].
For some of classes of rock fractures (long
fractures, or thick fractures etc.), it maybe needed to
trace some important fractures. In the well-known
BIPS system, curves are traced based on input points
(the more points, the more accurate is the tracing), to
fit curves on theoretical sinusoidal shape
(distribution). It is not an image processing or
matching algorithm, the color or grey information is
not needed.
In order to make measurements of rock fractures
(or spacing, discontinuities) easy and sufficiently for
the accurate analysis of rock mechanics and
engineering geology, we combined all the knowledge
we have, to establish a programming library for rock
fracture measurement and analysis, and developed
several rock fracture measurement algorithms on the
rock mechanics and geology applications. Now I
have setup an algorithm library, which includes a
number of algorithms for rock fracture analysis and
classification.
In this paper, we first to give a brief description of
visual rock fracture properties and classify the types
of rock fractures, then based on the sample images,
give a detailed analysis, thirdly we will discuss the
possible image processing and segmentation methods
for rock fractures, finally, give a conclusion.

3. Visual rock fracture properties and
classification for image segmentation
In most cases , rock surface is rough, except for the
variations of colors and gray- scales, three
dimensional surface roughness is the another property
comparing to other applications. For image
processing and analysis, fractures or cracks belong to
linear curved objects; the length of an object is much
longer than width. Inside the object, it may be empty
or filled by different materials. The filling materials
are with different colors. Since the large width and
color variation, it is usual that there are many gaps on
one object. Another property is that some fault object

appears on an image due to rough and noised surface.
Random and multiple fractures may form a
complicated network where fractures cross each other.
All the properties make image processing and
segmentation harder than other application. The
following are reprehensive examples for different
types of fractures or cracks.

Fig. 1 Fracture types: The two top images are resin
injection micro fracture images, the right-bottom one
is natural fracture image, and the last one is
laboratory image.

4. Fracture tracing algorithm
In order to classify and analyze rock fractures, the
image processing and segmentation will be first
important. Two components are essential for
recognizing fracture patterns:
Statistical analysis: Study and develop the
algorithms for recognizing fracture patterns in a
global fashion. For example study the density of
edges and variation of this density spatially.
Estimation of fracture pattern classes is another
important topic.
Semi-automatic or automatic tracing: Here we limit
our study to grey-scale images (Color images should
also be considered). We have not evaluated curvature
and shape systematically, yet, but concentrate on the
detection. Learning aspects (such as neural networks)
is another topic possibly worth considering in the
future.
We here use gray-scale information (a color band)
to trace the fracture curves. To develop the algorithm,
several aspects must, generally speaking, be
considered: (a) gray flatness or smoothness; (b)
curvature variation; (c) magnitude strength; (d)
computational searching costs; and (e) distance
linking etc.
On the surface of rock mass, the objects of fracture
often appear as step edges or ridge edges. The aim of

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

image processing and image segmentation is to autotracing rock fractures, which is one of the most
difficult tasks in image processing and image
segmentation, due to the complicated properties on
the rock surface.
Segmentation algorithms for monochrome images
are generally based on one of two basic properties of
gray-level values: discontinuity and similarity. In the
first category, the approach is to partition an image
based on abrupt changes in gray level.
An edge, in the image analysis literature, is a jump
in intensity. The cross section of a so-called ideal
edge has the shape of a ramp: infinite slope and flat
portions on either side of the discontinuity. In
smoother versions of the ideal edges, the first
derivative (in appropriate direction) assumes a local
maximum at a so-called edge point or edge pixel. A
well-known edge detector of this type is the Canny
edge detector, locating local maxima in gradient
magnitude (=steepest slope). However, in our case
we are more interested in another class of detectors,
for example, those known as ridge detectors in the
image analysis literature. A ridge can be simply
thought of as a double edge (a bar edge). Between the
step parts there is a narrow plateau or peak.
Sometimes, ridge detectors are expressed as
follows: a bright (dark) ridge point is defined a point
for which the intensity assumes a local maximum in
the main principal curvature direction.

5. Ridge detection
Edge (or ridge) detection is a fundamental
operation in image processing and computer vision,
because it is useful for object delineation and
recognition. There are a huge number of papers
dealing with this topic. Marr and Hildreth [10]
described a method for determining the edges using
the zero-crossings of the Laplacian of Guassian of an
image. Haralick [11] determined edges by fitting
polynomial functions to local image intensities and
finding the zero-crossings of the second directional
derivative of the functions. Canny [12] determined
edges by an optimization process and proposed an
approximation to the optimal detector as the maxima
of gradient magnitude of a Gaussian-smoothed image.
Clark [13] found a method to filter out false edges
obtained by the Laplacian of Gaussian operator.
Bergholm [14] introduced the concept of edge
focusing and tracked edges from coarse to fine to
mask weak and noisy edges. Elder and Zucker [15]
determined edges at multitudes of scales. For a
survey and comparison of the edge detectors, the
reader can refer to [16]. Among the edge detection
methods so far, the Canny edge detector is the most

rigorously defined operator and is widely used.
Canny also implemented a ridge detector.
However, it is difficult to design a general edge
detection algorithm which performs well in many
contexts and captures the requirements of subsequent
processing stages. Conceptually, the most commonly
proposed schemes for edge detection include three
operations: differentiation, smoothing and labeling.
The valley-edge detection algorithm may be used as
a ridge detector. A valley-edge detector tries to detect
the lowest valley point in a certain direction. If it is,
the pixel is used as the valley-edge candidate, and its
direction and location are marked, for further
processing to form a valley-edge, by thinning and
tracing procedures.

Fig.2 Examine the point P, determin ing if it is a
valley pixel, or not. Circles in the sparse (i, j)-grid.
It moves for each P ∈ (x, y)-grid. (a) A grey value
landscape over layered with a sample point grid. (b)
PA-PB section.
In Fig. 2, we see that P is surrounded by strong
negative and positive differences in the diagonal
directions:

∇ 45 < 0 , and ∆ 45 > 0 , ∇135 < 0 , and ∆ 135 > 0 ,
whereas, ∇ 0 ≈ 0 , and ∆ 0 ≥ 0 , ∇ 9 0 ≈ 0 , and ∆ 90 ≈ 0 ,
∆
where
are
forward
differences:
∆ 45 = f (i + 1, j + 1) − f (i , j ) , and ∇ are backward
differences: ∇ 45 = f (i, j ) − f (i − 1, j − 1) etc. for other
directions. We use max (∆ α − ∇ α ) as a measure of the

strength of an edge point. It should be noted that we
use sampled grid coordinates, which are much more
sparse than the pixel grid 0 ≤ x ≤ n , 0 ≤ y ≤ m . f is
the original grey value image after slight smoothing.
After valley-edge detection, a post-processing
subroutine must be added. In the post-processing
subroutine, several functions are used, such as
thinning, bridging of small gaps, and removal of
short curves or lines (refer to Figs. 3-4).

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

Fig. 3 Example 1 of fracture tracing by the new
algorithm. The top-left image is original image, the
top-right image is inverted and enhanced image, the
bottom-left image is a magnitude image by Robert
edge detector, and the bottom-right image is the
result image.

Fig. 4 Example 2 of fracture tracing by the new
algorithm. The left image is original image, the
middle image is a magnitude image, and the right
image is the result image.

6. Multiple scales
Multi-scale representations are more or less related
to scale-space theory, notably the theories of
pyramids, wavelets and multi-grid methods. We will
not describe and discuss the theory, the detailed
information can be found in Tony Lindeberg [10].
For the complicated rock fracture images, the
methodology is very useful as we tested.
If most fractures in an image are very thin, the finedetail information in the image is very important for
fracture tracing, and the algorithm must avoid
destroying the information. On the contrary, if
fractures are thick, it is necessary to remove the
detailed information on the rock surface, because it
may produce a lot of fault fractures. In general, it is
an image processing tool that the multiple scale
technique makes image structures at coarse scales
corresponding to simplifications of corresponding
structures at fine scales.
By using the knowledge of multiple scales, we
combine the valley edge detection results of different

scale images, and have a promising fracture tracing
result which is difficult to be obtained by using other
methods. A gray scale fracture image of 734x596
pixels is presented in Fig. 5. In Fig. 5(a), the noise
edges randomly distributed on the whole image
surface, and thick fracture cannot be detected
properly by using just valley edge detection. The
fracture mapping result is processed based on the
combination of multiple scales and our valley edge
detection methods. The question is how to scale the
image into different scale levels here, in the
following; we will give a brief description of the
question.

(a)
(b)
(c)
Fig. 6 Shrink image three times on the image in Fig.
5: (a) Maximum filter; (b) Middle filter; and (c)
Minimum filter.
In figure 6, since fractures in Fig. 5 have low gray
values, Maximum filter (in original image, choose
maximum gray value pixel, of four neighboring
pixels, as a new pixel in the shrink image) eras thin
fractures, on the contrast, Minimum filter make
fractures sharpen, but the noise are sharp too. In our
case, we use Minimum filter to shrink image for three
times, then smooth the scaled image by a Gaussian
filter.
One of typical examples is shown in Fig. 7. The
original image has a rough surface with thick
fractures, if the developed ridge detection and
fracture tracing algorithms are directly used without
image scale operations, the detection result will
include a lot of fault fractures. When we shrink the
original image one time, the detection result will be
better. The best detection result is in Fig. 7(d), where,
we shrink the image for three times before ridge
detection and fracture tracing.

Fig. 5 One example of rock fracture images:
resolution is 734x596.
The image scale is reduced. Let x = 1,..., n ,
y = 1,..., m , and f ( x, y ) is the original image. Then
f (xk , y k ) , x k = 1,..., n / 2 k , y k = 1,..., m / 2 k , k = 1, 2, 3,

4,…
where, k ≤ K , m ≥ 2 K , n ≥ 2 K
To obtain valuable scaled f (x k , y k ) , we tried
several image shrink methods (e.g. used Gaussian,
average, medium, adaptive, maximum and minimum
etc. filters). The figure 6 is one of the examples to
show the differences among the rock fracture image
shrink methods.

(a)

(b)

(c)
(d)
Fig. 7 Valley edge detection result: (a) Image of
resolution 734x596; (b) Image of resolution 367x298;
(c) Image of resolution 183x149; and (d) Image of
resolution 91x74.

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

Conclusions
For this study, we have developed a number of
algorithms for image processing and segmentation,
especially for rock fracture images. The presented
fracture detection algorithm is the robust for ridge
edge detection and fracture tracing, but for the rough
surface with thick cracks or fractures, using multiscale technology can alleviate producing noise
fractures. The developed algorithms have been coded
into a program library. We developed a system by
using Microsoft Visual C/C++ programming
languages. The next step of work is to use neural
network to classify images into different classes, then
use pyramid methods to divide original m
i age into
several scale levels, to use the detection algorithm
with different parameters to detect fractures.

[8]

[9]

[10]
[11]

[12]

Acknowledgement
This research is funded by Swedish Nuclear Fuel
and Waste Management Company (SKB), and Äspö
Hard Rock Laboratory through the TRUE-1
Continuation Project!

[13]

[14]

References
[1]

[2]

[3]

[4]

[5]

[6]

[7]

Final report of the TRUE Block Scale project, 4.
Synthesis of flow, transport and retention in the
block scale, March 2003, Swedish Nuclear Fuel and
Waste Management Co. (SKB, Technical Report,
TR-02-16).
Maria Johansson, Digital image processing of
borehole images for determination of rock fracture
orientation and aperture, Licentiate thesis, at Division
of Engineering Geology, Department of Civil and
Environmental Engineering, KTH, 1999, TRITAAMI LIC 2041.
Trevor Raymond Reid, A methodology for the
detection of discontinuity traces in digital images of
rock mass exposures, Doctoral thesis, in the
University of London (Imperial College of Science
Technology & Medicine), 1998.
Feng Quanhong, Application of Image processing to
borehole logging, master thesis, at Division of
Engineering Geology, Department of Civil and
Environmental Engineering, KTH, 1996.
Masahiro Iwano, Hydromechanical Characteristics of
a Single Rock Joint, Doctoral thesis, in
Massachusetts Institute of Technology, 1995.
Hakami, E., Aperture Distribution of Rock Fractures,
Doctoral thesis, at Division of Engineering Geology,
Department of Civil and Environmental Engineering,
KTH, 1995, TRITA-AMI PHD 1003.
Kemeny, J., Randy Post, 2003. Estimating threedimensional rock discontinuity orientation from

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV’05)
0-7695-2392-7/05 $20.00 © 2005 IEEE

[15]

[16]

[17]

digital images of fracture traces, Computer &
Geosciences, v. 29 n. 1, p.65-77 February.
Lee SW, Kim YJ. , 1995. Direct extraction of
topographic features for gray scale character
recognition. IEEE Trans Pattern Anal. Machine Intell;
17(7): 724-729.
Lyman, G. J. , Rock fracture mean trace length
estimation and confidence interval calculation using
maximum likelihood methods, International Journal
of Rock Mechanics and Mining Sciences, Volume 40,
Issue 6, September 2003, Pages 825-832.
Marr D. and E. Hildreth, Theory of Edge detection,
Proc. Royal Society of London, vol. B-207, 1980, pp.
187-217.
Haralik R., Digital Step Edges from zero Crossing of
Second Directional Derivatives, IEEE Trans. Pattern
Analysis and M achine Intelligence, vol. 6, 1984, pp.
58-68.
Canny J., A computational Approach to Edge
Detection, IEEE Trans. Pattern Analysis and
Machine Intelligence, vol. 8, no. 6, 1986, pp. 679698.
Clark J.J., Authenticating Edges Produced by Zero
Crossing Algorithms, IEEE Trans. Pattern Analysis
and Machine Intelligence, vol. 11, no. 1, 1989, pp.
43-57.
Bergholm F., Edge focusing, IEEE Trans. Pattern
Analysis and Machine Intelligence, vol. 9, 1987, pp.
726-741.
Elder J.H. and S.W. Zucker, Local Scale Control for
Edge Detection and Blur Estimation, IEEE Trans.
Pattern Analysis and Machine Intelligence, vol. 20,
no. 7, 1998, pp. 699-716.
Heath M.D., S. Sarkar, T. Sanocki, and K.W.
Bowyer, A Robust Visual Method for Assessing the
Relative Performance of Edge-Detection Algorithms,
IEEE Trans. Pattern Analysis and Machine
Intelligence, vol. 19, no. 12, 1997, pp. 1338-1359.
Lindeberg, T., Scale-space theory: A basic tool for
analysing structures at different scales, . of Applied
Statistics, 21(2), pp. 224--270, 1994. (Supplement on
Advances in Applied Statistics: Statistics and Images:
2)


Fifth International Conference on Computer Graphics, Imaging and Visualization
Visualisation

Simulating the Coalescence and Separation of Bubble and Foam by Particle
Level Set Method
Ryo Shimada, Sejuti Rahman, Yoichiro Kawaguchi
The University of Tokyo
sejuti@gmail.com, yoichiro@iii.u-tokyo.ac.jp

Abstract
In this paper, we present a physics-based computer graphics
technique for simulating and rendering foams and bubbles
floating on the calm surface of fluid. We integrate rendering
of bubble and foam, fluid simulation and the interactions
between them to create the appearance of realistic liquids.
As a whole, the animation of bubble that floats on the surface of fluid becomes possible by the technique of this research.

1. Introduction
We are aiming at the simulation of natural bubble phenomenon while avoiding the huge computational cost of a
physically accurate simulation. Therefore, we classify the
general bubble into bubble and foam and develop two different models. We simulate the dynamics of each individual
bubble but we consider foam as a collective body and simulate the macro level dynamics only. This approach helps
to avoid the prohibitive computational cost while realistic
rendering of bubbles is still possible. Moreover, our model
efficiently handles the collision of bubbles, effect of surface
tension, interaction among bubble, foam and fluid under the
existence of different attractive and viscous forces.

Figure 1. Simulation of espresso coffee bubbles

The movement of bubbles and foams on the surface of fluid
is simulated using three dimensional CG. However, the surface of fluid is simulated as a calm horizontal plane and the
calculation is approximated to two dimensions.

The rest of the paper is structured as follows. Section 2
describes our model for the simulation of bubble and foam
dynamics, physics of different forces acting on bubble and
foam. Section 3 presents some results of our CG rendering.
We end with concluding remarks and ideas for future work.

2.1. Theory of ﬂuid

2. Principle
We define bubble as “small enough to assume as a sphere”
and foam as “too small to distinguish as a single entity”.

978-0-7695-3359-9/08 $25.00 © 2008 IEEE
DOI 10.1109/CGIV.2008.30

The Particle Level Set method [1] and the Semi Lagrangian
Advection method [3] are adopted for fluid simulation.

18

• Attractive force of the container wall
• Attractive force of foam
• Viscous force due to fluid velocity

2.3.1
Figure 2. Modeling bubble

Attractive force between bubbles

The surface tension in fluid causes contracting forces along
the surface of fluid. As a result, fluids always try to minimize their surface area. Therefore, an attractive force due to
this surface tension works between bubbles (Figure 4). H.
Kuck [2] assumed that the attractive force works only when
the bubbles are in contact. But in this research, the attractive
force works between the bubbles within a specified range of
distance.

2.2. Change of shape of foam
Foam is represented by a collective body which is advected
by the velocity of fluid. The shape change is calculated by
the Particle Level Set method[1].

2.3. Modeling bubble
In this research, bubble is modeled as a rigid sphere, not as
a deformable body. A bubble has radius, position of gravitational center, velocity and forces as attributes(Figure 2).
The differences between general rigid body simulation and
bubble simulation are as follows:
• We assume that the bubble is floating on the surface of
fluid.

Figure 4. Attractive force between bubbles

• The movement of bubble is influenced by the velocity
of fluid.

The attractive force Faij between bubblei and bubblej is
given by

• The force of surface tension is considered.
Fija =

p −p

ka |p j−p i|2
j
i
0

if ri + rj < |pj − pi | ≤ ri + rj + Ra
others.

where ka is a user-defined constant, pi and pj are the positions of the sphere centers for the spheres representing
bubblei and bubblej respectively, ri and rj are radius of
bubblei and bubblej respectively. The attractive force is assumed to work between bubblei and bubblej only when the
distance between them is in a specific range which is specified by the user defined constant Ra .
Gradually the bubbles get closer due to the attractive force
and there will be a collision. But they will not penetrate as
we simulate the bubbles as rigid bodies. We simulate this
collision as an inelastic collision.

Figure 3. Forces acting on bubble

Collision processing is shown in Figure 5. vi is the velocity of bubblei before collision and vi is the velocity after
collision. The normal velocity changes but the tangential
velocity does not change. That is, friction does not work.

The bubble is simulated assuming the existence of the following forces (Figure 3).
• Attractive force between bubbles

19

of bubblei . The attractive force is assumed to work between bubblei and the wall w only when the distance between them is in a specific range which is specified by the
user defined constant Rw .

Figure 5. Collision of bubbles

Figure 6. Attractive force of the container wall

The position and speed of the bubble are calculated using
Euler finite difference. Because of the error due to the numerical calculation, portion of the colliding bubbles penetrate. In order to remove this penetration, the following
formulas are applied.
pi
pj

= pi − Δp
= pj + Δp

Δp =

(rj +ri −|pj −pi |)(pj −pi )
2

Figure 7. Bubbles are being attracted by foam
2.3.2

Attractive force of the container wall
2.3.3

Depending on the wetting characteristic, the container wall
can be categorized to wettable and non-wettable surface.
The degree of wetting is described by the contact angle, the
angle at which the liquid-vapor interface meets the solidliquid interface. If the wetting is very favorable, the contact
angle will be low, and the fluid will spread to cover a larger
area of the surface. If the wetting is unfavorable, the fluid
will form a compact droplet on the surface.

This research assumes that an attractive force between bubble and foam exists which is similar to the attractive force
between bubble and the container wall.
The attractive force Ffi between bubblei and foam is given
by
Fif =

If we assume that the wall of the container in which the fluid
is poured is wettable, then there exists an attractive force between the wall and the bubble (Figure 6) which is similar to
the attractive force between bubbles due to surface tension.

−pi
kw |ppw−p
2
w
i|
0

p −p

kf |p f−p i|2
0

f

i

if ri < |pf − pi | ≤ ri + Rf
others.

where kf is a user-defined constant, pf is a point on the
nearest foam surface from bubblei , pi is the position of the
sphere center for the sphere representing bubblei , ri is the
radius of bubblei . The attractive force is assumed to work
between bubblei and the foam only when the distance between them is in a specific range which is specified by the
user defined constant Rf .

The attractive force Fw
i between bubblei and the wall w is
given by

Fiw =

Attractive force of foam

if ri < |pw − pi | ≤ ri + Rw
others.

2.3.4
where kw is a user-defined constant, pw is a point on the
nearest wall from bubblei , pi is the position of the sphere
center for the sphere representing bubblei , ri is the radius

Viscous force due to fluid velocity

This research simulates one way fluid to solid interaction.
Therefore, the influence of velocity of fluid on the bubble

20

Figure 8. Simulating bubbles and foams of espresso coffee
is only considered. We assume that a force exists (Figure
9) that tries to make the velocity of bubble similar to the
velocity of fluid. This force Fvi is given by
Table 1. Parameters of espresso coffee
Parameter Value
ka
5.0
Ra
1.6
kw
20.0
Rw
12.0
kf
20.0
Rf
15.0
kv
0.1

Fiv = kv (u(pi ) − vi )
Where kv is a user defined constant, u is the velocity of fluid
and v is the velocity of bubble.

Figure 9. The effect of fluid velocity on bubbles. White circle is bubble, blue is fluid surface. Black straight lines represent the velocity vector of fluid.

3

Table 2. Parameters of green tea
Parameter Value
ka
2.0
Ra
1.4
kw
20.0
Rw
12.0
kf
20.0
Rf
15.0
kv
0.1

CG rendering

The bubbles and foams of espresso coffee (Figure 8) (Table
1) and the bubbles and foams of green tea (Figure 10) (Table
2) are given as examples of bubble and foam simulation by
our technique.

21

Figure 10. CG rendering of bubbles and foams of green tea

4

Conclusion

[3] J. Stam. Stable fluids. In Proceedings of SIGGRAPH 1999,
Computer Graphics Proceedings, Annual Conference Series,
pages 121–128, 1999.

This research develops a physics based simulation technique for rendering realistic liquids with bubbles and foams.
Considering the huge computation cost for physics based
rendering, it takes a novel approach for simulating the bubble phenomena. By applying this method, the bubbles of
green tea, coffee, soap water, normal water or other liquids
can be simulated. However, we only consider the calm surface of fluid and we do not generate the bubbles during simulation. Therefore future work can be concentrated on these
features.

Acknowledgements
This research is supported by CREST of JST (Japan Science and Technology). The authors are grateful to Takahiro
Harada and Shogo Yonekura (The University of Tokyo) for
their valuable comments and suggestions.

References
[1] D. Enright, S. Marschner, and R. Fedkiw. Animation and
rendering of complex water surfaces. ACM Transactions on
Graphics, 22(3):736–744, 2002.
[2] H. Kuck, C. Vogelgsang, and G. Greiner. Simulation and rendering of liquid foams. In Proceedings of Graphics Interface,
pages 81–88, 2002.

22


Fifth International Conference on Computer Graphics, Imaging and Visualization
Visualisation

Comparison of Turbidity Measurement by MODIS and AVHRR Images
H.G.Ng, M.Z.MatJafri, K.Abdullah, A.N.Alias
Universiti Sains Malaysia
{nghouguan@yahoo.com, mjafri@usm.my, khirudd@usm.my, azrul_usm@yahoo.com}
Abstract

1. Introduction

The turbidity is commonly measured by turbidity
meter. However, it is only accurate for single point
measurement but ineffective for wide spatial and
temporal coverage. The objective of this study was to
calibrate the turbidity algorithm for AVHRR and
MODIS images. We also want to compare the
effectiveness of MODIS and AVHRR in turbidity
retrieval. Some studies had been performed to correlate
the relationship between turbidity and reflectance. The
reflectance at the Top of Atmosphere (TOA) was
different with the reflectance from the target (water
surface). Therefore an algorithm for atmospheric
corrected reflectance had to be performed before a
regression analysis was done to correlate the turbidity
measurement with reflectance. Some pre-processing
steps had to be performed to retrieve the atmospheric
corrected reflectance and perform the geometric
correction. The classification of land, cloud and water
pixels was done based on the ratio of reflectance for
near-infrared channel and red visible channel. The
cloud masking techniques were also applied to filter the
cloud contaminated pixels. The good pixels were only
chosen for regression analysis. The multiple
regressions were done on turbidity data and
atmospheric corrected reflectance. The turbidity data
was turbidity in-situ data obtained from Department of
Environment (DOE). The atmospheric corrected
reflectance was calculated with method of Hu. The
square of correlation coefficient, R2 and root mean
square error, RMSE were calculated. The same
procedure was done on both MODIS and AVHRR
images. The scatter plot was generated to observe the
correlation between turbidity estimated from the
algorithm for MODIS and AVHRR images. The
turbidity estimated from algorithm by MODIS image
gave a higher correlation compared with AVHRR
image. Besides of that, the turbidity estimated from
algorithm by both images show only the moderate
relationship.

The launching of Earth Observation Satellites (EOS)
by carrying high spectral resolution sensors provided the
solutions. The ideal sensor for remote sensing is high
spectral, spatial and temporal resolution. However, there
is no current sensor technology has combination of these
three high resolutions, due to the signal to noise
requirements. Therefore, the selection of types of
resolution is based on the application. For the water
quality monitoring, a high spectral resolution is required.
The high spectral resolution for reflectance spectrum at
visible and near infrared bands was more effective on
differentiating the concentration of suspended solids.
Therefore, it provided the possibilities of measuring
turbidity based on the spectral reflectance. The Moderate
Resolution Imaging Spectro-radiometer (MODIS)
onboard Terra and Aqua satellites specially designed for
this purpose. MODIS has high spectral resolution (36
spectral bands/min ¨Ȝ=10 nm) but low spatial resolution
(250m, 500m and 1000 m per pixel). The Advanced
Very High Resolution Radiometer (AVHRR) onboard
NOAA series satellites contain visible and near infrared
bands which are also useful for turbidity retrieval.
However the AVHRR has lower spectral resolution (5
spectral bands/ min ¨Ȝ=100nm) and spatial resolution
(1100m per pixel) compared with MODIS.
The AVHRR and MODIS are suitable to be used for
the wide coverage area. We conducted the study to
compare the effectiveness of each sensor on monitoring
the turbidity on marine water. We selected South China
Sea as our study area.
Turbidity could be expressed in the function of
atmospheric corrected reflectance. However the sensor
data gave the at-sensor radiance only. Therefore
atmospheric correction had to be performed to retrieve
the water leaving radiance before converting into
atmospheric corrected reflectance. For the MODIS data,
several parameters were available in order to retrieve the
water leaving radiance. The parameters were normalized
water-leaving radiance, zenith angle and aerosol optical
thickness. These parameters were downloaded from
MODIS Ocean Product. The algorithm of turbidity was

Keywords--- This part is optional.

978-0-7695-3359-9/08 $25.00 © 2008 IEEE
DOI 10.1109/CGIV.2008.21

398

then calibrated by the empirical method. For the AVHRR
data, we utilized the digital number of band 1 and band
2. The digital numbers were then converted to radiance
based on the calibration data attached in the header file.
After that, we used method of Hu to get the atmospheric
corrected reflectance. Linear regression was done to
obtain the relationship between turbidity and reflectance.

where

n=refractive index of sea water =1.341
ȡ= Fresnel reflectivity from below the water
surface, assumed constant (ȡ=0.021)
E0(Ȝ) = extraterrestrial sun irradiance
ș0 = sun zenith angle
T0= diffuse transmittance from the sun to the
water surface

2. Material and Methodology

By providing the input of model atmosphere,
atmospheric column parameter and file, aerosols model,
geometry and spectral band’s parameters, the value of T0
were simulated and a graph was generated.
E0(Ȝ) can be calculated from equation (4):

The AVHRR image that was in scaled radiances,
acquired from Malaysia Centre of Remote Sensing
(MACRES). The date and time of the AVHRR were 25
June 2004, 23:27:57. The MODIS data was downloaded
from the Atmosphere Archive and Distribution System
(LADDS) website. The turbidity insitu data was obtained
from Department of Environment (DOE), Malaysia.
We retrieved the turbidity from two approaches, one is
from MODIS-Aqua normalized water leaving radiance
(approach 1), and another one is from AVHRR scaled
radiance data. The two approaches were then being
compared.

E0(Ȝ)=E0’(Ȝ){1+e cos[(2ʌ(D-3)/365])2

E0’(Ȝ) = mean extraterrestrial sun irradiance
e = eccentricity of the Earth’s orbit around the
sun (e=0.0167)
D= Julian day

where

E0’(Ȝ) was found from ASTM G173-03 Reference
Spectra derived from SMART v.2.9.2.

2.1. First Approach

E0 (Ȝ)was calculated by MIDC SOLPOS Calculator at
the website
http://www.nrel.gov/midc/solpos/solpos.html.

To retrieve the water-leaving radiance, we applied
the equation (1) given by (Gordon and Clark, 1981).

The turbidity was calculated from equation (5), (Chen
et.al.2006).
tb = a (R(Ȝ))b
(5)
From equation (5), we changed the equation (5) into loglog relationship
log tb = b log a + b log R(Ȝ)
(6)
A scatter plot of log tb and log R(Ȝ) was generated. We
determined empirically constant values a, and b from
linear regression. Data tb was in-situ turbidity data
obtained from Department of Environment (DOE). Data
R (Ȝ) was derived from equation (4).

Lw(Ȝ) = Lwn(Ȝ)cosș0exp[-(0.5Ĳr+Ĳoz)/cosș0]
(1)
where Lwn= normalized water leaving radiance
ș0 = solar zenith angle
Ĳr = the optical thickness of Rayleigh scattering
Ĳoz = ozone optical thickness
The data of Lwn could be downloaded from
http://oceancolor.gsfc.nasa.gov/cgi/level3.pl. The solar
zenith angle, ș0 is a function of time, day and latitude. It
was calculated by using solar position calculator at
http://www.srrb.noaa.gov/highlights/sunrise/azel.html.
The value of Ĳr was calculated by the equation (2),
(Linke, 1956).
Ĳr (Ȝ) = 0.00879Ȝ-4.09

2.2. Second Approach
AVHRR image was in scaled radiance in the form of 10
bit digital number. The digital number was converted to
albedo by equation (7), and the albedo was converted to
radiance by equation (8).
A = M(DN) +I
(7)
where A = albedo
M= the channel slope.
I = the channel intercept.

(2)

The value of Ĳoz was simulated from MODTRAN with
the software PcModwin4.0. The graph was plotted by the
software. From the graph, we estimated the value of
Ĳoz(Ȝ). After that we calculated water-leaving radiance
from equation (1).
Lwn given by the website was only at the wavelength of
412nm, 443nm, 488nm, 531 nm and 667 nm. The
effective wavelength of band 1 for AVHRR was at the
interval of 580nm to 680nm. Therefore we took the
downloaded data of Lwn(667) to calculate Lw(667). After
that, we calculated the reflectance by equation (3),
(Tassan, 1987) :

R (O )

Sn 2 Lw (O )
(1  U ) E 0 (O ) cos T 0T0 (O )

(4)

The calibration slope of channel 1 and channel 2 for
NOAA-15 was 0.05680 and 0.16330. The intercept of
channel 1 and channel 2 for NOAA-15 was -2.1874 and 54.99280.
The albedo was then converted to radiance:

(3)

Lt

399

A[

F
]
100WS

(8)

where Lt = total at-sensor radiance
F= the integrated solar spectral irradiance,
weighted by the spectral response function
of the channel in Watts/m2.
W= equivalent width of the spectral response
function in ȝm.
The value of F and W can be from NOAA KLM User’
Guide Appendix D.1, Table D.1-7.
Value F of channel 1 and channel 2 for NOAA-15 were
138.7 W/m2 and 235.4 W/m2. The value W of channel 1
and channel 2 were 0.084 ȝm and 0.228.
The reflectance can then be determined from equation
(9), (Hu et. al., 2004).

R(O1 )

Toz =ozone transmittance
Ĳr = the optical thickness of Rayleigh scattering
ș = sensor zenith angle.
Pr(ȥ-) can be estimated by the following equation:

I S )

(ș, I ) is the sensor zenith and azimuthal angle.

(ș0, I 0) is the solar zenith and azimuthal angle.

(ș0, I 0) can be calculated from software of solar position
calculator.
(ș, I ) can be obtained from the AVHRR data.
ĲR(Ȝ)= 0.00879Ȝ-4.09

E (O )
L (O )
L (O )
( t 1  ( t 2  Lr (O2 )) u 0 1  Lr (O1 )
E0 (O2 )
toz (O1 ) toz (O2 )
t0 (O1 ) u tv (O1 ) u F0 (O1 ) u cosT 0

Lr2 was given by

Where R = remote sensing reflectance or atmospheric
corrected reflectance
Lr= Radiance from Raleigh scattering in
absence of aerosols.
t0 =Diffuse transmittance from the sun to the
ground due to Raleigh and aerosol
scaterring.
tv = diffuse transmittance from the ground to a
sensor due to Raleigh and aerosol
scaterring.
toz= Diffuse transmittance from the sun to the
ground and from the ground to a sensor due
to absorption by ozone.
Ĭ0= solar zenith angle
Eo = Adjusted extraterrestrial solar irradiance.

Lr 2

U ( P0 ) E0 (O )T (O , P0 )W R (O , z0 )
Pr (\  )
cosT
(13)

where ȡ(ȝ0) = Fresnel reflectivity
T(ȝ0) = total transmittance
cos ȥ+ = cos ș0 cosș + sin ș0 sin ș cos( I0  I )
The Fresnel reflectivity was calculated by the software at
the website
http://unicorn.ps.uci.edu/calculations/fresnel/twophase.ht
ml. The input data of angle range and increment, indices
of refraction for air and water were required. A table
with the data of angle and Fresnel reflectivity would be
generated after submitting the input parameters.
After that, we calibrated the algorithm by using
regression analysis. The data used for regression analysis
must be selected from good pixels and coincident
turbidity in-situ data must be available.

In this case, band 1 and band 2 of AVHRR data was
used. Therefore, we took effective wavelength of band 1
and band 2 for Ȝ1 and Ȝ2. Thus, Ȝ1 =630 nm and Ȝ2 =
850nm. The value of t0, tv and toz were simulated from
MODTRAN. șo can be calculated from sun position
calculator by entering the input data of data, time and
location in latitude and longitude. E0 could be calculated
by equation (4) or using software of MIDC SOLPOS
Calculator.
The Rayleigh radiance, Lr contributed by two processes,
(Crackenll, 1981):
1. The direct sunlight scattered by the air
molecules into the sensor’s field of view, Lr1.
2. The direct sunlight reflected at the ocean
surface and then scattered by air molecules the
sensor’s field of view, Lr2.
Lr = Lr1 + Lr2
(10)

3. Results
The data of Lwn(667) at the date of 25 June 2004 was
downloaded from the website. The file was in the format
of HDF. By using the software HDF explorer, we could
view the parameter of normalised water leaving radiance
at 667 nm.
The software of solar position calculator was used to get
the data of solar zenith angle and extraterrestrial solar
irradiance. The result was shown as below.

Table1. The parameter calculated by software of
software position calculator
Date
time
Irradiance
Zenith
angle

Lr1 was given by:

E0 (O )Toz (O , P0 )W R (O )
Pr (\  )
cosT

(12)

where cos ȥ- = -cosș cosș0 –sinșsinș0 cos( I0

(9)

Lr1

3
(1  cos 2 \  )
16S

Pr (\  )

(11)

where Pr (ȥ-) = Rayleigh scattering phase function.

400

6/25/2004

23:00:00

1249.189331

19.083754

6/25/2004

23:10:00

1235.235962

20.855816

6/25/2004

23:20:00

1219.107422

22.739735

6/25/2004

23:30:00

1200.828613

22.739735

6/25/2004
6/25/2004

23:40:00
23:50:00

1180.443237
1157.986206

26.747099
28.836256

The first ten of the reflectance data were used for
algorithm calibration, and then the last ten data were
used for validation.
A scatter plot of log tb and log R(Ȝ) was generated to find
the coefficients of a and b in equation(6).
1.2
y = 0.8787x + 2.6041
1

At the time of 23:27:57, the solar zenith angle is about
24.3º, and E0 is about 1207.71 W/m2, from linear
interpolation of the data above. The value of ozone
transmittance can be simulated by MODTRAN. The
result of the simulation was shown in graph.

log t

0.8
0.6
0.4
0.2
0
-4

-3

-2

-1

0

log R

Fig. 3 Scatter plot of turbidity estimated from MODIS data and
reflectance calculated by approach 1

From linear regression, we get log tb =0.8787 log R +
2.6014 or tb = 399.39 R0.8787
For the AVHRR data, the calibration data and digital
number could be retrieved from the image processing
software.
Fig. 1 The

ozone transmittance varies with the
wavelength.

From the figure, we knew that at the wavelength of
667nm, the Ĳoz § 0.97.
The diffuse transmittance from the sun to the water
surface was also simulated with MODTRAN. The result
of simulation was shown in graph. The result of output
file was exported to the Excel file.

Fig. 4 The AVHRR information, calibration data, digital number
could be viewed in the image processing software

The value of t0, tv and toz could be simulated from
MODTRAN. The results were shown in the graph.

At the wavelength of 667nm, the value of T0 = 0.706.
Then, the reflectance was calculated by equation (3),
twenty of the reflectance data for selected pixels were
shown in the table below:

401

value of R2 =0.8633 and RMSE = 3.718 for approach 1,
while R2 = 0.8293 and RMSE = 6.218.
22

turbidity in-situ

20

18

16

14

Fig. 5 All the relevant transmittance parameters were simulated
by MODTRANS and results were shown in graph.

12

Reflectance data were calculated by equation (9).
Twenty data of reflectance from selected pixels were
shown as below. The data were divided into two parts.
One part is for regression analysis, and another part is for
validation.

10
10

Rsq = 0.8633
12

14

16

18

20

22

turbidity esimated (MODIS)

Fig. 7 Scatter plot of turbidity in-situ and turbidity estimated
from MODIS data.
22

Table 2. Reflectance data calculated from equation (9).
0.00377
0.01647
0.00377
0.01647

0.00312
0.02243
0.00312
0.02243

0.00479
0.02133
0.00479
0.02133

20

0.00533
0.02580
0.00533
0.02580

turbidity insitu

0.00125
0.01801
0.00125
0.01801

A scatter plot was then generated to get the relationship
between turbidity and reflectance.

y = 1.0917x + 3.0862

18

16

14

1.2
12

1
10

log t

0.8

Rsq = 0.8293
8

10

0.6

12

14

16

18

20

turbidity estimated (AVHRR)

0.4

Fig. 8 Scatter plot of turbidity in-situ and turbidity estimated
from AVHRR data.

0.2
0
-3

-2

-1

0

Conclusions

log R

We used two different approaches for retrieving water
quality from AVHRR and MODIS data. This was
because input parameters available for processing were
different. For example, we could download Lwn data for
MODIS sensor but there was no Lwn data available at
AVHRR data from MACRES. From the study, we knew
that MODIS data was more suitable for retrieving
turbidity data compared with the AVHRR data. This was
because the algorithm calibrated by MODIS data showed
the higher R2 and lower RMSE. The R2 = 0.8633 and
RMSE =3.718 for MODIS data, but R2= 0.8293 and
RMSE=6.218 for AVHRR data. Overall the correlation
between variables was not sufficiently high. This is

Fig. 6 Scatter plot of turbidity estimated from AVHRR data and
reflectance calculated by approach 2.

From linear regression, we knew that log tb = 1.0917 log
R +3.0862 or tb = 1219.55 R1.0917
After that, a validation was done on the calibrated
algorithm. A scatter plot of turbidity in-situ and turbidity
estimated was generated. The turbidity estimated was the
turbidity data calculated from the algorithm with the
reflectance data. We used linear regression analysis to
compare the correlation of two approaches. We had the

402

because very difficult to get the accurate data for
turbidity. The turbidity was sensitive to the technique of
measurement, spatial and temporal changes. Besides of
that, the number of data for algorithm calibration and
validation was not sufficient. This is due to the limited
number of monitoring station. Therefore satellite
measurement could not give the satisfied result of
turbidity for accuracy but it was effective for a large
coverage area when accuracy is not that important.

Acknowledgements
We would like to thank MACRES supplying AVHRR
image and DOE supplying turbidity in-situ data.

References
[1]

[2]
[3]

[4]

[5]

[6]

[7]

[8]

Bailey and Wedell, 2006. A multi-sensor approach for
the on-orbit validation of ocean color satellite data
products. In: Remote sensing of Environment,
Vol.102(1-2), pp. 12-23.
Cracknell, A.P. , 1981.Remote Sensing In Meteorology ,
Oceanography and Hydrology, Chapter 11, 163-197.
C.Hu, Z.Chen, T. Clayton, Swarnzenski, J. Brock, and
F.Muller Kerger., 2004. Aseesement of estuarine water
quality indicators using MODIS medium-resolution
bands: initial results from Tampa Bay, Florida, In:
Remote Sensing of Environment Vol.93, pp.423-441.
Franz et.al., 2006. , MODIS land bands for ocean remote
sensing applications. In: Proc.Ocean Optics Vol.XVIII,
Montral, Canada, 9-13 October 2006.
Gordon, H.R., and Clark, D. K., 1981, Clear water
radiances for atmospheric correction of Coastal Zone
Colour Scanner imagery. Applied Optics, 20, 4175-4180.
Linke, F. ,1956. Die Sonnestrahlung and ihre
Schwächung in der Atmosphäre in Handbuch der
Geophysik, Bd. VIII, herausgeg. Von F. Linke, F.
Moeller, Berlin Gebr. Borntraeger 1942-1956, Kap. 6.
Tassan, S., 1987, Evaluation of potential of the Thematic
Mapper for Marine application, Internation Journal of
Remote Sensing, 8, 1455-1487.
Z. Chen, C.Hu and F. Muller Kerger (in press), 2006.
Monitoring Turbidity in Tampa Bay Using MODIS/Aqua
250-m imagery, Remote Sensing of Environment,
doi:10.1016/j.rse.2006.12.019.

403


Fifth International Conference on Computer Graphics, Imaging and Visualization
Visualisation

Segmentation of CT Brain Images Using K-means and EM Clustering

Tong Hau Lee1, Mohammad Faizal Ahmad Fauzi2 and Ryoichi Komiya1
1
Faculty of Information Technology,
2
Faculty of Engineering,
Multimedia University, Jalan Multimedia, 63100 Cyberjaya, Selangor, Malaysia.
{ hltong@mmu.edu.my }
Section 2 of this paper gives the brief overview picture
of the whole process. Section 3 elaborates the details of
the entire process. In Section 4, we show the
experimental results of the segmentation. In the final
section, conclusions and possible future work are
discussed.

Abstract
The combination of the different approaches for the
segmentation of brain images is presented in this paper.
The system segments the CT head images into 3 clusters,
which are abnormal regions, cerebrospinal fluid (CSF)
and brain matter. Firstly we filter out the abnormal
regions from the intracranial area by using the decision
tree. As for the segmentation of the CSF and brain
matter, we employed the Expectation-maximization (EM)
algorithm. The system has been tested with a number of
real CT head images and has achieved some promising
results.

2. System overview
Most brain segmentations involved just one
segmentation algorithm to segment all the regions.
However, in our case we adopt the different methods to
segment different brain parts and the experiment shows
that they can achieve more promising results. The flow
of the system is shown as in Figure 1.

1. Introduction
Medical images are produced rapidly recent years.
Almost every day, huge medical visual data are produced
from X-ray, Computed Tomography (CT) scanner,
Magnetic Resonance Imaging (MRI) scanner and so on.
The images, if processed appropriately can provide very
useful information to assist doctors in diagnosis.
Image segmentation is the process of partitioning a
digital image into sets of pixels. Image segmentation is
important for classification and analysis. Manual brain
segmentation probably is more accurate than fully
automated segmentation ever likely to achieve. However,
the major drawbacks of manual image segmentation are
time consuming and subjectivity of human segmentation.
Therefore, it is significant to develop a reliable
automated segmentation to overcome the drawbacks of
manual segmentation. The challenges for automatic
segmentation of the CT head images have given rise to
many different approaches. The techniques of
segmentation developed so far include statistical pattern
recognition techniques[1,2,3], morphological processing
with thresholding [4,5], clustering algorithm[6,7] and
active contour[8,9].
In this paper, we segment the intracranial area into 3
clusters which are abnormal regions, CSF and brain
matter. The obtained results from image segmentation
play important role for annotation and image retrieval.
However, these are not within the scope of this paper.

978-0-7695-3359-9/08 $25.00 © 2008 IEEE
DOI 10.1109/CGIV.2008.17

Original
Image

Segmented
Images

Enhancement of
the original
image

Expectationmaximization
segmentation for
CSF and brain
matter

Extraction of
the intracranial
area

Feature extraction
and classification
of the normal and
abnormal regions.

Enhancement of
the abnormal
regions

Binarization of the
image by using kmeans clustering
and application of
connected
component
analysis

Figure 1 Flow chart for the system for
segmentation of CT brain images

339

The contrast stretching is applied to the acquired
original low contrast images that lack dynamic range.
After image enhancement, intracranial area is extracted
from the contrast stretched image. In order to obtain the
abnormal regions, we adopt contrast enhancement for the
second time and this time only to enhance the abnormal
regions.
For the binarization of the image, we utilize k-means
clustering in order to detect all the potential abnormal
regions in the brain. Once image is binarized, we extract
the features from each region and classify them
according to normal and abnormal regions by using the
decision tree. Eventually we apply the EM algorithm to
segment the brain, after the abnormal regions have been
excluded into CSF and brain matter area.

Figure 3 Histogram of the absolute first
difference

3. Methodology
3.1. Enhancement of the original image
The low distribution of the gray levels of the
original image reduces the overall contrast for different
parts of the image. Therefore contrast stretching is
employed to increase the dynamic range of the gray
levels in the images. The low limit and upper limit for
linear contrast stretching are automatically determined
from the histogram. Firstly, we construct the histogram
of the original image as depicted in Figure 2. From the
constructed histogram, it exhibits a few peaks and from
our observation the significant range for the
enhancement fall into the last peak. Therefore, we locate
the position of the last peak, I p .

(a)
(b)
Figure 4 (a) Original image
(b) Enhanced image

3.2. Extraction of the intracranial area
For the intracranial area extraction, we threshold the
enhanced image in Section 3.1 and the result is shown in
Figure 5 (a). We found that the skull is always the largest
connected component of the brightest areas. Therefore,
we determine the largest connected component and
remove the smaller connected component.
In order to acquire the intracranial area, we set the
pixel values of the skull and background to zero(black
pixel). The brain images after removing the skull is
shown in Figure 5 (b).

In order to obtain a smoother curve, we apply the
convolution operation. From the smoothed curve, we
acquire the absolute first difference and the result is
shown in Figure 3. From the first difference, the closest
peak on the left and right of I p are auto determined as
the lower limit, I L and the upper limit, I U respectively
for the contrast stretching.
I L and I U will then be considered as the input
into the linear contrast stretching algorithm below:

F (i, j ) = I max

( I (i, j ) − I L )
(I U −I L )

(a)
(b)
Figure 5 (a) Thresholded image
(b) Intracranial area.

where Imax, I(i,j) and F(i,j) denote the maximum intensity
in the image, original image and enhanced image
respectively. After the contrast stretching, the obtained
result is shown in the Figure 4(b).

3.3. Enhancement of the abnormal regions
The intracranial area is further proceeded with the
contrast stretching to enhance the area of abnormalities.
In our paper, we consider the calcification, hemorrhage,
and lesions as abnormal regions. However, other bright
regions such as sinus, vessel and midline falx should be
categorized as normal regions. We applied the identical
linear contrast stretching as in Section 3.1. In order to

Figure 2 Histogram of a CT head image

340

identify the appropriate lower limit and upper limit for
the contrast stretching, we construct the histogram for the
enhanced image in Section 3.2. Then the lower limit, I L
now is considered as the peak position of the histogram.
The upper limit, I U is defined as a:

IU = I L + I α

(b)
(c)
(b) Segmented image by Otsu threshold.
(c) Segmented image by EM segmentation.

where Iα is fixed at 400 from the experimental
observation.
Median filter is then applied to reduce the “salt and
pepper noise” and two examples of the obtained results
are shown in Figure 6 (a) and (b).

3.5. Feature extraction and classification of the
normal and abnormal regions
Prior to classification we extract the features of
every region obtained in Section 3.4. All the extracted
features are listed in Table 1.
Feature
Area

Explanation
The number of pixels in the region of
the ehanced image in Section 3.1.
The average of pixels in the region of
the original image in Section 3.1.
The standard deviation of pixels in
the region of the original image in
Section 3.1.
The value is between 0 and 1. An
ellipse whose eccentricity is 0 is
actually a circle, while an ellipse
whose eccentricity is 1 is a line
segment.
The angle in degree.
Whether skull or not.

mean
Standard
deviation

(a)
(b)
Figure 6 (a) & (b) Two different examples of the
enhanced images

Eccentricity

3.4. Binarization of the image
For the binarization of the enhanced image from
Section 3.3, we have attempted on three methods which
are k-means segmentation, EM segmentation and Otsu
threshold. The results for respective segmentation are
shown as in Figure 7. We convert the image into binary
image in order to apply the connected component
analysis to detect all the regions inside the brain.
From the obtained results, we discovered that for
Otsu threshold and EM segmentation the abnormal
regions are merged with the normal region. This makes it
impossible to filter out the abnormal region thoroughly.
On the contrary, k-means segmentation yields the best
result as the significant regions are separated from the
normal regions. This is crucial to grant that the abnormal
regions are able to be distinguished out from the normal
regions.

Orientation
Adjacent
neighbor

Table 1 Features of the regions
After the feature extraction, we classify the regions
into normal and abnormal region based on the features in
Table 1. First we distinguish the regions according to
their adjacent neighbor whether is a skull or not. Then
we implement the decision tree for the classification as in
Figure 8, where µ and σ denote mean and standard
deviation respectively.

Area < a

<b

µ

>= b

Normal
region

σ

<d

µ

Figure 7 (a) Segmented image by k-means
clustering.

Normal region

Area >= a

µ

σ

µ

> =c

σ

<e

<c

>= d

σ

>= e

Normal
region
Abnormal
region

Normal
region

Abnormal
region

Figure 8 Tree diagram for classification of the
regions where the adjacent neighbor is not skull

341

As shown in the tree diagram, we categorize the area
of regions into smaller and larger areas. As for smaller
areas such as hyperdense lesion, the intensity is lower
than larger areas such as calcification and bleeding.
Likewise for the region adjacent to the skull, we
apply the similar decision tree but with two extra features
which are orientation and eccentricity. The orientation
and eccentricity are to filter out the midline falx which is
bright area at top and bottom of the intracranial area.

other hand, recall is defined as the numbers of abnormal
regions correctly classified divided by total abnormal
regions.

Abnormal
region

The percentage of the precision is higher due to only
3 normal regions are misclassified as abnormal regions.
Whereas the result of recall is lower as for those
misclassified abnormal regions their intensity is very
similar to the white matter of the brain even after we
have done two contrast enhancements.
When proceed to EM segmentation, the
misclassified abnormal regions will be merged into the
brain matter cluster. The CT head image is eventually
categorized into 3 clusters which are CSF, brain matter
and abnormal regions. The results of all the clusters are
shown in Figure 9.
Our results show that the combination of different
methods for the head image segmentation is workable on
the acquired CT images.

After classification of the abnormal regions, EM
segmentation is adopted to segment the intracranial area
into two clusters which are CSF and brain matter.
Basically, EM algorithm[10] is a statistical estimation
algorithm used for finding maximum likelihood
estimates of parameters in probabilistic models.
The procedure to segment the CSF and brain matter
work as below:
i) Find the initial values for the maximum likelihood
parameters which are means, covariances and mixing
weights.
ii) In expectation (E) step, use the probability density
function for a Gaussian distribution to compute the
cluster probability for every pixel. The multivariate
Gaussian conditional density function is written as:

fi (x | θi ) =

(2π )d / 2

Recall
83.33%

Table 2 Results of the classification

3.6. EM segmentation

1

Precision
98.96%

Conclusions
We have elaborated our concept for the real CT head
image segmentation. The system performs image
segmentation based on different approaches for the
different regions of the brain. The method works quite
effectively for detection of the abnormal regions in the
brain.
Plans for future work include the annotation of the
abnormal regions such as hemorrhage, calcification and
lesion.

1
exp[− (x − µi )t ∑i−1 (x − µi )]
1/ 2
2
∑i

θi =( µi , ∑ i ), x is a d-dimensional feature
−1
vector, µi is the mean vector and ∑ i , ∑ i and ∑ i

where

are the d-by-d covariance matrix, its determinant and
inverse respectively.
iii) In maximization (M) step, use the probability values
obtained in E-step to re-estimate the means, covariances
and mixing weights.
iv) Repeat E-step in (ii) and M-step in (iii).

Acknowledgements
The authors would like to express his gratitude to
Dr. Fatimah Othman from Putrajaya Hospital for the
images provided, support and consultation from time to
time. Besides that, would also like to express
appreciation to MOSTI for funding support under grant
#01-02-01-SF0014 to make this project possible. All
images used in this research work were obtained and
used with permission from Putrajaya Hospital.

The algorithm terminates when the difference
between the log likelihood for the previous iteration and
current iteration fulfills the tolerance.

4. Experimental results
The source of the CT head images is acquired from
the collaborated hospital and the medical doctor has
manually labeled regions in the brain. All the images are
in DICOM format with dimension of 512 x 512. We
have acquired 114 potential abnormal regions from 28
patients and for each patient we take 2 images.
We evaluate our results of accuracy for Section 3.5
by using precision and recall and the results are shown in
Table 2. In our classification, precision is defined as the
numbers of abnormal regions correctly classified divided
by total regions classified as abnormal regions. On the

References
[1] Nathalie Richarda, Michel Dojata, Catherine Garbayvol,
“Distributed Markovian segmentation: Application to MR brain
scans”, Journal of Pattern Recognition 40, 2007, pp. 34673480.
[2] Y. Zhang, M. Brady, S. Smith, “Segmentation of brain MR
images through a hidden Markov random field model and the
expectation–maximization algorithm”, IEEE Transactions
Medical Imaging, vol. 20, Jan. 2001, pp. 45–57.

342

[3] Hau Lee Tong, Mohammad Faizal Ahmad Fauzi and
Ryoichi Komiya, “Segmentation of CT Head Images”,
Conference on Biomedical Engineering and Informatics, 2008.
[4] K.H. Hohne and W.A. Hanson, “Interactive 3D
segmentation of MRI and CT volumes using morphological
operations”, J. Comp. Assist. Tomogr. 2, 1992, pp. 285-294.
[5] Lemieux L., Hagemann G., Krakow K., Woermann F.G., “
Fast, accurate, and reproducible automatic segmentation of the
brain in T1-weighted volume MRI data”, Magnetic Resonance
in Medicine 42, 1999, pp.127–135.
[6] Qingmao Hu, Guoyu Qian, Aamer Aziz, Wieslaw L.
Nowinsk, ”Segmentation of brain from computed tomography
head images”, Proceedings of IEEE Engineering in Medicine
and Biology 27th Annual conference, Sept. 2005, pp. 3375 –
3378.
[7] N. A. Mohamed, M. N. Ahmed, and A. Farag, "Modified
Fuzzy C-Mean in Medical Image Segmentation", Acoustics,
Speech, and Signal Proceedings, vol.6 ,1999, pp. 3429-3432.

[8] Albert Huang, Rafeef Abugharbieh, Roger Tam, Anthony
Traboulsee, “MRI Brain Extraction with Combined
Expectation Maximization and Geodesic Active Contours”,
Signal Processing and Information Technology, 2006 IEEE
International
Symposium,
Aug.
2006,
pp.107-111.
[9] Ruzica Maksimovic, Srdjan Stankovic and Dragorad
Milovanovic “Computed tomography image analyzer: 3D
reconstruction and segmentation applying active contour
models - ’snakes’ ”, International Journal of Medical
Informatics Volumes 58-59, Sept. 2000, pp. 29–37.
[10] A. Dempster, N. Laird, and D. Rubin, “Maximum
Likelihood from Incomplete Data via the EM Algorithm”, J.
Royal Statistical Soc., vol. 39, 1977, pp. 1-38.

343

Intracranial Area:

Abnormal Regions:

Brain Matter:

Figure 9 The results of the segmentation of CT head images

344

CSF:


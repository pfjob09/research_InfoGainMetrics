2011 Eighth International Conference Computer Graphics, Imaging and Visualization

Bit Planes Histogram Equalization for Tone Mapping of High Contrast Images
Rashi Agarwal
Reader, Department of Information Technology
UIET, CSJM University
Kanpur, India
dr.rashiagrawal@gmail.com
the effect of the algorithm changes in each pixel according to
the local features of the image.

Abstract— The imaging system normally used and the
reproduction media has the capability to perceive scenes within
a narrow range of contrast whereas the human visual system
can perceive very high contrast with ease. We constantly strive
to map one such set of colors to another or to address the
problem of strong contrast reduction from active values to the
displayable range preserving the image details.

In image processing it is often desirable to increase
image contrast without introducing artifacts. Local tone
mapping produces a number of characteristic effects in
images. These include halos around dark objects, a
"painting-like" or "cartoon-like" appearance due to a lack of
large global contrasts, and highly saturated colors [2].It is
generally seen that the results stray too far from realism
hence we keep looking out for methods to address to the
problem of high contrast images with natural appearance.

The goals of the mapping may differ depending on the
application and the result we seek. A large number of
computationally intensive methods have been developed in the
past to address this problem. In this paper we try to develop a
simple but extremely effective method to address to the
problem of high contrast images so as to be able to reproduce
them on media with minimum loss of detail and minimum
introduction of “canvas like” effects.

Not all tone mapped images are visually distinctive.
Reducing dynamic range with tone mapping is often useful
in bright sunlit scenes, where the difference in intensity
between direct illumination and shadow is great. In these
cases the global contrast of the scene is reduced, but the local
contrast maintained, while the image as a whole continues to
look natural. Use of tone mapping in this context may not be
apparent from the final image.

Keywords- Histogram Equalization, Bit plane slicing, Tone
Mapping

I.
INTRODUCTION
The Human Visual System (HVS) has the capability to
perceive scenes with brightness ranges of over 5 orders of
magnitude and very high contrast. The imaging system
normally used and the reproduction media has a
comparatively much narrower range. Hence, tone mapping is
a technique used to map one such set of colors to another or
to address the problem of strong contrast reduction from
active values to the displayable range preserving the image
details.
The goals of the mapping may differ depending on the
application and the result we seek. We may want an
aesthetically appealing image or may want to maximize
image contrast or may want high details or sharp results. In
this paper we try to develop a simple but extremely effective
method to address to the problem of high contrast images.
Various tone mapping algorithms have been developed in
the recent years [1, 2, 3]. We can broadly classify them into
two groups:
Global (or spatially uniform) operators: These are nonlinear functions dependant on the luminance and other global
variables of the image. Once the optimal function has been
estimated according to the particular image, every pixel in
the image is mapped in the same way, independent of the
value of surrounding pixels in the image.

The simplest approach to preserve the original scene’s
relative visual contrast impression is to linearly map the
pixels from a high dynamic range to a low dynamic range,
but since the dynamic range in the display devices is much
narrower than that of the original scene, visibility will be
lost. The other problem is that by linearly scaling maps,
some displayable values in the low dynamic range device
may be empty or have too few pixels mapped onto them thus
resulting in an under utilization of all displayable values. [4]
The other approach where one can render the low
dynamic range image to have a maximum contrast is by
histogram equalization. Histogram is defined as the statistic
probability distribution of each gray level in a digital image.
Histogram equalization (HE) is one of the well-known
methods for enhancing the contrast of given images, making
the result image have a uniform distribution of the gray
levels. It flattens and stretches the dynamic range of the
image’s histogram and results in overall contrast
improvement. HE has been widely applied when the image
needs enhancement, such as medical images enhancement.
However, this will alter the original scene’s visual
impression, because it exaggerates contrast in densely
populated pixel value intervals while compresses too
aggressively sparsely populated pixel value intervals. [4]

Local (or spatially varying) operators: The parameters of
the non-linear function change in each pixel, according to
features extracted from the surrounding parameters. Thus,
978-0-7695-4484-7/11 $26.00 © 2011 IEEE
DOI 10.1109/CGIV.2011.18

13

3 which displays all pixels with bit 3 set: 0000.1000
4 which displays all pixels with bit 4 set: 0001.0000
5 which displays all pixels with bit 5 set: 0010.0000
6 which displays all pixels with bit 6 set: 0100.0000
7 which displays all pixels with bit 7 set: 1000.0000

In consumer electronics such as TV, HE is rarely
employed because it may significantly change the brightness
of an input image and cause undesirable artifacts. In theory,
the mean brightness of its output image is always the middle
gray level regardless of the input mean, because the
“desired” histogram is flat. This is not a desirable property in
some applications where brightness preservation is
necessary. Brightness preserving Bi-Histogram Equalization
(BBHE) was proposed to overcome that problem [6]. BBHE
first separates the input image’s histogram into two by its
mean, and thus two non-overlapped ranges of the histogram
are obtained. Next, it equalizes the two sub-histograms
independently. It has been analyzed that BBHE can preserve
the original brightness to a certain extent. Later, equal area
Dualistic Sub-Image Histogram Equalization (DSIHE) was
proposed which claims that if the separating level of
histogram is the median of the input image’s brightness, it
will yield the maximum entropy after two independent subequalizations [7]. DSIHE will change the brightness to the
middle level between the median level and the middle one of
the input image.

Shown below in Figure 1 is an 8-bit per pixel image and
how each plane represents information on that plane.

Figure 1.

Minimum Mean Brightness Error Bi-Histogram
Equalization (MMBEBHE) is proposed to preserve the
brightness [7]. MMBEBHE is to perform the separation
based on the threshold level, which would yield minimum
difference between input and output mean. This threshold
level is essentially chosen by enumeration.

These bit planes can be combined in their order, back
again to get the original image.
B. Histogram Equailzation
In histogram equalization [8], the transformation function
T(r) is given by:

The range of light we experience in the real world is vast,
spanning approximately ten orders of absolute range from
star-lit scenes to sun-lit snow, and over five orders of
dynamic range from shadows to highlights in a single scene.
However, the range of light which we can reproduce on our
print and screen display devices spans at best about two
orders of absolute dynamic range.

k

k

j =0

j =0

s k = T (rk ) = ∑ p r (r j ), = ∑

nj
n

(1)

0 ≤ r ≤1

k
Where :
and k = 0,1… L-1
pr(rj) = nj/n is the probability density function (pdf) of
the input image level j
n is the total number of pixels in the input image
nj is the number of pixels at level j
We fundamentally assume that function T(r) satisfies
following properties:
• T(r) is single-valued and monotonically
increasing in the interval 0 ≤ rk ≤ 1

This problem has been addressed by various schemes as
mentioned above. The drawback with these techniques is that
they are computationally expensive. We have tried to
develop a simple global method to address the same
problem, using bit plane slicing and then histogram
equalization on each bit plane.
II.

Bit planes of an 8 bit image (512 X 512 size)

METHODOLGY

0 ≤ T (r ) ≤ 1

0 ≤ r ≤1

k
k
•
for
It is not difficult to find that the probability density
function (PDF) of the output gray level sk follows a uniform
distribution ranging from 0 to 1.We essentially try to map the
histogram levels of the input image uniformly over the entire
range of intensities available for an image. The
transformation function T(r) represents the cumulative
density function (cdf) of the input image.

A. Bit Plane Slicing
Given an X-bit per pixel image, slicing the image at
different planes (bit-planes) plays an important role in image
processing. In general, 8-bit per pixel images are processed.
We can slice an image into the following bit-planes. Zero is
the least significant bit (LSB) and 7 is the most significant
bit (MSB):
0 which results in a binary image, that is, odd and even
pixels are displayed
1 which displays all pixels with bit 1 set: 0000.0010
2 which displays all pixels with bit 2 set: 0000.0100
14

Figure 5.
Figure 2.

Histogram Equalization where rk is intensity of input image and
sk is intensity of output image

The process of extraction of bit planes was done to get 8
planes as shown; these bit planes were individually equalized
to produce images as shown. Once the equalization on each
bit plane was done, the final image was got after adding back
the equalized bit planes in their original order.

This transformation function is illustrated in Figure 2.
Using the cdf as a transformation function, data regions that
have high concentration if pixels in the input image are
transformed into wider regions (the concentration is
reduced), while other regions are transformed into narrower
regions (the sparse data become concentrated). Hence, global
histogram equalization uses the overall histogram as its
transformation function, so it cannot adapt to the local light
condition of the image. This feature results in the contrast
deterioration of background and small objects.
We have first extracted the bit planes of each image
using coding and then have done histogram equalization on
each bit plane. After this we have recreated the image by
adding up the histogram equalized planes in their order of
importance. This is a fairly simple global method which
yields very good results as compared to any other methods
discussed before. The computations are simpler and faster as
well.

Figure 6.
Image

The process of extraction of bit planes was done to get 8
planes as shown; these bit planes were individually equalized
to produce images as shown. Once the equalization on each
bit plane was done, the final image was got after adding back
the equalized bit planes in their original order.

Figure 3. Original Image of high
contrast

Bit-planes Histogram Equalization on Figure 3

Figure 4. HE on Figure 3

15

Bit plane 0 of original

Figure 7. HE on Bit plane 0

Figure 8. Bit plane 1 of original
Image

Figure 9.

HE on Bit plane 1

Figure 10. Bit plane 2 of original
Image

Figure 11. HE on Bit plane 2

Figure 12. Bit plane 3 of original
Image

Figure 13. HE on Bit plane 3

Figure 14. Bit plane 4 of original
Image

Figure 15. HE on Bit plane 4

Figure 16. Bit plane 5 of original
Image

Figure 17. HE on Bit plane 5

Figure 18. Bit plane 6 of original
Image

Figure 19. HE on Bit plane 6

Figure 20. Bit plane 7 of original
Image

Figure 21. HE on Bit plane 7

Figure 22. Image after HE
application on the original figure

Figure 23. Image after BPHE
application (addition of all above
equalized bit planes)

III. RESULTS AND DISCUSSIONS
As we can easily see that HE on the original image
resulted in speckled final image where false contouring is
predominant. Our Bit plane HE results in a better image
visually and aesthetically with minimal contouring.
We performed the comparison between 50 images
extracted from online database of images and have seen the
results very promising for our suggested algorithm. A few
images and histograms are also shown hereby to affirm the
study.

Figure 24. Image after HE
application

16

Figure 25. Image after BPHE
application

We can see that HE generally reserves the resultant
histogram in a narrow range flattening out the details of the
original image and our algorithm enhances the mean
brightness and spreads out the histogram more evenly as
shown in Figure 29.

Figure 26. Image after HE
application

Figure 27. Image after BPHE
application

Figure 28. Histogram of Image
after HE application

Figure 29. Histogram of Image
after BPHE application

For the 50 images which we analyzed with our new
algorithm we have plotted a graph representing the original
mean brightness values, the mean brightness value of HE
images and the mean brightness value of BP HE images. We
can observe that while HE tends to flatten image histograms
and makes them washed out the new algorithm works better
for high contrast images specially as the mean brightness is
increased and distribution of intensities is not restricted to a
few intensity values only.

Shown in Table 1 are the results of images given above.
We can observe that HE yields result which generally pulls
down the mean brightness and flattens out the resultant
image hence the “natural” look of the image is lost. Our
algorithm has a higher mean brightness and preserves the
natural look of the image as well.

Figure 30. Comparison of results obtained for HE and Bit plane HE on
various images.

The new Bit-plane histogram equalization gives a faster
and easier method than the ones previously developed as
they have a lot of calculations involved as discussed in the
previous sections. The results are promising for reproduction
in the print and can be used with ease for high contrast
images.
REFERENCES
TABLE I.

COMPARISON OF MEAN BRIGHTNESS OF IMAGES USED IN

[1]

THE TEXT

[2]

[3]

145.1022

Mean
Brightness
after Bit
planes HE
205.4333

105.1435

146.6155

197.0803

[4]

Girl.tif

134.7431

127.7747

193.0856

Liberty.bmp

129.7737

143.3902

190.7327

Image name

Blueyeboy.tif

Mean
Brightness
of original
Image
218.7280

Gal.tif

Mean
Brightness
after HE

[5]
[6]

17

J. Tumblin and H. Rushmeier: Tone reproduction for realistic images,
IEEE Computer Graphics and Applications, vol. 13, pp. 42– 48, 1993.
M. Ashikhmin: A tone mapping algorithm for high contrast images,
Proc. Eurographics Workshop on Rendering, P. Debevec and S.
Gibson Eds., pp. 1 – 11, 2002.
G. W. Larson, H. Rushmeier and C. Piatko: A visibility matching
tone reproduction operator for high dynamic range scenes, IEEE
Trans on Visualization and Computer Graphics, vol. 3, pp. 291 – 306,
1997.
R. C. Gonzalez and R. E. Woods: Digital Image Processing, 2nd ed.
Reading, MA: Addison-Wesley, 1992.
R.A Hummel: Image enhancement by histogram transformation,
Computer Graphics Image Processing 6, pp. 184-195, 1977.
Y.T. Kim: Contrast enhancement using brightness preserving bihistogram equalization, IEEE Trans. Consumer Electron., vol. 43, no.
1, pp. 1–8, 1997.

[7]

[8]
[9]

filtering, IEEE Trans. on Consumer Electronics, vol. 44, no. 1, pp.
82–86, 1998.
[10] J. Zimmerman, S. Pizer, E. Staab, E. Perry, W. McCartney, and B.
Brenton: Evaluation of the effectiveness of adaptive histogram
equalization for contrast enhancement, IEEE Trans. Medical Imaging,
vol. 7, no. 4, pp. 304–312, 1988.

Chen, S.-D, A.R. Ramli: Minimum mean brightness error bihistogram equalization in contrast enhancement, IEEE Trans.
Consumer Electronics, vol. 49, no.4, pp.1310-1318, 2003.
A.K. Jain: Fundamentals of Digital Image Processing. Englewood
Cliffs, NJ: Prentice-Hall ,1989.
T.K. Kim, J.K. Paik, and B.-S. Kang: Contrast enhancement system
using spatially adaptive histogram equalization with temporal

18


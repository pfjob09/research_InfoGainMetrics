2011 Eighth International Conference Computer Graphics, Imaging and Visualization

A Novel Self-Synchroniztion Method for Audio Watermarking

Chi-Man Pun, Jing-Jing Jiang
Department of Computer and Information Science
University of Macau, Macau SAR, China
{cmpun, ma96525}@umac.mo

the watermarked signal to be at lower level. In addition to
these issues, the other constraints such as security and
complexity of the watermarking algorithm should also be
taken into consideration.

Abstract— In this paper, we present a Self-Synchronization
algorithm for audio watermarking to against all kind of audio
attacks, especially, the synchronization attacks. A region
corresponding to the area around the feature point of the
original audio signal was exploited to embed the watermark
information, thus the self-synchronization capability can be
obtained. To embed the watermark information into the low
frequency coefficients in DWT (Discrete Wavelet Transform)
domain, high robustness can be achieved. A watermarking
technique in the technique in the category of quantization
index modulation was adopted in this algorithm due to its
great robustness and blind feature. The performance of this
proposed algorithm was evaluated by PSNR (Peak Signal
Noise Ratio) method and Normalized Cross Correlation (NC)
after various attacks. Simulation results show that this
algorithm is robust against not only synchronization attacks
but also various common attacks such as filtering, resample
and so on.

Digital watermarking can be classified into three categories:
digital image watermarking, digital video watermarking and
digital audio watermarking, in term of the type of digital
media. There are several reasons for the difficulty of
developing audio watermarking algorithms. Most of all,
comparing to other human sensory organs, such like eye,
nose, the human ear is far more sensitive. Human ears are so
sensitive that even a small amount of embedded noise can
be detected, especially when the watermark is embedded to
the signal whose power is weak. Among the watermarking
algorithms that have been proposed [1-3], most of them are
produced for image or video. However, relative fewer
digital audio watermarking can be found [1-3]. Particularly,
it is difficult to find the audio watermarking algorithms that
are robust enough to resist the synchronization attack
efficiently.

Keywords- Discrete wavelet transform, Self-synchronization,
Audio digital watermarking.

Since the watermarked audio is likely to suffer from kinds
of synchronization attacks such as shifting and cropping, it
is necessary to have the audio watermarking algorithm own
the ability to resist the synchronization attacks. Up to now,
there are several methods to address the synchronization
issues. Kirovski et al [4] proposed several novel
mechanisms to exploit combination of spread spectrum and
spread spectrum code to embed and detect watermarks in
audio signals. But spread spectrum strategy cannot detect
the watermark information embedded during the detect
procedure, that is it cannot fulfill blind detection, which
bring many inconvenience to the algorithm. Huang et
al[5]exploit the synchronization code to the audio
watermarking. In their proposed algorithm, they embedded
to the original digital audio signal a 12-bits Barker code as
synchronization code to the special domain, and the
watermark information into the DCT (Discrete Cosine
Transform) coefficients. With the synchronization code
embedded, the detector can still find the right position the
watermark information had been placed even after

1. INTRODUCTION
Digital watermarking is the technology that embeds the
watermark information into the original signal and generates
watermarked signal, and make sure that the watermarked
signal does not impact normal usage of the signal. At least
two important constraints, which should be satisfied in each
audio watermarking algorithm, are: robustness and
imperceptibility. Imperceptibility is the ability of the
watermarked signal to keep perceptible distortion free after
watermark information insertion. Robustness means that the
watermarking algorithms own the capability to withdraw
attempts such as modify or removal of embedded watermark
information. In other word, after various attacks such as
compression, filtering, noise addition, the more the
watermarking information still can be detected from the
watermarked signal, the more robust the watermark
algorithm can be achieved. However, these two constraints
may seem to be contradictory. For example, keeping
robustness to attacks in a good level will lead inaudibility of
978-0-7695-4484-7/11 $26.00 © 2011 IEEE
DOI 10.1109/CGIV.2011.21

114

synchronization attacks. But, to fulfill the robustness of the
watermark algorithm, it may not use large enough
embedding strength since the synchronization code is
embedded in the spatial domain. Wang et al[6] proposed a
novel synchronization audio watermarking scheme based on
the DWT and DCT. In that algorithm, the watermark
information is embedded into the coefficients that obtained
after both DWT and DCT, leaking to the great calculation
expense. Wei et al[7] employ the Self-Synchronization
scheme to the audio watermarking. In their proposed
algorithm, they use the peak point extraction (PPE) scheme
to find the special points in the digital audio signal, and
embed the watermark information between these points.
Although no additional information is inserted into the
audio signal, the robustness of the algorithm is not so
perfect. Wan et al[8]maximize the autocorrelation of
watermark data to get synchronization, and use search
mechanism of segments synchronization to obtain
synchronization point. But the watermark information
embedded cannot well be retrieved when go through some
attacks.
2. EMBEDDING THE WATERMARK
The three major steps in the embedding procedure are:
1. Calculate the difference of the amplitude between two
adjacent amplitude values of the audio signal. And find
the relative location of the point which has the largest
difference of the amplitude with adjacent point over the
whole audio signal (Figure 1).
2. Apply DWT to the original audio signal and according
to the relative location which we found in last step to
select the corresponding point in the approximate
coefficients. Afterwards, we embed the watermark
information to the region that centered at the point
found in the approximation coefficients.
3. Applying IDWT to get the watermarked audio signal.

Figure 2. The flow chart of embed watermark procedure
3. DETECTING THE WATERMARK
The two major steps in the detect procedure are:
1. Calculate the difference of the amplitude between two
adjacent amplitude values of the audio signal. Find the
relative location of the point which has the largest
difference of the amplitude with adjacent point.
2. Apply DWT to the original audio signal and according
to the relative location which we found in last step to
select the corresponding point in the approximate
coefficients.
3. Afterwards, we can detect the watermark information
from the region that centered at the corresponding point
in the approximation coefficients.

Original Audio Signal

Difference of two adjacent points

Figure 1. Audio signal and difference of two adjacent
points.

115

Length * max A2 (i )
PSNR  10 log10 ( Length 1
)
*
2
 [ A(i )  A (i )]
i 0

*

Where A and A are the original audio signal and the
watermarked signal, respectively. Length denotes the
length of the audio signal. If the PSNR value exceeds a
certain threshold, the conclusion can be drawn that the
watermarked audio signal is inaudible, otherwise, the
watermarked audio signal is perceptible.
4. EXPERIMENTAL RESULTS
In order to appraise the robustness and inaudibility of our
audio watermark scheme, four audio signals with different
styles were tested in our proposed algorithm, pop.wav,
rock.wav, classic.wav and jazz.wav, whose lengths are all
10s. All the audio signals used in our experiment are 16 bit
signed mono audio signals sampled at 44.1kHz. The
watermark image to be embedded for the audio signals is
32  32 bit binary image (Figure 4). We apply three level
DWT to the audio signals, since the larger level DWT being
used the more calculation is needed and the smaller level
DWT being adopted the more robustness of the watermark
algorithm can be achieved. The quantization step of each
audio signal, in the other word the embedding strength, is
adaptive to the original audio signal, so that the inaudibility
and robustness nature of the watermark can be well
achieved to a certain extent.

Figure 3. The flow chart of detecting watermark procedure
Besides, in order to rule out the impact of objective an
subjective factors, such as experiment ambience and
experience of the observer, we exploited the Normalized
Cross Correlation (NC) [9] to evaluate the similarity
between the original watermark and the retrieved
watermark. The definition of NC is as follow:
M 1 N 1

NC (W * ,W ) 

 w(i, j )  w (i, j )
*

i 0 j 0

M 1 N 1

M 1 N 1

Figure 4. The original watermark image

 w (i, j )  w
i 0 j 0

2

2

*

(i, j )

To demonstrate the robustness of our watermarking
algorithm, two kinds of attacks of the audio signals,
synchronization attack and common attack was applied.
Among the synchronization attack, we mainly focus on
cropping attack to the audio signal. In the common attacks,
large kinds of attacks were employed, such as low-filter,
resample and Mp3 compression attack.

i 0 j 0

*

where W and W are the original watermark image and the
retrieved image, respectively. M and N are the length and
width of the watermark image. If the NC value exceeds a
given threshold, the conclusion that the watermark
information is well extracted can be drawn, otherwise, the
watermark information is not extracted very well.

In order to estimate the inaudibility of the embedded signals
in term of objective measurement, we will calculate the
PSNR once we get the watermarked audio signal after
embedding. Then different kinds of attacks to the
watermarked signals were applied. Afterwards, we attempt
to retrieve the watermark information being embedded.
With each watermark image retrieved, we calculate its NC,
which is the objective measurement of estimating the

To appraise the inaudibility of the proposed audio
watermark scheme, we adopted Peak Signal Noise Ratio
(PSNR) to serve as the objective measurement of the
embedded audio signal quality. The definition of PSNR is as
follow:

116

similarity of the detected watermark image and the original
watermark image. The retrieved watermark images from
different audio signals after various attacks are shown as
Figure 5.-Figure 8.

robustness property, of the retrieved watermark image after
kinds of attacks.
According to the definition of NC, the more close to 1 the
more similar the two images are. From the data in Figure5
to Figure6, whose NC is almost equal to 1, we can see that
the retrieved watermark images from the host audio signals
which were attacked are all extremely similar to the original
watermark image. It is obvious that, the more similar
between the retrieved watermark image and the original
watermarking, the stronger robustness of the digital
watermarking can be achieved. So experiment results
reveals that the audio watermark scheme that we proposed
have great robustness against different kind of attacks.

PSNR
:48.40
d:0.1

NC

1.0

1.0

1.0

NC

1.0

1.0

0.9910

1.0

5. CONCLUSION
In this paper, a novel self-synchronization method for the
audio watermarking has been proposed. Many methods had
been applied in this self-synchronization audio watermark
scheme. First of all, a watermarking technique in the
technique in the category of quantization index modulation
was adopted in this algorithm due to its great robustness and
blind feature. And then, in order to enhance the robustness
against all kinds of audio attacks whose host signal may be
probably applied to the audio signals, a certain area around
the feature point is exploited to place the watermarking
information. In addition, to rule out the human factors
involve the appraisement of the inaudibility and robustness
of the propose watermark scheme, we calculate the PSNR
and NC in our algorithm. Finally, to tradeoff the calculation
expense and robustness, we embed the watermark
information base on level-3 Discrete Wavelet Transform.
What’s more, taking the advantage of the inaudible feature
of the low frequency coefficients after DWT, we choose the
low frequency components to place the watermark
information.

Figure 5. The retrieved watermarks and their NC after
embedded pop.wav going through kinds of attacks

PSNR
:48.40
d:0.1

NC

1.0

1.0

1.0

NC

1.0

1.0

0.9873

1.0

Figure 6. The retrieved watermarks and their NC after
embedded rock.wav going through kinds of attacks
Generally, given the same watermark information to be
embedded, the larger embedding strength applied, the less
inaudibility will be fulfilled. By the contrast, using small
embedding strength will weaken the robustness of the
watermarking. Take two main properties of the
watermarking algorithm, robustness and inaudibility, into
consideration, we choose the embedding strength adaptively
in line with the characteristics of different audio signals.
Given the prerequisite that make the inaudibility of the
watermarking in an acceptable level, we tend to choose
relative large embedding strength when embedding.

ACKNOWLEDGMENT
The authors would like to thank the referees for their
valuable comments. This work was supported in part by the
Research Committee of the University of Macau and the
Science and Technology Development Fund of Macau SAR.
REFERENCES
[1] M. Arnold, “Audio watermarking: features, applications and
algorithms,” in Multimedia and Expo, 2000. ICME 2000. 2000
IEEE International Conference on, 2000, pp. 1013-1016 vol.2.
[2] J. W. Seok, and J. W. Hong, “Audio watermarking for
copyright protection of digital audio data,” Electron. Lett., vol.
37, pp. 60-61, 2001.
[3] I.-K. Yeo, and H. J. Kim, "Modified Patchwork Algorithm: a
novel audio watermarking scheme." pp. 237-242.

From the experiment results, we find that even adopt the
same embedding strength to the different digital audio host
signals, the robustness of the embedded signals varies,
which can be seen by NC, the objective measurement of

117

[4] D.Kirovski, and H.S.Malvar, “Spread spectrum watermarking
of audio signals,” IEEE Trans. Signal Process, vol. 51, no. 4,
pp. 1020-1033, 2003.
[5] J.W.Huang, W.Yong, and Y.Q.Shi, “A blind audio
watermarking algorithm with self-synchronization,” Proc.
IEEE Int. Symp. Circuits Syst., vol. 3, pp. 627-630, 2002.
[6] X.-Y. Wang, and H.Zhao, “A Novel Synchronization Invariant
Audio Watermarking Scheme Based on DWT and DCT,”
IEEE Trans. Signal Process, vol. 54, no. 12, pp. 4835-4840,
2006.
[7] F.S.Wei, X.Feng, and L.Mengyuan, “A Blind Audio
Watermarking Scheme Using Peak Point Extraction,” in IEEE
International Symp. on Circuits and Syst. and Signal
Processing, Kobe,Japan, 2005, pp. 4409-4412.
[8] Y.Wan, W.Lang, and X.Yang, “Self-Synchronization Property
Audio Watermarking Anti-Synchronization Attacks,” in
International Conference on Computational Intelligence and
Software Engineering, 2009, pp. 1-4.
[9] M.Kutter, and F.A.P.Petitcolas, “A fair benchmark for image
watermarking systems,” in Proc. Electron. Imag., 1999, pp.
226-239.

118


VAST 2009 Traffic Mini Challenge: Intuitive Analytic Information
Presentation
Shraddha Agrawal
Kollukuduru Sravanthi
Soujanya Vadapalli
Kamalakar Karlapalem
Centre for Data Engineering, International Institute of Information Technology, Hyderabad
e-mail:{shraddha,sravanthi}@students.iiit.ac.in, {soujanya,kamal}@iiit.ac.in

A BSTRACT
As a solution to the VAST 2009 Traffic Mini Visualization Challenge, we built the Badge and Network Traffic (BNT) tool to create animations of the events taking place in the embassy. Using
the embassy layout, the prox-card and web-access entries and their
time-stamps, we animated color-based flagging of events. The BNT
tool highlights logical anomalies occuring in the badge and network
traffic data with color-coded alerts. Prior to the animated visualization, the tool analyzes data with respect to various aspects using (i)
the amount of data transfers, (ii) destination IPs access patterns, (iii)
employee’s browsing patterns and (iv) employee’s entry log into the
restricted area. Any abnormality noticed is immediately reported to
the user in the form of plots. In this presentation, we list out the
various analyses performed and how they were utilized in the visualization. A few screenshots of the tool are provided to illustrate
our analytic information presentation.
1

I NTRODUCTION

Data set: In the given data set, there are 60 employees in the embassy with corresponding 60 machines. Two tables ‘prox-card’ and
‘IPlog’ data were preprocessed to filter out the important information.
From the task description and the data set provided, we identify
each record (row) in the tables of prox-card logs and web access
logs as an event. An event, thus, is one of the following:
1. prox-card event: an event that indicates any of these: (a) entry
into the embassy by an employee, (b) an entry into the restricted
zone or (c) an exit from the restricted zone.
2. web-access event: an event that indicates a web access from
a machine in the embassy (usually referred to as source IP) to a
destination machine on the net (referred to as destination IP).
A set of logical constraints are obtained from the task description
as given below:
1. One machine is allotted to each employee and the machine once
allotted is not shared with any other employee(s).
2. An employee is supposed to make web-accesses from his allotted
machine.
3. Whenever there is an entry into the restricted area, the event
is always recorded for individual employees. No piggy-backing is
allowed.
4. An exit from the restricted area is also always logged.
2

plots). These visualizations help the user in manually validating, if
the event is indeed suspicious.
The flagging criteria for inspecting events is done through the
following automated filters:
1. An employee is in restricted area and there is a web-access
from his corresponding allotted machine. The event is marked as a
definite ‘suspicious’ event.
2. An employee does not have a prox-in-building entry and there
is a web-access from his allotted machine on the same day. Such
a web-access could be a suspicious event or could also imply that
the corresponding employee of the machine has piggy-backed into
the embassy. We still flag such an event as a suspicious candidate
for further evaluation.

A NALYSIS

Given these event types and the logical constraints from the task description, we investigated a few logical inconsistencies that could
appear in the data. Whenever an event takes place, we have filters developed to check for a logical inconsistency. In case of logical inconsistency, the event is flagged as suspicious and further related information to that event is obtained as visualizations (mainly

IEEE Symposium on Visual Analytics Science and Technology
October 12 - 13, Atlantic City, New Jersey, USA
978-1-4244-5283-5/09/$25.00 ©2009 IEEE

Figure 1: Ratio vs. web-access event (source IP: 37.170.100.15)

General observations from the data:
1. A group by operation on the destination IP attribute in IPlog data
table revealed that out of the 20243 unique destination IPs, only
1022 of them had an access frequency > 1. The other destination
IPs with frequency = 1 were removed as these are not helpful in
finding patterns for suspicious cases.
2. The data transfer for all the web accesses took place through
three ports: 80, 25, 8080.
3. All web accesses through port 25 are only to one destination
IP 37.170.30.250. As port 25 corresponds to simple mail transfer
protocol, we conclude that this destination IP might be the
embassy’s mail server. Hence, these web-access requests through
port 25 are not flagged as suspicious events.
GUI-assisted data analysis: The various forms of visualizations
and plots provided to the user are:
1. Plots of ratio vs. web-access events through ports 80 and 8080:

271

For each web-access, if the ratio of the request size in bytes (reqSize) to response size in bytes (respSize) is high (> 1); we categorize such accesses as upload accesses where more data is uploaded
than received. Hence, we flag such events as a suspicious candidate for further evaluation. Further evaluation includes investigating how abnormally high the ratio is. Figure 1 displays a plot of
web access event (x-axis) vs. ratio (y-axis). The events are ordered
in ascending order of the ratio. The ratio of the suspicious candidate
is highlighted with a red dot.
2. Temporal plots of web-access patterns of each user on his/her
respective machine for all days: The usual time-slots during which
the user accesses web are plotted (for all days). A web access at
a time unusual to his regular times is flagged suspicious. Figure 2
displays the web-accesses of an employee at various times of the
day, for all days. The x-axis denotes time of the day and the y-axis
denotes the day of the month. Each tic in x-axis is 15mins and yaxis is one day. In each plot, the time of suspicious web access event
is highlighted with a green circle. It can be observed that the green
circle shows a deviation from the source IP’s regular web-access
sessions.

Figure 3: Snapshot of BNT Tool Animation

Block
Color/Symbol
WHITE
GREEN
BLUE
Text W
RED

Associated Event
No prox-in-building entry occurred till
that point of time.
Either with the Prox-in-building entry
or prox-out-classified event, the block is
colored green from then.
Prox-in-classified entry occurred and
block remains blue till prox-outclassified occurs.
To indicate a web-access from the corresponding source IP.
A web-access occurs from a source IP
when the block is presently blue (employee in restricted area).

Table 1: Color based flagging based on events

Figure 2: Temporal web-accesses (source IP: 37.170.100.18)

3

BNT TOOL

The Badge and Network Traffic (BNT) tool was built to represent
the web-access and prox-card events as they occur in an animated
fashion based on the physical office layout of the embassy. The tool
also calculates the number of employees present in the restricted
area and in the office at every event and updates the display of embassy layout accordingly. These numbers are presented to the user
in the case of a suspicious event.
Figure 3 displays the given embassy layout and displays the proxcard as well as IP Log information of all the 60 employees at
13:10:23 on 31st/Jan/2008. Each block in the layout displays the
employee’s cubicle. The colors of these cubicles are set according
the rules given in table 1. The prox-card entries and the web-access
entries being temporal, we update the employee cubicle blocks with
colors based on various events associated. The animation of the
events is presented.
4

R ESULTS : S USPICIOUS EVENTS

All the 18 suspicious events are identified by flagging candidate
suspicious events with the above filtering and flagging criteria. Our
investigation started with looking at the ‘RED’ block snapshots in
the embassy-layout animation. These ‘RED’ flagged events are

272

definitely suspicious events and are eight in number. We obtained
the web-access events of those 8 ‘RED’ blocks and observed that
the destination IP of all these accesses is 100.59.151.133. This
prompted us to obtain other web-accesses which had the same destination IP; these events were ten in number. For these events, as
they are not flagged ‘RED’, we investigated the ratio plots, the webaccess activity plots and the statistics obtained from above mentioned data operations, of the corresponding source IPs. We observed that (i) the ratio of reqSize to respSize of these accesses were
unusually high, (ii) the time of each web-access is an unusual time,
given the regular web-access pattern of the corresponding user of
the source IP and (iii) the number of employees present in the embassy at that time of the event is low (either due to early and late
working hours or due to employees in the restricted area). All these
observations together make these too suspicious. An interesting observation was that all the web accesses to this destination IP took
place only on two particular days of a week (if they did): Tuesday
and Thursday, with reference to the 2008 calendar year.
5 C ONCLUSIONS
Given such similar data sets, the above mentioned data analytics,
visual representations and techniques could be performed to identify and validate suspicious events. For this specific case, we were
successful; it requires careful evaluation of the solution approach
on the other data sets to validate the approach’s goodness.


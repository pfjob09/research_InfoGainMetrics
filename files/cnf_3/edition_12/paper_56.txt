Morphological Definition of Anatomic Shapes using
Minimal Datasets
Egor Zindy*, Christopher Moore**, David Burton*, Michael Lalor*
* Coherent and Electro-Optics Research Group, John Moores University, Liverpool UK
**

Christie Hospital, Manchester, UK
E-mail: ZindyQiname.com

Abstract

get volume (CTV) which accounts for micro-spread of
the disease and the planning target volume (PTV) that
ensures that the CTV will be treated at all times during treatment. Conformal radiotherapy, introduced in
ICRU-50 [3] goes one step further and shapes the beam
in real-time to reduce the CTV’s size, thus allowing for
stronger, more effective energy beams and smaller volumes of treatment, the idea being to spare more healthy
tissues while aiming more lethal radiation to diseased
tissues. To achieve this, GTVs, CTVs and PTVs must
be accurately defined. The ICRU-50 report also suggests GTVs should be defined from outlines drawn on
each C T slice, however this is a daunting process, made
worse by the nature of biological structures involved
(see figure 1).

A n e w method f o r outlining t u m o u r volumes and surrounding organs f r o m computed tomography slices i s
presented here. This task is performed during radiotherapy treatment planning and usually consists of t h e
hand-drawing of a set of contours o n t h e appropriate
computed tomography slices of t h e patient lying in treatm e n t position. This method i s both t i m e consuming
and prone t o errors. O u r solution, based o n threedimensional scattered data interpolation, fits a threedimensional primitive object o n the contours, which are
considered as 3-dimensional scattered points. T h e precision of this fit is iteratively refined by adding points
t o the interpolated contours. Interpolation using radial
basis functions is combined with a n appropriate mapping f u n c t i o n between t h e primitive object and t h e scattered point cloud t o provide this iterative warping. As
a result, both a 3-Dimensional m e s h object and a set of
contours are output. In this paper, we describe the mapping f u n c t i o n , as well as present s o m e results obtained
using this method.

1.

This paper explores the possibility of defining contours from computed tomography sequences in a
quicker and more intuitive manner.
In the case of GTV segmentation, automated techniques such as active contour modelling [4] or marching cubes [5] cannot be applied as there is no visible
boundary to segment. This is why two graphic tools
were introduced at the Christie hospital to help oncologists with the outlining task [6], [7], in form of a
((warp control envelope” and a (‘push tool” used for
copy-pasting contours from one slice t o the next and
subsequent modifications of contour shape either at a
global scale with the warp envelope or at a local scale
with the push tool.

Introduction

Computed tomography has made an important contribution to radiotherapy planning and is an acknowledged means of defining the volume of treatment [l].
Radiation dose prescribed by the radiotherapy oncologist is delivered to the patient in form of a collimated X-ray beam that is rotated around the patient
by a gantry mounted linear accelerator. The megavoltage energy beam penetrates deep inside the body, and
is effectively focused on the target volume, at the intersection of all the beams. The surrounding healthy
tissues however, receive only a minimal dose [2].

While these tools give good control over the drawing
process [8], they are not always intuitive because with
a warping process controlled by landmarks (the warp
envelop), contours are not modified directly. Instead,
the space surrounding the contours is modified. There
is also no obvious way for the clinician to find the optimal transformation that will require the least local
modification.

In order t o systematise the clinical approach t o disease targeting, the International Committee on Radiation Units introduced some simple concepts on defining the gross tumour volume (GTV), the clinical tar-

0-7695-0743-3/00
$10.00 0 2000 IEEE

To address these issues, a new methodology had to
be devised t o save from the oncologist the added com-

366

is completed when the oncologist is satisfied with the
overall precision.
After each computation of a new surface, the actual contours are recovered by “slicing” through the
transformed primitive volume at the original C T slices
depths.

The mapping function

3.

Given the topology of the involved organs, 3Dimensional warping of a cylinder was considered to
be sufficient to accurately model the surface between
the first and last contour only. To model closed organs or the GTV’s cap and tail, a sphere, ellipsoid or
superellipsoid would have becn used instead [9]. Also,
the cylinder’s primary axis is chosen to be perpcndicular t o the CT slices.
The warping function being defined by il displacement field, a method to associate points on thc cylinder to points from the contours was devised. Thus,
the following important assumption was made: the
displacement, of primitive object point,s is always twodimensional within a plane parallel to C T sliccs arid
therefore perpendicular to the primitive object’s priricipal axis.

Fig. 1. GTV contours as drawn by the radiotherapy
oncologist

plexity of using a warping envelope. In this paper a
3-Dimensional (3-D) warping function based on scattered data interpolation methods is described. Instead
of warping individual contours, a surface is interpolated
through any data point that has already been placed on
contour boundaries. This surface can be iteratively refined by adding points on the computed t,omography
slices.

2.

Therefore, when a new point is added to a C T slice,
this assumption reduces the problem of finding a displacement vector for t,liis point to a 2-Dimensional problem within the slice planc.
The displacement vector is chosen so that the closest
point, or1 the primitive object’s sect,ion is matched.

Method outline

4.

A surface that interpolates missing contour informat,ion is obtained by deforming a primitive object in order
to minimise the distance between the existing scattered
contour information and the deformed primitive object.

Scattered data interpolation

Let {xi : i = 1 , 2 : . . . ,n } be a given set of distinct
point,s in
and

To initiat,e the first surface, a set of 3 contours is
roughly outlined. These contours are the first, middle
and last contour of the GTV’s dataset. While this is
already common practice in radiotherapy planning, for
conformal radiotherapy, it does not suffice to interpolate the missing contours as the volume error resulting
from this interpolation would affect the target volume.

-(X)--(IIX-xzll)EIW,i=1,2

,...,71

(1)

bo a set of any RBF basis functions
Here 11 . 11 denotes the Euclidean distance on E@.
Given a function f : Rd -+ R to approximate and the
values {f(xi) : i = 1 , 2 , ... , n } , the RBF interpolarit

However, once a surface envelope is computed from
a first minimal dataset, it can be refined iteratively by
adding new points to the contours. When further points
are added, the mapping function is extended to take
account of the new points and a new surface is interpolated from the previous one. The outlining process

367

For a proper If? interpolation of sparse CT contour
data points x (z,y,z), it was found that the linear
spline function together with a p l polynomial was giving the best interpolation.

p1 (x)= CO

+ c1z + c2y + c3z

(5)

The nodes of interpolation x are now a subset of
the primitive object envelope and f ( x ) the data points
placed on the contour boundaries by the oncologist.
s(x) defined by equation 2 becomes the primitive object transformed by the displacement field previously
defined, and interpolates the sparse contour data. In
order to find the coefficients X i of the RBF function
and the coefficients of the polynomial pl the linear system 6 is solved:

Fig. 2. Mapping function based on the smallest distance

is obtained by solving the system of N + 1 linear equations, constrained by

and by
n

p i = 0

(4)

i=l

for n

+ 1 unknown expansion coefficients X i
Actually, because radial basis functions only deal
R interpolation, three systems have to be
with Rd
solved. We consider f ( x ) as its three independent variables ( f z , f Y ,fi).

This formulation of the interpolation problem defined
with an added constant p to the expansion and the
coefficients constrained to be zero was first given by
R.L. Hardy [lo], [ll].

if we call H the matrix

p is in fact the low degree polynomial pm(x)which
accounts for the fact that radial sums give poor approximations for points far away from the nodes of interpolation. It is a polynomial of degree m and d variables.

and

Using the notation r = IIx - xill, some examples of
the more commonly used RBFs are given below:
we solve
Linear spline: 4 ( r ) = r
Thin-plate spline: 4(r)= r2logr
Gaussian: $ ( T ) =
Multiquadric: ( d ( r )= r2 c 2 ) i

+

368

X

=

(a)

Knowing X,,X,X,
and pl(x), a 3-D mapping is defined by equation 2. Any point of the space can be
mapped using this equation, and in particular any point
from the original primitive object envelop.

a first interpolation is presented t o the oncologist which
may be refined by adding contour data until the resulting contours are satisfactory.

Examples

5.

This section illustrates the use of the RBF interpolation in conformal radiotherapy planning.

'0 c3

0

1

1
I

I
I

3

0

4

5

-_

0

8

0
(=I0
000

0

3

6

0

2

4

7

------

Fig. 4. Rendered mesh objects (patient's skin, bladder,
GTV,rectum)

Figure 4 gives an example of the visualisation capability of the algorithm presented in this paper. Because
meshing information defining 3-D polygons can be attached to the primitive object, a 3-D rendering of the
contours being drawn may be displayed along with the
interpolated contours.

6.

Conclusion

5

This paper has demonstrated the effectiveness of radial basis functions interpolation used together with a
suitable mapping function to solve the organ outlining
problem in radiotherapy.

8

Radial basis functions offer one main advantage over
other methods such as B-Spline tensor products [12] in
the sense that no information about connectivity between the points being interpolated is required. Contour information may therefore be added in a random
manner, either as complete arcs or single points.
Because the mapping function is hidden from the
oncologists, the authors believe that this method
presents an enhancement compared to the warp envelope method currently in use. However, the use of this
method is limited t o datasets which topology is known

Fig. 3. Interpolation at two different stages (The dotted
contours are the real contours being outlined)

Figure 3 shows how the outlining procedure is initiated by drawing three contours. Once these are drawn,

369

a-priori. This was not a problem for this specific application, in which the organs considered are all topologically equivalent to either spheres (closed volumes such
as the bladder or gross tumour volume) or cylinders
(body skin section and rectum). Also, if the primitive
object is defined by a wire mesh, the polygons information is not altered by the 3-dimensional transformation
of the object’s points. Therefore, the interpolated surface can be visualised using the same mesh. This helps
the oncologist by providing, at any time, a 3-D model
of the interpolated data that can be interacted with.

References
S. Webb, The Physics of Three-Dimensional Radiation Therapy, Institute of Physics, Bristol and
Philadelphia, 1993.
S. Webb, The Physics of Medical Imaging, Institute of Physics, Bristol and Philadelphia, 1995.
ICRU (International Committee on Radiation Units), “Prescribing, recording and reporting
photon beam therapy,” ICRU Report, , no. 50,
1993.
D. Terzopoulos, A. Witkin, and Michael Kass,
“Constraints on deformable models: Recovering
3D shape and nonrigid motion,” Artificial Intelligence, vol. 36, no. 1, pp. 91-124, 1988.
W. E. Lorensen and H. E. Cline, “Marching cubes:
A high resolution 3d surface construction algorithm,” Computer graphics (proceedings of SIGGRAPH’87), vol. 21, no. 4, pp. 163-169, 1987.

C. J . Moore, “Computerised conformal radiation
therapy - a critical process,” IEE Computing and
Control Engineering, vol. 6, no. 5 , pp. 205-210,
Oct. 1995.
C. J. Moore and R. I. MacKay, “The implementation of dilation, warping and pushing tools in
structure delineation - definition of target and sensitive tissues with respect to icru50,” XIIth Intl
Conf Computers in Radiotherapy, Utah, USA, pp,
257-258, May 1997.
P. G. Graham C. J . Moore, R. I. MacKay and
P. J. Sharrock, “Innovative structure drawing and
visualisation tools for the icru-50, biomodelling,
conformal radiation oncologist,” World Congress

on Medical Physics and Biomedical Engineering,
Nice, fiance, Sept. 1997.
E. Bardinet, L.D. Cohen, and N. Ayache, “Analyzing the deformation of the left ventricle of the
heart with a parametric deformable model,” Technical Report RR-2797, Inria, Institut National de
Recherche en Informaticlue et en Automaticlue.
[lo] J. Hardy and Y. Pomeau, “Thermodynamics and
hydrodynamics for a modeled fluid,” Journal of
Mathematical Physics, vol. 13, no. 7, pp. 10421051, July 1972.
[ll] R. L. Hardy, “Theory and applications of the
multiquadric-biharmonic method: 20 years of discovery 1968-1988,” Computers and Mathematics
with Applications, vol. 19, pp. 163-208, 1990.
[E]B. Shariat F. Jaillet and D. Vandorpe, “Periodic b-spline surface skinning of anatomic shapes,”
CCCG, Jan. 1997.

370


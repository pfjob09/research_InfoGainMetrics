Deformable organs modeling with multi layer particle systems
Morade AMRANI, Behzad SHARIAT
LIGIM, University of Lyon I
VILLEURBANNE, FRANCE

Abstract

produce the behavior of some cancerous tissues and organs.
In this paper, after a short state of the art of different
modeling techniques susceptible to represent deformable
organs, in chapter 3, we present a methodology for automatic reconstruction of organs’ shape based on multi-layer
particle systems. In chapter 4,we expose the difficulties
linked to these models for the animation of deformable bodies, and our solutions to these problems are demonstrated.
Chapter 5 gives some examples to illustrate the quality of
obtained results.

In this papeK we describe a general methodologyfor reconstruction and animation of volumetric deformable objects. In the scope of a medical application, we want to
simulate the motion and the form alteration of the internal
anatomical organs. Multi-layer particle systems are well
adapted to represent the geometry. However several probletns occurs related to the structure of our model and the
nature of internal forces. For this, we have introduced the
necessary tools to overcome these problems and to handle
the dynamic and deformable behavior of cancerous tissues
and organs. Our particle system seems to be suitable to
be integrated in a radiation dose evaluation software, developed within the European BIOMED2-ARROWproject by
North Western Medical Physics team, in Manchestel:

2. State of the art of the most relevant modeling
techniques
In the area of modeling and simulation of deformable
bodies many research works have been carried out. The
most common way for elastic materials is to use finite difference or finite element techniques by approximating the
body with a mesh of nodes of fixed topology [ 131. However,
these techniques are not well adapted for the animation of
materials able to accept large inelastic deformations.
In another approach, the shape of an unknown object is
calculated by the deformation of a primitive to fit the data
points [9]. Later, the deformable superquadrics have been
introduced by Terzopoulos [ 141. The reconstruction method
proposed by Terzopoulos consists in applying some external
forces to deform the superquadrics. Similarly, a methodology of 2D contour reconstruction using snakes [2] and
another using hyperquadrics [ 11 have been proposed. Nevertheless, these methods are able to reconstruct shapes that
are homeomorph to the chosen basic primitives. Moreover,
these methods suffer from the same handicaps that have
been mentioned for the preceding ones.
A last class of reconstruction methodologies uses implicit functions. They allow to extract an iso-surface either
by a procedural method, or skeletal implicit surfaces (surfaces generated by a field function and a skeleton).
The main problem of the methods of the first category is
to find a field function that is only defined in the vicinity of
the surface to be reconstructed. Moreover there should exist
a potential for which the corresponding iso-surface passes

1. Introduction
Conformal Radiotherapy aims at delivering a lethal ionizing radiation dose to cancerous regions causing a minimum of damage to surrounding healthy tissues.
Classically, the patient is supposed to be rigid and motionless during the treatment. However, in practice, the patient does not remain still. Furthermore, the internal interacting organs subject to internal and external forces are dynamic and deformable. This may result in an insufficient
exposure of treatment volumes and an unsafe radiation of
normal tissues. A solution to this problem is to model the
patient’s external and internal organs’ shape ( the treatment
volume and its neighboring organs). This will permit us to
obtain a dosimetric calculation and to have a better understanding of what happens during the treatment.
In this context, the physically-based particle systems
seem to be a serious candidate. These systems permit to
model deformable materials using the ideas from molecular dynamics. Hence they can model plastic, elastic, viscoelastic and fracture behaviors of different materials. In
this model it is also possible to introduce several kinds of
geometrical constraints such as volume conservation to re-

35 1
0-7695-0743-3100
$10.00 0 2000 IEEE

seems to be the most adapted for deformable objects modeling since many behaviors can be simulated.
In the aim of simulation, the organs’ shape has first to
be reconstructed. In our context, the initial data is a set
of points organized in parallel sections. Indeed, this kind
of data can be obtained from CT scans, commonly used in
medical area. From this data, the organs volume boundaries can be computed by a triangulation or a closed spline
surface [4], or an implicit surface [lo]. The reconstruction
method we use consists in gradually filling this volume with
particles, and then let them evolving to a stable state. Thus.
we easily obtain a regular sampling which corresponds t o a
maximal filling. Unfortunately, if we want to increase the
precision of the resulting model, we need to decrease the radius of the particles that will dramatically increase the number of particles. To solve this problem, we have developed
a multi-layer model.

through all the data points.
In [16], a method is proposed to reconstruct objects
described by cross-sectional images, in which the pixels’
value corresponds to the X-ray attenuation. This method is
automatic and allows to reconstruct objects with complex
shapes. However, it is difficult to reconstruct the objects
for which the boundary does not correspond to an intensity
change.
Muraki was the first to employ skeletal implicit surfaces
to reconstruct objects described by scattered data. In [SI,
Muraki proposes an automatic method to model the objects
with a blended union of blobs. The reconstruction process
converges extremely slowly (1 or 2 days of calculation).
Tsingos and all [ 151 have improved Muraki’s method.
An object is modeled by a blended union of blobs. But, to
reduce the computation complexity, a blob is defined by a
local field function.
A non-iterative method has been introduced, in [ 3 ] to reconstruct branching objects from a cloud of points. The
skeleton is thread-like, composed of several B-spline curves
which are surrounded with a non-uniform field. Each curve
generates an implicit surface and the object is modeled with
a blended implicit surface.
In [IO] authors propose a non iterative methodology
based on the use of a connected weighted skeleton and a
uniform field function. This approach permits to reconstruct
the shape of an object of any topology, from the data points
organized in parallel sections.
Despiteof their very interestingcapabilities, implicit surfaces are not very well adapted to large deformations and to
non isotropic behavior during a deformation.
In this context, a good choice is the particle systems
which are presented in the next section.

Figure 1. Multi-layer particle system

The key idea is to place small particles were det.iil\
required and big ones elsewhere (Fig. I ! :
0

;ire

the center is composed of particles of g r e ~t x i l u b .
They are the kernel of the object.
the center is surrounded by one o r more lave15 \ i i l h
decreasing radius as we get closer t o the boundaries.

The coherency of each layer is preserved by virtual wparations between layers. Then, the reconstruction proiess
can be repeated for each layer [ 5 ] ,as shown on figure 2 .

3. Multi layer particle system
Particle systems consist of a set of solid spheres whose
movement follows physical laws. They were first introduced by Reeves [ 1I], who used non-interacting particles
for the modeling of physical phenomena and fuzzy objects
like explosions, clouds and smoke. For deformable objects
modeling, this simple model has to be improved by the introduction of internal forces between particles to preserve
the cohesion of the object. In [12], the authors propose a
surface model with oriented particles, which allows joining,
cutting and extending of deformable surfaces. Particle systems have also been used to model deformable volume objects. In [ 6 ] , Lombard0 and Puech describe a way to model
deformable objects, and particularly muscles, with oriented
particles and implicit surfaces, and Meseure and Chaillou
apply the particle systems to the simulation of the dynamic
behavior of human organs [7]. So, particle systems model

Figure 2. Femoral head reconstruction

4. Animation and deformation of particle systems
Particle systems are well adapted for the animation of
deformable objects. The particles are subject to physical

352

forces that induce their movement. Thus, these forces will
determine the particles’ displacement, and by extension the
object’s shape alteration. We can distinguish several types
of forces:
0

external forces, that define the environment in which
evolve particles (gravity, collision with obstacles,
damping ...)

Figure 3. Layer structure alteration
0

internal forces that ensure shape coherence or volume
preservation (attractiodrepulsion, auto-collision)

It is possible to handle a wide variety of behaviors, simply by changing force formulation and its parameters.
If there is no change in the topology of the objects (objects
that do not undergo large deformations), the internal forces
could be represented by a network of masdspring elements.
This reduces greatly the complexity of the system. The interaction between particles is then simplified and modeled
with the help of springs that can be written as follow :

big particles into smaller ones when they are in contact with
the external world. This permits to maintain the coherency
of the multi-layer organization. While subdividing, it is important not to introduce perturbation in the system: volume
and energy must be preserved. This is achieved by replacing a particle P of radius R, mass M and velocity V by
n particles of radius R‘ = 4 ( D is the dimension of the
nD

space, 2 or 3). For a minimal volume loss, we use the face
centered cubic (or hexagonal in 2Dj packing of the new particles which is the most compact packing of spheres. With
regards to the momentum and kinetic energy preservation,
each new particle must have the same velocity V as the subdivided one, and a mass m equal to
:

:

where k, and k d are the spring’s elasticity and damping constants, lo is the initial length, Fand Care the relative position
and velocity of two adjacent particles. The constants defines the characteristics of the organ: rigidity depends on IC,,
while deformability depends on k d . This permits to model
different behaviors from rigid to elastic state. Elastic and inelastic deformations can also be handled by a combination
of simple springs. Cutting may also be easily simulated by
removing springs in contact with the cutting tool. This can
be very interesting for surgery simulations. However, the
fusion of objects is difficult to obtain.
For very deformable object, and in general case, the spring
system is not sufficient. We use non coupled interaction
forces like Lennard-Jones force to model internal interactions :

(momentum)

The evolution of a bi-dimensional object cut by a tool is
presented in figure 4.

Figure 4. Layer structure preservation

4.2. Volume constrained deformation

where m and n are called the shape parameters, T O is the
equilibrium distance, r the distance between two particles
and E the force amplitude.

One of the important points that should be handled when
modeling deformable objects is the control of the object’s
volume during the deformation. This problem is more important for organs’ simulation, since we wish to obtain a
more realistic behavior. In some applications, we want to
preserve object’s volume during the deformation process.
On the contrary, in other applications we may ask for a
change of object’s volume. This is the case for example during simulation of some organs like the lungs whose volume
increases or decreases during respiration, or the rectum’s

4.1. Dynamic layer structure
During a deformation, the big particles of the kernel
could get too close to the object surface, altering the layer
structure of the model. This modifies the physical properties of the object, and make the deformations incoherent
(see figure 3 j. To prevent this to occur, we have developed
an adaptive deformation method. The idea is to subdivide

353

- let the system evolve.

and bladder’s filling/emptying process. Consequently, we
should be able to control the volume changes.
Particle systems are really adapted to handle this constraint. Indeed, since this model is a volume sampling of
the initial object, an approximation of the volume can easily be found. For each particle Pi of radius Ri in the system,
we define an equilibrium ray Rei = Ri. The object’s volume can then be computed as the sum of all the particles’
volumes :
4

V=

Of course, the same algorithm can be used to decrease the
object’s volume.
The figure 5 shows an object which increases its volume by
increasing the equilibrium radius of its kernel’s particles.

E(-nReg)
3
i

Then, when computing the internal force between two particles Pi and Pj, the equilibrium distance Ro (or lo for
springs interaction) between these particles must be :

Figure 5. Object’s volume increasing

Ro = Rei + Rej

43. Shape preservation with skeleton

During the deformation, particles tend to reach their most
stable state, which corresponds to their equilibrium distances. In this case, the particles try to keep their respective
distances in a manner to minimize the whole system’s energy. This avoids the creation of holes in the system. Thus,
the object’s volume is naturally preserved.
In the same way, to change the object’s volume we have just
to modify the equilibrium radius of some particles. Indeed,
for a particle Pi,if we change Rei to Re:, its volume is
modified, therefore the object’s volume changes. The problem is to know how to change the equilibrium radius to obtain a specific volume variation. For this, we first choose the
particles that will be modified. Generally, internal particles
are preferable to avoid the creation of holes on the object’s
surface. Let N be the number of these particles. Then, the
following algorithm gives the different steps to increase the
object’s volume of a quantity AV in a time At :
0

The most significant problem of particle systems is the
shape preservation during the deformation process. Since
particles move according to physical laws, the system tries
to minimize its energy. This often leads to a spherical clustering of the particles, leading to the loss of the shape of
the modeled organ (see figure 6 ) . In a first approach, we
tried to use the object’s kernel to preserve the shape. Thus,
we have introduced additional forces that preserve relative
position (distances and angles) of kernel’s particles. However, the shape information given by the kernel is not sufficient. Indeed, the kernel only describes the object’s shape
very roughly. The most important shape information is
where small particles are used to obtain higher precision.
Then, it is necessary to introduce additional constraints on
all the system’s particles. But this leads to a less deformable
model, as in a masskpring system. Our solution to this

computing the number of stepsw between the times t
andt At :

+

A

At
n,tep = - where dt is the time step
dt
0

computing the volume change at each step

Figure 6. A falling object : the system minimizes its energy and the object’s shape is
lost

dV
dV = -and then for each particle dV, = -

N

nstep

which iduces the following equilibrium radius change :

0

then, for ti = t to ti = t

problem is the introduction of a skeleton in the system,
whose role is to preserve the shape of the object. To compute this skeleton, we use a subdivision of the object with a
set of boxes. The organ’s bounding box is first computed.
This box is then subdivided into smaller ones according to
the following criteria :

+ At by step of dt

- for each particle P to be increased, compute the
new Re

0

354

boxes should have a size less than a MAX threshold.

0

0

boxes should have a size greater than a M I N threshold.

time. Secondly, undesirable merges of organ’s parts can
also be avoided by introducing repulsion forces between
non-interacting particles that get too close to each other. Finally, the skeleton can be used to simulate organ to organ, or
organ to some external fixed points (on a bone for example)
linkage. To do so, we only need to introduce an interaction
force (spring or Lennard Jones) between a node of an organ,
and a node of another organ or an external fixed point.

boxes should have a filling percentage of particles
(density) greater than a given threshold.

At each subdivision step, sub-boxes are reduced to the
bounding boxes of their included particles. When all boxes
verify the previous criteria, the subdivision is complete.
At the end of the process, each box generates a node of
the skeleton. This node is associated to the particles included in the box. The mass center of these particles, and
the sum of their masses, define the position and the mass of
this node. After computing all the nodes, we define a neighboring relationship between them. This can be done easily,
considering that two nodes are neighbors if they are issued
from two neighboring boxes (see figure 7). To preserve the

5. Application to organs’ simulation
The figure 9 shows an example of a simulation using our
method. It shows the movement of the prostate under the
action of the bladder growing and the rectum decreasing. In
this example, the bladder grows to 200% of its initial volume, whereas the rectum’s volume is decreased by 30%.
We note a little displacement of the prostate, which seems
to be coherent with the reality. Figure 10 shows the initial
and final contours of the modeled organs. This permits to
highlight the organs’ volume changes as well as their displacements. The Bladder’s model required 300 particles,

Figure 7. Skeleton computation
shape of the modeled organ, we introduce interaction forces
(springs or Lennard Jones) between neighboring nodes. So,
at each time step, we compute for each node, all the applied
forces due to its interaction with its neighbors. Then, these
forces are distributed among the particles associated to the
node. The corresponding particles move under the action
of the node, as well as other internal (inter particle) and external (collision, gravity, ...) forces. Then, after each step
we update the node’s position as the new mass center of its
associated particles.
Thus, skeleton forces control global deformations of the organ, and preserve its shape. Whereas internal forces between particles control the local deformations (see figure 8).
The use of a skeleton offers other advantages. First, by

Figure 9. Bladder, prostate and rectum interactions

Figure 10. Organs’ movement and deformation highlighting
Figure 8. A falling object : the skeleton preserve the shape during the deformation
200 particles for the prostate and 170 for the rectum. The
figure 9 was extracted from an animation producing 1500
frames which required 30 minutes of computation. The
computing rate is 1 frame every 2 seconds. This simulation has been carried on a PC pentiumII1-466Mhz with 528

reducing inter particle interactions to the interaction between particles associated to the same, or to some neighboring nodes, we can considerably reduce the computation

355

megabyte of RAM memory, and without any graphic acceleration card.

[5] E Jaillet, B. Shariat, and D. Vandorpe. Deformable
object reconstruction with particle systems. Computers & Graphics, 22(2-3): 189-194, March 1998.

6. Conclusion

[6] J.-C. Lombard0 and C. Puech. Oriented particles: A
tool for shape memory objects modeling. In Graphics
Interface’95, Quebec City (CAN),May 1995.

In this paper, we have presented a new modeling technique of deformable organs based on a multi layer particle
system. These models are able to simulate different organs’
behaviours from solid to fluid state. Moreover, the use of
particle systems will avoid the difficult problem of the calculation of collision forces and contact surfaces between
objects.
However, during a simulation process, the multi layer
particle system can suffer from some unwilling behaviours:
0

perturbation of the multi layer structure

0

control of objects’ volume

0

spherical clustering of the particles

0

computation time

[7] P. Meseure and C. Chaillou. Deformable body simulation with adaptive subdivision and cuttings. In 5th
Int. Con$ in Central Europe on Comp. Graphics and
Visualization WSCG’97, Plzen, CZ, pages 361-370,
February 1997. IFIP working group 5.10 on Computer
Graphics and Virtual Worlds.
[8] Shigeru Muraki. Volumetric shape description of
range data using ”blobby model”. Computer Graphics, 25(4):227-235, July 1991.
[9] Alex Pentland. Perceptual organization and the representation of natural form. Artijicial Intelligence,
28(3):293-331,1986.
[lo] Serge Pontier, Behzad Shariat, and Denis Vandorpe.
Implicit surface reconstruction from 2d ct scan sections. In Proceedings of the Computer Graphics International 1998, pages 583-586. IEEE Press, June
1998.

We have solved these problems by proposing a dynamic
multi layer system and a dynamic skeleton. This skeleton
not only permits to avoid the spherical clustering of the system but also permits to accelerate the computation time of
the simulation of the interaction between neighbouring organs.
In the context of the european BIOMED2-ARROW
project, the proposed modeling technique is actually integrated in a global treatment system for a clinical validation
for a dynamic dosimetric calculation.

[ 111 W. T. Reeves. Particle systems: a technique for modeling a class of fuzzy objects. In Proceedings of

SIGGRAPH’83, pages 359-376. Computer Graphics,
1983.
[ 121 R. Szeliski and D. Tonnesen. Surface modeling with

oriented particle systems. Technical Report CRL
91/14, DEC, Cambridge Research Lab, December
1991.

References

[ 131 D. Terzopolous and K. Fleicher. Modeling inelastic

Isaac Cohen and Laurent Cohen. A hybrid hyperquadric model for 2-d and 3-d data fitting. Technical
Report 2188, INRIA, January 1994.

deformation: viscoelasticity, plasticity, fracture. In
Proceedings of SIGGRAPH’88, pages 269-278. Computer Graphics, 1988.

B. Derdouri, M. Neveu, and D. Faudot. Reconstruction d’objets 3d deformables. Acres de GROPLAN 92,
Nantes, pages 99-106, November 1992.

[ 141 Demetri Terzopoulos and Dimitri Metaxas. Dynamic

3d models with local and global deformations: Deformable superquadrics. IEEE Transactions on pattern analysis and machine intelligence, 13(7):703714, July 1991.

Eric Ferley, Marie-Paule Gascuel, and Dominique Attali. Skeletal reconstruction of branching shapes. In
Implicit Surfaces’96: 2nd International Workshop on
Implicit Surface, Eindhoven, The Netherlands, October 1996.

[15] Nicolas Tsingos, Eric Bittar, and Marie-Paule Gascuel. Implicit Surfaces for Semi-automatic Medical
Organ Reconstruction, chapter Techniques in Modelling Virtual Environments, pages 3-15. Academic
Press, Leeds, UK, June 1995.

E Jaillet, B. Shariat, and D. Vandorpe. 3D surface
modeling from planar sections. In Optical 3 0 Measurement Techniques W ,Zurich, CH, pages 430-435,
October 1997.

[16] A. Wallin. Constructing isosurfaces from ct data.
IEEE CG and A, 11(6):28-33, November 1991.

356


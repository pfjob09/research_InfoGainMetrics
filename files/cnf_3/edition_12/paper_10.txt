A Rational Spline for Visualizing Positive Data
Muhammad Sarfraz', Malik Zawwar' Hussain, Sohail Butt3
'Department of Information and Computer Science, King Fahd University of Petroleum and Minerals
KFUPM # 1510, Dhahran 31261, Saudi Arabia.
'Department of Mathematics, University of the Punjab, Quaid-I-Azam Campus,
Lahore, Palustan.
3Departmentof Business and Management, College of Business Administration,
University of Bahrain, Bahrain.
Email: sarfraz@kfupm.edu. sa

Abstract
A piecewise rational cubic spline has been
introduced to visualize the positive data in its natural
fom. It is attempted that the spline method preserves the
shape of the data when it is positive. The spline
representation is interpolatory and applicable to the
scalar valued data. The shape parameters, in the
description of the rational cubic, have been constrained
in such a way that they control the shape of the curve to
avoid any noise. As far as visual smoothness is
concerned, the curve scheme under discussion is C'.

1. Introduction
In Computer Graphics
a
is usually
Of an interpolatorY scheme which Possesses
ceaain characteristics like shape preservation, shape
control, etc. Particularly when a data from some
scientific observation is under discussion, a
is
always interested to visualize it graphically in a pleasant
way. Various authors [ l - 221 have discussed the issues
of distinct shaped data like monotonic data or convex
data etc. This paper examines the problem of shape
preservation of a positive data arose from some scientific
phenomena or from some mathematical function.

in need

area may be the observation of gas discharge when
certain chemical experiment is in process. Therefore, it is
very important to discuss positive interpolation problem
(the interpolation in which the curve is positive
everywhere) to provide a computationally economical
and visually pleasing solution to the problems of
different scientific phenomena in everyday life.
Recently some interest has been shown, in this area,
by Schmidt & Hess [21] and Butt & Brodlie [3]. Schmidt
and Hess [21] have used cubic polynomials and derived
the necessary and sufficient conditions to make the
interpolant positive. They also have given comparatively
simpler sufficient conditions that make the basis of their
interpolation algorithm in which the slopes at data points
are estimated. The problem of positvity when the slopes
at data points are given is discussed in [ 11 and [ 171, Butt
and Brodlie in [I] have used cubic polynomials in the
development of their scheme where as Sarfraz et al in
[17] have used C' piecewise rational cubic functions
with cubic numerator and quadratic denominator.
This work is also related to the positive
interpolation. The interpolant used is a piecewise rational
function in a C' form. This interpolant has already been
used in different contexts in [15] and [19]. The rational
functions used in this scheme have some freedom in the
form of parameters, in each interval, which can control
the shape of the curve. The subject of this paper is to
search for appropriate constraints on the shape
parameters so that the resultant curve is positive for
positive data. Moreover, it is also desired that the degree
of smoothness is visually acceptable.

Positivity is very important aspect of shape. There
are many physical situations where entities only have a
meaning when their values are positive. For example, in
a probability distribution the presentation is always
positive or when dealing with the samples of populations,
the data is always in positive figures. Another application

57
0-7695-0743-3/00 $10.000 2000 IEEE

hidi

ui = A . zi = fi+l,v, =A+---,

The method under consideration in this paper has the
following important and advantageous features that no
additional points (knots) need be supplied. In contrast,
the quadratic spline methods of Schumaker [22] and the
cubic interpolation method of Brodlie and Butt [l]
require the introduction of additional knots when used as
shape preserving methods. Moreover, already existing
algorithms like de Castlejau algorithm can be used for
rapid computations. Another interesting feature of this
scheme is that it recovers the curve method in [17] as a
very special case.

Vi

and

wi = fi+l--,hidi+l

where S o ) denotes derivative with respect to nand
di denotes derivative value given at the knot x i . This
leads the piecewise rational cubic (2.2) to the following
piecewise Hermite interpolant s E C' [xl ,x,

1:

The paper has been organized in such a way that
Section 2 describes about the Hermite Rational Cubic
interpolation. The problem of positivity is discussed in
Section 3 and Section 4 concludes the paper.

where

6 (e)=f i (1-e? + vivie(i-e>z+ wiwie2(1 -e)+ fi+le3

2. Rational Hermite Cubic Spline

and

Let ( x i , f i ) , i= 1,2,......, n, be a given set of data
points, where
XI

Qi(e)=(i-eY +V,e(i-e>z + w i e 2 ( i - e ) + e 3

< x2 < ... < x, .

The parameters v i , wi ' s , and the derivatives di ' s are to
be chosen such that the monotonic shape is preserved by
the interpolant (2.6). One can note that when vi = 3 = w i ,
the rational function (2.6) obviously becomes the
standard cubic Hermite polynomial. Variation for the
values of vi, wi ' s , control (tighten or loosen) the curve
in different pieces of the curve. This interval shape
control behavior can be observed by rewriting S i ( x ) in
Equation (2.6) to the following simplified form:

Let

hi =

-xi,

and

Ai =- f i + l - f i , i = 1 , 2,...,n-1.
(2.1)
hi
Consider the following piecewise rational cubic function:
s(x) =

s ( x ) = f i (1 - e)+ fi+l e +
[(l- OXd, - Ai )+ e(Ai - di+l)biO(l
-e).

+ vivie(i- e)2 +
wiwie2(1- e)+ fi+'e3
si( x ) =
(1 - ey + vie(i - e)2 + wie2(1 - e)+ e3
fi

(1 - e?

Qi

When

(2.2)
where
x - xi

e=-

hi

(2.5)

vi

v i ,wi + 0,

(2.7)

(0)

it is simple to see the convergence

to the following linear interpolant:
(2.3)

s ( ~=)

To make the rational function (2.2) C', one needs to
impose the following interpolatory properties:

(1 - e)+ &+,e.

(2.8)

It should be noted that the shape control analysis is valid
only if the bounded derivative values are assumed. In
most applications, the derivative parameters {d, }are not
given and hence must be determined either from the
given data (xi,f i ), i = 1,2,....,n, or by some other means.
In this article, they are computed exactly from the
arithmetic approximation scheme in [ 161. The
smoothness of the interpolant (2.6), hence would be C'.

S ( x i ) = f i , and S ( X ~ + ~ f)i =+ l ,

S ( ' ) ( x i ) = d i , and S ( ' ) ( X ~ + ~ ) = ~ ~ + ~ (2.4)

which provide the following manipulations:

2.1. Demonstration
58

For the demonstration of this C' rational Hermite
cubic spline scheme, we will choose the following choice
of shape parameters:

In this paper we shall develop necessary and
sufficient conditions on piecewise rational cubics under
which C' positive interpolation is preserved. We
describe the rational cubic spline S on the grid
xl < x2 < ... < x, . The key idea to preserve positivity
using S(x) is to assign suitable values to v i , wi ' s , in each

However, other values of shape parameters can also be
allocated for the achievement of a controlled curve. The
Figures 1 and 2 are the default curves to the positive data
in Table 1 and Table 2, respectively. It can be seen that
the ordinary spline curve does not guarantee to preserve
the shape. Some negative behaviour can be seen in the
presentation of the curve.

interval. But first we determine conditions for v i , w;' s ,
which guarantee positivity.

As vi,w;2 0 guarantee strictly positive denominator
Qi ( t ) , so initial conditions on vi, wi ' s , are:
v;,wi 2 0 .

3. Positive Interpolation
The rational spline method, described in the previous
section, has deficiencies as far as shape preserving issue
is concerned. For example, the rational cubic in Section 2
does not preserve the shape of the monotonic data (see
Figure 1) in Table 1. Very clearly, this curve is not
preserving the shape of the data. Thus, it is required to
assign appropriate values to the shape parameters so that
it generates a data preserved shape. Similarly an
unwanted behaviour can be observed in Figure 3 for the
data set in Table 2. Thus it looks as if ordinary spline
schemes do not provide the desired shape features, some
further treatment is required to achieve a shape
preserving spline for positive data.

(3.2)

Since Q,(t)>0 , for a l l v , , ~2, 0 , so the positivity of
SI ( x ) = P, ( t ) / Q, ( t ) depends on the positivity of cubic

polynomial P,(t). Thus, the problem reduces to: For
what values of vl , w,'s, the cubic polynomial 4 ( t ) is
positive?

4 ( t ) can be expressed as follows:
4 ( t ) = a i t+3P i t 2 + y ; t + 6 ; ,

(3.3)

where

a; = (1 - W ~ ) Y ; + ~(1 - vi)yi +

The proposed way, which is effective, useful and is
the target of this article, is the automated generation of
shape preserving curve. This requires an automated
computation of suitable shape parameters. To proceed
with this strategy, some mathematical treatment is
needed which has been explained in the following
Subsection.

+dj)h,

y, = h,d, - (3 - v;)Y;

6; = y ;
Now according to Schmidt and Hess [21], a cubic
polynomial p i ( t )> 0 , if and only if

3.1. Positive Rational Cubic Spline

(P'i (O), p'i (1))E R,UR,.

where

R,

= { (a,b):
36y,yi+,((a2+ b 2 + a b - 3 A j ( a +b))+3Aj2)+

let us construct an interpolant S, which is positive on the
whole interval [xl ,x, That is,

1.

3(yi+lU- y;b&h;ab - 3y;+la+ 3Yib)+
4h,(y,+p3- y j b 3 ) -hj2a2b2> 0

S ( x ) > O , XI I x l x , .

59

>.

(3.4)

This gives

and

Further
p ' i ( l ) = d , + _] Y " l ( W i
hi

l II I-

2-

( P ' ;(01p ' i (1))~R, ,

-3).

1

(3.6)
where
41 (Vi

) = P ' i (o), 4 2 (w;) = p ' i (1)

-20

This leads to the following:
Theorem 1: The rational cubic polynomial (2.1)
preserves positivity if and only if either (3.5) or (3.6) is
satisfied.

Figure 1: Cubic Hermite Spline curve to the data
in Table 1.

Remark 1: Although vi, w i ' s , satisfying (3.6), can be
determined but it requires a lot of computations. So an
efficient and reasonably attractive result can be obtained
by conditions given in (3.5)
Remark 2: This method can be used in both cases when

either d i ' s are particularly specified or estimated by
some method.

~
y

I

~ 1 ~ 2 ~
14 I 8 I 3 I 0.8

I

3 ~ 8
0.5 1 0.45

I

~ 1 0 ~
0.4 1 0.37

Table 1: A positive data showing depreciation in
the computer price.
Figure 2: Shape preserving Rational Cubic
Spline curve to the data in Table 1.

3.2. Demonstration
First example is regarding a lot of computers which
were bought by a university and were installed in its
Computer Center. Due to continuous usage and
availability of latest technology in the market, the
computers depreciated there market prices. Due to the
depreciation, the evaluation of the market price was
noticed at different stages of time, which has been
displayed in Table 1. At the end of first year, the price

The relation (3.4) is true when

60

1

1

~

1

Application of the Hermite cubic spline method (see
Section 2) produces the curve in Figure 1. This curve
shows negative prices which is misguiding. We now
apply piecewise rational cubic of Section 3 to the same
data. The Figure 2 is produced by the default settings of
the parameters v i , wi satisfying the positive conditions
derived in Section 3. One can see that the positivity
nature of the data is preserved in a pleasing way.

was evaluated as $ 14,0000/- and it depreciated to $
3700/- after 14 years. One can note that all the data
values are positive I Table 1.
Visualization of this information is maintained in
Figures 1 and 2 implementing the schemes in Section 2
and 3 respectively.

Second example is regarding a data taken at random
in Table 2. The curve in Figure 3 is due to Hermite cubic
spline method (see Section 2). This is not a desired
display as some negative portion of the curve is also
noticed in certain time limit. The Figure 4 is produced by
the default settings of the parameters v,, w, satisfying
the positive conditions derived in Section 3. One can
observe that the curve is positive and visually pleasing.

Table 2: A positive data taken at random.

4. Conclusions and Suggestions
C' piecewise rational cubic Hermite interpolant has
been utilized to obtain a C' positivity preserving curve
method. Data dependent shape constraints are derived on
the shape parameters to assure the positive shape
preservation of the data.
Choice of the derivative parameters is considered to
be the approximation through arithmetic means.
However, it can be left at the wish of the user as well.

Figure 3: Cubic Hermite Spline curve to the data
in Table 2.

The scheme has been implemented for scalar valued
curves whereas the search, for the planar curves, is under
the consideration of the author.
Although, the proposed curve scheme is visually
enough smooth and presents a reasonably acceptable
demonstration of the positive data. But a higher degree of
smoothness, while stitching the pieces of curves, may
enhance the visual display. The author is interested to
have look at this issue in the future work.
This curve scheme could also be generalized to the
surface case. The author is keen to discuss it in a
subsequent paper.

Acknowledgement
The author acknowledges the support of Pakistan Science
Foundation (PSF), against Project No. P-PU/Maths(17),
in the development of this work. The author also likes to
thank referees for their valuable comments in the
improvement of this manuscript.

Figure 4: Shape preserving Rational Cubic
Spline curve to the data in Table 2.

61

References

[12] Lahtinen, A., (1996). Monotone interpolation with
application to estimation of taper curves, Annals of
Numerical Math. 3,151-161.

Brodlie, K.W. and Butt, S . (1991), Preserving convexity
using piecewise cubic interpolation, Computer and
Graphics 15(1), 15-23.

[13] McAllister, D. F., Passow, E. and Roulier, J. A. (1977),
Algorithms for computing shape preserving spline
interpolations to data, Math. Comp., 31,717-725.

Brodlie, K. W., (1985). Methods for drawing curves, in :
Fundamenal algorithm for Computer Graphics, ed. R.A.
Earnshaw (Springer, BerlidHeidelherg), 303-323.

I141 McAllister, D. F., and Roulier, J. A. (1981), An algorithm
for computing a shape preserving osculatory quadratic
spline, ACM Trans. Math. Software, 7, 331-347.

Butt, S . and Brodlie, K.W. (1993), Preserving positivity
using piecewise cubic interpolation, Computer and
Graphics 17(1), 55-64.

[15] Sarfraz, M., (1999), A Smooth Rational Spline for
Visualizing Monotone Data, The Proceedings of IEEE
Intemational Conference on Information VisualizationIV’99-UK. IEEE Computer Society Press, USA, 372-377.

Constantini, P., (1997), Boundary-Valued Shape
Preserving Interpolating Splines, ACM Transactions on
Mathematical Software, 23(2), 229-251.

[16] Sarfraz, M., AI-Mulhem, M., and Ashraf, F. (1997).
Preserving Monotonic Shape of the Data using Piecewise
Rational Cubic Functions, Computers & Graphics, Vol.
21(1), 5-14.

Delbourgo, R. and Gregory, J. A. (1985). Shape preserving
piecewise rational interpolation, SIAM J. Stat. Computer.
6, 967-976.
DeVore, A., and Yan, Z., (1986), Error analysis for
piecewise quadratic curve fitting algorithms, Comp. Aided
Geom. Design 3,205-215.

[17] Sarfraz, M., Butt, S . and Hussain, M. Z., (1994), The
Proceedings of the fourth Islamic Countries Conference on
Statistical Sciences, ICCS-IV, Vol. 8,251-261.

Fritsch, F.N. and Butland, J. (1984), A method for
constructing local monotone piecewise cubic interpolants,
SIAM J. of Sci. Stat. Comput. 5, 300-304.

[18] Sarfraz, M. (1993), Monotonicity preserving piecewise
rational interpolation, PUJM 26 (1-2), 11 1-118.

Fritsch, F.N. and Carlson, R. E. (1980), Monotone
piecewise cubic interpolation, SIAM J. Numer. Anal.,
17(2), 238-246.

[19] Sarfraz, M., (1992), Interpolatory Rational Cubic Spline
with Biased, Point and Interval Tension, Computers \&
Graphics, 16(4), 427-430.

Gregory, J. R. and Delbourgo, R. (1983), Piecewise
rational quadratic interpolation to monotonic data, SIAM
J. Numer. Anal., 3, 141-152.

[20] Sarfraz, M. (1992), Convexity preserving piecewise
rational interpolation for planar curves, Bull. Korean
Math. Soc., 29(2), 193-200.

[lo] Goodman, T. N, T, and Unsworth, K. (19881, Shape
preserving interpolation by parametrically defined curves,
SIAM J. Numer.Anal., 25, 1-13.

[211 Schmidt, J.W. and Hess, w . (1988), Positivity of cubic
polynomial on intervals and positive spline interpolation.
BIT 28, 340-352.

[ l l ] Greiner, K., (1991), A survey on univariate data
interpolation and approximation by splines of given shape,
Math. Comp. Mod. 15,97406.

[221 Schumaker, L. (1981), Spline functions: Basic Theory,
Wiley.

62


Error Analysis for the Evaluation of
Rational B6zier Curves
J. M. Peiia
Departamento de MatemAtica Aplicada, Universidad de Zaragoza, 50009 Zaragoza, Spain

Abstract

is called rational Bezier curve.
Error analysis of the de Casteljau algorithm for the evaluation of a polynomial has been considered in [7] and [12].
The main goal of this paper is to perform the error analysis
of Farin’s algorithm (seep. 218 of [ 5 ] , [3] or Section 4.1.4 of
[lo]) for the evaluation of a rational Bezier function.
The paper is organized as follows. Section 2 introduces
basic notations and auxiliary results for our error analysis and
contains a forward error bound for the evaluation of a function f ( t ) =
bJr3(t). We compare it with the forward
error bound obtained when using the de Casteljau algorithm
for the evaluation of a polynomial in Bernstein-Bezier form.
The normalized B-basis of a space of functions U is the basis
with optimal shape preserving properties (see [2] and [16]).
The corresponding evaluation algorithm was called in [ 1 11Balgorithm and can be considered as a generalized de Casteljau algorithm. It again provides an evaluation algorithm in
the corresponding space of rational functions generated by a
system derived from the normalized B-basis of U in a similar
way as we have obtained (3) from (2). In Section 3 we show
that our error analysis of Section 2 can be extended to the algorithm for the evaluation of these rational functions. This
section also includes the conclusions.

Rational Bezier curves provide flexibility in curve design.
The goal of this paper is to perform error analysis of Farin’s
algorithm for the evaluation of these curves. It is shown that a
similar error analysis can be applied for the algorithms in rational spaces obtained from spaces admitting shape preserving representations.
-

E,”=,

Introduction

1

In computer-aided geometric design the usual representation
of a polynomial is the called Bemstein-Bezier form. The
Bernstein-Bezier form of a polynomial p ( t ) of degree less
than or equal to n on [0,1]is given by
n

P(t) = CajB;(t),

(1)

t E [0,11,

j=O

where

Bjn(t)=

(3
,

P(1 - qn-’,

j = 0,. .. , n ,

(2)

is the corresponding Bernstein polynomial of degree n. The
usual algorithm used to evaluate a polynomial in the form ( I )
is the de Casteljau algorithm.
Rational Bezier curves allow us to represent many
more curves than the usual (nonrational) Bezier curves, including conic sections (see [ 5 ] , [4],[lo]). Given a sequence of positive weights W O , . . . ,w,, and the Bernstein basis (B,“(t),.
. . , B,”(t)),we have ~ j ” = o ~ j B>~0 (and
t ) so
we can form the system ( r o ( t ) ,. . . ,r,(t)) with

r z ( t ):=

wi By ( t)

t € l i = O , l ) . . . , n.

Cy=’=,
wjB;(t) ‘

2

Main result

Let us now introduce some standard notations in error analysis. Given a E R, the computed element in floating point
arithmetic will be denoted by either fl(a) or by b. As usual,
to investigate the effect of rounding errors when working with
floating point arithmetic we use the model
fl(aopb) = ( a o p b ) ( I

(3)

+ 6):

161 5 U ,

(4)

although we also can use

Then (ro(t),. . . , r n ( t ) )is a basis of the corresponding space
. . Pn E Rd,
of rational functions. Given control points PO,.
the generated curve
~

fl(a0pb) = (aopb)
~

(1 + E ) ’

I&[5 U ,

(5)

n

dt)

=

CP3m

with U the unit roundoff and op any of the elementary operations +, -, x , / (see pp. 44-45of [9] for more details). Given

j=O

470

0-7695-1195-3/01 $10.00 0 2001 IEEE

k E No such that k u

<< 1,let us define

ku
Yk := -- icu
1- k u

with

+ O(u2).

In our error analysis we shall de,al with quantities satisfying
that their absolute value is bounded above by Yk. Following [9] we denote by e k such quantities and let us take into
account that, by Lemmas 3.3 anld 3.1 of [9], the following
properties hold:

Therefore, for all k = 1,.... n,we can write

Analogously, (9) implies that, for all j = 0 , . . . ,n - 1,

where U j is the (n- j ) x ( n - j
Given a sequence of real coefficients bo,.. . , b n , let us
consider the rational Bernstein-Bezier function f given by
f ( t ) = Cy=o
btr,(t), t E [0,1]and r,(t) given by (3). If we
want to evaluate f at t E [0,1], we can apply the following
Farin's algorithm, which is a de Casteljau type algorithm and
will be called rational de Casteljau algorithm (see p. 218 of
[ 5 ] , [3] and Section 4.1.4 of [IO]). If b! := b, and w! := wt
for all a = 0, . . . .n then this algorithm produces the coefficients br ( r = 1, .... n,2 = 0 , . . . .n - r ) as follows:

uj

1-t

t

0

1-t

+ 1) matrix of the form

0

......

t

'..

. .. . ..
... ...

=

...... 0

0

0

.

.

...

0

1-t

t

Therefore, for all IC = 1..... n, we can write
w(k) = Uk-1

... uow(o).

From the recursive definition of w$ (see (9)) and (4),we
canwriteforall k = 1,... , n

with
w,' = (1 - t

) W y

+ tw;;;,

?;i = u$(1 + J;),

(9)

Then f ( t ) = b;. From now on, given a coefficients vector b(O) = (bo,. . . ,bn)T E Rn+' and a weights vector
W(O) = (WO, . . . , w n )
E Rni-l,we shall denote by b(')
and w ( ~ )respectively,
,
the vectors in Rn+'+ given by the
coefficients and weights, respectively, obtained after T steps
of the de Casteljau algorithm: bfr) = (b;:. . . , b';-,)T and
w(r) = (w;(t), . . . ,w;-,)T.
Given A = ( a13, . )l l i5<j Smn'

where

a$ := ((1- t)$-1(1

+

I<j<n

6;= (1 - t)?i;-l(i

Theorem Let f ( t ) =
bir,(t), t E [0,1], and
let f ( t ) be the computed value by the rational de Casteljau
algorithm. Then

+ e,) + $;;(I

+e,)

for all j = 0 , . . . . n - k . Iterating the previous arguments and
using (6) and (14) we can obtain
WO(1 + Q2k)

n

1bj1~ j ( t )

6;;;))

are numbers less than or equal to the
and 16;-ll1 $,I/;
unit roundoff U . Then by ( 6 ) we have

(AI := ( I " i j l ) l Z i & .

~ f ( t-) f ^ ( t ) ~I
~3n2i-5n

+ tG;;;(l+

(10)

3=0

Proof. For all T = 0 , . . .

~

1% -

b(T+1) =

b(r)l
r

where V, is the ( n - j)x ( n - T

v, =

0

..'

0
..

x;
..

y;

0

..
.
......

...
..
.
..
.

.

.

Therefore we can write

(11)

+ 1) matrix of the form

x;; Yo'

..

1 (8) gives

'3

G(k)=

U k P l . . . uo

( (
w(0) +

0

" '

Wn62k
and so

...
x;-,

woe2k))

,G(k)= w ( k )+ Uke1
. . . jyo

0
y-;,

47 1

and, using the nonnegativity of the matrices

6,
we get

l b t - b : ~ I ~3n2+5n~n-l...~OIb(O)I
and then

We conclude that
ldk)

I& - GI

- W(k)l 5 Y 2 k l U k - l l . . . lUol IW(0)I.

From (14) and the nonnegativity of matrices
we derive
p ( k ) -w

Uj and weights,

Then (10) follows taking into account that b(n) = b," = f ( t )
and that (b(o)l(n) is the evaluation by the rational de Casteljau
algorithm of a Bemstein-Bezier rational function with coefficients lbgl = lbol,. . . ,lb:l = lbnl.

( y 5 - y 4 J k - 1 . . . UOW(0)= -/2yzkW(k).

Therefore we can write for all 1 5
7iP)= w ( k ) ( l

k 5 n and 0 5 1 5 n - k

+ 02k).

L ~ 3 n 2 + 5 nIb(O)l(k).

Let U be a finite dimensional vector space of functions
defined on I C R and let U =
be a basis for U.Given
a function f = E&,ctut E U we are interested in measuring the sensitivity of f ( t ) to perturbations in the coefficients
c=
o f f . If g = c y = o ( l 6,)ctu, is related to f by
a relative perturbation 6 = (6,):=, in c, then for any t E I

(15)

Let us now come back to the calculation of the coefficients b:. From the recursive definition of b: (see (8)), (4)and
(6),we can derive for all T = 1,. . . , n

+

(C~)Y=~

n

n

If(t) - g W l

I

= -ptCt%(t)I

I ll~llco

t=O

The number

Applying (15) we get

Ict~t(t)l.

t=O

n

CU(f,t)
:=

Ict.t(t)l,

(17)

a=O

where cT is given by

acts as a condition number for the evaluation o f f at the point
U . We observe that for f,g E U as above

t using the basis
and t E I

If(t) - g(t)l I
&(f, t ) .
and, using (7) and (6),we can deduce that

where E = I1611m. Thus this condition number can be used
to
measure the sensitivity o f f to perturbations in the coeffi-r-1
wr-1
cients. A related condition number for roots of polynomials
= ( i - t )W~; ( i + e 6 r + 2 ) ~ - WT
1+t~(i+s6r+2)~~:.
was considered by Farouki and Rajan in [7] (see also [6] and
[ 141). If we assume that the basis is formed by nonnegative
(16)
Iterating the previous arguments, using (6) and (1 2) and takfunctions (which is a usual requirement in computer aided
ing into account that C h l ( 6 r + 2) = 3n2 + 5n, we can
geometric design), ( I 7) can be written as
derive

6

i=O

bz=Vn-l...Vo

Using this condition number and the basis of rational
functions T = ( T O @ ) , . . . , ~ , ( t ) )of (3), we can reformulate
the Theorem in the following way:

and therefore

Corollary Let f ( t ) =
b t r t ( t ) ,t E [O,11, and
let f ( t ) be the computed value by the rational de Casteljau
algorithm. Then

~ f ( t-) f ^ ( t ) ~5 ~ 3 n 2 + 5 n ~ r ( f t t )

Hence we obtain

472

(19)

We now can compare this formula with that obtained in
for the de Casteljau algorithm for the evaluation of a polynomialp(t) in the Bernstein basis E = ( B g ( t ) ., . . , BG(t))(see
[121):
( P ( t ) - ?j(t)l5 'YznCb(P7 t ) .

w o , .... , w n , we have
w p j ( t ) > 0 and so we can form
the system (ro(t),. . . , ~ , ( t ) with
)

We observe the considerable incxease of the error bound in
the rational case.

Then ( T O , . . . , T , ) is the normalized B-basis of the corresponding space of rational functions.
If we have a B-algorithm for the evaluation of a function then we can also obtain a B-algorithm for the evaluation in the corresponding space of rational functions, which
will be called rational B-algorithm. In fact, we can apply
the key idea of the mentioned Farin's algorithm for the evaluation of a rational curve: if a curve admits a de Casteljautype algorithm then the corresponding rational scheme follows straightforward from it by projection of the non-rational
scheme. More precisely, given a function in U of the form
g ( t ) = C ~ = o ~ l uthe
i ( evaluation
t),
by the corresponding
B-algorithm is given by

3

Extension to B-bases and conclusions

Let U be a vector space of real functions defined on I C R
and (uo(t),. . . , u n ( t ) )(t E I) a basis of U. If a sequence
PO,.. . ,P, of points in Rkis given then we define a curve
P,u,(t),
t E I. The points Po,. . . ,P, are
y(t) =
called control points and the polygon PO. . . P, with vertices
PO,.. . ,P, is called the control polygon of y. If the basis
functions form a partition of the iinity we say that the basis is
normalized.
The collocation matrix of (uo(t),. . . , u,(t)) at t o <
. . . < t , in I is given by

where do)= (QO, . . . , Q , ) ~ and for all j = 0 , . . . ,n - 1 uj
( n - j ) x ( n - j + 1) matrix of the form

A matrix is totally positive if all its minors are nonnegative
and a system of functions is totally positive when all its collocation matrices (20) are totally positive. In interactive design we want that the shape of a parametrically defined curve
mimics the shape of its control polygon; thus we can predict
or manipulate the shape of the curve by choosing or changing the control polygon suitably. In case of a normalized
totally positive basis one knows that the curve imitates the
shape of its control polygon, due to the variation diminishing
properties of totally positive matrices (see [8].[ 11 and [ 161).
If (uo(t),. . . , un(t)) is normalized totally positive then the
curve y inherits many shape properties of the control polygon.
The normalized totally positive bases which present optimal shape preserving properties are called normalized Bbases (see [2], where it is proved its existence and uniqueness). The Bernstein basis and the B-spline basis are examples of normalized B-bases in their corresponding spaces. Associated to any normalized B-basis we construct in that paper
a corner cutting algorithm (which we call a B-algorithm) satisfying the two main properties of the de Casteljau algorithm:
evaluation and subdivision proper1:ies. In the case of the Bernstein basis the B-algorithm coincides with the de Casteljau
algorithm.
Let (uo, . . . .U,) be a normalized B-basis of a given
space U of functions. Given a sequence of positive weights

If we now want to evaluate the rational function f(t) =
E,"=,b3r1(t),we can apply the following B-algorithm (see
for more details [l]), which will be called rational Balgorithm. If bp := b, and wp := w, for all i = O:. . . , n then
we obtain the coefficients b: (T = 1 , . . . , n, i = 0 , . . . , n - T )
as follows:

with

w,'(t) = (1 - u : - ' ) ~ : - ' ( t ) + u ~ - ' w ~ ~ , l . (23)
Then f ( t ) = bg.
Therefore we can apply to this case the proof of the Theorem, replacing the matrices U, by
and the matrices V, by
where
is the ( n - T ) x ( n - T 1) matrix of the form

v,,

nj

v,

-

v,=

+

3;

go'

0

...

0

z;

$1

..

..

..

,

.

473

...

0

.. . ..

..
0

...

.

..

...

0

.

'..
z:-,

0

g-,

Camicer,J.M. and Pena, J.M. (1993), Shape preserving representations and optimality of the Bemstein basis, Advances in
Computational Mathematics 1, 173-196.

with

Farin, G . (1983), Algorithms for rational Bezier curves,
Computer-Aided Design 15.73-77.

As a consequence of the previous arguments, formulae
similar to (19) and (10) also hold for this algorithm with the
basis T = (ro(t),. . . rn(t>)
of rational functions of (21). In
fact we can state the following result, analogous to the Corollary of the previous section:

Farin, G., ed. (1991). NURBS for curve and surface design, SIAM, Philadelphia
Farin, G. (1996), Curves and surfaces for Computer
Aided Geometric Design (4th edition), Academic Press.
San Diego.

Proposition. Let f ( t ) = C ~ = O b , ~
with
, ( tT) ,=
TO(^)^. . . , r n ( t )given at (21) and let f ( t ) be the computed
value by the corresponding rational B-algorithm. Then

Farouki, R. T. and Goodman, T. N. T. (1996), On the optimal
stability of Bernstein basis, Math. Comp. 65, 1553-1566.

(24)
Farouki, R. T. and Rajan, V. T. (1987), On the numerical
condition of polynomials in Bemstein form, Comput. Aided
Geom. Design 4,191-216.

Let us summarize some conclusions. The evaluation algorithm for rational Bezier curves and, more generally, for rational spaces obtained from spaces with normalized B-bases,
is stable, as it could be expected from the fact that the steps of
the algorithm are convex combinations or “weighted” convex
combinations. Besides, formula (19) depends on the condition number of the normalized B-basis of (21) and it is shown
in [ 151 that these bases are optimally stable among the bases
formed by nonnegative functions. However the forward error
bounds are considerably larger than the corresponding ones
for the de Casteljau algorithm and for B-algorithms (which
are similar but using ?an instead of ~ 3 ~ 2 + 5 ~This
) . increase
of the forward error bound does not appear if we use the Balgorithm of some recent alternatives to the rational Bezier
model, as those presented in [13], which also allow one to

Goodman, T. N. T. (1989), Shape preserving representations,
in: Lyche, T. and Schumaker, L.L., eds., Mathematical
Methods in CAGD, Academic Press, Boston, 333-357.
Higham, N. J. (1996), Accuracy and stability of numerical algorithms, SIAM, Philadelphia.
Hoschek, J. and Lasser, D. (1993), Fundamentals of Computer Aided Geometric Design, AKPeters, Wellesley,
MA.
Mainar, E. and Pena, J. M. (1999). Comer cutting algorithms associated with optimal shape preserving representations, Comput. Aided Geom. Design 16, pp. 883-906.

represent large families of curves. These alternative spaces

Mainar, E. and Pena, J. M. (1999), Error analysis of comer
cutting algorithms, Numerical Algorithms 22.41 -52.

are generated by nonrational functions: trigonometric and algebraic polynomials. They also possess normalized B-bases
which correspond to the optimal shape preserving representations and have associated B-algorithms for the evaluation.
These B-algorithms present good stability properties and, as
has been shown, lead to small forward error bounds. But
these alternatives avoid a rational model at the expense of
introducing trigonometric polynomials, which have a higher
evaluation cost than their algebraic counterparts.

Mainar, E., Pena, J. M., Sanchez-Reyes, J. (2001), Shape preserving alternatives to the rational Bezier model. To appear in
Comput. Aided Geom. Design.
Pena, J. M. (1997), B-splines and optimal stability, Math.
Comp. 66, 1555-1560.

Acknowledgment. This work was partially supported by the Spanish Research Grant DGI BFM20001253.

Pena, J. M. (1999), Stability and error analysis of shape preserving representations, in: Pena, J. M., ed., Shape preserving representations, Nova Science Publishers, New York,
1555-1560.

References

Pena, J. M. ( 1 999). Shape preserving representations,
Nova Science Publishers,New York, 85-97.

[I]

Wilkinson, J. H. (1963). Rounding errors in algebraic
processes, Notes on Applied Science 32, Her Majesty’s Stationery Office, London.

Carnicer, J. M. and Pena, J. M. (1994), Totally positive bases
and optimality of B-splines, Comput. Aided Geom. Design 1 1 ,
635-656.

474


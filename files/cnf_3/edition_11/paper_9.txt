Shape Control of Cubic B-spline and NURBS Curves by Knot Modifications
Miklds Hoffmann
Institute of Mathematics and Computer Science
Kiroly E,szterhizy College
Leinyka str. 4-6.
H-3300 Eger, Hungary
hofi@ektf.hu

Abstract

Imre JuhBsz
Department of Descriptive Geometry
University of Miskolc
Miskolc-EgyetemvBros
H-34 15 Hungary
agtji @gold.uni-miskolc.hu

the modification of a knot value on the shape of the curve. In
the next sections constrained based shape control possibilities are discussed modifying knot values of a non-rational
B-spline curve, while the effect of simultaneous modification of knots and weights is presented in the rational case. In
these latter sections we restrict our consideration to curves
of degree 3, since this is the most widely used type of Bspline and NURBS curves.

Shape control methods of cubic B-spline and NURBS
curves by the niodijkation of th,?irknot values, and simultaneous modification of weights and knots are presented. Theoretical aspects of knot modijieation concerning the paths
of points of a curve and the existence of an envelope for
the farnily of curves resulted by a knot modijication are also
discussed for curves of degree IC.

2. Theoretical results
1. Introduction

In this section the modification of a knot value of a kth
degree B-spline curve will be examined. We begin our discussion with the basic definitions.

B-spline and NURBS curves are standard description
methods of CAD systems and widely used in computer
aided design today. There are several books and papers
on these curves describing their properties, with the help
of which one can apply them as, powerful design tools.
A k f h degree B-spline curve is uniquely defined by its
control points and knot values. while in terms of NURBS
curves the weight vector has ito be specified in addition.
The shape modification of these curves plays central role
in CAD, hence numerous methlods have been presented to
control the shape of a curve by modifying one of its data
mentioned above. The most basic possibilities can be found
in any book of the field (e.g. in [ 6 ] ) .Further control pointbased shape modification is discussed in [2] and [5], weightbased modification is described e.g. in [3] and [5], while
others present shape control by simultaneous modification
of control points and weights (see [ 11, [7]).
It is also well-known that the change of the knot vector
affects the shape of the curve. The properties of this change,
however, have not been described yet. The aim of this paper
is to present the geometrical arid mathematical representation of the effects of knot modification for B-spline curves.
After the basic definitions some theoretical results are presented, by means of which one can describe the effects of

Definition 1 The recursive function N;
equations

given by the

is called nornialized B-spline basis function of order k (degree k - l). The numbers uj
u,+l E R are called knot
values or simply knots, and 0/0=0 by definition.

<

Definition 2 The curve s

(U)

defined by

is called B-spline curve of order k (degree k - l), where
NF ( U ) is the lth norniulized B-spline basis function, f o r
the evaluation of which the knots U O ,u1, . . . , u,+k are necessary. The points di are called control points or de Boorpoints, while the polygon formed by these points is called
control polygon.

63
0-7695-1195-3/01 $10.000 2001 IEEE

(U)

which is also a B-spline curve of order ( k - 1) and can be
written in the form

The j t h span of the B-spline curve can be written as

sj ( U )

i-1

=
l=j-k+l

Modifying the knot ui, the point o f this span associated with
u j + 1 ) will move along
the fixed parameter value ii E [uj,
the curve

where

vj

=

{.

z:+l-

i

, that is the

ithknot value

is removed from the knot vector { u j }of the original curves.

Hereafter, we refer to this curve as the path of the point
( 6 ) . In [4] the authors proved the following basic properties of these paths:

sj

.envelope

Theorem 1 Modifiing the knot value ui E [ u i - 1 , ui+l]
of a kth order B-spline curve, the points of the spans
s i - k + l ( U ) , ...,S i + k - z ( U ) moves along rational curves. The
degree of these paths decreases symmetrically from k - 1to
1 as the indices of the spans getting farther from i, i.e. the
paths
ui) and s ~ + ~ - I(I& ui) are rational curves of
degree k - m with respect to ui,( m = 1,.. . , k - 1).
The theorem states that modifying ui E [ui-l ui+l]the
points of the spans S i - k + l ( G , ui) and Si+k-2 (6,ui) move
along straight lines. One can easily prove the following
corollary, which will be strongly used in the next section.

Figure 1. The envelope of the family of cubic
B-spline curves is a quadratic B-spline curve
with the same control polygon.

Corollary1 If ui runs from ui--1 to ui+l, then the
points of the span S i - k + l (G,ui)and s i + k - ~ ( G , 7 4 ) move
along straight lines parallel to the side d i - k , d i - k + l and
d i - 1 , di of the control polygon, respectively.

Until now only non-rational B-spline curves have been
examined, but similar results hold for the rational case. A
rational B-spline curve can always be considered as a central projection of a non-rational B-spline curve. The degree
of a curve cannot increase by a central projection, thus Theorem 1 and its corollary hold for paths of the points of a
NURBS curve, except the parallel paths will be concurrent,
which will be discussed in the next section. Similarly, Theorem 2 holds for the rational case too, but the envelope will
also be a NURBS curve. Fig.1 shows an envelope of the
family of cubic B-spline curves resulted by the modification of one of the knot values.
These theoretical results help us to develop some interesting tools for shape control of B-spline and NURBS
curves by the modification of their knot values, that will be
examined in the next section.

Beside these paths we can also consider the oneparameter family of B-spline curves

which is resulted by the modification of the knot value ui.
In case of k = 3 the spans of the curves are parabolic
arcs. It is a well-known fact, that the tangent lines of these
arcs at the knot values coincide with the corresponding sides
of the control polygon. Modifying a knot value ui the tangent line remains the same, which can be interpreted as the
side of the control polygon is an envelope of the family of
these quadratic B-spline curves. The generalization of this
property has also been proved by the authors for arbitrary k
(see [4]):

3. Shape control

Theorem2 The family of the kth order B-spline curves
s (21,ui) = Cy=,d l N / ( U ?U i ) , ( k > 2 ) has an envelope

For the sake of simplicity we restrict our consideration
for the case k = 4. Cubic curves are powerful design tools

64

for most of the applications in the plane as well as in the 3D
space. Some of the algorithms discussed below can be generalized for arbitrary k, while others use the specific properties of cubic curves.

system can be solved for any two unknowns, but to avoid
the unnecessary changes of farther spans it is better to
chose two neighboring values, thus 8 spans will be modified. Solving the system e.g. for wj-1,vj and considering
the quadratic curve b(w) with these knot values b(U) = p
holds. Therefore, because of Theorem 2, the cubic curve
.(U) with the knot values (...uj-l = wj-1, u j = wj,
uj+l = U, ~ j + 2= w j + l ...) also passes through the point p
at the parameter value U.
Since we have four free parameters w j - 1 ,wj,w j + l and
w j + 2 , some additional conditions can be assumed for the
quadratic curve E(w) in advance. Such a condition can be
the given tangent direction at p, but the initial position of
p and the given direction cannot be arbitrary. To describe
the permissible positions and directions, consider parabolic
arcs having the tangents dj-2, dj-1 and dj, dj-1. The tangent points are b (wj) and b(wj+l) , i.e. the points where
the spline arcs are connected. The extreme positions of the
points b (wj) and b (wj+l) of the parabolic arc are dj-2
and dj,respectively. If the position of both end-points are
extreme, then the parabolic arc defined by the control points
dj-2, dj-1 , dj will be obtained, hence the point p can be
given in the region defined by this arc and the two sides
(dj-2, dj-1 and dj, dj-1) of the control polygon (see the
grey area in Fig. 2 ) .
If the point p is on this arc, then the tangent direction
cannot be given in advance, since a parabolic arc is uniquely
defined by two of its points and the tangents in them. However if the point p is an inner point of the area mentioned
above, then the tangent line can be given in addition.
The extreme positions of this tangent line are given
by the tangents of the extreme parabolic arcs passing
through the point p and fulfilling the conditions. To obtain these extreme arcs, consider the following two situations: b (wj) = dj--2 and b (wj+l) is an inner point of the
segment dj-l,dj, or b (wj+l) = d j and b ( v j ) is an inner point of the segment dj-2, dj-1. These parabolic arcs
can easily be calculated by considering the affine coordinate
system described above in this section, in which let the coordinates of the point p be (2,y). The control points of the
first extreme arc are: dj-2, dj-1, dj-1 pez, p < 1, and
it can be written in the parametric form

3.1. Non-rational B-spline curve passing through a
point

-

Let .(U) be a non-rational cubic B-spline curve with
control points di, (i = 0, ..., n) and knot values uj,( j =
0, ...,n 4). Until now the only possibility for the modification of this curve has been the repositioning of its control
points. Now we give an algorithm for changing this curve
by modifying its knot values in such a way that the curve
will pass through a given poinl. p at the given parameter
value U. This point, of course cannot be anywhere: the algorithm works if this point is inside the region defined by the
sides of the control polygon and the envelopes mentioned in
Theorem 2, which are parabolic arcs in the cubic case.
Let the point p be in the region defined by the control points dj-2, dj-l, dj. Let a parameter value U E
[uj,uj+2) be also given. Consider a quadratic B-spline
curve b(w) with the same coiitrol points and the knot
values W O = U O , ...w j - 1 = uj-1, w j = u j , W j + l =
- u,+4. Hence the .given value U E
Uj+2, . . ' I wn+3 [wj, ~ j + ~Consider
).
the j t h span of the quadratic curve

+

j

bJ(V)

=

Nf(v)dl,

E [wj,wj+l).

kj-2

Using the monotonicity of the knot values one can write

w - vj-1
vj+2 - w

=

(Wj+1

=

(Wj+* - V j ) -

- "j-1) - (Wj+l - w)

(v - Wj).

Substituting these formulae to the original equation we obtain the form

bj(v)

= dj-1

+ Nj"_,!(w)(dj-2

- dj-1)

+Nj"(w)( d j - dj-1).

+

Now consider the affine coordinate system the origin of
which is dj-1 and the base vectors are el = dj-2 - dj-1
and e 2 = d j - dj-1. Let the coordinates of the given point
p in this coordinate system be x and y. This yields the following system of equations:

c (v) = dj-1

+ (1- w

)el~

+ w'pez.

One of its points will be the point p at the parameter value
W O E ( 0 , l ) . For this point

holds. The vectors el and e2 are linearly independent,
hence from the equation p = c ( W O ) we obtain the solu2
p = y / (1 . Fig. 2 shows the
tions W O = 1 two extreme parabolic arcs passing through p and their tan-

A,

Hence x,y and w = U are given, one can choose two unknowns from the knot values (~1j-1 , wj, w j + l , vj+2). The

65

A)

triangle, thus suitably changing the weight wj there will be
a parameter value 5,for which b(5) = p. If we modify the
knot value uj+lof the cubic curve to be uj+l = i7,the cubic
curve will also pass through the point p. This type of shape
modification is illustrated in Fig. 3.

d3

P

Figure 3. Modifying the weight w 3 and the
knot u4,the NURBS curve passes through the
given point p which is outside the area accessible by the modification of w3 only.
Figure 2. The permissible positions of the
points p and the tangent directions of the
parabolic arc .

In this subsection the quadratic envelope has been modified by a weight, where the points of the curve moves along
straight lines toward a control point. Similar effect, however, can be achieved in terms of non-rational quadratic Bspline curves by appropriate simultaneous modification of
two knot values. More precisely, from the definition of the
B-spline functions and the Corollary of Theorem 1 one can
easily prove the following property:

gent lines at p. The tangent direction can be given in this
angular domain.

3.2. NURBS curve passing through a point

Theorem 3 Consider the quadratic non-rational B-spline
curve .(U), and simultaneously modib its knots U , and u,+3
in an equal mannel; i.e. let U , = U , A, u,+3 = u,+3 - A.
As a result of this modijication, points of the span s,+1 ( U )
move along concurrent straight lines, ifand only

+

It is a well-known fact, that the modification of the
weight w j of a NURBS curve causes a perspective functional translation of points of the effected arcs, i.e. it
pulls/pushes points of the curve toward/away from the control point dj. If a given point is on one of the line segments
of the paths of this perspective change, one can easily compute the new weight value in such a way, that the new curve
will pass through the given point. This point can almost be
anywhere in the convex hull, but for k > 3 these concurrent
line segments starting from d j do not sweep the entire area
of the triangle dj-1, dj, dj+l, cf. the gray area in Fig. 3 .
If the given point is close to the side of the control polygon,
i.e. it is out of the shaded region of Fig. 3 , the problem can
only be solved with the change of two neighboring weights.
Now, we give an algorithm to solve this problem with the
change of one weight and one knot value.
Let .(U) be a cubic NURBS curve and p a point in
the triangle dj-1, dj, dj+l. Consider the quadratic envelope b(v) of the family of NURBS curves S ( U , uj+l). This
parabolic arc intersects all the lines starting from d j in this

a

U1+2

- U , = %+3 - %+I

holds. The common point of these straight lines is d, (see
Fig. 4).
Proof. As we have seen above, the span s,+1 ( U ) can be
written in the form

st+i ( U ) = d,

+ N:-1

+ N:+1

- 4)

(&+I - 4).

Applying the knot modification of the theorem, we obtain
the family of curves

66

Assuming the equality 6 = ui+2 - ui = ui+3 - ~
can factor out 1/ ( 6 - A) and W I Zobtain

i + we
~ ,

which is a family of straight line segments and the pencil of
lines determined by them has the centre di.
Conversely, if ui+2 - ui # ui+3 - ui+l then the rational
curves (1) have two points at infinity (at X = ui+2 - ui and
X = ui+3 - ui+l),therefore th'ey can not be straight lines.

modifying a knot value in addition. Thus the points of a
span of the curve will move along concurrent lines passing
through any given point of the line dj, dj+l except the inner point of the leg. As we have mentioned in the preceding
section, modifying a knot value u j of a cubic NURBS curve
the points of the spans sj-3, sj+z will move along two families of concurrent straight lines. Considering the span sj-3
and assuming that wj-4 # wj-3 the following result can
be achieved: modifying the knot value u j the points of this
span move along concurrent lines the centre of which is on
the line dj, dj+l and its barycentric coordinates are
wj-4
wj-4 - wj-3

7 1-

wj-4

wj-4

- wj-3

V

Figure 4. Simultaneous modification of two
knot values yields a perspective change of
the span of a non-rational quadratic B-spline
curve.

Figure 5. Modifying the knot value u7, points
of the span s4 moves along concurrent
straight lines the centre of which depends on
w 3 and w4 and can be arbitrary located on the
line of d 3 , d 4 ,except the inner points of the
segment.

The modification of these two knot values, of course, is
not so effective, than that of a weight, because the region
of change is greater in the latter case while the number of
changing spans is fewer (7 for the two knot values and 3
for the weight), but we have to emphasize, that this theorem
allows us to modify non-rational B-spline curves similarly
to NURBS curves.

One can easily see, that one of its coordinates must be
negative with the usual assumption wj 2 0, V j . Hence this
centre cannot be on the leg dj, dj+l but on the rest of the
line. Fig. 5 shows a case of this type of modification.

3.3. Modification of two weights and a knot value of
a NURBS curve

4. Conclusions and further research

Modifying two neighboring weights wj,wj+l of a
NURBS curve the points of the curve move along straight
lines toward or away from the leg d,, dj+l of the control
polygon. This change is neither perspective nor parallel.
This property can be made more intuitive geometrically by

This paper has been devoted to the shape control of cubic
B-spline and NURBS curves. These curves can uniquely be
defined by their degree, control points, weights and knot
vector. While the effect of the modification of the preceding data has been widely published and used, the change of

67

References

the knot vector has not been studied yet. At the first section
some theoretical results have been presented in terms of the
paths of the points of the curve when one of its knot values
is modified, and the existence of an envelope of the resulted
family of curves. Applying these results some shape control
methods have been presented in the next section. Modifying one or some of the knot values of a non-rational B-spline
one can achieve constraint-based modification, such as obtaining a curve passing through a given point, or a shape
modification which is similar to the effect of the modification of a weight in the rational case. For NURBS curves
simultaneous change of one or two weights and knot values
has been presented, the result of which is a NURBS curve
passing through'a given point or a geometrically simple perspective shape modification.
Our objective in our further research, besides the knotbased constrained shape modification of curves of arbitrary
order k, is to study the theoretical aspects of knot modifications for surfaces, which will hopefully generate some
shape control methods both for B-spline and NURBS surfaces.

C. K. Au and M. M. F. Yuen. Unified approach to nurbs curve
shape modification. Computer-Aided Design, 27(2):85-93,
February 1995.
B. Fowler and R. Bartels. Constraint-based curve manipulation. IEEE Computer Graphics and Applications, 13(5):4349, September 1993.
1. Juhisz. Weight-based shape modification of nurbs curves.
Cornpurer Aided Geometric Design, 16(5):377-383, June
1999.
I. Juhisz and M. Hoffmann. The effect of knot modifications
on the shape of b-spline curves. Journal !or Geomet? and
Graphics, (submitted for publication) 2001.
L. Piegl. Modifying the shape of rational b-splines. part 1:
curves. Computer-Aided Design, 2 1(8):509-5 18, October
1989.
L. Piegl and W. Tiller. The NURBS book. Springer-Verlag,
Berlin, 1995.
J . Sinchez-Reyes. A simple technique for nurbs shape
modification. IEEE Cornpiiter Grupkics and Applications,
I7( 1):52-59, January-February 1997.

Acknowledgement This research was supported by the
Hungarian National Scientific Fund (OTKA No.
F032679) and the research project FKP 0027/2001.

68


2010 14th International
Information
Conference
Visualisation
Information Visualisation

Visualisation of Left Ventricular Dysfunction in the
Virtual Pathological Heart
X Lin, N J B McFarlane, Y Zhao, G J Clapworthy,
F Dong

A Redaelli
Department of Bioengineering,
Politecnico di Milano, Italy
berto.redaelli@polimi.it

Centre for Computer Graphics & Visualisation,
University of Bedfordshire, UK
xinyu.lin@beds.ac.uk, nigel.mcfarlane@beds.ac.uk,
youbing.zhao@beds.ac.uk
Abstract — While there has been significant progress in the
treatment of ischemic heart failure, it remains a significant
health and economic problem worldwide. In this paper, we
present the challenges of modelling ischemic heart failure and
introduce a user-friendly software system that will be a sub-set
of the Virtual Pathological Heart environment which is
currently being developed under the FP7 VPH2 project. This
will provide patient-specific computational modelling and
simulation of the human heart to assist the cardiologist and the
cardiac surgeon in defining the severity and extent of disease in
patients with post-ischemic Left Ventricular Dysfunction. The
proposed system will provide visualisation tools for surgical
assessment and planning: the registration and display of
necrotic and hypo-kinetic regions; simulated surgical
restoration (cutting and patching); and finally post-operative
functional prediction (volume, shape and mitral valve
regurgitation).

atrium via the mitral valve, which closes when the LV
contracts, forcing the blood out of the LV along the aorta, the
main artery in the body.
A failing heart often expands and fills the available
cavity, making it more difficult for it to function; the
enlargement increases the tension required (the “muscle
afterload”) to achieve ejection pressure. If part of the heart is
necrotic, the surgeon may choose to remove this tissue. The
incision is then closed either directly or by the insertion of a
synthetic patch; in either case, the stitching must pass
through sound tissue. Some parts of the heart may be
“hibernated” (or “hypokinetic”); here, the tissue is failing but
not yet dead. In some areas of the heart, it might be possible
to revive the hibernated tissue by restoring the circulation
using a revascularisation procedure.

Keywords-Visualisation, Ischemic heart failure, Left
Ventricular Dysfunction, virtual surgery, restoration, surface
reconstruction, surface registration

The VPH2 project [4], funded by the European
Commission under FP7 [5], aims to develop a system for the
patient-specific computational modelling and simulation of
the human heart to assist the cardiologist and the cardiac
surgeon in defining the severity and extent of disease in
patients with post-ischemic Left Ventricular Dysfunction
(LVD), with or without Functional Mitral Regurgitation
(FMR). FMR occurs when the mitral valves fail to close
completely allowing blood to pass back into the left atrium
when the LV contracts.

I.

II.

INTRODUCTION

Heart failure (HF) is a serious medical condition in which
the heart can no longer pump blood around the body as well
as it should. It is one of the major causes of death in
developed countries and accounts for almost a quarter of all
admissions to hospital for cardiovascular events. It has high
mortality (median survival around 18 months) and places a
great burden on all healthcare systems, with estimated direct
costs of £905m (€1000m) in the United Kingdom in 2000
[1], which represents 2% of total NHS expenditure. The
estimated total direct and indirect cost of HF in the United
States for 2008 is $34.8 billion (£22.9 billion) [2].
HF is caused by either decreased left ventricular endsystolic elastance (systolic HF) or decreased diastolic
compliance (diastolic HF) [3]. The most common cause of
systolic HF is myocardial infarction (MI), secondary to
coronary artery disease (⅔ of all HF).
The left ventricle (LV) is the largest of the four chambers
of the heart and is responsible for pumping oxygenated blood
to all tissues in the body. It receives blood from the left
1550-6037/10 $26.00 © 2010 IEEE
DOI 10.1109/IV.2010.92

THE VPH2 PROJECT

Base
Medium
Apex
Apex

Base

Figure 1. (a) conceptual LV geometry of the LV modeled as a thickwalled, axisymmetric, truncated, prolate spheroid; (b) shown as a bullseye
diagram

625
635

Fig. 1 shows the least complex realistic geometric
representation for regional left ventricular mechanics – a
truncated ellipsoid or prolate spheroid. The ventricle is
divided into segments, usually 18. These can be colourcoded to show parameters such as thickness, viability and
contractibility.
There has been significant recent progress in cardiac
surgery and the treatment of HF, but many problems remain
unsolved including the effect of therapy on LV stress and
function and intra-ventricular and intra-device flow and
thrombus formation.
The VPH2 project is developing a multiscale approach
which will take account of the wide variety of influences that
lead to LVD. No similar system currently exists. The
technological aim of VPH2 is to deliver the most advanced
software application framework for the development of
computer-aided
medicine in
cardiology.
Specific
computational methods will allow for clinical decision
making and for planning the optimal treatment for left
ventricle-valve repair. In particular, the virtual approach to
the organ pathology starts from the definition of the
topographic location of myocardial dysfunction by analysing
the myocardial functional behaviour, and from the
visualisation of transvalvular flux (MRI phase contrast), and
mitral valve function and anatomy.
Our work focuses on developing a visualisation system
for surgical simulation and prediction. Currently, it is
primarily concerned with surface reconstruction of the LV,
gadolinium surface registration and virtual surgery. The
surfaces of the LV are reconstructed from MRI data, and
areas containing necrotic tissue or tissue where
revascularisation can take place are then registered and
mapped on to the surface.

Visual surgical tools are being developed for surgical
simulation and prediction to enable the surgeon to define the
areas of tissue to be removed, to perform surgical procedures
in silico, and to receive quantitative predictions of the effect
of the procedure on the likely performance of the ventricle.
Quantitative and validated results, including blood flow and
mitral valve function, will be available by the end of the
project. However, this work is currently at an early stage,
and shows only preliminary data and visualisations for those
modules which have been sufficiently completed. Fig. 2
shows the system diagram; the highlighted modules are
currently at the prototype stage. The Multimod Application
Framework (MAF) [6] is the technological foundation of our
system. MAF, developed by a consortium of European
research institutions and high-tech companies, is an open
source framework containing several libraries such as VTK,
ITK, etc., for the rapid development of computer aided
medicine applications.
The details of the system being developed for VPH2 are
described in following sections. The process consists of 3
stages: pre-processing, pre-operative and post-operative.
Section III introduces the surface reconstruction of the LV
from a 3D point cloud as a pre-processing step. In Section
IV, the registration of the necrotic region with the LV
surface is described, and Section V demonstrates the virtual
surgical operation. Early findings are summarised in Section
VI.
III.

POINTS

The first pre-processing step is the reconstruction of the
LV surfaces from point cloud contours. The input data
consists of contour points segmented from original MRI
dataset. These contour points are a single point set in R3 with
additional slice number information. Fig. 3 shows an
example of the input contour points. The input data is sparse,
rarely consisting of more than 10 contours, approximately
8mm apart. The contours are not captured simultaneously;
rather they are captured at different times but nominally all at
the same point in the cardiac cycle. The low resolution and
errors due to mistiming or the patient’s breathing make it
difficult to create a good mesh for later processing.

Pre-processing
LV surface
reconstruction

LV SURFACE RECONSTRUCTION FROM 3D CONTOUR

Registration of
necrotic region with
LV surface

Pre-Operative
Segment model
Contractility of each
display
segment
Virtual surgical operation
Deformation and
Cutting, patching and
shape prediction
closing
Post-operative
Construct the 3D
Animated post-op
heart
post-op heart model
Resynchronisation

Mitral Valve
Regurgitation

Figure 3. Input 3D contour points displayed using the VPH2 framework.
The points are segmented from MRI slices; contours are parallel in Z coordinates

Figure 2. System diagram: blocks in grey are currently being prototyped;
the rest are planned for future work

636
626

There has been extensive research in surface
reconstruction from point representation to 3D model of an
object. Existing methods fall into two main categories. The
“Point-based reconstruction” considers the input as an
unorganised set of points in R3. In contrast, in “Slice-based”
reconstruction, each contour slice (or pair of slices) is
processed as an individual input unit.
The point-based approaches include the implicit surface
method of Hoppe et al. [7], the power crust algorithm of
Amenta et al. [8], and the method based on Multi-level
Partition of Unity (MPU) by Ohtake et al. [9]. Hoppe’s
method constructs a distance function that is distance
between input point and tangent plane of nearest 3D point
location. Hoppe also proposed a method for calculating the
normal direction by fitting a plane through input points’ k
nearest neighbours. Power crust method constructs 3D
volumetric grid using weighted Voronoi diagram known as
“power diagram”. This algorithm produces convex polygons
instead of triangle mesh, which can be a drawback in some
applications. Ohtake’s MPU is another popular method
based on 3D point set. It is based on octree decomposition of
space around the input point, and the surface is constructed
by blending local implicit functions. Advantages of pointbased methods are the robustness for general 3D input
points. But they are techniques aimed at unorganised 3D
points without optimisation for the characteristics of
biological data. Many methods in this category also require
an accurate estimation of the surface normal, which is
challenging task in itself.
Slice-based methods generally tackle three problems:
correspondence between adjacent slices, branching of the
structure, and “tiling” process that produces meshes between
slices. The most prominent method is contour stitching [10].
The advantage of slice-based methods is the intrinsic
exploitation of point structure that is not available with
general 3D point sets. Furthermore, surface normal is not
required as input for slice-based method. However, the main
disadvantage of slice-based method is limited continuity of
the surface constructed since it is equivalent to linear
interpolation, and the quality of the reconstructed surface is
constrained by the number of slices. Interpolation [11, 12]
and surface smoothing are normally required to improve the
quality of final surface mesh.
We have been exploiting both point-based and slicebased approaches. Fig. 4 shows the results of reconstruction
using the power crust method, which produced unexpected
result with sparse input point. In this work, we implemented
a slice-based reconstruction strategy. Fig. 5 shows the flow
of our method using a 2D distance transform followed by the
Marching Cube algorithm.
First, a polygon is created for each contour slice from the
3D points. The binary slice is then constructed by testing the
polygon membership of each pixel within the slice. Fig. 6
shows the results of creating 2D binary slices from the 3D
contour points. A 2D distance transform is applied
subsequently on each binary slice.

Figure 4. Surfaces reconstructed using the power crust method whose
output meshes are convex

The set of 2D distance maps is stacked to create a 3D
volume. Finally, we employ the Marching Cube algorithm to
extract the LV mesh surface, based on the 3D distance map.
This is followed by Laplacian smoothing of the polygon
mesh. Marching cubes is the most widely used standard
method for isosurface extraction. It has been adopted in our
study because of its robust performance in medical
visualisation and efficient computational performance in
practice. Fig. 7 shows the result of the distance map and Fig.
8 shows the reconstructed surface of the LV, which is
superior compared with results in Fig. 4. We will continue to
exploit advantages from both approaches.
3D point cloud
creation of binary slice from
contour slice
2D distance transform on
binary slice
3D stacking of 2D distance
map
Marching Cube surface
extraction on 3D distance map
surface mesh of LV
Figure 5. Flow of surface reconstruction algorithm

Figure 6. (a) polygon contour created from 3D contour point; (b) 2D
binary image created from polygon contour

637
627

Figure 9. LV obtained from gadolinium MRI (left) and the original LV
(right)

Figure 7. Distance map of binary slices

Figure 8. Mesh surface of LV (a) surface mesh; (b) wire-frame of mesh

IV.

GADOLINIUM HEART VENTRICLE REGISTRATION

Figure 10. Match the gadolinium LV (blue wireframe) to the original LV

When investigating the condition of the heart, clinicians
will often use gadolinium-enhanced magnetic resonance
imaging (MRI) to identify necrotic regions. The
paramagnetic trait of gadolinium ions makes gadolinium
compounds popular as contrast agents in MRI to enhance
images and locate possible necrotic tissue.
As the gadolinium MRI is taken in an independent pass, a
correspondence between the gadolinium data and the original
heart data acquired from the time-varying MRI has to be
established in order to map and visualise the necrotic area on
the original heart model. This process is achieved by
registration of the models for the LV obtained from the
gadolinium MRI and the original MRI using the iterative
closest point (ICP) algorithm [13]; ICP is a fast, classical and
well-tested registration algorithm which does not rely on
sensitive surface information.
ICP is used to minimise the difference between two point
clouds. It iteratively updates the transformation (translation,
rotation) needed to minimise the distance between two input
point sets and always converges monotonically to a local
minimum with respect to the distance objective function. The
output is the refined transformation matrix.
As stated in Section III, the input data is low-resolution
and noisy. There are no surface landmarks except bumps
which are as likely to be noise as real features. In addition,
the top and bottom of the ventricle are absent from the data,
the up-and-down motion of the heart making them too
difficult to capture; if the input datasets have different
lengths missing, or parts were captured at different points in
the cardiac cycle, the registration in the axial direction
becomes very difficult.

Indeed, we found that a simple application of ICP cannot
result in a satisfying transformation as there is only partial
overlap between the gadolinium ventricle and the original
heart ventricle, as shown in Fig. 9. To produce satisfying
results, those points which are not in the overlapped parts
should be pruned before ICP registration. The registered
heart ventricles are shown in Fig. 10.
After the transformation matrix is calculated through
registration of two aforementioned heart ventricles, the
necrotic points on the gadolinium ventricle have to be
mapped to regions on the original heart model for
visualisation and surgical planning. The transformed necrotic
points are shown in Fig. 11.

Figure 11. Transform necrotic points to the original LV

638
628

V.

VIRTUAL SURGICAL OPERATION

would allow the hole to be closed with a lesser reduction in
volume. The patch also allows some control over the final
shape of the ventricle – it is desirable that the final shape is
ellipsoidal rather than spherical.
In the proposed system, a default patch larger than the
hole is inserted, and the user controls the percentage closure
of the hole on the patch with a slider. Part of the patch
remains visible through the hole, contributing additional
volume to the heart, and a non-contractile area to the surface.
Fig. 14 shows a patched hole with different percentages of
closure.
The closure operation involves two stages: first the points
on the mesh around the hole must be moved into their final
positions, either stitched to the patch or to each other; and
second, the rest of the heart must deform elastically to its
final shape and volume. The precise form of the elastic
model has not yet been decided; however, since the input
data itself is not very accurate, it is likely that a very simple
model, such as an elastic structure based on the graphical
mesh, will suffice.

This part of the system will provide a simple simulation
of LV surgery, enabling the surgeon to test the effect of
different surgical choices on the viability of the postoperative heart. The stages of the operation are visualisation,
cutting, patching, closure and assessment.
The initial visualisation of the LV is shown in Fig. 12
and consists of three surfaces: the epicardium; the
endocardium; and between them a surface derived from
gadolinium (Gd) MRI indicating the region of necrotic tissue
in the myocardium
The Gd surface is the white area visible beneath the
epicardium. In future development, it is intended that the Gd
data should be transferred as a colour to the epicardium,
where it would be more visible, and allow more information
such as transmurality (the percentage thickness) to be
included in the display. Transparency is achieved by
rendering the epi- and endocardia in wireframe format, with
additional stippling of the densely-spaced mesh lines to
obtain the desired degree of transparency. This form of
pseudo-transparency is faster than “true” transparency,
allowing seamless interaction.
In the complete system, additional information must also
be displayed showing the “hypokinetic”, or “hibernated”
parts which are failing but not yet necrotic, as well as their
relationship to the blood vessels of the heart. Hypokinetic
regions can be restored by a process known as
revascularisation if they are in a favourable position, so this
is an important consideration in surgical planning. The
patient data must be derived from kinetic analysis of timevarying MRI data. (At the time of writing, the results of this
analysis are not yet available for visualisation). The heart
vasculature is a generic model which must be registered with
the patient heart, and might be visualised either as a realistic
mesh of blood vessels, or as a 2D texture map, possibly on
its own transparent surface. The simultaneous presentation of
so much data will be challenging.
For the cutting operation, a set of simple shapes (triangle,
ellipse, and spindle) can be selected from a dialog. Selecting
a shape prompts a corresponding widget to appear on the
epicardium. The user then manipulates the widget on the
surface to select the size, orientation and position of the
region to be removed. When the widget is in position, the
user selects the “cut” option, and the widget punches a hole
through the three surfaces. Fig. 13 shows a spindle widget
positioned around the necrotic region, and resulting hole cut
through the surfaces.
The patching operation is an important surgical option in
which a thin patch is inserted into the surgical hole, and the
edges of the hole are stitched to the patch. In the absence of a
patch, the hole would be closed simply by stitching the
opposite sides together. The main reason for patching is to
allow the surgeon some control over the final shape and
volume of the ventricle; some reduction of the enlarged
pathological ventricle is desirable because a smaller volume
requires less muscle tension to achieve a given pressure.
However, if a large region has been removed, the loss in
volume could leave the heart non-viable, so using a patch

Figure 12. LV showing epicardium, endocardium and necrotic area

Figure 13. LV with spindle-shaped cutting widget (left) and result of
cutting operation (right).

639
629

[3]

[4]
[5]
[6]

[7]

[8]
Figure 14. LV patched with different percentages of closure: left, 0%;
right, 80%

[9]

[10]

The final stage is functional assessment, in which various
parameters of the predicted post-operative ventricle are
measured. The most important are volume, sphericity,
conicity and regularity-of-radius. Sphericity is the ratio of
the vertical length to the radius, which should be large; that
is, the heart should be elongated. Ultimately, the system will
also include a model of the mitral valve which will combine
with the ventricle shape to predict the effect of the surgery
on the closure of the valve. At the end of the virtual surgery,
if the parameters are not acceptable, the surgeon may repeat
the cutting and closure operations with different options to
try to obtain a better result.
VI.

[11]

[12]
[13]

CONCLUSIONS

In this paper, we have described the economic and
clinical significance of HF and introduced a visualisation
system for surgical simulation and prediction which forms
part of the VPH2 multiscale framework for modelling LVD.
To enable a surgeon to perform a surgical procedure in
silico, and receive quantitative predictions of the effect of the
procedure on the likely performance of the LV, efficient
visualisation and simulation systems are needed. We have
described the forms of clinical data normally provided and
identified the challenges to be faced.
Clinical needs have been analysed and interpreted into
technical requirements. The key modules of the proposed
systems have been prototyped and a solid base has been
created from which the final visualisation sub-system of the
VPH2 framework will be developed.
ACKNOWLEDGMENT
This work is partially supported by the European
Commission, under the Information Society Technology
programme, within the VPH2 project (FP7-ICT-2-224635).
REFERENCES
[1]

[2]

S Stewart, A Jenkins, S Buchan, A McGuire, S Capewell and J J
McMurray, The current cost of heart failure to the National Health
Service in the UK, European Journal of Heart Failure, 4(3), 2002
American Heart Association. Heart disease and stroke statistics: 2008
update, American Heart Association, 2008

640
630

M R Zile, C F Baicu, W H Gaasch, Diastolic heart failure–
abnormalities in active relaxation and passive stiffness of the left
ventricle, New England Journal of Medicine, 350:1953–9, 2004
http://www.vph2.eu
European Commission, Information Society and Media, ICT in FP7
at a Glance, 2006
M Viceconti, C Zannoni, D Testi, M Petrone, S Perticoni, P
Quadrani, F Taddei, S Imboden, G J Clapworthy, The Multimod
Application Framework: a rapid application development tool for
computer aided medicine, Computer Methods & Programs in
Biomedicine, 85(2):138-151, 2007
H Hoppe, T DeRose, T Duchamp, J McDonald, W Stuetzle, Surface
reconstruction from unorganized points, Computer Graphics (Proc.
SIGGRAPH), 26(2):71-78, 1992
N Amenta, S Choi, R Kolluri. The power crust, unions of balls, and
the medial axis transform. Computational Geometry: Theory and
Applications, 19(2-3):127-153, 2001
Y Ohtake, A Belyaev, M Alexa, G Turk, H-P Seidel, Multi-level
partition of unity implicits, ACM Transactions on Graphics (Proc.
SIGGRAPH), 22(3):463-470, 2003
G Barequet, M T Goodrich, A Levi-Steiner, D Steiner, Straightskeleton based contour interpolation. In Proc. 14th Symp. Discrete
Algorithms, pp 118-127, ACM and SIAM, Jan 2003
D Cohen-Or, D Levin, Guided multi-dimensional reconstruction from
cross sections, Advanced Topics in Multivariate Approximation.
World Scientific Publishing Co., 1996
S Raya, J Udupa, Shape-based interpolation of multidimensional
objects, IEEE Transactions on Medical Imaging, 9(1):32–42, 1990.
P J Besl, N D McKay, A method for registration of 3-D shapes. IEEE
Transactions on Pattern Analysis and Machine Intelligence,
14(2):239-255, 1992


A Novel Image Encryption Scheme Based-on JPEG Encoding
Shiguo Lian, Jinsheng Sun, Zhiquan Wang
Department of Automation
Nanjing University of Science and Technology
Nanjing, P.R China 210094
E-mail: sg_lian@163.com
Abstract
Image encryption is a suitable method to protect
image data. The encryption algorithms based on position
confusion and pixel substitution change compression
ratio greatly. In this paper, a novel image encryption
algorithm combining with JPEG encoding is proposed.
In luminance and chrominance plane, the DCT blocks
are confused by pseudo-random SFCs (Space Filling
Curves). In each DCT block, DCT coefficients are
confused according to different frequency bands and
their signs are encrypted by a chaotic stream cipher. The
security of the cryptosystem against brute-force attack
and known-plaintext attack is also analyzed.
Experimental results show that, the algorithm is of high
security and low cost. What‚Äôs more, it supports direct
bit-rate control or recompression, which means that the
encrypted image can still be decrypted correctly even if
its compression ratio has been changed. These
advantages make it suitable for image transmission over
network.

1. Introduction
With the development of multimedia technology, the
research on multimedia encryption, such as image, audio
and video, becomes a hot topic. For the properties of
large volumes and real-time requirement, multimedia
data is difficult to be encrypted by traditional
cryptographies directly. Some new algorithms based on
confusion or substitution [1-3] may increase encryption
speed, but they change the statistic property of the data,
which goes against compression. In practice, multimedia
data are often compressed before transmitting or storing,
so these algorithms are not suitable here. According to
the problem, some encryption algorithms combining
encryption process with compression process are
preferred. Chen [4] proposed an image encryption
algorithm based on vector quantization encoding. The
algorithm encrypts quantization table and code stream at
the same time in the encoding process, and it is of high
security. Cheng [5] proposed an image encryption
algorithm based on SPIHT encoding. The algorithm

encrypts only the wavelet zero-tree structure, which
decreases the data volume to be encrypted and keeps
compression ratio unchanged.
JPEG image compression method has been widely
used, and the requirement of JPEG image encryption
combining with compression is urgent. According to
JPEG [6] encoding process, JPEG image encryption may
be realized by encrypting quantization tables, Huffman
tables or DCT coefficients. However, for quantization
tables or Huffman tables are produced by various
experiments and tests, they are known to all users, which
makes it fragile to attackers. What‚Äôs more, it is not secure
against known-plaintext attackers, for the quantization
tables or Huffman tables may be recovered by comparing
ciphertexts and plaintexts. The algorithm encrypting
DCT coefficients with traditional cryptography causes
great changes in compression ratio, for the process
changes the statistic property of DCT coefficients
greatly. What‚Äôs more, the compression ratio conversion
process cannot be realized directly before decrypting
ciphertexts, which limits its applications. Considering
that compression ratio conversion in JPEG is realized by
adjusting quantization steps, the encryption process
should not change the ranges of DCT coefficients in
order to support direct bit-rate control. In this paper, we
propose a JPEG image encryption algorithm that
permutes DCT blocks by pseudo-random SFCs (Space
Filling Curves) in luminance and chrominance planes,
confuses DCT coefficients according to different
segments in each DCT block and encrypts the signs of
DCT coefficients by a chaotic stream cipher. The
algorithm is of high-security and low-cost. What‚Äôs more,
it affects compression ratio slightly and keeps data
format unchanged, which makes it suitable for direct bitrate control.
The rest of this paper is organized as follows. In
Section 2, the JPEG image encryption algorithm is
proposed. And its properties of security, computingcomplexity and bit-rate control are analyzed in Section 3.
In Section 4, some experimental results are given.
Finally, in Section 5, some conclusions are drawn, and
the future work is proposed.

2. The Proposed Encryption Scheme

Proceedings of the Eighth International Conference on Information Visualisation (IV‚Äô04)
1093-9547/04 $ 20.00 IEEE

The proposed encryption process combining with
compression process is shown in Figure 1. Where, the
encryption process is composed of three steps: color
plane permutation, DCT coefficient confusion and sign
encryption. They are specified in details as below:
User Key

Key Generator
k0

B

SFC Confusion

G
RGB
to
YCrCb

R

k1

8*8 Blcok
Scan

SFC Confusion

DCT

k2

128

SFC Confusion

Encrypted
Data

VLC

Sign
Encryption

are confused under the control of the same key.

k3

k4

coefficients are divided into four subsections (l1, l2, l3):
[1, l1], [l1+1, l2], [l2+1, l3] and [l3+1, 63]. It means that
AC coefficients are confused in each subsection
respectively while leaving DC coefficient unchanged.
Through various experiments, we propose the division
mode (5, 20, 40) that has less effect on compression
ratio. What‚Äôs more, in order to reduce computing
complexity, all the DCT blocks may be divided into P
( 1 d P d 3WH ) groups, and the blocks in the same group

DPCM
Zig-Zag
RLE

DCT
Confusion

Quantization

2.3. Sign Encryption of DCT Coefficient

Figure 1. The Proposed Image Encryption
Scheme Based on JPEG encoding

2.1. Color Plane Permutation
In this step, the positions of the DCT blocks in
luminance plane and chrominance planes are confused
under the control of key k0, k1 and k2 respectively. The
process is shown in Figure 1. Here, the confusion
method based on pseudo-random Space Filling Curve
(SFC) [7] is used in order to reduce the changes of
compression ratio and avoid the block border effects.
This is because that, DC coefficients are encoded
referencing to the previous adjacent ones in JPEG, and
pseudo-random SFC method can keep the correlation
between blocks in some extent [8].
The confusion method is shown in Figure 2.
Where, if the original image is of W*H-sized, then the
block map of each color plane is of size W u H
8

Changes in DCT coefficients‚Äô sign may reduce the
understandability of images. What‚Äôs more, encrypting
only one sign bit of each coefficient keeps compression
ratio unchanged and keeps the encryption process of low
cost. If a coefficient is bigger than 0, its sign is
represented as ‚Äú1‚Äù, otherwise is ‚Äú0‚Äù. Thus, the signs of
all the coefficients form a string of bytes that can be
encrypted by traditional high-secure block ciphers (DES,
IDEA, RSA etc.) or chaotic stream ciphers. Considering
that the signs of coefficients may change according to
different quantization steps after bit-rate control, chaotic
stream cipher is more suitable for JPEG encryption in
order to supporting direct bit-rate control. In this scheme,
the sign sequence is modulated (bitwise) by chaotic
sequence generated by the chaotic sequence generator
proposed in [9]. The encryption process is shown in
Figure 3.
Sign
Sequence

8

(luminance plane) and W u H (chrominance planes)

Chaotic Sequence
Generator

16 16

respectively.
Block Map
of Original Image

Pseudo-Random
SFC Scan

Key

Confused
Block Map

Confusion Key

Figure 2. Color Plane Confusion Method

2.2. DCT Coefficient Confusion
DCT concentrates energy on lower frequency, which
is used to realize data compression. At the same time,
confusing coefficients changes the coefficient
distribution, and thus makes the decoded images chaotic.
In order to reduce the effect on compression ratio,
subsection confusion method is more suitable for JPEG
encryption. In subsection confusion, DCT coefficients
are divided into several subsections, and each subsection
is confused respectively, which avoids the exchange
between big coefficients and small coefficients and thus
reduce the change of compression ratio. Here, DCT

Encrypted
Sign Sequence

Figure 3. Coefficient Sign Encryption

3. Quality Analysis
3.1. Security Analysis
At first, the cryptosystem has a large brute-force
space, which is composed of three parts: color plane
confusion space, sign encryption space and DCT
coefficient confusion space. For an image with N pixels,
the brute-force space of pseudo-random SFC is

20.5573 N

, which has been proposed in [8]. So, for a
W*H sized color image, the brute-force space of the
cryptosystem is

Proceedings of the Eighth International Conference on Information Visualisation (IV‚Äô04)
1093-9547/04 $ 20.00 IEEE

K

¬ß
2 0.0131WH ¬ò 21.5000WH ¬ò ¬®¬®
¬©

P

4

¬ñ
i 1

¬∑
( Li ! ) ¬∏¬∏
¬π .

P

¬ß 4
¬∑
21.5131WH ¬ò ¬®¬®
( Li !) ¬∏¬∏
¬©i1
¬π
Where, Li (i=1,2,3,4) is the length of each subsection.
For example, for a 128*128 sized color image, if the
division mode is (5, 20, 40) and P=1, then the brute-force
space is 5.22 u 10 7517 . Considering that attacks are often
realized by repeating encoding and decoding operations,
the brute-force space is so large that the brute-force
process is difficult to succeed.
Additionally, pseudo-random SFC method and chaotic
stream cipher are used respectively in color plane
confusion and sign encryption. They are secure in some
extent against known-plaintext attacks, and this keeps the
JPEG encryption scheme proposed here secure against
known-plaintext attacks. For multimedia data, an
encryption algorithm is regarded as secure if the cost
spent on attacking it is higher than the cost for its
authority. Thus, according to this point, the encryption
scheme proposed here is suitable for many applications.

¬ñ

3.2. Computing-complexity
Thus, in the cryptosystem, the ratio between encrypted
pixels and image pixels is
3
1
63P
11 63 P .
R



¬ò
128

16

3WH

128

DCT coefficients avoids the permutation between bigger
ones and smaller ones, which has a slighter effect on
compression ratio than complete confusion method does.
JPEG encoding (loss mode) realizes bit-rate
conversion by changing quantization steps. The
encryption scheme proposed here changes only the
relative position of DCT blocks, the signs of DCT
coefficients and the relative position of DCT
coefficients, but leaves the ranges of DCT coefficients
unchanged. Therefore, the encryption scheme supports
direct bit-rate control. That is to say, it permits to
recompress the encoded and encrypted data before
decrypting it firstly. Compared with decryptionrecompression-encryption process, this scheme voids the
processes of decryption and encryption, which saves
much time for users.

4. Experimental Results
4.1. Encryption Results
Applying this encryption scheme to various images,
the encrypted images are all too chaotic to be
understood. The experimental results of image Lena and
Airplane are shown in Figure 4. Where, image (a) and
(b) are original ones, and image (c) and (d) are encrypted
ones (compression ratio is 75%). It is obvious that, the
encrypted ones cannot be understood at all, which shows
that the encryption scheme is of high security.

3 WH

It is apparent that, the R is in inverse proportion to
image size W u H , and in proportion to DCT block
groups P. If P is fixed, the bigger the image is, the
smaller the ratio R is; and on the contrary, the smaller the
image is, the bigger the ratio R is. And if the image size
is fixed, the smaller P is, the smaller the ratio R is. With
P varying from 1 to 3WH , the ratio R changes from 74
128
128
to 11  63 . Taking P=4 for example, if the image‚Äôs
128

(a) Original Image

(b) Original Image

(c) Encrypted Image

(d) Encrypted Image

3WH

size is 64*64, then R=0.106; if the size is 128*128, then
R=0.091; and if the size is 256*256, then R=0.087, and
so on. As may be seen that, the encryption data ratio R is
relatively small, which ensure that the real-time
requirement may be satisfied.

3.3. Direct Bit-rate Control

Figure 4. Encryption Results
The whole encryption scheme affects compression
ratio slightly. In the proposed encryption scheme, sign
encryption of DCT coefficients keeps compression ratio
unchanged according to JPEG encoding. The pseudorandom SFC method affects compression ratio slightly,
which is because that the adjacent relationship among
blocks is kept, and only one DC coefficient in each block
is encoded referencing to others. Subsection confusion of

4.2. Direct Bit-rate Control
The encrypted images can be decrypted correctly
although they have been directly recompressed several
times with different compression ratios. The
experimental results of image Airplane are shown in
Figure 5. Where, the recompression is realized by

Proceedings of the Eighth International Conference on Information Visualisation (IV‚Äô04)
1093-9547/04 $ 20.00 IEEE

software ACDSee 4.0v. Images (a)-(d) are decrypted
from the recompressed ones that are compressed with
compression ratio varying from 20% to 100%. It is
apparent that, the images are all decrypted correctly,
which shows that the encryption scheme proposed here
supporting direct bit-rate control.

security, computing complexity, compression ratio and
bit-rate control are analyzed respectively. Theoretical
analyses and experimental results show that, the
encryption scheme is of high security, low cost and high
speed. What‚Äôs more, it affects compression ratio slightly
and supports direct bit-rate control. All these advantages
make it suitable for many applications especially for
secure image encoding with large volumes and real-time
requirement, such as multimedia network, wireless
multimedia communication and so on. And this
encryption scheme may be extended to JPEG2000 and
MPEG codecs, which is our future work.

Acknowledgement
(a) 100%, 40.15 dB

(b) 80%, 36.24 dB

This work was supported by the National Natural
Science Foundation of China through the grant number
60374066 and the Province Natural Science Foundation
of China through the grant number BK2002101.

References
(c) 60%, 32.20 dB

(d) 20%, 27.79 dB

Figure 5. Decrypted Images After Bit-rate
Control

[2] Jiu-Cheng Yen and Jiu-In Guo, ‚ÄúA new image encryption
system and its VLSI architecture,‚Äù IEEE Workshop on Signal
Processing Systems, Taipei, 1999, pp.430-437.

4.3. Encryption Speed Test
Experiments on various images show that the
proposed encryption scheme is of high speed. Here,
taking various images for example, the ratios between
encryption/decryption process and encoding/decoding
process are shown in Table 1. Where, the computer is of
1.7G CPU/256M RAM. As may be seen from table 1
that, for the same image, the time ratio reduces with the
rise of image size. And for different images, the time
ratios are all not higher than 15%, which means that the
encryption process is of low cost and the scheme is of
high speed, thus it may satisfy real-time requirement of
many applications.
Table 1. Encryption Time Ratio Test
Image

Size (N*N)

Lena
Couple
Lena
Couple
Lena
Banoon

128*128
128*128
256*256
256*256
512*512
512*512

[1] N. Bourbakis and C. Alexopoulos, ‚ÄúPicture Data Encryption
Using SCAN Pattern,‚Äù Pattern Recognization, vol.25, no.6,
pp.567-581, 1992.

Encryption Time
Ratio (%)
12.8%
12.4%
9.4%
9.8%
7.6%
7.7%

[3] F. Pichler and J. Scharinger, ‚ÄúEfficient Image Encryption
Based on Chaotic Maps.‚Äù Johannes Kepler University, Linz,
Austria, preprint, 1996.
[4] Tung-Shou Chen, Chin-Chen Chang, and Min-Shiang
Hwang, ‚ÄúA Virtual Image Cryptosystem Based upon Vector
Quantization,‚Äù IEEE Transactions on Image Processing, Vol.7,
No.10, October 1998.
[5] Howard Cheng and Xiaobo Li, ‚ÄúPartial Encryption of
Compressed Images and Videos,‚Äù IEEE Transactions on Signal
Processing, v 48, n 8, Aug, 2000, p 2439-2451.
[6] Pennebaker W.B., Mitchell J.L.: JPEG still image
compression standard, New York, Van Nostrand Reinhold
1993.
[7] Y. Matias and A. Shamir, ‚ÄúA video scrambling technique
based on space filling curves,‚Äù Proceedings of Advances in
Cryptology-CRYPTO‚Äô87, Springer LNCS 293, pages 398-417,
1987.
[8] A. Ansari and A. Fineberg, ‚ÄúImage data compression and
ordering using peano scan and lot,‚Äù IEEE Transactions on
Consumer Electronics, 38(3): 436-445, August 1992.

5. Conclusions and Future Work
In this paper, a JPEG image encryption scheme is
proposed, which supports direct bit-rate control. And its

[9] C. J. Kuo and M. S. Chen, ‚ÄúA New Signal Encryption
Technique and its Attack Study,‚Äù IEEE International
Conference on Security Technology, Taipei, Taiwan, pp.149153, 1991.

Proceedings of the Eighth International Conference on Information Visualisation (IV‚Äô04)
1093-9547/04 $ 20.00 IEEE


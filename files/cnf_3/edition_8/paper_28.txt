A Haptic Interface for Dose Planning in Stereo-tactic Radio-surgery
Ida Olofsson
ReachIn Technologies,
Sweden

Karljohan Lundin∗
Linköping University
Sweden

Matthew Cooper
Linköping University
Sweden

Per Kjäll
Elekta AB
Sweden

Anders Ynnerman
Linköping University
Sweden
Abstract
When planning a Leksell GammaKnife R treatment, dose planners place iso-centres of the irradiation
field in such a way that a certain iso-dose surface conforms as closely as possible to a target, such as a tumour.
Today this planning is done primarily in 2D, and the clinician places the iso-centres onto the currentmedical image.
The images used are usually acquired by MRI, CT or Angiography.
In this paper we investigate the use of interactive 3D
visualization and haptics to perform the dose planning. In a
pilot implementation we provide the user with a virtual environment with real-time graphics to visualize the target,
surrounding tissue and iso-dose surfaces as well as an integrated graphical user interface. The overall aim of the implementation is to increase the efficiency and precision of
the planning process by adding haptic feedback to represent various constraints and opportunities in the planning
process and so guide the user to an optimal placement of
the iso-centres. Preliminary feedback from potential users
has been very positive.

Keywords— Surgical Planning, VR environment, haptics,
volume haptics, haptic guidance

1. Introduction
When treating small targets or targets very close to sensitive structures in the brain with ionizing radiation the most
commonly used procedure is Stereo-tactic Radio-surgery
(SRS). A crucial step in the treatment process when using
ionizing radiation, is dose planning, during which the clinician determines the extent of the region to treat and the dose
∗

karlu@itn.liu.se

Figure 1. Tissue visualization through
volume rendering with target volume
rendered using iso-surfacing.

to be delivered to this region. The dose plan is entirely based
on the diagnostic information available such as images acquired by the use of MRI, CT and/or angiography.
When using the Leksell GammaKnife R for stereo-tactic
radio-surgery, the target is irradiated by 201 very narrow
beams of Co-60 gamma photons. Because of the high degree of symmetry, the dose distribution created during a
single irradiation has an almost spherical shape. The doseplanners task is then to “fill” the target volume with irradiation iso-centres in such a way that a certain iso-dose surface, defining the region within which a sufficient level of irradiation is achieved, as closely as possible conforms to the
target surface. An example of a target volume can be seen
in Fig. 1. It is however not enough only to achieve full target coverage, the dose applied to the tissue outside the target

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

must also be kept to a minimum; in other words, the treatment has to be selective. The planning is done iteratively in
the sense that the number, sizes, weights and locations of
the iso-centres are altered until the target coverage is maximized and the dose to adjacent tissue is minimized.
Today this planning is primarily carried out using twodimensional displays, where the clinician places the isocentres directly onto individual images. When an iso-centre
is placed on one image, however, the tissue slices represented in the adjacent images will also receive a dosage contribution which must be factored into the overall dosage
volume. Thus, how a potential extra iso-centre at a certain
position will influence the dosage on adjacent tissue must
be evaluated in real-time. This task is extremely challenging.
Figure 2. The Reachin Display.

2. Approach

• Haptic interaction with the dose distribution generated
from the previously placed iso-centres to guide the
users to optimal positions in the target volume

information and so guide the user towards advantageous actions. We create forms of feedback that are not found in reality and thus do not enhance the feeling of ‘presence’ but, instead, help the user to understand the data and find optimal
solutions to this specific problem.
In [8] Pao et al. discuss the concept of haptics as an additional communication channel and present some examples
of how haptic feedback can be used to present abstract data.
Also methods for generating haptic feedback for presenting
volumetric data have been published[1, 4]. However, to the
authors’ knowledge, haptics has not previously been used
to interactively explore and interact with properties of dose
distributions.

• Use of haptic 3D-menus to provide an integrated planning environment

4. The Application

In this paper we investigate the use of haptic interaction
(force feedback) combined with 3D visualization to provide
an efficient tool for dose planning. Thus the implemented
tool is built upon the following constituents:
• Real-time 3D visualization of both the tissue data and
the currently defined irradiation field
• Interactive placement and subsequent adjustment of irradiation iso-centres using a haptic device

The novel aspects of this approach lie in the use of
haptics to explore the dose distribution and to guide the user
in positioning the next iso-centre, and the different methods
used to generate the force feedback from the dose distribution. The use of haptics adds a complimentary channel of
abstract information to the user, helping to guide the clinician. Furthermore, the application is an example of an integrated VR environment tailored for the specific application at hand with the potential of improving the work flow
in dose planning.

3. Related Work
Many of the papers discussing the application of virtual reality and haptic feedback in clinical practice and
training today, aim at using the feedback to improve immersion and tactile interaction, for example for surgical
simulators[9, 6, 10, 7]. In contrast, in this application, the
haptic feedback is exploited to deliver additional abstract

The implementation presented in this paper is based on
the haptic workstation developed by Reachin Technologies
AB, as shown in Fig. 2. It consists of a monitor providing (in
combination with a standard pair of LCD shutter glasses)
stereo display, a 6 degree of freedom mouse (a Magellan device from 3Dconnexion), and a Desktop PHANTOM
haptic device (from Sensable technologies) which provides
6 degrees of freedom tracked motion with three degrees of
freedom being force-enabled. An API based on the VRML
scene-graph model is also supplied with the workstation and
is suitable for programming haptic environments in C++,
VRML and Python.

4.1. Visualization
Of primary importance to the clinician is the visual representation of the initial anatomical data taken from the patient scan. This visual representation permits the clinician
to perform an initial planning of the positions and sizes of

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

the iso-centres. It is therefore crucial that the initial visualization permits the clinician to see both the target and the
surrounding tissue structures clearly. A mixture of visualization methods are, therefore, applied to the initial data display before the clinician switches to the haptic interaction
scheme for the placement of the dose iso-centres.
4.1.1. Target visualization In the current implementation
we have used a manual procedure to segment the target
volume from the surrounding tissue on the original MR images. The segmentation produces a set of data images having the same dimensions as the original MR images but
containing a segmentation of the data into a binary state of
either inside or outside the target volume. This new set of
data is then stacked into a binary volume that can be transformed into an iso-surface using standard methods such as
the Marching Cubes algorithm[5].
The target iso-surface is then rendered as a semitransparent surface within the 3D display environment of
the haptics workstation. This is done in order to visualize the target volume while not occluding the interior of
the target. This is important since iso-centres are placed inside the target during the planning process and the visual
representation of the selected iso-dose surface will also be
rendered partly inside the target volume.
4.1.2. Surrounding tissue visualization In the initial visual analysis of the target, the surrounding tissue is displayed using volume visualization methods based
on 3D textures. Since this tissue visualization is not essential for the process of iso-centre placement and serves
primarily as an orientation aid, the MRI images are simply
stacked to create a 3D texture without further segmentation.
In the present implementation the volume rendering capabilities of the haptics workstation were found
to be insufficient for interactive work when placing the
dose iso-centres in the target volume, the frame rate being too low. This problem is avoided by simply turning
off the volume-rendered display of the surrounding tissues during the placement process. This does not directly hinder the clinician’s work since the target itself
can still be clearly seen. The volume rendering can easily be turned on again, at any time, to assist in orientation.
As graphics hardware can be expected to continue to improve it is anticipated that this volume visualization can
become a standard feature used in the process in future versions of the application.
4.1.3. Dose visualization The placement of iso-centres
gives rise to a dose distribution, as discussed in section 1.
The evolution of the dose distribution, as iso-centres are added or adjusted, is continuously visualized through an isodose surface representing a certain fraction of the peak level
of the scalar irradiation field. With each placement of a new

Figure 3. An iso-dose surface partly inside
the target surface. A piece of the iso-dose
surface has been rendered as a wire-frame to
reveal the iso-centre spheres.

or movement of an existing iso-centre the surface is updated
in real-time, see Fig. 3.
During the dose planning process the iso-dose surface is
an important visual tool since the goal is to gain optimal
conformity between the target surface and a particular isodose surface. The visualization of the surface aids the user
in understanding how the dose is distributed across the target and in identifying any overspill into adjacent tissue.
The Marching Cubes algorithm is used to create and update the iso-dose surface. Since the dose volume used to
evaluate the accumulated dose is usually relatively small,
updates of the iso-dose surface can be accomplished in real
time without the use of more sophisticated data representations.
The iso-centres are rendered as red spheres, showing the
size and position of each iso-centre placed in the target
volume. However, most of the time, these red spheres are
hidden within the iso-dose surface and only when there is a
very steep gradient near an iso-centre is the iso-centre visible. To enable interaction with the iso-centres, when the
user wants to pick an already placed iso-centre and move
it or change its properties, the iso-dose surface is automatically turned off. When an iso-centre is picked the corresponding sphere turns green.
Moving or changing the properties of the iso-centre will
change its influence on the dose distribution and the isodose surface is then automatically turned on and updated in
real-time as the iso-centre is moved.

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

4.1.4. Graphical user interface A user interface toolkit is
provided by the Reachin API. With the help of this toolkit
it is a relatively simple task to construct user interfaces in
VRML. The resulting user interface objects have built-in
force feedback and when, for example, pressing a button the
feedback mimics the feeling of using a pen to push the buttons on a keyboard.
In the developed application, see Fig. 4, the left part of
the screen contains a user menu and coordinate axes to show
how the target is rotated with respect to the user’s view, a
feature which is essential for clinical use of the application.
To the right the raw MRI images are displayed, showing the
planning progress in the traditional 2D format. In the centre
is the 3D ‘work area’ and in the upper centre is an information panel. This panel shows information about the most recently placed or selected iso-centre, such as its size and the
irradiation time.
The implemented functions on the user menu are:
1. Choose Size — a menu with four different options: 4,
8, 14, 18 mm which controls the collimator used for a
particular iso-centre.
2. Clear — remove all placed iso-centres.
3. Zoom — zooms the target area.
4. Isodose — a slider-bar where the user can interactively
adjust the iso-dose surface displayed. The value of the
iso-dose surface ranges from 0% – 100%.
5. Time Weight — increase/decrease the irradiation time
for the current iso-centre. If no iso-centre is currently
selected then the most recently placed iso-centre is manipulated.
6. Delete — remove selected iso-centre. If no iso-centre
is currently selected then the most recently placed isocentre is removed.
7. Settings — a menu where the user can turn different visualization options on/off. The options are: isodose surface, target surface, iso-centre representation,
volume rendering of MRI data and volume rendering
of dose distribution.
8. Target Force — a menu where the user can control the
force model for the target force. See section 4.2.1 below.
9. Dose Force — a menu where the user can control the
dose force model. See 4.2.2 below.
10. Pick dose — when this button is pressed the user can
pick a specific iso-centre to manipulate.
The MRI images, displayed to the right of the work area,
make an intuitive connection from this application to the
more traditional interfaces, based on 2D visualization, for

dose planning. There are three panels showing three adjacent images at a time. The user may zoom and pan the images, change the contrast and even maximize the middle
panel. On the images the target area and the iso-dose can
be seen as red and green iso-lines, respectively, as can be
seen in Fig. 4.
Since the 2D slices are displayed at a relatively low resolution it was unnecessary to employ a computationally
heavy method, such as marching squares, to display the target and dose distribution volumes in the 2D slices. Instead,
a simple stencil method was used which allows the clinician to clearly see the projection of these volumes into the
three 2D slices currently displayed. Pixels of the target surface are coloured red and of the dose iso-surface are coloured green on the 2D plane.

4.2. Haptic feedback
The dose distribution generated by the iso-centres is far
more complex than a simple iso-surface rendering scheme
can reveal. Volume rendering is, in this case, not suitable
due to the fact that it is very small local changes in the scalar
field that are the primary interest of the clinician carrying
out the procedure. Haptic interaction, however, provides a
means of achieving full 3D local representation of these
variations. Furthermore, haptics is not affected by visual occlusion caused by the target or iso-dose surface representations.
In addition to using haptic feedback to present the dose
distribution to the user, we also use the feedback to guide
the user to place iso-centres at advantageous positions.
An advantageous position is defined by two main criteria:
• the dose should be inside the target area so that healthy
tissue is not unnecessarily exposed to radiation
• the required dose should be distributed as uniformly as
possible over the whole target volume
One important question to address is: what is the optimal
placement of the first iso-centre? Since, at that stage, no
point inside (or outside) the target has any dose at all, all
dose-based force algorithms fail. In the current implementation we rely on the expert opinion of the clinician to determine the position for the first iso-centre.
Two sources of haptic feedback were implemented corresponding to the two criteria above:
• A target guiding force feedback, not to force but to
guide the user to put iso-centres in a position inside
the target and not too close to the target wall
• A dosage guiding force feedback that leads the user
away from areas where higher dose has already been
applied and thus finds potential minima of the field inside the target volume

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

These two force-feedback methods are described in more
detail in the following two subsections.
4.2.1. Target guiding The purpose of the target guidance
force is to help the user find appropriate new positions inside the target area. The force should be directed inwards
from the target surface and also be inversely proportional
to the distance from the surface. In a simplistic approach,
at every haptic loop cycle the distance from the position of
the pen to each vertex in the target surface would have to be
evaluated in order to obtain the minimum distance. For any
realistic target surface, however, the calculations required in
obtaining this minimum distance cause the haptic feedback
frequency to become too low, resulting in poor response to
movements of the planned iso-centre, and so a simplification is required.
In order to speed up the calculations it was decided, instead, to first calculate the distance from the pen to a small
number of randomly chosen points (perhaps 5) on the target
surface. The minimum of these distances can then be taken
and a cube constructed around the pointer position, having
sides twice that distance. All of the surface points that have
coordinates lying outside these intervals can then immediately be ignored. Through this optimization it is possible to
discard a sufficient number of vertices so that the update frequency for the haptic loop can be maintained at an acceptable rate and the algorithm produces a force smooth enough
to be of practical use.
When this approach was implemented, however, it was
found that the direction of the force towards the centre of the
target did not convey a ‘natural’ feeling of the target boundary for real target surfaces which are often very irregular.
To alleviate this problem we instead direct the force along
the direction defined by the vector pointing from the surface
of the target towards the pen position. This, however, produced a discontinuous force, due to the non-smooth nature
of the target surface. This problem was resolved by finding
the three nearest vertices and calculating a weighted sum of
these, so that the vertex furthest away contributed the least
to the force. This final force gives a natural feeling of the target surface with an acceptable computational overhead and
no discontinuities.
Other, more complex, methods such as the use of a static,
pre-computed distance field (as suggested by Bartz et al.[2])
would be appropriate but, for the initial implementation, a
simple distance force has been found to be sufficient. It is
planned to explore the benefits of more complex target force
models in future work.
4.2.2. Dosage guiding To produce force feedback representing the irradiation field, a gradient based feedback[4, 7,
1, 3] was adopted. The force, F , at a position, x, is calculated as
F (x) = −C ∇D(x)
(1)

Figure 4. A screen dump from the application.

where C is a scaling constant and ∇ is the gradient operator
acting on the irradiation field D(x).
By basing the force feedback on the negative multiple of
the gradient the haptic instrument will be pushed away from
areas where high dose is already present. This will create
an attraction towards local minima in the dose distribution,
which are likely to be suitable areas to place new irradiation
iso-centres.
The dose distribution profile for a single iso-centre falls
off very quickly. This results in a large gradient at short
distances from the iso-centre. When several iso-centres are
placed in close proximity to each other the gradient will
give rise to large forces pushing the haptic instrument away.
Hence, the user will sense sharp changes in the dose distribution providing information hard to represent visually,
such as changes in dose distribution at the borders of the
target volume.

5. Results and Future work
In previous medical applications haptics have primarily been used for training simulators based on the physical properties of the tissues involved in the procedures being simulated. In the presented application we make use of
haptics to explore volume data describing a dose distribution during treatment planning.
The presented work constitutes an example of how
haptics, in combination with 3D visualization, can provide
an integrated environment for advanced work procedures requiring many channels of information to the user
as well as accurate and intuitive interaction with the data
at hand. The haptics is used to supply an additional channel for abstract information overlaid on geometry that is
visualized using standard 3D graphics techniques.

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

The implementation presented above has not yet been
subjected to a strict evaluation procedure but preliminary
feedback from potential users has been very positive, indicating that they consider this force-assisted approach to be
a promising additional tool for the task of positioning the
dose iso-centres.
Current development work is being carried out to implement the standard ‘Dose Volume Histogram’ measure
within the application which provides a quantitative and
qualitative measure of the planned dose distribution. Using
this measure it will be possible to carry out a full comparison between the performance of clinicians using this new
haptic interface and using the current 2D approach. Such a
systematic comparison is currently being conducted by one
of the authors.
Based on the positive feedback received we now foresee
several other application areas in which 3D-visualization
can be augmented with haptic information in similar ways.
Work is in progress to carry our developments forward into
these new areas of interest.

[3] W. Hashimoro and H. Iwata. A versatile software platform
for visual/haptic environment. ICAT Paper, 1997. pages
106–114.

References

[9] G. Picinbono, J.-C. Lombardo, H. Delingette, and N. Ayache. Anisotropic elasticity and force extrapolation to improve realism of surgery simulation. Proceedings of the 2000
IEEE International Conference on Robotics and Automation,
2000.

[1] R. S. Avila and L. M. Sobierajski. A haptic interaction
method for volume visualization. In IEEE Visualization, October 1996. pages 197–204.
[2] D. Bartz and Ö. Gürvit. Haptic navigation in volumetric datasets. Proc. of PHANToM User Research Symposium, 2000.

[4] H. Iwata and H. Noma. Volume haptization. IEEE 1993
Symposium on Research Frontiers in Virtual Reality, October 1993. pp. 16-23.
[5] W. E. Lorensen and H. E. Cline. Marching cubes: A high
resolution 3d surface construction algorithm. Proceedings of
the ACM Conference on Computer Graphics, July 1987.
[6] K. Montgomery, L. Heinrichs, C. Bruyns, S. Wildermuth,
C. Hasser, S. Ozenne, and D. Bailey. Surgical simulator for
hysteroscopy: A case study of visualization in surgical training. Presented at IEEE Visualization 2001, 2001.
[7] A. Mor, S. Gibson, and J. Samosky. Interacting with 3dimensional medical data: Haptic feedback for surgical simulation. In Proceedings of Phantom User Group Workshop’96, 1996.
[8] L. Pao and D. Lawrence. Synergistic visual/haptic computer
interfaces. Proceedings Japan/USA/Vietnam Workshop on
Research and Education in Systems, Computation, and Control Engineering, 1998.

[10] V. Vuskovic, M. Kauer, G.Szekely, and M. Reidy. Realistic
force feedback for virtual reality based diagnostic surgery
simulators. Proceedings of the 2000 IEEE International Conference on Robotics and Automation, 2000.

Proceedings of the Eighth International Conference on Information Visualisation (IV’04)
1093-9547/04 $ 20.00 IEEE

